/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var Gd=Object.create;var xn=Object.defineProperty;var Jd=Object.getOwnPropertyDescriptor;var Qd=Object.getOwnPropertyNames;var Zd=Object.getPrototypeOf,Yd=Object.prototype.hasOwnProperty;var Xd=(r,e,t)=>e in r?xn(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var j=(r,e)=>()=>(r&&(e=r(r=0)),e);var Si=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),xt=(r,e)=>{for(var t in e)xn(r,t,{get:e[t],enumerable:!0})},Ta=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Qd(e))!Yd.call(r,i)&&i!==t&&xn(r,i,{get:()=>e[i],enumerable:!(n=Jd(e,i))||n.enumerable});return r};var Ut=(r,e,t)=>(t=r!=null?Gd(Zd(r)):{},Ta(e||!r||!r.__esModule?xn(t,"default",{value:r,enumerable:!0}):t,r)),ef=r=>Ta(xn({},"__esModule",{value:!0}),r);var be=(r,e,t)=>(Xd(r,typeof e!="symbol"?e+"":e,t),t);var Pa,st,Ei=j(()=>{Pa=require("obsidian"),st=class{constructor(e){this.plugin=e,this.init()}static getInstance(e){return this.instance||(this.instance=new st(e)),this.instance}init(){}getCurrentMarkdownView(){var n;let e=this.plugin.app.workspace.getActiveFile(),t=this.plugin.app.workspace.getLeavesOfType("markdown");for(let i of t){let o=i.view;if(((n=o.file)==null?void 0:n.path)===(e==null?void 0:e.path))return o}return null}forceRenderActiveMarkdownView(){let e=this.getCurrentMarkdownView();e&&this.plugin.app.workspace.trigger("render",e)}queryElements(e){let t=this.getCurrentMarkdownView();if(!t)return[];let n=t.getMode()==="preview"?".markdown-preview-view":".markdown-source-view",i=t.containerEl.querySelector(n);return i?i.querySelectorAll(e):[]}getMarkdownViewContainer(){let e=this.getCurrentMarkdownView();return e?e.containerEl:null}getMarkdownRenderedElement(e,t){let n=this.queryElements(t);if(n.length<=e)return null;let i=n[e];return i||null}getFileOfLink(e){return this.plugin.app.metadataCache.getFirstLinkpathDest(e,"")}async getLinkFileContent(e){let t=this.getFileOfLink(e);return t?await this.plugin.app.vault.adapter.read(t.path):null}async saveImageFromUrl(e){var d;let t=this.plugin.app.workspace.getActiveFile();if(!t)return null;let n=t.basename,i=((d=t.parent)==null?void 0:d.path)||"",o=e.split("/"),s=o[o.length-1].split("?")[0].split(".").pop(),l=new Date().toISOString().replace(/[:.]/g,"-").replace("T","_"),c=`${n}_generated_${l}.${s||"jpg"}`,u=i==="/"?`/${c}`:`${i}/${c}`;try{let f=await(0,Pa.requestUrl)({url:e});if(f.status!==200)throw new Error("Failed to fetch image");let m=f.arrayBuffer;return await this.plugin.app.vault.adapter.writeBinary(u,m),u}catch(f){return console.error("Error saving image:",f),null}}}});var ne,_n,Ia,tf,nf,$a,Oa,kn,Da,rf,ir,of,Na,Vt,af,sf,Ai,lf,cf,uf,Pi,or,df,Kt,lt,Gt,ar,ja,Ma,Jt,sr,La,Ra,Ii,Fa,Ti,$i,ff,Wt,Oi,hf,Di,Ba,qa,rr,pf,Ct,Oe,ow,aw,sw,lw,cw,uw,dw,fw,hw,pw,gw,mw,vw,yw,za=j(()=>{ne=r=>typeof r=="string",_n=()=>{let r,e,t=new Promise((n,i)=>{r=n,e=i});return t.resolve=r,t.reject=e,t},Ia=r=>r==null?"":""+r,tf=(r,e,t)=>{r.forEach(n=>{e[n]&&(t[n]=e[n])})},nf=/###/g,$a=r=>r&&r.indexOf("###")>-1?r.replace(nf,"."):r,Oa=r=>!r||ne(r),kn=(r,e,t)=>{let n=ne(e)?e.split("."):e,i=0;for(;i<n.length-1;){if(Oa(r))return{};let o=$a(n[i]);!r[o]&&t&&(r[o]=new t),Object.prototype.hasOwnProperty.call(r,o)?r=r[o]:r={},++i}return Oa(r)?{}:{obj:r,k:$a(n[i])}},Da=(r,e,t)=>{let{obj:n,k:i}=kn(r,e,Object);if(n!==void 0||e.length===1){n[i]=t;return}let o=e[e.length-1],a=e.slice(0,e.length-1),s=kn(r,a,Object);for(;s.obj===void 0&&a.length;)o=`${a[a.length-1]}.${o}`,a=a.slice(0,a.length-1),s=kn(r,a,Object),s!=null&&s.obj&&typeof s.obj[`${s.k}.${o}`]!="undefined"&&(s.obj=void 0);s.obj[`${s.k}.${o}`]=t},rf=(r,e,t,n)=>{let{obj:i,k:o}=kn(r,e,Object);i[o]=i[o]||[],i[o].push(t)},ir=(r,e)=>{let{obj:t,k:n}=kn(r,e);if(t&&Object.prototype.hasOwnProperty.call(t,n))return t[n]},of=(r,e,t)=>{let n=ir(r,t);return n!==void 0?n:ir(e,t)},Na=(r,e,t)=>{for(let n in e)n!=="__proto__"&&n!=="constructor"&&(n in r?ne(r[n])||r[n]instanceof String||ne(e[n])||e[n]instanceof String?t&&(r[n]=e[n]):Na(r[n],e[n],t):r[n]=e[n]);return r},Vt=r=>r.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),af={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},sf=r=>ne(r)?r.replace(/[&<>"'\/]/g,e=>af[e]):r,Ai=class{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){let t=this.regExpMap.get(e);if(t!==void 0)return t;let n=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,n),this.regExpQueue.push(e),n}},lf=[" ",",","?","!",";"],cf=new Ai(20),uf=(r,e,t)=>{e=e||"",t=t||"";let n=lf.filter(a=>e.indexOf(a)<0&&t.indexOf(a)<0);if(n.length===0)return!0;let i=cf.getRegExp(`(${n.map(a=>a==="?"?"\\?":a).join("|")})`),o=!i.test(r);if(!o){let a=r.indexOf(t);a>0&&!i.test(r.substring(0,a))&&(o=!0)}return o},Pi=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!r)return;if(r[e])return Object.prototype.hasOwnProperty.call(r,e)?r[e]:void 0;let n=e.split(t),i=r;for(let o=0;o<n.length;){if(!i||typeof i!="object")return;let a,s="";for(let l=o;l<n.length;++l)if(l!==o&&(s+=t),s+=n[l],a=i[s],a!==void 0){if(["string","number","boolean"].indexOf(typeof a)>-1&&l<n.length-1)continue;o+=l-o+1;break}i=a}return i},or=r=>r==null?void 0:r.replace("_","-"),df={type:"logger",log(r){this.output("log",r)},warn(r){this.output("warn",r)},error(r){this.output("error",r)},output(r,e){var t,n;(n=(t=console==null?void 0:console[r])==null?void 0:t.apply)==null||n.call(t,console,e)}},Kt=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||df,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,n,i){return i&&!this.debug?null:(ne(e[0])&&(e[0]=`${n}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new Kt(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new Kt(this.logger,e)}},lt=new Kt,Gt=class{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(n=>{this.observers[n]||(this.observers[n]=new Map);let i=this.observers[n].get(t)||0;this.observers[n].set(t,i+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(a=>{let[s,l]=a;for(let c=0;c<l;c++)s(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(a=>{let[s,l]=a;for(let c=0;c<l;c++)s.apply(s,[e,...n])})}},ar=class extends Gt{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){let t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,n){var c,u;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,a=i.ignoreJSONStructure!==void 0?i.ignoreJSONStructure:this.options.ignoreJSONStructure,s;e.indexOf(".")>-1?s=e.split("."):(s=[e,t],n&&(Array.isArray(n)?s.push(...n):ne(n)&&o?s.push(...n.split(o)):s.push(n)));let l=ir(this.data,s);return!l&&!t&&!n&&e.indexOf(".")>-1&&(e=s[0],t=s[1],n=s.slice(2).join(".")),l||!a||!ne(n)?l:Pi((u=(c=this.data)==null?void 0:c[e])==null?void 0:u[t],n,o)}addResource(e,t,n,i){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1},a=o.keySeparator!==void 0?o.keySeparator:this.options.keySeparator,s=[e,t];n&&(s=s.concat(a?n.split(a):n)),e.indexOf(".")>-1&&(s=e.split("."),i=t,t=s[1]),this.addNamespaces(t),Da(this.data,s,i),o.silent||this.emit("added",e,t,n,i)}addResources(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(let o in n)(ne(n[o])||Array.isArray(n[o]))&&this.addResource(e,t,o,n[o],{silent:!0});i.silent||this.emit("added",e,t,n)}addResourceBundle(e,t,n,i,o){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},s=[e,t];e.indexOf(".")>-1&&(s=e.split("."),i=n,n=t,t=s[1]),this.addNamespaces(t);let l=ir(this.data,s)||{};a.skipCopy||(n=JSON.parse(JSON.stringify(n))),i?Na(l,n,o):l={...l,...n},Da(this.data,s,l),a.silent||this.emit("added",e,t,n)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){let t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(i=>t[i]&&Object.keys(t[i]).length>0)}toJSON(){return this.data}},ja={processors:{},addPostProcessor(r){this.processors[r.name]=r},handle(r,e,t,n,i){return r.forEach(o=>{var a,s;e=(s=(a=this.processors[o])==null?void 0:a.process(e,t,n,i))!=null?s:e}),e}},Ma={},Jt=class extends Gt{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),tf(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=lt.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;let n=this.resolve(e,t);return(n==null?void 0:n.res)!==void 0}extractFromKey(e,t){let n=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");let i=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator,o=t.ns||this.options.defaultNS||[],a=n&&e.indexOf(n)>-1,s=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!uf(e,n,i);if(a&&!s){let l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:ne(o)?[o]:o};let c=e.split(n);(n!==i||n===i&&this.options.ns.indexOf(c[0])>-1)&&(o=c.shift()),e=c.join(i)}return{key:e,namespaces:ne(o)?[o]:o}}translate(e,t,n){if(typeof t!="object"&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),typeof t=="object"&&(t={...t}),t||(t={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);let i=t.returnDetails!==void 0?t.returnDetails:this.options.returnDetails,o=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator,{key:a,namespaces:s}=this.extractFromKey(e[e.length-1],t),l=s[s.length-1],c=t.lng||this.language,u=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((c==null?void 0:c.toLowerCase())==="cimode"){if(u){let p=t.nsSeparator||this.options.nsSeparator;return i?{res:`${l}${p}${a}`,usedKey:a,exactUsedKey:a,usedLng:c,usedNS:l,usedParams:this.getUsedParamsDetails(t)}:`${l}${p}${a}`}return i?{res:a,usedKey:a,exactUsedKey:a,usedLng:c,usedNS:l,usedParams:this.getUsedParamsDetails(t)}:a}let d=this.resolve(e,t),f=d==null?void 0:d.res,m=(d==null?void 0:d.usedKey)||a,b=(d==null?void 0:d.exactUsedKey)||a,E=Object.prototype.toString.apply(f),S=["[object Number]","[object Function]","[object RegExp]"],y=t.joinArrays!==void 0?t.joinArrays:this.options.joinArrays,g=!this.i18nFormat||this.i18nFormat.handleAsObject,h=!ne(f)&&typeof f!="boolean"&&typeof f!="number";if(g&&f&&h&&S.indexOf(E)<0&&!(ne(y)&&Array.isArray(f))){if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");let p=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,f,{...t,ns:s}):`key '${a} (${this.language})' returned an object instead of string.`;return i?(d.res=p,d.usedParams=this.getUsedParamsDetails(t),d):p}if(o){let p=Array.isArray(f),w=p?[]:{},k=p?b:m;for(let R in f)if(Object.prototype.hasOwnProperty.call(f,R)){let B=`${k}${o}${R}`;w[R]=this.translate(B,{...t,joinArrays:!1,ns:s}),w[R]===B&&(w[R]=f[R])}f=w}}else if(g&&ne(y)&&Array.isArray(f))f=f.join(y),f&&(f=this.extendTranslation(f,e,t,n));else{let p=!1,w=!1,k=t.count!==void 0&&!ne(t.count),R=Jt.hasDefaultValue(t),B=k?this.pluralResolver.getSuffix(c,t.count,t):"",F=t.ordinal&&k?this.pluralResolver.getSuffix(c,t.count,{ordinal:!1}):"",K=k&&!t.ordinal&&t.count===0,V=K&&t[`defaultValue${this.options.pluralSeparator}zero`]||t[`defaultValue${B}`]||t[`defaultValue${F}`]||t.defaultValue;!this.isValidLookup(f)&&R&&(p=!0,f=V),this.isValidLookup(f)||(w=!0,f=a);let Q=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&w?void 0:f,G=R&&V!==f&&this.options.updateMissing;if(w||p||G){if(this.logger.log(G?"updateKey":"missingKey",c,l,a,G?V:f),o){let v=this.resolve(a,{...t,keySeparator:!1});v&&v.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let Z=[],te=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if(this.options.saveMissingTo==="fallback"&&te&&te[0])for(let v=0;v<te.length;v++)Z.push(te[v]);else this.options.saveMissingTo==="all"?Z=this.languageUtils.toResolveHierarchy(t.lng||this.language):Z.push(t.lng||this.language);let se=(v,x,_)=>{var A;let C=R&&_!==f?_:Q;this.options.missingKeyHandler?this.options.missingKeyHandler(v,l,x,C,G,t):(A=this.backendConnector)!=null&&A.saveMissing&&this.backendConnector.saveMissing(v,l,x,C,G,t),this.emit("missingKey",v,l,x,f)};this.options.saveMissing&&(this.options.saveMissingPlurals&&k?Z.forEach(v=>{let x=this.pluralResolver.getSuffixes(v,t);K&&t[`defaultValue${this.options.pluralSeparator}zero`]&&x.indexOf(`${this.options.pluralSeparator}zero`)<0&&x.push(`${this.options.pluralSeparator}zero`),x.forEach(_=>{se([v],a+_,t[`defaultValue${_}`]||V)})}):se(Z,a,V))}f=this.extendTranslation(f,e,t,d,n),w&&f===a&&this.options.appendNamespaceToMissingKey&&(f=`${l}:${a}`),(w||p)&&this.options.parseMissingKeyHandler&&(f=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${l}:${a}`:a,p?f:void 0))}return i?(d.res=f,d.usedParams=this.getUsedParamsDetails(t),d):f}extendTranslation(e,t,n,i,o){var c,u;var a=this;if((c=this.i18nFormat)!=null&&c.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});let d=ne(e)&&(((u=n==null?void 0:n.interpolation)==null?void 0:u.skipOnVariables)!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables),f;if(d){let b=e.match(this.interpolator.nestingRegexp);f=b&&b.length}let m=n.replace&&!ne(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(m={...this.options.interpolation.defaultVariables,...m}),e=this.interpolator.interpolate(e,m,n.lng||this.language||i.usedLng,n),d){let b=e.match(this.interpolator.nestingRegexp),E=b&&b.length;f<E&&(n.nest=!1)}!n.lng&&i&&i.res&&(n.lng=this.language||i.usedLng),n.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var b=arguments.length,E=new Array(b),S=0;S<b;S++)E[S]=arguments[S];return(o==null?void 0:o[0])===E[0]&&!n.context?(a.logger.warn(`It seems you are nesting recursively key: ${E[0]} in key: ${t[0]}`),null):a.translate(...E,t)},n)),n.interpolation&&this.interpolator.reset()}let s=n.postProcess||this.options.postProcess,l=ne(s)?[s]:s;return e!=null&&(l!=null&&l.length)&&n.applyPostProcessor!==!1&&(e=ja.handle(l,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),e}resolve(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n,i,o,a,s;return ne(e)&&(e=[e]),e.forEach(l=>{if(this.isValidLookup(n))return;let c=this.extractFromKey(l,t),u=c.key;i=u;let d=c.namespaces;this.options.fallbackNS&&(d=d.concat(this.options.fallbackNS));let f=t.count!==void 0&&!ne(t.count),m=f&&!t.ordinal&&t.count===0,b=t.context!==void 0&&(ne(t.context)||typeof t.context=="number")&&t.context!=="",E=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);d.forEach(S=>{var y,g;this.isValidLookup(n)||(s=S,!Ma[`${E[0]}-${S}`]&&((y=this.utils)!=null&&y.hasLoadedNamespace)&&!((g=this.utils)!=null&&g.hasLoadedNamespace(s))&&(Ma[`${E[0]}-${S}`]=!0,this.logger.warn(`key "${i}" for languages "${E.join(", ")}" won't get resolved as namespace "${s}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),E.forEach(h=>{var k;if(this.isValidLookup(n))return;a=h;let p=[u];if((k=this.i18nFormat)!=null&&k.addLookupKeys)this.i18nFormat.addLookupKeys(p,u,h,S,t);else{let R;f&&(R=this.pluralResolver.getSuffix(h,t.count,t));let B=`${this.options.pluralSeparator}zero`,F=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(f&&(p.push(u+R),t.ordinal&&R.indexOf(F)===0&&p.push(u+R.replace(F,this.options.pluralSeparator)),m&&p.push(u+B)),b){let K=`${u}${this.options.contextSeparator}${t.context}`;p.push(K),f&&(p.push(K+R),t.ordinal&&R.indexOf(F)===0&&p.push(K+R.replace(F,this.options.pluralSeparator)),m&&p.push(K+B))}}let w;for(;w=p.pop();)this.isValidLookup(n)||(o=w,n=this.getResource(h,S,w,t))}))})}),{res:n,usedKey:i,exactUsedKey:o,usedLng:a,usedNS:s}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,n){var o;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return(o=this.i18nFormat)!=null&&o.getResource?this.i18nFormat.getResource(e,t,n,i):this.resourceStore.getResource(e,t,n,i)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=e.replace&&!ne(e.replace),i=n?e.replace:e;if(n&&typeof e.count!="undefined"&&(i.count=e.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!n){i={...i};for(let o of t)delete i[o]}return i}static hasDefaultValue(e){let t="defaultValue";for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t===n.substring(0,t.length)&&e[n]!==void 0)return!0;return!1}},sr=class{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=lt.create("languageUtils")}getScriptPartFromCode(e){if(e=or(e),!e||e.indexOf("-")<0)return null;let t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=or(e),!e||e.indexOf("-")<0)return e;let t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(ne(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch(n){}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(n=>{if(t)return;let i=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(i))&&(t=i)}),!t&&this.options.supportedLngs&&e.forEach(n=>{if(t)return;let i=this.getLanguagePartFromCode(n);if(this.isSupportedCode(i))return t=i;t=this.options.supportedLngs.find(o=>{if(o===i)return o;if(!(o.indexOf("-")<0&&i.indexOf("-")<0)&&(o.indexOf("-")>0&&i.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===i||o.indexOf(i)===0&&i.length>1))return o})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),ne(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}toResolveHierarchy(e,t){let n=this.getFallbackCodes(t||this.options.fallbackLng||[],e),i=[],o=a=>{a&&(this.isSupportedCode(a)?i.push(a):this.logger.warn(`rejecting language code not found in supportedLngs: ${a}`))};return ne(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&o(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&o(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&o(this.getLanguagePartFromCode(e))):ne(e)&&o(this.formatLanguageCode(e)),n.forEach(a=>{i.indexOf(a)<0&&o(this.formatLanguageCode(a))}),i}},La={zero:0,one:1,two:2,few:3,many:4,other:5},Ra={select:r=>r===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})},Ii=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=lt.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=or(e==="dev"?"en":e),i=t.ordinal?"ordinal":"cardinal",o=JSON.stringify({cleanedCode:n,type:i});if(o in this.pluralRulesCache)return this.pluralRulesCache[o];let a;try{a=new Intl.PluralRules(n,{type:i})}catch(s){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),Ra;if(!e.match(/-|_/))return Ra;let l=this.languageUtils.getLanguagePartFromCode(e);a=this.getRule(l,t)}return this.pluralRulesCache[o]=a,a}needsPlural(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=this.getRule(e,t);return n||(n=this.getRule("dev",t)),(n==null?void 0:n.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,n).map(i=>`${t}${i}`)}getSuffixes(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=this.getRule(e,t);return n||(n=this.getRule("dev",t)),n?n.resolvedOptions().pluralCategories.sort((i,o)=>La[i]-La[o]).map(i=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${i}`):[]}getSuffix(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=this.getRule(e,n);return i?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${i.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,n))}},Fa=function(r,e,t){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=of(r,e,t);return!o&&i&&ne(t)&&(o=Pi(r,t,n),o===void 0&&(o=Pi(e,t,n))),o},Ti=r=>r.replace(/\$/g,"$$$$"),$i=class{constructor(){var t;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=lt.create("interpolator"),this.options=e,this.format=((t=e==null?void 0:e.interpolation)==null?void 0:t.format)||(n=>n),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});let{escape:t,escapeValue:n,useRawValueToEscape:i,prefix:o,prefixEscaped:a,suffix:s,suffixEscaped:l,formatSeparator:c,unescapeSuffix:u,unescapePrefix:d,nestingPrefix:f,nestingPrefixEscaped:m,nestingSuffix:b,nestingSuffixEscaped:E,nestingOptionsSeparator:S,maxReplaces:y,alwaysFormat:g}=e.interpolation;this.escape=t!==void 0?t:sf,this.escapeValue=n!==void 0?n:!0,this.useRawValueToEscape=i!==void 0?i:!1,this.prefix=o?Vt(o):a||"{{",this.suffix=s?Vt(s):l||"}}",this.formatSeparator=c||",",this.unescapePrefix=u?"":d||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=f?Vt(f):m||Vt("$t("),this.nestingSuffix=b?Vt(b):E||Vt(")"),this.nestingOptionsSeparator=S||",",this.maxReplaces=y||1e3,this.alwaysFormat=g!==void 0?g:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){let e=(t,n)=>(t==null?void 0:t.source)===n?(t.lastIndex=0,t):new RegExp(n,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,n,i){var m;let o,a,s,l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},c=b=>{if(b.indexOf(this.formatSeparator)<0){let g=Fa(t,l,b,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(g,void 0,n,{...i,...t,interpolationkey:b}):g}let E=b.split(this.formatSeparator),S=E.shift().trim(),y=E.join(this.formatSeparator).trim();return this.format(Fa(t,l,S,this.options.keySeparator,this.options.ignoreJSONStructure),y,n,{...i,...t,interpolationkey:S})};this.resetRegExp();let u=(i==null?void 0:i.missingInterpolationHandler)||this.options.missingInterpolationHandler,d=((m=i==null?void 0:i.interpolation)==null?void 0:m.skipOnVariables)!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:b=>Ti(b)},{regex:this.regexp,safeValue:b=>this.escapeValue?Ti(this.escape(b)):Ti(b)}].forEach(b=>{for(s=0;o=b.regex.exec(e);){let E=o[1].trim();if(a=c(E),a===void 0)if(typeof u=="function"){let y=u(e,o,i);a=ne(y)?y:""}else if(i&&Object.prototype.hasOwnProperty.call(i,E))a="";else if(d){a=o[0];continue}else this.logger.warn(`missed to pass in variable ${E} for interpolating ${e}`),a="";else!ne(a)&&!this.useRawValueToEscape&&(a=Ia(a));let S=b.safeValue(a);if(e=e.replace(o[0],S),d?(b.regex.lastIndex+=a.length,b.regex.lastIndex-=o[0].length):b.regex.lastIndex=0,s++,s>=this.maxReplaces)break}}),e}nest(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,o,a,s=(l,c)=>{var E;let u=this.nestingOptionsSeparator;if(l.indexOf(u)<0)return l;let d=l.split(new RegExp(`${u}[ ]*{`)),f=`{${d[1]}`;l=d[0],f=this.interpolate(f,a);let m=f.match(/'/g),b=f.match(/"/g);(((E=m==null?void 0:m.length)!=null?E:0)%2===0&&!b||b.length%2!==0)&&(f=f.replace(/'/g,'"'));try{a=JSON.parse(f),c&&(a={...c,...a})}catch(S){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,S),`${l}${u}${f}`}return a.defaultValue&&a.defaultValue.indexOf(this.prefix)>-1&&delete a.defaultValue,l};for(;i=this.nestingRegexp.exec(e);){let l=[];a={...n},a=a.replace&&!ne(a.replace)?a.replace:a,a.applyPostProcessor=!1,delete a.defaultValue;let c=!1;if(i[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(i[1])){let u=i[1].split(this.formatSeparator).map(d=>d.trim());i[1]=u.shift(),l=u,c=!0}if(o=t(s.call(this,i[1].trim(),a),a),o&&i[0]===e&&!ne(o))return o;ne(o)||(o=Ia(o)),o||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${e}`),o=""),c&&(o=l.reduce((u,d)=>this.format(u,d,n.lng,{...n,interpolationkey:i[1].trim()}),o.trim())),e=e.replace(i[0],o),this.regexp.lastIndex=0}return e}},ff=r=>{let e=r.toLowerCase().trim(),t={};if(r.indexOf("(")>-1){let n=r.split("(");e=n[0].toLowerCase().trim();let i=n[1].substring(0,n[1].length-1);e==="currency"&&i.indexOf(":")<0?t.currency||(t.currency=i.trim()):e==="relativetime"&&i.indexOf(":")<0?t.range||(t.range=i.trim()):i.split(";").forEach(a=>{if(a){let[s,...l]=a.split(":"),c=l.join(":").trim().replace(/^'+|'+$/g,""),u=s.trim();t[u]||(t[u]=c),c==="false"&&(t[u]=!1),c==="true"&&(t[u]=!0),isNaN(c)||(t[u]=parseInt(c,10))}})}return{formatName:e,formatOptions:t}},Wt=r=>{let e={};return(t,n,i)=>{let o=i;i&&i.interpolationkey&&i.formatParams&&i.formatParams[i.interpolationkey]&&i[i.interpolationkey]&&(o={...o,[i.interpolationkey]:void 0});let a=n+JSON.stringify(o),s=e[a];return s||(s=r(or(n),i),e[a]=s),s(t)}},Oi=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=lt.create("formatter"),this.options=e,this.formats={number:Wt((t,n)=>{let i=new Intl.NumberFormat(t,{...n});return o=>i.format(o)}),currency:Wt((t,n)=>{let i=new Intl.NumberFormat(t,{...n,style:"currency"});return o=>i.format(o)}),datetime:Wt((t,n)=>{let i=new Intl.DateTimeFormat(t,{...n});return o=>i.format(o)}),relativetime:Wt((t,n)=>{let i=new Intl.RelativeTimeFormat(t,{...n});return o=>i.format(o,n.range||"day")}),list:Wt((t,n)=>{let i=new Intl.ListFormat(t,{...n});return o=>i.format(o)})},this.init(e)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=t.interpolation.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=Wt(t)}format(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},o=t.split(this.formatSeparator);if(o.length>1&&o[0].indexOf("(")>1&&o[0].indexOf(")")<0&&o.find(s=>s.indexOf(")")>-1)){let s=o.findIndex(l=>l.indexOf(")")>-1);o[0]=[o[0],...o.splice(1,s)].join(this.formatSeparator)}return o.reduce((s,l)=>{var d;let{formatName:c,formatOptions:u}=ff(l);if(this.formats[c]){let f=s;try{let m=((d=i==null?void 0:i.formatParams)==null?void 0:d[i.interpolationkey])||{},b=m.locale||m.lng||i.locale||i.lng||n;f=this.formats[c](s,b,{...u,...i,...m})}catch(m){this.logger.warn(m)}return f}else this.logger.warn(`there was no format function for ${c}`);return s},e)}},hf=(r,e)=>{r.pending[e]!==void 0&&(delete r.pending[e],r.pendingCount--)},Di=class extends Gt{constructor(e,t,n){var o,a;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=n,this.languageUtils=n.languageUtils,this.options=i,this.logger=lt.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],(a=(o=this.backend)==null?void 0:o.init)==null||a.call(o,n,i.backend,i)}queueLoad(e,t,n,i){let o={},a={},s={},l={};return e.forEach(c=>{let u=!0;t.forEach(d=>{let f=`${c}|${d}`;!n.reload&&this.store.hasResourceBundle(c,d)?this.state[f]=2:this.state[f]<0||(this.state[f]===1?a[f]===void 0&&(a[f]=!0):(this.state[f]=1,u=!1,a[f]===void 0&&(a[f]=!0),o[f]===void 0&&(o[f]=!0),l[d]===void 0&&(l[d]=!0)))}),u||(s[c]=!0)}),(Object.keys(o).length||Object.keys(a).length)&&this.queue.push({pending:a,pendingCount:Object.keys(a).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(o),pending:Object.keys(a),toLoadLanguages:Object.keys(s),toLoadNamespaces:Object.keys(l)}}loaded(e,t,n){let i=e.split("|"),o=i[0],a=i[1];t&&this.emit("failedLoading",o,a,t),!t&&n&&this.store.addResourceBundle(o,a,n,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&n&&(this.state[e]=0);let s={};this.queue.forEach(l=>{rf(l.loaded,[o],a),hf(l,e),t&&l.errors.push(t),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(c=>{s[c]||(s[c]={});let u=l.loaded[c];u.length&&u.forEach(d=>{s[c][d]===void 0&&(s[c][d]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",s),this.queue=this.queue.filter(l=>!l.done)}read(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,a=arguments.length>5?arguments[5]:void 0;if(!e.length)return a(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:n,tried:i,wait:o,callback:a});return}this.readingCalls++;let s=(c,u)=>{if(this.readingCalls--,this.waitingReads.length>0){let d=this.waitingReads.shift();this.read(d.lng,d.ns,d.fcName,d.tried,d.wait,d.callback)}if(c&&u&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,n,i+1,o*2,a)},o);return}a(c,u)},l=this.backend[n].bind(this.backend);if(l.length===2){try{let c=l(e,t);c&&typeof c.then=="function"?c.then(u=>s(null,u)).catch(s):s(null,c)}catch(c){s(c)}return}return l(e,t,s)}prepareLoading(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();ne(e)&&(e=this.languageUtils.toResolveHierarchy(e)),ne(t)&&(t=[t]);let o=this.queueLoad(e,t,n,i);if(!o.toLoad.length)return o.pending.length||i(),null;o.toLoad.forEach(a=>{this.loadOne(a)})}load(e,t,n){this.prepareLoading(e,t,{},n)}reload(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}loadOne(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=e.split("|"),i=n[0],o=n[1];this.read(i,o,"read",void 0,void 0,(a,s)=>{a&&this.logger.warn(`${t}loading namespace ${o} for language ${i} failed`,a),!a&&s&&this.logger.log(`${t}loaded namespace ${o} for language ${i}`,s),this.loaded(e,a,s)})}saveMissing(e,t,n,i,o){var l,c,u,d,f;let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if((c=(l=this.services)==null?void 0:l.utils)!=null&&c.hasLoadedNamespace&&!((d=(u=this.services)==null?void 0:u.utils)!=null&&d.hasLoadedNamespace(t))){this.logger.warn(`did not save key "${n}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if((f=this.backend)!=null&&f.create){let m={...a,isUpdate:o},b=this.backend.create.bind(this.backend);if(b.length<6)try{let E;b.length===5?E=b(e,t,n,i,m):E=b(e,t,n,i),E&&typeof E.then=="function"?E.then(S=>s(null,S)).catch(s):s(null,E)}catch(E){s(E)}else b(e,t,n,i,s,m)}!e||!e[0]||this.store.addResource(e[0],t,n,i)}}},Ba=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:r=>{let e={};if(typeof r[1]=="object"&&(e=r[1]),ne(r[1])&&(e.defaultValue=r[1]),ne(r[2])&&(e.tDescription=r[2]),typeof r[2]=="object"||typeof r[3]=="object"){let t=r[3]||r[2];Object.keys(t).forEach(n=>{e[n]=t[n]})}return e},interpolation:{escapeValue:!0,format:r=>r,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),qa=r=>{var e,t;return ne(r.ns)&&(r.ns=[r.ns]),ne(r.fallbackLng)&&(r.fallbackLng=[r.fallbackLng]),ne(r.fallbackNS)&&(r.fallbackNS=[r.fallbackNS]),((t=(e=r.supportedLngs)==null?void 0:e.indexOf)==null?void 0:t.call(e,"cimode"))<0&&(r.supportedLngs=r.supportedLngs.concat(["cimode"])),typeof r.initImmediate=="boolean"&&(r.initAsync=r.initImmediate),r},rr=()=>{},pf=r=>{Object.getOwnPropertyNames(Object.getPrototypeOf(r)).forEach(t=>{typeof r[t]=="function"&&(r[t]=r[t].bind(r))})},Ct=class extends Gt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(super(),this.options=qa(e),this.services={},this.logger=lt,this.modules={external:[]},pf(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof t=="function"&&(n=t,t={}),t.defaultNS==null&&t.ns&&(ne(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));let i=Ba();this.options={...i,...this.options,...qa(t)},this.options.interpolation={...i.interpolation,...this.options.interpolation},t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);let o=u=>u?typeof u=="function"?new u:u:null;if(!this.options.isClone){this.modules.logger?lt.init(o(this.modules.logger),this.options):lt.init(null,this.options);let u;this.modules.formatter?u=this.modules.formatter:u=Oi;let d=new sr(this.options);this.store=new ar(this.options.resources,this.options);let f=this.services;f.logger=lt,f.resourceStore=this.store,f.languageUtils=d,f.pluralResolver=new Ii(d,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),u&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(f.formatter=o(u),f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new $i(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new Di(o(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",function(m){for(var b=arguments.length,E=new Array(b>1?b-1:0),S=1;S<b;S++)E[S-1]=arguments[S];e.emit(m,...E)}),this.modules.languageDetector&&(f.languageDetector=o(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=o(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new Jt(this.services,this.options),this.translator.on("*",function(m){for(var b=arguments.length,E=new Array(b>1?b-1:0),S=1;S<b;S++)E[S-1]=arguments[S];e.emit(m,...E)}),this.modules.external.forEach(m=>{m.init&&m.init(this)})}if(this.format=this.options.interpolation.format,n||(n=rr),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){let u=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);u.length>0&&u[0]!=="dev"&&(this.options.lng=u[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(u=>{this[u]=function(){return e.store[u](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(u=>{this[u]=function(){return e.store[u](...arguments),e}});let l=_n(),c=()=>{let u=(d,f)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(f),n(d,f)};if(this.languages&&!this.isInitialized)return u(null,this.t.bind(this));this.changeLanguage(this.options.lng,u)};return this.options.resources||!this.options.initAsync?c():setTimeout(c,0),l}loadResources(e){var o,a;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rr,i=ne(e)?e:this.language;if(typeof e=="function"&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if((i==null?void 0:i.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();let s=[],l=c=>{if(!c||c==="cimode")return;this.services.languageUtils.toResolveHierarchy(c).forEach(d=>{d!=="cimode"&&s.indexOf(d)<0&&s.push(d)})};i?l(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(u=>l(u)),(a=(o=this.options.preload)==null?void 0:o.forEach)==null||a.call(o,c=>l(c)),this.services.backendConnector.load(s,this.options.ns,c=>{!c&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(c)})}else n(null)}reloadResources(e,t,n){let i=_n();return typeof e=="function"&&(n=e,e=void 0),typeof t=="function"&&(n=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),n||(n=rr),this.services.backendConnector.reload(e,t,o=>{i.resolve(),n(o)}),i}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&ja.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let t=0;t<this.languages.length;t++){let n=this.languages[t];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}changeLanguage(e,t){var n=this;this.isLanguageChangingTo=e;let i=_n();this.emit("languageChanging",e);let o=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},a=(l,c)=>{c?(o(c),this.translator.changeLanguage(c),this.isLanguageChangingTo=void 0,this.emit("languageChanged",c),this.logger.log("languageChanged",c)):this.isLanguageChangingTo=void 0,i.resolve(function(){return n.t(...arguments)}),t&&t(l,function(){return n.t(...arguments)})},s=l=>{var u,d;!e&&!l&&this.services.languageDetector&&(l=[]);let c=ne(l)?l:this.services.languageUtils.getBestMatchFromCodes(l);c&&(this.language||o(c),this.translator.language||this.translator.changeLanguage(c),(d=(u=this.services.languageDetector)==null?void 0:u.cacheUserLanguage)==null||d.call(u,c)),this.loadResources(c,f=>{a(f,c)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?s(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(s):this.services.languageDetector.detect(s):s(e),i}getFixedT(e,t,n){var i=this;let o=function(a,s){let l;if(typeof s!="object"){for(var c=arguments.length,u=new Array(c>2?c-2:0),d=2;d<c;d++)u[d-2]=arguments[d];l=i.options.overloadTranslationOptionHandler([a,s].concat(u))}else l={...s};l.lng=l.lng||o.lng,l.lngs=l.lngs||o.lngs,l.ns=l.ns||o.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||n||o.keyPrefix);let f=i.options.keySeparator||".",m;return l.keyPrefix&&Array.isArray(a)?m=a.map(b=>`${l.keyPrefix}${f}${b}`):m=l.keyPrefix?`${l.keyPrefix}${f}${a}`:a,i.t(m,l)};return ne(e)?o.lng=e:o.lngs=e,o.ns=t,o.keyPrefix=n,o}t(){var i;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(i=this.translator)==null?void 0:i.translate(...t)}exists(){var i;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(i=this.translator)==null?void 0:i.exists(...t)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;let n=t.lng||this.resolvedLanguage||this.languages[0],i=this.options?this.options.fallbackLng:!1,o=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;let a=(s,l)=>{let c=this.services.backendConnector.state[`${s}|${l}`];return c===-1||c===0||c===2};if(t.precheck){let s=t.precheck(this,a);if(s!==void 0)return s}return!!(this.hasResourceBundle(n,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||a(n,e)&&(!i||a(o,e)))}loadNamespaces(e,t){let n=_n();return this.options.ns?(ne(e)&&(e=[e]),e.forEach(i=>{this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}),this.loadResources(i=>{n.resolve(),t&&t(i)}),n):(t&&t(),Promise.resolve())}loadLanguages(e,t){let n=_n();ne(e)&&(e=[e]);let i=this.options.preload||[],o=e.filter(a=>i.indexOf(a)<0&&this.services.languageUtils.isSupportedCode(a));return o.length?(this.options.preload=i.concat(o),this.loadResources(a=>{n.resolve(),t&&t(a)}),n):(t&&t(),Promise.resolve())}dir(e){var i,o;if(e||(e=this.resolvedLanguage||(((i=this.languages)==null?void 0:i.length)>0?this.languages[0]:this.language)),!e)return"rtl";let t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=((o=this.services)==null?void 0:o.languageUtils)||new sr(Ba());return t.indexOf(n.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return new Ct(e,t)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rr,n=e.forkResourceStore;n&&delete e.forkResourceStore;let i={...this.options,...e,isClone:!0},o=new Ct(i);if((e.debug!==void 0||e.prefix!==void 0)&&(o.logger=o.logger.clone(e)),["store","services","language"].forEach(s=>{o[s]=this[s]}),o.services={...this.services},o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},n){let s=Object.keys(this.store.data).reduce((l,c)=>(l[c]={...this.store.data[c]},Object.keys(l[c]).reduce((u,d)=>(u[d]={...l[c][d]},u),{})),{});o.store=new ar(s,i),o.services.resourceStore=o.store}return o.translator=new Jt(o.services,i),o.translator.on("*",function(s){for(var l=arguments.length,c=new Array(l>1?l-1:0),u=1;u<l;u++)c[u-1]=arguments[u];o.emit(s,...c)}),o.init(i,t),o.translator.options=i,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}},Oe=Ct.createInstance();Oe.createInstance=Ct.createInstance;ow=Oe.createInstance,aw=Oe.dir,sw=Oe.init,lw=Oe.loadResources,cw=Oe.reloadResources,uw=Oe.use,dw=Oe.changeLanguage,fw=Oe.getFixedT,hw=Oe.t,pw=Oe.exists,gw=Oe.setDefaultNamespace,mw=Oe.hasLoadedNamespace,vw=Oe.loadNamespaces,yw=Oe.loadLanguages});var Ua,Ha=j(()=>{Ua={assets:{draft:"Draft",image:"Image","invalid-draft":"Invalid draft: missing account name or note path.",news:"News",video:"Video",voice:"Voice"},main:{"no-wechat-mp-account-selected":"No WeChat MP account selected.","please-check-you-appid-and-appsecret":"Please check your AppID and AppSecret.","open-previewer":"Article render previewer","fetch-wechat-profile":"Fetching WeChat profile","insert-mpcard":"Insert official account card","mpcard-not-configured":"No official account card configured. Paste the HTML in publish config first."},modals:{"be-careful":"Caution!",cancel:"Cancel",caution:"Caution!",confirm:"Confirm",delete:{action:"To proceed with deletion, click below.",message:"Are you sure you want to delete this item?",title:"Confirm Delete",warning:"This action is permanent and cannot be undone."},enter:"Enter",escape:"Escape",mpcard:{empty:"Please paste official account card content.",hint:"Copy the official account card code block from WeChat backend and paste it here.",insert:"Insert",placeholder:"Example:\n```mpcard\nid: gh_xxx\nheadimg: https://...\nnickname: Official Account\nsignature: Account description\n```",title:"Insert official account card"},ok:"OK",publish:{failed:"Publication failed",message:"Are you sure you want to publish this article?",success:"Published successfully",title:"Confirm publish",warning:"Publishing outside of WeChat MP may not be as efficient and some features might not work as expected (e.g., tags, pushing to public accounts)."},"publish-config":{"card-tab":"Official account card","options-tab":"Article options","mpcard-desc":"Paste the HTML code copied after inserting an official account card in WeChat editor.","copy-script":"Copy extract script","script-copied":"Script copied to clipboard.","mpcard-input":"Card HTML","mpcard-input-desc":"Paste <mp-common-profile> or a <section> that contains it.","mpcard-empty":"No official account card configured.","save-mpcard":"Parse and save","clear-mpcard":"Clear card","no-account":"No official account selected.","invalid-mpcard":"Invalid card content or missing data-id.","mpcard-saved":"Official account card saved.","no-active-file":"No active Markdown file.",title:"Title",author:"Author",digest:"Digest","source-url":"Source URL","open-comment":"Enable comments","only-fans":"Fans only comments","cover-empty":"Cover image not set."},space:"Space"},render:{"admonition-failed":"<section>Admonition rendering failed</section>","callout-failed":"<span>Callout rendering failed</span>","charts-failed":"<section>Charts rendering failed</section>","excalidraw-failed":"Excalidraw rendering failed","faild-canvas-context":"Failed to get canvas context.","failed-to-convert-canvas-to-blob":"Failed to convert canvas to Blob.","file-not-found":"File not found: {0}","mermaid-failed":"<section>Mermaid rendering failed</section>","pdf-crop-failed":"<span>Pdf cropping failed</span>","render-failed":"Rendering failed.","charts-plugin-not-installed":"Charts plugin not installed.","mpcard-default-name":"Official Account","mpcard-default-signature":"Account description",rendering:"Rendering...","failed-to-parse-custom-css":"Custom CSS parsing failed: {0}"},settings:{"account-info":"Account info","account-name":"Public account name","account-name-for-your-wechat-official":"WeChat official account name","add-ip-address-ipv4-0-to-wechat-mp-ip-wh":"Add IP address [{0}] to WeChat MP IP whitelist.",appid:"AppID","app-secret":"AppSecret","app-secret-for-your-wechat-official":"AppSecret for your WeChat official account","appid-for-your-wechat-official-account":"AppID for your WeChat official account","be-carefull-delete-account":"Caution! This will delete all settings and data for the account.","check-if-your-account-setting-is-correct":"Check if your account settings are correct.","click-to-connect-wechat-server":"Click to connect to WeChat server","successfully-connected-to-wechat-server":"Successfully connected to WeChat server.",fetching:"Fetching...","failed-to-connect-to-wechat-server":"Failed to connect to WeChat server.","copy-ip-address-to-clipboard":"Copy IP address to clipboard","copy-ip-to-clipboard":"Copy IP to clipboard","clipboard-not-supported":"Clipboard is not available on this platform.","create-new-account":"Create new account","custom-themes":"Custom themes","custom-themes-folder":"Custom themes folder","general-settings":"General settings","default-mpcard-biz-id":"Biz ID (data-id)","default-mpcard-biz-id-desc":"Base64 ID from the HTML.","delete-account":"Delete account","draft-previewer-wechat-id":"Draft previewer WeChat ID","draft-only-visible-for-the-wechat-user-o":"Draft visible only to the WeChat user. Requires API permission.","preview-draft-tooltip":"Send preview (API permission required)","enable-real-time-rendering":"Enable real-time rendering of markdown content","real-time-render":"Real-time Render","failed-to-get-wechat-access-token":"Failed to get WeChat access token.","if-your-device-cannot-get-static-pubic-i":"If your device cannot get a static public IP, use our center token server to get tokens. We will not misuse your AppID or AppSecret.","appid-secret-guide":"AppID and AppSecret are now available in WeChat Developer Console \u2192 Official Account \u2192 Basic Info.","appid-secret-guide-link":"Open WeChat Developer Console to get AppID / AppSecret","import-account-info":"Import Account Info","export-account-info":"Export Account Info","import-export-one2mp-account":"Import/Export Account Information","import-or-export-your-account-info-for-b":"Import or export your account info for backup and restore.","import-settings-title":"Import settings from vault","import-settings-hint":"Select a JSON settings file stored in your vault.","import-settings-placeholder":"Type or select a JSON file path","import-settings-confirm":"Import","import-settings-empty-path":"Please choose a settings file.","import-settings-file-not-found":"Settings file not found.","invalid-json-file":"Invalid JSON file.","invalid-wewerite-settings-file":"Invalid One2MP settings file.","ip-copied-to-clipboard":"IP copied to clipboard.","new-account":"New account","no-ip-address":"No IP address","public-ip-address":"Public IP address","select-account":"Select account","select-wechat-mp-account":"Select WeChat MP account","send-article-to-draft-box-successfully":"Article sent to draft box successfully.","settings-exported":"Settings exported successfully.","settings-exporting-failed":"Failed to export settings.","settings-exported-to-vault":"Settings exported to vault: {0}","settings-imported-error":"Error importing settings.","settings-imported-failed":"Failed to import settings.","settings-imported-successfully":"Settings imported successfully.","default-mpcard":"Default official account card","default-mpcard-desc":"Save a default official account card (used for right-click insert).","default-mpcard-placeholder":"Paste the official account card code block","default-mpcard-id":"Account ID","default-mpcard-id-desc":"Official account user_name.","default-mpcard-id-placeholder":"gh_xxx","default-mpcard-headimg":"Avatar URL","default-mpcard-headimg-desc":"Official account avatar link.","default-mpcard-headimg-placeholder":"https://...","default-mpcard-nickname":"Account name","default-mpcard-nickname-desc":"Official account display name.","default-mpcard-nickname-placeholder":"Account name","default-mpcard-signature":"Account description","default-mpcard-signature-desc":"Official account description.","default-mpcard-signature-placeholder":"Account description","default-mpcard-sync":"Sync account info","default-mpcard-sync-success":"Default official account card synced.","default-mpcard-sync-failed":"Failed to sync official account card.","default-mpcard-sync-partial":"Only nickname was synced. Please fill avatar/signature manually.","theme-download-overwrite":"Overwrite themes on download","theme-download-overwrite-desc":"When enabled, download will overwrite existing themes with the same name.","test-connection":"Test connection","choose-the-account-to-modify":"Choose the account to modify","the-folder-where-your-custom-themes":"Folder where your custom themes are stored.","themes-folder-path":"Themes folder path","use-center-token-server":"Use center token server","wechat-account":"WeChat account","you-should-add-this-ip-to-ip-whitelist-o":'Add this IP address to whitelist. Click the image in "account information" below to visit the WeChat MP platform.',"your-wechat-official-account":"Your WeChat official account"},views:{"article-header":{"article-title":"Article title","article-title-placeholder":"Enter article title",author:"Author","author-name":"Author name","comments-description":"Comments are closed by default.","cover-image":"Cover image","cover-image-description":"Cover image is required. Drag from vault or use an online image URL.","cover-file-not-supported":"Local file cover is not supported on mobile. Use a vault image or URL.","cover-image-mobile-button":"Choose/upload cover","cover-image-mobile-title":"Set cover image","cover-image-mobile-vault":"Select from vault","cover-image-mobile-vault-desc":"Choose an image path from the vault.","cover-image-mobile-vault-placeholder":"Type or select an image path","cover-image-mobile-url":"Use an image URL","cover-image-mobile-url-desc":"Enter an image URL.","cover-image-mobile-required":"Provide at least one cover image source.","cover-image-mobile-invalid":"Invalid image path. Please check and try again.","reset-cover-crop":"Reset crop",digest:"Digest","digest-text":"Enter digest text","only-fans-can-comment":"Only fans can comment","only-fans-can-comment-description":"Everyone can comment by default.","open-comments":"Open comments","testing-button":"Testing button",title:"Draft header"},"delete-draft":"Delete draft","delete-image":"Delete image","free-publish":"Free publish","no-title-article":"Article without title.","other-type-has-not-been-implemented":"Other type not implemented.","preview-draft":"Preview draft",previewer:{"article-copied-to-clipboard":"Article copied to clipboard.","open-url-not-supported":"Opening links is not supported on this platform.","article-render-failed":"Failed to render article.","article-title":"Article title","copy-article-to-clipboard":"Copy article to clipboard","publish-config":"Publish config","generate-template":"Generate WeChat template","file-not-found-path":"File not found: {0}","not-a-markdown-view":"Not a markdown view","please-set-cover-image":"Please set a cover image.","preview-draft-missing-id":"Send to draft first before previewing.","preview-draft-missing-wxid":"Set the previewer WeChat ID in Publish config first.","preview-draft-sent":"Preview message sent to WeChat.","render-article":"Render article","send-article-to-draft-box":"Send article to draft box","template-created":"WeChat template created.","template-file-created":"Template file created: one2mp-template.md","testing-button":"Testing button","to-verify-the-images-in-article":"Verify images in the article","one2mp-previewer":"O2Any previewer"},"send-mass-message":"Send mass message","theme-manager":{"default-theme":"Default theme","download-predefined-custom-themes":"Download predefined custom themes","download-started":"Theme download started. Please wait\u2026","download-themes-mobile-not-supported":"Theme download is not supported on mobile.","download-summary":"Theme download finished: {0} success, {1} failed, {2} skipped","error-downloading-theme":"Error downloading theme","error-downloading-themes":"Error downloading themes.","failed-to-fetch-themes-json-themesrespon":"Failed to fetch themes.json: {0}","total-themes-length-themes-downloaded":"Total {0} themes downloaded."}},"wechat-api":{"add-ip-address-ipv4-0-to-wechat-mp-ip-wh":"Add IP address [{0}] to WeChat MP IP whitelist.","failed-to-get-wechat-access-token":"Failed to get WeChat access token.","image-size-exceeds-10m":"Image size exceeds 10MB limit","video-size-exceeds-10m":"Video size exceeds 10MB limit","voice-size-exceeds-2m":"Voice size exceeds 2MB limit","select-an-wechat-mp-account-first":"Select a WeChat MP account first.","send-article-to-draft-box-successfully":"Article sent to draft box successfully.","uploading-material-type":"uploading material {0}"}}});var Wa,Va=j(()=>{Wa={assets:{draft:"\u8349\u7A3F",image:"\u56FE\u7247","invalid-draft":"\u65E0\u6548\u8349\u7A3F\uFF1A\u7F3A\u5C11\u8D26\u53F7\u540D\u79F0\u6216\u7B14\u8BB0\u8DEF\u5F84\u3002",news:"\u56FE\u6587\u6D88\u606F",video:"\u89C6\u9891",voice:"\u8BED\u97F3"},main:{"no-wechat-mp-account-selected":"\u672A\u9009\u62E9\u5FAE\u4FE1\u516C\u4F17\u53F7\u8D26\u53F7\u3002","please-check-you-appid-and-appsecret":"\u8BF7\u68C0\u67E5\u60A8\u7684AppID\u548CAppSecret\u3002","open-previewer":"\u6587\u7AE0\u6E32\u67D3\u9884\u89C8","fetch-wechat-profile":"\u63D0\u53D6\u516C\u4F17\u53F7\u4FE1\u606F","insert-mpcard":"\u63D2\u5165\u516C\u4F17\u53F7\u540D\u7247","mpcard-not-configured":"\u672A\u914D\u7F6E\u516C\u4F17\u53F7\u540D\u7247\uFF0C\u8BF7\u5148\u5728\u53D1\u5E03\u914D\u7F6E\u4E2D\u7C98\u8D34\u516C\u4F17\u53F7\u540D\u7247HTML\u3002"},modals:{"be-careful":"\u6CE8\u610F\uFF01",cancel:"\u53D6\u6D88",caution:"\u6CE8\u610F\uFF01",confirm:"\u786E\u8BA4",delete:{action:"\u70B9\u51FB\u4E0B\u65B9\u6309\u94AE\u7EE7\u7EED\u5220\u9664\u3002",message:"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u9879\u5417\uFF1F",title:"\u786E\u8BA4\u5220\u9664",warning:"\u6B64\u64CD\u4F5C\u4E0D\u53EF\u64A4\u9500\u3002"},enter:"\u56DE\u8F66",escape:"Esc\u952E",mpcard:{empty:"\u8BF7\u8F93\u5165\u516C\u4F17\u53F7\u540D\u7247\u5185\u5BB9\u3002",hint:"\u8BF7\u5728\u516C\u4F17\u53F7\u540E\u53F0\u590D\u5236\u516C\u4F17\u53F7\u540D\u7247\u7684\u4EE3\u7801\u5757\u5185\u5BB9\uFF0C\u5E76\u7C98\u8D34\u5230\u8FD9\u91CC\u3002",insert:"\u63D2\u5165",placeholder:"\u793A\u4F8B:\n```mpcard\nid: gh_xxx\nheadimg: https://...\nnickname: \u516C\u4F17\u53F7\u540D\u79F0\nsignature: \u516C\u4F17\u53F7\u4ECB\u7ECD\n```",title:"\u63D2\u5165\u516C\u4F17\u53F7\u540D\u7247"},ok:"\u786E\u5B9A",publish:{failed:"\u53D1\u5E03\u5931\u8D25",message:"\u786E\u5B9A\u8981\u53D1\u5E03\u8FD9\u7BC7\u6587\u7AE0\u5417\uFF1F",success:"\u53D1\u5E03\u6210\u529F",title:"\u786E\u8BA4\u53D1\u5E03",warning:"\u5728\u5FAE\u4FE1\u516C\u4F17\u53F7\u5E73\u53F0\u5916\u53D1\u5E03\u53EF\u80FD\u6548\u7387\u8F83\u4F4E\uFF0C\u90E8\u5206\u529F\u80FD\u53EF\u80FD\u65E0\u6CD5\u6B63\u5E38\u4F7F\u7528\uFF08\u5982\u6807\u7B7E\u3001\u63A8\u9001\u5230\u516C\u4F17\u53F7\u7B49\uFF09\u3002"},space:"\u7A7A\u683C"},"publish-config":{title:"\u6587\u7AE0\u53D1\u5E03\u914D\u7F6E","mp-card-settings":"\u516C\u4F17\u53F7\u540D\u7247\u914D\u7F6E","paste-html-guide":"\u8BF7\u4ECE\u6D4F\u89C8\u5668\u63D2\u4EF6\u6216\u516C\u4F17\u53F7\u540E\u53F0\u590D\u5236\u540D\u7247 HTML \u4EE3\u7801 (<mp-common-profile...>) \u5E76\u7C98\u8D34\u5230\u4E0B\u65B9\uFF1A","parse-and-save":"\u89E3\u6790\u5E76\u4FDD\u5B58","card-updated":"\u540D\u7247\u4FE1\u606F\u5DF2\u66F4\u65B0","parse-failed":"\u89E3\u6790\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5 HTML \u4EE3\u7801\u683C\u5F0F","manual-edit":"\u624B\u52A8\u7F16\u8F91 (\u9AD8\u7EA7)","other-settings":"\u5176\u4ED6\u53D1\u5E03\u53C2\u6570","card-tab":"\u516C\u4F17\u53F7\u540D\u7247","options-tab":"\u6587\u7AE0\u53C2\u6570","mpcard-desc":"\u8BF7\u7C98\u8D34\u516C\u4F17\u53F7\u540E\u53F0\u4E2D\u63D2\u5165\u540D\u7247\u540E\u590D\u5236\u5230\u7684 HTML \u4EE3\u7801\u3002","copy-script":"\u590D\u5236\u63D0\u53D6\u811A\u672C","script-copied":"\u811A\u672C\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F\u3002","mpcard-input":"\u540D\u7247 HTML","mpcard-input-desc":"\u7C98\u8D34 <mp-common-profile> \u6216\u5305\u542B\u5B83\u7684 <section> \u4EE3\u7801\u3002","mpcard-empty":"\u5C1A\u672A\u914D\u7F6E\u516C\u4F17\u53F7\u540D\u7247\u3002","save-mpcard":"\u89E3\u6790\u5E76\u4FDD\u5B58","clear-mpcard":"\u6E05\u7A7A\u540D\u7247","no-account":"\u672A\u9009\u62E9\u516C\u4F17\u53F7\u8D26\u53F7\u3002","invalid-mpcard":"\u540D\u7247\u5185\u5BB9\u65E0\u6548\u6216\u7F3A\u5C11 data-id\u3002","mpcard-saved":"\u516C\u4F17\u53F7\u540D\u7247\u5DF2\u4FDD\u5B58\u3002","no-active-file":"\u672A\u627E\u5230\u53EF\u7F16\u8F91\u7684 Markdown \u6587\u4EF6\u3002","field-title":"\u6807\u9898",author:"\u4F5C\u8005",digest:"\u6458\u8981","source-url":"\u539F\u6587\u94FE\u63A5","open-comment":"\u5F00\u542F\u8BC4\u8BBA","only-fans":"\u4EC5\u7C89\u4E1D\u53EF\u8BC4\u8BBA","cover-empty":"\u672A\u8BBE\u7F6E\u5C01\u9762\u56FE\u3002"},render:{"admonition-failed":"<section>Admonition\u6E32\u67D3\u5931\u8D25</section>","callout-failed":"<span>Callout\u6E32\u67D3\u5931\u8D25</span>","charts-failed":"<section>\u56FE\u8868\u6E32\u67D3\u5931\u8D25</section>","excalidraw-failed":"Excalidraw\u6E32\u67D3\u5931\u8D25","faild-canvas-context":"\u83B7\u53D6canvas\u4E0A\u4E0B\u6587\u5931\u8D25\u3002","failed-to-convert-canvas-to-blob":"\u5C06canvas\u8F6C\u6362\u4E3ABlob\u5931\u8D25\u3002","file-not-found":"\u6587\u4EF6\u672A\u627E\u5230\uFF1A{0}","mermaid-failed":"<section>Mermaid\u6E32\u67D3\u5931\u8D25</section>","pdf-crop-failed":"<span>PDF\u88C1\u526A\u5931\u8D25</span>","render-failed":"\u6E32\u67D3\u5931\u8D25\u3002","charts-plugin-not-installed":"\u56FE\u8868\u63D2\u4EF6\u672A\u5B89\u88C5\u3002","mpcard-default-name":"\u516C\u4F17\u53F7\u540D\u79F0","mpcard-default-signature":"\u516C\u4F17\u53F7\u4ECB\u7ECD",rendering:"\u6E32\u67D3\u4E2D...","failed-to-parse-custom-css":"\u5B9A\u5236\u98CE\u683C\u5B58\u5728CSS\u8BED\u6CD5\u9519\u8BEF\uFF1A{0}"},settings:{"account-info":"\u8D26\u53F7\u4FE1\u606F","account-name":"\u516C\u4F17\u53F7\u540D\u79F0","account-name-for-your-wechat-official":"\u5FAE\u4FE1\u516C\u4F17\u53F7\u540D\u79F0","add-ip-address-ipv4-0-to-wechat-mp-ip-wh":"\u5C06IP\u5730\u5740[{0}]\u6DFB\u52A0\u5230\u5FAE\u4FE1\u516C\u4F17\u53F7IP\u767D\u540D\u5355\u3002",appid:"AppID","app-secret":"AppSecret","app-secret-for-your-wechat-official":"\u5FAE\u4FE1\u516C\u4F17\u53F7AppSecret","appid-for-your-wechat-official-account":"\u5FAE\u4FE1\u516C\u4F17\u53F7AppID","be-carefull-delete-account":"\u6CE8\u610F\uFF01\u8FD9\u5C06\u5220\u9664\u8BE5\u8D26\u53F7\u7684\u6240\u6709\u8BBE\u7F6E\u548C\u6570\u636E\u3002","check-if-your-account-setting-is-correct":"\u68C0\u67E5\u8D26\u53F7\u8BBE\u7F6E\u662F\u5426\u6B63\u786E\u3002","click-to-connect-wechat-server":"\u70B9\u51FB\u8FDE\u63A5\u5FAE\u4FE1\u670D\u52A1\u5668","successfully-connected-to-wechat-server":"\u6210\u529F\u8FDE\u63A5\u5230\u5FAE\u4FE1\u670D\u52A1\u5668\u3002",fetching:"\u83B7\u53D6\u4E2D...","failed-to-connect-to-wechat-server":"\u8FDE\u63A5\u5FAE\u4FE1\u670D\u52A1\u5668\u5931\u8D25\u3002","copy-ip-address-to-clipboard":"\u590D\u5236IP\u5730\u5740\u5230\u526A\u8D34\u677F","copy-ip-to-clipboard":"\u590D\u5236IP\u5230\u526A\u8D34\u677F","clipboard-not-supported":"\u5F53\u524D\u5E73\u53F0\u4E0D\u652F\u6301\u526A\u8D34\u677F\u3002","create-new-account":"\u521B\u5EFA\u65B0\u8D26\u53F7","custom-themes":"\u81EA\u5B9A\u4E49\u4E3B\u9898","custom-themes-folder":"\u81EA\u5B9A\u4E49\u4E3B\u9898\u6587\u4EF6\u5939","theme-download-overwrite":"\u4E0B\u8F7D\u4E3B\u9898\u65F6\u8986\u76D6\u540C\u540D\u6587\u4EF6","theme-download-overwrite-desc":"\u5F00\u542F\u5219\u8986\u76D6\u5DF2\u6709\u540C\u540D\u4E3B\u9898\uFF0C\u5173\u95ED\u5219\u8DF3\u8FC7\u3002","general-settings":"\u901A\u7528\u8BBE\u7F6E","default-mpcard-biz-id":"Biz ID\uFF08data-id\uFF09","default-mpcard-biz-id-desc":"HTML \u4E2D\u7684 base64 ID\u3002","delete-account":"\u5220\u9664\u8D26\u53F7","draft-previewer-wechat-id":"\u8349\u7A3F\u9884\u89C8\u8005\u5FAE\u4FE1ID","draft-only-visible-for-the-wechat-user-o":"\u8349\u7A3F\u4EC5\u5BF9\u5FAE\u4FE1\u7528\u6237\u53EF\u89C1\uFF0C\u9700\u516C\u4F17\u53F7\u63A5\u53E3\u6743\u9650\u3002","preview-draft-tooltip":"\u53D1\u9001\u8349\u7A3F\u9884\u89C8\uFF08\u9700\u63A5\u53E3\u6743\u9650\uFF09","enable-real-time-rendering":"\u542F\u7528Markdown\u5185\u5BB9\u7684\u5B9E\u65F6\u6E32\u67D3","real-time-render":"\u5B9E\u65F6\u6E32\u67D3","failed-to-get-wechat-access-token":"\u83B7\u53D6\u5FAE\u4FE1access token\u5931\u8D25\u3002","if-your-device-cannot-get-static-pubic-i":"\u5982\u679C\u60A8\u7684\u8BBE\u5907\u65E0\u6CD5\u83B7\u53D6\u9759\u6001\u516C\u7F51IP\uFF0C\u8BF7\u4F7F\u7528\u6211\u4EEC\u7684\u4E2D\u5FC3\u4EE4\u724C\u670D\u52A1\u5668\u83B7\u53D6\u4EE4\u724C\u3002\u6211\u4EEC\u4E0D\u4F1A\u6EE5\u7528\u60A8\u7684AppID\u6216AppSecret\u3002","appid-secret-guide":"AppID \u4E0E AppSecret \u73B0\u5728\u9700\u8981\u5728\u300C\u5FAE\u4FE1\u5F00\u53D1\u8005\u5E73\u53F0-\u516C\u4F17\u53F7-\u57FA\u7840\u4FE1\u606F\u300D\u4E2D\u83B7\u53D6\u3002","appid-secret-guide-link":"\u6253\u5F00\u5FAE\u4FE1\u5F00\u53D1\u8005\u5E73\u53F0\u83B7\u53D6 AppID / AppSecret","import-account-info":"\u5BFC\u5165\u8D26\u53F7\u4FE1\u606F","export-account-info":"\u5BFC\u51FA\u8D26\u53F7\u4FE1\u606F","import-export-one2mp-account":"\u5BFC\u5165/\u5BFC\u51FA\u8D26\u53F7\u4FE1\u606F","import-or-export-your-account-info-for-b":"\u5BFC\u5165\u6216\u5BFC\u51FA\u60A8\u7684\u8D26\u53F7\u4FE1\u606F\u4EE5\u8FDB\u884C\u5907\u4EFD\u548C\u6062\u590D\u3002","import-settings-title":"\u4ECE\u4ED3\u5E93\u5BFC\u5165\u8BBE\u7F6E","import-settings-hint":"\u8BF7\u9009\u62E9\u4FDD\u5B58\u5728\u4ED3\u5E93\u4E2D\u7684 JSON \u8BBE\u7F6E\u6587\u4EF6\u3002","import-settings-placeholder":"\u8F93\u5165\u6216\u9009\u62E9 JSON \u6587\u4EF6\u8DEF\u5F84","import-settings-confirm":"\u5BFC\u5165","import-settings-empty-path":"\u8BF7\u9009\u62E9\u8BBE\u7F6E\u6587\u4EF6\u3002","import-settings-file-not-found":"\u672A\u627E\u5230\u8BBE\u7F6E\u6587\u4EF6\u3002","invalid-json-file":"\u65E0\u6548\u7684JSON\u6587\u4EF6\u3002","invalid-wewerite-settings-file":"\u65E0\u6548\u7684One2MP\u8BBE\u7F6E\u6587\u4EF6\u3002","ip-copied-to-clipboard":"IP\u5730\u5740\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F\u3002","new-account":"\u65B0\u5EFA\u8D26\u53F7","no-ip-address":"\u65E0IP\u5730\u5740","public-ip-address":"\u516C\u7F51IP\u5730\u5740","select-account":"\u9009\u62E9\u8D26\u53F7","select-wechat-mp-account":"\u9009\u62E9\u5FAE\u4FE1\u516C\u4F17\u53F7\u8D26\u53F7","send-article-to-draft-box-successfully":"\u6587\u7AE0\u6210\u529F\u53D1\u9001\u5230\u8349\u7A3F\u7BB1\u3002","settings-exported":"\u8BBE\u7F6E\u5BFC\u51FA\u6210\u529F\u3002","settings-exporting-failed":"\u8BBE\u7F6E\u5BFC\u51FA\u5931\u8D25\u3002","settings-exported-to-vault":"\u8BBE\u7F6E\u5DF2\u5BFC\u51FA\u5230\u4ED3\u5E93\uFF1A{0}","settings-imported-error":"\u8BBE\u7F6E\u5BFC\u5165\u51FA\u9519\u3002","settings-imported-failed":"\u8BBE\u7F6E\u5BFC\u5165\u5931\u8D25\u3002","settings-imported-successfully":"\u8BBE\u7F6E\u5BFC\u5165\u6210\u529F\u3002","default-mpcard":"\u9ED8\u8BA4\u516C\u4F17\u53F7\u540D\u7247","default-mpcard-desc":"\u4FDD\u5B58\u9ED8\u8BA4\u516C\u4F17\u53F7\u540D\u7247\uFF08\u53EF\u5728\u53F3\u952E\u63D2\u5165\u65F6\u81EA\u52A8\u586B\u5145\uFF09\u3002","default-mpcard-placeholder":"\u7C98\u8D34\u516C\u4F17\u53F7\u540D\u7247\u4EE3\u7801\u5757","default-mpcard-id":"\u8D26\u53F7ID","default-mpcard-id-desc":"\u516C\u4F17\u53F7\u539F\u59CBID\uFF08user_name\uFF09\u3002","default-mpcard-id-placeholder":"gh_xxx","default-mpcard-headimg":"\u5934\u50CFURL","default-mpcard-headimg-desc":"\u516C\u4F17\u53F7\u5934\u50CF\u94FE\u63A5\u3002","default-mpcard-headimg-placeholder":"https://...","default-mpcard-nickname":"\u516C\u4F17\u53F7\u540D\u79F0","default-mpcard-nickname-desc":"\u516C\u4F17\u53F7\u663E\u793A\u540D\u79F0\u3002","default-mpcard-nickname-placeholder":"\u516C\u4F17\u53F7\u540D\u79F0","default-mpcard-signature":"\u516C\u4F17\u53F7\u4ECB\u7ECD","default-mpcard-signature-desc":"\u516C\u4F17\u53F7\u7B80\u4ECB/\u7B7E\u540D\u3002","default-mpcard-signature-placeholder":"\u516C\u4F17\u53F7\u4ECB\u7ECD","default-mpcard-sync":"\u4E00\u952E\u540C\u6B65\u8D26\u53F7\u4FE1\u606F","default-mpcard-sync-success":"\u5DF2\u540C\u6B65\u9ED8\u8BA4\u516C\u4F17\u53F7\u540D\u7247\u3002","default-mpcard-sync-failed":"\u540C\u6B65\u516C\u4F17\u53F7\u540D\u7247\u5931\u8D25\u3002","default-mpcard-sync-partial":"\u4EC5\u540C\u6B65\u5230\u6635\u79F0\u4FE1\u606F\uFF0C\u8BF7\u624B\u52A8\u8865\u5145\u5934\u50CF/\u4ECB\u7ECD\u3002","test-connection":"\u6D4B\u8BD5\u8FDE\u63A5","choose-the-account-to-modify":"\u9009\u62E9\u8981\u4FEE\u6539\u7684\u8D26\u53F7","the-folder-where-your-custom-themes":"\u5B58\u50A8\u81EA\u5B9A\u4E49\u4E3B\u9898\u7684\u6587\u4EF6\u5939\u3002","themes-folder-path":"\u4E3B\u9898\u6587\u4EF6\u5939\u8DEF\u5F84","use-center-token-server":"\u4F7F\u7528\u4E2D\u5FC3\u4EE4\u724C\u670D\u52A1\u5668","wechat-account":"\u5FAE\u4FE1\u516C\u4F17\u53F7\u8D26\u53F7","you-should-add-this-ip-to-ip-whitelist-o":"\u8BF7\u5C06\u6B64IP\u6DFB\u52A0\u5230IP\u767D\u540D\u5355\u4E2D\u3002\u70B9\u51FB\u4E0B\u65B9\u8D26\u53F7\u4FE1\u606F\u4E2D\u7684\u56FE\u7247\u8BBF\u95EE\u201C\u5FAE\u4FE1\u516C\u4F17\u53F7\u5E73\u53F0\u201D\u8FDB\u884C\u8BBE\u7F6E\u3002","your-wechat-official-account":"\u60A8\u7684\u5FAE\u4FE1\u516C\u4F17\u53F7"},views:{"article-header":{"article-title":"\u6587\u7AE0\u6807\u9898","article-title-placeholder":"\u8F93\u5165\u6587\u7AE0\u6807\u9898",author:"\u4F5C\u8005","author-name":"\u4F5C\u8005\u540D\u79F0","comments-description":"\u8BC4\u8BBA\u9ED8\u8BA4\u5173\u95ED\u3002","cover-image":"\u5C01\u9762\u56FE\u7247","cover-image-description":"\u6587\u7AE0\u5FC5\u987B\u5305\u542B\u5C01\u9762\u56FE\u7247\u3002\u53EF\u4ECE\u672C\u5730\u4ED3\u5E93\u62D6\u653E\u56FE\u7247\u6216\u4F7F\u7528\u7F51\u7EDC\u56FE\u7247\u94FE\u63A5\u3002","cover-file-not-supported":"\u79FB\u52A8\u7AEF\u4E0D\u652F\u6301\u672C\u5730\u6587\u4EF6\u5C01\u9762\uFF0C\u8BF7\u4F7F\u7528\u4ED3\u5E93\u56FE\u7247\u6216\u7F51\u7EDC\u94FE\u63A5\u3002","cover-image-mobile-button":"\u9009\u62E9/\u4E0A\u4F20\u5C01\u9762","cover-image-mobile-title":"\u8BBE\u7F6E\u5C01\u9762\u56FE\u7247","cover-image-mobile-vault":"\u4ECE\u4ED3\u5E93\u9009\u62E9\u56FE\u7247","cover-image-mobile-vault-desc":"\u9009\u62E9\u4ED3\u5E93\u4E2D\u7684\u56FE\u7247\u8DEF\u5F84\u3002","cover-image-mobile-vault-placeholder":"\u8F93\u5165\u6216\u9009\u62E9\u56FE\u7247\u8DEF\u5F84","cover-image-mobile-url":"\u4F7F\u7528\u7F51\u7EDC\u56FE\u7247\u94FE\u63A5","cover-image-mobile-url-desc":"\u8F93\u5165\u56FE\u7247\u7684\u7F51\u7EDC\u94FE\u63A5\u3002","cover-image-mobile-required":"\u8BF7\u81F3\u5C11\u63D0\u4F9B\u4E00\u4E2A\u5C01\u9762\u56FE\u7247\u6765\u6E90\u3002","cover-image-mobile-invalid":"\u56FE\u7247\u8DEF\u5F84\u65E0\u6548\uFF0C\u8BF7\u68C0\u67E5\u540E\u518D\u8BD5\u3002","reset-cover-crop":"\u91CD\u7F6E\u88C1\u526A",digest:"\u6458\u8981","digest-text":"\u8F93\u5165\u6458\u8981\u6587\u672C","only-fans-can-comment":"\u4EC5\u7C89\u4E1D\u53EF\u8BC4\u8BBA","only-fans-can-comment-description":"\u9ED8\u8BA4\u6240\u6709\u4EBA\u90FD\u53EF\u8BC4\u8BBA","open-comments":"\u5F00\u542F\u8BC4\u8BBA","testing-button":"\u6D4B\u8BD5\u6309\u94AE",title:"\u6587\u7AE0\u5C5E\u6027"},"delete-draft":"\u5220\u9664\u8349\u7A3F","delete-image":"\u5220\u9664\u56FE\u7247","free-publish":"\u514D\u8D39\u53D1\u5E03","no-title-article":"\u65E0\u6807\u9898\u6587\u7AE0\u3002","other-type-has-not-been-implemented":"\u5176\u4ED6\u7C7B\u578B\u5C1A\u672A\u5B9E\u73B0\u3002","preview-draft":"\u9884\u89C8\u8349\u7A3F",previewer:{"article-copied-to-clipboard":"\u6587\u7AE0\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F\u3002","open-url-not-supported":"\u5F53\u524D\u5E73\u53F0\u4E0D\u652F\u6301\u6253\u5F00\u94FE\u63A5\u3002","article-render-failed":"\u6587\u7AE0\u6E32\u67D3\u5931\u8D25\u3002","article-title":"\u6587\u7AE0\u6807\u9898","copy-article-to-clipboard":"\u590D\u5236\u6587\u7AE0\u5230\u526A\u8D34\u677F","publish-config":"\u53D1\u5E03\u914D\u7F6E","generate-template":"\u751F\u6210\u516C\u4F17\u53F7\u6A21\u677F","file-not-found-path":"\u6587\u4EF6\u672A\u627E\u5230\uFF1A{0}","not-a-markdown-view":"\u4E0D\u662FMarkdown\u89C6\u56FE","please-set-cover-image":"\u8BF7\u8BBE\u7F6E\u5C01\u9762\u56FE\u7247\u3002","preview-draft-missing-id":"\u8BF7\u5148\u53D1\u9001\u5230\u8349\u7A3F\u7BB1\u518D\u9884\u89C8\u3002","preview-draft-missing-wxid":"\u8BF7\u5728\u53D1\u5E03\u914D\u7F6E\u4E2D\u586B\u5199\u8349\u7A3F\u9884\u89C8\u8005\u5FAE\u4FE1ID\u3002","preview-draft-sent":"\u9884\u89C8\u6D88\u606F\u5DF2\u53D1\u9001\u5230\u5FAE\u4FE1\u3002","render-article":"\u6E32\u67D3\u6587\u7AE0","send-article-to-draft-box":"\u53D1\u9001\u6587\u7AE0\u5230\u8349\u7A3F\u7BB1","template-created":"\u516C\u4F17\u53F7\u6A21\u677F\u5DF2\u751F\u6210\u3002","template-file-created":"\u5DF2\u521B\u5EFA\u6A21\u677F\u6587\u4EF6\uFF1Aone2mp-template.md","testing-button":"\u6D4B\u8BD5\u6309\u94AE","to-verify-the-images-in-article":"\u9A8C\u8BC1\u6587\u7AE0\u4E2D\u7684\u56FE\u7247","one2mp-previewer":"O2Any\u9884\u89C8\u5668"},"send-mass-message":"\u7FA4\u53D1\u6D88\u606F","theme-manager":{"default-theme":"\u9ED8\u8BA4\u4E3B\u9898","download-predefined-custom-themes":"\u4E0B\u8F7D\u5B9A\u5236\u4E3B\u9898","download-themes-mobile-not-supported":"\u79FB\u52A8\u7AEF\u6682\u4E0D\u652F\u6301\u4E3B\u9898\u4E0B\u8F7D\u3002","error-downloading-theme":"\u4E0B\u8F7D\u4E3B\u9898\u51FA\u9519","error-downloading-themes":"\u4E0B\u8F7D\u4E3B\u9898\u51FA\u9519\u3002","failed-to-fetch-themes-json-themesrespon":"\u83B7\u53D6themes.json\u5931\u8D25\uFF1A{0}","total-themes-length-themes-downloaded":"\u5171\u4E0B\u8F7D{0}\u4E2A\u4E3B\u9898\u3002","download-started":"\u5F00\u59CB\u4E0B\u8F7D\u4E3B\u9898\uFF0C\u8BF7\u7A0D\u5019\u2026","download-summary":"\u4E3B\u9898\u4E0B\u8F7D\u5B8C\u6210\uFF1A\u6210\u529F {0} \u4E2A\uFF0C\u5931\u8D25 {1} \u4E2A\uFF0C\u8DF3\u8FC7 {2} \u4E2A"}},"wechat-api":{"add-ip-address-ipv4-0-to-wechat-mp-ip-wh":"\u5C06IP\u5730\u5740[{0}]\u6DFB\u52A0\u5230\u5FAE\u4FE1\u516C\u4F17\u53F7IP\u767D\u540D\u5355\u3002","failed-to-get-wechat-access-token":"\u83B7\u53D6\u5FAE\u4FE1access token\u5931\u8D25\u3002","image-size-exceeds-10m":"\u56FE\u7247\u5927\u5C0F\u8D85\u8FC710MB\u9650\u5236","video-size-exceeds-10m":"\u89C6\u9891\u5927\u5C0F\u8D85\u8FC710MB\u9650\u5236","voice-size-exceeds-2m":"\u8BED\u97F3\u5927\u5C0F\u8D85\u8FC72MB\u9650\u5236","select-an-wechat-mp-account-first":"\u8BF7\u5148\u9009\u62E9\u4E00\u4E2A\u5FAE\u4FE1\u516C\u4F17\u53F7\u8D26\u53F7\u3002","send-article-to-draft-box-successfully":"\u6587\u7AE0\u6210\u529F\u53D1\u9001\u5230\u8349\u7A3F\u7BB1\u3002","uploading-material-type":"\u4E0A\u4F20\u7D20\u6750\u7C7B\u578B\uFF1A{0}"}}});function $(r,e){let t=Oe.t(r);if(e!==void 0)for(let n=0;n<e.length;n++)t=t.replace(`{${n}}`,e[n]);return t}var Ka,Fe=j(()=>{za();Ka=require("obsidian");Ha();Va();Oe.init({debug:!1,lng:Ka.moment.locale(),fallbackLng:"en",interpolation:{escapeValue:!1},resources:{en:{translation:Ua},zh:{translation:Wa}}}).catch(r=>{console.error("i18n init failed:",r)});window.$t=$});var dr,Qt,Mi=j(()=>{dr=require("obsidian"),Qt=class extends dr.AbstractInputSuggest{constructor(t,n,i=[]){super(t,n);this.inputEl=n;this.extensions=i}getSuggestions(t){let n=t.toLowerCase();return this.app.vault.getAllLoadedFiles().filter(o=>o instanceof dr.TFile).filter(o=>this.extensions.length&&!this.extensions.includes(o.extension)?!1:o.path.toLowerCase().includes(n))}renderSuggestion(t,n){n.setText(t.path)}selectSuggestion(t){this.inputEl.value=t.path,this.inputEl.trigger("input"),this.close()}}});var vf,Zt,fr=j(()=>{vf=r=>{let e=r.trim();return e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'")?e.slice(1,-1):e},Zt=r=>{if(!r.startsWith("---"))return{data:{},content:r};let e=r.indexOf(`
---`,3);if(e===-1)return{data:{},content:r};let t=r.slice(3,e).trim(),i=r.slice(e+4).replace(/^\r?\n/,""),o={};if(t)for(let a of t.split(/\r?\n/)){let s=a.match(/^([^:#]+):\s*(.*)$/);if(!s)continue;let l=s[1].trim(),c=vf(s[2]);l&&(o[l]=c)}return{data:o,content:i}}});var Qa,Ja=j(()=>{Qa=`/* 00_one2mp.css 
	\u5B9A\u4E49one2mp\u7684\u57FA\u672C\u8272\u7CFB

*/
:root {
  /* \u4E3B\u8272\u7CFB */
  --one2mp-primary: #2c3e50;
  --one2mp-secondary: #3498db;
  --one2mp-accent: #e67e22;
  --one2mp-primary-light: #d0e4ff;
  
  /* \u4E2D\u6027\u8272 */
  --one2mp-bg: transparent;
  --one2mp-bg-alt: var(--one2mp-primary);
  --one2mp-text: #333333;
  --one2mp-text-color: var(--one2mp-text);
  --one2mp-text-alt: #ffffff;
  --one2mp-border:#999999;
  
  /* \u72B6\u6001\u8272 */
  --one2mp-success: #27ae60;
  --one2mp-success: #28a745;
  --one2mp-warning: #ff9800;
  --one2mp-error: #e74c3c;
  --one2mp-danger:  #dc3545;
  --one2mp-blue: #1e3a8a;
}	

:root {
	--one2mp-font-size: 16px;
	--one2mp-line-height: 1.8;
	--one2mp-text-indent: 0;
	--one2mp-letter-spacing: 0;
	--one2mp-word-spacing: 0;
	--one2mp-text-align: left;
	--one2mp-text-decoration: none;
	--one2mp-border-width: 1px;
	--one2mp-border-style: solid;
	--one2mp-border-radius: 4px;
	--one2mp-border-radius-sm: 2px;
	--one2mp-border-radius-lg: 6px;
	--one2mp-border-radius-xl: 8px;
}
body{
	font-size: var(--one2mp-font-size);
	line-height: var(--one2mp-line-height);
	text-indent: var(--one2mp-text-indent);
	letter-spacing: var(--one2mp-letter-spacing);
	word-spacing: var(--one2mp-word-spacing);
	text-align: var(--one2mp-text-align);
	text-decoration: var(--one2mp-text-decoration);
	border-width: var(--one2mp-border-width);
	border-style: var(--one2mp-border-style);
	border-radius: var(--one2mp-border-radius);
} 
`});var Ya,Za=j(()=>{Ya=`/**
* \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u9875\u9762\u7248\u5F0F\u548C\u57FA\u672C\u5B57\u4F53\u98CE\u683C\u7684\u6837\u5F0F
*/

:root {
	/* page  layout */
	--article-max-width: none;
	--article-min-width: 200px;
	--article-padding: 0px;
	--article-margin: 0px;
	--article-background-color: var(--one2mp-bg);
	--article-background-image: none;
	--article-background-repeat: repeat;
	--article-background-size: auto;
	--article-background-position: left top;
	
}

.one2mp {
	max-width: var(--article-max-width);
	min-width: var(--article-min-width);
	padding: var(--article-padding);
	margin: var(--article-margin);
	background-color: var(--article-background-color);
	background-image: var(--article-background-image);
	background-repeat: var(--article-background-repeat);
	background-size: var(--article-background-size);
	background-position: var(--article-background-position);
	
}
`});var es,Xa=j(()=>{es=`/**
 * \u5B9A\u4E49icon,image \u7684\u57FA\u672C\u6837\u5F0F
 */
:root {
	/* --icon-pin: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='%23333' viewBox='0 0 24 24'%3E%3Cpath d='M12 0c.6 0 1 .4 1 1v7h1l2.4-4c.3-.6 1-.7 1.4-.4.5.3.7 1 .4 1.5L16 9l5 5v1h-7v7h-1l-5-5-3.9 2.6c-.5.3-1.1.2-1.4-.3-.3-.5-.2-1.1.3-1.4L8 13l-4-5.3c-.3-.5-.2-1.2.3-1.5.5-.3 1.2-.2 1.5.3L10 9V1c0-.6.4-1 1-1z'/%3E%3C/svg%3E"); */

	/* --icon-pencil: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 24 24'%3E%3Cpath d='M17.25 2.08a1.5 1.5 0 0 1 2.12 0l2.55 2.55a1.5 1.5 0 0 1 0 2.12l-2.34 2.34-4.67-4.67L17.25 2.08zM13.89 4.89l4.67 4.67L7.5 20.61H2v-5.5L13.89 4.89z'/%3E%3C/svg%3E"); */
	/* --icon-clip: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 24 24'%3E%3Cpath d='M16.5 3.5a5.002 5.002 0 0 1 3.536 8.536L10.828 21.244a7 7 0 0 1-9.9-9.9L12.121.15a1 1 0 1 1 1.415 1.414L2.343 12.757a5 5 0 1 0 7.07 7.071l9.207-9.207a3 3 0 1 0-4.243-4.243L5.464 16.464a1 1 0 1 1-1.414-1.414L16.5 3.5z'/%3E%3C/svg%3E"); */
	/* --icon-book:   url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='none' viewBox='0 0 24 24'><rect x='3' y='3' width='14' height='18' rx='2' fill='%23F5F5F5' stroke='%23BDBDBD' stroke-width='1.5'/><line x1='6' y1='6' x2='14' y2='6' stroke='%239E9E9E' stroke-width='1'/><line x1='6' y1='9' x2='14' y2='9' stroke='%239E9E9E' stroke-width='1'/><line x1='6' y1='12' x2='14' y2='12' stroke='%239E9E9E' stroke-width='1'/><path d='M17.5 4.5L19.5 6.5L9 17L6 17L6 14L17.5 4.5Z' fill='%23FFEB3B' stroke='%23FBC02D' stroke-width='1'/><path d='M6 17L6.5 18L7.5 18.5L9 17H6Z' fill='%23795548'/><circle cx='18.5' cy='5.5' r='1' fill='%23E91E63'/></svg>"); */
	/* --bg-img-student: linear-gradient(transparent 29px, #ddd 30px), */




	--icon-pin: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 42'%3E%3Cpath fill='%23ff4444' d='M16 1C9 1 3 7 3 14c0 10 11 21 13 21s13-11 13-21c0-7-6-13-13-13zm0 20a7 7 0 1 1 0-14 7 7 0 0 1 0 14z'/%3E%3C/svg%3E");
	
}
`});var ns,ts=j(()=>{ns=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u5B57\u4F53\u7248\u5F0F\u6837\u5F0F
 */
:root {

	/* typography */
	--article-font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji;
	--article-font-weight: 400;
	--article-word-break: break-word;
	--article-letter-space: 0px;
	--article-text-font-size: 15px;
	--article-text-color: var(--one2mp-text);
	--article-line-height: var(--one2mp-line-height);
	--article-text-align: left;
	--article-text-indent: 0;
	--article-font-style: normal;
}

.one2mp {
	font-family: var(--article-font-family);
	font-weight: var(--article-font-weight);
	word-break: var(--article-word-break);
	letter-spacing: var(--article-letter-space);
	color: var(--article-text-color);
	font-size: var(--article-text-font-size);
	line-height: var(--article-line-height);
	text-align: var(--article-text-align);
	text-indent: var(--article-text-indent);
	font-style: var(--article-font-style); 
}

`});var is,rs=j(()=>{is=`/**
* \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u6B63\u6587\u6837\u5F0F
*/

:root {
	--paragraph-font-family: var(--article-font-family);
	--paragraph-font-weight: var(--article-font-weight);
	--paragraph-font-size: var(--article-text-font-size);
	--paragraph-word-break: var(--article-word-break);
	--paragraph-text-color: var(--article-text-color);
	--paragraph-letter-space: var(--article-letter-space);
	--paragraph-line-height: var(--article-line-height);
	--paragraph-text-align: var(--article-text-align);
	--paragraph-text-indent: var(--article-text-indent);
	--paragraph-font-style: var(--article-font-style);
	--paragraph-margin: var(--article-margin);
}

.one2mp > p {
	font-family: var(--paragraph-font-family);
	font-weight: var(--paragraph-font-weight);
	font-size: var(--paragraph-font-size);
	color: var(--paragraph-text-color);
	word-break: var(--paragraph-word-break);
	letter-spacing: var(--paragraph-letter-space);
	line-height: var(--paragraph-line-height);
	text-align: var(--paragraph-text-align);
	text-indent: var(--paragraph-text-indent);
	font-style: var(--paragraph-font-style);
	margin: var(--paragraph-margin);
}
`});var as,os=j(()=>{as=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u4FEE\u9970\u6027\u6587\u5B57\u7684\u98CE\u683C\uFF1A
 - \u7C97\u4F53

 */
:root {
	--strong-font-family: var(--article-font-family);
	--strong-font-weight: 600;
	--strong-font-style: bold;
	--strong-font-size: var(--article-text-font-size);
	--strong-line-height: var(--article-line-height);
	--strong-letter-spacing: var(--article-letter-space);
	--strong-text-align: var(--article-text-align);
	--strong-text-indent: var(--article-text-indent);
	--strong-color: var(--one2mp-primary);
}

.one2mp strong {
	font-family: var(--strong-font-family);
	font-weight: var(--strong-font-weight);
	font-size: var(--strong-font-size);
	line-height: var(--strong-line-height);
	letter-spacing: var(--strong-letter-spacing);
	text-align: var(--strong-text-align);
	text-indent: var(--strong-text-indent);
	color: var(--strong-color);
}
`});var ls,ss=j(()=>{ls=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u4FEE\u9970\u6027\u6587\u5B57\u7684\u98CE\u683C\uFF1A
 - \u659C\u4F53
 - 

 */
:root {
	--em-font-family: var(--article-font-family);
	--em-font-weight: var(--article-font-weight);
	--em-font-size: var(--article-text-font-size);
	--em-line-height: var(--article-line-height);
	--em-letter-spacing: var(--article-letter-space);
	--em-text-align: var(--article-text-align);
	--em-text-indent: var(--article-text-indent);
	--em-color: var(--article-text-color);
	--em-font-style: italic;
	
}

.one2mp em {
	font-family: var(--em-font-family);
	font-weight: var(--em-font-weight);
	font-size: var(--em-font-size);
	line-height: var(--em-line-height);
	letter-spacing: var(--em-letter-spacing);
	text-align: var(--em-text-align);
	text-indent: var(--em-text-indent);
	color: var(--em-color);
	font-style: var(--em-font-style);
}
`});var us,cs=j(()=>{us=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u4FEE\u9970\u6027\u6587\u5B57\u7684\u98CE\u683C\uFF1A
 - \u659C\u4F53
 - 

 */
:root {
	--u-font-family: var(--article-font-family);
	--u-font-weight: var(--article-font-weight);
	--u-font-size: var(--article-text-font-size);
	--u-line-height: var(--article-line-height);
	--u-letter-spacing: var(--article-letter-space);
	--u-text-align: var(--article-text-align);
	--u-text-indent: var(--article-text-indent);
	--u-color: var(--article-text-color);
	--u-font-style: normal;
	--u-text-decoration: underline;
	--u-text-decoration-thickness: 1px;
	--u-text-decoration-style: solid;
	--u-text-decoration-color: var(--article-text-color);
	--u-underline-offset: 0.2em;
}

.one2mp u {
	font-family: var(--u-font-family);
	font-weight: var(--u-font-weight);
	font-size: var(--u-font-size);
	line-height: var(--u-line-height);
	letter-spacing: var(--u-letter-spacing);
	text-align: var(--u-text-align);
	text-indent: var(--u-text-indent);
	color: var(--u-color);
	font-style: var(--u-font-style);
	text-decoration:  var(--u-text-decoration);
	text-decoration-thickness: var(--u-text-decoration-thickness);
	text-decoration-style: var(--u-text-decoration-style);
	text-decoration-color: var(--u-text-decoration-color);
	text-underline-offset: var(--u-underline-offset)
}
`});var fs,ds=j(()=>{fs=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u4FEE\u9970\u6027\u6587\u5B57\u7684\u98CE\u683C\uFF1A
 - \u659C\u4F53
 - 

 */
:root {
	--del-font-family: var(--article-font-family);
	--del-font-weight: var(--article-font-weight);
	--del-font-size: var(--article-text-font-size);
	--del-line-height: var(--article-line-height);
	--del-letter-spacing: var(--article-letter-space);
	--del-text-align: var(--article-text-align);
	--del-text-indent: var(--article-text-indent);
	--del-color: var(--article-text-color);
	--del-font-style: normal;
	--del-text-decoration: line-through;
	--del-text-decoration-thickness: 1px;
	--del-text-decoration-style: solid;
	--del-text-decoration-color: var(--article-text-color);
}

.one2mp del {
	font-family: var(--del-font-family);
	font-weight: var(--del-font-weight);
	font-size: var(--del-font-size);
	line-height: var(--del-line-height);
	letter-spacing: var(--del-letter-spacing);
	text-align: var(--del-text-align);
	text-indent: var(--del-text-indent);
	color: var(--del-color);
	font-style: var(--del-font-style);
	text-decoration:  var(--del-text-decoration);
	text-decoration-thickness: var(--del-text-decoration-thickness);
	text-decoration-style: var(--del-text-decoration-style);
	text-decoration-color: var(--del-text-decoration-color);
}
`});var Li,hs=j(()=>{Li=`:root{
	--codespan-color: #e5c07b;
	--codespan-background-color: #282c34;
	--codespan-padding: 2px 4px;
	--codespan-border-radius: 4px;
	--codespan-font-size: 0.9rem;
	--codespan-font-family: "Fira Code", "Fira Mono", "Source Code Pro", "Roboto Mono", monospace;
	--codespan-font-weight: 500;
}

.one2mp .one2mp-codespan {
	color: var(--codespan-color, #e5c07b);
	background-color: var(--codespan-background-color, #282c34);
	padding: var(--codespan-padding, 2px);
	border-radius: var(--codespan-border-radius, 4px);
	font-size: var(--codespan-font-size, 0.9rem);
	font-family: var(--codespan-font-family, "Fira Code", "Fira Mono", "Source Code Pro", "Roboto Mono", monospace);
	font-weight: var(--codespan-font-weight, 500);

}
`});var gs,ps=j(()=>{gs=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u6807\u9898\u7684\u57FA\u672C\u6837\u5F0F
 */

:root {
	--heading-font-family: var(--article-font-family);
	--heading-font-weight: 600;
	--heading-color: var(--article-text-color);
	--heading-line-height: 1.5;
	--heading-letter-spacing: var(--article-letter-space);
	--heading-text-align: var(--article-text-align);
	--heading-font-style: normal;
	--heading-margin: 1rem 0;
	--heading-text-decoration-style: none;
	--heading-text-decoration-thickness: 0;
	--heading-text-decoration-color: transparent; 
	--heading-radius: var(--one2mp-radius);
	--heading-border-bottom-width: 0;
	--heading-border-bottom-style: none;
	--heading-border-bottom-color: transparent;
	--heading-padding: 0;
	--heading-display: flex;
	--heading-tail-display: none;
	--heading-tail-content: " ";
	--heading-tail-shadow-color: rgb(239, 235, 233);
	--heading-tail-shadow-height: 0;
	--heading-tail-shadow-width: 0;
	
}

/* \u6807\u9898 */
.one2mp h1,
.one2mp h2,
.one2mp h3,
.one2mp h4,
.one2mp h5,
.one2mp h6 {
	font-family: var(--heading-font-family);
	font-weight: var(--heading-font-weight);
	color: var(--heading-color);
	line-height: var(--heading-line-height);
	letter-spacing: var(--heading-letter-spacing);
	text-align: var(--heading-text-align);
	font-style: var(--heading-font-style);
	margin: var(--heading-margin);
	text-decoration-style: var(--heading-text-decoration-style);
	text-decoration-thickness: var(--heading-text-decoration-thickness);
	text-decoration-color: var(--heading-text-decoration-color);
	display: var(--heading-display);
}

.one2mp .one2mp-heading-prefix {
	display: none;
}
.one2mp .one2mp-heading-outbox {
	display: block;
}
.one2mp .one2mp-heading-leaf {
	display: block;
}
.one2mp .one2mp-heading-tail {
	display: none;
}
`});var vs,ms=j(()=>{vs=`/**
h1  \u6807\u9898
*/

:root {

	--h1-font-family: var(--heading-font-family);
	--h1-font-weight: var(--heading-font-weight);
	--h1-color: var(--heading-color);
	--h1-font-size: 2.2rem;
	--h1-line-height: var(--heading-line-height);
	--h1-letter-spacing: var(--heading-letter-spacing);
	--h1-text-align: var(--heading-text-align);
	--h1-font-style: var(--heading-font-style);
	--h1-text-decoration-style: var(--heading-text-decoration-style);
	--h1-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h1-text-decoration-color: var(--heading-text-decoration-color);
	--h1-margin: var(--heading-margin);
	/* --h1-bg: var(--one2mp-primary); */
	--h1-bg: var(--one2mp-bg);
	--h1-border-bottom-width: var(--heading-border-bottom-width);
	/* --h1-border-bottom-color: var(--h1-bg); */
	--h1-border-bottom-color: var(--heading-border-bottom-color);
	--h1-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h1-prefix-display: none;
	--h1-prefix-color: var(--h1-color);
	--h1-font-style: normal;
	--h1-text-align: var(--h1-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h1-outbox-display: block;
	--h1-outbox-radius: var(--one2mp-border-radius);
	--h1-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h1-leaf-display: block;
	--h1-leaf-padding: var(--heading-padding);
	--h1-leaf-color: var(--h1-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h1-tail-display: inline-block; */
	--h1-tail-display: none;
	--h1-tail-content: " ";
	--h1-tail-vertical-align: bottom;
	--h1-tail-display: var(--heading-tail-display);
	--h1-tail-content: var(--heading-tail-content);
	--h1-tail-shadow-color: var(--heading-tail-shadow-color);
	--h1-tail-shadow-height: var(--heading-tail-shadow-height);
	--h1-tail-shadow-width: var(--heading-tail-shadow-width);
	--h1-display: flex;
}

.one2mp h1 {
	font-family: var(--h1-font-family);
	font-weight: var(--h1-font-weight);
	font-size: var(--h1-font-size);
	line-height: var(--h1-line-height);
	letter-spacing: var(--h1-letter-spacing);
	text-align: var(--h1-text-align);
	color: var(--h1-color);
	font-style: var(--h1-font-style);
	text-decoration-style: var(--h1-text-decoration-style);
	text-decoration-thickness: var(--h1-text-decoration-thickness);
	text-decoration-color: var(--h1-text-decoration-color);
	margin: var(--h1-margin);
	border-bottom-width: var(--h1-border-bottom-width);
	border-bottom-style: var(--h1-border-bottom-style);
	border-bottom-color: var(--h1-border-bottom-color);
	display: var(--h1-display);
}


.one2mp h1 .one2mp-heading-prefix {
	display: var(--h1-prefix-display);
	color: var(--h1-prefix-color);
	font-style: var(--h1-font-style);
	text-align: var(--h1-text-align);

}

.one2mp h1 .one2mp-heading-outbox {
	border-top-right-radius: var(--h1-outbox-radius);
	border-top-left-radius: var(--h1-outbox-radius);
	background-color: var(--h1-bg);
	padding: var(--h1-outbox-padding);
	display: block;
}

.one2mp h1 .one2mp-heading-leaf {
	padding-left: var(--h1-leaf-padding);
	padding-right: var(--h1-leaf-padding);
	font-weight: var(--h1-font-weight);
	display: var(--h1-leaf-display);
	color: var(--h1-leaf-color)
}

.one2mp h1 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h1-tail-display);
	content: var(--h1-tail-content);
	vertical-align: var(--h1-tail-vertical-align);
	border-bottom: var(--h1-tail-shadow-height) solid var(--h1-tail-shadow-color);
	border-right: var(--h1-tail-shadow-width) solid transparent;

}
`});var ws,ys=j(()=>{ws=`/**
h2  \u6807\u9898
*/

:root {
	--h2-font-family: var(--heading-font-family);
	--h2-font-weight: var(--heading-font-weight);
	--h2-color: var(--heading-color);
	--h2-font-size: 2rem;
	--h2-line-height: var(--heading-line-height);
	--h2-letter-spacing: var(--heading-letter-spacing);
	--h2-text-align: var(--heading-text-align);
	--h2-font-style: var(--heading-font-style);
	--h2-text-decoration-style: var(--heading-text-decoration-style);
	--h2-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h2-text-decoration-color: var(--heading-text-decoration-color);
	--h2-margin: var(--heading-margin);
	/* --h2-bg: var(--one2mp-primary); */
	--h2-bg: var(--one2mp-bg);
	--h2-border-bottom-width: var(--heading-border-bottom-width);
	/* --h2-border-bottom-color: var(--h2-bg); */
	--h2-border-bottom-color: var(--heading-border-bottom-color);
	--h2-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h2-prefix-display: none;
	--h2-prefix-color: var(--h2-color);
	--h2-font-style: normal;
	--h2-text-align: var(--h2-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h2-outbox-display: block;
	--h2-outbox-radius: var(--one2mp-border-radius);
	--h2-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h2-leaf-display: block;
	--h2-leaf-padding: var(--heading-padding);
	--h2-leaf-color: var(--h2-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h2-tail-display: inline-block; */
	--h2-tail-display: none;
	--h2-tail-content: " ";
	--h2-tail-vertical-align: bottom;
	--h2-tail-display: var(--heading-tail-display);
	--h2-tail-content: var(--heading-tail-content);
	--h2-tail-shadow-color: var(--heading-tail-shadow-color);
	--h2-tail-shadow-height: var(--heading-tail-shadow-height);
	--h2-tail-shadow-width: var(--heading-tail-shadow-width);
	--h2-display: flex;
}
.one2mp h2 {
	font-family: var(--h2-font-family);
	font-weight: var(--h2-font-weight);
	font-size: var(--h2-font-size);
	line-height: var(--h2-line-height);
	letter-spacing: var(--h2-letter-spacing);
	text-align: var(--h2-text-align);
	color: var(--h2-color);
	font-style: var(--h2-font-style);
	text-decoration-style: var(--h2-text-decoration-style);
	text-decoration-thickness: var(--h2-text-decoration-thickness);
	text-decoration-color: var(--h2-text-decoration-color);
	margin: var(--h2-margin);
	border-bottom-width: var(--h2-border-bottom-width);
	border-bottom-style: var(--h2-border-bottom-style);
	border-bottom-color: var(--h2-border-bottom-color);
	display: var(--h2-display);
}


.one2mp h2 .one2mp-heading-prefix {
	display: var(--h2-prefix-display);
	color: var(--h2-prefix-color);
	font-style: var(--h2-font-style);
	text-align: var(--h2-text-align);

}
.one2mp h2 .one2mp-heading-outbox {
	border-top-right-radius: var(--h2-outbox-radius);
	border-top-left-radius: var(--h2-outbox-radius);
	background-color: var(--h2-bg);
	padding: var(--h2-outbox-padding);
	display: block;
}
.one2mp h2 .one2mp-heading-leaf {
	padding-left: var(--h2-leaf-padding);
	padding-right: var(--h2-leaf-padding);
	font-weight:  var(--h2-font-weight);
	display: var(--h2-leaf-display);
	color: var(--h2-leaf-color)
}
.one2mp h2 .one2mp-heading-tail {
	box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizelegibility;
    display: var(--h2-tail-display);
    content: var(--h2-tail-content);
    vertical-align: var(--h2-tail-vertical-align);
	border-bottom: var(--h2-tail-shadow-height) solid var(--h2-tail-shadow-color);
	border-right: var(--h2-tail-shadow-width) solid transparent;
}
`});var xs,bs=j(()=>{xs=`/**
h3  \u6807\u9898
*/

:root {
	--h3-font-family: var(--heading-font-family);
	--h3-font-weight: var(--heading-font-weight);
	--h3-color: var(--heading-color);
	--h3-font-size: 1.8rem;
	--h3-line-height: var(--heading-line-height);
	--h3-letter-spacing: var(--heading-letter-spacing);
	--h3-text-align: var(--heading-text-align);
	--h3-font-style: var(--heading-font-style);
	--h3-text-decoration-style: var(--heading-text-decoration-style);
	--h3-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h3-text-decoration-color: var(--heading-text-decoration-color);
	--h3-margin: var(--heading-margin);
	/* --h3-bg: var(--one2mp-primary); */
	--h3-bg: var(--one2mp-bg);
	--h3-border-bottom-width: var(--heading-border-bottom-width);
	/* --h3-border-bottom-color: var(--h3-bg); */
	--h3-border-bottom-color: var(--heading-border-bottom-color);
	--h3-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h3-prefix-display: none;
	--h3-prefix-color: var(--h3-color);
	--h3-font-style: normal;
	--h3-text-align: var(--h3-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h3-outbox-display: block;
	--h3-outbox-radius: var(--one2mp-border-radius);
	--h3-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h3-leaf-display: block;
	--h3-leaf-padding: var(--heading-padding);
	--h3-leaf-color: var(--h3-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h3-tail-display: inline-block; */
	--h3-tail-display: none;
	--h3-tail-content: " ";
	--h3-tail-vertical-align: bottom;
	--h3-tail-display: var(--heading-tail-display);
	--h3-tail-content: var(--heading-tail-content);
	--h3-tail-shadow-color: var(--heading-tail-shadow-color);
	--h3-tail-shadow-height: var(--heading-tail-shadow-height);
	--h3-tail-shadow-width: var(--heading-tail-shadow-width);
	--h3-display: flex;
}

.one2mp h3 {
	font-family: var(--h3-font-family);
	font-weight: var(--h3-font-weight);
	font-size: var(--h3-font-size);
	line-height: var(--h3-line-height);
	letter-spacing: var(--h3-letter-spacing);
	text-align: var(--h3-text-align);
	color: var(--h3-color);
	font-style: var(--h3-font-style);
	text-decoration-style: var(--h3-text-decoration-style);
	text-decoration-thickness: var(--h3-text-decoration-thickness);
	text-decoration-color: var(--h3-text-decoration-color);
	margin: var(--h3-margin);
	border-bottom-width: var(--h3-border-bottom-width);
	border-bottom-style: var(--h3-border-bottom-style);
	border-bottom-color: var(--h3-border-bottom-color);
	display: var(--h3-display);
}


.one2mp h3 .one2mp-heading-prefix {
	display: var(--h3-prefix-display);
	color: var(--h3-prefix-color);
	font-style: var(--h3-font-style);
	text-align: var(--h3-text-align);

}

.one2mp h3 .one2mp-heading-outbox {
	border-top-right-radius: var(--h3-outbox-radius);
	border-top-left-radius: var(--h3-outbox-radius);
	background-color: var(--h3-bg);
	padding: var(--h3-outbox-padding);
	display: block;
}

.one2mp h3 .one2mp-heading-leaf {
	padding-left: var(--h3-leaf-padding);
	padding-right: var(--h3-leaf-padding);
	font-weight: var(--h3-font-weight);
	display: var(--h3-leaf-display);
	color: var(--h3-leaf-color)
}

.one2mp h3 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h3-tail-display);
	content: var(--h3-tail-content);
	vertical-align: var(--h3-tail-vertical-align);
	border-bottom: var(--h3-tail-shadow-height) solid var(--h3-tail-shadow-color);
	border-right: var(--h3-tail-shadow-width) solid transparent;
}
`});var ks,_s=j(()=>{ks=`/**
h4  \u6807\u9898
*/

:root {
	--h4-font-family: var(--heading-font-family);
	--h4-font-weight: var(--heading-font-weight);
	--h4-color: var(--heading-color);
	--h4-font-size: 1.5rem;
	--h4-line-height: var(--heading-line-height);
	--h4-letter-spacing: var(--heading-letter-spacing);
	--h4-text-align: var(--heading-text-align);
	--h4-font-style: var(--heading-font-style);
	--h4-text-decoration-style: var(--heading-text-decoration-style);
	--h4-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h4-text-decoration-color: var(--heading-text-decoration-color);
	--h4-margin: var(--heading-margin);
	/* --h4-bg: var(--one2mp-primary); */
	--h4-bg: var(--one2mp-bg);
	--h4-border-bottom-width: var(--heading-border-bottom-width);
	/* --h4-border-bottom-color: var(--h4-bg); */
	--h4-border-bottom-color: var(--heading-border-bottom-color);
	--h4-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h4-prefix-display: none;
	--h4-prefix-color: var(--h4-color);
	--h4-font-style: normal;
	--h4-text-align: var(--h4-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h4-outbox-display: block;
	--h4-outbox-radius: var(--one2mp-border-radius);
	--h4-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h4-leaf-display: block;
	--h4-leaf-padding: var(--heading-padding);
	--h4-leaf-color: var(--h4-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h4-tail-display: inline-block; */
	--h4-tail-display: none;
	--h4-tail-content: " ";
	--h4-tail-vertical-align: bottom;
	--h4-tail-display: var(--heading-tail-display);
	--h4-tail-content: var(--heading-tail-content);
	--h4-tail-shadow-color: var(--heading-tail-shadow-color);
	--h4-tail-shadow-height: var(--heading-tail-shadow-height);
	--h4-tail-shadow-width: var(--heading-tail-shadow-width);
	--h4-display: flex;
}


.one2mp h4 {
	font-family: var(--h4-font-family);
	font-weight: var(--h4-font-weight);
	font-size: var(--h4-font-size);
	line-height: var(--h4-line-height);
	letter-spacing: var(--h4-letter-spacing);
	text-align: var(--h4-text-align);
	color: var(--h4-color);
	font-style: var(--h4-font-style);
	text-decoration-style: var(--h4-text-decoration-style);
	text-decoration-thickness: var(--h4-text-decoration-thickness);
	text-decoration-color: var(--h4-text-decoration-color);
	margin: var(--h4-margin);
	border-bottom-width: var(--h4-border-bottom-width);
	border-bottom-style: var(--h4-border-bottom-style);
	border-bottom-color: var(--h4-border-bottom-color);
	display: var(--h4-display);
}


.one2mp h4 .one2mp-heading-prefix {
	display: var(--h4-prefix-display);
	color: var(--h4-prefix-color);
	font-style: var(--h4-font-style);
	text-align: var(--h4-text-align);

}

.one2mp h4 .one2mp-heading-outbox {
	border-top-right-radius: var(--h4-outbox-radius);
	border-top-left-radius: var(--h4-outbox-radius);
	background-color: var(--h4-bg);
	padding: var(--h4-outbox-padding);
	display: block;
}

.one2mp h4 .one2mp-heading-leaf {
	padding-left: var(--h4-leaf-padding);
	padding-right: var(--h4-leaf-padding);
	font-weight: var(--h4-font-weight);
	display: var(--h4-leaf-display);
	color: var(--h4-leaf-color)
}

.one2mp h4 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h4-tail-display);
	content: var(--h4-tail-content);
	vertical-align: var(--h4-tail-vertical-align);
	border-bottom: var(--h4-tail-shadow-height) solid var(--h4-tail-shadow-color);
	border-right: var(--h4-tail-shadow-width) solid transparent;
}
`});var Cs,Ss=j(()=>{Cs=`/**
h5  \u6807\u9898
*/

:root {
	--h5-font-family: var(--heading-font-family);
	--h5-font-weight: var(--heading-font-weight);
	--h5-color: var(--heading-color);
	--h5-font-size: 1.2rem;
	--h5-line-height: var(--heading-line-height);
	--h5-letter-spacing: var(--heading-letter-spacing);
	--h5-text-align: var(--heading-text-align);
	--h5-font-style: var(--heading-font-style);
	--h5-text-decoration-style: var(--heading-text-decoration-style);
	--h5-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h5-text-decoration-color: var(--heading-text-decoration-color);
	--h5-margin: var(--heading-margin);
	/* --h5-bg: var(--one2mp-primary); */
	--h5-bg: var(--one2mp-bg);
	--h5-border-bottom-width: var(--heading-border-bottom-width);
	/* --h5-border-bottom-color: var(--h5-bg); */
	--h5-border-bottom-color: var(--heading-border-bottom-color);
	--h5-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h5-prefix-display: none;
	--h5-prefix-color: var(--h5-color);
	--h5-font-style: normal;
	--h5-text-align: var(--h5-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h5-outbox-display: block;
	--h5-outbox-radius: var(--one2mp-border-radius);
	--h5-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h5-leaf-display: block;
	--h5-leaf-padding: var(--heading-padding);
	--h5-leaf-color: var(--h5-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h5-tail-display: inline-block; */
	--h5-tail-display: none;
	--h5-tail-content: " ";
	--h5-tail-vertical-align: bottom;
	--h5-tail-display: var(--heading-tail-display);
	--h5-tail-content: var(--heading-tail-content);
	--h5-tail-shadow-color: var(--heading-tail-shadow-color);
	--h5-tail-shadow-height: var(--heading-tail-shadow-height);
	--h5-tail-shadow-width: var(--heading-tail-shadow-width);
	--h5-display: flex;
}

.one2mp h5 {
	font-family: var(--h5-font-family);
	font-weight: var(--h5-font-weight);
	font-size: var(--h5-font-size);
	line-height: var(--h5-line-height);
	letter-spacing: var(--h5-letter-spacing);
	text-align: var(--h5-text-align);
	color: var(--h5-color);
	font-style: var(--h5-font-style);
	text-decoration-style: var(--h5-text-decoration-style);
	text-decoration-thickness: var(--h5-text-decoration-thickness);
	text-decoration-color: var(--h5-text-decoration-color);
	margin: var(--h5-margin);
	border-bottom-width: var(--h5-border-bottom-width);
	border-bottom-style: var(--h5-border-bottom-style);
	border-bottom-color: var(--h5-border-bottom-color);
	display: var(--h5-display);
}


.one2mp h5 .one2mp-heading-prefix {
	display: var(--h5-prefix-display);
	color: var(--h5-prefix-color);
	font-style: var(--h5-font-style);
	text-align: var(--h5-text-align);

}

.one2mp h5 .one2mp-heading-outbox {
	border-top-right-radius: var(--h5-outbox-radius);
	border-top-left-radius: var(--h5-outbox-radius);
	background-color: var(--h5-bg);
	padding: var(--h5-outbox-padding);
	display: block;
}

.one2mp h5 .one2mp-heading-leaf {
	padding-left: var(--h5-leaf-padding);
	padding-right: var(--h5-leaf-padding);
	font-weight: var(--h5-font-weight);
	display: var(--h5-leaf-display);
	color: var(--h5-leaf-color)
}

.one2mp h5 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h5-tail-display);
	content: var(--h5-tail-content);
	vertical-align: var(--h5-tail-vertical-align);
	border-bottom: var(--h5-tail-shadow-height) solid var(--h5-tail-shadow-color);
	border-right: var(--h5-tail-shadow-width) solid transparent;
}
`});var Ts,Es=j(()=>{Ts=`/**
h6  \u6807\u9898
*/

:root {
	--h6-font-family: var(--heading-font-family);
	--h6-font-weight: var(--heading-font-weight);
	--h6-color: var(--heading-color);
	--h6-font-size: 1rem;
	--h6-line-height: var(--heading-line-height);
	--h6-letter-spacing: var(--heading-letter-spacing);
	--h6-text-align: var(--heading-text-align);
	--h6-font-style: var(--heading-font-style);
	--h6-text-decoration-style: var(--heading-text-decoration-style);
	--h6-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h6-text-decoration-color: var(--heading-text-decoration-color);
	--h6-margin: var(--heading-margin);
	/* --h6-bg: var(--one2mp-primary); */
	--h6-bg: var(--one2mp-bg);
	--h6-border-bottom-width: var(--heading-border-bottom-width);
	/* --h6-border-bottom-color: var(--h6-bg); */
	--h6-border-bottom-color: var(--heading-border-bottom-color);
	--h6-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h6-prefix-display: none;
	--h6-prefix-color: var(--h6-color);
	--h6-font-style: normal;
	--h6-text-align: var(--h6-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h6-outbox-display: block;
	--h6-outbox-radius: var(--one2mp-border-radius);
	--h6-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h6-leaf-display: block;
	--h6-leaf-padding: var(--heading-padding);
	--h6-leaf-color: var(--h6-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h6-tail-display: inline-block; */
	--h6-tail-display: none;
	--h6-tail-content: " ";
	--h6-tail-vertical-align: bottom;
	--h6-tail-display: var(--heading-tail-display);
	--h6-tail-content: var(--heading-tail-content);
	--h6-tail-shadow-color: var(--heading-tail-shadow-color);
	--h6-tail-shadow-height: var(--heading-tail-shadow-height);
	--h6-tail-shadow-width: var(--heading-tail-shadow-width);
	--h6-display: flex;
}

.one2mp h6 {
	font-family: var(--h6-font-family);
	font-weight: var(--h6-font-weight);
	font-size: var(--h6-font-size);
	line-height: var(--h6-line-height);
	letter-spacing: var(--h6-letter-spacing);
	text-align: var(--h6-text-align);
	color: var(--h6-color);
	font-style: var(--h6-font-style);
	text-decoration-style: var(--h6-text-decoration-style);
	text-decoration-thickness: var(--h6-text-decoration-thickness);
	text-decoration-color: var(--h6-text-decoration-color);
	margin: var(--h6-margin);
	border-bottom-width: var(--h6-border-bottom-width);
	border-bottom-style: var(--h6-border-bottom-style);
	border-bottom-color: var(--h6-border-bottom-color);
	display: var(--h6-display);
}


.one2mp h6 .one2mp-heading-prefix {
	display: var(--h6-prefix-display);
	color: var(--h6-prefix-color);
	font-style: var(--h6-font-style);
	text-align: var(--h6-text-align);

}

.one2mp h6 .one2mp-heading-outbox {
	border-top-right-radius: var(--h6-outbox-radius);
	border-top-left-radius: var(--h6-outbox-radius);
	background-color: var(--h6-bg);
	padding: var(--h6-outbox-padding);
	display: block;
}

.one2mp h6 .one2mp-heading-leaf {
	padding-left: var(--h6-leaf-padding);
	padding-right: var(--h6-leaf-padding);
	font-weight: var(--h6-font-weight);
	display: var(--h6-leaf-display);
	color: var(--h6-leaf-color)
}

.one2mp h6 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h6-tail-display);
	content: var(--h6-tail-content);
	vertical-align: var(--h6-tail-vertical-align);
	border-bottom: var(--h6-tail-shadow-height) solid var(--h6-tail-shadow-color);
	border-right: var(--h6-tail-shadow-width) solid transparent;
}
`});var Ps,As=j(()=>{Ps=`:root {
	--image-border-radius: var(--one2mp-border-radius);
	--image-border-width: 0px;
	--image-border-color: transparent;
	--image-border-style: solid;
	--image-frame-padding: 0px;
	--image-caption-triangle: hidden;
	--image-caption-triangle-width: 0rem;
	--image-caption-margin-top: -1rem;
	--image-caption-text-color: var(--one2mp-text-color);
	--image-cation-font-size: 0.8rem;
	--image-caption-font-weight: normal;
	--image-caption-font-style: normal;
	--image-caption-font-family: var(--article-font-family);
	--image-caption-line-height: 1.5;
	--image-caption-text-align: center;
}

.one2mp img:not(.one2mp-profile-card img) {
	border-radius: var(--image-border-radius);
	border-width: var(--image-border-width); 
	border-style: var(--image-border-style);
	border-color: var(--image-border-color);
	box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
	margin: 0.0 0;
}

.image-with-caption {
	position: relative;
	display: inline-block;
	text-align: center;
	/* \u9ED8\u8BA4\u5C45\u4E2D\uFF0C\u53EF\u901A\u8FC7\u7C7B\u63A7\u5236 */
	font-family: "Arial", sans-serif;
	border-radius: var(--image-border-radius);
	border-width: var(--image-border-width); 
	border-style: var(--image-border-style);
	border-color: var(--image-border-color);
	box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
	padding: var(--image-frame-padding);
	margin: 0;
}

.image-with-caption img {
	max-width: 100%;
	height: auto;
	display: block;
}

/* \u5BF9\u9F50\u65B9\u5F0F\u63A7\u5236 */
.image-with-caption.align-left {
	text-align: left;
}

.image-with-caption.align-center {
	text-align: center;
}

.image-with-caption.align-right {
	text-align: right;
}

/* \u4F2A\u5143\u7D20\u4F5C\u4E3A\u56FE\u7247\u6807\u9898 */
.image-caption {
	font-size: 0.9rem;
	color: gray;
	position: relative;
	margin-right: auto;
}

.image-caption-row {
	display: flex;
	align-items: center;
	gap: 0.5em;
	/* \u4E09\u89D2\u5F62\u548C\u6587\u5B57\u4E4B\u95F4\u7684\u95F4\u8DDD */
	margin-bottom: 0.5em;
	position: relative;
	top: -0.3rem;
}

.image-with-caption .triangle {
	width: 0;
	height: 0;
	border: var(--image-caption-triangle-width, 0.3rem) solid transparent;
	border-bottom-color: var(--image-border-color, #555);
	position: relative;
	top: -0.3rem;
	margin-left: auto;
}

.one2mp .caption {
	font-size: 0.9rem;
	color: var(--image-border-color, #555);
	position: relative;
	width: 100%;
	text-align: center;
	top: var(--image-caption-margin-top, -2rem);
}

.one2mp .one2mp-image-caption {
	font-size: var(--image-cation-font-size);
	color: var(--image-caption-text-color);
	font-weight: var(--image-caption-font-weight);
	font-style: var(--image-caption-font-style);
	font-family: var(--image-caption-font-family);
	line-height: var(--image-caption-line-height);
	text-align: var(--image-caption-text-align);
	position: relative;
	width: 100%;
	text-align: var(--image-caption-text-align);
	top: var(--image-caption-margin-top, -2rem);
}
`});var $s,Is=j(()=>{$s=`/* list */
:root {
	--list-text-color: var(--article-text-color, #333);
	--list-bg-color: var(--article-bg-color, #fff);
	--list-padding-left: 0.5rem;
	--list-line-height: var(--article-line-height, 1.6);
	--list-ul-style: disc;
	--list-ol-style: decimal;
	--list-item-margin-bottom: 3px;
	--list-margin-top: 3px;
	--list-margin-buton: 3px;
	--list-margin-left: 1rem;
	--list-text-indent: 0;
}
.one2mp ol,
.one2mp ul:not(.one2mp .code-section ul) {
	color: var(--list-text-color, #333);
	/* background-color: var(--list-bg-color, #fff); */
	padding-left: var(--list-padding-left);
	margin-left: var(--list-margin-left, 1rem);
	margin-top: var(--list-margin-top, 0);
	margin-bottom: var(--list-margin-bottom, 0);
	line-height: var(--list-line-height, 1.5);
	text-indent: var(--list-text-indent, 0);

}

.one2mp ol {
	list-style-type: var(--list-ol-style, decimal);
}
.one2mp ul:not(.one2mp .code-section ul) {
	list-style-type: var(--list-ul-style, disc);
}


.one2mp ol li,
.one2mp ul li:not(.one2mp .code-section ul li) {
	margin-bottom: var(--list-item-margin-bottom, 3px);
	line-height: var(--list-line-height, 1.6);
	padding-left: var(--list-padding-left);
}

.one2mp ul li ul {
  list-style-type: circle;
  padding-left: var(--list-padding-left);
}
`});var Ds,Os=j(()=>{Ds=`:root {
  --footnote-color:  #a0a0a0;
  --footnote-hover-color: #666;
  --footnote-font-size: 12px;
  --hr-color: #ccc;
  --hr-height: 1px;
  --hr-margin: 1em 0;
}

.one2mp hr {
	border-bottom: var(--hr-height, 1px) solid var(--hr-color, #eaeaea);
	border-bottom: none;
	border-left: none;
	border-right: none;
	margin-top: 20px;
	margin-bottom: 20px;
}

.one2mp .foot-links hr {
	margin-top: 2rem;
	margin-bottom: 0.5rem;
}

.one2mp .foot-links {
	font-size: var(--footnote-font-size, 12px);
	color: var(--footnote-color, #a0a0a0);
}

/* footnote */
.one2mp .footnote-id {
	color: var(--wechat-footnote-text-color, #999);
	margin-right: 0.5em;

}

.one2mp .footnote {
	font-size: 0.9em;
	font-weight: 300;
	margin-left: 0.5em;
}
`});var Ls,Ms=j(()=>{Ls=`:root {
	--table-border-color: var(--one2mp-border-color, #454545);
	--table-border-width: var(--one2mp-border-width, 1px);
	--table-border-style: var(--one2mp-border-style, solid);
	--table-padding: var(--one2mp-padding, 16px);
	--table-margin: var(--one2mp-margin, 0);
	--table-background-color: var(--one2mp-bg, #fff);
	--table-background-color-alt: #eaeaea;
	--table-background-color-hover: var(--one2mp-bg-alt, #0d5c7e);
	--table-font-size: var(--one2mp-font-size, 16px);
	--table-font-weight: var(--one2mp-font-weight, 400);
	--table-line-height: var(--one2mp-line-height, 1.4);
	--table-text-align: var(--one2mp-text-align, left);
	--table-text-indent: var(--one2mp-text-indent, 0);
	--table-text-color: var(--one2mp-text-color, #333);
	--table-header-color: var(--one2mp-header-color, #333);
	--table-header-background-color: #b9b9b9;
	--table-header-font-weight: var(--one2mp-header-font-weight, 600);
	--table-header-line-height: var(--one2mp-header-line-height, 1.5);
	--table-header-text-align: var(--one2mp-header-text-align, left);
	--table-min-width: var(--one2mp-min-width, 100px);
	--table-container-overflow: auto;
	--tabble-radius: 0;
	--table-width: max-content;
	--tabble-white-space: nowrap;
	--table-layout: fixed;
	--table-collapse: collapse;
	--table-td-max-width: 200px;
	--table-td-min-width: 50px;
	--table-td-text-align: left;
	--table-td-word-break: break-word;
	--table-td-white-space: normal;
}

.one2mp .table-container {
	display: flex;
	width: 100%;
	overflow-x: var(--table-container-overflow);
	padding: 1px;
	box-shadow: 0 4px 8px var(--one2mp-shadow, (0, 0, 0, 0.1));
}

.one2mp table {
	border-collapse: var(--table-collapse);
	width: var(--table-width);
	border-color: var(--table-border-color);
	white-space: var(--tabble-white-space);
	table-layout: var(--table-layout);
}

.one2mp thead tr {
	background-color: var(--table-header-background-color);
	color: var(--table-header-color);
	text-align: var(--table-header-text-align);
	line-height: var(--table-header-line-height);
	font-weight: var(--table-header-font-weight);
}
 
.one2mp thead th {
	background-color: var(--table-header-background-color);
	color: var(--table-header-color);
}

/* table body text */
.one2mp tbody tr{
	line-height: var(--table-line-height, 1.5);
	text-align: var(--table-text-align, left);
	background-color: var(--table-background-color); 
	color: var(--table-text-color);
	font-size: var(--table-font-size);
	font-weight: var(--table-font-weight);
}
/* border */
.one2mp th,
.one2mp tr,
.one2mp td {
	border-color: var(--table-border-color);
	border-width: var(--table-border-width);
	border-style: solid;
	max-width: var(--table-td-max-width);
	min-width: var(--table-td-min-width);
	text-align: var(--table-td-text-align);
	word-break: var(--table-td-word-break);
	white-space: var(--table-td-white-space);
}

.one2mp td {
	background-color: var(--table-background-color);
	color: var(--table-text-color);
}

.one2mp tr:nth-child(even) {
	background-color: var(--table-background-color-alt);
	/* \u5076\u6570\u884C\u80CC\u666F\u8272 */;
}

.one2mp tr:nth-child(even) td {
	background-color: var(--table-background-color-alt);
}

.one2mp thead tr:first-child th:first-child {
	border-top-left-radius: var(--tabble-radius);
}
.one2mp thead tr:first-child th:last-child {
	border-top-right-radius: var(--tabble-radius);
}
.one2mp tbody tr:last-child td:first-child {
	border-bottom-left-radius: var(--tabble-radius);
}
.one2mp tbody tr:last-child td:last-child {
	border-bottom-right-radius: var(--tabble-radius);
}
`});var Fs,Rs=j(()=>{Fs=`/* code section */

:root {
	--code-container-background-color: #282c34;
	/*#1E1E1E;*/
	--code-section-background-color: #282c34;
	--code-color: #abb2bf;
	--code-comment-color: #5c6370;
	--code-keyword-color: #c678dd;
	--code-name-color: #e06c75;
	--code-literal-color: #56b6c2;
	--code-string-color: #98c379;
	--code-variable-color: #d19a66;
	--code-symbol-color: #61aeee;
	--code-class-color: #e6c07b;
	--code-line-height: 1.6;
	--code-line-color: rgb(253, 247, 247);
	--code-font-size: 0.9rem;
	--code-padding: 8px;
	--code-border-radius: 6px;
	--code-banner-display: inline-block;
	--code-border-color: rgb(166, 166, 166);
	--code-border-width: 0.5px;
}

.one2mp code {
	display: inline;
	color: var(--code-color, rgb(153, 153, 153));
	line-height: var(--code-line-height, 1.6);
}

.one2mp .code-container {
	display: flex;
	flex-direction: column;
	border-radius: var(--code-border-radius, 4px);
	background: var(--code-container-background-color, #1E1E1E);
	box-shadow: rgba(0, 0, 0, 0.55) 0px 10px 10px -10px;
	border-width: var(--code-border-width);
	border-style: solid;
	border-color: var(--code-border-color);
}


.one2mp .code-section-banner {
	background-image: url('https://mmbiz.qpic.cn/mmbiz_svg/QAm7hEbaujTQuIH8VVl7W7PicH14grAZxd7oUx579CB2wpytwlLSpiaq2DXBpNUz8R6ckkAuO8tBLr52XjAsvR67mh3oibs2dYK/640?wx_fmt=svg&from=appmsg&tp=webp&wxfrom=15&wx_lazy=1');
	background-position: 10px 10px;
	background-size: 40px auto;
	background-repeat: no-repeat;
	display: var(--code-banner-display, inline-block);
	height: 32px;
	width: 100%;
	border-bottom: solid 0.5px var(--code-color, rgb(153, 153, 153));
}

.one2mp .code-section {
	display: flex;
	flex-grow: 1;
	font-size: var(--code-font-size, 0.9rem);
	line-height: var(--code-line-height, 1.6);
	border-radius: var(--code-border-radius, 4px);
}

.one2mp .code-section pre {
	position: relative;
	padding: 2px;
	margin: 0;
	flex: 1;
	overflow: auto;
	border-bottom-left-radius: var(--code-border-radius, 4px);
	border-bottom-right-radius: var(--code-border-radius, 4px);

}


.one2mp .code-section code {
	display: block;
	padding: 10px 5px !important;
	padding-left: .5em;
	font-family: Consolas, Monaco, Menlo, monospace;
	white-space: pre-wrap !important;
	word-wrap: break-word !important;
	overflow-x: auto;
}

.one2mp .code-section ul {
	padding-top: var(--code-padding, 8px);
	padding-bottom: var(--code-padding, 8px);
	position: relative;
	overflow: hidden;
	background: var(--code-section-background-color, #282c34) !important;
	display: flex;
	flex-direction: column;
	flex-shrink: 0;
	counter-reset: line;
	margin: 0;
	padding: 10px 0 0 0;
	white-space: normal;
	width: fit-content;
	user-select: none;
	border-right: solid 0.5px rgb(166, 166, 166);
	padding-right: 5px;
	color: var(--code-line-color, green);
	border-bottom-left-radius: var(--code-border-radius, 4px);
}

.one2mp .code-section ul>li {
	position: relative;
	margin: 0;
	display: list-item;
	text-align: right;
	text-wrap: nowrap;
	line-height: var(--code-line-height, 1.6);
	font-size: var(--code-font-size, 0.9rem);
	font-family: Menlo-Regular, Menlo, Monaco, Consolas, "Courier New", monospace;
	list-style-type: none;
	color: var(--code-line-color, red);
	padding-left: 1rem;

}

.one2mp .code-section ul>li::marker {
	content: none;
}

.one2mp pre code .hljs {
	display: block;
	overflow-x: auto;
	padding: 1em
}

.one2mp code .hljs {
	padding: 3px 5px
}

/*
  
  Atom One Dark by Daniel Gamage
  Original One Dark Syntax theme from https://github.com/atom/one-dark-syntax
  
  base:    #282c34
  mono-1:  #abb2bf
  mono-2:  #818896
  mono-3:  #5c6370
  hue-1:   #56b6c2
  hue-2:   #61aeee
  hue-3:   #c678dd
  hue-4:   #98c379
  hue-5:   #e06c75
  hue-5-2: #be5046
  hue-6:   #d19a66
  hue-6-2: #e6c07b
  
  */
.one2mp .hljs {
	color: var(--code-color, #abb2bf);
	background: var(--code-section-background-color, #282c34)
}

.one2mp .hljs-comment,
.one2mp .hljs-quote {
	color: var(--code-color, #5c6370);
	font-style: italic
}

.one2mp .hljs-doctag,
.one2mp .hljs-keyword,
.one2mp .hljs-formula {
	color: var(--code-keyword-color, #c678dd)
}

.one2mp .hljs-section,
.one2mp .hljs-name,
.one2mp .hljs-selector-tag,
.one2mp .hljs-deletion,
.one2mp .hljs-subst {
	color: var(--code-name-color, #e06c75)
}

.one2mp .hljs-literal {
	color: var(--code-literal-color, #56b6c2)
}

.one2mp .hljs-string,
.one2mp .hljs-regexp,
.one2mp .hljs-addition,
.one2mp .hljs-attribute,
.one2mp .hljs-meta .one2mp .hljs-string {
	color: var(--code-string-color, #98c379)
}

.one2mp .hljs-attr,
.one2mp .hljs-variable,
.one2mp .hljs-template-variable,
.one2mp .hljs-type,
.one2mp .hljs-selector-class,
.one2mp .hljs-selector-attr,
.one2mp .hljs-selector-pseudo,
.one2mp .hljs-number {
	color: var(--code-variable-color, #d19a66)
}

.one2mp .hljs-symbol,
.one2mp .hljs-bullet,
.one2mp .hljs-link,
.one2mp .hljs-meta,
.one2mp .hljs-selector-id,
.one2mp .hljs-title {
	color: var(--code-symbol-color, #61aeee)
}

.one2mp .hljs-built_in,
.one2mp .hljs-title.class_,
.one2mp .hljs-class .one2mp .hljs-title {
	color: var (--code-class-color, #e6c07b)
}

.one2mp .hljs-emphasis {
	font-style: italic
}

.one2mp .hljs-strong {
	font-weight: bold
}

.one2mp .hljs-link {
	text-decoration: underline
}`});var qs,Bs=j(()=>{qs=`:root {
	--blockquote-color: rgba(0, 0, 0, 0.5);
	--blockquote-border-color:  var(--blockquote-color);
	--blockquote-border-width: 0px;
	--blockquote-border-style: solid;	
	--blockquote-border-radius: 4px;
	--blockquote-padding: 20px;
	--blockquote-margin: 0px;
	--blockquote-font-size: 1em;
	--blockquote-background-color: rgba(0, 0, 0, 0.05);
	--blockquote-inner-background-color: var(--blockquote-background-color);
	--blockquote-font-family: var(--article-font-family);
	--blockquote-font-style: italic;
}

.one2mp blockquote {
	border-left-width: var(--blockquote-border-width);
	border-left-style: var(--blockquote-border-style);
	border-left-color: var(--blockquote-border-color);
	border-radius: var(--blockquote-border-radius);
	padding: var(--blockquote-padding);
	margin: var(--blockquote-margin);
	color: var(--one2mp-secondary);	
	background-color: var(--blockquote-background-color);
	line-height: var(--one2mp-line-height);
	text-indent: 0;
	color: var(--blockquote-color);
	font-family: var(--blockquote-font-family);
	font-size: var(--blockquote-font-size);
	font-style: var(--blockquote-font-style);
}

.blockquote-inner {
  background: transparent;
  padding: 0px;
  transform: skew(0.0deg, 0.0deg); /* \u62B5\u6D88\u5916\u5C42\u503E\u659C\uFF0C\u8BA9\u5185\u5BB9\u4E0D\u6B6A */
}

/* .icon-pin {
  position: absolute;
  top: -12px;
  right: -12px;
  width: 24px;
  height: 24px;
  background-image: var(--icon-book);
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  pointer-events: none;
  visibility: visible
} */
`});var js,Ns=j(()=>{js=`:root{
	--link-color: var(--one2mp-secondary, rgb(0, 102, 204));
	--link-hover-color: var(--one2mp-primary-light, rgb(0, 128, 255));
	--link-active-color: var(--one2mp-primary, rgb(0, 128, 255));
}


.one2mp a {
	font-weight: 500;
	text-decoration: none;
	color: var(--link-color, rgb(0, 102, 204));
}

.one2mp a:hover,
.one2mp a:active {
	border-bottom: 1.5px solid var(--link-color, rgb(0, 102, 204));
	color: var(--link-hover-color, rgb(0, 128, 255));
}

.one2mp a:before {
	content: "\u21F2";
}
`});var Hs,zs=j(()=>{Hs=`/* Callout Styles */

:root {
    --callout-background-color: rgba(8, 109, 221, 0.04);
	--callout-box-shadow: 0 8px 16px rgba(0, 0, 0, 0.16);
    --callout-border-color: rgba(8, 109, 221, 0.18);
	--callout-border-radius: var(--one2mp-border-radius, 4px);
	--callout-border-width: 0px;
    --callout-icon-color: rgba(8, 109, 221, 0.5);
    --callout-icon-size: 1.25em;
    --callout-icon-margin: 0.25em;
    --callout-text-color: var(--article-text-color, #333333);
	--cursor: pointer;
}

.one2mp-callout {
    overflow: hidden;
    border-style: solid;
    border-color: var(--callout-border-color, rgba(8, 109, 221, 0.25));
    border-width: var(--callout-border-width, 0px);
    border-radius: var(--callout-border-radius, 4px);
    margin: 1em 0;
    background-color: var(--callout-background-color, rgba(8, 109, 221, 0.1));
    padding: 12px 12px 12px 24px;
    opacity: 1;
    filter: none;
}

.one2mp-callout:not(.admonition).drop-shadow {
    box-shadow: var(--callout-box-shadow, 0 4px 8px  rgba(0, 0, 0, 0.2));
}

.one2mp-callout:not(.admonition) .no-title {
    display: none;
}


@supports selector(:has(*)) {

    :has(.one2mp-callout .callout-title .callout-title-inner:dir(rtl)),
    .one2mp-callout:has(> .callout-title .callout-title-inner:dir(rtl)) {
        direction: rtl;
    }

    :has(.one2mp-callout .callout-title .callout-title-inner:dir(rtl))>.callout-title,
    .one2mp-callout:has(> .callout-title .callout-title-inner:dir(rtl))>.callout-title {
        direction: rtl;
        --direction: -1;
    }

    :has(.one2mp-callout .callout-title .callout-title-inner:dir(rtl))>.callout-title .callout-icon svg.svg-icon,
    .one2mp-callout:has(> .callout-title .callout-title-inner:dir(rtl))>.callout-title .callout-icon svg.svg-icon {
        transform: scale(-1, 1);
    }
}

.one2mp-callout {
    background-color: var(--callout-background-color, rgba(8, 109, 221, 0.1));
    box-shadow: var(--callout-box-shadow, 0 4px 8px  rgba(0, 0, 0, 0.2));
}


.callout-icon {
    height: 1em;
}

.one2mp-callout[data-callout="summary"] {
    background-color: rgba(0, 191, 188, 0.04);
}
.one2mp-callout[data-callout="abstract"],
.one2mp-callout[data-callout="tldr"] {
    background-color: rgba(0, 176, 255, 0.04);
}

.one2mp-callout[data-callout="info"] {
    background-color: rgba(8, 109, 221, 0.04);
}

.one2mp-callout[data-callout="todo"] {
    background-color: rgba(8, 109, 221, 0.04);
}

.one2mp-callout[data-callout="important"] {
    background-color: rgba(8, 191, 188, 0.04);
}

.one2mp-callout[data-callout="tip"],
.one2mp-callout[data-callout="hint"] {
    background-color: rgba(8, 191, 188, 0.04);
}

.one2mp-callout[data-callout="success"],
.one2mp-callout[data-callout="check"],
.one2mp-callout[data-callout="done"] {
    background-color: rgba(8, 185, 78, 0.04);

}

.one2mp-callout[data-callout="question"],
.one2mp-callout[data-callout="help"],
.one2mp-callout[data-callout="faq"] {
    background-color: rgba(236, 117, 0, 0.04);
}

.one2mp-callout[data-callout="warning"],
.one2mp-callout[data-callout="caution"],
.one2mp-callout[data-callout="attention"] {
    background-color: rgba(236, 117, 0, 0.04);
}

.one2mp-callout[data-callout="failure"],
.one2mp-callout[data-callout="fail"],
.one2mp-callout[data-callout="missing"] {
    background-color: rgba(233, 49, 71, 0.04);
}

.one2mp-callout[data-callout="danger"],
.one2mp-callout[data-callout="error"] {
    background-color: rgba(233, 49, 71, 0.04);
}

.one2mp-callout[data-callout="bug"] {
    background-color: rgba(233, 49, 71, 0.04);
}

.one2mp-callout[data-callout="example"] {
    background-color: rgba(120, 82, 238, 0.04);
}

.one2mp-callout[data-callout="quote"],
.one2mp-callout[data-callout="cite"] {
    background-color: rgba(158, 158, 158, 0.04);
}

/* title start */
.one2mp-callout.is-collapsible  {
    cursor: var(--cursor);
}


.callout-title {
    padding: 0;
    display: flex;
    gap: 4px;
    font-size: inherit;
    line-height: 1.3;
    align-items: flex-start;
    color: rgb(8, 109, 221);
}


.one2mp-callout[data-callout="summary"] .callout-title  {
    color: rgb(0, 191, 188);
}
.one2mp-callout[data-callout="abstract"] .callout-title ,
.one2mp-callout[data-callout="tldr"] .callout-title {
    color: rgb(0, 176, 255);
}

.one2mp-callout[data-callout="info"] .callout-title {
    color: rgb(8, 109, 221);
}

.one2mp-callout[data-callout="todo"] .callout-title {
    color: rgb(8, 109, 221);
}

.one2mp-callout[data-callout="important"] .callout-title {
    color: rgb(8, 191, 188);
}

.one2mp-callout[data-callout="tip"] .callout-title ,
.one2mp-callout[data-callout="hint"] .callout-title {
    color: rgb(8, 191, 188);
}

.one2mp-callout[data-callout="success"] .callout-title ,
.one2mp-callout[data-callout="check"] .callout-title ,
.one2mp-callout[data-callout="done"] .callout-title {
    color: rgb(8, 185, 78);

}

.one2mp-callout[data-callout="question"] .callout-title ,
.one2mp-callout[data-callout="help"] .callout-title ,
.one2mp-callout[data-callout="faq"] .callout-title {
    color: rgb(236, 117, 0);
}

.one2mp-callout[data-callout="warning"] .callout-title ,
.one2mp-callout[data-callout="caution"] .callout-title ,
.one2mp-callout[data-callout="attention"] .callout-title {
    color: rgb(236, 117, 0);
}

.one2mp-callout[data-callout="failure"] .callout-title ,
.one2mp-callout[data-callout="fail"] .callout-title ,
.one2mp-callout[data-callout="missing"] .callout-title {
    color: rgb(233, 49, 71);
}

.one2mp-callout[data-callout="danger"]  .callout-title ,
.one2mp-callout[data-callout="error"] .callout-title {
    color: rgb(233, 49, 71);
}

.one2mp-callout[data-callout="bug"] .callout-title {
    color: rgb(233, 49, 71);
}

.one2mp-callout[data-callout="example"] .callout-title {
    color: rgb(120, 82, 238);
}

.one2mp-callout[data-callout="quote"] .callout-title ,
.one2mp-callout[data-callout="cite"]  .callout-title {
    color: rgb(158, 158, 158);
}

/* title end */
.callout-content {
    overflow-x: auto;
    padding: 0; 
    background-color: transparent;
    opacity: 1;
    filter: none;
}

.one2mp-callout .callout-content p,
.one2mp-callout .callout-content li,
.one2mp-callout .callout-content span,
.one2mp-callout .callout-content strong,
.one2mp-callout .callout-content em,
.one2mp-callout .callout-content a,
.one2mp-callout .callout-content code,
.one2mp-callout .callout-text {
    color: var(--callout-text-color, #333333);
    opacity: 1;
}

.one2mp-callout .callout-text {
    color: var(--article-text-color, #333333) !important;
    opacity: 1 !important;
}

.callout-content .one2mp-callout {
    margin-top: 20px;
}

.callout-icon {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
}



.callout-title-inner {
    font-weight: 600; 
    color: inherit; 
}

.callout-fold {
    display: flex;
    align-items: center;
    padding-inline-end: 8px; 
}


.callout-fold .svg-icon {
    transition: transform 100ms ease-in-out;
}

.callout-fold.is-collapsed .svg-icon {
    transform: rotate(-1 * -1 * 90deg);
}
`});var Vs,Us=j(()=>{Vs=`.admonition {
    margin-top: 1.5em;
    margin-bottom: 1.5em;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.admonition.no-title .admonition-content {
    margin-top: 0;
    margin-bottom: 0;
}

.admonition li.task-list-item.is-checked p {
    text-decoration: line-through;
}

.admonition.no-drop {
    box-shadow: none;
}

.admonition.no-drop>.admonition-title.no-title+.admonition-content,
.admonition.no-drop .admonition .admonition-title.no-title+.admonition-content {
    margin-top: 0;
    margin-bottom: 0;
}

.admonition.no-drop .admonition .admonition-content {
    border-right: .0625em solid rgba(233, 233,123, .2);
    border-bottom: .0625em solid rgba(233, 233,123, .2);
}

.admonition.no-drop .admonition .admonition-title.no-title+.admonition-content {
    border-top: .0625em solid rgba(233, 233,123, .2);
}

:is(.markdown-source-view.mod-cm6) .admonition .math-block>mjx-container,
:is(.markdown-reading-view) .admonition .math-block>mjx-container {
    display: block;
    text-align: center;
    padding: 1em;
}

:is(.markdown-reading-view) .admonition .math-block>mjx-container {
    padding: .0625em;
}

*:not(.is-live-preview) .admonition.no-content {
    display: none;
}

.admonition {
    margin-top: 0px;
    margin-bottom: .75em;
}

.admonition.no-content {
    opacity: .1;
}

.admonition-content p {
    line-height: inherit;
    margin: revert;
}

.admonition-content p br {
    display: initial;
}

.admonition-content p ul>li>ul {
    border-left: 2px;
    border-left-color: #ababab;
    border-left-style: solid;
}

.admonition-content:first-child {
    margin-top: .8em;
}

.admonition-content:last-child {
    margin-bottom: .8em;
}

.admonition-title.no-title {
    display: none;
}

.admonition-title:hover+.admonition-content .admonition-content-copy {
    opacity: .7;
}

.admonition-content,
.callout-content {
    position: relative;
}

.admonition-content-copy {
    color: #ababab;
    cursor: pointer;
    opacity: 0;
    position: absolute;
    margin: .375em;
    right: 0;
    top: 0;
    transition: .3s opacity ease-in;
}

.admonition-content-copy:hover {
    color: inherit;
}

.admonition:hover .admonition-content-copy,
.callout:hover .admonition-content-copy,
.admonition-content-copy:hover {
    opacity: 1;
}


.admonition-content ul,
.admonition-content ol {
    white-space: normal;
}

.admonition-title-icon,
.fa {
    height: 1.2em;
    width: 1.2em;
}
`});var Ks,Ws=j(()=>{Ks=`.one2mp .inline-math{
    display: inline-block;
    padding: 0 0.5rem;
}

.one2mp .block-math {
    display: flex;
    width: 100%;
    overflow: auto;
    padding: 0.5rem;
}

.one2mp .block-math svg {
    width: fit-content;
    margin: auto;
}
`});var Js,Gs=j(()=>{Js=`.one2mp .mermaid {
    display: flex;
    flex-direction: column;
    padding: 0;
    border: none;
    border-radius: 0;
    background: transparent;
    box-shadow: none;
}

.one2mp .mermaid image {
    width: 100%;
    margin: auto;
}

.one2mp .mermaid img {
    border: none;
    border-radius: 0;
    box-shadow: none;
    display: block;
}
`});var Zs,Qs=j(()=>{Zs=`.one2mp .charts {
    display: flex;
    flex-direction: column;
    padding: 3px;
    border: solid 1px #ccc;
    border-radius: 3px;
}

.one2mp .charts image
 {
    width: 100%;
    margin: auto;
}
`});var Xs,Ys=j(()=>{Xs=`/* icon */

.obsidian-icon {
	font-size: inherit;
	display: inline-block;
	width: 1.8rem;
	text-align: center;
}

/* p .obsidian-icon {
	width: 1.75em
} */

.obsidian-icon.react-icon>svg {
	vertical-align: middle;
	margin-bottom: 3px;
}

.obsidian-icon.react-icon{
	width: 1.8rem;;
}
`});var tl,el=j(()=>{tl=`/* summary */
.one2mp details {
	border: none;
	outline: none;
	/* border-left: 4px solid #3eaf7c; */
	padding-left: var(--wechat-collapse-padding, 1em);
	margin-left: var(--wechat-collapse-margin, 0);
	background-color: var(--wechat-collapse-bg-color, #f5f5f5);
}

.one2mp details summary {
	cursor: pointer;
	border: none;
	outline: none;
	margin: 0px -17px;
}

.one2mp details summary::-webkit-details-marker {
	color: var(--wechat-collapse-bg-color, #f5f5f5);
}
`});var rl,nl=j(()=>{rl=`
    :root{
		--profile-background-color: #fafafa;
		--profile-title-color: #1f1f1f;
		--profile-description-color: #333;
		--profile-meta-color: #666;
		--profile-border-color: #eee;
		--profile-footer-color: #999;
		--profile-footer-bg-color: #fafafa;
		--profile-avatar-size: 64px;
		--profile-width: 600px;
		--profile-radius: 12px;
	}
	.one2mp-profile-card {
      background-color: var(--profile-background-color, #fff);
      border-radius: var(--profile-radius, 12px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
      overflow: hidden;
      width: var(--profile-width, 600px);
    }

    .one2mp-profile-card .card-main {
      display: flex;
      align-items: center;
      padding: 20px;
    }

    .one2mp-profile-card .avatar {
      width: var(--profile-avatar-size, 64px);
      height: var(--profile-avatar-size, 64px);
      border-radius: 50%;
      overflow: hidden;
      margin-right: 16px;
      flex-shrink: 0;
    }

    .one2mp-profile-card .avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .one2mp-profile-card .content {
      flex-grow: 1;
    }

    .one2mp-profile-card .title {
      font-size: 20px;
      font-weight: bold;
      color: var(--profile-title-color, #1f1f1f);
      margin-bottom: 6px;
    }

    .one2mp-profile-card .description {
      font-size: 16px;
      color: var(--profile-description-color, #555);
      margin-bottom: 8px;
    }

    .one2mp-profile-card .meta {
      font-size: 14px;
      color: var(--profile-meta-color, #888);
    }

    .one2mp-profile-card .arrow {
      font-size: 20px;
      color: #999;
      margin-left: 12px;
    }

    .one2mp-profile-card .card-footer {
      background-color: var(--profile-footer-bg-color, #f7f7f7);
      padding: 10px 20px;
      font-size: 14px;
      color: var(--profile-footer-color, #999);
      border-top: 1px solid var(--profile-border-color, #eee);
    }
`});var ol,il=j(()=>{ol=`.one2mp-mpcard-wrapper {
  margin: 20px 20px;
  background-color: rgb(250, 250, 250);
  padding: 10px 20px;
  border-radius: 10px;
}

.one2mp-mpcard-content {
  display: flex;
  align-items: center;
}

.one2mp-mpcard-headimg {
  border: none !important;
  border-radius: 27px !important;
  box-shadow: none !important;
  width: 54px !important;
  height: 54px !important;
  margin: 0 !important;
}

.one2mp-mpcard-info {
  margin-left: 10px;
}

.one2mp-mpcard-nickname {
  font-size: 17px;
  font-weight: 500;
  color: rgba(0, 0, 0, 0.9);
}

.one2mp-mpcard-signature {
  font-size: 14px;
  color: rgba(0, 0, 0, 0.55);
}

.one2mp-mpcard-foot {
  margin-top: 20px;
  padding-top: 10px;
  border-top: 1px solid #ececec;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.3);
}
`});var al,Zf,Yf,Xf,hr,sl=j(()=>{Ja();Za();Xa();ts();rs();os();ss();cs();ds();hs();ps();ms();ys();bs();_s();Ss();Es();As();Is();Os();Ms();Rs();Bs();Ns();zs();Us();Ws();Gs();Qs();Ys();el();nl();il();al=require("obsidian");Fe();Zf=[Qa,Ya,es,ns,is,as,ls,us,fs,Li,gs,vs,ws,xs,ks,Cs,Ts,Ps,$s,Ds,Ls,Fs,qs,js,Hs,Vs,Ks,Js,Zs,Xs,Li,tl,rl,ol],Yf=["appmsg_","wx_","wx-","common-webchat","weui-"],Xf=r=>Yf.some(e=>r.startsWith(e)),hr=class{constructor(){this.vars=new Map;this.rules=new Map}async init(e){await this.buildBaseCSS();try{this.mergeCssText(e)}catch(t){new al.Notice($("render.failed-to-parse-custom-css",[t])),console.error(t)}}async buildBaseCSS(){this.vars.clear(),this.rules.clear();for(let e of Zf)this.mergeCssText(e)}resolveCssVars(e,t,n=0){let o=/var\(\s*--([\w-]+)(?:\s*,\s*((?:\((?:[^()]|\([^()]*\))*\)|[^)\s]|[\s\S])*?))?\s*\)/g,a=e,s;do s=!1,a=a.replace(o,(l,c,u)=>{let d=`--${c}`;if(t.has(d)){let f=t.get(d);return s=!0,f}else return u!==void 0?(s=!0,u):(console.warn(`Variable ${d} not found and no fallback provided`),"")}),n++;while(s&&n<10);return a}mergeCssText(e){if(!e||!e.trim())return;let t=this.parseCssText(e);this.mergeVars(t.vars),this.mergeRules(t.rules)}mergeVars(e){for(let[t,n]of e.entries())this.vars.set(t,n)}mergeRules(e){for(let[t,n]of e.entries()){let i=this.rules.get(t);i||(i=new Map,this.rules.set(t,i));for(let[o,a]of n.entries()){let s=i.get(o);(s===void 0||!s.important||a.important)&&i.set(o,a)}}}parseCssText(e){let t=new Map,n=new Map,i=this.parseWithCssSheet(e);return i?(this.collectRulesFromList(i.cssRules,t,n),{vars:t,rules:n}):(this.parseWithFallback(e,t,n),{vars:t,rules:n})}parseWithCssSheet(e){if(typeof CSSStyleSheet=="undefined")return null;let t=new CSSStyleSheet;try{return t.replaceSync(e),t}catch(n){return console.debug("CSSStyleSheet \u89E3\u6790\u5931\u8D25",n),null}}collectRulesFromList(e,t,n){for(let i of Array.from(e))i.type===CSSRule.STYLE_RULE?this.collectStyleRule(i,t,n):"cssRules"in i&&this.collectRulesFromList(i.cssRules,t,n)}collectStyleRule(e,t,n){if(!e.selectorText)return;let i=e.selectorText.split(",").map(o=>o.trim()).filter(Boolean);if(i.length!==0)for(let o of i){if(o===":root"){this.collectVariables(e.style,t);continue}this.collectDeclarations(o,e.style,n)}}collectVariables(e,t){for(let n=0;n<e.length;n++){let i=e.item(n);if(!i||!i.startsWith("--"))continue;let o=e.getPropertyValue(i).trim();o&&t.set(i,o)}}collectDeclarations(e,t,n){let i=n.get(e);i||(i=new Map,n.set(e,i));for(let o=0;o<t.length;o++){let a=t.item(o);if(!a||a.startsWith("--"))continue;let s=t.getPropertyValue(a).trim();s&&i.set(a,{value:s,important:t.getPropertyPriority(a)==="important"})}}parseWithFallback(e,t,n){let i=e.replace(/\/\*[\s\S]*?\*\//g,""),o=/([^{@}]+)\{([^}]*)\}/g,a;for(;(a=o.exec(i))!==null;){let s=a[1].trim();if(!s||s.startsWith("@"))continue;let l=a[2],c=this.parseDeclarations(l),u=s.split(",").map(d=>d.trim()).filter(Boolean);for(let d of u){if(d===":root"){for(let[m,b]of c.entries())m.startsWith("--")&&t.set(m,b.value);continue}let f=n.get(d);f||(f=new Map,n.set(d,f));for(let[m,b]of c.entries())m.startsWith("--")||f.set(m,b)}}}parseDeclarations(e){let t=new Map,n=e.split(";");for(let i of n){let o=i.trim();if(!o)continue;let a=o.indexOf(":");if(a===-1)continue;let s=o.slice(0,a).trim();if(!s)continue;let l=o.slice(a+1).trim(),c=!1;l.endsWith("!important")&&(c=!0,l=l.replace(/!important$/i,"").trim()),l&&t.set(s,{value:l,important:c})}return t}normalizeSelector(e){let t=e.match(/::(before|after)/),n=t?t[1]:null;return{baseSelector:n?e.replace(/::(before|after)/g,""):e,pseudo:n}}ensurePseudoElement(e,t,n){let i=`data-one2mp-pseudo-${t}`,o=e.querySelector(`[${i}]`);return o||(o=document.createElement("span"),o.setAttribute(i,"true"),t==="before"?e.prepend(o):e.append(o)),n&&(o.textContent=n.replace(/(^")|("$)/g,"")),o}applyStyleToElement(e){this.rules.forEach((n,i)=>{let{baseSelector:o,pseudo:a}=this.normalizeSelector(i);try{if(e.matches(o)){let s=e;if(a){let l=n.get("content");s=this.ensurePseudoElement(e,a,l==null?void 0:l.value)}n.forEach((l,c)=>{if(c==="content")return;let u=this.resolveCssVars(l.value,this.vars);s.setCssProps({[c]:l.important?`${u} !important`:u})})}}catch(s){console.debug("error selector=>",i," | Error=>",s.message)}});let t=e.firstElementChild;for(;t;)this.applyStyleToElement(t),t=t.nextElementSibling;return e}removeClassName(e){let t=e.getAttribute("class");if(t){let i=t.split(" ");for(let o of i)Xf(o)||e.classList.remove(o)}e.removeAttribute("class");let n=e.firstElementChild;for(;n;)this.removeClassName(n),n=n.nextElementSibling}}});var pr={};xt(pr,{ThemeManager:()=>Yt});var Be,Ri,Yt,Sn=j(()=>{Be=require("obsidian");Fe();fr();sl();Ri=class{constructor(e){this.cssMerger=null;this.cachedCssKey=null;this.themes=[];this.plugin=e}async downloadThemes(){var n;let e=["https://raw.githubusercontent.com/ryfineZ/O2Any/main/themes/","https://fastly.jsdelivr.net/gh/ryfineZ/O2Any@main/themes/","https://ghproxy.com/https://raw.githubusercontent.com/ryfineZ/O2Any/main/themes/","https://gitee.com/ryfineZ/O2Any/raw/main/themes/","https://raw.githubusercontent.com/ryfineZ/O2Any/master/themes/","https://fastly.jsdelivr.net/gh/ryfineZ/O2Any@master/themes/","https://ghproxy.com/https://raw.githubusercontent.com/ryfineZ/O2Any/master/themes/","https://gitee.com/ryfineZ/O2Any/raw/master/themes/"],t=this.normalizeThemeFolder(this.plugin.settings.css_styles_folder);this.plugin.app.vault.getAbstractFileByPath(t)||await this.plugin.app.vault.createFolder(t);try{let i="",o,a=null;for(let m of e)try{if(o=await(0,Be.requestUrl)(`${m}themes.json`),o.status===200){i=m;break}a=new Error(o.text)}catch(b){a=b instanceof Error?b:new Error(String(b))}if(!o||o.status!==200||!i)throw new Error($("views.theme-manager.failed-to-fetch-themes-json-themesrespon",[(n=a==null?void 0:a.message)!=null?n:"unknown"]));let l=o.json.themes,c=0,u=0,d=0,f=this.plugin.settings.themeDownloadOverwrite;for(let m of l)try{let b=encodeURIComponent(m.file),E=await(0,Be.requestUrl)(`${i}${b}`);if(E.status!==200){console.warn(`Failed to download ${m.file}: ${E.text}`),u+=1;continue}let S=E.text,y=`${t}/${m.file}`,g=this.plugin.app.vault.getAbstractFileByPath(y);if(g){if(!f){d+=1;continue}if(g instanceof Be.TFile){await this.plugin.app.vault.modify(g,S),c+=1;continue}u+=1;continue}await this.plugin.app.vault.create(y,S),c+=1}catch(b){console.error(b),u+=1,new Be.Notice($("views.theme-manager.error-downloading-theme")+b.message);continue}new Be.Notice($("views.theme-manager.download-summary",[String(c),String(u),String(d)]))}catch(i){console.error("Error downloading themes:",i),new Be.Notice($("views.theme-manager.error-downloading-themes"))}}static getInstance(e){return this.instance||(this.instance=new Ri(e)),this.instance}static resetInstance(){this.instance=null}async loadThemes(){this.themes=[];let e=this.normalizeThemeFolder(this.plugin.settings.css_styles_folder),t=this.plugin.app.vault.getAbstractFileByPath(e);return t instanceof Be.TFolder&&(this.themes=await this.getAllThemesInFolder(t)),this.themes}normalizeThemeFolder(e){let t=(e!=null?e:"").trim();return t||(t="one2mp-css-styles"),t=(0,Be.normalizePath)(t),t.startsWith("/")&&(t=t.slice(1)),t}cleanCSS(e){e=e.replace(/```[cC][Ss]{2}\s*|\s*```/g,"").trim();let t=/\/\*[\s\S]*?\*\//g,n=/\/\/.*/g,i=/\s+/g,o=/[\u200B\u00AD\uFEFF\u00A0]/g;return e.replace(t,"").replace(n,"").replace(i," ").replace(o,"").trim()}async extractCSSblocks(e){let t=[],n=this.plugin.app.vault.getFileByPath(e);if(!n)return"";let i=this.plugin.app.metadataCache.getFileCache(n);if(!(i!=null&&i.sections))return"";let o=await this.plugin.app.vault.read(n);for(let a of i.sections)if(a.type==="code"){let s=o.substring(a.position.start.offset,a.position.end.offset);if(!/^```css/i.test(s))continue;let l=s.indexOf(`
`),c=s.lastIndexOf(`
`),u=s.substring(l+1,c).trim();t.push(u)}return t.join(`
`)}async getThemeContent(e){let t=this.plugin.app.vault.getFileByPath(e);if(!t)return"";let n=await this.plugin.app.vault.cachedRead(t),i=/```[cC][Ss]{2}\s*([\s\S]+?)\s*```/gs,o=[],a;for(;(a=i.exec(n))!==null;)o.push(this.cleanCSS(a[1].trim()));return console.debug("cssBlocks=>",o),o.join(`
`)}async getCSS(){let e="";return this.plugin.settings.custom_theme&&(e=await this.extractCSSblocks(this.plugin.settings.custom_theme)),e}getShadowStleSheet(){let e=new CSSStyleSheet;return e.replaceSync(`
  /* \u6EDA\u52A8\u6761\u6837\u5F0F we use shadow dom, make the preview looks better.*/
.table-container::-webkit-scrollbar {
	width: 8px;
	height: 8px;
	background-color: var(--scrollbar-bg);
}

.table-container::-webkit-scrollbar-thumb {
	background-color: var(--scrollbar-thumb-bg);
    -webkit-border-radius: var(--radius-l);
    background-clip: padding-box;
    border: 2px solid transparent;
    border-width: 3px 3px 3px 2px;
    min-height: 45px;
}
.table-container::-webkit-scrollbar-thumb:hover {
	background-color: var(--scrollbar-thumb-hover-bg);
}

.one2mp-article::-webkit-scrollbar-corner{
	background: transparent;
}

.one2mp-article pre::-webkit-scrollbar {
	width: 8px;
	height: 8px;
	background-color: var(--scrollbar-bg);
}

.one2mp-article pre::-webkit-scrollbar-thumb {
	background-color: var(--scrollbar-thumb-bg);
    -webkit-border-radius: var(--radius-l);
    background-clip: padding-box;
    border: 2px solid transparent;
    border-width: 3px 3px 3px 2px;
    min-height: 45px;
}

.one2mp-article pre::-webkit-scrollbar-thumb:hover {
	background-color: var(--scrollbar-thumb-hover-bg);
}

.one2mp-article::-webkit-scrollbar-corner{
	background: transparent;
}
`),e}async getAllThemesInFolder(e){let t=[],n=async i=>{let o=i.children.map(async a=>{if(a instanceof Be.TFile&&a.extension==="md"){let s=await this.getThemeProperties(a);s&&t.push(s)}else a instanceof Be.TFolder&&await n(a)});await Promise.all(o)};return await n(e),t}async getThemeProperties(e){let t=await this.plugin.app.vault.cachedRead(e),{data:n}=Zt(t),i=(n.theme_name||"").trim();if(i)return{name:i,path:e.path}}async applyTheme(e){var o;let t=await this.getCSS(),n=t;if((!this.cssMerger||this.cachedCssKey!==n)&&(this.cssMerger=new hr,await this.cssMerger.init(t),this.cachedCssKey=n),((o=e.dataset)==null?void 0:o.one2mpThemeKey)===n)return e;let i=this.cssMerger.applyStyleToElement(e);return i.dataset.one2mpThemeKey=n,i}},Yt=Ri;Yt.instance=null});function Xt(r,e){if(r===e)return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;let t=Object.keys(r),n=Object.keys(e);if(t.length!==n.length)return!1;for(let i of t){let o=r,a=e;if(!n.includes(i)||!Xt(o[i],a[i]))return!1}return!0}async function Cn(r,e){if(!r)throw new Error(`Invalid URL: ${r}`);if(r.startsWith("data:"))return eh(r);if(e&&r.startsWith("app://")){let t=r.slice(6),n=t.indexOf("/"),i=n>=0?t.slice(n+1):t;i=decodeURIComponent(i),i=i.split("?")[0].split("#")[0];let o=i.replace(/^\/+/,""),a=i.startsWith("/")?i:`/${i}`,s=e.vault.adapter;if(s instanceof rt.FileSystemAdapter){let c=s.getBasePath();if(a.startsWith(c)){let u=a.slice(c.length);(u.startsWith("/")||u.startsWith("\\"))&&(u=u.slice(1));let d=ll(e,u);if(d instanceof rt.TFile){let f=await e.vault.readBinary(d);return new Blob([f])}}}let l=ll(e,o);if(l instanceof rt.TFile){let c=await e.vault.readBinary(l);return new Blob([c])}throw new Error(`Image not found in vault: ${i}`)}try{let t=await(0,rt.requestUrl)(r);if(!t.arrayBuffer)throw new Error(`Failed to fetch image from ${r}`);return new Blob([t.arrayBuffer])}catch(t){let n=t instanceof Error?t.message:String(t);throw new Error(`Error fetching image from ${r}: ${n}`)}}function eh(r){let[e,t]=r.split(","),n=e.match(/data:(.*?);base64/),i=n?n[1]:"application/octet-stream",o=atob(t),a=new Uint8Array(o.length);for(let s=0;s<o.length;s+=1)a[s]=o.charCodeAt(s);return new Blob([a],{type:i})}function cl(r){return r.outerHTML.replaceAll(/<div /g,"<section ").replaceAll(/<\/div>/g,"</section>")}var rt,ll,en=j(()=>{rt=require("obsidian");ll=(r,e)=>{var u,d,f,m,b,E,S,y;let t=r.vault,n=r.workspace.getActiveFile(),i=t.config,o=(u=i==null?void 0:i.attachmentFolderPath)!=null?u:"",a=e.trim();if(!a)return null;a=a.split("|")[0].split("?")[0].split("#")[0],(a.startsWith("/")||a.startsWith("\\"))&&(a=a.slice(1));let s=t.getAbstractFileByPath(a);if(s instanceof rt.TFile)return s;let l=r.metadataCache.getFirstLinkpathDest(a,(d=n==null?void 0:n.path)!=null?d:"");if(l instanceof rt.TFile)return l;if((f=n==null?void 0:n.parent)!=null&&f.path){let g=`${n.parent.path}/${a}`,h=t.getAbstractFileByPath(g);if(h instanceof rt.TFile)return h}let c=a.split("/").pop()||a;if(o){let g=[];if(o.startsWith("./")){let h=o.slice(2);g.push(`${(b=(m=n==null?void 0:n.parent)==null?void 0:m.path)!=null?b:""}/${h}/${c}`),g.push(`${(S=(E=n==null?void 0:n.parent)==null?void 0:E.path)!=null?S:""}/${h}/${a}`)}else g.push(`${o}/${c}`),g.push(`${o}/${a}`),(y=n==null?void 0:n.parent)!=null&&y.path&&(g.push(`${n.parent.path}/${o}/${c}`),g.push(`${n.parent.path}/${o}/${a}`));for(let h of g){let p=t.getAbstractFileByPath(h);if(p instanceof rt.TFile)return p}}return null}});var Fi=Si((ul,dl)=>{(function(r){if(typeof ul=="object")dl.exports=r();else if(typeof define=="function"&&define.amd)define(r);else{var e;try{e=window}catch(t){e=self}e.SparkMD5=r()}})(function(r){"use strict";var e=function(y,g){return y+g&4294967295},t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(y,g,h,p,w,k){return g=e(e(g,y),e(p,k)),e(g<<w|g>>>32-w,h)}function i(y,g){var h=y[0],p=y[1],w=y[2],k=y[3];h+=(p&w|~p&k)+g[0]-680876936|0,h=(h<<7|h>>>25)+p|0,k+=(h&p|~h&w)+g[1]-389564586|0,k=(k<<12|k>>>20)+h|0,w+=(k&h|~k&p)+g[2]+606105819|0,w=(w<<17|w>>>15)+k|0,p+=(w&k|~w&h)+g[3]-1044525330|0,p=(p<<22|p>>>10)+w|0,h+=(p&w|~p&k)+g[4]-176418897|0,h=(h<<7|h>>>25)+p|0,k+=(h&p|~h&w)+g[5]+1200080426|0,k=(k<<12|k>>>20)+h|0,w+=(k&h|~k&p)+g[6]-1473231341|0,w=(w<<17|w>>>15)+k|0,p+=(w&k|~w&h)+g[7]-45705983|0,p=(p<<22|p>>>10)+w|0,h+=(p&w|~p&k)+g[8]+1770035416|0,h=(h<<7|h>>>25)+p|0,k+=(h&p|~h&w)+g[9]-1958414417|0,k=(k<<12|k>>>20)+h|0,w+=(k&h|~k&p)+g[10]-42063|0,w=(w<<17|w>>>15)+k|0,p+=(w&k|~w&h)+g[11]-1990404162|0,p=(p<<22|p>>>10)+w|0,h+=(p&w|~p&k)+g[12]+1804603682|0,h=(h<<7|h>>>25)+p|0,k+=(h&p|~h&w)+g[13]-40341101|0,k=(k<<12|k>>>20)+h|0,w+=(k&h|~k&p)+g[14]-1502002290|0,w=(w<<17|w>>>15)+k|0,p+=(w&k|~w&h)+g[15]+1236535329|0,p=(p<<22|p>>>10)+w|0,h+=(p&k|w&~k)+g[1]-165796510|0,h=(h<<5|h>>>27)+p|0,k+=(h&w|p&~w)+g[6]-1069501632|0,k=(k<<9|k>>>23)+h|0,w+=(k&p|h&~p)+g[11]+643717713|0,w=(w<<14|w>>>18)+k|0,p+=(w&h|k&~h)+g[0]-373897302|0,p=(p<<20|p>>>12)+w|0,h+=(p&k|w&~k)+g[5]-701558691|0,h=(h<<5|h>>>27)+p|0,k+=(h&w|p&~w)+g[10]+38016083|0,k=(k<<9|k>>>23)+h|0,w+=(k&p|h&~p)+g[15]-660478335|0,w=(w<<14|w>>>18)+k|0,p+=(w&h|k&~h)+g[4]-405537848|0,p=(p<<20|p>>>12)+w|0,h+=(p&k|w&~k)+g[9]+568446438|0,h=(h<<5|h>>>27)+p|0,k+=(h&w|p&~w)+g[14]-1019803690|0,k=(k<<9|k>>>23)+h|0,w+=(k&p|h&~p)+g[3]-187363961|0,w=(w<<14|w>>>18)+k|0,p+=(w&h|k&~h)+g[8]+1163531501|0,p=(p<<20|p>>>12)+w|0,h+=(p&k|w&~k)+g[13]-1444681467|0,h=(h<<5|h>>>27)+p|0,k+=(h&w|p&~w)+g[2]-51403784|0,k=(k<<9|k>>>23)+h|0,w+=(k&p|h&~p)+g[7]+1735328473|0,w=(w<<14|w>>>18)+k|0,p+=(w&h|k&~h)+g[12]-1926607734|0,p=(p<<20|p>>>12)+w|0,h+=(p^w^k)+g[5]-378558|0,h=(h<<4|h>>>28)+p|0,k+=(h^p^w)+g[8]-2022574463|0,k=(k<<11|k>>>21)+h|0,w+=(k^h^p)+g[11]+1839030562|0,w=(w<<16|w>>>16)+k|0,p+=(w^k^h)+g[14]-35309556|0,p=(p<<23|p>>>9)+w|0,h+=(p^w^k)+g[1]-1530992060|0,h=(h<<4|h>>>28)+p|0,k+=(h^p^w)+g[4]+1272893353|0,k=(k<<11|k>>>21)+h|0,w+=(k^h^p)+g[7]-155497632|0,w=(w<<16|w>>>16)+k|0,p+=(w^k^h)+g[10]-1094730640|0,p=(p<<23|p>>>9)+w|0,h+=(p^w^k)+g[13]+681279174|0,h=(h<<4|h>>>28)+p|0,k+=(h^p^w)+g[0]-358537222|0,k=(k<<11|k>>>21)+h|0,w+=(k^h^p)+g[3]-722521979|0,w=(w<<16|w>>>16)+k|0,p+=(w^k^h)+g[6]+76029189|0,p=(p<<23|p>>>9)+w|0,h+=(p^w^k)+g[9]-640364487|0,h=(h<<4|h>>>28)+p|0,k+=(h^p^w)+g[12]-421815835|0,k=(k<<11|k>>>21)+h|0,w+=(k^h^p)+g[15]+530742520|0,w=(w<<16|w>>>16)+k|0,p+=(w^k^h)+g[2]-995338651|0,p=(p<<23|p>>>9)+w|0,h+=(w^(p|~k))+g[0]-198630844|0,h=(h<<6|h>>>26)+p|0,k+=(p^(h|~w))+g[7]+1126891415|0,k=(k<<10|k>>>22)+h|0,w+=(h^(k|~p))+g[14]-1416354905|0,w=(w<<15|w>>>17)+k|0,p+=(k^(w|~h))+g[5]-57434055|0,p=(p<<21|p>>>11)+w|0,h+=(w^(p|~k))+g[12]+1700485571|0,h=(h<<6|h>>>26)+p|0,k+=(p^(h|~w))+g[3]-1894986606|0,k=(k<<10|k>>>22)+h|0,w+=(h^(k|~p))+g[10]-1051523|0,w=(w<<15|w>>>17)+k|0,p+=(k^(w|~h))+g[1]-2054922799|0,p=(p<<21|p>>>11)+w|0,h+=(w^(p|~k))+g[8]+1873313359|0,h=(h<<6|h>>>26)+p|0,k+=(p^(h|~w))+g[15]-30611744|0,k=(k<<10|k>>>22)+h|0,w+=(h^(k|~p))+g[6]-1560198380|0,w=(w<<15|w>>>17)+k|0,p+=(k^(w|~h))+g[13]+1309151649|0,p=(p<<21|p>>>11)+w|0,h+=(w^(p|~k))+g[4]-145523070|0,h=(h<<6|h>>>26)+p|0,k+=(p^(h|~w))+g[11]-1120210379|0,k=(k<<10|k>>>22)+h|0,w+=(h^(k|~p))+g[2]+718787259|0,w=(w<<15|w>>>17)+k|0,p+=(k^(w|~h))+g[9]-343485551|0,p=(p<<21|p>>>11)+w|0,y[0]=h+y[0]|0,y[1]=p+y[1]|0,y[2]=w+y[2]|0,y[3]=k+y[3]|0}function o(y){var g=[],h;for(h=0;h<64;h+=4)g[h>>2]=y.charCodeAt(h)+(y.charCodeAt(h+1)<<8)+(y.charCodeAt(h+2)<<16)+(y.charCodeAt(h+3)<<24);return g}function a(y){var g=[],h;for(h=0;h<64;h+=4)g[h>>2]=y[h]+(y[h+1]<<8)+(y[h+2]<<16)+(y[h+3]<<24);return g}function s(y){var g=y.length,h=[1732584193,-271733879,-1732584194,271733878],p,w,k,R,B,F;for(p=64;p<=g;p+=64)i(h,o(y.substring(p-64,p)));for(y=y.substring(p-64),w=y.length,k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=0;p<w;p+=1)k[p>>2]|=y.charCodeAt(p)<<(p%4<<3);if(k[p>>2]|=128<<(p%4<<3),p>55)for(i(h,k),p=0;p<16;p+=1)k[p]=0;return R=g*8,R=R.toString(16).match(/(.*?)(.{0,8})$/),B=parseInt(R[2],16),F=parseInt(R[1],16)||0,k[14]=B,k[15]=F,i(h,k),h}function l(y){var g=y.length,h=[1732584193,-271733879,-1732584194,271733878],p,w,k,R,B,F;for(p=64;p<=g;p+=64)i(h,a(y.subarray(p-64,p)));for(y=p-64<g?y.subarray(p-64):new Uint8Array(0),w=y.length,k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=0;p<w;p+=1)k[p>>2]|=y[p]<<(p%4<<3);if(k[p>>2]|=128<<(p%4<<3),p>55)for(i(h,k),p=0;p<16;p+=1)k[p]=0;return R=g*8,R=R.toString(16).match(/(.*?)(.{0,8})$/),B=parseInt(R[2],16),F=parseInt(R[1],16)||0,k[14]=B,k[15]=F,i(h,k),h}function c(y){var g="",h;for(h=0;h<4;h+=1)g+=t[y>>h*8+4&15]+t[y>>h*8&15];return g}function u(y){var g;for(g=0;g<y.length;g+=1)y[g]=c(y[g]);return y.join("")}u(s("hello"))!=="5d41402abc4b2a76b9719d911017c592"&&(e=function(y,g){var h=(y&65535)+(g&65535),p=(y>>16)+(g>>16)+(h>>16);return p<<16|h&65535}),typeof ArrayBuffer!="undefined"&&!ArrayBuffer.prototype.slice&&function(){function y(g,h){return g=g|0||0,g<0?Math.max(g+h,0):Math.min(g,h)}ArrayBuffer.prototype.slice=function(g,h){var p=this.byteLength,w=y(g,p),k=p,R,B,F,K;return h!==r&&(k=y(h,p)),w>k?new ArrayBuffer(0):(R=k-w,B=new ArrayBuffer(R),F=new Uint8Array(B),K=new Uint8Array(this,w,R),F.set(K),B)}}();function d(y){return/[\u0080-\uFFFF]/.test(y)&&(y=unescape(encodeURIComponent(y))),y}function f(y,g){var h=y.length,p=new ArrayBuffer(h),w=new Uint8Array(p),k;for(k=0;k<h;k+=1)w[k]=y.charCodeAt(k);return g?w:p}function m(y){return String.fromCharCode.apply(null,new Uint8Array(y))}function b(y,g,h){var p=new Uint8Array(y.byteLength+g.byteLength);return p.set(new Uint8Array(y)),p.set(new Uint8Array(g),y.byteLength),h?p:p.buffer}function E(y){var g=[],h=y.length,p;for(p=0;p<h-1;p+=2)g.push(parseInt(y.substr(p,2),16));return String.fromCharCode.apply(String,g)}function S(){this.reset()}return S.prototype.append=function(y){return this.appendBinary(d(y)),this},S.prototype.appendBinary=function(y){this._buff+=y,this._length+=y.length;var g=this._buff.length,h;for(h=64;h<=g;h+=64)i(this._hash,o(this._buff.substring(h-64,h)));return this._buff=this._buff.substring(h-64),this},S.prototype.end=function(y){var g=this._buff,h=g.length,p,w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k;for(p=0;p<h;p+=1)w[p>>2]|=g.charCodeAt(p)<<(p%4<<3);return this._finish(w,h),k=u(this._hash),y&&(k=E(k)),this.reset(),k},S.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},S.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},S.prototype.setState=function(y){return this._buff=y.buff,this._length=y.length,this._hash=y.hash,this},S.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},S.prototype._finish=function(y,g){var h=g,p,w,k;if(y[h>>2]|=128<<(h%4<<3),h>55)for(i(this._hash,y),h=0;h<16;h+=1)y[h]=0;p=this._length*8,p=p.toString(16).match(/(.*?)(.{0,8})$/),w=parseInt(p[2],16),k=parseInt(p[1],16)||0,y[14]=w,y[15]=k,i(this._hash,y)},S.hash=function(y,g){return S.hashBinary(d(y),g)},S.hashBinary=function(y,g){var h=s(y),p=u(h);return g?E(p):p},S.ArrayBuffer=function(){this.reset()},S.ArrayBuffer.prototype.append=function(y){var g=b(this._buff.buffer,y,!0),h=g.length,p;for(this._length+=y.byteLength,p=64;p<=h;p+=64)i(this._hash,a(g.subarray(p-64,p)));return this._buff=p-64<h?new Uint8Array(g.buffer.slice(p-64)):new Uint8Array(0),this},S.ArrayBuffer.prototype.end=function(y){var g=this._buff,h=g.length,p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],w,k;for(w=0;w<h;w+=1)p[w>>2]|=g[w]<<(w%4<<3);return this._finish(p,h),k=u(this._hash),y&&(k=E(k)),this.reset(),k},S.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},S.ArrayBuffer.prototype.getState=function(){var y=S.prototype.getState.call(this);return y.buff=m(y.buff),y},S.ArrayBuffer.prototype.setState=function(y){return y.buff=f(y.buff,!0),S.prototype.setState.call(this,y)},S.ArrayBuffer.prototype.destroy=S.prototype.destroy,S.ArrayBuffer.prototype._finish=S.prototype._finish,S.ArrayBuffer.hash=function(y,g){var h=l(new Uint8Array(y)),p=u(h);return g?E(p):p},S})});function Bi(){if(!mr&&(mr=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!mr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return mr(th)}var mr,th,fl=j(()=>{th=new Uint8Array(16)});var hl,pl=j(()=>{hl=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i});function nh(r){return typeof r=="string"&&hl.test(r)}var gl,ml=j(()=>{pl();gl=nh});function rh(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(Me[r[e+0]]+Me[r[e+1]]+Me[r[e+2]]+Me[r[e+3]]+"-"+Me[r[e+4]]+Me[r[e+5]]+"-"+Me[r[e+6]]+Me[r[e+7]]+"-"+Me[r[e+8]]+Me[r[e+9]]+"-"+Me[r[e+10]]+Me[r[e+11]]+Me[r[e+12]]+Me[r[e+13]]+Me[r[e+14]]+Me[r[e+15]]).toLowerCase();if(!gl(t))throw TypeError("Stringified UUID is invalid");return t}var Me,vr,vl,yl=j(()=>{ml();Me=[];for(vr=0;vr<256;++vr)Me.push((vr+256).toString(16).substr(1));vl=rh});function ih(r,e,t){r=r||{};var n=r.random||(r.rng||Bi)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(var i=0;i<16;++i)e[t+i]=n[i];return e}return vl(n)}var En,wl=j(()=>{fl();yl();En=ih});var bl=j(()=>{wl()});var xl=Si(qi=>{"use strict";qi.stringify=function(e){var t=[];t.push({obj:e});for(var n="",i,o,a,s,l,c,u,d,f,m,b;i=t.pop();)if(o=i.obj,a=i.prefix||"",s=i.val||"",n+=a,s)n+=s;else if(typeof o!="object")n+=typeof o=="undefined"?null:JSON.stringify(o);else if(o===null)n+="null";else if(Array.isArray(o)){for(t.push({val:"]"}),l=o.length-1;l>=0;l--)c=l===0?"":",",t.push({obj:o[l],prefix:c});t.push({val:"["})}else{u=[];for(d in o)o.hasOwnProperty(d)&&u.push(d);for(t.push({val:"}"}),l=u.length-1;l>=0;l--)f=u[l],m=o[f],b=l>0?",":"",b+=JSON.stringify(f)+":",t.push({obj:m,prefix:b});t.push({val:"{"})}return n};function tn(r,e,t){var n=t[t.length-1];r===n.element&&(t.pop(),n=t[t.length-1]);var i=n.element,o=n.index;if(Array.isArray(i))i.push(r);else if(o===e.length-2){var a=e.pop();i[a]=r}else e.push(r)}qi.parse=function(r){for(var e=[],t=[],n=0,i,o,a,s,l,c,u,d,f;;){if(i=r[n++],i==="}"||i==="]"||typeof i=="undefined"){if(e.length===1)return e.pop();tn(e.pop(),e,t);continue}switch(i){case" ":case"	":case`
`:case":":case",":break;case"n":n+=3,tn(null,e,t);break;case"t":n+=3,tn(!0,e,t);break;case"f":n+=4,tn(!1,e,t);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(o="",n--;;)if(a=r[n++],/[\d\.\-e\+]/.test(a))o+=a;else{n--;break}tn(parseFloat(o),e,t);break;case'"':for(s="",l=void 0,c=0;u=r[n++],u!=='"'||l==="\\"&&c%2===1;)s+=u,l=u,l==="\\"?c++:c=0;tn(JSON.parse('"'+s+'"'),e,t);break;case"[":d={element:[],index:e.length},e.push(d.element),t.push(d);break;case"{":f={element:{},index:e.length},e.push(f.element),t.push(f);break;default:throw new Error("unexpectedly reached end of input: "+i)}}}});var Fo={};xt(Fo,{default:()=>Wg});function oh(r){return typeof ArrayBuffer!="undefined"&&r instanceof ArrayBuffer||typeof Blob!="undefined"&&r instanceof Blob}function ah(r){return r instanceof ArrayBuffer?r.slice(0):r.slice(0,r.size,r.type)}function lh(r){var e=Object.getPrototypeOf(r);if(e===null)return!0;var t=e.constructor;return typeof t=="function"&&t instanceof t&&Jl.call(t)==sh}function $e(r){var e,t,n;if(!r||typeof r!="object")return r;if(Array.isArray(r)){for(e=[],t=0,n=r.length;t<n;t++)e[t]=$e(r[t]);return e}if(r instanceof Date&&isFinite(r))return r.toISOString();if(oh(r))return ah(r);if(!lh(r))return r;e={};for(t in r)if(Object.prototype.hasOwnProperty.call(r,t)){var i=$e(r[t]);typeof i!="undefined"&&(e[t]=i)}return e}function Ql(r){var e=!1;return function(...t){if(e)throw new Error("once called more than once");e=!0,r.apply(this,t)}}function Zl(r){return function(...e){e=$e(e);var t=this,n=typeof e[e.length-1]=="function"?e.pop():!1,i=new Promise(function(o,a){var s;try{var l=Ql(function(c,u){c?a(c):o(u)});e.push(l),s=r.apply(t,e),s&&typeof s.then=="function"&&o(s)}catch(c){a(c)}});return n&&i.then(function(o){n(null,o)},n),i}}function ch(r,e,t){if(r.constructor.listeners("debug").length){for(var n=["api",r.name,e],i=0;i<t.length-1;i++)n.push(t[i]);r.constructor.emit("debug",n);var o=t[t.length-1];t[t.length-1]=function(a,s){var l=["api",r.name,e];l=l.concat(a?["error",a]:["success",s]),r.constructor.emit("debug",l),o(a,s)}}}function Ce(r,e){return Zl(function(...t){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var n=this;return ch(n,r,t),this.taskqueue.isReady?e.apply(this,t):new Promise(function(i,o){n.taskqueue.addTask(function(a){a?o(a):i(n[r].apply(n,t))})})})}function $n(r,e){for(var t={},n=0,i=e.length;n<i;n++){var o=e[n];o in r&&(t[o]=r[o])}return t}function _l(r){return r}function dh(r){return[{ok:r}]}function Yl(r,e,t){var n=e.docs,i=new Map;n.forEach(function(E){i.has(E.id)?i.get(E.id).push(E):i.set(E.id,[E])});var o=i.size,a=0,s=new Array(o);function l(){var E=[];s.forEach(function(S){S.docs.forEach(function(y){E.push({id:S.id,docs:[y]})})}),t(null,{results:E})}function c(){++a===o&&l()}function u(E,S,y){s[E]={id:S,docs:y},c()}var d=[];i.forEach(function(E,S){d.push(S)});var f=0;function m(){if(!(f>=d.length)){var E=Math.min(f+uh,d.length),S=d.slice(f,E);b(S,f),f+=S.length}}function b(E,S){E.forEach(function(y,g){var h=S+g,p=i.get(y),w=$n(p[0],["atts_since","attachments"]);w.open_revs=p.map(function(R){return R.rev}),w.open_revs=w.open_revs.filter(_l);var k=_l;w.open_revs.length===0&&(delete w.open_revs,k=dh),["revs","attachments","binary","ajax","latest"].forEach(function(R){R in e&&(w[R]=e[R])}),r.get(y,w,function(R,B){var F;R?F=[{error:R}]:F=k(B),u(h,y,F),m()})})}m()}function kr(){return Xi}function Xe(r){if(typeof console!="undefined"&&typeof console[r]=="function"){var e=Array.prototype.slice.call(arguments,1);console[r].apply(console,e)}}function fh(r,e){var t=6e5;r=parseInt(r,10)||0,e=parseInt(e,10),e!==e||e<=r?e=(r||1)<<1:e=e+1,e>t&&(r=t>>1,e=t);var n=Math.random(),i=e-r;return~~(i*n+r)}function hh(r){var e=0;return r||(e=2e3),fh(r,e)}function to(r,e){Xe("info","The above "+r+" is totally normal. "+e)}function ie(r,e){function t(n){for(var i=Object.getOwnPropertyNames(r),o=0,a=i.length;o<a;o++)typeof r[i[o]]!="function"&&(this[i[o]]=r[i[o]]);this.stack===void 0&&(this.stack=new Error().stack),n!==void 0&&(this.reason=n)}return t.prototype=xe.prototype,new t(e)}function sn(r){if(typeof r!="object"){var e=r;r=ko,r.data=e}return"error"in r&&r.error==="conflict"&&(r.name="conflict",r.status=409),"name"in r||(r.name=r.error||"unknown"),"status"in r||(r.status=500),"message"in r||(r.message=r.message||r.reason),"stack"in r||(r.stack=new Error().stack),r}function wh(r,e,t){try{return!r(e,t)}catch(i){var n="Filter function threw: "+i.toString();return ie($r,n)}}function Co(r){var e={},t=r.filter&&typeof r.filter=="function";return e.query=r.query_params,function(i){i.doc||(i.doc={});var o=t&&wh(r.filter,i.doc,e);if(typeof o=="object")return o;if(o)return!1;if(!r.include_docs)delete i.doc;else if(!r.attachments)for(var a in i.doc._attachments)Object.prototype.hasOwnProperty.call(i.doc._attachments,a)&&(i.doc._attachments[a].stub=!0);return!0}}function tc(r){var e;if(r?typeof r!="string"?e=ie(Xl):/^_/.test(r)&&!/^_(design|local)/.test(r)&&(e=ie(mh)):e=ie(gh),e)throw e}function dt(r){return typeof r._remote=="boolean"?r._remote:typeof r.type=="function"?(Xe("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),r.type()==="http"):!1}function bh(r,e){return"listenerCount"in r?r.listenerCount(e):ft.default.listenerCount(r,e)}function no(r){if(!r)return null;var e=r.split("/");return e.length===2?e:e.length===1?[r,r]:null}function Sl(r){var e=no(r);return e?e.join("/"):null}function nc(r){for(var e=_h.exec(r),t={},n=14;n--;){var i=Cl[n],o=e[n]||"",a=["user","password"].indexOf(i)!==-1;t[i]=a?decodeURIComponent(o):o}return t[El]={},t[Cl[12]].replace(xh,function(s,l,c){l&&(t[El][l]=c)}),t}function Eo(r,e){var t=[],n=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t.push(i),n.push(e[i]));return t.push(r),Function.apply(null,t).apply(null,n)}function Sr(r,e,t){return r.get(e).catch(function(n){if(n.status!==404)throw n;return{}}).then(function(n){var i=n._rev,o=t(n);return o?(o._id=e,o._rev=i,kh(r,o,t)):{updated:!1,rev:i}})}function kh(r,e,t){return r.put(e).then(function(n){return{updated:!0,rev:n.rev}},function(n){if(n.status!==409)throw n;return Sr(r,e._id,t)})}function Ao(r,e){r=r||[],e=e||{};try{return new Blob(r,e)}catch(o){if(o.name!=="TypeError")throw o;for(var t=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,n=new t,i=0;i<r.length;i+=1)n.append(r[i]);return n.getBlob(e.type)}}function Sh(r){for(var e=r.length,t=new ArrayBuffer(e),n=new Uint8Array(t),i=0;i<e;i++)n[i]=r.charCodeAt(i);return t}function Po(r,e){return Ao([Sh(r)],{type:e})}function Io(r,e){return Po(To(r),e)}function Ch(r){for(var e="",t=new Uint8Array(r),n=t.byteLength,i=0;i<n;i++)e+=String.fromCharCode(t[i]);return e}function rc(r,e){var t=new FileReader,n=typeof t.readAsBinaryString=="function";t.onloadend=function(i){var o=i.target.result||"";if(n)return e(o);e(Ch(o))},n?t.readAsBinaryString(r):t.readAsArrayBuffer(r)}function ic(r,e){rc(r,function(t){e(t)})}function $o(r,e){ic(r,function(t){e(On(t))})}function Eh(r,e){var t=new FileReader;t.onloadend=function(n){var i=n.target.result||new ArrayBuffer(0);e(i)},t.readAsArrayBuffer(r)}function Ph(r){return On(r)}function Ih(r,e,t,n,i){(t>0||n<e.size)&&(e=e.slice(t,n)),Eh(e,function(o){r.append(o),i()})}function $h(r,e,t,n,i){(t>0||n<e.length)&&(e=e.substring(t,n)),r.appendBinary(e),i()}function Oo(r,e){var t=typeof r=="string",n=t?r.length:r.size,i=Math.min(Ah,n),o=Math.ceil(n/i),a=0,s=t?new _r.default:new _r.default.ArrayBuffer,l=t?$h:Ih;function c(){Th(d)}function u(){var f=s.end(!0),m=Ph(f);e(m),s.destroy()}function d(){var f=a*i,m=f+i;a++,a<o?l(s,r,f,m,c):l(s,r,f,m,u)}d()}function oc(r){return _r.default.hash(r)}function ac(r,e){if(!e)return En().replace(/-/g,"").toLowerCase();var t=Object.assign({},r);return delete t._rev_tree,oc(JSON.stringify(t))}function $t(r){for(var e,t,n,i=r.rev_tree.slice(),o;o=i.pop();){var a=o.ids,s=a[2],l=o.pos;if(s.length){for(var c=0,u=s.length;c<u;c++)i.push({pos:l+1,ids:s[c]});continue}var d=!!a[1].deleted,f=a[0];(!e||(n!==d?n:t!==l?t<l:e<f))&&(e=f,t=l,n=d)}return t+"-"+e}function Ot(r,e){for(var t=r.slice(),n;n=t.pop();)for(var i=n.pos,o=n.ids,a=o[2],s=e(a.length===0,i,o[0],n.ctx,o[1]),l=0,c=a.length;l<c;l++)t.push({pos:i+1,ids:a[l],ctx:s})}function Oh(r,e){return r.pos-e.pos}function Do(r){var e=[];Ot(r,function(i,o,a,s,l){i&&e.push({rev:o+"-"+a,pos:o,opts:l})}),e.sort(Oh).reverse();for(var t=0,n=e.length;t<n;t++)delete e[t].pos;return e}function Mo(r){for(var e=$t(r),t=Do(r.rev_tree),n=[],i=0,o=t.length;i<o;i++){var a=t[i];a.rev!==e&&!a.opts.deleted&&n.push(a.rev)}return n}function Dh(r){var e=[];return Ot(r.rev_tree,function(t,n,i,o,a){a.status==="available"&&!t&&(e.push(n+"-"+i),a.status="missing")}),e}function Mh(r,e){let t=[],n=r.slice(),i;for(;i=n.pop();){let{pos:o,ids:a}=i,s=`${o}-${a[0]}`,l=a[2];if(t.push(s),s===e){if(l.length!==0)throw new Error("The requested revision is not a leaf");return t.reverse()}(l.length===0||l.length>1)&&(t=[]);for(let c=0,u=l.length;c<u;c++)n.push({pos:o+1,ids:l[c]})}if(t.length===0)throw new Error("The requested revision does not exist");return t.reverse()}function sc(r){for(var e=[],t=r.slice(),n;n=t.pop();){var i=n.pos,o=n.ids,a=o[0],s=o[1],l=o[2],c=l.length===0,u=n.history?n.history.slice():[];u.push({id:a,opts:s}),c&&e.push({pos:i+1-u.length,ids:u});for(var d=0,f=l.length;d<f;d++)t.push({pos:i+1,ids:l[d],history:u})}return e.reverse()}function Lh(r,e){return r.pos-e.pos}function Rh(r,e,t){for(var n=0,i=r.length,o;n<i;)o=n+i>>>1,t(r[o],e)<0?n=o+1:i=o;return n}function Fh(r,e,t){var n=Rh(r,e,t);r.splice(n,0,e)}function Tl(r,e){for(var t,n,i=e,o=r.length;i<o;i++){var a=r[i],s=[a.id,a.opts,[]];n?(n[2].push(s),n=s):t=n=s}return t}function Bh(r,e){return r[0]<e[0]?-1:1}function Al(r,e){for(var t=[{tree1:r,tree2:e}],n=!1;t.length>0;){var i=t.pop(),o=i.tree1,a=i.tree2;(o[1].status||a[1].status)&&(o[1].status=o[1].status==="available"||a[1].status==="available"?"available":"missing");for(var s=0;s<a[2].length;s++){if(!o[2][0]){n="new_leaf",o[2][0]=a[2][s];continue}for(var l=!1,c=0;c<o[2].length;c++)o[2][c][0]===a[2][s][0]&&(t.push({tree1:o[2][c],tree2:a[2][s]}),l=!0);l||(n="new_branch",Fh(o[2],a[2][s],Bh))}}return{conflicts:n,tree:r}}function lc(r,e,t){var n=[],i=!1,o=!1,a;if(!r.length)return{tree:[e],conflicts:"new_leaf"};for(var s=0,l=r.length;s<l;s++){var c=r[s];if(c.pos===e.pos&&c.ids[0]===e.ids[0])a=Al(c.ids,e.ids),n.push({pos:c.pos,ids:a.tree}),i=i||a.conflicts,o=!0;else if(t!==!0){var u=c.pos<e.pos?c:e,d=c.pos<e.pos?e:c,f=d.pos-u.pos,m=[],b=[];for(b.push({ids:u.ids,diff:f,parent:null,parentIdx:null});b.length>0;){var E=b.pop();if(E.diff===0){E.ids[0]===d.ids[0]&&m.push(E);continue}for(var S=E.ids[2],y=0,g=S.length;y<g;y++)b.push({ids:S[y],diff:E.diff-1,parent:E.ids,parentIdx:y})}var h=m[0];h?(a=Al(h.ids,d.ids),h.parent[2][h.parentIdx]=a.tree,n.push({pos:u.pos,ids:u.ids}),i=i||a.conflicts,o=!0):n.push(c)}else n.push(c)}return o||n.push(e),n.sort(Lh),{tree:n,conflicts:i||"internal_node"}}function qh(r,e){for(var t=sc(r),n,i,o=0,a=t.length;o<a;o++){var s=t[o],l=s.ids,c;if(l.length>e){n||(n={});var u=l.length-e;c={pos:s.pos+u,ids:Tl(l,u)};for(var d=0;d<u;d++){var f=s.pos+d+"-"+l[d].id;n[f]=!0}}else c={pos:s.pos,ids:Tl(l,0)};i?i=lc(i,c,!0).tree:i=[c]}return n&&Ot(i,function(m,b,E){delete n[b+"-"+E]}),{tree:i,revs:n?Object.keys(n):[]}}function cc(r,e,t){var n=lc(r,e),i=qh(n.tree,t);return{tree:i.tree,stemmedRevs:i.revs,conflicts:n.conflicts}}function Nh(r,e){for(var t=r.slice(),n=e.split("-"),i=parseInt(n[0],10),o=n[1],a;a=t.pop();){if(a.pos===i&&a.ids[0]===o)return!0;for(var s=a.ids[2],l=0,c=s.length;l<c;l++)t.push({pos:a.pos+1,ids:s[l]})}return!1}function jh(r){return r.ids}function vt(r,e){e||(e=$t(r));for(var t=e.substring(e.indexOf("-")+1),n=r.rev_tree.map(jh),i;i=n.pop();){if(i[0]===t)return!!i[1].deleted;n=n.concat(i[2])}}function It(r){return typeof r=="string"&&r.startsWith("_local/")}function zh(r,e){for(var t=e.rev_tree.slice(),n;n=t.pop();){var i=n.pos,o=n.ids,a=o[0],s=o[1],l=o[2],c=l.length===0,u=n.history?n.history.slice():[];if(u.push({id:a,pos:i,opts:s}),c)for(var d=0,f=u.length;d<f;d++){var m=u[d],b=m.pos+"-"+m.id;if(b===r)return i+"-"+a}for(var E=0,S=l.length;E<S;E++)t.push({pos:i+1,ids:l[E],history:u})}throw new Error("Unable to resolve latest revision for id "+e.id+", rev "+r)}function Hh(r,e,t,n){try{r.emit("change",e,t,n)}catch(i){Xe("error",'Error in .on("change", function):',i)}}function Uh(r,e,t){var n=[{rev:r._rev}];t.style==="all_docs"&&(n=Do(e.rev_tree).map(function(o){return{rev:o.rev}}));var i={id:e.id,changes:n,doc:r};return vt(e,r._rev)&&(i.deleted=!0),t.conflicts&&(i.doc._conflicts=Mo(e),i.doc._conflicts.length||delete i.doc._conflicts),i}function ji(r,e){return function(t,n){t||n[0]&&n[0].error?(t=t||n[0],t.docId=e,r(t)):r(null,n.length?n[0]:n)}}function Vh(r){for(var e=0;e<r.length;e++){var t=r[e];if(t._deleted)delete t._attachments;else if(t._attachments)for(var n=Object.keys(t._attachments),i=0;i<n.length;i++){var o=n[i];t._attachments[o]=$n(t._attachments[o],["data","digest","content_type","length","revpos","stub"])}}}function Wh(r,e){if(r._id===e._id){let t=r._revisions?r._revisions.start:0,n=e._revisions?e._revisions.start:0;return t-n}return r._id<e._id?-1:1}function Kh(r){var e={},t=[];return Ot(r,function(n,i,o,a){var s=i+"-"+o;return n&&(e[s]=0),a!==void 0&&t.push({from:a,to:s}),s}),t.reverse(),t.forEach(function(n){e[n.from]===void 0?e[n.from]=1+e[n.to]:e[n.from]=Math.min(e[n.from],1+e[n.to])}),e}function Gh(r){var e="limit"in r?r.keys.slice(r.skip,r.limit+r.skip):r.skip>0?r.keys.slice(r.skip):r.keys;r.keys=e,r.skip=0,delete r.limit,r.descending&&(e.reverse(),r.descending=!1)}function uc(r){var e=r._compactionQueue[0],t=e.opts,n=e.callback;r.get("_local/compaction").catch(function(){return!1}).then(function(i){i&&i.last_seq&&(t.last_seq=i.last_seq),r._compact(t,function(o,a){o?n(o):n(null,a),ht(function(){r._compactionQueue.shift(),r._compactionQueue.length&&uc(r)})})})}function Jh(r,e,t){return r.get("_local/purges").then(function(n){let i=n.purgeSeq+1;return n.purges.push({docId:e,rev:t,purgeSeq:i}),n.purges.length>self.purged_infos_limit&&n.purges.splice(0,n.purges.length-self.purged_infos_limit),n.purgeSeq=i,n}).catch(function(n){if(n.status!==404)throw n;return{_id:"_local/purges",purges:[{docId:e,rev:t,purgeSeq:0}],purgeSeq:0}}).then(function(n){return r.put(n)})}function Qh(r){return r.charAt(0)==="_"?r+" is not a valid attachment name, attachment names cannot start with '_'":!1}function zi(r){return r===null||typeof r!="object"||Array.isArray(r)}function Hi(r){return typeof r=="string"&&Zh.test(r)}function Yh(r,e){var t=r.match(/([a-z-]*):\/\/(.*)/);if(t)return{name:/https?/.test(t[1])?t[1]+"://"+t[2]:t[2],adapter:t[1]};var n=ae.adapters,i=ae.preferredAdapters,o=ae.prefix,a=e.adapter;if(!a)for(var s=0;s<i.length;++s){if(a=i[s],a==="idb"&&"websql"in n&&kr()&&localStorage["_pouch__websqldb_"+o+r]){Xe("log",'PouchDB is downgrading "'+r+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}var l=n[a],c=l&&"use_prefix"in l?l.use_prefix:!0;return{name:c?o+r:r,adapter:a}}function Xh(r,e){r.prototype=Object.create(e.prototype,{constructor:{value:r}})}function dc(r,e){let t=function(...n){if(!(this instanceof t))return new t(...n);e.apply(this,n)};return Xh(t,r),t}function ep(r){function e(n){r.removeListener("closed",t),n||r.constructor.emit("destroyed",r.name)}function t(){r.removeListener("destroyed",e),r.constructor.emit("unref",r)}r.once("destroyed",e),r.once("closed",t),r.constructor.emit("ref",r)}function tp(r){Object.keys(ft.default.prototype).forEach(function(t){typeof ft.default.prototype[t]=="function"&&(r[t]=Pl[t].bind(Pl))});var e=r._destructionListeners=new Map;r.on("ref",function(n){e.has(n.name)||e.set(n.name,[]),e.get(n.name).push(n)}),r.on("unref",function(n){if(e.has(n.name)){var i=e.get(n.name),o=i.indexOf(n);o<0||(i.splice(o,1),i.length>1?e.set(n.name,i):e.delete(n.name))}}),r.on("destroyed",function(n){if(e.has(n)){var i=e.get(n);e.delete(n),i.forEach(function(o){o.emit("destroyed",!0)})}})}function Lo(r,e){for(var t=r,n=0,i=e.length;n<i;n++){var o=e[n];if(t=t[o],!t)break}return t}function rp(r,e){return r<e?-1:r>e?1:0}function Ro(r){for(var e=[],t="",n=0,i=r.length;n<i;n++){var o=r[n];n>0&&r[n-1]==="\\"&&(o==="$"||o===".")?t=t.substring(0,t.length-1)+o:o==="."?(e.push(t),t=""):t+=o}return e.push(t),e}function hc(r){return ip.indexOf(r)>-1}function pc(r){return Object.keys(r)[0]}function op(r){return r[pc(r)]}function Pn(r){var e={},t={$or:!0,$nor:!0};return r.forEach(function(n){Object.keys(n).forEach(function(i){var o=n[i];if(typeof o!="object"&&(o={$eq:o}),hc(i))if(o instanceof Array){if(t[i]){t[i]=!1,e[i]=o;return}var a=[];e[i].forEach(function(l){Object.keys(o).forEach(function(c){var u=o[c],d=Math.max(Object.keys(l).length,Object.keys(u).length),f=Pn([l,u]);Object.keys(f).length<=d||a.push(f)})}),e[i]=a}else e[i]=Pn([o]);else{var s=e[i]=e[i]||{};Object.keys(o).forEach(function(l){var c=o[l];if(l==="$gt"||l==="$gte")return ap(l,c,s);if(l==="$lt"||l==="$lte")return sp(l,c,s);if(l==="$ne")return lp(c,s);if(l==="$eq")return cp(c,s);if(l==="$regex")return up(c,s);s[l]=c})}})}),e}function ap(r,e,t){typeof t.$eq=="undefined"&&(typeof t.$gte!="undefined"?r==="$gte"?e>t.$gte&&(t.$gte=e):e>=t.$gte&&(delete t.$gte,t.$gt=e):typeof t.$gt!="undefined"?r==="$gte"?e>t.$gt&&(delete t.$gt,t.$gte=e):e>t.$gt&&(t.$gt=e):t[r]=e)}function sp(r,e,t){typeof t.$eq=="undefined"&&(typeof t.$lte!="undefined"?r==="$lte"?e<t.$lte&&(t.$lte=e):e<=t.$lte&&(delete t.$lte,t.$lt=e):typeof t.$lt!="undefined"?r==="$lte"?e<t.$lt&&(delete t.$lt,t.$lte=e):e<t.$lt&&(t.$lt=e):t[r]=e)}function lp(r,e){"$ne"in e?e.$ne.push(r):e.$ne=[r]}function cp(r,e){delete e.$gt,delete e.$gte,delete e.$lt,delete e.$lte,delete e.$ne,e.$eq=r}function up(r,e){"$regex"in e?e.$regex.push(r):e.$regex=[r]}function gc(r){for(var e in r){if(Array.isArray(r))for(var t in r)r[t].$and&&(r[t]=Pn(r[t].$and));var n=r[e];typeof n=="object"&&gc(n)}return r}function mc(r,e){for(var t in r){t==="$and"&&(e=!0);var n=r[t];typeof n=="object"&&(e=mc(n,e))}return e}function dp(r){var e=$e(r);mc(e,!1)&&(e=gc(e),"$and"in e&&(e=Pn(e.$and))),["$or","$nor"].forEach(function(a){a in e&&e[a].forEach(function(s){for(var l=Object.keys(s),c=0;c<l.length;c++){var u=l[c],d=s[u];(typeof d!="object"||d===null)&&(s[u]={$eq:d})}})}),"$not"in e&&(e.$not=Pn([e.$not]));for(var t=Object.keys(e),n=0;n<t.length;n++){var i=t[n],o=e[i];(typeof o!="object"||o===null)&&(o={$eq:o}),e[i]=o}return ao(e),e}function ao(r){Object.keys(r).forEach(function(e){var t=r[e];Array.isArray(t)?t.forEach(function(n){n&&typeof n=="object"&&ao(n)}):e==="$ne"?r.$ne=[t]:e==="$regex"?r.$regex=[t]:t&&typeof t=="object"&&ao(t)})}function fp(r,e,t){for(var n="",i=t-r.length;n.length<i;)n+=e;return n}function hp(r,e,t){var n=fp(r,e,t);return n+r}function Ee(r,e){if(r===e)return 0;r=Dt(r),e=Dt(e);var t=co(r),n=co(e);if(t-n!==0)return t-n;switch(typeof r){case"number":return r-e;case"boolean":return r<e?-1:1;case"string":return wp(r,e)}return Array.isArray(r)?yp(r,e):bp(r,e)}function Dt(r){switch(typeof r){case"undefined":return null;case"number":return r===1/0||r===-1/0||isNaN(r)?null:r;case"object":var e=r;if(Array.isArray(r)){var t=r.length;r=new Array(t);for(var n=0;n<t;n++)r[n]=Dt(e[n])}else{if(r instanceof Date)return r.toJSON();if(r!==null){r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=e[i];typeof o!="undefined"&&(r[i]=Dt(o))}}}}return r}function pp(r){if(r!==null)switch(typeof r){case"boolean":return r?1:0;case"number":return xp(r);case"string":return r.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var e=Array.isArray(r),t=e?r:Object.keys(r),n=-1,i=t.length,o="";if(e)for(;++n<i;)o+=ot(t[n]);else for(;++n<i;){var a=t[n];o+=ot(a)+ot(r[a])}return o}return""}function ot(r){var e="\0";return r=Dt(r),co(r)+lo+pp(r)+e}function gp(r,e){var t=e,n,i=r[e]==="1";if(i)n=0,e++;else{var o=r[e]==="0";e++;var a="",s=r.substring(e,e+so),l=parseInt(s,10)+vc;for(o&&(l=-l),e+=so;;){var c=r[e];if(c==="\0")break;a+=c,e++}a=a.split("."),a.length===1?n=parseInt(a,10):n=parseFloat(a[0]+"."+a[1]),o&&(n=n-10),l!==0&&(n=parseFloat(n+"e"+l))}return{num:n,length:e-t}}function mp(r,e){var t=r.pop();if(e.length){var n=e[e.length-1];t===n.element&&(e.pop(),n=e[e.length-1]);var i=n.element,o=n.index;if(Array.isArray(i))i.push(t);else if(o===r.length-2){var a=r.pop();i[a]=t}else r.push(t)}}function vp(r){for(var e=[],t=[],n=0;;){var i=r[n++];if(i==="\0"){if(e.length===1)return e.pop();mp(e,t);continue}switch(i){case"1":e.push(null);break;case"2":e.push(r[n]==="1"),n++;break;case"3":var o=gp(r,n);e.push(o.num),n+=o.length;break;case"4":for(var a="";;){var s=r[n];if(s==="\0")break;a+=s,n++}a=a.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),e.push(a);break;case"5":var l={element:[],index:e.length};e.push(l.element),t.push(l);break;case"6":var c={element:{},index:e.length};e.push(c.element),t.push(c);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+i)}}}function yp(r,e){for(var t=Math.min(r.length,e.length),n=0;n<t;n++){var i=Ee(r[n],e[n]);if(i!==0)return i}return r.length===e.length?0:r.length>e.length?1:-1}function wp(r,e){return r===e?0:r>e?1:-1}function bp(r,e){for(var t=Object.keys(r),n=Object.keys(e),i=Math.min(t.length,n.length),o=0;o<i;o++){var a=Ee(t[o],n[o]);if(a!==0||(a=Ee(r[t[o]],e[n[o]]),a!==0))return a}return t.length===n.length?0:t.length>n.length?1:-1}function co(r){var e=["boolean","number","string","object"],t=e.indexOf(typeof r);if(~t)return r===null?1:Array.isArray(r)?5:t<3?t+2:t+3;if(Array.isArray(r))return 5}function xp(r){if(r===0)return"1";var e=r.toExponential().split(/e\+?/),t=parseInt(e[1],10),n=r<0,i=n?"0":"2",o=(n?-t:t)-vc,a=hp(o.toString(),"0",so);i+=lo+a;var s=Math.abs(parseFloat(e[0]));n&&(s=10-s);var l=s.toFixed(20);return l=l.replace(/\.?0+$/,""),i+=lo+l,i}function _p(r){function e(t){return r.map(function(n){var i=pc(n),o=Ro(i),a=Lo(t,o);return a})}return function(t,n){var i=e(t.doc),o=e(n.doc),a=Ee(i,o);return a!==0?a:rp(t.doc._id,n.doc._id)}}function kp(r,e,t){if(r=r.filter(function(a){return on(a.doc,e.selector,t)}),e.sort){var n=_p(e.sort);r=r.sort(n),typeof e.sort[0]!="string"&&op(e.sort[0])==="desc"&&(r=r.reverse())}if("limit"in e||"skip"in e){var i=e.skip||0,o=("limit"in e?e.limit:r.length)+i;r=r.slice(i,o)}return r}function on(r,e,t){return t.every(function(n){var i=e[n],o=Ro(n),a=Lo(r,o);return hc(n)?Sp(n,i,r):Tr(i,r,o,a)})}function Tr(r,e,t,n){return r?typeof r=="object"?Object.keys(r).every(function(i){var o=r[i];if(i.indexOf("$")===0)return Il(i,e,o,t,n);var a=Ro(i);if(n===void 0&&typeof o!="object"&&a.length>0)return!1;var s=Lo(n,a);return typeof o=="object"?Tr(o,e,t,s):Il("$eq",e,o,a,s)}):r===n:!0}function Sp(r,e,t){return r==="$or"?e.some(function(n){return on(t,n,Object.keys(n))}):r==="$not"?!on(t,e,Object.keys(e)):!e.find(function(n){return on(t,n,Object.keys(n))})}function Il(r,e,t,n,i){if(!Ol[r])throw new Error('unknown operator "'+r+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return Ol[r](e,t,n,i)}function Tn(r){return typeof r!="undefined"&&r!==null}function Et(r){return typeof r!="undefined"}function Cp(r,e){if(typeof r!="number"||parseInt(r,10)!==r)return!1;var t=e[0],n=e[1];return r%t===n}function $l(r,e){return e.some(function(t){return r instanceof Array?r.some(function(n){return Ee(t,n)===0}):Ee(t,r)===0})}function Ep(r,e){return e.every(function(t){return r.some(function(n){return Ee(t,n)===0})})}function Tp(r,e){return r.length===e}function Ap(r,e){var t=new RegExp(e);return t.test(r)}function Pp(r,e){switch(e){case"null":return r===null;case"boolean":return typeof r=="boolean";case"number":return typeof r=="number";case"string":return typeof r=="string";case"array":return r instanceof Array;case"object":return{}.toString.call(r)==="[object Object]"}}function Ip(r,e){if(typeof e!="object")throw new Error("Selector error: expected a JSON object");e=dp(e);var t={doc:r},n=kp([t],{selector:e},Object.keys(e));return n&&n.length===1}function $p(r){return Eo(`"use strict";
return `+r+";",{})}function Op(r){var e=["return function(doc) {",'  "use strict";',"  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+r+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join(`
`);return Eo(e,{})}function Dp(r,e){if(r.selector&&r.filter&&r.filter!=="_selector"){var t=typeof r.filter=="string"?r.filter:"function";return e(new Error('selector invalid for filter "'+t+'"'))}e()}function Mp(r){r.view&&!r.filter&&(r.filter="_view"),r.selector&&!r.filter&&(r.filter="_selector"),r.filter&&typeof r.filter=="string"&&(r.filter==="_view"?r.view=Sl(r.view):r.filter=Sl(r.filter))}function Lp(r,e){return e.filter&&typeof e.filter=="string"&&!e.doc_ids&&!dt(r.db)}function Rp(r,e){var t=e.complete;if(e.filter==="_view"){if(!e.view||typeof e.view!="string"){var n=ie($r,"`view` filter parameter not found or invalid.");return t(n)}var i=no(e.view);r.db.get("_design/"+i[0],function(a,s){if(r.isCancelled)return t(null,{status:"cancelled"});if(a)return t(sn(a));var l=s&&s.views&&s.views[i[1]]&&s.views[i[1]].map;if(!l)return t(ie(Ze,s.views?"missing json key: "+i[1]:"missing json key: views"));e.filter=Op(l),r.doChanges(e)})}else if(e.selector)e.filter=function(a){return Ip(a,e.selector)},r.doChanges(e);else{var o=no(e.filter);r.db.get("_design/"+o[0],function(a,s){if(r.isCancelled)return t(null,{status:"cancelled"});if(a)return t(sn(a));var l=s&&s.filters&&s.filters[o[1]];if(!l)return t(ie(Ze,s&&s.filters?"missing json key: "+o[1]:"missing json key: filters"));e.filter=$p(l),r.doChanges(e)})}}function Fp(r){r._changesFilterPlugin={validate:Dp,normalize:Mp,shouldFilter:Lp,filter:Rp}}function Bp(r,e,t){return new Promise(function(n){var i=Ao([""]);let o;if(typeof t=="function"){let s=t(i);o=r.objectStore(e).put(s)}else{let a=t;o=r.objectStore(e).put(i,a)}o.onsuccess=function(){var a=navigator.userAgent.match(/Chrome\/(\d+)/),s=navigator.userAgent.match(/Edge\//);n(s||!a||parseInt(a[1],10)>=43)},o.onerror=r.onabort=function(a){a.preventDefault(),a.stopPropagation(),n(!1)}}).catch(function(){return!1})}function yc(r){return r.reduce(function(e,t){return e[t]=!0,e},{})}function Dl(r){if(!/^\d+-/.test(r))return ie(br);var e=r.indexOf("-"),t=r.substring(0,e),n=r.substring(e+1);return{prefix:parseInt(t,10),id:n}}function jp(r,e){for(var t=r.start-r.ids.length+1,n=r.ids,i=[n[0],e,[]],o=1,a=n.length;o<a;o++)i=[n[o],{status:"missing"},[i]];return[{pos:t,ids:i}]}function wc(r,e,t){t||(t={deterministic_revs:!0});var n,i,o,a={status:"available"};if(r._deleted&&(a.deleted=!0),e)if(r._id||(r._id=Or()),i=ac(r,t.deterministic_revs),r._rev){if(o=Dl(r._rev),o.error)return o;r._rev_tree=[{pos:o.prefix,ids:[o.id,{status:"missing"},[[i,a,[]]]]}],n=o.prefix+1}else r._rev_tree=[{pos:1,ids:[i,a,[]]}],n=1;else if(r._revisions&&(r._rev_tree=jp(r._revisions,a),n=r._revisions.start,i=r._revisions.ids[0]),!r._rev_tree){if(o=Dl(r._rev),o.error)return o;n=o.prefix,i=o.id,r._rev_tree=[{pos:n,ids:[i,a,[]]}]}tc(r._id),r._rev=n+"-"+i;var s={metadata:{},data:{}};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){var c=l[0]==="_";if(c&&!qp[l]){var u=ie(kl,l);throw u.message=kl.message+": "+l,u}else c&&!Np[l]?s.metadata[l.slice(1)]=r[l]:s.data[l]=r[l]}return s}function zp(r){try{return To(r)}catch(t){var e=ie(ec,"Attachment is not a valid base64 string");return{error:e}}}function Hp(r,e,t){var n=zp(r.data);if(n.error)return t(n.error);r.length=n.length,e==="blob"?r.data=Po(n,r.content_type):e==="base64"?r.data=On(n):r.data=n,Oo(n,function(i){r.digest="md5-"+i,t()})}function Up(r,e,t){Oo(r.data,function(n){r.digest="md5-"+n,r.length=r.data.size||r.data.length||0,e==="binary"?ic(r.data,function(i){r.data=i,t()}):e==="base64"?$o(r.data,function(i){r.data=i,t()}):t()})}function Vp(r,e,t){if(r.stub)return t();typeof r.data=="string"?Hp(r,e,t):Up(r,e,t)}function Wp(r,e,t){if(!r.length)return t();var n=0,i;r.forEach(function(a){var s=a.data&&a.data._attachments?Object.keys(a.data._attachments):[],l=0;if(!s.length)return o();function c(d){i=d,l++,l===s.length&&o()}for(var u in a.data._attachments)Object.prototype.hasOwnProperty.call(a.data._attachments,u)&&Vp(a.data._attachments[u],e,c)});function o(){n++,r.length===n&&(i?t(i):t())}}function Kp(r,e,t,n,i,o,a,s){if(Nh(e.rev_tree,t.metadata.rev)&&!s)return n[i]=t,o();var l=e.winningRev||$t(e),c="deleted"in e?e.deleted:vt(e,l),u="deleted"in t.metadata?t.metadata.deleted:vt(t.metadata),d=/^1-/.test(t.metadata.rev);if(c&&!u&&s&&d){var f=t.data;f._rev=l,f._id=t.metadata.id,t=wc(f,s)}var m=cc(e.rev_tree,t.metadata.rev_tree[0],r),b=s&&(c&&u&&m.conflicts!=="new_leaf"||!c&&m.conflicts!=="new_leaf"||c&&!u&&m.conflicts==="new_branch");if(b){var E=ie(an);return n[i]=E,o()}var S=t.metadata.rev;t.metadata.rev_tree=m.tree,t.stemmedRevs=m.stemmedRevs||[],e.rev_map&&(t.metadata.rev_map=e.rev_map);var y=$t(t.metadata),g=vt(t.metadata,y),h=c===g?0:c<g?-1:1,p;S===y?p=g:p=vt(t.metadata,S),a(t,y,g,p,!0,h,i,o)}function Gp(r){return r.metadata.rev_tree[0].ids[1].status==="missing"}function Jp(r,e,t,n,i,o,a,s,l){r=r||1e3;function c(E,S,y){var g=$t(E.metadata),h=vt(E.metadata,g);if("was_delete"in s&&h)return o[S]=ie(Ze,"deleted"),y();var p=u&&Gp(E);if(p){var w=ie(an);return o[S]=w,y()}var k=h?0:1;a(E,g,h,h,!1,k,S,y)}var u=s.new_edits,d=new Map,f=0,m=e.length;function b(){++f===m&&l&&l()}e.forEach(function(E,S){if(E._id&&It(E._id)){var y=E._deleted?"_removeLocal":"_putLocal";t[y](E,{ctx:i},function(h,p){o[S]=h||p,b()});return}var g=E.metadata.id;d.has(g)?(m--,d.get(g).push([E,S])):d.set(g,[[E,S]])}),d.forEach(function(E,S){var y=0;function g(){++y<E.length?h():b()}function h(){var p=E[y],w=p[0],k=p[1];if(n.has(S))Kp(r,n.get(S),w,o,k,g,a,u);else{var R=cc([],w.metadata.rev_tree[0],r);w.metadata.rev_tree=R.tree,w.stemmedRevs=R.stemmedRevs||[],c(w,k,g)}}h()})}function Zp(r){try{return JSON.parse(r)}catch(e){return _o.default.parse(r)}}function Yp(r){try{return JSON.stringify(r)}catch(e){return _o.default.stringify(r)}}function ut(r){return function(e){var t="unknown_error";e.target&&e.target.error&&(t=e.target.error.name||e.target.error.message),r(ie(So,t,e.type))}}function uo(r,e,t){return{data:Yp(r),winningRev:e,deletedOrLocal:t?"1":"0",seq:r.seq,id:r.id}}function Pt(r){if(!r)return null;var e=Zp(r.data);return e.winningRev=r.winningRev,e.deleted=r.deletedOrLocal==="1",e.seq=r.seq,e}function Ar(r){if(!r)return r;var e=r._doc_id_rev.lastIndexOf(":");return r._id=r._doc_id_rev.substring(0,e-1),r._rev=r._doc_id_rev.substring(e+1),delete r._doc_id_rev,r}function bc(r,e,t,n){t?n(r?typeof r!="string"?r:Io(r,e):Ao([""],{type:e})):r?typeof r!="string"?rc(r,function(i){n(On(i))}):n(r):n("")}function xc(r,e,t,n){var i=Object.keys(r._attachments||{});if(!i.length)return n&&n();var o=0;function a(){++o===i.length&&n&&n()}function s(l,c){var u=l._attachments[c],d=u.digest,f=t.objectStore(Ye).get(d);f.onsuccess=function(m){u.body=m.target.result.body,a()}}i.forEach(function(l){e.attachments&&e.include_docs?s(r,l):(r._attachments[l].stub=!0,a())})}function fo(r,e){return Promise.all(r.map(function(t){if(t.doc&&t.doc._attachments){var n=Object.keys(t.doc._attachments);return Promise.all(n.map(function(i){var o=t.doc._attachments[i];if("body"in o){var a=o.body,s=o.content_type;return new Promise(function(l){bc(a,s,e,function(c){t.doc._attachments[i]=Object.assign($n(o,["digest","content_type"]),{data:c}),l()})})}}))}}))}function _c(r,e,t){var n=[],i=t.objectStore(Le),o=t.objectStore(Ye),a=t.objectStore(At),s=r.length;function l(){s--,s||c()}function c(){n.length&&n.forEach(function(u){var d=a.index("digestSeq").count(IDBKeyRange.bound(u+"::",u+"::\uFFFF",!1,!1));d.onsuccess=function(f){var m=f.target.result;m||o.delete(u)}})}r.forEach(function(u){var d=i.index("_doc_id_rev"),f=e+"::"+u;d.getKey(f).onsuccess=function(m){var b=m.target.result;if(typeof b!="number")return l();i.delete(b);var E=a.index("seq").openCursor(IDBKeyRange.only(b));E.onsuccess=function(S){var y=S.target.result;if(y){var g=y.value.digestSeq.split("::")[0];n.push(g),a.delete(y.primaryKey),y.continue()}else l()}}})}function at(r,e,t){try{return{txn:r.transaction(e,t)}}catch(n){return{error:n}}}function Xp(r,e,t,n,i,o){for(var a=e.docs,s,l,c,u,d,f,m,b,E=0,S=a.length;E<S;E++){var y=a[E];y._id&&It(y._id)||(y=a[E]=wc(y,t.new_edits,r),y.error&&!m&&(m=y))}if(m)return o(m);var g=!1,h=0,p=new Array(a.length),w=new Map,k=!1,R=n._meta.blobSupport?"blob":"base64";Wp(a,R,function(C){if(C)return o(C);B()});function B(){var C=[Te,Le,Ye,ct,At,qe],A=at(i,C,"readwrite");if(A.error)return o(A.error);s=A.txn,s.onabort=ut(o),s.ontimeout=ut(o),s.oncomplete=Q,l=s.objectStore(Te),c=s.objectStore(Le),u=s.objectStore(Ye),d=s.objectStore(At),f=s.objectStore(qe),f.get(qe).onsuccess=function(M){b=M.target.result,V()},Z(function(M){if(M)return k=!0,o(M);Y()})}function F(){g=!0,V()}function K(){Jp(r.revs_limit,a,n,w,s,p,te,t,F)}function V(){!b||!g||(b.docCount+=h,f.put(b))}function Y(){if(!a.length)return;var C=0;function A(){++C===a.length&&K()}function M(D){var O=Pt(D.target.result);O&&w.set(O.id,O),A()}for(var q=0,I=a.length;q<I;q++){var T=a[q];if(T._id&&It(T._id)){A();continue}var P=l.get(T.metadata.id);P.onsuccess=M}}function Q(){k||(An.notify(n._meta.name),o(null,p))}function G(C,A){var M=u.get(C);M.onsuccess=function(q){if(q.target.result)A();else{var I=ie(yh,"unknown stub attachment with digest "+C);I.status=412,A(I)}}}function Z(C){var A=[];if(a.forEach(function(T){T.data&&T.data._attachments&&Object.keys(T.data._attachments).forEach(function(P){var D=T.data._attachments[P];D.stub&&A.push(D.digest)})}),!A.length)return C();var M=0,q;function I(){++M===A.length&&C(q)}A.forEach(function(T){G(T,function(P){P&&!q&&(q=P),I()})})}function te(C,A,M,q,I,T,P,D){C.metadata.winningRev=A,C.metadata.deleted=M;var O=C.data;O._id=C.metadata.id,O._rev=C.metadata.rev,q&&(O._deleted=!0);var L=O._attachments&&Object.keys(O._attachments).length;if(L)return v(C,A,M,I,P,D);h+=T,V(),se(C,A,M,I,P,D)}function se(C,A,M,q,I,T){var P=C.data,D=C.metadata;P._doc_id_rev=D.id+"::"+D.rev,delete P._id,delete P._rev;function O(ee){var le=C.stemmedRevs||[];q&&n.auto_compaction&&(le=le.concat(Dh(C.metadata))),le&&le.length&&_c(le,C.metadata.id,s),D.seq=ee.target.result;var ce=uo(D,A,M),W=l.put(ce);W.onsuccess=J}function L(ee){ee.preventDefault(),ee.stopPropagation();var le=c.index("_doc_id_rev"),ce=le.getKey(P._doc_id_rev);ce.onsuccess=function(W){var z=c.put(P,W.target.result);z.onsuccess=O}}function J(){p[I]={ok:!0,id:D.id,rev:D.rev},w.set(C.metadata.id,C.metadata),x(C,D.seq,T)}var U=c.put(P);U.onsuccess=O,U.onerror=L}function v(C,A,M,q,I,T){var P=C.data,D=0,O=Object.keys(P._attachments);function L(){D===O.length&&se(C,A,M,q,I,T)}function J(){D++,L()}O.forEach(function(U){var ee=C.data._attachments[U];if(ee.stub)D++,L();else{var le=ee.data;delete ee.data,ee.revpos=parseInt(A,10);var ce=ee.digest;_(ce,le,J)}})}function x(C,A,M){var q=0,I=Object.keys(C.data._attachments||{});if(!I.length)return M();function T(){++q===I.length&&M()}function P(O){var L=C.data._attachments[O].digest,J=d.put({seq:A,digestSeq:L+"::"+A});J.onsuccess=T,J.onerror=function(U){U.preventDefault(),U.stopPropagation(),T()}}for(var D=0;D<I.length;D++)P(I[D])}function _(C,A,M){var q=u.count(C);q.onsuccess=function(I){var T=I.target.result;if(T)return M();var P={digest:C,body:A},D=u.put(P);D.onsuccess=M}}}function kc(r,e,t,n,i){n===-1&&(n=1e3);var o=typeof r.getAll=="function"&&typeof r.getAllKeys=="function"&&n>1&&!t,a,s,l;function c(m){s=m.target.result,a&&i(a,s,l)}function u(m){a=m.target.result,s&&i(a,s,l)}function d(){if(!a.length)return i();var m=a[a.length-1],b;if(e&&e.upper)try{b=IDBKeyRange.bound(m,e.upper,!0,e.upperOpen)}catch(E){if(E.name==="DataError"&&E.code===0)return i()}else b=IDBKeyRange.lowerBound(m,!0);e=b,a=null,s=null,r.getAll(e,n).onsuccess=c,r.getAllKeys(e,n).onsuccess=u}function f(m){var b=m.target.result;if(!b)return i();i([b.key],[b.value],b)}o?(l={continue:d},r.getAll(e,n).onsuccess=c,r.getAllKeys(e,n).onsuccess=u):t?r.openCursor(e,"prev").onsuccess=f:r.openCursor(e).onsuccess=f}function eg(r,e,t){if(typeof r.getAll=="function"){r.getAll(e).onsuccess=t;return}var n=[];function i(o){var a=o.target.result;a?(n.push(a.value),a.continue()):t({target:{result:n}})}r.openCursor(e).onsuccess=i}function tg(r,e,t){var n=new Array(r.length),i=0;r.forEach(function(o,a){e.get(o).onsuccess=function(s){s.target.result?n[a]=s.target.result:n[a]={key:o,error:"not_found"},i++,i===r.length&&t(r,n,{})}})}function ng(r,e,t,n,i){try{if(r&&e)return i?IDBKeyRange.bound(e,r,!t,!1):IDBKeyRange.bound(r,e,!1,!t);if(r)return i?IDBKeyRange.upperBound(r):IDBKeyRange.lowerBound(r);if(e)return i?IDBKeyRange.lowerBound(e,!t):IDBKeyRange.upperBound(e,!t);if(n)return IDBKeyRange.only(n)}catch(o){return{error:o}}return null}function rg(r,e,t){var n="startkey"in r?r.startkey:!1,i="endkey"in r?r.endkey:!1,o="key"in r?r.key:!1,a="keys"in r?r.keys:!1,s=r.skip||0,l=typeof r.limit=="number"?r.limit:-1,c=r.inclusive_end!==!1,u,d;if(!a&&(u=ng(n,i,c,o,r.descending),d=u&&u.error,d&&!(d.name==="DataError"&&d.code===0)))return t(ie(So,d.name,d.message));var f=[Te,Le,qe];r.attachments&&f.push(Ye);var m=at(e,f,"readonly");if(m.error)return t(m.error);var b=m.txn;b.oncomplete=Y,b.onabort=ut(t);var E=b.objectStore(Te),S=b.objectStore(Le),y=b.objectStore(qe),g=S.index("_doc_id_rev"),h=[],p,w;y.get(qe).onsuccess=function(Q){p=Q.target.result.docCount},r.update_seq&&(S.openKeyCursor(null,"prev").onsuccess=Q=>{var G=Q.target.result;G&&G.key&&(w=G.key)});function k(Q,G,Z){var te=Q.id+"::"+Z;g.get(te).onsuccess=function(v){if(G.doc=Ar(v.target.result)||{},r.conflicts){var x=Mo(Q);x.length&&(G.doc._conflicts=x)}xc(G.doc,r,b)}}function R(Q,G){var Z={id:G.id,key:G.id,value:{rev:Q}},te=G.deleted;te?a&&(h.push(Z),Z.value.deleted=!0,Z.doc=null):s--<=0&&(h.push(Z),r.include_docs&&k(G,Z,Q))}function B(Q){for(var G=0,Z=Q.length;G<Z&&h.length!==l;G++){var te=Q[G];if(te.error&&a){h.push(te);continue}var se=Pt(te),v=se.winningRev;R(v,se)}}function F(Q,G,Z){Z&&(B(G),h.length<l&&Z.continue())}function K(Q){var G=Q.target.result;r.descending&&(G=G.reverse()),B(G)}function V(){var Q={total_rows:p,offset:r.skip,rows:h};r.update_seq&&w!==void 0&&(Q.update_seq=w),t(null,Q)}function Y(){r.attachments?fo(h,r.binary).then(V):V()}if(!(d||l===0)){if(a)return tg(a,E,F);if(l===-1)return eg(E,u,K);kc(E,u,r.descending,l+s,F)}}function ig(r,e){var t=r.objectStore(Te).index("deletedOrLocal");t.count(IDBKeyRange.only("0")).onsuccess=function(n){e(n.target.result)}}function og(r,e,t,n){try{r(e,t)}catch(i){n.emit("error",i)}}function Ml(){ho||!po.length||(ho=!0,po.shift()())}function ag(r,e,t){po.push(function(){r(function(o,a){og(e,o,a,t),ho=!1,ht(function(){Ml(t)})})}),Ml()}function sg(r,e,t,n){if(r=$e(r),r.continuous){var i=t+":"+Or();return An.addListener(t,i,e,r),An.notify(t),{cancel:function(){An.removeListener(t,i)}}}var o=r.doc_ids&&new Set(r.doc_ids);r.since=r.since||0;var a=r.since,s="limit"in r?r.limit:-1;s===0&&(s=1);var l=[],c=0,u=Co(r),d=new Map,f,m,b,E;function S(B,F,K){if(!K||!B.length)return;var V=new Array(B.length),Y=new Array(B.length);function Q(te,se){var v=r.processChange(se,te,r);a=v.seq=te.seq;var x=u(v);return typeof x=="object"?Promise.reject(x):x?(c++,r.return_docs&&l.push(v),r.attachments&&r.include_docs?new Promise(function(_){xc(se,r,f,function(){fo([v],r.binary).then(function(){_(v)})})}):Promise.resolve(v)):Promise.resolve()}function G(){for(var te=[],se=0,v=V.length;se<v&&c!==s;se++){var x=V[se];if(x){var _=Y[se];te.push(Q(_,x))}}Promise.all(te).then(function(C){for(var A=0,M=C.length;A<M;A++)C[A]&&r.onChange(C[A])}).catch(r.complete),c!==s&&K.continue()}var Z=0;F.forEach(function(te,se){var v=Ar(te),x=B[se];g(v,x,function(_,C){Y[se]=_,V[se]=C,++Z===B.length&&G()})})}function y(B,F,K,V){if(K.seq!==F)return V();if(K.winningRev===B._rev)return V(K,B);var Y=B._id+"::"+K.winningRev,Q=E.get(Y);Q.onsuccess=function(G){V(K,Ar(G.target.result))}}function g(B,F,K){if(o&&!o.has(B._id))return K();var V=d.get(B._id);if(V)return y(B,F,V,K);b.get(B._id).onsuccess=function(Y){V=Pt(Y.target.result),d.set(B._id,V),y(B,F,V,K)}}function h(){r.complete(null,{results:l,last_seq:a})}function p(){!r.continuous&&r.attachments?fo(l).then(h):h()}var w=[Te,Le];r.attachments&&w.push(Ye);var k=at(n,w,"readonly");if(k.error)return r.complete(k.error);f=k.txn,f.onabort=ut(r.complete),f.oncomplete=p,m=f.objectStore(Le),b=f.objectStore(Te),E=m.index("_doc_id_rev");var R=r.since&&!r.descending?IDBKeyRange.lowerBound(r.since,!0):null;kc(m,R,r.descending,s,S)}function Sc(r,e){var t=this;ag(function(n){lg(t,r,n)},e,t.constructor)}function lg(r,e,t){var n=e.name,i=null,o=null;r._meta=null;function a(S){return function(y,g){y&&y instanceof Error&&!y.reason&&o&&(y.reason=o),S(y,g)}}function s(S){var y=S.createObjectStore(Te,{keyPath:"id"});S.createObjectStore(Le,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),S.createObjectStore(Ye,{keyPath:"digest"}),S.createObjectStore(qe,{keyPath:"id",autoIncrement:!1}),S.createObjectStore(Ui),y.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),S.createObjectStore(ct,{keyPath:"_id"});var g=S.createObjectStore(At,{autoIncrement:!0});g.createIndex("seq","seq"),g.createIndex("digestSeq","digestSeq",{unique:!0})}function l(S,y){var g=S.objectStore(Te);g.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),g.openCursor().onsuccess=function(h){var p=h.target.result;if(p){var w=p.value,k=vt(w);w.deletedOrLocal=k?"1":"0",g.put(w),p.continue()}else y()}}function c(S){S.createObjectStore(ct,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function u(S,y){var g=S.objectStore(ct),h=S.objectStore(Te),p=S.objectStore(Le),w=h.openCursor();w.onsuccess=function(k){var R=k.target.result;if(R){var B=R.value,F=B.id,K=It(F),V=$t(B);if(K){var Y=F+"::"+V,Q=F+"::",G=F+"::~",Z=p.index("_doc_id_rev"),te=IDBKeyRange.bound(Q,G,!1,!1),se=Z.openCursor(te);se.onsuccess=function(v){if(se=v.target.result,!se)h.delete(R.primaryKey),R.continue();else{var x=se.value;x._doc_id_rev===Y&&g.put(x),p.delete(se.primaryKey),se.continue()}}}else R.continue()}else y&&y()}}function d(S){var y=S.createObjectStore(At,{autoIncrement:!0});y.createIndex("seq","seq"),y.createIndex("digestSeq","digestSeq",{unique:!0})}function f(S,y){var g=S.objectStore(Le),h=S.objectStore(Ye),p=S.objectStore(At),w=h.count();w.onsuccess=function(k){var R=k.target.result;if(!R)return y();g.openCursor().onsuccess=function(B){var F=B.target.result;if(!F)return y();for(var K=F.value,V=F.primaryKey,Y=Object.keys(K._attachments||{}),Q={},G=0;G<Y.length;G++){var Z=K._attachments[Y[G]];Q[Z.digest]=!0}var te=Object.keys(Q);for(G=0;G<te.length;G++){var se=te[G];p.put({seq:V,digestSeq:se+"::"+V})}F.continue()}}}function m(S){function y(w){return w.data?Pt(w):(w.deleted=w.deletedOrLocal==="1",w)}var g=S.objectStore(Le),h=S.objectStore(Te),p=h.openCursor();p.onsuccess=function(w){var k=w.target.result;if(!k)return;var R=y(k.value);R.winningRev=R.winningRev||$t(R);function B(){var K=R.id+"::",V=R.id+"::\uFFFF",Y=g.index("_doc_id_rev").openCursor(IDBKeyRange.bound(K,V)),Q=0;Y.onsuccess=function(G){var Z=G.target.result;if(!Z)return R.seq=Q,F();var te=Z.primaryKey;te>Q&&(Q=te),Z.continue()}}function F(){var K=uo(R,R.winningRev,R.deleted),V=h.put(K);V.onsuccess=function(){k.continue()}}if(R.seq)return F();B()}}r._remote=!1,r.type=function(){return"idb"},r._id=Zl(function(S){S(null,r._meta.instanceId)}),r._bulkDocs=function(y,g,h){Xp(e,y,g,r,i,a(h))},r._get=function(y,g,h){var p,w,k,R=g.ctx;if(!R){var B=at(i,[Te,Le,Ye],"readonly");if(B.error)return h(B.error);R=B.txn}function F(){h(k,{doc:p,metadata:w,ctx:R})}R.objectStore(Te).get(y).onsuccess=function(K){if(w=Pt(K.target.result),!w)return k=ie(Ze,"missing"),F();var V;if(g.rev)V=g.latest?zh(g.rev,w):g.rev;else{V=w.winningRev;var Y=vt(w);if(Y)return k=ie(Ze,"deleted"),F()}var Q=R.objectStore(Le),G=w.id+"::"+V;Q.index("_doc_id_rev").get(G).onsuccess=function(Z){if(p=Z.target.result,p&&(p=Ar(p)),!p)return k=ie(Ze,"missing"),F();F()}}},r._getAttachment=function(S,y,g,h,p){var w;if(h.ctx)w=h.ctx;else{var k=at(i,[Te,Le,Ye],"readonly");if(k.error)return p(k.error);w=k.txn}var R=g.digest,B=g.content_type;w.objectStore(Ye).get(R).onsuccess=function(F){var K=F.target.result.body;bc(K,B,h.binary,function(V){p(null,V)})}},r._info=function(y){var g,h,p=at(i,[qe,Le],"readonly");if(p.error)return y(p.error);var w=p.txn;w.objectStore(qe).get(qe).onsuccess=function(k){h=k.target.result.docCount},w.objectStore(Le).openKeyCursor(null,"prev").onsuccess=function(k){var R=k.target.result;g=R?R.key:0},w.oncomplete=function(){y(null,{doc_count:h,update_seq:g,idb_attachment_format:r._meta.blobSupport?"binary":"base64"})}},r._allDocs=function(y,g){rg(y,i,a(g))},r._changes=function(y){return sg(y,r,n,i)},r._close=function(S){i.close(),nn.delete(n),S()},r._getRevisionTree=function(S,y){var g=at(i,[Te],"readonly");if(g.error)return y(g.error);var h=g.txn,p=h.objectStore(Te).get(S);p.onsuccess=function(w){var k=Pt(w.target.result);k?y(null,k.rev_tree):y(ie(Ze))}},r._doCompaction=function(S,y,g){var h=[Te,Le,Ye,At],p=at(i,h,"readwrite");if(p.error)return g(p.error);var w=p.txn,k=w.objectStore(Te);k.get(S).onsuccess=function(R){var B=Pt(R.target.result);Ot(B.rev_tree,function(V,Y,Q,G,Z){var te=Y+"-"+Q;y.indexOf(te)!==-1&&(Z.status="missing")}),_c(y,S,w);var F=B.winningRev,K=B.deleted;w.objectStore(Te).put(uo(B,F,K))},w.onabort=ut(g),w.oncomplete=function(){g()}},r._getLocal=function(S,y){var g=at(i,[ct],"readonly");if(g.error)return y(g.error);var h=g.txn,p=h.objectStore(ct).get(S);p.onerror=ut(y),p.onsuccess=function(w){var k=w.target.result;k?(delete k._doc_id_rev,y(null,k)):y(ie(Ze))}},r._putLocal=function(S,y,g){typeof y=="function"&&(g=y,y={}),delete S._revisions;var h=S._rev,p=S._id;h?S._rev="0-"+(parseInt(h.split("-")[1],10)+1):S._rev="0-1";var w=y.ctx,k;if(!w){var R=at(i,[ct],"readwrite");if(R.error)return g(R.error);w=R.txn,w.onerror=ut(g),w.oncomplete=function(){k&&g(null,k)}}var B=w.objectStore(ct),F;h?(F=B.get(p),F.onsuccess=function(K){var V=K.target.result;if(!V||V._rev!==h)g(ie(an));else{var Y=B.put(S);Y.onsuccess=function(){k={ok:!0,id:S._id,rev:S._rev},y.ctx&&g(null,k)}}}):(F=B.add(S),F.onerror=function(K){g(ie(an)),K.preventDefault(),K.stopPropagation()},F.onsuccess=function(){k={ok:!0,id:S._id,rev:S._rev},y.ctx&&g(null,k)})},r._removeLocal=function(S,y,g){typeof y=="function"&&(g=y,y={});var h=y.ctx;if(!h){var p=at(i,[ct],"readwrite");if(p.error)return g(p.error);h=p.txn,h.oncomplete=function(){w&&g(null,w)}}var w,k=S._id,R=h.objectStore(ct),B=R.get(k);B.onerror=ut(g),B.onsuccess=function(F){var K=F.target.result;!K||K._rev!==S._rev?g(ie(Ze)):(R.delete(k),w={ok:!0,id:k,rev:"0-0"},y.ctx&&g(null,w))}},r._destroy=function(S,y){An.removeAllListeners(n);var g=Wi.get(n);g&&g.result&&(g.result.close(),nn.delete(n));var h=indexedDB.deleteDatabase(n);h.onsuccess=function(){Wi.delete(n),kr()&&n in localStorage&&delete localStorage[n],y(null,{ok:!0})},h.onerror=ut(y)};var b=nn.get(n);if(b)return i=b.idb,r._meta=b.global,ht(function(){t(null,r)});var E=indexedDB.open(n,Qp);Wi.set(n,E),E.onupgradeneeded=function(S){var y=S.target.result;if(S.oldVersion<1)return s(y);var g=S.currentTarget.transaction;S.oldVersion<3&&c(y),S.oldVersion<4&&d(y);var h=[l,u,f,m],p=S.oldVersion;function w(){var k=h[p-1];p++,k&&k(g,w)}w()},E.onsuccess=function(S){i=S.target.result,i.onversionchange=function(){i.close(),nn.delete(n)},i.onabort=function(F){Xe("error","Database has a global failure",F.target.error),o=F.target.error,i.close(),nn.delete(n)};var y=i.transaction([qe,Ui,Te],"readwrite"),g=!1,h,p,w,k;function R(){typeof w=="undefined"||!g||(r._meta={name:n,instanceId:k,blobSupport:w},nn.set(n,{idb:i,global:r._meta}),t(null,r))}function B(){if(!(typeof p=="undefined"||typeof h=="undefined")){var F=n+"_id";F in h?k=h[F]:h[F]=k=Or(),h.docCount=p,y.objectStore(qe).put(h)}}y.objectStore(qe).get(qe).onsuccess=function(F){h=F.target.result||{id:qe},B()},ig(y,function(F){p=F,B()}),Vi||(Vi=Bp(y,Ui,"key")),Vi.then(function(F){w=F,R()}),y.oncomplete=function(){g=!0,R()},y.onabort=ut(t)},E.onerror=function(S){var y=S.target.error&&S.target.error.message;y?y.indexOf("stored database is a higher version")!==-1&&(y=new Error('This DB was created with the newer "indexeddb" adapter, but you are trying to open it with the older "idb" adapter')):y="Failed to open indexedDB, are you in private browsing mode?",Xe("error",y),t(ie(So,y))}}function cg(r){r.adapter("idb",Sc,!0)}function ug(r,e){return new Promise(function(t,n){var i=0,o=0,a=0,s=r.length,l;function c(){i++,r[o++]().then(d,f)}function u(){++a===s?l?n(l):t():m()}function d(){i--,u()}function f(b){i--,l=l||b,u()}function m(){for(;i<e&&o<s;)c()}m()})}function Gi(r){let e=r.doc||r.ok,t=e&&e._attachments;t&&Object.keys(t).forEach(function(n){let i=t[n];i.data=Io(i.data,i.content_type)})}function Tt(r){return/^_design/.test(r)?"_design/"+encodeURIComponent(r.slice(8)):r.startsWith("_local/")?"_local/"+encodeURIComponent(r.slice(7)):encodeURIComponent(r)}function Ll(r){return!r._attachments||!Object.keys(r._attachments)?Promise.resolve():Promise.all(Object.keys(r._attachments).map(function(e){let t=r._attachments[e];if(t.data&&typeof t.data!="string")return new Promise(function(n){$o(t.data,n)}).then(function(n){t.data=n})}))}function pg(r){if(!r.prefix)return!1;let e=nc(r.prefix).protocol;return e==="http"||e==="https"}function gg(r,e){if(pg(e)){let i=e.name.substr(e.prefix.length);r=e.prefix.replace(/\/?$/,"/")+encodeURIComponent(i)}let t=nc(r);(t.user||t.password)&&(t.auth={username:t.user,password:t.password});let n=t.path.replace(/(^\/|\/$)/g,"").split("/");return t.db=n.pop(),t.db.indexOf("%")===-1&&(t.db=encodeURIComponent(t.db)),t.path=n.join("/"),t}function Ie(r,e){return xr(r,r.db+"/"+e)}function xr(r,e){let t=r.path?"/":"";return r.protocol+"://"+r.host+(r.port?":"+r.port:"")+"/"+r.path+t+e}function wr(r){let e=Object.keys(r);return e.length===0?"":"?"+e.map(t=>t+"="+encodeURIComponent(r[t])).join("&")}function mg(r){let e=typeof navigator!="undefined"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",t=e.indexOf("msie")!==-1,n=e.indexOf("trident")!==-1,i=e.indexOf("edge")!==-1,o=!("method"in r)||r.method==="GET";return(t||n||i)&&o}function go(r,e){let t=this,n=gg(r.name,r),i=Ie(n,"");r=$e(r);let o=async function(d,f){if(f=f||{},f.headers=f.headers||new rn,f.credentials="include",r.auth||n.auth){let E=r.auth||n.auth,S=E.username+":"+E.password,y=On(unescape(encodeURIComponent(S)));f.headers.set("Authorization","Basic "+y)}let m=r.headers||{};return Object.keys(m).forEach(function(E){f.headers.append(E,m[E])}),mg(f)&&(d+=(d.indexOf("?")===-1?"?":"&")+"_nonce="+Date.now()),await(r.fetch||fc)(d,f)};function a(d,f){return Ce(d,function(...m){c().then(function(){return f.apply(this,m)}).catch(function(b){m.pop()(b)})}).bind(t)}async function s(d,f){let m={};f=f||{},f.headers=f.headers||new rn,f.headers.get("Content-Type")||f.headers.set("Content-Type","application/json"),f.headers.get("Accept")||f.headers.set("Accept","application/json");let b=await o(d,f);m.ok=b.ok,m.status=b.status;let E=await b.json();if(m.data=E,!m.ok)throw m.data.status=m.status,sn(m.data);return Array.isArray(m.data)&&(m.data=m.data.map(function(S){return S.error||S.missing?sn(S):S})),m}let l;async function c(){return r.skip_setup?Promise.resolve():l||(l=s(i).catch(function(d){return d&&d.status&&d.status===404?(to(404,"PouchDB is just detecting if the remote exists."),s(i,{method:"PUT"})):Promise.reject(d)}).catch(function(d){return d&&d.status&&d.status===412?!0:Promise.reject(d)}),l.catch(function(){l=null}),l)}ht(function(){e(null,t)}),t._remote=!0,t.type=function(){return"http"},t.id=a("id",async function(d){let f;try{f=await(await o(xr(n,""))).json()}catch(b){f={}}let m=f&&f.uuid?f.uuid+n.db:Ie(n,"");d(null,m)}),t.compact=a("compact",async function(d,f){typeof d=="function"&&(f=d,d={}),d=$e(d),await s(Ie(n,"_compact"),{method:"POST"});function m(){t.info(function(b,E){E&&!E.compact_running?f(null,{ok:!0}):setTimeout(m,d.interval||200)})}m()}),t.bulkGet=Ce("bulkGet",function(d,f){let m=this;async function b(g){let h={};d.revs&&(h.revs=!0),d.attachments&&(h.attachments=!0),d.latest&&(h.latest=!0);try{let p=await s(Ie(n,"_bulk_get"+wr(h)),{method:"POST",body:JSON.stringify({docs:d.docs})});d.attachments&&d.binary&&p.data.results.forEach(function(w){w.docs.forEach(Gi)}),g(null,p.data)}catch(p){g(p)}}function E(){let g=fg,h=Math.ceil(d.docs.length/g),p=0,w=new Array(h);function k(R){return function(B,F){w[R]=F.results,++p===h&&f(null,{results:w.flat()})}}for(let R=0;R<h;R++){let B=$n(d,["revs","attachments","binary","latest"]);B.docs=d.docs.slice(R*g,Math.min(d.docs.length,(R+1)*g)),Yl(m,B,k(R))}}let S=xr(n,""),y=Ki[S];typeof y!="boolean"?b(function(g,h){g?(Ki[S]=!1,to(g.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),E()):(Ki[S]=!0,f(null,h))}):y?b(f):E()}),t._info=async function(d){try{await c();let m=await(await o(Ie(n,""))).json();m.host=Ie(n,""),d(null,m)}catch(f){d(f)}},t.fetch=async function(d,f){await c();let m=d.substring(0,1)==="/"?xr(n,d.substring(1)):Ie(n,d);return o(m,f)},t.get=a("get",async function(d,f,m){typeof f=="function"&&(m=f,f={}),f=$e(f);let b={};f.revs&&(b.revs=!0),f.revs_info&&(b.revs_info=!0),f.latest&&(b.latest=!0),f.open_revs&&(f.open_revs!=="all"&&(f.open_revs=JSON.stringify(f.open_revs)),b.open_revs=f.open_revs),f.rev&&(b.rev=f.rev),f.conflicts&&(b.conflicts=f.conflicts),f.update_seq&&(b.update_seq=f.update_seq),d=Tt(d);function E(g){let h=g._attachments,p=h&&Object.keys(h);if(!h||!p.length)return;async function w(R){let B=h[R],F=Tt(g._id)+"/"+u(R)+"?rev="+g._rev,K=await o(Ie(n,F)),V;"buffer"in K?V=await K.buffer():V=await K.blob();let Y;if(f.binary){let Q=Object.getOwnPropertyDescriptor(V.__proto__,"type");(!Q||Q.set)&&(V.type=B.content_type),Y=V}else Y=await new Promise(function(Q){$o(V,Q)});delete B.stub,delete B.length,B.data=Y}let k=p.map(function(R){return function(){return w(R)}});return ug(k,5)}function S(g){return Array.isArray(g)?Promise.all(g.map(function(h){if(h.ok)return E(h.ok)})):E(g)}let y=Ie(n,d+wr(b));try{let g=await s(y);f.attachments&&await S(g.data),m(null,g.data)}catch(g){g.docId=d,m(g)}}),t.remove=a("remove",async function(d,f,m,b){let E;typeof f=="string"?(E={_id:d,_rev:f},typeof m=="function"&&(b=m,m={})):(E=d,typeof f=="function"?(b=f,m={}):(b=m,m=f));let S=E._rev||m.rev,y=Ie(n,Tt(E._id))+"?rev="+S;try{let g=await s(y,{method:"DELETE"});b(null,g.data)}catch(g){b(g)}});function u(d){return d.split("/").map(encodeURIComponent).join("/")}t.getAttachment=a("getAttachment",async function(d,f,m,b){typeof m=="function"&&(b=m,m={});let E=m.rev?"?rev="+m.rev:"",S=Ie(n,Tt(d))+"/"+u(f)+E,y;try{let g=await o(S,{method:"GET"});if(!g.ok)throw g;y=g.headers.get("content-type");let h;if(typeof process!="undefined"&&!process.browser&&typeof g.buffer=="function"?h=await g.buffer():h=await g.blob(),typeof process!="undefined"&&!process.browser){let p=Object.getOwnPropertyDescriptor(h.__proto__,"type");(!p||p.set)&&(h.type=y)}b(null,h)}catch(g){b(g)}}),t.removeAttachment=a("removeAttachment",async function(d,f,m,b){let E=Ie(n,Tt(d)+"/"+u(f))+"?rev="+m;try{let S=await s(E,{method:"DELETE"});b(null,S.data)}catch(S){b(S)}}),t.putAttachment=a("putAttachment",async function(d,f,m,b,E,S){typeof E=="function"&&(S=E,E=b,b=m,m=null);let y=Tt(d)+"/"+u(f),g=Ie(n,y);if(m&&(g+="?rev="+m),typeof b=="string"){let h;try{h=To(b)}catch(p){return S(ie(ec,"Attachment is not a valid base64 string"))}b=h?Po(h,E):""}try{let h=await s(g,{headers:new rn({"Content-Type":E}),method:"PUT",body:b});S(null,h.data)}catch(h){S(h)}}),t._bulkDocs=async function(d,f,m){d.new_edits=f.new_edits;try{await c(),await Promise.all(d.docs.map(Ll));let b=await s(Ie(n,"_bulk_docs"),{method:"POST",body:JSON.stringify(d)});m(null,b.data)}catch(b){m(b)}},t._put=async function(d,f,m){try{await c(),await Ll(d);let b=await s(Ie(n,Tt(d._id)),{method:"PUT",body:JSON.stringify(d)});m(null,b.data)}catch(b){b.docId=d&&d._id,m(b)}},t.allDocs=a("allDocs",async function(d,f){typeof d=="function"&&(f=d,d={}),d=$e(d);let m={},b,E="GET";d.conflicts&&(m.conflicts=!0),d.update_seq&&(m.update_seq=!0),d.descending&&(m.descending=!0),d.include_docs&&(m.include_docs=!0),d.attachments&&(m.attachments=!0),d.key&&(m.key=JSON.stringify(d.key)),d.start_key&&(d.startkey=d.start_key),d.startkey&&(m.startkey=JSON.stringify(d.startkey)),d.end_key&&(d.endkey=d.end_key),d.endkey&&(m.endkey=JSON.stringify(d.endkey)),typeof d.inclusive_end!="undefined"&&(m.inclusive_end=!!d.inclusive_end),typeof d.limit!="undefined"&&(m.limit=d.limit),typeof d.skip!="undefined"&&(m.skip=d.skip);let S=wr(m);typeof d.keys!="undefined"&&(E="POST",b={keys:d.keys});try{let y=await s(Ie(n,"_all_docs"+S),{method:E,body:JSON.stringify(b)});d.include_docs&&d.attachments&&d.binary&&y.data.rows.forEach(Gi),f(null,y.data)}catch(y){f(y)}}),t._changes=function(d){let f="batch_size"in d?d.batch_size:dg;d=$e(d),d.continuous&&!("heartbeat"in d)&&(d.heartbeat=hg);let m="timeout"in d?d.timeout:30*1e3;"timeout"in d&&d.timeout&&m-d.timeout<yr&&(m=d.timeout+yr),"heartbeat"in d&&d.heartbeat&&m-d.heartbeat<yr&&(m=d.heartbeat+yr);let b={};"timeout"in d&&d.timeout&&(b.timeout=d.timeout);let E=typeof d.limit!="undefined"?d.limit:!1,S=E;if(d.style&&(b.style=d.style),(d.include_docs||d.filter&&typeof d.filter=="function")&&(b.include_docs=!0),d.attachments&&(b.attachments=!0),d.continuous&&(b.feed="longpoll"),d.seq_interval&&(b.seq_interval=d.seq_interval),d.conflicts&&(b.conflicts=!0),d.descending&&(b.descending=!0),d.update_seq&&(b.update_seq=!0),"heartbeat"in d&&d.heartbeat&&(b.heartbeat=d.heartbeat),d.filter&&typeof d.filter=="string"&&(b.filter=d.filter),d.view&&typeof d.view=="string"&&(b.filter="_view",b.view=d.view),d.query_params&&typeof d.query_params=="object")for(let B in d.query_params)Object.prototype.hasOwnProperty.call(d.query_params,B)&&(b[B]=d.query_params[B]);let y="GET",g;d.doc_ids?(b.filter="_doc_ids",y="POST",g={doc_ids:d.doc_ids}):d.selector&&(b.filter="_selector",y="POST",g={selector:d.selector});let h=new AbortController,p,w=async function(B,F){if(d.aborted)return;b.since=B,typeof b.since=="object"&&(b.since=JSON.stringify(b.since)),d.descending?E&&(b.limit=S):b.limit=!E||S>f?f:S;let K=Ie(n,"_changes"+wr(b)),V={signal:h.signal,method:y,body:JSON.stringify(g)};if(p=B,!d.aborted)try{await c();let Y=await s(K,V);F(null,Y.data)}catch(Y){F(Y)}},k={results:[]},R=function(B,F){if(d.aborted)return;let K=0;if(F&&F.results){K=F.results.length,k.last_seq=F.last_seq;let Y=null,Q=null;typeof F.pending=="number"&&(Y=F.pending),(typeof k.last_seq=="string"||typeof k.last_seq=="number")&&(Q=k.last_seq);let G={};G.query=d.query_params,F.results=F.results.filter(function(Z){S--;let te=Co(d)(Z);return te&&(d.include_docs&&d.attachments&&d.binary&&Gi(Z),d.return_docs&&k.results.push(Z),d.onChange(Z,Y,Q)),te})}else if(B){d.aborted=!0,d.complete(B);return}F&&F.last_seq&&(p=F.last_seq);let V=E&&S<=0||F&&K<f||d.descending;d.continuous&&!(E&&S<=0)||!V?ht(function(){w(p,R)}):d.complete(null,k)};return w(d.since||0,R),{cancel:function(){d.aborted=!0,h.abort()}}},t.revsDiff=a("revsDiff",async function(d,f,m){typeof f=="function"&&(m=f,f={});try{let b=await s(Ie(n,"_revs_diff"),{method:"POST",body:JSON.stringify(d)});m(null,b.data)}catch(b){m(b)}}),t._close=function(d){d()},t._destroy=async function(d,f){try{let m=await s(Ie(n,""),{method:"DELETE"});f(null,m)}catch(m){m.status===404?f(null,{ok:!0}):f(m)}}}function vg(r){r.adapter("http",go,!1),r.adapter("https",go,!1)}function Cc(r,e){return e&&r.then(function(t){ht(function(){e(null,t)})},function(t){ht(function(){e(t)})}),r}function yg(r){return function(...e){var t=e.pop(),n=r.apply(this,e);return typeof t=="function"&&Cc(n,t),n}}function wg(r,e){return r.then(function(t){return e().then(function(){return t})},function(t){return e().then(function(){throw t})})}function Ji(r,e){return function(){var t=arguments,n=this;return r.add(function(){return e.apply(n,t)})}}function Rl(r){var e=new Set(r),t=new Array(e.size),n=-1;return e.forEach(function(i){t[++n]=i}),t}function Qi(r){var e=new Array(r.size),t=-1;return r.forEach(function(n,i){e[++t]=i}),e}function Fl(r){var e="builtin "+r+" function requires map values to be numbers or number arrays";return new cn(e)}function mo(r){for(var e=0,t=0,n=r.length;t<n;t++){var i=r[t];if(typeof i!="number")if(Array.isArray(i)){e=typeof e=="number"?[e]:e;for(var o=0,a=i.length;o<a;o++){var s=i[o];if(typeof s!="number")throw Fl("_sum");typeof e[o]=="undefined"?e.push(s):e[o]+=s}}else throw Fl("_sum");else typeof e=="number"?e+=i:e[0]+=i}return e}function Ec(r,e){return Eo("return ("+r.replace(/;\s*$/,"")+");",{emit:e,sum:mo,log:bg,isArray:xg,toJSON:_g})}function Bl(r){if(!r)return"undefined";switch(typeof r){case"function":return r.toString();case"string":return r.toString();default:return JSON.stringify(r)}}function kg(r,e){return Bl(r)+Bl(e)+"undefined"}async function ql(r,e,t,n,i,o){let a=kg(t,n),s;if(!i&&(s=r._cachedViews=r._cachedViews||{},s[a]))return s[a];let l=r.info().then(async function(c){let u=c.db_name+"-mrview-"+(i?"temp":oc(a));function d(S){S.views=S.views||{};let y=e;y.indexOf("/")===-1&&(y=e+"/"+e);let g=S.views[y]=S.views[y]||{};if(!g[u])return g[u]=!0,S}await Sr(r,"_local/"+o,d);let m=(await r.registerDependentDatabase(u)).db;m.auto_compaction=!0;let b={name:u,db:m,sourceDB:r,adapter:r.adapter,mapFun:t,reduceFun:n},E;try{E=await b.db.get("_local/lastSeq")}catch(S){if(S.status!==404)throw S}return b.seq=E?E.seq:0,s&&b.db.once("destroyed",function(){delete s[a]}),b});return s&&(s[a]=l),l}function Zi(r){return r.indexOf("/")===-1?[r,r]:r.split("/")}function Cg(r){return r.length===1&&/^1-/.test(r[0].rev)}function zl(r,e,t){try{r.emit("error",e)}catch(n){Xe("error",`The user's map/reduce function threw an uncaught error.
You can debug this error by doing:
myDatabase.on('error', function (err) { debugger; });
Please double-check your map/reduce function.`),Xe("error",e,t)}}function Eg(r,e,t,n){function i(v,x,_){try{x(_)}catch(C){zl(v,C,{fun:x,doc:_})}}function o(v,x,_,C,A){try{return{output:x(_,C,A)}}catch(M){return zl(v,M,{fun:x,keys:_,values:C,rereduce:A}),{error:M}}}function a(v,x){let _=Ee(v.key,x.key);return _!==0?_:Ee(v.value,x.value)}function s(v,x,_){return _=_||0,typeof x=="number"?v.slice(_,x+_):_>0?v.slice(_):v}function l(v){let x=v.value;return x&&typeof x=="object"&&x._id||v.id}function c(v){for(let x of v.rows){let _=x.doc&&x.doc._attachments;if(_)for(let C of Object.keys(_)){let A=_[C];_[C].data=Io(A.data,A.content_type)}}}function u(v){return function(x){return v.include_docs&&v.attachments&&v.binary&&c(x),x}}function d(v,x,_,C){let A=x[v];typeof A!="undefined"&&(C&&(A=encodeURIComponent(JSON.stringify(A))),_.push(v+"="+A))}function f(v){if(typeof v!="undefined"){let x=Number(v);return!isNaN(x)&&x===parseInt(v,10)?x:v}}function m(v){return v.group_level=f(v.group_level),v.limit=f(v.limit),v.skip=f(v.skip),v}function b(v){if(v){if(typeof v!="number")return new mt(`Invalid value for integer: "${v}"`);if(v<0)return new mt(`Invalid value for positive integer: "${v}"`)}}function E(v,x){let _=v.descending?"endkey":"startkey",C=v.descending?"startkey":"endkey";if(typeof v[_]!="undefined"&&typeof v[C]!="undefined"&&Ee(v[_],v[C])>0)throw new mt("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(x.reduce&&v.reduce!==!1){if(v.include_docs)throw new mt("{include_docs:true} is invalid for reduce");if(v.keys&&v.keys.length>1&&!v.group&&!v.group_level)throw new mt("Multi-key fetches for reduce views must use {group: true}")}for(let A of["group_level","limit","skip"]){let M=b(v[A]);if(M)throw M}}async function S(v,x,_){let C=[],A,M="GET",q;if(d("reduce",_,C),d("include_docs",_,C),d("attachments",_,C),d("limit",_,C),d("descending",_,C),d("group",_,C),d("group_level",_,C),d("skip",_,C),d("stale",_,C),d("conflicts",_,C),d("startkey",_,C,!0),d("start_key",_,C,!0),d("endkey",_,C,!0),d("end_key",_,C,!0),d("inclusive_end",_,C),d("key",_,C,!0),d("update_seq",_,C),C=C.join("&"),C=C===""?"":"?"+C,typeof _.keys!="undefined"){let D=`keys=${encodeURIComponent(JSON.stringify(_.keys))}`;D.length+C.length+1<=2e3?C+=(C[0]==="?"?"&":"?")+D:(M="POST",typeof x=="string"?A={keys:_.keys}:x.keys=_.keys)}if(typeof x=="string"){let P=Zi(x),D=await v.fetch("_design/"+P[0]+"/_view/"+P[1]+C,{headers:new rn({"Content-Type":"application/json"}),method:M,body:JSON.stringify(A)});q=D.ok;let O=await D.json();if(!q)throw O.status=D.status,sn(O);for(let L of O.rows)if(L.value&&L.value.error&&L.value.error==="builtin_reduce_error")throw new Error(L.reason);return new Promise(function(L){L(O)}).then(u(_))}A=A||{};for(let P of Object.keys(x))Array.isArray(x[P])?A[P]=x[P]:A[P]=x[P].toString();let I=await v.fetch("_temp_view"+C,{headers:new rn({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(A)});q=I.ok;let T=await I.json();if(!q)throw T.status=I.status,sn(T);return new Promise(function(P){P(T)}).then(u(_))}function y(v,x,_){return new Promise(function(C,A){v._query(x,_,function(M,q){if(M)return A(M);C(q)})})}function g(v){return new Promise(function(x,_){v._viewCleanup(function(C,A){if(C)return _(C);x(A)})})}function h(v){return function(x){if(x.status===404)return v;throw x}}async function p(v,x,_){let C="_local/doc_"+v,A={_id:C,keys:[]},M=_.get(v),q=M[0],I=M[1];function T(){return Cg(I)?Promise.resolve(A):x.db.get(C).catch(h(A))}function P(J){return J.keys.length?x.db.allDocs({keys:J.keys,include_docs:!0}):Promise.resolve({rows:[]})}function D(J,U){let ee=[],le=new Set;for(let W of U.rows){let z=W.doc;if(z&&(ee.push(z),le.add(z._id),z._deleted=!q.has(z._id),!z._deleted)){let H=q.get(z._id);"value"in H&&(z.value=H.value)}}let ce=Qi(q);for(let W of ce)if(!le.has(W)){let z={_id:W},H=q.get(W);"value"in H&&(z.value=H.value),ee.push(z)}return J.keys=Rl(ce.concat(J.keys)),ee.push(J),ee}let O=await T(),L=await P(O);return D(O,L)}function w(v){return v.sourceDB.get("_local/purges").then(function(x){let _=x.purgeSeq;return v.db.get("_local/purgeSeq").then(function(C){return C._rev}).catch(h(void 0)).then(function(C){return v.db.put({_id:"_local/purgeSeq",_rev:C,purgeSeq:_})})}).catch(function(x){if(x.status!==404)throw x})}function k(v,x,_){var C="_local/lastSeq";return v.db.get(C).catch(h({_id:C,seq:0})).then(function(A){var M=Qi(x);return Promise.all(M.map(function(q){return p(q,v,x)})).then(function(q){var I=q.flat();return A.seq=_,I.push(A),v.db.bulkDocs({docs:I})}).then(()=>w(v))})}function R(v){let x=typeof v=="string"?v:v.name,_=Nl[x];return _||(_=Nl[x]=new In),_}async function B(v,x){return Ji(R(v),function(){return F(v,x)})()}async function F(v,x){let _,C,A;function M(W,z){let H={id:C._id,key:Dt(W)};typeof z!="undefined"&&z!==null&&(H.value=Dt(z)),_.push(H)}let q=e(v.mapFun,M),I=v.seq||0;function T(){return v.sourceDB.info().then(function(W){A=v.sourceDB.activeTasks.add({name:"view_indexing",total_items:W.update_seq-I})})}function P(W,z){return function(){return k(v,W,z)}}let D=0,O={view:v.name,indexed_docs:D};v.sourceDB.emit("indexing",O);let L=new In;async function J(){let W=await v.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:I,limit:x.changes_batch_size}),z=await U();return ee(W,z)}function U(){return v.db.get("_local/purgeSeq").then(function(W){return W.purgeSeq}).catch(h(-1)).then(function(W){return v.sourceDB.get("_local/purges").then(function(z){let H=z.purges.filter(function(he,oe){return oe>W}).map(he=>he.docId),fe=H.filter(function(he,oe){return H.indexOf(he)===oe});return Promise.all(fe.map(function(he){return v.sourceDB.get(he).then(function(oe){return{docId:he,doc:oe}}).catch(h({docId:he}))}))}).catch(h([]))})}function ee(W,z){let H=W.results;if(!H.length&&!z.length)return;for(let oe of z)if(H.findIndex(function(Ve){return Ve.id===oe.docId})<0){let Ve={_id:oe.docId,doc:{_id:oe.docId,_deleted:1},changes:[]};oe.doc&&(Ve.doc=oe.doc,Ve.changes.push({rev:oe.doc._rev})),H.push(Ve)}let fe=le(H);L.add(P(fe,I)),D=D+H.length;let he={view:v.name,last_seq:W.last_seq,results_count:H.length,indexed_docs:D};if(v.sourceDB.emit("indexing",he),v.sourceDB.activeTasks.update(A,{completed_items:D}),!(H.length<x.changes_batch_size))return J()}function le(W){let z=new Map;for(let H of W){if(H.doc._id[0]!=="_"){_=[],C=H.doc,C._deleted||i(v.sourceDB,q,C),_.sort(a);let fe=ce(_);z.set(H.doc._id,[fe,H.changes])}I=H.seq}return z}function ce(W){let z=new Map,H;for(let fe=0,he=W.length;fe<he;fe++){let oe=W[fe],je=[oe.key,oe.id];fe>0&&Ee(oe.key,H)===0&&je.push(fe),z.set(ot(je),oe),H=oe.key}return z}try{await T(),await J(),await L.finish(),v.seq=I,v.sourceDB.activeTasks.remove(A)}catch(W){v.sourceDB.activeTasks.remove(A,W)}}function K(v,x,_){_.group_level===0&&delete _.group_level;let C=_.group||_.group_level,A=t(v.reduceFun),M=[],q=isNaN(_.group_level)?Number.POSITIVE_INFINITY:_.group_level;for(let I of x){let T=M[M.length-1],P=C?I.key:null;if(C&&Array.isArray(P)&&(P=P.slice(0,q)),T&&Ee(T.groupKey,P)===0){T.keys.push([I.key,I.id]),T.values.push(I.value);continue}M.push({keys:[[I.key,I.id]],values:[I.value],groupKey:P})}x=[];for(let I of M){let T=o(v.sourceDB,A,I.keys,I.values,!1);if(T.error&&T.error instanceof cn)throw T.error;x.push({value:T.error?null:T.output,key:I.groupKey})}return{rows:s(x,_.limit,_.skip)}}function V(v,x){return Ji(R(v),function(){return Y(v,x)})()}async function Y(v,x){let _,C=v.reduceFun&&x.reduce!==!1,A=x.skip||0;typeof x.keys!="undefined"&&!x.keys.length&&(x.limit=0,delete x.keys);async function M(I){I.include_docs=!0;let T=await v.db.allDocs(I);return _=T.total_rows,T.rows.map(function(P){if("value"in P.doc&&typeof P.doc.value=="object"&&P.doc.value!==null){let O=Object.keys(P.doc.value).sort(),L=["id","key","value"];if(!(O<L||O>L))return P.doc.value}let D=vp(P.doc._id);return{key:D[0],id:D[1],value:"value"in P.doc?P.doc.value:null}})}async function q(I){let T;if(C?T=K(v,I,x):typeof x.keys=="undefined"?T={total_rows:_,offset:A,rows:I}:T={total_rows:_,offset:A,rows:s(I,x.limit,x.skip)},x.update_seq&&(T.update_seq=v.seq),x.include_docs){let P=Rl(I.map(l)),D=await v.sourceDB.allDocs({keys:P,include_docs:!0,conflicts:x.conflicts,attachments:x.attachments,binary:x.binary}),O=new Map;for(let L of D.rows)O.set(L.id,L.doc);for(let L of I){let J=l(L),U=O.get(J);U&&(L.doc=U)}}return T}if(typeof x.keys!="undefined"){let T=x.keys.map(function(O){let L={startkey:ot([O]),endkey:ot([O,{}])};return x.update_seq&&(L.update_seq=!0),M(L)}),D=(await Promise.all(T)).flat();return q(D)}else{let I={descending:x.descending};x.update_seq&&(I.update_seq=!0);let T,P;if("start_key"in x&&(T=x.start_key),"startkey"in x&&(T=x.startkey),"end_key"in x&&(P=x.end_key),"endkey"in x&&(P=x.endkey),typeof T!="undefined"&&(I.startkey=x.descending?ot([T,{}]):ot([T])),typeof P!="undefined"){let O=x.inclusive_end!==!1;x.descending&&(O=!O),I.endkey=ot(O?[P,{}]:[P])}if(typeof x.key!="undefined"){let O=ot([x.key]),L=ot([x.key,{}]);I.descending?(I.endkey=O,I.startkey=L):(I.startkey=O,I.endkey=L)}C||(typeof x.limit=="number"&&(I.limit=x.limit),I.skip=A);let D=await M(I);return q(D)}}async function Q(v){return(await v.fetch("_view_cleanup",{headers:new rn({"Content-Type":"application/json"}),method:"POST"})).json()}async function G(v){try{let x=await v.get("_local/"+r),_=new Map;for(let T of Object.keys(x.views)){let P=Zi(T),D="_design/"+P[0],O=P[1],L=_.get(D);L||(L=new Set,_.set(D,L)),L.add(O)}let C={keys:Qi(_),include_docs:!0},A=await v.allDocs(C),M={};for(let T of A.rows){let P=T.key.substring(8);for(let D of _.get(T.key)){let O=P+"/"+D;x.views[O]||(O=D);let L=Object.keys(x.views[O]),J=T.doc&&T.doc.views&&T.doc.views[D];for(let U of L)M[U]=M[U]||J}}let I=Object.keys(M).filter(function(T){return!M[T]}).map(function(T){return Ji(R(T),function(){return new v.constructor(T,v.__opts).destroy()})()});return Promise.all(I).then(function(){return{ok:!0}})}catch(x){if(x.status===404)return{ok:!0};throw x}}async function Z(v,x,_){if(typeof v._query=="function")return y(v,x,_);if(dt(v))return S(v,x,_);let C={changes_batch_size:v.__opts.view_update_changes_batch_size||Sg};if(typeof x!="string")return E(_,x),jl.add(async function(){let A=await ql(v,"temp_view/temp_view",x.map,x.reduce,!0,r);return wg(B(A,C).then(function(){return V(A,_)}),function(){return A.db.destroy()})}),jl.finish();{let A=x,M=Zi(A),q=M[0],I=M[1],T=await v.get("_design/"+q);if(x=T.views&&T.views[I],!x)throw new ln(`ddoc ${T._id} has no view named ${I}`);n(T,I),E(_,x);let P=await ql(v,A,x.map,x.reduce,!1,r);return _.stale==="ok"||_.stale==="update_after"?(_.stale==="update_after"&&ht(function(){B(P,C)}),V(P,_)):(await B(P,C),V(P,_))}}function te(v,x,_){let C=this;typeof x=="function"&&(_=x,x={}),x=x?m(x):{},typeof v=="function"&&(v={map:v});let A=Promise.resolve().then(function(){return Z(C,v,x)});return Cc(A,_),A}let se=yg(function(){let v=this;return typeof v._viewCleanup=="function"?g(v):dt(v)?Q(v):G(v)});return{query:te,viewCleanup:se}}function Tg(r){if(/^_sum/.test(r))return Yi._sum;if(/^_count/.test(r))return Yi._count;if(/^_stats/.test(r))return Yi._stats;if(/^_/.test(r))throw new Error(r+" is not a supported reduce function.")}function Ag(r,e){if(typeof r=="function"&&r.length===2){var t=r;return function(n){return t(n,e)}}else return Ec(r.toString(),e)}function Pg(r){var e=r.toString(),t=Tg(e);return t||Ec(e)}function Ig(r,e){var t=r.views&&r.views[e];if(typeof t.map!="string")throw new ln("ddoc "+r._id+" has no string view named "+e+", instead found object of type: "+typeof t.map)}function Og(r,e,t){return Tc.query.call(this,r,e,t)}function Dg(r){return Tc.viewCleanup.call(this,r)}function Lg(r,e,t){return!r._attachments||!r._attachments[t]||r._attachments[t].digest!==e._attachments[t].digest}function Hl(r,e){var t=Object.keys(e._attachments);return Promise.all(t.map(function(n){return r.getAttachment(e._id,n,{rev:e._rev})}))}function Rg(r,e,t){var n=dt(e)&&!dt(r),i=Object.keys(t._attachments);return n?r.get(t._id).then(function(o){return Promise.all(i.map(function(a){return Lg(o,t,a)?e.getAttachment(t._id,a):r.getAttachment(o._id,a)}))}).catch(function(o){if(o.status!==404)throw o;return Hl(e,t)}):Hl(e,t)}function Fg(r){var e=[];return Object.keys(r).forEach(function(t){var n=r[t].missing;n.forEach(function(i){e.push({id:t,rev:i})})}),{docs:e,revs:!0,latest:!0}}function Bg(r,e,t,n){t=$e(t);var i=[],o=!0;function a(){var l=Fg(t);if(l.docs.length)return r.bulkGet(l).then(function(c){if(n.cancelled)throw new Error("cancelled");return Promise.all(c.results.map(function(u){return Promise.all(u.docs.map(function(d){var f=d.ok;return d.error&&(o=!1),!f||!f._attachments?f:Rg(e,r,f).then(m=>{var b=Object.keys(f._attachments);return m.forEach(function(E,S){var y=f._attachments[b[S]];delete y.stub,delete y.length,y.data=E}),f})}))})).then(function(u){i=i.concat(u.flat().filter(Boolean))})})}function s(){return{ok:o,docs:i}}return Promise.resolve().then(a).then(s)}function vo(r,e,t,n,i){return r.get(e).catch(function(o){if(o.status===404)return(r.adapter==="http"||r.adapter==="https")&&to(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:n,_id:e,history:[],replicator:Vl,version:Ul};throw o}).then(function(o){if(!i.cancelled&&o.last_seq!==t)return o.history=(o.history||[]).filter(function(a){return a.session_id!==n}),o.history.unshift({last_seq:t,session_id:n}),o.history=o.history.slice(0,qg),o.version=Ul,o.replicator=Vl,o.session_id=n,o.last_seq=t,r.put(o).catch(function(a){if(a.status===409)return vo(r,e,t,n,i);throw a})})}function Ng(r,e){return r.session_id===e.session_id?{last_seq:r.last_seq,history:r.history}:Ac(r.history,e.history)}function Ac(r,e){var t=r[0],n=r.slice(1),i=e[0],o=e.slice(1);if(!t||e.length===0)return{last_seq:it,history:[]};var a=t.session_id;if(yo(a,e))return{last_seq:t.last_seq,history:r};var s=i.session_id;return yo(s,n)?{last_seq:i.last_seq,history:o}:Ac(n,o)}function yo(r,e){var t=e[0],n=e.slice(1);return!r||e.length===0?!1:r===t.session_id?!0:yo(r,n)}function Kl(r){return typeof r.status=="number"&&Math.floor(r.status/100)===4}function Pc(r,e,t,n,i){return this instanceof Pr?Pc:new Pr(r,e,t,n,i)}function jg(r,e,t,n){if(r.retry===!1){e.emit("error",t),e.removeAllListeners();return}if(typeof r.back_off_function!="function"&&(r.back_off_function=hh),e.emit("requestError",t),e.state==="active"||e.state==="pending"){e.emit("paused",t),e.state="stopped";var i=function(){r.current_back_off=Gl},o=function(){e.removeListener("active",i)};e.once("paused",o),e.once("active",i)}r.current_back_off=r.current_back_off||Gl,r.current_back_off=r.back_off_function(r.current_back_off),setTimeout(n,r.current_back_off)}function zg(r){return Object.keys(r).sort(Ee).reduce(function(e,t){return e[t]=r[t],e},{})}function Hg(r,e,t){var n=t.doc_ids?t.doc_ids.sort(Ee):"",i=t.filter?t.filter.toString():"",o="",a="",s="";return t.selector&&(s=JSON.stringify(t.selector)),t.filter&&t.query_params&&(o=JSON.stringify(zg(t.query_params))),t.filter&&t.filter==="_view"&&(a=t.view.toString()),Promise.all([r.id(),e.id()]).then(function(l){var c=l[0]+l[1]+i+a+o+n+s;return new Promise(function(u){Oo(c,u)})}).then(function(l){return l=l.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+l})}function Ic(r,e,t,n,i){var o=[],a,s={seq:0,changes:[],docs:[]},l=!1,c=!1,u=!1,d=0,f=0,m=t.continuous||t.live||!1,b=t.batch_size||100,E=t.batches_limit||10,S=t.style||"all_docs",y=!1,g=t.doc_ids,h=t.selector,p,w,k=[],R=Or(),B;i=i||{ok:!0,start_time:new Date().toISOString(),docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var F={};n.ready(r,e);function K(){return w?Promise.resolve():Hg(r,e,t).then(function(T){p=T;var P={};t.checkpoint===!1?P={writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:t.checkpoint==="source"?P={writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:t.checkpoint==="target"?P={writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:P={writeSourceCheckpoint:!0,writeTargetCheckpoint:!0},w=new Pc(r,e,p,n,P)})}function V(){if(k=[],a.docs.length!==0){var T=a.docs,P={timeout:t.timeout};return e.bulkDocs({docs:T,new_edits:!1},P).then(function(D){if(n.cancelled)throw v(),new Error("cancelled");var O=Object.create(null);D.forEach(function(J){J.error&&(O[J.id]=J)});var L=Object.keys(O).length;i.doc_write_failures+=L,i.docs_written+=T.length-L,T.forEach(function(J){var U=O[J._id];if(U){i.errors.push(U);var ee=(U.name||"").toLowerCase();if(ee==="unauthorized"||ee==="forbidden")n.emit("denied",$e(U));else throw U}else k.push(J)})},function(D){throw i.doc_write_failures+=T.length,D})}}function Y(){if(a.error)throw new Error("There was a problem getting docs.");i.last_seq=f=a.seq;var T=$e(i);return k.length&&(T.docs=k,typeof a.pending=="number"&&(T.pending=a.pending,delete a.pending),n.emit("change",T)),l=!0,r.info().then(function(P){var D=r.activeTasks.get(B);if(!(!a||!D)){var O=D.completed_items||0,L=parseInt(P.update_seq,10)-parseInt(d,10);r.activeTasks.update(B,{completed_items:O+a.changes.length,total_items:L})}}),w.writeCheckpoint(a.seq,R).then(function(){if(n.emit("checkpoint",{checkpoint:a.seq}),l=!1,n.cancelled)throw v(),new Error("cancelled");a=void 0,A()}).catch(function(P){throw I(P),P})}function Q(){var T={};return a.changes.forEach(function(P){n.emit("checkpoint",{revs_diff:P}),P.id!=="_user/"&&(T[P.id]=P.changes.map(function(D){return D.rev}))}),e.revsDiff(T).then(function(P){if(n.cancelled)throw v(),new Error("cancelled");a.diffs=P})}function G(){return Bg(r,e,a.diffs,n).then(function(T){a.error=!T.ok,T.docs.forEach(function(P){delete a.diffs[P._id],i.docs_read++,a.docs.push(P)})})}function Z(){if(!(n.cancelled||a)){if(o.length===0){te(!0);return}a=o.shift(),n.emit("checkpoint",{start_next_batch:a.seq}),Q().then(G).then(V).then(Y).then(Z).catch(function(T){se("batch processing terminated with error",T)})}}function te(T){if(s.changes.length===0){o.length===0&&!a&&((m&&F.live||c)&&(n.state="pending",n.emit("paused")),c&&v());return}(T||c||s.changes.length>=b)&&(o.push(s),s={seq:0,changes:[],docs:[]},(n.state==="pending"||n.state==="stopped")&&(n.state="active",n.emit("active")),Z())}function se(T,P){u||(P.message||(P.message=T),i.ok=!1,i.status="aborting",o=[],s={seq:0,changes:[],docs:[]},v(P))}function v(T){if(!u&&!(n.cancelled&&(i.status="cancelled",l)))if(i.status=i.status||"complete",i.end_time=new Date().toISOString(),i.last_seq=f,u=!0,r.activeTasks.remove(B,T),T){T=ie(T),T.result=i;var P=(T.name||"").toLowerCase();P==="unauthorized"||P==="forbidden"?(n.emit("error",T),n.removeAllListeners()):jg(t,n,T,function(){Ic(r,e,t,n)})}else n.emit("complete",i),n.removeAllListeners()}function x(T,P,D){if(n.cancelled)return v();typeof P=="number"&&(s.pending=P);var O=Co(t)(T);if(!O){var L=r.activeTasks.get(B);if(L){var J=L.completed_items||0;r.activeTasks.update(B,{completed_items:++J})}return}s.seq=T.seq||D,s.changes.push(T),n.emit("checkpoint",{pending_batch:s.seq}),ht(function(){te(o.length===0&&F.live)})}function _(T){if(y=!1,n.cancelled)return v();if(T.results.length>0)F.since=T.results[T.results.length-1].seq,A(),te(!0);else{var P=function(){m?(F.live=!0,A()):c=!0,te(!0)};!a&&T.results.length===0?(l=!0,w.writeCheckpoint(T.last_seq,R).then(function(){if(l=!1,i.last_seq=f=T.last_seq,n.cancelled)throw v(),new Error("cancelled");P()}).catch(I)):P()}}function C(T){if(y=!1,n.cancelled)return v();se("changes rejected",T)}function A(){if(!(!y&&!c&&o.length<E))return;y=!0;function T(){D.cancel()}function P(){n.removeListener("cancel",T)}n._changes&&(n.removeListener("cancel",n._abortChanges),n._changes.cancel()),n.once("cancel",T);var D=r.changes(F).on("change",x);D.then(P,P),D.then(_).catch(C),t.retry&&(n._changes=D,n._abortChanges=T)}function M(T){return r.info().then(function(P){var D=typeof t.since=="undefined"?parseInt(P.update_seq,10)-parseInt(T,10):parseInt(P.update_seq,10);return B=r.activeTasks.add({name:`${m?"continuous ":""}replication from ${P.db_name}`,total_items:D}),T})}function q(){K().then(function(){if(n.cancelled){v();return}return w.getCheckpoint().then(M).then(function(T){f=T,d=T,F={since:f,limit:b,batch_size:b,style:S,doc_ids:g,selector:h,return_docs:!0},t.filter&&(typeof t.filter!="string"?F.include_docs=!0:F.filter=t.filter),"heartbeat"in t&&(F.heartbeat=t.heartbeat),"timeout"in t&&(F.timeout=t.timeout),t.query_params&&(F.query_params=t.query_params),t.view&&(F.view=t.view),A()})}).catch(function(T){se("getCheckpoint rejected with ",T)})}function I(T){l=!1,se("writeCheckpoint completed with error",T)}if(n.cancelled){v();return}n._addedListeners||(n.once("cancel",v),typeof t.complete=="function"&&(n.once("error",t.complete),n.once("complete",function(T){t.complete(null,T)})),n._addedListeners=!0),typeof t.since=="undefined"?q():K().then(function(){return l=!0,w.writeCheckpoint(t.since,R)}).then(function(){if(l=!1,n.cancelled){v();return}f=t.since,q()}).catch(I)}function Ir(r,e){var t=e.PouchConstructor;return typeof r=="string"?new t(r,e):r}function bo(r,e,t,n){if(typeof t=="function"&&(n=t,t={}),typeof t=="undefined"&&(t={}),t.doc_ids&&!Array.isArray(t.doc_ids))throw ie($r,"`doc_ids` filter parameter is not a list.");t.complete=n,t=$e(t),t.continuous=t.continuous||t.live,t.retry="retry"in t?t.retry:!1,t.PouchConstructor=t.PouchConstructor||this;var i=new wo(t),o=Ir(r,t),a=Ir(e,t);return Ic(o,a,t,i),i}function Ug(r,e,t,n){return typeof t=="function"&&(n=t,t={}),typeof t=="undefined"&&(t={}),t=$e(t),t.PouchConstructor=t.PouchConstructor||this,r=Ir(r,t),e=Ir(e,t),new xo(r,e,t,n)}function Vg(r){r.replicate=bo,r.sync=Ug,Object.defineProperty(r.prototype,"replicate",{get:function(){var e=this;return typeof this.replicateMethods=="undefined"&&(this.replicateMethods={from:function(t,n,i){return e.constructor.replicate(t,e,n,i)},to:function(t,n,i){return e.constructor.replicate(e,t,n,i)}}),this.replicateMethods}}),r.prototype.sync=function(e,t,n){return this.constructor.sync(this,e,t,n)}}var _r,_o,ft,Jl,sh,uh,Xi,ht,eo,xe,b0,ph,Ze,an,Xl,gh,mh,x0,ko,ec,_0,vh,kl,$r,Ni,k0,So,S0,C0,E0,br,T0,yh,A0,Cl,El,xh,_h,To,On,Th,Ah,Or,ro,Zh,Cr,io,Er,ae,fc,rn,oo,Pl,np,ip,vc,so,lo,Ol,qp,Np,Qp,Te,Le,Ye,At,qe,ct,Ui,An,ho,po,nn,Vi,Wi,dg,fg,yr,hg,Ki,mt,ln,cn,bg,xg,_g,In,Nl,jl,Sg,Yi,$g,Tc,Mg,Ul,Vl,qg,it,Pr,Wl,Gl,wo,xo,Wg,Bo=j(()=>{_r=Ut(Fi());bl();_o=Ut(xl()),ft=Ut(require("events"));Jl=Function.prototype.toString,sh=Jl.call(Object);uh=6;try{localStorage.setItem("_pouch_check_localstorage",1),Xi=!!localStorage.getItem("_pouch_check_localstorage")}catch(r){Xi=!1}ht=typeof queueMicrotask=="function"?queueMicrotask:function(e){Promise.resolve().then(e)},eo=class extends ft.default{constructor(){super(),this._listeners={},kr()&&addEventListener("storage",e=>{this.emit(e.key)})}addListener(e,t,n,i){if(this._listeners[t])return;var o=!1,a=this;function s(){if(!a._listeners[t])return;if(o){o="waiting";return}o=!0;var l=$n(i,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);function c(){o=!1}n.changes(l).on("change",function(u){u.seq>i.since&&!i.cancelled&&(i.since=u.seq,i.onChange(u))}).on("complete",function(){o==="waiting"&&ht(s),o=!1}).on("error",c)}this._listeners[t]=s,this.on(e,s)}removeListener(e,t){t in this._listeners&&(super.removeListener(e,this._listeners[t]),delete this._listeners[t])}notifyLocalWindows(e){kr()&&(localStorage[e]=localStorage[e]==="a"?"b":"a")}notify(e){this.emit(e),this.notifyLocalWindows(e)}};xe=class extends Error{constructor(e,t,n){super(),this.status=e,this.name=t,this.message=n,this.error=!0}toString(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})}},b0=new xe(401,"unauthorized","Name or password is incorrect."),ph=new xe(400,"bad_request","Missing JSON list of 'docs'"),Ze=new xe(404,"not_found","missing"),an=new xe(409,"conflict","Document update conflict"),Xl=new xe(400,"bad_request","_id field must contain a string"),gh=new xe(412,"missing_id","_id is required for puts"),mh=new xe(400,"bad_request","Only reserved document ids may start with underscore."),x0=new xe(412,"precondition_failed","Database not open"),ko=new xe(500,"unknown_error","Database encountered an unknown error"),ec=new xe(500,"badarg","Some query argument is invalid"),_0=new xe(400,"invalid_request","Request was invalid"),vh=new xe(400,"query_parse_error","Some query parameter is invalid"),kl=new xe(500,"doc_validation","Bad special document member"),$r=new xe(400,"bad_request","Something wrong with the request"),Ni=new xe(400,"bad_request","Document must be a JSON object"),k0=new xe(404,"not_found","Database not found"),So=new xe(500,"indexed_db_went_bad","unknown"),S0=new xe(500,"web_sql_went_bad","unknown"),C0=new xe(500,"levelDB_went_went_bad","unknown"),E0=new xe(403,"forbidden","Forbidden by design doc validate_doc_update function"),br=new xe(400,"bad_request","Invalid rev format"),T0=new xe(412,"file_exists","The database could not be created, the file already exists."),yh=new xe(412,"missing_stub","A pre-existing attachment stub wasn't found"),A0=new xe(413,"invalid_url","Provided URL is invalid");Cl=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],El="queryKey",xh=/(?:^|&)([^&=]*)=?([^&]*)/g,_h=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;To=function(r){return atob(r)},On=function(r){return btoa(r)};Th=self.setImmediate||self.setTimeout,Ah=32768;Or=En;ro=class extends ft.default{constructor(e,t,n){super(),this.db=e,t=t?$e(t):{};var i=t.complete=Ql((s,l)=>{s?bh(this,"error")>0&&this.emit("error",s):this.emit("complete",l),this.removeAllListeners(),e.removeListener("destroyed",o)});n&&(this.on("complete",function(s){n(null,s)}),this.on("error",n));let o=()=>{this.cancel()};e.once("destroyed",o),t.onChange=(s,l,c)=>{this.isCancelled||Hh(this,s,l,c)};var a=new Promise(function(s,l){t.complete=function(c,u){c?l(c):s(u)}});this.once("cancel",function(){e.removeListener("destroyed",o),t.complete(null,{status:"cancelled"})}),this.then=a.then.bind(a),this.catch=a.catch.bind(a),this.then(function(s){i(null,s)},i),e.taskqueue.isReady?this.validateChanges(t):e.taskqueue.addTask(s=>{s?t.complete(s):this.isCancelled?this.emit("cancel"):this.validateChanges(t)})}cancel(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")}validateChanges(e){var t=e.complete;ae._changesFilterPlugin?ae._changesFilterPlugin.validate(e,n=>{if(n)return t(n);this.doChanges(e)}):this.doChanges(e)}doChanges(e){var t=e.complete;if(e=$e(e),"live"in e&&!("continuous"in e)&&(e.continuous=e.live),e.processChange=Uh,e.since==="latest"&&(e.since="now"),e.since||(e.since=0),e.since==="now"){this.db.info().then(i=>{if(this.isCancelled){t(null,{status:"cancelled"});return}e.since=i.update_seq,this.doChanges(e)},t);return}if(ae._changesFilterPlugin){if(ae._changesFilterPlugin.normalize(e),ae._changesFilterPlugin.shouldFilter(this,e))return ae._changesFilterPlugin.filter(this,e)}else["doc_ids","filter","selector","view"].forEach(function(i){i in e&&Xe("warn",'The "'+i+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')});"descending"in e||(e.descending=!1),e.limit=e.limit===0?1:e.limit,e.complete=t;var n=this.db._changes(e);if(n&&typeof n.cancel=="function"){let i=this.cancel;this.cancel=(...o)=>{n.cancel(),i.apply(this,o)}}}};Zh=/^\d+-[^-]*$/;Cr=class extends ft.default{_setup(){this.post=Ce("post",function(e,t,n){if(typeof t=="function"&&(n=t,t={}),zi(e))return n(ie(Ni));this.bulkDocs({docs:[e]},t,ji(n,e._id))}).bind(this),this.put=Ce("put",function(e,t,n){if(typeof t=="function"&&(n=t,t={}),zi(e))return n(ie(Ni));if(tc(e._id),"_rev"in e&&!Hi(e._rev))return n(ie(br));if(It(e._id)&&typeof this._putLocal=="function")return e._deleted?this._removeLocal(e,n):this._putLocal(e,n);let i=a=>{typeof this._put=="function"&&t.new_edits!==!1?this._put(e,t,a):this.bulkDocs({docs:[e]},t,ji(a,e._id))};t.force&&e._rev?(o(),i(function(a){var s=a?null:{ok:!0,id:e._id,rev:e._rev};n(a,s)})):i(n);function o(){var a=e._rev.split("-"),s=a[1],l=parseInt(a[0],10),c=l+1,u=ac();e._revisions={start:c,ids:[u,s]},e._rev=c+"-"+u,t.new_edits=!1}}).bind(this),this.putAttachment=Ce("putAttachment",function(e,t,n,i,o){var a=this;typeof o=="function"&&(o=i,i=n,n=null),typeof o=="undefined"&&(o=i,i=n,n=null),o||Xe("warn","Attachment",t,"on document",e,"is missing content_type");function s(l){var c="_rev"in l?parseInt(l._rev,10):0;return l._attachments=l._attachments||{},l._attachments[t]={content_type:o,data:i,revpos:++c},a.put(l)}return a.get(e).then(function(l){if(l._rev!==n)throw ie(an);return s(l)},function(l){if(l.reason===Ze.message)return s({_id:e});throw l})}).bind(this),this.removeAttachment=Ce("removeAttachment",function(e,t,n,i){this.get(e,(o,a)=>{if(o){i(o);return}if(a._rev!==n){i(ie(an));return}if(!a._attachments)return i();delete a._attachments[t],Object.keys(a._attachments).length===0&&delete a._attachments,this.put(a,i)})}).bind(this),this.remove=Ce("remove",function(e,t,n,i){var o;typeof t=="string"?(o={_id:e,_rev:t},typeof n=="function"&&(i=n,n={})):(o=e,typeof t=="function"?(i=t,n={}):(i=n,n=t)),n=n||{},n.was_delete=!0;var a={_id:o._id,_rev:o._rev||n.rev};if(a._deleted=!0,It(a._id)&&typeof this._removeLocal=="function")return this._removeLocal(o,i);this.bulkDocs({docs:[a]},n,ji(i,a._id))}).bind(this),this.revsDiff=Ce("revsDiff",function(e,t,n){typeof t=="function"&&(n=t,t={});var i=Object.keys(e);if(!i.length)return n(null,{});var o=0,a=new Map;function s(c,u){a.has(c)||a.set(c,{missing:[]}),a.get(c).missing.push(u)}function l(c,u){var d=e[c].slice(0);Ot(u,function(f,m,b,E,S){var y=m+"-"+b,g=d.indexOf(y);g!==-1&&(d.splice(g,1),S.status!=="available"&&s(c,y))}),d.forEach(function(f){s(c,f)})}i.forEach(function(c){this._getRevisionTree(c,function(u,d){if(u&&u.status===404&&u.message==="missing")a.set(c,{missing:e[c]});else{if(u)return n(u);l(c,d)}if(++o===i.length){var f={};return a.forEach(function(m,b){f[b]=m}),n(null,f)}})},this)}).bind(this),this.bulkGet=Ce("bulkGet",function(e,t){Yl(this,e,t)}).bind(this),this.compactDocument=Ce("compactDocument",function(e,t,n){this._getRevisionTree(e,(i,o)=>{if(i)return n(i);var a=Kh(o),s=[],l=[];Object.keys(a).forEach(function(c){a[c]>t&&s.push(c)}),Ot(o,function(c,u,d,f,m){var b=u+"-"+d;m.status==="available"&&s.indexOf(b)!==-1&&l.push(b)}),this._doCompaction(e,l,n)})}).bind(this),this.compact=Ce("compact",function(e,t){typeof e=="function"&&(t=e,e={}),e=e||{},this._compactionQueue=this._compactionQueue||[],this._compactionQueue.push({opts:e,callback:t}),this._compactionQueue.length===1&&uc(this)}).bind(this),this.get=Ce("get",function(e,t,n){if(typeof t=="function"&&(n=t,t={}),t=t||{},typeof e!="string")return n(ie(Xl));if(It(e)&&typeof this._getLocal=="function")return this._getLocal(e,n);var i=[];let o=()=>{var l=[],c=i.length;if(!c)return n(null,l);i.forEach(u=>{this.get(e,{rev:u,revs:t.revs,latest:t.latest,attachments:t.attachments,binary:t.binary},function(d,f){if(d)l.push({missing:u});else{for(var m,b=0,E=l.length;b<E;b++)if(l[b].ok&&l[b].ok._rev===f._rev){m=!0;break}m||l.push({ok:f})}c--,c||n(null,l)})})};if(t.open_revs){if(t.open_revs==="all")this._getRevisionTree(e,function(l,c){if(l)return n(l);i=Do(c).map(function(u){return u.rev}),o()});else if(Array.isArray(t.open_revs)){i=t.open_revs;for(var a=0;a<i.length;a++){var s=i[a];if(!Hi(s))return n(ie(br))}o()}else return n(ie(ko,"function_clause"));return}return this._get(e,t,(l,c)=>{if(l)return l.docId=e,n(l);var u=c.doc,d=c.metadata,f=c.ctx;if(t.conflicts){var m=Mo(d);m.length&&(u._conflicts=m)}if(vt(d,u._rev)&&(u._deleted=!0),t.revs||t.revs_info){for(var b=u._rev.split("-"),E=parseInt(b[0],10),S=b[1],y=sc(d.rev_tree),g=null,h=0;h<y.length;h++){var p=y[h];let Q=p.ids.findIndex(G=>G.id===S);var w=Q===E-1;(w||!g&&Q!==-1)&&(g=p)}if(!g)return l=new Error("invalid rev tree"),l.docId=e,n(l);let V=u._rev.split("-")[1],Y=g.ids.findIndex(Q=>Q.id===V)+1;var k=g.ids.length-Y;if(g.ids.splice(Y,k),g.ids.reverse(),t.revs&&(u._revisions={start:g.pos+g.ids.length-1,ids:g.ids.map(function(Q){return Q.id})}),t.revs_info){var R=g.pos+g.ids.length;u._revs_info=g.ids.map(function(Q){return R--,{rev:R+"-"+Q.id,status:Q.opts.status}})}}if(t.attachments&&u._attachments){var B=u._attachments,F=Object.keys(B).length;if(F===0)return n(null,u);Object.keys(B).forEach(V=>{this._getAttachment(u._id,V,B[V],{binary:t.binary,metadata:d,ctx:f},function(Y,Q){var G=u._attachments[V];G.data=Q,delete G.stub,delete G.length,--F||n(null,u)})})}else{if(u._attachments)for(var K in u._attachments)Object.prototype.hasOwnProperty.call(u._attachments,K)&&(u._attachments[K].stub=!0);n(null,u)}})}).bind(this),this.getAttachment=Ce("getAttachment",function(e,t,n,i){n instanceof Function&&(i=n,n={}),this._get(e,n,(o,a)=>{if(o)return i(o);if(a.doc._attachments&&a.doc._attachments[t])n.ctx=a.ctx,n.binary=!0,n.metadata=a.metadata,this._getAttachment(e,t,a.doc._attachments[t],n,i);else return i(ie(Ze))})}).bind(this),this.allDocs=Ce("allDocs",function(e,t){if(typeof e=="function"&&(t=e,e={}),e.skip=typeof e.skip!="undefined"?e.skip:0,e.start_key&&(e.startkey=e.start_key),e.end_key&&(e.endkey=e.end_key),"keys"in e){if(!Array.isArray(e.keys))return t(new TypeError("options.keys must be an array"));var n=["startkey","endkey","key"].filter(function(i){return i in e})[0];if(n){t(ie(vh,"Query parameter `"+n+"` is not compatible with multi-get"));return}if(!dt(this)&&(Gh(e),e.keys.length===0))return this._allDocs({limit:0},t)}return this._allDocs(e,t)}).bind(this),this.close=Ce("close",function(e){return this._closed=!0,this.emit("closed"),this._close(e)}).bind(this),this.info=Ce("info",function(e){this._info((t,n)=>{if(t)return e(t);n.db_name=n.db_name||this.name,n.auto_compaction=!!(this.auto_compaction&&!dt(this)),n.adapter=this.adapter,e(null,n)})}).bind(this),this.id=Ce("id",function(e){return this._id(e)}).bind(this),this.bulkDocs=Ce("bulkDocs",function(e,t,n){if(typeof t=="function"&&(n=t,t={}),t=t||{},Array.isArray(e)&&(e={docs:e}),!e||!e.docs||!Array.isArray(e.docs))return n(ie(ph));for(var i=0;i<e.docs.length;++i){let l=e.docs[i];if(zi(l))return n(ie(Ni));if("_rev"in l&&!Hi(l._rev))return n(ie(br))}var o;if(e.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(c){o=o||Qh(c),l._attachments[c].content_type||Xe("warn","Attachment",c,"on document",l._id,"is missing content_type")})}),o)return n(ie($r,o));"new_edits"in t||("new_edits"in e?t.new_edits=e.new_edits:t.new_edits=!0);var a=this;!t.new_edits&&!dt(a)&&e.docs.sort(Wh),Vh(e.docs);var s=e.docs.map(function(l){return l._id});this._bulkDocs(e,t,function(l,c){if(l)return n(l);if(t.new_edits||(c=c.filter(function(f){return f.error})),!dt(a))for(var u=0,d=c.length;u<d;u++)c[u].id=c[u].id||s[u];n(null,c)})}).bind(this),this.registerDependentDatabase=Ce("registerDependentDatabase",function(e,t){var n=$e(this.__opts);this.__opts.view_adapter&&(n.adapter=this.__opts.view_adapter);var i=new this.constructor(e,n);function o(a){return a.dependentDbs=a.dependentDbs||{},a.dependentDbs[e]?!1:(a.dependentDbs[e]=!0,a)}Sr(this,"_local/_pouch_dependentDbs",o).then(function(){t(null,{db:i})}).catch(t)}).bind(this),this.destroy=Ce("destroy",function(e,t){typeof e=="function"&&(t=e,e={});var n="use_prefix"in this?this.use_prefix:!0;let i=()=>{this._destroy(e,(o,a)=>{if(o)return t(o);this._destroyed=!0,this.emit("destroyed"),t(null,a||{ok:!0})})};if(dt(this))return i();this.get("_local/_pouch_dependentDbs",(o,a)=>{if(o)return o.status!==404?t(o):i();var s=a.dependentDbs,l=this.constructor,c=Object.keys(s).map(u=>{var d=n?u.replace(new RegExp("^"+l.prefix),""):u;return new l(d,this.__opts).destroy()});Promise.all(c).then(i,t)})}).bind(this)}_compact(e,t){var n={return_docs:!1,last_seq:e.last_seq||0,since:e.last_seq||0},i=[],o,a=0;let s=u=>{this.activeTasks.update(o,{completed_items:++a}),i.push(this.compactDocument(u.id,0))},l=u=>{this.activeTasks.remove(o,u),t(u)},c=u=>{var d=u.last_seq;Promise.all(i).then(()=>Sr(this,"_local/compaction",f=>!f.last_seq||f.last_seq<d?(f.last_seq=d,f):!1)).then(()=>{this.activeTasks.remove(o),t(null,{ok:!0})}).catch(l)};this.info().then(u=>{o=this.activeTasks.add({name:"database_compaction",total_items:u.update_seq-n.last_seq}),this.changes(n).on("change",s).on("complete",c).on("error",l)})}changes(e,t){return typeof e=="function"&&(t=e,e={}),e=e||{},e.return_docs="return_docs"in e?e.return_docs:!e.live,new ro(this,e,t)}type(){return typeof this._type=="function"?this._type():this.adapter}};Cr.prototype.purge=Ce("_purge",function(r,e,t){if(typeof this._purge=="undefined")return t(ie(ko,"Purge is not implemented in the "+this.adapter+" adapter."));var n=this;n._getRevisionTree(r,(i,o)=>{if(i)return t(i);if(!o)return t(ie(Ze));let a;try{a=Mh(o,e)}catch(s){return t(s.message||s)}n._purge(r,a,(s,l)=>{if(s)return t(s);Jh(n,r,e).then(function(){return t(null,l)})})})});io=class{constructor(){this.isReady=!1,this.failed=!1,this.queue=[]}execute(){var e;if(this.failed)for(;e=this.queue.shift();)e(this.failed);else for(;e=this.queue.shift();)e()}fail(e){this.failed=e,this.execute()}ready(e){this.isReady=!0,this.db=e,this.execute()}addTask(e){this.queue.push(e),this.failed&&this.execute()}};Er=class extends Cr{constructor(e,t){super(),this._setup(e,t)}_setup(e,t){if(super._setup(),t=t||{},e&&typeof e=="object"&&(t=e,e=t.name,delete t.name),t.deterministic_revs===void 0&&(t.deterministic_revs=!0),this.__opts=t=$e(t),this.auto_compaction=t.auto_compaction,this.purged_infos_limit=t.purged_infos_limit||1e3,this.prefix=ae.prefix,typeof e!="string")throw new Error("Missing/invalid DB name");var n=(t.prefix||"")+e,i=Yh(n,t);if(t.name=i.name,t.adapter=t.adapter||i.adapter,this.name=e,this._adapter=t.adapter,ae.emit("debug",["adapter","Picked adapter: ",t.adapter]),!ae.adapters[t.adapter]||!ae.adapters[t.adapter].valid())throw new Error("Invalid Adapter: "+t.adapter);if(t.view_adapter&&(!ae.adapters[t.view_adapter]||!ae.adapters[t.view_adapter].valid()))throw new Error("Invalid View Adapter: "+t.view_adapter);this.taskqueue=new io,this.adapter=t.adapter,ae.adapters[t.adapter].call(this,t,o=>{if(o)return this.taskqueue.fail(o);ep(this),this.emit("created",this),ae.emit("created",this.name),this.taskqueue.ready(this)})}},ae=dc(Er,function(r,e){Er.prototype._setup.call(this,r,e)}),fc=fetch,rn=Headers,oo=class{constructor(){this.tasks={}}list(){return Object.values(this.tasks)}add(e){let t=En();return this.tasks[t]={id:t,name:e.name,total_items:e.total_items,created_at:new Date().toJSON()},t}get(e){return this.tasks[e]}remove(e,t){return delete this.tasks[e],this.tasks}update(e,t){let n=this.tasks[e];if(typeof n!="undefined"){let i={id:n.id,name:n.name,created_at:n.created_at,total_items:t.total_items||n.total_items,completed_items:t.completed_items||n.completed_items,updated_at:new Date().toJSON()};this.tasks[e]=i}return this.tasks}};ae.adapters={};ae.preferredAdapters=[];ae.prefix="_pouch_";Pl=new ft.default;tp(ae);ae.adapter=function(r,e,t){e.valid()&&(ae.adapters[r]=e,t&&ae.preferredAdapters.push(r))};ae.plugin=function(r){if(typeof r=="function")r(ae);else{if(typeof r!="object"||Object.keys(r).length===0)throw new Error('Invalid plugin: got "'+r+'", expected an object or a function');Object.keys(r).forEach(function(e){ae.prototype[e]=r[e]})}return this.__defaults&&(ae.__defaults=Object.assign({},this.__defaults)),ae};ae.defaults=function(r){let e=dc(ae,function(t,n){n=n||{},t&&typeof t=="object"&&(n=t,t=n.name,delete n.name),n=Object.assign({},e.__defaults,n),ae.call(this,t,n)});return e.preferredAdapters=ae.preferredAdapters.slice(),Object.keys(ae).forEach(function(t){t in e||(e[t]=ae[t])}),e.__defaults=Object.assign({},this.__defaults,r),e};ae.fetch=function(r,e){return fc(r,e)};ae.prototype.activeTasks=ae.activeTasks=new oo;np="9.0.0";ip=["$or","$nor","$not"];vc=-324,so=3,lo="";Ol={$elemMatch:function(r,e,t,n){return!Array.isArray(n)||n.length===0?!1:typeof n[0]=="object"&&n[0]!==null?n.some(function(i){return on(i,e,Object.keys(e))}):n.some(function(i){return Tr(e,r,t,i)})},$allMatch:function(r,e,t,n){return!Array.isArray(n)||n.length===0?!1:typeof n[0]=="object"&&n[0]!==null?n.every(function(i){return on(i,e,Object.keys(e))}):n.every(function(i){return Tr(e,r,t,i)})},$eq:function(r,e,t,n){return Et(n)&&Ee(n,e)===0},$gte:function(r,e,t,n){return Et(n)&&Ee(n,e)>=0},$gt:function(r,e,t,n){return Et(n)&&Ee(n,e)>0},$lte:function(r,e,t,n){return Et(n)&&Ee(n,e)<=0},$lt:function(r,e,t,n){return Et(n)&&Ee(n,e)<0},$exists:function(r,e,t,n){return e?Et(n):!Et(n)},$mod:function(r,e,t,n){return Tn(n)&&Cp(n,e)},$ne:function(r,e,t,n){return e.every(function(i){return Ee(n,i)!==0})},$in:function(r,e,t,n){return Tn(n)&&$l(n,e)},$nin:function(r,e,t,n){return Tn(n)&&!$l(n,e)},$size:function(r,e,t,n){return Tn(n)&&Array.isArray(n)&&Tp(n,e)},$all:function(r,e,t,n){return Array.isArray(n)&&Ep(n,e)},$regex:function(r,e,t,n){return Tn(n)&&typeof n=="string"&&e.every(function(i){return Ap(n,i)})},$type:function(r,e,t,n){return Pp(n,e)}};ae.plugin(Fp);ae.version=np;qp=yc(["_id","_rev","_access","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),Np=yc(["_access","_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);Qp=5,Te="document-store",Le="by-sequence",Ye="attach-store",At="attach-seq-store",qe="meta-store",ct="local-store",Ui="detect-blob-support";An=new eo;ho=!1,po=[];nn=new Map,Wi=new Map;Sc.valid=function(){try{return typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(r){return!1}};dg=25,fg=50,yr=5e3,hg=1e4,Ki={};go.valid=function(){return!0};mt=class extends Error{constructor(e){super(),this.status=400,this.name="query_parse_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,mt)}catch(t){}}},ln=class extends Error{constructor(e){super(),this.status=404,this.name="not_found",this.message=e,this.error=!0;try{Error.captureStackTrace(this,ln)}catch(t){}}},cn=class extends Error{constructor(e){super(),this.status=500,this.name="invalid_value",this.message=e,this.error=!0;try{Error.captureStackTrace(this,cn)}catch(t){}}};bg=Xe.bind(null,"log"),xg=Array.isArray,_g=JSON.parse;In=class{constructor(){this.promise=Promise.resolve()}add(e){return this.promise=this.promise.catch(()=>{}).then(()=>e()),this.promise}finish(){return this.promise}};Nl={},jl=new In,Sg=50;Yi={_sum:function(r,e){return mo(e)},_count:function(r,e){return e.length},_stats:function(r,e){function t(n){for(var i=0,o=0,a=n.length;o<a;o++){var s=n[o];i+=s*s}return i}return{sum:mo(e),min:Math.min.apply(null,e),max:Math.max.apply(null,e),count:e.length,sumsqr:t(e)}}};$g="mrviews",Tc=Eg($g,Ag,Pg,Ig);Mg={query:Og,viewCleanup:Dg};Ul=1,Vl="pouchdb",qg=5,it=0;Pr=class{constructor(e,t,n,i,o={writeSourceCheckpoint:!0,writeTargetCheckpoint:!0}){this.src=e,this.target=t,this.id=n,this.returnValue=i,this.opts=o,typeof o.writeSourceCheckpoint=="undefined"&&(o.writeSourceCheckpoint=!0),typeof o.writeTargetCheckpoint=="undefined"&&(o.writeTargetCheckpoint=!0)}writeCheckpoint(e,t){var n=this;return this.updateTarget(e,t).then(function(){return n.updateSource(e,t)})}updateTarget(e,t){return this.opts.writeTargetCheckpoint?vo(this.target,this.id,e,t,this.returnValue):Promise.resolve(!0)}updateSource(e,t){if(this.opts.writeSourceCheckpoint){var n=this;return vo(this.src,this.id,e,t,this.returnValue).catch(function(i){if(Kl(i))return n.opts.writeSourceCheckpoint=!1,!0;throw i})}else return Promise.resolve(!0)}getCheckpoint(){var e=this;return!e.opts.writeSourceCheckpoint&&!e.opts.writeTargetCheckpoint?Promise.resolve(it):e.opts&&e.opts.writeSourceCheckpoint&&!e.opts.writeTargetCheckpoint?e.src.get(e.id).then(function(t){return t.last_seq||it}).catch(function(t){if(t.status!==404)throw t;return it}):e.target.get(e.id).then(function(t){return e.opts&&e.opts.writeTargetCheckpoint&&!e.opts.writeSourceCheckpoint?t.last_seq||it:e.src.get(e.id).then(function(n){if(t.version!==n.version)return it;var i;return t.version?i=t.version.toString():i="undefined",i in Wl?Wl[i](t,n):it},function(n){if(n.status===404&&t.last_seq)return e.src.put({_id:e.id,last_seq:it}).then(function(){return it},function(i){return Kl(i)?(e.opts.writeSourceCheckpoint=!1,t.last_seq):it});throw n})}).catch(function(t){if(t.status!==404)throw t;return it})}},Wl={undefined:function(r,e){return Ee(r.last_seq,e.last_seq)===0?e.last_seq:0},1:function(r,e){return Ng(e,r).last_seq}};Gl=0;wo=class extends ft.default{constructor(){super(),this.cancelled=!1,this.state="pending";let e=new Promise((t,n)=>{this.once("complete",t),this.once("error",n)});this.then=function(t,n){return e.then(t,n)},this.catch=function(t){return e.catch(t)},this.catch(function(){})}cancel(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")}ready(e,t){if(this._readyCalled)return;this._readyCalled=!0;let n=()=>{this.cancel()};e.once("destroyed",n),t.once("destroyed",n);function i(){e.removeListener("destroyed",n),t.removeListener("destroyed",n)}this.once("complete",i),this.once("error",i)}};xo=class extends ft.default{constructor(e,t,n,i){super(),this.canceled=!1;let o=n.push?Object.assign({},n,n.push):n,a=n.pull?Object.assign({},n,n.pull):n;this.push=bo(e,t,o),this.pull=bo(t,e,a),this.pushPaused=!0,this.pullPaused=!0;let s=h=>{this.emit("change",{direction:"pull",change:h})},l=h=>{this.emit("change",{direction:"push",change:h})},c=h=>{this.emit("denied",{direction:"push",doc:h})},u=h=>{this.emit("denied",{direction:"pull",doc:h})},d=()=>{this.pushPaused=!0,this.pullPaused&&this.emit("paused")},f=()=>{this.pullPaused=!0,this.pushPaused&&this.emit("paused")},m=()=>{this.pushPaused=!1,this.pullPaused&&this.emit("active",{direction:"push"})},b=()=>{this.pullPaused=!1,this.pushPaused&&this.emit("active",{direction:"pull"})},E={},S=h=>(p,w)=>{(p==="change"&&(w===s||w===l)||p==="denied"&&(w===u||w===c)||p==="paused"&&(w===f||w===d)||p==="active"&&(w===b||w===m))&&(p in E||(E[p]={}),E[p][h]=!0,Object.keys(E[p]).length===2&&this.removeAllListeners(p))};n.live&&(this.push.on("complete",this.pull.cancel.bind(this.pull)),this.pull.on("complete",this.push.cancel.bind(this.push)));function y(h,p,w){h.listeners(p).indexOf(w)==-1&&h.on(p,w)}this.on("newListener",function(h){h==="change"?(y(this.pull,"change",s),y(this.push,"change",l)):h==="denied"?(y(this.pull,"denied",u),y(this.push,"denied",c)):h==="active"?(y(this.pull,"active",b),y(this.push,"active",m)):h==="paused"&&(y(this.pull,"paused",f),y(this.push,"paused",d))}),this.on("removeListener",function(h){h==="change"?(this.pull.removeListener("change",s),this.push.removeListener("change",l)):h==="denied"?(this.pull.removeListener("denied",u),this.push.removeListener("denied",c)):h==="active"?(this.pull.removeListener("active",b),this.push.removeListener("active",m)):h==="paused"&&(this.pull.removeListener("paused",f),this.push.removeListener("paused",d))}),this.pull.on("removeListener",S("pull")),this.push.on("removeListener",S("push"));let g=Promise.all([this.push,this.pull]).then(h=>{let p={push:h[0],pull:h[1]};return this.emit("complete",p),i&&i(null,p),this.removeAllListeners(),p},h=>{if(this.cancel(),i?i(h):this.emit("error",h),this.removeAllListeners(),i)throw h});this.then=function(h,p){return g.then(h,p)},this.catch=function(h){return g.catch(h)}}cancel(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())}};ae.plugin(cg).plugin(vg).plugin(Mg).plugin(Vg);Wg=ae});function qo(r,e){function t(n){for(var i=Object.getOwnPropertyNames(r),o=0,a=i.length;o<a;o++)typeof r[i[o]]!="function"&&(this[i[o]]=r[i[o]]);this.stack===void 0&&(this.stack=new Error().stack),n!==void 0&&(this.reason=n)}return t.prototype=_e.prototype,new t(e)}function Dn(r){if(typeof r!="object"){var e=r;r=Zg,r.data=e}return"error"in r&&r.error==="conflict"&&(r.name="conflict",r.status=409),"name"in r||(r.name=r.error||"unknown"),"status"in r||(r.status=500),"message"in r||(r.message=r.message||r.reason),"stack"in r||(r.stack=new Error().stack),r}var _e,$0,O0,D0,M0,Gg,Jg,Qg,L0,Zg,R0,F0,B0,q0,Yg,N0,j0,z0,H0,U0,V0,W0,K0,G0,J0,Mr=j(()=>{_e=class extends Error{constructor(e,t,n){super(),this.status=e,this.name=t,this.message=n,this.error=!0}toString(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})}},$0=new _e(401,"unauthorized","Name or password is incorrect."),O0=new _e(400,"bad_request","Missing JSON list of 'docs'"),D0=new _e(404,"not_found","missing"),M0=new _e(409,"conflict","Document update conflict"),Gg=new _e(400,"bad_request","_id field must contain a string"),Jg=new _e(412,"missing_id","_id is required for puts"),Qg=new _e(400,"bad_request","Only reserved document ids may start with underscore."),L0=new _e(412,"precondition_failed","Database not open"),Zg=new _e(500,"unknown_error","Database encountered an unknown error"),R0=new _e(500,"badarg","Some query argument is invalid"),F0=new _e(400,"invalid_request","Request was invalid"),B0=new _e(400,"query_parse_error","Some query parameter is invalid"),q0=new _e(500,"doc_validation","Bad special document member"),Yg=new _e(400,"bad_request","Something wrong with the request"),N0=new _e(400,"bad_request","Document must be a JSON object"),j0=new _e(404,"not_found","Database not found"),z0=new _e(500,"indexed_db_went_bad","unknown"),H0=new _e(500,"web_sql_went_bad","unknown"),U0=new _e(500,"levelDB_went_went_bad","unknown"),V0=new _e(403,"forbidden","Forbidden by design doc validate_doc_update function"),W0=new _e(400,"bad_request","Invalid rev format"),K0=new _e(412,"file_exists","The database could not be created, the file already exists."),G0=new _e(412,"missing_stub","A pre-existing attachment stub wasn't found"),J0=new _e(413,"invalid_url","Provided URL is invalid")});var un,No=j(()=>{un=Headers});function em(r,e){r=r||[],e=e||{};try{return new Blob(r,e)}catch(o){if(o.name!=="TypeError")throw o;for(var t=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,n=new t,i=0;i<r.length;i+=1)n.append(r[i]);return n.getBlob(e.type)}}function tm(r){for(var e=r.length,t=new ArrayBuffer(e),n=new Uint8Array(t),i=0;i<e;i++)n[i]=r.charCodeAt(i);return t}function nm(r,e){return em([tm(r)],{type:e})}function Rc(r,e){return nm(Xg(r),e)}var Xg,jo=j(()=>{Xg=function(r){return atob(r)}});function rm(r,e,t){for(var n="",i=t-r.length;n.length<i;)n+=e;return n}function im(r,e,t){var n=rm(r,e,t);return n+r}function Se(r,e){if(r===e)return 0;r=_t(r),e=_t(e);var t=Uo(r),n=Uo(e);if(t-n!==0)return t-n;switch(typeof r){case"number":return r-e;case"boolean":return r<e?-1:1;case"string":return cm(r,e)}return Array.isArray(r)?lm(r,e):um(r,e)}function _t(r){switch(typeof r){case"undefined":return null;case"number":return r===1/0||r===-1/0||isNaN(r)?null:r;case"object":var e=r;if(Array.isArray(r)){var t=r.length;r=new Array(t);for(var n=0;n<t;n++)r[n]=_t(e[n])}else{if(r instanceof Date)return r.toJSON();if(r!==null){r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=e[i];typeof o!="undefined"&&(r[i]=_t(o))}}}}return r}function om(r){if(r!==null)switch(typeof r){case"boolean":return r?1:0;case"number":return dm(r);case"string":return r.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var e=Array.isArray(r),t=e?r:Object.keys(r),n=-1,i=t.length,o="";if(e)for(;++n<i;)o+=et(t[n]);else for(;++n<i;){var a=t[n];o+=et(a)+et(r[a])}return o}return""}function et(r){var e="\0";return r=_t(r),Uo(r)+Ho+om(r)+e}function am(r,e){var t=e,n,i=r[e]==="1";if(i)n=0,e++;else{var o=r[e]==="0";e++;var a="",s=r.substring(e,e+zo),l=parseInt(s,10)+Fc;for(o&&(l=-l),e+=zo;;){var c=r[e];if(c==="\0")break;a+=c,e++}a=a.split("."),a.length===1?n=parseInt(a,10):n=parseFloat(a[0]+"."+a[1]),o&&(n=n-10),l!==0&&(n=parseFloat(n+"e"+l))}return{num:n,length:e-t}}function sm(r,e){var t=r.pop();if(e.length){var n=e[e.length-1];t===n.element&&(e.pop(),n=e[e.length-1]);var i=n.element,o=n.index;if(Array.isArray(i))i.push(t);else if(o===r.length-2){var a=r.pop();i[a]=t}else r.push(t)}}function Bc(r){for(var e=[],t=[],n=0;;){var i=r[n++];if(i==="\0"){if(e.length===1)return e.pop();sm(e,t);continue}switch(i){case"1":e.push(null);break;case"2":e.push(r[n]==="1"),n++;break;case"3":var o=am(r,n);e.push(o.num),n+=o.length;break;case"4":for(var a="";;){var s=r[n];if(s==="\0")break;a+=s,n++}a=a.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),e.push(a);break;case"5":var l={element:[],index:e.length};e.push(l.element),t.push(l);break;case"6":var c={element:{},index:e.length};e.push(c.element),t.push(c);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+i)}}}function lm(r,e){for(var t=Math.min(r.length,e.length),n=0;n<t;n++){var i=Se(r[n],e[n]);if(i!==0)return i}return r.length===e.length?0:r.length>e.length?1:-1}function cm(r,e){return r===e?0:r>e?1:-1}function um(r,e){for(var t=Object.keys(r),n=Object.keys(e),i=Math.min(t.length,n.length),o=0;o<i;o++){var a=Se(t[o],n[o]);if(a!==0||(a=Se(r[t[o]],e[n[o]]),a!==0))return a}return t.length===n.length?0:t.length>n.length?1:-1}function Uo(r){var e=["boolean","number","string","object"],t=e.indexOf(typeof r);if(~t)return r===null?1:Array.isArray(r)?5:t<3?t+2:t+3;if(Array.isArray(r))return 5}function dm(r){if(r===0)return"1";var e=r.toExponential().split(/e\+?/),t=parseInt(e[1],10),n=r<0,i=n?"0":"2",o=(n?-t:t)-Fc,a=im(o.toString(),"0",zo);i+=Ho+a;var s=Math.abs(parseFloat(e[0]));n&&(s=10-s);var l=s.toFixed(20);return l=l.replace(/\.?0+$/,""),i+=Ho+l,i}var Fc,zo,Ho,Lr=j(()=>{Fc=-324,zo=3,Ho=""});function Mn(r){return qc.default.hash(r)}var qc,rx,Rr=j(()=>{jo();qc=Ut(Fi()),rx=self.setImmediate||self.setTimeout});function hm(r){return typeof ArrayBuffer!="undefined"&&r instanceof ArrayBuffer||typeof Blob!="undefined"&&r instanceof Blob}function pm(r){return r instanceof ArrayBuffer?r.slice(0):r.slice(0,r.size,r.type)}function mm(r){var e=Object.getPrototypeOf(r);if(e===null)return!0;var t=e.constructor;return typeof t=="function"&&t instanceof t&&zc.call(t)==gm}function yt(r){var e,t,n;if(!r||typeof r!="object")return r;if(Array.isArray(r)){for(e=[],t=0,n=r.length;t<n;t++)e[t]=yt(r[t]);return e}if(r instanceof Date&&isFinite(r))return r.toISOString();if(hm(r))return pm(r);if(!mm(r))return r;e={};for(t in r)if(Object.prototype.hasOwnProperty.call(r,t)){var i=yt(r[t]);typeof i!="undefined"&&(e[t]=i)}return e}function Fr(r){if(typeof console!="undefined"&&typeof console[r]=="function"){var e=Array.prototype.slice.call(arguments,1);console[r].apply(console,e)}}function vm(){}function wt(r){return typeof r._remote=="boolean"?r._remote:typeof r.type=="function"?(Fr("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),r.type()==="http"):!1}function dn(r,e,t){return r.get(e).catch(function(n){if(n.status!==404)throw n;return{}}).then(function(n){var i=n._rev,o=t(n);return o?(o._id=e,o._rev=i,wm(r,o,t)):{updated:!1,rev:i}})}function wm(r,e,t){return r.put(e).then(function(n){return{updated:!0,rev:n.rev}},function(n){if(n.status!==409)throw n;return dn(r,e._id,t)})}var fm,zc,gm,Nc,Ln,ym,jc,Rn=j(()=>{Mr();fm=Ut(require("events"));Rr();zc=Function.prototype.toString,gm=zc.call(Object);try{localStorage.setItem("_pouch_check_localstorage",1),Nc=!!localStorage.getItem("_pouch_check_localstorage")}catch(r){Nc=!1}Ln=typeof queueMicrotask=="function"?queueMicrotask:function(e){Promise.resolve().then(e)};ym=vm.name;ym?jc=function(r){return r.name}:jc=function(r){var e=r.toString().match(/^\s*function\s*(?:(\S+)\s*)?\(/);return e&&e[1]?e[1]:""}});function Vo(r,e){return e&&r.then(function(t){Ln(function(){e(null,t)})},function(t){Ln(function(){e(t)})}),r}function Hc(r){return function(...e){var t=e.pop(),n=r.apply(this,e);return typeof t=="function"&&Vo(n,t),n}}function Uc(r,e){return r.then(function(t){return e().then(function(){return t})},function(t){return e().then(function(){throw t})})}function Br(r,e){return function(){var t=arguments,n=this;return r.add(function(){return e.apply(n,t)})}}function Wo(r){var e=new Set(r),t=new Array(e.size),n=-1;return e.forEach(function(i){t[++n]=i}),t}function qr(r){var e=new Array(r.size),t=-1;return r.forEach(function(n,i){e[++t]=i}),e}var pt,fn,hn,Vc=j(()=>{Rn();pt=class extends Error{constructor(e){super(),this.status=400,this.name="query_parse_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,pt)}catch(t){}}},fn=class extends Error{constructor(e){super(),this.status=404,this.name="not_found",this.message=e,this.error=!0;try{Error.captureStackTrace(this,fn)}catch(t){}}},hn=class extends Error{constructor(e){super(),this.status=500,this.name="invalid_value",this.message=e,this.error=!0;try{Error.captureStackTrace(this,hn)}catch(t){}}}});function Wc(r){if(!r)return"undefined";switch(typeof r){case"function":return r.toString();case"string":return r.toString();default:return JSON.stringify(r)}}function bm(r,e){return Wc(r)+Wc(e)+"undefined"}async function Kc(r,e,t,n,i,o){let a=bm(t,n),s;if(!i&&(s=r._cachedViews=r._cachedViews||{},s[a]))return s[a];let l=r.info().then(async function(c){let u=c.db_name+"-mrview-"+(i?"temp":Mn(a));function d(S){S.views=S.views||{};let y=e;y.indexOf("/")===-1&&(y=e+"/"+e);let g=S.views[y]=S.views[y]||{};if(!g[u])return g[u]=!0,S}await dn(r,"_local/"+o,d);let m=(await r.registerDependentDatabase(u)).db;m.auto_compaction=!0;let b={name:u,db:m,sourceDB:r,adapter:r.adapter,mapFun:t,reduceFun:n},E;try{E=await b.db.get("_local/lastSeq")}catch(S){if(S.status!==404)throw S}return b.seq=E?E.seq:0,s&&b.db.once("destroyed",function(){delete s[a]}),b});return s&&(s[a]=l),l}function Ko(r){return r.indexOf("/")===-1?[r,r]:r.split("/")}function _m(r){return r.length===1&&/^1-/.test(r[0].rev)}function Qc(r,e,t){try{r.emit("error",e)}catch(n){Fr("error",`The user's map/reduce function threw an uncaught error.
You can debug this error by doing:
myDatabase.on('error', function (err) { debugger; });
Please double-check your map/reduce function.`),Fr("error",e,t)}}function km(r,e,t,n){function i(v,x,_){try{x(_)}catch(C){Qc(v,C,{fun:x,doc:_})}}function o(v,x,_,C,A){try{return{output:x(_,C,A)}}catch(M){return Qc(v,M,{fun:x,keys:_,values:C,rereduce:A}),{error:M}}}function a(v,x){let _=Se(v.key,x.key);return _!==0?_:Se(v.value,x.value)}function s(v,x,_){return _=_||0,typeof x=="number"?v.slice(_,x+_):_>0?v.slice(_):v}function l(v){let x=v.value;return x&&typeof x=="object"&&x._id||v.id}function c(v){for(let x of v.rows){let _=x.doc&&x.doc._attachments;if(_)for(let C of Object.keys(_)){let A=_[C];_[C].data=Rc(A.data,A.content_type)}}}function u(v){return function(x){return v.include_docs&&v.attachments&&v.binary&&c(x),x}}function d(v,x,_,C){let A=x[v];typeof A!="undefined"&&(C&&(A=encodeURIComponent(JSON.stringify(A))),_.push(v+"="+A))}function f(v){if(typeof v!="undefined"){let x=Number(v);return!isNaN(x)&&x===parseInt(v,10)?x:v}}function m(v){return v.group_level=f(v.group_level),v.limit=f(v.limit),v.skip=f(v.skip),v}function b(v){if(v){if(typeof v!="number")return new pt(`Invalid value for integer: "${v}"`);if(v<0)return new pt(`Invalid value for positive integer: "${v}"`)}}function E(v,x){let _=v.descending?"endkey":"startkey",C=v.descending?"startkey":"endkey";if(typeof v[_]!="undefined"&&typeof v[C]!="undefined"&&Se(v[_],v[C])>0)throw new pt("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(x.reduce&&v.reduce!==!1){if(v.include_docs)throw new pt("{include_docs:true} is invalid for reduce");if(v.keys&&v.keys.length>1&&!v.group&&!v.group_level)throw new pt("Multi-key fetches for reduce views must use {group: true}")}for(let A of["group_level","limit","skip"]){let M=b(v[A]);if(M)throw M}}async function S(v,x,_){let C=[],A,M="GET",q;if(d("reduce",_,C),d("include_docs",_,C),d("attachments",_,C),d("limit",_,C),d("descending",_,C),d("group",_,C),d("group_level",_,C),d("skip",_,C),d("stale",_,C),d("conflicts",_,C),d("startkey",_,C,!0),d("start_key",_,C,!0),d("endkey",_,C,!0),d("end_key",_,C,!0),d("inclusive_end",_,C),d("key",_,C,!0),d("update_seq",_,C),C=C.join("&"),C=C===""?"":"?"+C,typeof _.keys!="undefined"){let D=`keys=${encodeURIComponent(JSON.stringify(_.keys))}`;D.length+C.length+1<=2e3?C+=(C[0]==="?"?"&":"?")+D:(M="POST",typeof x=="string"?A={keys:_.keys}:x.keys=_.keys)}if(typeof x=="string"){let P=Ko(x),D=await v.fetch("_design/"+P[0]+"/_view/"+P[1]+C,{headers:new un({"Content-Type":"application/json"}),method:M,body:JSON.stringify(A)});q=D.ok;let O=await D.json();if(!q)throw O.status=D.status,Dn(O);for(let L of O.rows)if(L.value&&L.value.error&&L.value.error==="builtin_reduce_error")throw new Error(L.reason);return new Promise(function(L){L(O)}).then(u(_))}A=A||{};for(let P of Object.keys(x))Array.isArray(x[P])?A[P]=x[P]:A[P]=x[P].toString();let I=await v.fetch("_temp_view"+C,{headers:new un({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(A)});q=I.ok;let T=await I.json();if(!q)throw T.status=I.status,Dn(T);return new Promise(function(P){P(T)}).then(u(_))}function y(v,x,_){return new Promise(function(C,A){v._query(x,_,function(M,q){if(M)return A(M);C(q)})})}function g(v){return new Promise(function(x,_){v._viewCleanup(function(C,A){if(C)return _(C);x(A)})})}function h(v){return function(x){if(x.status===404)return v;throw x}}async function p(v,x,_){let C="_local/doc_"+v,A={_id:C,keys:[]},M=_.get(v),q=M[0],I=M[1];function T(){return _m(I)?Promise.resolve(A):x.db.get(C).catch(h(A))}function P(J){return J.keys.length?x.db.allDocs({keys:J.keys,include_docs:!0}):Promise.resolve({rows:[]})}function D(J,U){let ee=[],le=new Set;for(let W of U.rows){let z=W.doc;if(z&&(ee.push(z),le.add(z._id),z._deleted=!q.has(z._id),!z._deleted)){let H=q.get(z._id);"value"in H&&(z.value=H.value)}}let ce=qr(q);for(let W of ce)if(!le.has(W)){let z={_id:W},H=q.get(W);"value"in H&&(z.value=H.value),ee.push(z)}return J.keys=Wo(ce.concat(J.keys)),ee.push(J),ee}let O=await T(),L=await P(O);return D(O,L)}function w(v){return v.sourceDB.get("_local/purges").then(function(x){let _=x.purgeSeq;return v.db.get("_local/purgeSeq").then(function(C){return C._rev}).catch(h(void 0)).then(function(C){return v.db.put({_id:"_local/purgeSeq",_rev:C,purgeSeq:_})})}).catch(function(x){if(x.status!==404)throw x})}function k(v,x,_){var C="_local/lastSeq";return v.db.get(C).catch(h({_id:C,seq:0})).then(function(A){var M=qr(x);return Promise.all(M.map(function(q){return p(q,v,x)})).then(function(q){var I=q.flat();return A.seq=_,I.push(A),v.db.bulkDocs({docs:I})}).then(()=>w(v))})}function R(v){let x=typeof v=="string"?v:v.name,_=Gc[x];return _||(_=Gc[x]=new Fn),_}async function B(v,x){return Br(R(v),function(){return F(v,x)})()}async function F(v,x){let _,C,A;function M(W,z){let H={id:C._id,key:_t(W)};typeof z!="undefined"&&z!==null&&(H.value=_t(z)),_.push(H)}let q=e(v.mapFun,M),I=v.seq||0;function T(){return v.sourceDB.info().then(function(W){A=v.sourceDB.activeTasks.add({name:"view_indexing",total_items:W.update_seq-I})})}function P(W,z){return function(){return k(v,W,z)}}let D=0,O={view:v.name,indexed_docs:D};v.sourceDB.emit("indexing",O);let L=new Fn;async function J(){let W=await v.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:I,limit:x.changes_batch_size}),z=await U();return ee(W,z)}function U(){return v.db.get("_local/purgeSeq").then(function(W){return W.purgeSeq}).catch(h(-1)).then(function(W){return v.sourceDB.get("_local/purges").then(function(z){let H=z.purges.filter(function(he,oe){return oe>W}).map(he=>he.docId),fe=H.filter(function(he,oe){return H.indexOf(he)===oe});return Promise.all(fe.map(function(he){return v.sourceDB.get(he).then(function(oe){return{docId:he,doc:oe}}).catch(h({docId:he}))}))}).catch(h([]))})}function ee(W,z){let H=W.results;if(!H.length&&!z.length)return;for(let oe of z)if(H.findIndex(function(Ve){return Ve.id===oe.docId})<0){let Ve={_id:oe.docId,doc:{_id:oe.docId,_deleted:1},changes:[]};oe.doc&&(Ve.doc=oe.doc,Ve.changes.push({rev:oe.doc._rev})),H.push(Ve)}let fe=le(H);L.add(P(fe,I)),D=D+H.length;let he={view:v.name,last_seq:W.last_seq,results_count:H.length,indexed_docs:D};if(v.sourceDB.emit("indexing",he),v.sourceDB.activeTasks.update(A,{completed_items:D}),!(H.length<x.changes_batch_size))return J()}function le(W){let z=new Map;for(let H of W){if(H.doc._id[0]!=="_"){_=[],C=H.doc,C._deleted||i(v.sourceDB,q,C),_.sort(a);let fe=ce(_);z.set(H.doc._id,[fe,H.changes])}I=H.seq}return z}function ce(W){let z=new Map,H;for(let fe=0,he=W.length;fe<he;fe++){let oe=W[fe],je=[oe.key,oe.id];fe>0&&Se(oe.key,H)===0&&je.push(fe),z.set(et(je),oe),H=oe.key}return z}try{await T(),await J(),await L.finish(),v.seq=I,v.sourceDB.activeTasks.remove(A)}catch(W){v.sourceDB.activeTasks.remove(A,W)}}function K(v,x,_){_.group_level===0&&delete _.group_level;let C=_.group||_.group_level,A=t(v.reduceFun),M=[],q=isNaN(_.group_level)?Number.POSITIVE_INFINITY:_.group_level;for(let I of x){let T=M[M.length-1],P=C?I.key:null;if(C&&Array.isArray(P)&&(P=P.slice(0,q)),T&&Se(T.groupKey,P)===0){T.keys.push([I.key,I.id]),T.values.push(I.value);continue}M.push({keys:[[I.key,I.id]],values:[I.value],groupKey:P})}x=[];for(let I of M){let T=o(v.sourceDB,A,I.keys,I.values,!1);if(T.error&&T.error instanceof hn)throw T.error;x.push({value:T.error?null:T.output,key:I.groupKey})}return{rows:s(x,_.limit,_.skip)}}function V(v,x){return Br(R(v),function(){return Y(v,x)})()}async function Y(v,x){let _,C=v.reduceFun&&x.reduce!==!1,A=x.skip||0;typeof x.keys!="undefined"&&!x.keys.length&&(x.limit=0,delete x.keys);async function M(I){I.include_docs=!0;let T=await v.db.allDocs(I);return _=T.total_rows,T.rows.map(function(P){if("value"in P.doc&&typeof P.doc.value=="object"&&P.doc.value!==null){let O=Object.keys(P.doc.value).sort(),L=["id","key","value"];if(!(O<L||O>L))return P.doc.value}let D=Bc(P.doc._id);return{key:D[0],id:D[1],value:"value"in P.doc?P.doc.value:null}})}async function q(I){let T;if(C?T=K(v,I,x):typeof x.keys=="undefined"?T={total_rows:_,offset:A,rows:I}:T={total_rows:_,offset:A,rows:s(I,x.limit,x.skip)},x.update_seq&&(T.update_seq=v.seq),x.include_docs){let P=Wo(I.map(l)),D=await v.sourceDB.allDocs({keys:P,include_docs:!0,conflicts:x.conflicts,attachments:x.attachments,binary:x.binary}),O=new Map;for(let L of D.rows)O.set(L.id,L.doc);for(let L of I){let J=l(L),U=O.get(J);U&&(L.doc=U)}}return T}if(typeof x.keys!="undefined"){let T=x.keys.map(function(O){let L={startkey:et([O]),endkey:et([O,{}])};return x.update_seq&&(L.update_seq=!0),M(L)}),D=(await Promise.all(T)).flat();return q(D)}else{let I={descending:x.descending};x.update_seq&&(I.update_seq=!0);let T,P;if("start_key"in x&&(T=x.start_key),"startkey"in x&&(T=x.startkey),"end_key"in x&&(P=x.end_key),"endkey"in x&&(P=x.endkey),typeof T!="undefined"&&(I.startkey=x.descending?et([T,{}]):et([T])),typeof P!="undefined"){let O=x.inclusive_end!==!1;x.descending&&(O=!O),I.endkey=et(O?[P,{}]:[P])}if(typeof x.key!="undefined"){let O=et([x.key]),L=et([x.key,{}]);I.descending?(I.endkey=O,I.startkey=L):(I.startkey=O,I.endkey=L)}C||(typeof x.limit=="number"&&(I.limit=x.limit),I.skip=A);let D=await M(I);return q(D)}}async function Q(v){return(await v.fetch("_view_cleanup",{headers:new un({"Content-Type":"application/json"}),method:"POST"})).json()}async function G(v){try{let x=await v.get("_local/"+r),_=new Map;for(let T of Object.keys(x.views)){let P=Ko(T),D="_design/"+P[0],O=P[1],L=_.get(D);L||(L=new Set,_.set(D,L)),L.add(O)}let C={keys:qr(_),include_docs:!0},A=await v.allDocs(C),M={};for(let T of A.rows){let P=T.key.substring(8);for(let D of _.get(T.key)){let O=P+"/"+D;x.views[O]||(O=D);let L=Object.keys(x.views[O]),J=T.doc&&T.doc.views&&T.doc.views[D];for(let U of L)M[U]=M[U]||J}}let I=Object.keys(M).filter(function(T){return!M[T]}).map(function(T){return Br(R(T),function(){return new v.constructor(T,v.__opts).destroy()})()});return Promise.all(I).then(function(){return{ok:!0}})}catch(x){if(x.status===404)return{ok:!0};throw x}}async function Z(v,x,_){if(typeof v._query=="function")return y(v,x,_);if(wt(v))return S(v,x,_);let C={changes_batch_size:v.__opts.view_update_changes_batch_size||xm};if(typeof x!="string")return E(_,x),Jc.add(async function(){let A=await Kc(v,"temp_view/temp_view",x.map,x.reduce,!0,r);return Uc(B(A,C).then(function(){return V(A,_)}),function(){return A.db.destroy()})}),Jc.finish();{let A=x,M=Ko(A),q=M[0],I=M[1],T=await v.get("_design/"+q);if(x=T.views&&T.views[I],!x)throw new fn(`ddoc ${T._id} has no view named ${I}`);n(T,I),E(_,x);let P=await Kc(v,A,x.map,x.reduce,!1,r);return _.stale==="ok"||_.stale==="update_after"?(_.stale==="update_after"&&Ln(function(){B(P,C)}),V(P,_)):(await B(P,C),V(P,_))}}function te(v,x,_){let C=this;typeof x=="function"&&(_=x,x={}),x=x?m(x):{},typeof v=="function"&&(v={map:v});let A=Promise.resolve().then(function(){return Z(C,v,x)});return Vo(A,_),A}let se=Hc(function(){let v=this;return typeof v._viewCleanup=="function"?g(v):wt(v)?Q(v):G(v)});return{query:te,viewCleanup:se}}var Fn,Gc,Jc,xm,Zc,Yc=j(()=>{jo();Lr();Mr();No();Rn();Rr();Vc();Fn=class{constructor(){this.promise=Promise.resolve()}add(e){return this.promise=this.promise.catch(()=>{}).then(()=>e()),this.promise}finish(){return this.promise}};Gc={},Jc=new Fn,xm=50;Zc=km});function gn(r,e){for(var t=r,n=0,i=e.length;n<i;n++){var o=e[n];if(t=t[o],!t)break}return t}function nu(r,e,t){for(var n=0,i=e.length;n<i-1;n++){var o=e[n];r=r[o]=r[o]||{}}r[e[i-1]]=t}function jr(r,e){return r<e?-1:r>e?1:0}function kt(r){for(var e=[],t="",n=0,i=r.length;n<i;n++){var o=r[n];n>0&&r[n-1]==="\\"&&(o==="$"||o===".")?t=t.substring(0,t.length-1)+o:o==="."?(e.push(t),t=""):t+=o}return e.push(t),e}function ru(r){return Sm.indexOf(r)>-1}function ze(r){return Object.keys(r)[0]}function zr(r){return r[ze(r)]}function qn(r){var e={},t={$or:!0,$nor:!0};return r.forEach(function(n){Object.keys(n).forEach(function(i){var o=n[i];if(typeof o!="object"&&(o={$eq:o}),ru(i))if(o instanceof Array){if(t[i]){t[i]=!1,e[i]=o;return}var a=[];e[i].forEach(function(l){Object.keys(o).forEach(function(c){var u=o[c],d=Math.max(Object.keys(l).length,Object.keys(u).length),f=qn([l,u]);Object.keys(f).length<=d||a.push(f)})}),e[i]=a}else e[i]=qn([o]);else{var s=e[i]=e[i]||{};Object.keys(o).forEach(function(l){var c=o[l];if(l==="$gt"||l==="$gte")return Cm(l,c,s);if(l==="$lt"||l==="$lte")return Em(l,c,s);if(l==="$ne")return Tm(c,s);if(l==="$eq")return Am(c,s);if(l==="$regex")return Pm(c,s);s[l]=c})}})}),e}function Cm(r,e,t){typeof t.$eq=="undefined"&&(typeof t.$gte!="undefined"?r==="$gte"?e>t.$gte&&(t.$gte=e):e>=t.$gte&&(delete t.$gte,t.$gt=e):typeof t.$gt!="undefined"?r==="$gte"?e>t.$gt&&(delete t.$gt,t.$gte=e):e>t.$gt&&(t.$gt=e):t[r]=e)}function Em(r,e,t){typeof t.$eq=="undefined"&&(typeof t.$lte!="undefined"?r==="$lte"?e<t.$lte&&(t.$lte=e):e<=t.$lte&&(delete t.$lte,t.$lt=e):typeof t.$lt!="undefined"?r==="$lte"?e<t.$lt&&(delete t.$lt,t.$lte=e):e<t.$lt&&(t.$lt=e):t[r]=e)}function Tm(r,e){"$ne"in e?e.$ne.push(r):e.$ne=[r]}function Am(r,e){delete e.$gt,delete e.$gte,delete e.$lt,delete e.$lte,delete e.$ne,e.$eq=r}function Pm(r,e){"$regex"in e?e.$regex.push(r):e.$regex=[r]}function iu(r){for(var e in r){if(Array.isArray(r))for(var t in r)r[t].$and&&(r[t]=qn(r[t].$and));var n=r[e];typeof n=="object"&&iu(n)}return r}function ou(r,e){for(var t in r){t==="$and"&&(e=!0);var n=r[t];typeof n=="object"&&(e=ou(n,e))}return e}function Hr(r){var e=yt(r);ou(e,!1)&&(e=iu(e),"$and"in e&&(e=qn(e.$and))),["$or","$nor"].forEach(function(a){a in e&&e[a].forEach(function(s){for(var l=Object.keys(s),c=0;c<l.length;c++){var u=l[c],d=s[u];(typeof d!="object"||d===null)&&(s[u]={$eq:d})}})}),"$not"in e&&(e.$not=qn([e.$not]));for(var t=Object.keys(e),n=0;n<t.length;n++){var i=t[n],o=e[i];(typeof o!="object"||o===null)&&(o={$eq:o}),e[i]=o}return Go(e),e}function Go(r){Object.keys(r).forEach(function(e){var t=r[e];Array.isArray(t)?t.forEach(function(n){n&&typeof n=="object"&&Go(n)}):e==="$ne"?r.$ne=[t]:e==="$regex"?r.$regex=[t]:t&&typeof t=="object"&&Go(t)})}function Im(r){function e(t){return r.map(function(n){var i=ze(n),o=kt(i),a=gn(t,o);return a})}return function(t,n){var i=e(t.doc),o=e(n.doc),a=Se(i,o);return a!==0?a:jr(t.doc._id,n.doc._id)}}function Jo(r,e,t){if(r=r.filter(function(a){return pn(a.doc,e.selector,t)}),e.sort){var n=Im(e.sort);r=r.sort(n),typeof e.sort[0]!="string"&&zr(e.sort[0])==="desc"&&(r=r.reverse())}if("limit"in e||"skip"in e){var i=e.skip||0,o=("limit"in e?e.limit:r.length)+i;r=r.slice(i,o)}return r}function pn(r,e,t){return t.every(function(n){var i=e[n],o=kt(n),a=gn(r,o);return ru(n)?$m(n,i,r):Nr(i,r,o,a)})}function Nr(r,e,t,n){return r?typeof r=="object"?Object.keys(r).every(function(i){var o=r[i];if(i.indexOf("$")===0)return Xc(i,e,o,t,n);var a=kt(i);if(n===void 0&&typeof o!="object"&&a.length>0)return!1;var s=gn(n,a);return typeof o=="object"?Nr(o,e,t,s):Xc("$eq",e,o,a,s)}):r===n:!0}function $m(r,e,t){return r==="$or"?e.some(function(n){return pn(t,n,Object.keys(n))}):r==="$not"?!pn(t,e,Object.keys(e)):!e.find(function(n){return pn(t,n,Object.keys(n))})}function Xc(r,e,t,n,i){if(!tu[r])throw new Error('unknown operator "'+r+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return tu[r](e,t,n,i)}function Bn(r){return typeof r!="undefined"&&r!==null}function Mt(r){return typeof r!="undefined"}function Om(r,e){if(typeof r!="number"||parseInt(r,10)!==r)return!1;var t=e[0],n=e[1];return r%t===n}function eu(r,e){return e.some(function(t){return r instanceof Array?r.some(function(n){return Se(t,n)===0}):Se(t,r)===0})}function Dm(r,e){return e.every(function(t){return r.some(function(n){return Se(t,n)===0})})}function Mm(r,e){return r.length===e}function Lm(r,e){var t=new RegExp(e);return t.test(r)}function Rm(r,e){switch(e){case"null":return r===null;case"boolean":return typeof r=="boolean";case"number":return typeof r=="number";case"string":return typeof r=="string";case"array":return r instanceof Array;case"object":return{}.toString.call(r)==="[object Object]"}}function Nn(r,e){if(typeof e!="object")throw new Error("Selector error: expected a JSON object");e=Hr(e);var t={doc:r},n=Jo([t],{selector:e},Object.keys(e));return n&&n.length===1}var Sm,tu,au=j(()=>{Rn();Lr();Sm=["$or","$nor","$not"];tu={$elemMatch:function(r,e,t,n){return!Array.isArray(n)||n.length===0?!1:typeof n[0]=="object"&&n[0]!==null?n.some(function(i){return pn(i,e,Object.keys(e))}):n.some(function(i){return Nr(e,r,t,i)})},$allMatch:function(r,e,t,n){return!Array.isArray(n)||n.length===0?!1:typeof n[0]=="object"&&n[0]!==null?n.every(function(i){return pn(i,e,Object.keys(e))}):n.every(function(i){return Nr(e,r,t,i)})},$eq:function(r,e,t,n){return Mt(n)&&Se(n,e)===0},$gte:function(r,e,t,n){return Mt(n)&&Se(n,e)>=0},$gt:function(r,e,t,n){return Mt(n)&&Se(n,e)>0},$lte:function(r,e,t,n){return Mt(n)&&Se(n,e)<=0},$lt:function(r,e,t,n){return Mt(n)&&Se(n,e)<0},$exists:function(r,e,t,n){return e?Mt(n):!Mt(n)},$mod:function(r,e,t,n){return Bn(n)&&Om(n,e)},$ne:function(r,e,t,n){return e.every(function(i){return Se(n,i)!==0})},$in:function(r,e,t,n){return Bn(n)&&eu(n,e)},$nin:function(r,e,t,n){return Bn(n)&&!eu(n,e)},$size:function(r,e,t,n){return Bn(n)&&Array.isArray(n)&&Mm(n,e)},$all:function(r,e,t,n){return Array.isArray(n)&&Dm(n,e)},$regex:function(r,e,t,n){return Bn(n)&&typeof n=="string"&&e.every(function(i){return Lm(n,i)})},$type:function(r,e,t,n){return Rm(n,e)}}});var yu={};xt(yu,{default:()=>Uv});function Yo(r){let e={};for(let t of r)Object.assign(e,t);return e}function Bm(r,e){let t={};for(let n of e){let i=kt(n),o=gn(r,i);typeof o!="undefined"&&nu(t,i,o)}return t}function uu(r,e){for(let t=0,n=Math.min(r.length,e.length);t<n;t++)if(r[t]!==e[t])return!1;return!0}function qm(r,e){return r.length>e.length?!1:uu(r,e)}function Nm(r,e){r=r.slice();for(let t of e){if(!r.length)break;let n=r.indexOf(t);if(n===-1)return!1;r.splice(n,1)}return!0}function jm(r){let e={};for(let t of r)e[t]=!0;return e}function zm(r,e){let t=null,n=-1;for(let i of r){let o=e(i);o>n&&(n=o,t=i)}return t}function su(r,e){if(r.length!==e.length)return!1;for(let t=0,n=r.length;t<n;t++)if(r[t]!==e[t])return!1;return!0}function Hm(r){return Array.from(new Set(r))}function jn(r){return function(...e){let t=e[e.length-1];if(typeof t=="function"){let n=t.bind(null,null),i=t.bind(null);r.apply(this,e.slice(0,-1)).then(n,i)}else return r.apply(this,e)}}function du(r){r=yt(r),r.index||(r.index={});for(let e of["type","name","ddoc"])r.index[e]&&(r[e]=r.index[e],delete r.index[e]);return r.fields&&(r.index.fields=r.fields,delete r.fields),r.type||(r.type="json"),r}function Ur(r){return typeof r=="object"&&r!==null}function Um(r,e,t){let n="",i=e,o=!0;if(["$in","$nin","$or","$and","$mod","$nor","$all"].indexOf(r)!==-1&&(Array.isArray(e)||(n="Query operator "+r+" must be an array.")),["$not","$elemMatch","$allMatch"].indexOf(r)!==-1&&(!Array.isArray(e)&&Ur(e)||(n="Query operator "+r+" must be an object.")),r==="$mod"&&Array.isArray(e))if(e.length!==2)n="Query operator $mod must be in the format [divisor, remainder], where divisor and remainder are both integers.";else{let a=e[0],s=e[1];a===0&&(n="Query operator $mod's divisor cannot be 0, cannot divide by zero.",o=!1),(typeof a!="number"||parseInt(a,10)!==a)&&(n="Query operator $mod's divisor is not an integer.",i=a),parseInt(s,10)!==s&&(n="Query operator $mod's remainder is not an integer.",i=s)}if(r==="$exists"&&typeof e!="boolean"&&(n="Query operator $exists must be a boolean."),r==="$type"){let a=["null","boolean","number","string","array","object"],s='"'+a.slice(0,a.length-1).join('", "')+'", or "'+a[a.length-1]+'"';(typeof e!="string"||a.indexOf(e)==-1)&&(n="Query operator $type must be a string. Supported values: "+s+".")}if(r==="$size"&&parseInt(e,10)!==e&&(n="Query operator $size must be a integer."),r==="$regex"&&typeof e!="string"&&(t?n="Query operator $regex must be a string.":e instanceof RegExp||(n="Query operator $regex must be a string or an instance of a javascript regular expression.")),n){if(o){let a=i===null?" ":Array.isArray(i)?" array":" "+typeof i,s=Ur(i)?JSON.stringify(i,null,"	"):i;n+=" Received"+a+": "+s}throw new Error(n)}}function Vr(r,e){if(Array.isArray(r))for(let t of r)Ur(t)&&Vr(t,e);else for(let[t,n]of Object.entries(r))Vm.indexOf(t)!==-1&&Um(t,n,e),Km.indexOf(t)===-1&&Wm.indexOf(t)===-1&&Ur(n)&&Vr(n,e)}async function zn(r,e,t){t.body&&(t.body=JSON.stringify(t.body),t.headers=new un({"Content-type":"application/json"}));let n=await r.fetch(e,t),i=await n.json();if(!n.ok){i.status=n.status;let o=qo(i);throw Dn(o)}return i}async function Gm(r,e){return await zn(r,"_index",{method:"POST",body:du(e)})}async function Jm(r,e){return Vr(e.selector,!0),await zn(r,"_find",{method:"POST",body:e})}async function Qm(r,e){return await zn(r,"_explain",{method:"POST",body:e})}async function Zm(r){return await zn(r,"_index",{method:"GET"})}async function Ym(r,e){let t=e.ddoc,n=e.type||"json",i=e.name;if(!t)throw new Error("you must provide an index's ddoc");if(!i)throw new Error("you must provide an index's name");let o="_index/"+[t,n,i].map(encodeURIComponent).join("/");return await zn(r,o,{method:"DELETE"})}function fu(r,e){for(let t of e)if(r=r[t],r===void 0)return;return r}function Xm(r,e,t){return function(n){if(t&&!Nn(n,t))return;let i=[];for(let o of r){let a=fu(n,kt(o));if(a===void 0)return;i.push(a)}e(i)}}function ev(r,e,t){let n=kt(r);return function(i){if(t&&!Nn(i,t))return;let o=fu(i,n);o!==void 0&&e(o)}}function tv(r,e,t){return function(n){t&&!Nn(n,t)||e(n[r])}}function nv(r,e,t){return function(n){if(t&&!Nn(n,t))return;let i=r.map(o=>n[o]);e(i)}}function rv(r){return r.every(e=>e.indexOf(".")===-1)}function iv(r,e,t){let n=rv(r),i=r.length===1;return n?i?tv(r[0],e,t):nv(r,e,t):i?ev(r[0],e,t):Xm(r,e,t)}function ov(r,e){let t=Object.keys(r.fields),n=r.partial_filter_selector;return iv(t,e,n)}function av(){throw new Error("reduce not supported")}function sv(r,e){let t=r.views[e];if(!t.map||!t.map.fields)throw new Error("ddoc "+r._id+" with view "+e+" doesn't have map.fields defined. maybe it wasn't created by this plugin?")}function Xo(r){return r._customFindAbstractMapper?{query:function(t,n){let i=Qo.query.bind(this);return r._customFindAbstractMapper.query.call(this,t,n,i)},viewCleanup:function(){let t=Qo.viewCleanup.bind(this);return r._customFindAbstractMapper.viewCleanup.call(this,t)}}:Qo}function lv(r){if(!Array.isArray(r))throw new Error("invalid sort json - should be an array");return r.map(function(e){if(typeof e=="string"){let t={};return t[e]="asc",t}else return e})}function uv(r){let e=[];return typeof r=="string"?e.push(r):e=r,e.map(function(t){return t.replace(cv,"")})}function hu(r){return r.fields=r.fields.map(function(e){if(typeof e=="string"){let t={};return t[e]="asc",t}return e}),r.partial_filter_selector&&(r.partial_filter_selector=Hr(r.partial_filter_selector)),r}function dv(r,e){return e.def.fields.map(t=>{let n=ze(t);return gn(r,kt(n))})}function fv(r,e,t){let n=t.def.fields,i=0;for(let o of r){let a=dv(o.doc,t);if(n.length===1)a=a[0];else for(;a.length>e.length;)a.pop();if(Math.abs(Se(a,e))>0)break;++i}return i>0?r.slice(i):r}function hv(r){let e=yt(r);return delete e.startkey,delete e.endkey,delete e.inclusive_start,delete e.inclusive_end,"endkey"in r&&(e.startkey=r.endkey),"startkey"in r&&(e.endkey=r.startkey),"inclusive_start"in r&&(e.inclusive_end=r.inclusive_start),"inclusive_end"in r&&(e.inclusive_start=r.inclusive_end),e}function pv(r){let e=r.fields.filter(function(t){return zr(t)==="asc"});if(e.length!==0&&e.length!==r.fields.length)throw new Error("unsupported mixed sorting")}function gv(r,e){if(e.defaultUsed&&r.sort){let t=r.sort.filter(function(n){return Object.keys(n)[0]!=="_id"}).map(function(n){return Object.keys(n)[0]});if(t.length>0)throw new Error('Cannot sort on field(s) "'+t.join(",")+'" when using the default index')}e.defaultUsed}function mv(r){if(typeof r.selector!="object")throw new Error("you must provide a selector when you find()")}function vv(r,e){let t=Object.keys(r),n=e?e.map(ze):[],i;return t.length>=n.length?i=t:i=n,n.length===0?{fields:i}:(i=i.sort(function(o,a){let s=n.indexOf(o);s===-1&&(s=Number.MAX_VALUE);let l=n.indexOf(a);return l===-1&&(l=Number.MAX_VALUE),s<l?-1:s>l?1:0}),{fields:i,sortOrder:e.map(ze)})}async function yv(r,e){e=du(e);let t=yt(e.index);e.index=hu(e.index),pv(e.index);let n;function i(){return n||(n=Mn(JSON.stringify(e)))}let o=e.name||"idx-"+i(),a=e.ddoc||"idx-"+i(),s="_design/"+a,l=!1,c=!1;function u(f){return f._rev&&f.language!=="query"&&(l=!0),f.language="query",f.views=f.views||{},c=!!f.views[o],c?!1:(f.views[o]={map:{fields:Yo(e.index.fields),partial_filter_selector:e.index.partial_filter_selector},reduce:"_count",options:{def:t}},f)}if(r.constructor.emit("debug",["find","creating index",s]),await dn(r,s,u),l)throw new Error('invalid language for ddoc with id "'+s+'" (should be "query")');let d=a+"/"+o;return await Xo(r).query.call(r,d,{limit:0,reduce:!1}),{id:s,name:o,result:c?"exists":"created"}}async function pu(r){let e=await r.allDocs({startkey:"_design/",endkey:"_design/\uFFFF",include_docs:!0}),t={indexes:[{ddoc:null,name:"_all_docs",type:"special",def:{fields:[{_id:"asc"}]}}]};return t.indexes=cu(t.indexes,e.rows.filter(function(n){return n.doc.language==="query"}).map(function(n){return(n.doc.views!==void 0?Object.keys(n.doc.views):[]).map(function(o){let a=n.doc.views[o];return{ddoc:n.id,name:o,type:"json",def:hu(a.options.def)}})})),t.indexes.sort(function(n,i){return jr(n.name,i.name)}),t.total_rows=t.indexes.length,t}function bv(r,e){return r.def.fields.some(t=>ze(t)===e)}function xv(r,e){let t=r[e];return ze(t)!=="$eq"}function gu(r,e){let t=e.def.fields.map(ze);return r.slice().sort(function(n,i){let o=t.indexOf(n),a=t.indexOf(i);return o===-1&&(o=Number.MAX_VALUE),a===-1&&(a=Number.MAX_VALUE),jr(o,a)})}function _v(r,e,t){t=gu(t,r);let n=!1;for(let i=0,o=t.length;i<o;i++){let a=t[i];if(n||!bv(r,a))return t.slice(i);i<o-1&&xv(e,a)&&(n=!0)}return[]}function kv(r){let e=[];for(let[t,n]of Object.entries(r))for(let i of Object.keys(n))i==="$ne"&&e.push(t);return e}function Sv(r,e,t,n){let i=cu(r,_v(e,t,n),kv(t));return gu(Hm(i),e)}function Cv(r,e,t){if(e){let n=qm(e,r),i=uu(t,r);return n&&i}return Nm(t,r)}function mu(r){return Ev.indexOf(r)===-1}function Tv(r,e){let t=r[0],n=e[t];return typeof n=="undefined"?!0:!(Object.keys(n).length===1&&ze(n)==="$ne")}function Av(r,e,t,n){let i=r.def.fields.map(ze);return Cv(i,e,t)?Tv(i,n):!1}function Pv(r,e,t,n){return n.filter(function(i){return Av(i,t,e,r)})}function Iv(r,e,t,n,i){let o=Pv(r,e,t,n);if(o.length===0){if(i)throw{error:"no_usable_index",message:"There is no index available for this selector."};let l=n[0];return l.defaultUsed=!0,l}if(o.length===1&&!i)return o[0];let a=jm(e);function s(l){let c=l.def.fields.map(ze),u=0;for(let d of c)a[d]&&u++;return u}if(i){let l="_design/"+i[0],c=i.length===2?i[1]:!1,u=o.find(function(d){return!!(c&&d.ddoc===l&&c===d.name||d.ddoc===l)});if(!u)throw{error:"unknown_error",message:"Could not find that index or could not use that index for the query"};return u}return zm(o,s)}function $v(r,e){switch(r){case"$eq":return{key:e};case"$lte":return{endkey:e};case"$gte":return{startkey:e};case"$lt":return{endkey:e,inclusive_end:!1};case"$gt":return{startkey:e,inclusive_start:!1}}return{startkey:Wr}}function Ov(r,e){let t=ze(e.def.fields[0]),n=r[t]||{},i=[],o=Object.keys(n),a;for(let s of o){mu(s)&&i.push(t);let l=n[s],c=$v(s,l);a?a=Yo([a,c]):a=c}return{queryOpts:a,inMemoryFields:i}}function Dv(r,e){switch(r){case"$eq":return{startkey:e,endkey:e};case"$lte":return{endkey:e};case"$gte":return{startkey:e};case"$lt":return{endkey:e,inclusive_end:!1};case"$gt":return{startkey:e,inclusive_start:!1}}}function Mv(r,e){let t=e.def.fields.map(ze),n=[],i=[],o=[],a,s;function l(u){a!==!1&&i.push(Wr),s!==!1&&o.push(Zo),n=t.slice(u)}for(let u=0,d=t.length;u<d;u++){let f=t[u],m=r[f];if(!m||!Object.keys(m).length){l(u);break}else if(Object.keys(m).some(mu)){l(u);break}else if(u>0){let S="$gt"in m||"$gte"in m||"$lt"in m||"$lte"in m,y=Object.keys(r[t[u-1]]),g=su(y,["$eq"]),h=su(y,Object.keys(m));if(S&&!g&&!h){l(u);break}}let b=Object.keys(m),E=null;for(let S of b){let y=m[S],g=Dv(S,y);E?E=Yo([E,g]):E=g}i.push("startkey"in E?E.startkey:Wr),o.push("endkey"in E?E.endkey:Zo),"inclusive_start"in E&&(a=E.inclusive_start),"inclusive_end"in E&&(s=E.inclusive_end)}let c={startkey:i,endkey:o};return typeof a!="undefined"&&(c.inclusive_start=a),typeof s!="undefined"&&(c.inclusive_end=s),{queryOpts:c,inMemoryFields:n}}function Lv(r){return Object.keys(r).map(function(t){return r[t]}).some(function(t){return typeof t=="object"&&Object.keys(t).length===0})}function Rv(r){return{queryOpts:{startkey:null},inMemoryFields:[Object.keys(r)]}}function Fv(r,e){return e.defaultUsed?Rv(r,e):e.def.fields.length===1?Ov(r,e):Mv(r,e)}function Bv(r,e){let t=r.selector,n=r.sort;if(Lv(t))return Object.assign({},wv,{index:e[0]});let i=vv(t,n),o=i.fields,a=i.sortOrder,s=Iv(t,o,a,e,r.use_index),l=Fv(t,s),c=l.queryOpts,u=l.inMemoryFields,d=Sv(u,s,t,o);return{queryOpts:c,index:s,inMemoryFields:d}}function qv(r){return r.ddoc.substring(8)+"/"+r.name}async function Nv(r,e){let t=yt(e);t.descending?("endkey"in t&&typeof t.endkey!="string"&&(t.endkey=""),"startkey"in t&&typeof t.startkey!="string"&&(t.limit=0)):("startkey"in t&&typeof t.startkey!="string"&&(t.startkey=""),"endkey"in t&&typeof t.endkey!="string"&&(t.limit=0)),"key"in t&&typeof t.key!="string"&&(t.limit=0),t.limit>0&&t.indexes_count&&(t.original_limit=t.limit,t.limit+=t.indexes_count);let n=await r.allDocs(t);return n.rows=n.rows.filter(function(i){return!/^_design\//.test(i.id)}),t.original_limit&&(t.limit=t.original_limit),n.rows=n.rows.slice(0,t.limit),n}async function jv(r,e,t){return t.name==="_all_docs"?Nv(r,e):Xo(r).query.call(r,qv(t),e)}async function vu(r,e,t){e.selector&&(Vr(e.selector,!1),e.selector=Hr(e.selector)),e.sort&&(e.sort=lv(e.sort)),e.use_index&&(e.use_index=uv(e.use_index)),"limit"in e||(e.limit=25),mv(e);let n=await pu(r);r.constructor.emit("debug",["find","planning query",e]);let i=Bv(e,n.indexes);r.constructor.emit("debug",["find","query plan",i]);let o=i.index;gv(e,o);let a=Object.assign({include_docs:!0,reduce:!1,indexes_count:n.total_rows},i.queryOpts);if("startkey"in a&&"endkey"in a&&Se(a.startkey,a.endkey)>0)return{docs:[]};if(e.sort&&typeof e.sort[0]!="string"&&zr(e.sort[0])==="desc"&&(a.descending=!0,a=hv(a)),i.inMemoryFields.length||(a.limit=e.limit,"skip"in e&&(a.skip=e.skip)),t)return Promise.resolve(i,a);let l=await jv(r,a,o);a.inclusive_start===!1&&(l.rows=fv(l.rows,a.startkey,o)),i.inMemoryFields.length&&(l.rows=Jo(l.rows,e,i.inMemoryFields));let c={docs:l.rows.map(function(u){let d=u.doc;return e.fields?Bm(d,e.fields):d})};return o.defaultUsed&&(c.warning="No matching index found, create an index to optimize query time."),c}async function zv(r,e){let t=await vu(r,e,!0);return{dbname:r.name,index:t.index,selector:e.selector,range:{start_key:t.queryOpts.startkey,end_key:t.queryOpts.endkey},opts:{use_index:e.use_index||[],bookmark:"nil",limit:e.limit,skip:e.skip,sort:e.sort||{},fields:e.fields,conflicts:!1,r:[49]},limit:e.limit,skip:e.skip||0,fields:e.fields}}async function Hv(r,e){if(!e.ddoc)throw new Error("you must supply an index.ddoc when deleting");if(!e.name)throw new Error("you must supply an index.name when deleting");let t=e.ddoc,n=e.name;function i(o){return Object.keys(o.views).length===1&&o.views[n]?{_id:t,_deleted:!0}:(delete o.views[n],o)}return await dn(r,t,i),await Xo(r).viewCleanup.apply(r),{ok:!0}}var Fm,lu,cu,Vm,Wm,Km,Qo,cv,Wr,Zo,wv,Ev,mn,Uv,wu=j(()=>{Mr();No();Yc();Rr();Lr();au();Rn();Fm=(...r)=>r.flat(1/0),lu=(...r)=>{let e=[];for(let t of r)Array.isArray(t)?e=e.concat(lu(...t)):e.push(t);return e},cu=typeof Array.prototype.flat=="function"?Fm:lu;Vm=["$all","$allMatch","$and","$elemMatch","$exists","$in","$mod","$nin","$nor","$not","$or","$regex","$size","$type"],Wm=["$in","$nin","$mod","$all"],Km=["$eq","$gt","$gte","$lt","$lte"];Qo=Zc("indexes",ov,av,sv);cv=/^_design\//;Wr=null,Zo={"\uFFFF":{}},wv={queryOpts:{limit:0,startkey:Zo,endkey:Wr},inMemoryFields:[]};Ev=["$eq","$gt","$gte","$lt","$lte"];mn={};mn.createIndex=jn(async function(r){if(typeof r!="object")throw new Error("you must provide an index to create");return(wt(this)?Gm:yv)(this,r)});mn.find=jn(async function(r){if(typeof r!="object")throw new Error("you must provide search parameters to find()");return(wt(this)?Jm:vu)(this,r)});mn.explain=jn(async function(r){if(typeof r!="object")throw new Error("you must provide search parameters to explain()");return(wt(this)?Qm:zv)(this,r)});mn.getIndexes=jn(async function(){return(wt(this)?Zm:pu)(this)});mn.deleteIndex=jn(async function(r){if(typeof r!="object")throw new Error("you must provide an index to delete");return(wt(this)?Ym:Hv)(this,r)});Uv=mn});var _u={};xt(_u,{LocalDraftManager:()=>bt,initDraftDB:()=>ea});var bu,Kr,xu,ea,Lt,bt,Hn=j(()=>{bu=require("obsidian");en();Fe();Kr=null,xu=async()=>{if(Kr)return Kr;try{let{default:r}=await Promise.resolve().then(()=>(Bo(),Fo)),{default:e}=await Promise.resolve().then(()=>(wu(),yu));return r.plugin(e),Kr=new r("one2mp-local-drafts"),Kr}catch(r){return console.warn("PouchDB \u521D\u59CB\u5316\u5931\u8D25\uFF0C\u6539\u7528\u5185\u5B58\u8349\u7A3F\u5B58\u50A8",r),null}},ea=async()=>{await xu()},Lt=class{constructor(e){this.db=null;this.fallbackDrafts={};this.fallbackLoaded=!1;this.plugin=e}static getInstance(e){return Lt.instance||(Lt.instance=new Lt(e)),Lt.instance}static resetInstance(){Lt.instance=null}async ensureFallbackLoaded(){if(!this.fallbackLoaded)try{let e=await this.plugin.loadData(),t=e==null?void 0:e.local_drafts;t&&typeof t=="object"&&(this.fallbackDrafts=t)}catch(e){console.warn("\u52A0\u8F7D\u672C\u5730\u8349\u7A3F\u7F13\u5B58\u5931\u8D25",e)}finally{this.fallbackLoaded=!0}}async saveFallbackDrafts(){try{let e=await this.plugin.loadData();await this.plugin.saveData({...e!=null?e:{},local_drafts:this.fallbackDrafts})}catch(e){console.warn("\u4FDD\u5B58\u672C\u5730\u8349\u7A3F\u7F13\u5B58\u5931\u8D25",e)}}async getDb(){return this.db!==null?this.db:bu.Platform.isMobile?null:(this.db=await xu(),this.db)}async getDrafOfActiveNote(){let e,t=this.plugin.settings.selectedMPAccount;if(t!==void 0&&t){let n=this.plugin.app.workspace.getActiveFile();n&&(e=await this.getDraft(t,n.path),e===void 0&&(e={accountName:t,notePath:n.path,title:n.basename,_id:t+n.path},await this.setDraft(e)),e.title.trim()===""&&(e.title=n.basename,await this.setDraft(e)))}return e}isActiveNoteDraft(e){let t=this.plugin.app.workspace.getActiveFile();return e===void 0&&t===null?!0:e!==void 0&&t?e.notePath===t.path:!1}async getDraft(e,t){let n=await this.getDb();return n?new Promise(i=>{n.get(e+t).then(o=>{i(o)}).catch(()=>{i(void 0)})}):(await this.ensureFallbackLoaded(),this.fallbackDrafts[e+t])}async setDraft(e){let t=i=>i instanceof Error?i:new Error(String(i)),n=await this.getDb();if(!n){if(await this.ensureFallbackLoaded(),!e.accountName||!e.notePath)throw new Error($("assets.invalid-draft"));e._id||(e._id=e.accountName+e.notePath);let i=this.fallbackDrafts[e._id];return i&&Xt(e,i)||(this.fallbackDrafts[e._id]={...e},await this.saveFallbackDrafts()),!0}return new Promise((i,o)=>{if(!e.accountName||!e.notePath)return o(new Error($("assets.invalid-draft")));e._id||(e._id=e.accountName+e.notePath),n.get(e._id).then(a=>{if(Xt(e,a)){i(!0);return}else return e._rev=a._rev,n.put(e).then(()=>i(!0)).catch(()=>{i(!1)});i(!1)}).catch(a=>{if(a.status===404)return n.put(e).then(()=>i(!0)).catch(s=>{console.error("Error creating new draft:",s),o(t(s))});console.error("Error checking existing draft:",a),o(t(a))})})}},bt=Lt;bt.instance=null});function Ke(r){return Vv.get(r)||"unknow error."}var Vv,ku=j(()=>{Vv=new Map([[-1,"\u7CFB\u7EDF\u7E41\u5FD9\uFF0C\u6B64\u65F6\u8BF7\u5F00\u53D1\u8005\u7A0D\u5019\u518D\u8BD5"],[0,"\u8BF7\u6C42\u6210\u529F"],[40001,"\u83B7\u53D6 access_token \u65F6 AppSecret \u9519\u8BEF\uFF0C\u6216\u8005 access_token \u65E0\u6548\u3002\u8BF7\u5F00\u53D1\u8005\u8BA4\u771F\u6BD4\u5BF9 AppSecret \u7684\u6B63\u786E\u6027\uFF0C\u6216\u67E5\u770B\u662F\u5426\u6B63\u5728\u4E3A\u6070\u5F53\u7684\u516C\u4F17\u53F7\u8C03\u7528\u63A5\u53E3"],[40002,"\u4E0D\u5408\u6CD5\u7684\u51ED\u8BC1\u7C7B\u578B"],[40003,"\u4E0D\u5408\u6CD5\u7684 OpenID \uFF0C\u8BF7\u5F00\u53D1\u8005\u786E\u8BA4 OpenID \uFF08\u8BE5\u7528\u6237\uFF09\u662F\u5426\u5DF2\u5173\u6CE8\u516C\u4F17\u53F7\uFF0C\u6216\u662F\u5426\u662F\u5176\u4ED6\u516C\u4F17\u53F7\u7684 OpenID"],[40004,"\u4E0D\u5408\u6CD5\u7684\u5A92\u4F53\u6587\u4EF6\u7C7B\u578B"],[40005,"\u4E0D\u5408\u6CD5\u7684\u6587\u4EF6\u7C7B\u578B"],[40006,"\u4E0D\u5408\u6CD5\u7684\u6587\u4EF6\u5927\u5C0F"],[40007,"\u4E0D\u5408\u6CD5\u7684\u5A92\u4F53\u6587\u4EF6 id"],[40008,"\u4E0D\u5408\u6CD5\u7684\u6D88\u606F\u7C7B\u578B"],[40009,"\u4E0D\u5408\u6CD5\u7684\u56FE\u7247\u6587\u4EF6\u5927\u5C0F"],[40010,"\u4E0D\u5408\u6CD5\u7684\u8BED\u97F3\u6587\u4EF6\u5927\u5C0F"],[40011,"\u4E0D\u5408\u6CD5\u7684\u89C6\u9891\u6587\u4EF6\u5927\u5C0F"],[40012,"\u4E0D\u5408\u6CD5\u7684\u7F29\u7565\u56FE\u6587\u4EF6\u5927\u5C0F"],[40013,"\u4E0D\u5408\u6CD5\u7684 AppID \uFF0C\u8BF7\u5F00\u53D1\u8005\u68C0\u67E5 AppID \u7684\u6B63\u786E\u6027\uFF0C\u907F\u514D\u5F02\u5E38\u5B57\u7B26\uFF0C\u6CE8\u610F\u5927\u5C0F\u5199"],[40014,"\u4E0D\u5408\u6CD5\u7684 access_token \uFF0C\u8BF7\u5F00\u53D1\u8005\u8BA4\u771F\u6BD4\u5BF9 access_token \u7684\u6709\u6548\u6027\uFF08\u5982\u662F\u5426\u8FC7\u671F\uFF09\uFF0C\u6216\u67E5\u770B\u662F\u5426\u6B63\u5728\u4E3A\u6070\u5F53\u7684\u516C\u4F17\u53F7\u8C03\u7528\u63A5\u53E3"],[40015,"\u4E0D\u5408\u6CD5\u7684\u83DC\u5355\u7C7B\u578B"],[40016,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE\u4E2A\u6570"],[40017,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE\u7C7B\u578B"],[40018,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE\u540D\u5B57\u957F\u5EA6"],[40019,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE KEY \u957F\u5EA6"],[40020,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE URL \u957F\u5EA6"],[40021,"\u4E0D\u5408\u6CD5\u7684\u83DC\u5355\u7248\u672C\u53F7"],[40022,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u7EA7\u6570"],[40023,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE\u4E2A\u6570"],[40024,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE\u7C7B\u578B"],[40025,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE\u540D\u5B57\u957F\u5EA6"],[40026,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE KEY \u957F\u5EA6"],[40027,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE URL \u957F\u5EA6"],[40028,"\u4E0D\u5408\u6CD5\u7684\u81EA\u5B9A\u4E49\u83DC\u5355\u4F7F\u7528\u7528\u6237"],[40029,"\u65E0\u6548\u7684 oauth_code"],[40030,"\u4E0D\u5408\u6CD5\u7684 refresh_token"],[40031,"\u4E0D\u5408\u6CD5\u7684 openid \u5217\u8868"],[40032,"\u4E0D\u5408\u6CD5\u7684 openid \u5217\u8868\u957F\u5EA6"],[40033,"\u4E0D\u5408\u6CD5\u7684\u8BF7\u6C42\u5B57\u7B26\uFF0C\u4E0D\u80FD\u5305\u542B \\uxxxx \u683C\u5F0F\u7684\u5B57\u7B26"],[40035,"\u4E0D\u5408\u6CD5\u7684\u53C2\u6570"],[40038,"\u4E0D\u5408\u6CD5\u7684\u8BF7\u6C42\u683C\u5F0F"],[40039,"\u4E0D\u5408\u6CD5\u7684 URL \u957F\u5EA6"],[40048,"\u65E0\u6548\u7684url"],[40050,"\u4E0D\u5408\u6CD5\u7684\u5206\u7EC4 id"],[40051,"\u5206\u7EC4\u540D\u5B57\u4E0D\u5408\u6CD5"],[40060,"\u5220\u9664\u5355\u7BC7\u56FE\u6587\u65F6\uFF0C\u6307\u5B9A\u7684 article_idx \u4E0D\u5408\u6CD5"],[40117,"\u5206\u7EC4\u540D\u5B57\u4E0D\u5408\u6CD5"],[40118,"media_id \u5927\u5C0F\u4E0D\u5408\u6CD5"],[40119,"button \u7C7B\u578B\u9519\u8BEF"],[40120,"\u5B50 button \u7C7B\u578B\u9519\u8BEF"],[40121,"\u4E0D\u5408\u6CD5\u7684 media_id \u7C7B\u578B"],[40125,"\u65E0\u6548\u7684appsecret"],[40132,"\u5FAE\u4FE1\u53F7\u4E0D\u5408\u6CD5"],[40137,"\u4E0D\u652F\u6301\u7684\u56FE\u7247\u683C\u5F0F"],[40155,"\u8BF7\u52FF\u6DFB\u52A0\u5176\u4ED6\u516C\u4F17\u53F7\u7684\u4E3B\u9875\u94FE\u63A5"],[40163,"oauth_code\u5DF2\u4F7F\u7528"],[40164,"IP\u5730\u5740\u4E0D\u5728\u767D\u540D\u5355\u4E0A\uFF0C\u5C06ip\u6DFB\u52A0\u5230ip\u767D\u540D\u5355\u5217\u8868\u5373\u53EF"],[40227,"\u6807\u9898\u4E3A\u7A7A"],[40243,"AppSecret\u5DF2\u88AB\u51BB\u7ED3\uFF0C\u8BF7\u767B\u5F55MP\u89E3\u51BB\u540E\u518D\u6B21\u8C03\u7528"],[40249,"\u4E0D\u652F\u6301\u4E0B\u53D1\u8425\u9500/\u63A8\u5E7F\u7C7B\u7684\u6D88\u606F\u5185\u5BB9"],[40250,"\u4E0B\u53D1\u6D88\u606F\u5185\u5BB9\u4E0D\u89C4\u8303\uFF08\u5305\u542B\u7A7A\u503C\u7B49\uFF09\uFF0C\u5EFA\u8BAE\u68C0\u67E5\u5185\u5BB9\u89C4\u8303\u6027\u540E\u518D\u4E0B\u53D1"],[40251,"\u56E0\u5386\u53F2\u8FDD\u89C4\u5BFC\u81F4\u5E73\u53F0\u9650\u5236\u8D26\u53F7\u8C03\u7528\u4E0A\u9650\uFF0C\u5F53\u524D\u5DF2\u5230\u8FBE\u4E0B\u53D1\u4E0A\u9650"],[40252,"\u6B63\u5728\u8C03\u7528\u7684\u6A21\u677F\u4E0B\u53D1\u7684\u90E8\u5206\u5185\u5BB9\u5DF2\u8FDB\u5165\u5E73\u53F0\u5BA1\u6838\u6D41\u7A0B\uFF0C\u5728\u5BA1\u6838\u5B8C\u6210\u524D\uFF0C\u76F8\u5173\u5185\u5BB9\u6682\u65F6\u65E0\u6CD5\u4E0B\u53D1"],[41001,"\u7F3A\u5C11 access_token \u53C2\u6570"],[41002,"\u7F3A\u5C11 appid \u53C2\u6570"],[41003,"\u7F3A\u5C11 refresh_token \u53C2\u6570"],[41004,"\u7F3A\u5C11 secret \u53C2\u6570"],[41005,"\u7F3A\u5C11\u591A\u5A92\u4F53\u6587\u4EF6\u6570\u636E"],[41006,"\u7F3A\u5C11 media_id \u53C2\u6570"],[41007,"\u7F3A\u5C11\u5B50\u83DC\u5355\u6570\u636E"],[41008,"\u7F3A\u5C11 oauth code"],[41009,"\u7F3A\u5C11 openid"],[42001,"access_token \u8D85\u65F6\uFF0C\u8BF7\u68C0\u67E5 access_token \u7684\u6709\u6548\u671F\uFF0C\u8BF7\u53C2\u8003\u57FA\u7840\u652F\u6301 - \u83B7\u53D6 access_token \u4E2D\uFF0C\u5BF9 access_token \u7684\u8BE6\u7EC6\u673A\u5236\u8BF4\u660E"],[42002,"refresh_token \u8D85\u65F6"],[42003,"oauth_code \u8D85\u65F6"],[42007,"\u7528\u6237\u4FEE\u6539\u5FAE\u4FE1\u5BC6\u7801\uFF0C accesstoken \u548C refreshtoken \u5931\u6548\uFF0C\u9700\u8981\u91CD\u65B0\u6388\u6743"],[42010,"\u76F8\u540C media_id \u7FA4\u53D1\u8FC7\u5FEB\uFF0C\u8BF7\u91CD\u8BD5"],[43001,"\u9700\u8981 GET \u8BF7\u6C42"],[43002,"\u9700\u8981 POST \u8BF7\u6C42"],[43003,"\u9700\u8981 HTTPS \u8BF7\u6C42"],[43004,"\u9700\u8981\u63A5\u6536\u8005\u5173\u6CE8"],[43005,"\u9700\u8981\u597D\u53CB\u5173\u7CFB"],[43019,"\u9700\u8981\u5C06\u63A5\u6536\u8005\u4ECE\u9ED1\u540D\u5355\u4E2D\u79FB\u9664"],[43116,"\u8BE5\u6A21\u677F\u56E0\u6EE5\u7528\u88AB\u6EE5\u7528\u8FC7\u591A\uFF0C\u5DF2\u88AB\u9650\u5236\u4E0B\u53D1"],[44001,"\u591A\u5A92\u4F53\u6587\u4EF6\u4E3A\u7A7A"],[44002,"POST \u7684\u6570\u636E\u5305\u4E3A\u7A7A"],[44003,"\u56FE\u6587\u6D88\u606F\u5185\u5BB9\u4E3A\u7A7A"],[44004,"\u6587\u672C\u6D88\u606F\u5185\u5BB9\u4E3A\u7A7A"],[44008,"\u97F3\u9891\u5185\u5BB9\u5BA1\u6838\u5931\u8D25"],[44009,"\u56FE\u6587\u4E2D\u7684\u97F3\u9891\u5185\u5BB9\u5BA1\u6838\u5931\u8D25"],[45001,"\u591A\u5A92\u4F53\u6587\u4EF6\u5927\u5C0F\u8D85\u8FC7\u9650\u5236"],[45002,"\u6D88\u606F\u5185\u5BB9\u8D85\u8FC7\u9650\u5236"],[45003,"\u6807\u9898\u5B57\u6BB5\u8D85\u8FC7\u9650\u5236"],[45004,"\u63CF\u8FF0\u5B57\u6BB5\u8D85\u8FC7\u9650\u5236"],[45005,"\u94FE\u63A5\u5B57\u6BB5\u8D85\u8FC7\u9650\u5236"],[45006,"\u56FE\u7247\u94FE\u63A5\u5B57\u6BB5\u8D85\u8FC7\u9650\u5236"],[45007,"\u8BED\u97F3\u64AD\u653E\u65F6\u95F4\u8D85\u8FC7\u9650\u5236"],[45008,"\u56FE\u6587\u6D88\u606F\u8D85\u8FC7\u9650\u5236"],[45009,"\u63A5\u53E3\u8C03\u7528\u8D85\u8FC7\u9650\u5236"],[45010,"\u521B\u5EFA\u83DC\u5355\u4E2A\u6570\u8D85\u8FC7\u9650\u5236"],[45011,"API \u8C03\u7528\u592A\u9891\u7E41\uFF0C\u8BF7\u7A0D\u5019\u518D\u8BD5"],[45015,"\u56DE\u590D\u65F6\u95F4\u8D85\u8FC7\u9650\u5236"],[45016,"\u7CFB\u7EDF\u5206\u7EC4\uFF0C\u4E0D\u5141\u8BB8\u4FEE\u6539"],[45017,"\u5206\u7EC4\u540D\u5B57\u8FC7\u957F"],[45018,"\u5206\u7EC4\u6570\u91CF\u8D85\u8FC7\u4E0A\u9650"],[45047,"\u5BA2\u670D\u63A5\u53E3\u4E0B\u884C\u6761\u6570\u8D85\u8FC7\u4E0A\u9650"],[45064,"\u521B\u5EFA\u83DC\u5355\u5305\u542B\u672A\u5173\u8054\u7684\u5C0F\u7A0B\u5E8F"],[45065,"\u76F8\u540C clientmsgid \u5DF2\u5B58\u5728\u7FA4\u53D1\u8BB0\u5F55\uFF0C\u8FD4\u56DE\u6570\u636E\u4E2D\u5E26\u6709\u5DF2\u5B58\u5728\u7684\u7FA4\u53D1\u4EFB\u52A1\u7684 msgid"],[45066,"\u76F8\u540C clientmsgid \u91CD\u8BD5\u901F\u5EA6\u8FC7\u5FEB\uFF0C\u8BF7\u95F4\u96941\u5206\u949F\u91CD\u8BD5"],[45067,"clientmsgid \u957F\u5EA6\u8D85\u8FC7\u9650\u5236"],[45110,"\u4F5C\u8005\u5B57\u6570\u8D85\u51FA\u9650\u5236"],[46001,"\u4E0D\u5B58\u5728\u5A92\u4F53\u6570\u636E"],[46002,"\u4E0D\u5B58\u5728\u7684\u83DC\u5355\u7248\u672C"],[46003,"\u4E0D\u5B58\u5728\u7684\u83DC\u5355\u6570\u636E"],[46004,"\u4E0D\u5B58\u5728\u7684\u7528\u6237"],[47001,"\u89E3\u6790 JSON/XML \u5185\u5BB9\u9519\u8BEF"],[47003,"\u53C2\u6570\u503C\u4E0D\u7B26\u5408\u9650\u5236\u8981\u6C42\uFF0C\u8BE6\u60C5\u53EF\u53C2\u8003\u53C2\u6570\u503C\u5185\u5BB9\u9650\u5236\u8BF4\u660E"],[48001,"api \u529F\u80FD\u672A\u6388\u6743\uFF0C\u8BF7\u786E\u8BA4\u516C\u4F17\u53F7\u5DF2\u83B7\u5F97\u8BE5\u63A5\u53E3\uFF0C\u53EF\u4EE5\u5728\u516C\u4F17\u5E73\u53F0\u5B98\u7F51 - \u5F00\u53D1\u8005\u4E2D\u5FC3\u9875\u4E2D\u67E5\u770B\u63A5\u53E3\u6743\u9650"],[48002,"\u7C89\u4E1D\u62D2\u6536\u6D88\u606F\uFF08\u7C89\u4E1D\u5728\u516C\u4F17\u53F7\u9009\u9879\u4E2D\uFF0C\u5173\u95ED\u4E86 \u201C \u63A5\u6536\u6D88\u606F \u201D \uFF09"],[48004,"api \u63A5\u53E3\u88AB\u5C01\u7981\uFF0C\u8BF7\u767B\u5F55 mp.weixin.qq.com \u67E5\u770B\u8BE6\u60C5"],[48005,"api \u7981\u6B62\u5220\u9664\u88AB\u81EA\u52A8\u56DE\u590D\u548C\u81EA\u5B9A\u4E49\u83DC\u5355\u5F15\u7528\u7684\u7D20\u6750"],[48006,"api \u7981\u6B62\u6E05\u96F6\u8C03\u7528\u6B21\u6570\uFF0C\u56E0\u4E3A\u6E05\u96F6\u6B21\u6570\u8FBE\u5230\u4E0A\u9650"],[48008,"\u6CA1\u6709\u8BE5\u7C7B\u578B\u6D88\u606F\u7684\u53D1\u9001\u6743\u9650"],[48021,"\u81EA\u52A8\u4FDD\u5B58\u7684\u8349\u7A3F\u65E0\u6CD5\u9884\u89C8/\u53D1\u9001\uFF0C\u8BF7\u5148\u624B\u52A8\u4FDD\u5B58\u8349\u7A3F"],[50001,"\u7528\u6237\u672A\u6388\u6743\u8BE5 api"],[50002,"\u7528\u6237\u53D7\u9650\uFF0C\u53EF\u80FD\u662F\u8FDD\u89C4\u540E\u63A5\u53E3\u88AB\u5C01\u7981"],[50005,"\u7528\u6237\u672A\u5173\u6CE8\u516C\u4F17\u53F7"],[53500,"\u53D1\u5E03\u529F\u80FD\u88AB\u5C01\u7981"],[53501,"\u9891\u7E41\u8BF7\u6C42\u53D1\u5E03"],[53502,"Publish ID \u65E0\u6548"],[53600,"Article ID \u65E0\u6548"],[61451,"\u53C2\u6570\u9519\u8BEF (invalid parameter)"],[61452,"\u65E0\u6548\u5BA2\u670D\u8D26\u53F7 (invalid kf_account)"],[61453,"\u5BA2\u670D\u8D26\u53F7\u5DF2\u5B58\u5728 (kf_account exsited)"],[61454,"\u5BA2\u670D\u8D26\u53F7\u540D\u957F\u5EA6\u8D85\u8FC7\u9650\u5236 ( \u4EC5\u5141\u8BB8 10 \u4E2A\u82F1\u6587\u5B57\u7B26\uFF0C\u4E0D\u5305\u62EC @ \u53CA @ \u540E\u7684\u516C\u4F17\u53F7\u7684\u5FAE\u4FE1\u53F7 )(invalid   kf_acount length)"],[61455,"\u5BA2\u670D\u8D26\u53F7\u540D\u5305\u542B\u975E\u6CD5\u5B57\u7B26 ( \u4EC5\u5141\u8BB8\u82F1\u6587 + \u6570\u5B57 )(illegal character in     kf_account)"],[61456,"\u5BA2\u670D\u8D26\u53F7\u4E2A\u6570\u8D85\u8FC7\u9650\u5236 (10 \u4E2A\u5BA2\u670D\u8D26\u53F7 )(kf_account count exceeded)"],[61457,"\u65E0\u6548\u5934\u50CF\u6587\u4EF6\u7C7B\u578B (invalid   file type)"],[61450,"\u7CFB\u7EDF\u9519\u8BEF (system error)"],[61500,"\u65E5\u671F\u683C\u5F0F\u9519\u8BEF"],[63001,"\u90E8\u5206\u53C2\u6570\u4E3A\u7A7A"],[63002,"\u65E0\u6548\u7684\u7B7E\u540D"],[65301,"\u4E0D\u5B58\u5728\u6B64 menuid \u5BF9\u5E94\u7684\u4E2A\u6027\u5316\u83DC\u5355"],[65302,"\u6CA1\u6709\u76F8\u5E94\u7684\u7528\u6237"],[65303,"\u6CA1\u6709\u9ED8\u8BA4\u83DC\u5355\uFF0C\u4E0D\u80FD\u521B\u5EFA\u4E2A\u6027\u5316\u83DC\u5355"],[65304,"MatchRule \u4FE1\u606F\u4E3A\u7A7A"],[65305,"\u4E2A\u6027\u5316\u83DC\u5355\u6570\u91CF\u53D7\u9650"],[65306,"\u4E0D\u652F\u6301\u4E2A\u6027\u5316\u83DC\u5355\u7684\u8D26\u53F7"],[65307,"\u4E2A\u6027\u5316\u83DC\u5355\u4FE1\u606F\u4E3A\u7A7A"],[65308,"\u5305\u542B\u6CA1\u6709\u54CD\u5E94\u7C7B\u578B\u7684 button"],[65309,"\u4E2A\u6027\u5316\u83DC\u5355\u5F00\u5173\u5904\u4E8E\u5173\u95ED\u72B6\u6001"],[65310,"\u586B\u5199\u4E86\u7701\u4EFD\u6216\u57CE\u5E02\u4FE1\u606F\uFF0C\u56FD\u5BB6\u4FE1\u606F\u4E0D\u80FD\u4E3A\u7A7A"],[65311,"\u586B\u5199\u4E86\u57CE\u5E02\u4FE1\u606F\uFF0C\u7701\u4EFD\u4FE1\u606F\u4E0D\u80FD\u4E3A\u7A7A"],[65312,"\u4E0D\u5408\u6CD5\u7684\u56FD\u5BB6\u4FE1\u606F"],[65313,"\u4E0D\u5408\u6CD5\u7684\u7701\u4EFD\u4FE1\u606F"],[65314,"\u4E0D\u5408\u6CD5\u7684\u57CE\u5E02\u4FE1\u606F"],[65316,"\u8BE5\u516C\u4F17\u53F7\u7684\u83DC\u5355\u8BBE\u7F6E\u4E86\u8FC7\u591A\u7684\u57DF\u540D\u5916\u8DF3\uFF08\u6700\u591A\u8DF3\u8F6C\u5230 3 \u4E2A\u57DF\u540D\u7684\u94FE\u63A5\uFF09"],[65317,"\u4E0D\u5408\u6CD5\u7684 URL"],[87009,"\u65E0\u6548\u7684\u7B7E\u540D"],[89503,"\u6B64\u6B21\u8C03\u7528\u9700\u8981\u7BA1\u7406\u5458\u786E\u8BA4\uFF0C\u8BF7\u8010\u5FC3\u7B49\u5019"],[89506,"\u8BE5IP\u8C03\u7528\u6C42\u8BF7\u6C42\u5DF2\u88AB\u516C\u4F17\u53F7\u7BA1\u7406\u5458\u62D2\u7EDD\uFF0C\u8BF724\u5C0F\u65F6\u540E\u518D\u8BD5\uFF0C\u5EFA\u8BAE\u8C03\u7528\u524D\u4E0E\u7BA1\u7406\u5458\u6C9F\u901A\u786E\u8BA4"],[89507,"\u8BE5IP\u8C03\u7528\u6C42\u8BF7\u6C42\u5DF2\u88AB\u516C\u4F17\u53F7\u7BA1\u7406\u5458\u62D2\u7EDD\uFF0C\u8BF71\u5C0F\u65F6\u540E\u518D\u8BD5\uFF0C\u5EFA\u8BAE\u8C03\u7528\u524D\u4E0E\u7BA1\u7406\u5458\u6C9F\u901A\u786E\u8BA4"],[900100,"	POST \u6570\u636E\u53C2\u6570\u4E0D\u5408\u6CD5"],[900100,"	\u8FDC\u7AEF\u670D\u52A1\u4E0D\u53EF\u7528"],[900100,"	Ticket \u4E0D\u5408\u6CD5"],[900100,"	\u83B7\u53D6\u6447\u5468\u8FB9\u7528\u6237\u4FE1\u606F\u5931\u8D25"],[900100,"	\u83B7\u53D6\u5546\u6237\u4FE1\u606F\u5931\u8D25"],[900100,"	\u83B7\u53D6 OpenID \u5931\u8D25"],[900100,"	\u4E0A\u4F20\u6587\u4EF6\u7F3A\u5931"],[900100,"	\u4E0A\u4F20\u7D20\u6750\u7684\u6587\u4EF6\u7C7B\u578B\u4E0D\u5408\u6CD5"],[900100,"	\u4E0A\u4F20\u7D20\u6750\u7684\u6587\u4EF6\u5C3A\u5BF8\u4E0D\u5408\u6CD5"],[900101,"	\u4E0A\u4F20\u5931\u8D25"],[900102,"	\u8D26\u53F7\u4E0D\u5408\u6CD5"],[900102,"	\u5DF2\u6709\u8BBE\u5907\u6FC0\u6D3B\u7387\u4F4E\u4E8E 50% \uFF0C\u4E0D\u80FD\u65B0\u589E\u8BBE\u5907"],[900102,"	\u8BBE\u5907\u7533\u8BF7\u6570\u4E0D\u5408\u6CD5\uFF0C\u5FC5\u987B\u4E3A\u5927\u4E8E 0 \u7684\u6570\u5B57"],[900102,"	\u5DF2\u5B58\u5728\u5BA1\u6838\u4E2D\u7684\u8BBE\u5907 ID \u7533\u8BF7"],[900102,"	\u4E00\u6B21\u67E5\u8BE2\u8BBE\u5907 ID \u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7 50"],[900102,"	\u8BBE\u5907 ID \u4E0D\u5408\u6CD5"],[900102,"	\u9875\u9762 ID \u4E0D\u5408\u6CD5"],[900102,"	\u9875\u9762\u53C2\u6570\u4E0D\u5408\u6CD5"],[900102,"	\u4E00\u6B21\u5220\u9664\u9875\u9762 ID \u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7 10"],[900102,"	\u9875\u9762\u5DF2\u5E94\u7528\u5728\u8BBE\u5907\u4E2D\uFF0C\u8BF7\u5148\u89E3\u9664\u5E94\u7528\u5173\u7CFB\u518D\u5220\u9664"],[900103,"	\u4E00\u6B21\u67E5\u8BE2\u9875\u9762 ID \u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7 50"],[900103,"	\u65F6\u95F4\u533A\u95F4\u4E0D\u5408\u6CD5"],[900103,"	\u4FDD\u5B58\u8BBE\u5907\u4E0E\u9875\u9762\u7684\u7ED1\u5B9A\u5173\u7CFB\u53C2\u6570\u9519\u8BEF"],[900103,"	\u95E8\u5E97 ID \u4E0D\u5408\u6CD5"],[900103,"	\u8BBE\u5907\u5907\u6CE8\u4FE1\u606F\u8FC7\u957F"],[900103,"	\u8BBE\u5907\u7533\u8BF7\u53C2\u6570\u4E0D\u5408\u6CD5"],[900103,"	\u67E5\u8BE2\u8D77\u59CB\u503C begin \u4E0D\u5408\u6CD5"],[40114,"invalid index value"],[41039,"invalid content_source_url"],[45166,"invalid content"],[88e3,"without comment privilege"]])});function Wv(r){let e=/\b(?:\d{1,3}\.){3}\d{1,3}\b/g,t=/(?:::ffff:)?([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::(?:ffff:)?(?:\d{1,3}\.){3}\d{1,3}/g,n=r.match(e)||[],i=r.match(t)||[];return{ipv4:n,ipv6:i}}var X,Rt,tt,Un=j(()=>{X=require("obsidian");ku();Fe();Rt=class{constructor(e){this.baseUrl="https://api.weixin.qq.com/cgi-bin";this.plugin=e}static getInstance(e){return Rt.instance||(Rt.instance=new Rt(e)),Rt.instance}static resetInstance(){Rt.instance=null}async requestToken(){let e="https://wewrite.3thinking.cn/mp_token",t=this.plugin.getSelectedMPAccount();if(t===void 0)return new X.Notice($("wechat-api.select-an-wechat-mp-account-first")),null;let{appId:n,appSecret:i,doc_id:o}=t,a;o===void 0||!o?a={app_id:n,secret:i}:a={doc_id:o};try{let s=await(0,X.requestUrl)({method:"POST",url:e,headers:{"Content-Type":"application/json"},throw:!1,body:JSON.stringify(a)});if(s.status!==200)return new X.Notice(s.text,0),null;let{code:l,data:c}=s.json;if(l!==0){if(l==-2)return t.doc_id=void 0,this.plugin.saveSettings(),await this.requestToken();if(l==-10&&c.errcode===40164){let{ipv4:u}=Wv(c.errmsg);u[0]!==void 0&&u[0]&&new X.Notice($("wechat-api.add-ip-address-ipv4-0-to-wechat-mp-ip-wh",[u[0]]))}return null}return c.last_token===void 0?(new X.Notice($("wechat-api.failed-to-get-wechat-access-token"),0),null):(t.access_token=c.last_token,t.doc_id=c.doc_id,t.expires_in=c.expiretime,t.lastRefreshTime=new Date().getTime(),this.plugin.saveSettings(),c.last_token)}catch(s){return console.error("Get wechat access token error:",s),new X.Notice($("wechat-api.failed-to-get-wechat-access-token"),0),null}}getHeaders(){return{"Accept-Encoding":"gzip, deflate, br","Accept-Language":"zh-CN,zh;q=0.9,en;q=0.8"}}async getAccessToken(e,t){let i={url:`${this.baseUrl}/token?grant_type=client_credential&appid=${e}&secret=${t}`,method:"GET",headers:this.getHeaders()},o=await(0,X.requestUrl)(i),{access_token:a,errcode:s,expires_in:l}=o.json;return a===void 0?(new X.Notice(Ke(s),0),!1):{access_token:a,expires_in:l}}async getAccountBasicInfo(e){let t=e!=null?e:this.plugin.settings.selectedMPAccount;if(!t)return new X.Notice($("wechat-api.select-an-wechat-mp-account-first")),null;let n=await this.plugin.refreshAccessToken(t);if(!n)return null;let i=`${this.baseUrl}/account/getaccountbasicinfo?access_token=${n}`,o=await(0,X.requestUrl)({method:"GET",url:i,throw:!1}),{errcode:a}=o.json;return a!==void 0&&a!==0?(new X.Notice(Ke(a),0),null):o.json}async getBatchMaterial(e,t,n=0,i=10){let o=await this.plugin.refreshAccessToken(e);if(!o)return!1;let a="https://api.weixin.qq.com/cgi-bin/material/batchget_material?access_token="+o;return await(await(0,X.requestUrl)({method:"POST",url:a,throw:!1,body:JSON.stringify({type:t,offset:n,count:i})})).json}async sendArticleToDraftBox(e,t){let n=await this.plugin.refreshAccessToken(this.plugin.settings.selectedMPAccount);if(!n)return!1;let i="https://api.weixin.qq.com/cgi-bin/draft/add?access_token="+n,o={articles:[{title:e.title,content:t,digest:e.digest,thumb_media_id:e.thumb_media_id,...e.content_source_url&&{content_source_url:e.content_source_url},...e.need_open_comment!==void 0&&{need_open_comment:e.need_open_comment},...e.only_fans_can_comment!==void 0&&{only_fans_can_comment:e.only_fans_can_comment},...e.pic_crop_235_1&&{pic_crop_235_1:e.pic_crop_235_1},...e.pic_crop_1_1&&{pic_crop_1_1:e.pic_crop_1_1},...e.author&&{author:e.author}}]},a=await(0,X.requestUrl)({method:"POST",url:i,throw:!1,body:JSON.stringify(o)}),{errcode:s,media_id:l}=a.json;return s!==void 0&&s!==0?(new X.Notice(Ke(s),0),!1):(new X.Notice($("wechat-api.send-article-to-draft-box-successfully")),l)}async uploadXMaterial(e,t,n){if(n==="video"){if(e.size>1024*1024*10)return new X.Notice($("wechat-api.video-size-exceeds-10m")),!1}else if(n==="voice"){if(e.size>1024*1024*2)return new X.Notice($("wechat-api.voice-size-exceeds-2m")),!1}else if(e.size>1024*1024*10)return new X.Notice($("wechat-api.image-size-exceeds-10m")),!1;let i=await this.plugin.refreshAccessToken(this.plugin.settings.selectedMPAccount);if(!i)return!1;let o=`https://api.weixin.qq.com/cgi-bin/media/uploadimg?access_token=${i}`;n===void 0&&e.size>=1024*1024&&(n="image"),n!==void 0&&(o=`https://api.weixin.qq.com/cgi-bin/material/add_material?access_token=${i}&type=${n}`);let a=16,s="one2mpBoundary"+Array(a+1).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,a),l=[],c=JSON.stringify({title:"title of video",content:"content of video"});l.push(`--${s}\r
Content-Disposition: form-data; name="media"; filename="${t}"\r
Content-Type: "application/octet-stream"\r
\r
`);let u=await(0,X.getBlobArrayBuffer)(e);l.push(u),l.push(`\r
`),n==="video"&&l.push(`--${s}\r
Content-Disposition: form-data; name="description"\r
Content-Type: application/json\r
\r
`+c+`\r
`),l.push(`--${s}--\r
`);let d=new TextEncoder,f=l.map(y=>typeof y=="string"?d.encode(y):y),m=await new Blob(f).arrayBuffer(),b={method:"POST",url:o,contentType:`multipart/form-data; boundary=${s}`,body:m},S=await(await(0,X.requestUrl)(b)).json;return(S.errcode===void 0||S.errcode==0)&&this.plugin.messageService.sendMessage(n+"-item-updated",S),{url:S.url||"",media_id:S.media_id||"",errcode:S.errcode||0,errmsg:S.errmsg||""}}async uploadMaterial(e,t,n){if(n==="video"){if(e.size>1024*1024*10)return new X.Notice($("wechat-api.video-size-exceeds-10m")),!1}else if(n==="voice"){if(e.size>1024*1024*2)return new X.Notice($("wechat-api.voice-size-exceeds-2m")),!1}else if(e.size>1024*1024*10)return new X.Notice($("wechat-api.image-size-exceeds-10m")),!1;let i=await this.plugin.refreshAccessToken(this.plugin.settings.selectedMPAccount);if(!i)return!1;let o=`https://api.weixin.qq.com/cgi-bin/media/uploadimg?access_token=${i}`;n===void 0&&e.size>=1024*1024&&(n="image"),n!==void 0&&(o=`https://api.weixin.qq.com/cgi-bin/material/add_material?access_token=${i}&type=${n}`);let a={title:"title of video",introduction:"content of video"},s=await(0,X.getBlobArrayBuffer)(e),l=t,c="----WebKitFormBoundary"+Math.random().toString(36).substring(2),u=[];u.push(`--${c}\r
Content-Disposition: form-data; name="media"; filename="${l}"\r
Content-Type: application/octet-stream\r
\r
`),u.push(new Uint8Array(s)),u.push(`\r
`),n==="video"&&a&&u.push(`--${c}\r
Content-Disposition: form-data; name="description"\r
Content-Type: application/json\r
\r
`+JSON.stringify(a)+`\r
`),u.push(`--${c}--\r
`);let d=new TextEncoder,f=u.map(m=>typeof m=="string"?d.encode(m):m).reduce((m,b)=>{let E=new Uint8Array(m.length+b.length);return E.set(m),E.set(b,m.length),E},new Uint8Array(0));try{this.plugin.showSpinner($("wechat-api.uploading-material-type",[n||"unknown"]));let m=await(0,X.requestUrl)({url:o,method:"POST",headers:{"Content-Type":`multipart/form-data; boundary=${c}`},body:f.buffer});this.plugin.hideSpinner();let b=await m.json;return b.errcode!==void 0&&b.errcode!==0?(console.error("\u4E0A\u4F20\u7D20\u6750\u5931\u8D25:",b),new X.Notice(Ke(b.errcode)||b.errmsg||"\u4E0A\u4F20\u7D20\u6750\u5931\u8D25",0),null):(this.plugin.messageService.sendMessage(n+"-item-updated",b),{url:b.url||"",media_id:b.media_id||"",errcode:b.errcode||0,errmsg:b.errmsg||""})}catch(m){throw this.plugin.hideSpinner(),console.error("\u4E0A\u4F20\u7D20\u6750\u65F6\u51FA\u9519:",m),m}}async getMaterialList(e,t,n=0,i=20){let o=await this.plugin.refreshAccessToken(e);if(!o)return!1;let a=`${this.baseUrl}/material/batchget_material?access_token=${o}`,s={type:t,offset:n,count:i},l={url:a,method:"POST",headers:this.getHeaders(),body:JSON.stringify(s)};return(await(0,X.requestUrl)(l)).json}async getMaterialById(e,t){if(!e)return!1;t===void 0&&(t=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(t);if(!n)return!1;let i=`${this.baseUrl}/material/get_material?access_token=${n}`,o={media_id:e},a={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(o)};return(await(0,X.requestUrl)(a)).json}async getBatchDraftList(e,t=0,n=20){let i=await this.plugin.refreshAccessToken(e);if(!i)return!1;let o=`${this.baseUrl}/draft/batchget?access_token=${i}`,a={offset:t,count:n,no_content:!1},s={url:o,method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)};return(await(0,X.requestUrl)(s)).json}async getMaterialCounts(e){let t=await this.plugin.refreshAccessToken(e);if(!t)return!1;let i={url:`${this.baseUrl}/material/get_materialcount?access_token=${t}`,method:"GET",headers:this.getHeaders()},o=await(0,X.requestUrl)(i),{errcode:a}=o.json;return a!==void 0&&a!==0?(new X.Notice(Ke(a),0),!1):o.json}async getDraftCount(e){let t=await this.plugin.refreshAccessToken(e);if(!t)return!1;let i={url:`${this.baseUrl}/draft/count?access_token=${t}`,method:"GET",headers:this.getHeaders()},o=await(0,X.requestUrl)(i),{errcode:a,total_count:s}=o.json;return a!==void 0&&a!==0?(new X.Notice(Ke(a),0),!1):s}async getDraftById(e,t){let n=await this.plugin.refreshAccessToken(e);if(!n)return!1;let i=`${this.baseUrl}/draft/get?access_token=${n}`,o={media_id:t},a={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(o)},s=await(0,X.requestUrl)(a),{errcode:l,news_item:c}=s.json;return l!==void 0&&l!==0?(new X.Notice(Ke(l),0),!1):c}async publishDraft(e,t=""){t||(t=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(t);if(!n)return!1;let i=`${this.baseUrl}/freepublish/submit?access_token=${n}`,o={media_id:e},a={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(o)},s=await(0,X.requestUrl)(a),{errcode:l,publish_id:c}=s.json;return l!==void 0&&l!==0?(new X.Notice(Ke(l),0),!1):c}async deleteMedia(e,t=""){t||(t=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(t);if(!n)return!1;let i=`${this.baseUrl}/material/del_material?access_token=${n}`,o={media_id:e},a={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(o)},s=await(0,X.requestUrl)(a),{errcode:l}=s.json;return l!==void 0&&l!==0?(new X.Notice(Ke(l),0),!1):!0}async deleteDraft(e,t=""){t||(t=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(t);if(!n)return!1;let i=`${this.baseUrl}/draft/delete?access_token=${n}`,o={media_id:e},a={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(o)},s=await(0,X.requestUrl)(a),{errcode:l}=s.json;return l!==void 0&&l!==0?(new X.Notice(Ke(l),0),!1):!0}async massSendAll(e,t=""){t||(t=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(t);if(!n)return!1;let i=`${this.baseUrl}/message/mass/sendall?access_token=${n}`,o={filter:{is_to_all:!0},mpnews:{media_id:e},msgtype:"mpnews"},a={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(o)},s=await(0,X.requestUrl)(a),{errcode:l}=s.json;return l!==void 0&&l!==0?(new X.Notice(Ke(l),0),!1):!0}async senfForPreview(e,t="",n=""){n||(n=this.plugin.settings.selectedMPAccount),t||(t=this.plugin.settings.previewer_wxname);let i=await this.plugin.refreshAccessToken(n);if(!i)return!1;let o=`${this.baseUrl}/message/mass/preview?access_token=${i}`,a={towxname:t,mpnews:{media_id:e},msgtype:"mpnews"},s={url:o,method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)},l=await(0,X.requestUrl)(s),{errcode:c}=l.json;return c!==void 0&&c!==0?(new X.Notice(Ke(c),0),!1):!0}},tt=Rt;tt.instance=null});var Su=Si((ta,na)=>{(function(r){"use strict";let e=R(),t=B(),n=F(),i=K(),o={copyDefaultStyles:!0,imagePlaceholder:void 0,cacheBust:!1,useCredentials:!1,httpTimeout:3e4,styleCaching:"strict",corsImg:void 0},a={toSvg:d,toPng:m,toJpeg:b,toBlob:E,toPixelData:f,toCanvas:S,impl:{fontFaces:n,images:i,util:e,inliner:t,urlCache:[],options:{}}};typeof ta=="object"&&typeof na=="object"?na.exports=a:r.domtoimage=a;let s=(typeof Node=="undefined"?void 0:Node.ELEMENT_NODE)||1,l=(r===void 0?void 0:r.getComputedStyle)||(typeof window=="undefined"?void 0:window.getComputedStyle)||globalThis.getComputedStyle,c=(r===void 0?void 0:r.atob)||(typeof window=="undefined"?void 0:window.atob)||globalThis.atob;function u(_){return _===""||_==="none"}function d(_,C){let A=a.impl.util.getWindow(_);C||(C={}),y(C);let M=[];return Promise.resolve(_).then(q).then(O=>p(O,C,null,A)).then(w).then(k).then(P).then(D).then(I).then(T);function q(O){if(O.nodeType===s)return O;let L=O,J=O.parentNode,U=document.createElement("span");return L.replaceWith(U),U.append(O),M.push({parent:J,child:L,wrapper:U}),U}function I(O){for(;M.length>0;){let L=M.pop();L.parent.replaceChild(L.child,L.wrapper)}return O}function T(O){return a.impl.urlCache=[],x(),O}function P(O){if(C.bgcolor&&(O.style.backgroundColor=C.bgcolor),C.width&&(O.style.width=`${C.width}px`),C.height&&(O.style.height=`${C.height}px`),C.style)for(let J of Object.keys(C.style))O.style[J]=C.style[J];let L=null;return typeof C.onclone=="function"&&(L=C.onclone(O)),Promise.resolve(L).then(()=>O)}function D(O){let L=C.width||e.width(O),J=C.height||e.height(O);return Promise.resolve(O).then(U=>(U.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(U))).then(e.escapeXhtml).then(U=>{let ee=(e.isDimensionMissing(L)?' width="100%"':` width="${L}"`)+(e.isDimensionMissing(J)?' height="100%"':` height="${J}"`);return`<svg xmlns="http://www.w3.org/2000/svg"${(e.isDimensionMissing(L)?"":` width="${L}"`)+(e.isDimensionMissing(J)?"":` height="${J}"`)}><foreignObject${ee}>${U}</foreignObject></svg>`}).then(U=>`data:image/svg+xml;charset=utf-8,${U}`)}}function f(_,C){return g(_,C).then(A=>A.getContext("2d").getImageData(0,0,e.width(_),e.height(_)).data)}function m(_,C={}){return g(_,C).then(A=>A.toDataURL())}function b(_,C){return g(_,C).then(A=>A.toDataURL("image/jpeg",(C?C.quality:void 0)||1))}function E(_,C){return g(_,C).then(e.canvasToBlob)}function S(_,C){return g(_,C)}function y(_){_.copyDefaultStyles===void 0?a.impl.options.copyDefaultStyles=o.copyDefaultStyles:a.impl.options.copyDefaultStyles=_.copyDefaultStyles,_.imagePlaceholder===void 0?a.impl.options.imagePlaceholder=o.imagePlaceholder:a.impl.options.imagePlaceholder=_.imagePlaceholder,a.impl.options.cacheBust=_.cacheBust===void 0?o.cacheBust:_.cacheBust,a.impl.options.corsImg=_.corsImg===void 0?o.corsImg:_.corsImg,a.impl.options.useCredentials=_.useCredentials===void 0?o.useCredentials:_.useCredentials,a.impl.options.httpTimeout=_.httpTimeout===void 0?o.httpTimeout:_.httpTimeout,a.impl.options.styleCaching=_.styleCaching===void 0?o.styleCaching:_.styleCaching,a.impl.options.requestUrl=_.requestUrl,a.impl.options.type=_.type||"image/png",a.impl.options.quality=_.quality||1}function g(_,C){return C||(C={}),d(_,C).then(e.makeImage).then(M=>{let q=typeof C.scale=="number"?C.scale:1,I=A(_,q),T=I.getContext("2d");return T.msImageSmoothingEnabled=!1,T.imageSmoothingEnabled=!1,M&&(T.scale(q,q),T.drawImage(M,0,0)),I});function A(M,q){let I=C.width||e.width(M),T=C.height||e.height(M);e.isDimensionMissing(I)&&(I=e.isDimensionMissing(T)?300:T*2),e.isDimensionMissing(T)&&(T=I/2);let P=document.createElement("canvas");if(P.width=I*q,P.height=T*q,C.bgcolor){let D=P.getContext("2d");D.fillStyle=C.bgcolor,D.fillRect(0,0,P.width,P.height)}return P}}let h=null;function p(_,C,A,M){let q=C.filter;if(_===h||e.isHTMLScriptElement(_)||e.isHTMLStyleElement(_)||e.isHTMLLinkElement(_)||A!==null&&q&&!q(_))return Promise.resolve();return Promise.resolve(_).then(I).then(O=>P(O,T(_))).then(O=>D(O,_));function I(O){return e.isHTMLCanvasElement(O)?e.makeImage(O.toDataURL()):O.cloneNode(!1)}function T(O){return e.isElementHostForOpenShadowRoot(O)?O.shadowRoot:O}function P(O,L){let J=le(L),U=Promise.resolve();if(J.length>0){let ce=l(ee(L));for(let W of e.asArray(J))U=U.then(()=>p(W,C,ce,M).then(z=>{z&&O.append(z)}))}return U.then(()=>O);function ee(ce){return e.isShadowRoot(ce)?ce.host:ce}function le(ce){return e.isShadowSlotElement(ce)?ce.assignedNodes():ce.childNodes}}function D(O,L){if(!e.isElement(O)||e.isShadowSlotElement(L))return Promise.resolve(O);return Promise.resolve().then(J).then(U).then(ee).then(le).then(()=>O);function J(){W(L,O);function ce(z,H){H.font=z.font,H.fontFamily=z.fontFamily,H.fontFeatureSettings=z.fontFeatureSettings,H.fontKerning=z.fontKerning,H.fontSize=z.fontSize,H.fontStretch=z.fontStretch,H.fontStyle=z.fontStyle,H.fontVariant=z.fontVariant,H.fontVariantCaps=z.fontVariantCaps,H.fontVariantEastAsian=z.fontVariantEastAsian,H.fontVariantLigatures=z.fontVariantLigatures,H.fontVariantNumeric=z.fontVariantNumeric,H.fontVariationSettings=z.fontVariationSettings,H.fontWeight=z.fontWeight}function W(z,H){let fe=l(z);if(fe.cssText)H.style.cssText=fe.cssText,ce(fe,H.style);else{if(Q(C,z,fe,A,H),A===null){for(let je of["inset-block","inset-block-start","inset-block-end"])H.style.removeProperty(je);for(let je of["left","right","top","bottom"])H.style.getPropertyValue(je)&&V(H.style,je,"0px")}let he="-webkit-background-clip",oe=fe.getPropertyValue(he);oe&&oe!=="border-box"&&V(H.style,he,oe)}}}function U(){}function ee(){e.isHTMLTextAreaElement(L)&&(O.value=L.value,O.textContent=L.value),e.isHTMLInputElement(L)&&O.setAttribute("value",L.value)}function le(){if(e.isSVGElement(O)&&(O.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.isSVGRectElement(O)))for(let ce of["width","height"]){let W=O.getAttribute(ce);W&&(O.style[ce]=W)}}}}function w(_){return Promise.resolve(_)}function k(_){return i.inlineAll(_).then(()=>_)}function R(){let _=0;return{escape:qd,isDataUrl:z,canvasToBlob:he,resolveUrl:oe,getAndEncode:Bd,uid:je,delay:Nd,asArray:jd,escapeXhtml:zd,makeImage:Ve,width:Hd,height:Ud,getWindow:C,isElement:I,isElementHostForOpenShadowRoot:A,isShadowRoot:M,isInShadowRoot:q,isHTMLElement:P,isHTMLCanvasElement:T,isHTMLInputElement:O,isHTMLImageElement:D,isHTMLLinkElement:L,isHTMLScriptElement:J,isHTMLStyleElement:U,isHTMLTextAreaElement:ee,isShadowSlotElement:le,isSVGElement:ce,isSVGRectElement:W,isDimensionMissing:H};function C(N){let de=N?N.ownerDocument:void 0;return(de?de.defaultView:void 0)||r||window}function A(N){return I(N)&&N.shadowRoot!==null}function M(N){return N instanceof C(N).ShadowRoot}function q(N){return N!==null&&Object.hasOwn(N,"getRootNode")&&M(N.getRootNode())}function I(N){return N instanceof C(N).Element}function T(N){return N instanceof C(N).HTMLCanvasElement}function P(N){return N instanceof C(N).HTMLElement}function D(N){return N instanceof C(N).HTMLImageElement}function O(N){return N instanceof C(N).HTMLInputElement}function L(N){return N instanceof C(N).HTMLLinkElement}function J(N){return N instanceof C(N).HTMLScriptElement}function U(N){return N instanceof C(N).HTMLStyleElement}function ee(N){return N instanceof C(N).HTMLTextAreaElement}function le(N){return q(N)&&N instanceof C(N).HTMLSlotElement}function ce(N){return N instanceof C(N).SVGElement}function W(N){return N instanceof C(N).SVGRectElement}function z(N){return N.search(/^(data:)/)!==-1}function H(N){return isNaN(N)||N<=0}function fe(N){return new Promise(de=>{let ue=c(N.toDataURL().split(",")[1]),pe=ue.length,we=new Uint8Array(pe);for(let Qe=0;Qe<pe;Qe++)we[Qe]=ue.charCodeAt(Qe);de(new Blob([we],{type:a.impl.options.type}))})}function he(N){return N.toBlob?new Promise(de=>{N.toBlob(de,a.impl.options.type,a.impl.options.quality)}):fe(N)}function oe(N,de){let ue=document.implementation.createHTMLDocument(),pe=ue.createElement("base");ue.head.append(pe);let we=ue.createElement("a");return ue.body.append(we),pe.href=de,we.href=N,we.href}function je(){return`u${N()}${_++}`;function N(){return`0000${Math.trunc(Math.random()*36**4).toString(36)}`.slice(-4)}}function Ve(N){return N==="data:,"?Promise.resolve():new Promise((de,ue)=>{let pe=new Image;a.impl.options.useCredentials&&(pe.crossOrigin="use-credentials"),pe.addEventListener("load",()=>{window&&window.requestAnimationFrame?window.requestAnimationFrame(()=>{de(pe)}):de(pe)}),pe.onerror=ue,pe.src=N})}function Bd(N){let de=a.impl.urlCache.find(ue=>ue.url===N);return de||(de={url:N,promise:null},a.impl.urlCache.push(de)),de.promise===null&&(a.impl.options.cacheBust&&(N+=(/\?/.test(N)?"&":"?")+Date.now()),a.impl.options.requestUrl&&N.startsWith("http")&&!N.startsWith("http://localhost/")?de.promise=a.impl.options.requestUrl({url:N,method:"GET"}).then(ue=>new Promise(pe=>{let we=new FileReader;we.addEventListener("load",Qe=>{pe(Qe.target.result)}),we.readAsDataURL(new Blob([ue.arrayBuffer],{type:ue.headers["content-type"]}))})).catch(ue=>(console.error("cannot fetch resource: "+N+", error: "+ue),"")):de.promise=new Promise(ue=>{let pe=a.impl.options.httpTimeout,we=new XMLHttpRequest;if(we.addEventListener("readystatechange",Vd),we.ontimeout=Wd,we.responseType="blob",we.timeout=pe,a.impl.options.useCredentials&&(we.withCredentials=!0),a.impl.options.corsImg&&N.indexOf("http")===0&&!N.includes(window.location.origin)){let We=(a.impl.options.corsImg.method||"GET").toUpperCase()==="POST"?"POST":"GET";we.open(We,(a.impl.options.corsImg.url||"").replace("#{cors}",N),!0);let _i=!1,ki=a.impl.options.corsImg.headers||{};for(let St of Object.keys(ki))ki[St].includes("application/json")&&(_i=!0),we.setRequestHeader(St,ki[St]);let Ht=Kd(a.impl.options.corsImg.data||"");for(let St of Object.keys(Ht))typeof Ht[St]=="string"&&(Ht[St]=Ht[St].replace("#{cors}",N));we.send(_i?JSON.stringify(Ht):Ht)}else we.open("GET",N,!0),we.send();let Qe;if(a.impl.options.imagePlaceholder){let We=a.impl.options.imagePlaceholder.split(/,/);We&&We[1]&&(Qe=We[1])}function Vd(){if(we.readyState!==4)return;if(we.status>=300){Qe?ue(Qe):xi(`cannot fetch resource: ${N}, status: ${we.status}`);return}let We=new FileReader;We.onloadend=function(){ue(We.result)},We.readAsDataURL(we.response)}function Wd(){Qe?ue(Qe):xi(`timeout of ${pe}ms occured while fetching resource: ${N}`)}function Kd(We){try{return JSON.parse(JSON.stringify(We))}catch(_i){xi("corsImg.data is missing or invalid")}}function xi(We){console.error(We),ue("")}})),de.promise}function qd(N){return N.replaceAll(/([.*+?^${}()|[\]\/\\])/g,"\\$1")}function Nd(N){return function(de){return new Promise(ue=>{setTimeout(()=>{ue(de)},N)})}}function jd(N){let de=[],ue=N.length;for(let pe=0;pe<ue;pe++)de.push(N[pe]);return de}function zd(N){let de=N.replaceAll("%","%25").replaceAll("#","%23").replaceAll(`
`,"%0A"),ue="";for(let pe=0;pe<de.length;pe++){let we=de.charCodeAt(pe);we<=31||we===127||(ue+=de[pe])}return ue}function Hd(N){let de=zt(N,"width");if(!isNaN(de))return de;let ue=zt(N,"border-left-width"),pe=zt(N,"border-right-width");return N.scrollWidth+ue+pe}function Ud(N){let de=zt(N,"height");if(!isNaN(de))return de;let ue=zt(N,"border-top-width"),pe=zt(N,"border-bottom-width");return N.scrollHeight+ue+pe}function zt(N,de){if(N.nodeType===s){let ue=l(N).getPropertyValue(de);if(ue.slice(-2)==="px")return ue=ue.slice(0,-2),Number.parseFloat(ue)}return Number.NaN}}function B(){let _=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:q,shouldProcess:C,impl:{readUrls:A,inline:M}};function C(I){return I.search(_)!==-1}function A(I){let T=[],P;for(;(P=_.exec(I))!==null;)T.push(P[1]);return T.filter(D=>!e.isDataUrl(D))}function M(I,T,P,D){return Promise.resolve(T).then(L=>P?e.resolveUrl(L,P):L).then(D||e.getAndEncode).then(L=>I.replace(O(T),`$1${L}$3`));function O(L){return new RegExp(`(url\\(['"]?)(${e.escape(L)})(['"]?\\))`,"g")}}function q(I,T,P){if(D())return Promise.resolve(I);return Promise.resolve(I).then(A).then(O=>{let L=Promise.resolve(I);for(let J of O)L=L.then(U=>M(U,J,T,P));return L});function D(){return!C(I)}}}function F(){return{resolveAll:_,impl:{readAll:C}};function _(){return C().then(A=>Promise.all(A.map(M=>M.resolve()))).then(A=>A.join(`
`))}function C(){return Promise.resolve(e.asArray(document.styleSheets)).then(M).then(A).then(I=>I.map(q));function A(I){return I.filter(T=>T.type===CSSRule.FONT_FACE_RULE).filter(T=>t.shouldProcess(T.style.getPropertyValue("src")))}function M(I){let T=[];for(let P of I)if(Object.hasOwn(Object.getPrototypeOf(P),"cssRules"))try{e.asArray(P.cssRules||[]).forEach(T.push.bind(T))}catch(D){console.error(`domtoimage: Error while reading CSS rules from ${P.href}`,D.toString())}return T}function q(I){return{resolve:function(){let P=(I.parentStyleSheet||{}).href;return t.inlineAll(I.cssText,P)},src(){return I.style.getPropertyValue("src")}}}}}function K(){return{inlineAll:C,impl:{newImage:_}};function _(A){return{inline:M};function M(q){return e.isDataUrl(A.src)?Promise.resolve():Promise.resolve(A.src).then(q||e.getAndEncode).then(I=>new Promise(T=>{A.addEventListener("load",T),A.onerror=T,A.src=I}))}}function C(A){if(!e.isElement(A))return Promise.resolve(A);return M(A).then(()=>e.isHTMLImageElement(A)?_(A).inline():Promise.all(e.asArray(A.childNodes).map(q=>C(q))));function M(q){let T=["background","background-image"].map(P=>{let D=q.style.getPropertyValue(P),O=q.style.getPropertyPriority(P);return D?t.inlineAll(D).then(L=>{V(q.style,P,L,O)}):Promise.resolve()});return Promise.all(T).then(()=>q)}}}function V(_,C,A,M){let q=["background-clip"].includes(C),I=M?" !important":"";Y(_,C,A,I),q&&Y(_,`-webkit-${C}`,A,I)}function Y(_,C,A,M){if(!C)return;let q=_.cssText&&!_.cssText.trim().endsWith(";")?"; ":"";_.cssText+=`${q}${C}: ${A}${M};`}function Q(_,C,A,M,q){let I=a.impl.options.copyDefaultStyles?se(_,C):{},T=q.style;for(let D of P(e.asArray(A))){let O=A.getPropertyValue(D),L=I[D],J=M?M.getPropertyValue(D):void 0;if(O!==L||M&&O!==J||/border/.test(D)){let U=A.getPropertyPriority(D);V(T,D,O,U)}}function P(D){for(let O of["counter-reset","counter-increment","counter-set"])D.indexOf(O)<0&&!u(A.getPropertyValue(O))&&D.push(O);return D}}let G=null,Z={},te=new Set(["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","DETAILS","DIALOG","DD","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","LI","MAIN","NAV","OL","P","PRE","SECTION","SVG","TABLE","UL","math","svg","BODY","HEAD","HTML"]);function se(_,C){let A=P(C),M=D(A);if(Z[M])return Z[M];let q=v(),I=O(q.document,A),T=L(q,I);return J(I),Z[M]=T,T;function P(U){let ee=[];do{if(U.nodeType===s){let le=U.tagName;if(ee.push(le),te.has(le))break}U=U.parentNode}while(U);return ee}function D(U){return _.styleCaching==="relaxed"?U.filter((ee,le,ce)=>le===0||le===ce.length-1).join(">"):U.join(">")}function O(U,ee){let le=U.body;do{let ce=ee.pop(),W=U.createElement(ce);le.append(W),le=W}while(ee.length>0);return le.textContent="\u200B",le}function L(U,ee){let le={},ce=U.getComputedStyle(ee);for(let W of e.asArray(ce))le[W]=W==="width"||W==="height"?"auto":ce.getPropertyValue(W);return le}function J(U){do{let ee=U.parentElement;ee!==null&&U.remove(),U=ee}while(U&&U.tagName!=="BODY")}}function v(){if(h)return h.contentWindow;let _=document.characterSet||"UTF-8",C=document.doctype,A=C?`<!DOCTYPE ${M(C.name)} ${M(C.publicId)} ${M(C.systemId)}`.trim()+">":"";return h=document.createElement("iframe"),h.id="domtoimage-sandbox-"+e.uid(),h.classList.add("one2mp-domtoimage-sandbox"),document.body.append(h),q(h,A,_,"domtoimage-sandbox");function M(I){return I?I.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;"):""}function q(I,T,P,D){let O=document.createElement("meta");O.setAttribute("charset",P);try{let L=document.implementation.createHTMLDocument(D);L.head.append(O);let J=new XMLSerializer,U=T+J.serializeToString(L.documentElement);return I.setAttribute("srcdoc",U),I.contentWindow}catch(L){}return I.contentDocument.head.append(O),I.contentDocument.title=D,I.contentWindow}}function x(){h&&(h.remove(),h=null),G&&clearTimeout(G),G=setTimeout(()=>{G=null,Z={}},20*1e3)}})(ta)});var Yr,Cu,Ae,Vn=j(()=>{Yr=require("obsidian"),Cu=Ut(Su()),Ae=class{constructor(e){this.app=e;this.rendering=!1;this.app=e}static getInstance(e){return Ae.instance||(Ae.instance=new Ae(e)),Ae.instance}async render(e,t,n){if(e===void 0||!e||!e.toLowerCase().endsWith(".md")||!t||!n)return;this.container=t,this.container.addClass("one2mp-markdown-render-container"),this.view=n,this.container.empty(),this.container.show(),this.rendering=!0,this.mdv&&this.mdv.unload(),this.previewEl=createDiv(),this.markdownBody=this.previewEl.createDiv(),this.mdv=new Yr.MarkdownRenderChild(this.markdownBody),this.view.addChild(this.mdv),this.container.appendChild(this.previewEl);let i=await this.app.vault.adapter.read(e);await Yr.MarkdownRenderer.render(this.app,i,this.markdownBody,e,this.mdv);try{let o=[];/^\s*>+\s*\[!/m.test(i)&&o.push(this.waitForSelector(this.previewEl,".callout",1e3)),/```\s*mermaid/i.test(i)&&o.push(this.waitForSelector(this.previewEl,".mermaid svg",5e3)),o.length&&await Promise.all(o)}catch(o){console.warn("\u90E8\u5206\u63D2\u4EF6\u6E32\u67D3\u8D85\u65F6\uFF08\u975E\u81F4\u547D\uFF09",o)}this.rendering=!1}queryElement(e,t){if(this.previewEl===void 0||!this.previewEl||this.rendering||this.previewEl===void 0||!this.previewEl)return null;let n=this.previewEl.querySelectorAll(t);return e<0||e>=n.length?null:n[e]}async domToImage(e,t={}){return await Cu.default.toPng(e,t)}waitForSelector(e,t,n=1e3){return new Promise(i=>{if(e.querySelector(t))return i();let o=new MutationObserver(()=>{e.querySelector(t)&&(o.disconnect(),i())});o.observe(e,{childList:!0,subtree:!0}),setTimeout(()=>{o.disconnect(),i()},n)})}}});function Xr(r,e){let t="";return r&&r.includes("/")&&(t=r.split("/")[1]||""),t||(t=e||"png"),`image-${new Date().getTime()}.${t}`}function Kv(r){if(!r)return;let t=r.split("?")[0].split("#")[0].match(/\.([a-zA-Z0-9]+)$/);return t?t[1].toLowerCase():void 0}function ei(r,e){e.forEach(t=>{t.status==="rejected"&&console.error(`${r}\u4E0A\u4F20\u5931\u8D25:`,t.reason)})}function Gv(r){return new Promise((e,t)=>{let n=new Image;n.onload=()=>{let s=document.createElement("canvas"),l=window.devicePixelRatio||1;s.width=n.width*l,s.height=n.height*l;let c=s.getContext("2d");if(!c){t(new Error($("render.faild-canvas-context")));return}c.drawImage(n,0,0),s.toBlob(u=>{u?e(u):t(new Error($("render.failed-to-convert-canvas-to-blob")))},"image/png")},n.onerror=s=>{let l=s instanceof Error?s.message:typeof s=="string"?s:JSON.stringify(s);t(new Error(l))};let o=new TextEncoder().encode(r),a=String.fromCharCode.apply(null,o);n.src=`data:image/svg+xml;base64,${btoa(a)}`})}function ra(r){let e=r.split(";base64,");console.debug("parts:",e);let t=e[0].split(":")[1];console.debug("contentType",t);let n=window.atob(e[1]);console.debug("raw:",n);let i=n.length,o=new Uint8Array(i);for(let a=0;a<i;++a)o[a]=n.charCodeAt(a);return console.debug("uInt8Array byteLength:",o.byteLength),new Blob([o],{type:t})}function Jv(r){let e=r.toDataURL("image/png");return ra(e)}async function Eu(r,e){let t=[];r.querySelectorAll("svg").forEach(o=>{t.push(o)});let n=t.map(async o=>{let a=o.outerHTML;a.length<1e4||await Gv(a).then(async s=>{let l=await e.uploadMaterial(s,Xr(s.type,"png"));if(l&&l.url){let c=document.createElement("img");c.src=l.url,o.replaceWith(c)}else console.error("upload svg failed.")})}),i=await Promise.allSettled(n);ei("SVG",i)}async function Tu(r,e){let t=[];r.querySelectorAll("canvas").forEach(o=>{t.push(o)});let n=t.map(async o=>{let a=Jv(o),s=await e.uploadMaterial(a,Xr(a.type,"png"));if(s&&s.url){let l=document.createElement("img");l.src=s.url,o.replaceWith(l)}else console.error("upload canvas failed.")}),i=await Promise.allSettled(n);ei("Canvas",i)}async function Au(r,e,t){let n=[];r.querySelectorAll("img").forEach(a=>{n.push(a)});let i=n.map(async a=>{let s,l=Kv(a.src);if(!a.src.includes("://mmbiz.qpic.cn/")){if(a.src.startsWith("data:image/"))s=ra(a.src);else try{s=await Cn(a.src,t)}catch(c){console.error(`Error fetching image from ${a.src}:`,c);return}s!==void 0&&await e.uploadMaterial(s,Xr(s.type,l)).then(c=>{c&&c.url?a.src=c.url:console.error("upload image failed.")})}}),o=await Promise.allSettled(i);ei("\u56FE\u7247",o)}function Pu(r,e){var a;let t=r.classList.contains("one2mp")?r:(a=r.querySelector(".one2mp"))!=null?a:r,n=t.querySelector("p"),i=e||n&&window.getComputedStyle(n).color||window.getComputedStyle(t).color||"#333333",o=s=>{s.setCssProps({color:i,opacity:"1",filter:"none"})};r.querySelectorAll(".one2mp-callout .callout-text").forEach(o),r.querySelectorAll(".one2mp-callout .callout-content p, .one2mp-callout .callout-content li").forEach(o)}async function Iu(r,e){let t=[];r.querySelectorAll("video").forEach(o=>{t.push(o)});let n=t.map(async o=>{let a;o.src.includes("://mmbiz.qpic.cn/")||(o.src.startsWith("data:image/")?a=ra(o.src):a=await Cn(o.src),a!==void 0&&await e.uploadMaterial(a,Xr(a.type),"video").then(async s=>{if(s){let l=await e.getMaterialById(s.media_id);o.src=l.url}else console.error("upload video failed.")}))}),i=await Promise.allSettled(n);ei("\u89C6\u9891",i)}var $u=j(()=>{Fe();en()});var nt,ia=j(()=>{nt=class{constructor(){this.cardData=new Map}static getInstance(){return nt.instance||(nt.instance=new nt),nt.instance}setCardData(e,t){this.cardData.set(e,t)}cleanup(){this.cardData.clear()}restoreCard(e){for(let[t,n]of this.cardData.entries()){let o=`<section[^>]*\\sdata-id="${t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}"[^>]*>(.*?)<\\/section>`,a=new RegExp(o,"gs");if(!a.test(e)){console.warn("\u6CA1\u6709\u516C\u4F17\u53F7\u4FE1\u606F\uFF1A",t);continue}e=e.replace(a,n)}return e}}});function aa(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}function Fu(r){qt=r}function ge(r,e=""){let t=typeof r=="string"?r:r.source,n={replace:(i,o)=>{let a=typeof o=="string"?o:o.source;return a=a.replace(Ne.caret,"$1"),t=t.replace(i,a),n},getRegex:()=>new RegExp(t,e)};return n}function gt(r,e){if(e){if(Ne.escapeTest.test(r))return r.replace(Ne.escapeReplace,Du)}else if(Ne.escapeTestNoEncode.test(r))return r.replace(Ne.escapeReplaceNoEncode,Du);return r}function Mu(r){try{r=encodeURI(r).replace(Ne.percentDecode,"%")}catch(e){return null}return r}function Lu(r,e){var o;let t=r.replace(Ne.findPipe,(a,s,l)=>{let c=!1,u=s;for(;--u>=0&&l[u]==="\\";)c=!c;return c?"|":" |"}),n=t.split(Ne.splitPipe),i=0;if(n[0].trim()||n.shift(),n.length>0&&!((o=n.at(-1))!=null&&o.trim())&&n.pop(),e)if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(Ne.slashPipe,"|");return n}function Kn(r,e,t){let n=r.length;if(n===0)return"";let i=0;for(;i<n&&r.charAt(n-i-1)===e;)i++;return r.slice(0,n-i)}function Ay(r,e){if(r.indexOf(e[1])===-1)return-1;let t=0;for(let n=0;n<r.length;n++)if(r[n]==="\\")n++;else if(r[n]===e[0])t++;else if(r[n]===e[1]&&(t--,t<0))return n;return-1}function Ru(r,e,t,n,i){let o=e.href,a=e.title||null,s=r[1].replace(i.other.outputLinkReplace,"$1");if(r[0].charAt(0)!=="!"){n.state.inLink=!0;let l={type:"link",raw:t,href:o,title:a,text:s,tokens:n.inlineTokens(s)};return n.state.inLink=!1,l}return{type:"image",raw:t,href:o,title:a,text:s}}function Py(r,e,t){let n=r.match(t.other.indentCodeCompensation);if(n===null)return e;let i=n[1];return e.split(`
`).map(o=>{let a=o.match(t.other.beginningSpace);if(a===null)return o;let[s]=a;return s.length>=i.length?o.slice(i.length):o}).join(`
`)}function ve(r,e){return Bt.parse(r,e)}var qt,Gn,Ne,Qv,Zv,Yv,Zn,Xv,Bu,qu,sa,ey,la,ty,ny,ri,ca,ry,Nu,iy,ua,Ou,oy,ay,sy,ly,ju,cy,ii,da,zu,uy,Hu,dy,fy,hy,Uu,py,gy,Vu,my,vy,yy,wy,by,xy,_y,ni,ky,Wu,Ku,Sy,fa,Cy,oa,Ey,ti,Wn,Ty,Du,vn,He,yn,Jn,Ue,Ft,Qn,Bt,Kx,Gx,Jx,Qx,Zx,Yx,Xx,Gu=j(()=>{qt=aa();Gn={exec:()=>null};Ne={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:r=>new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}#`),htmlBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}<(?:[a-z].*>|!--)`,"i")},Qv=/^(?:[ \t]*(?:\n|$))+/,Zv=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Yv=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Zn=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Xv=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Bu=/(?:[*+-]|\d{1,9}[.)])/,qu=ge(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Bu).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),sa=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,ey=/^[^\n]+/,la=/(?!\s*\])(?:\\.|[^\[\]\\])+/,ty=ge(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",la).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ny=ge(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Bu).getRegex(),ri="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ca=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,ry=ge("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",ca).replace("tag",ri).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Nu=ge(sa).replace("hr",Zn).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ri).getRegex(),iy=ge(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Nu).getRegex(),ua={blockquote:iy,code:Zv,def:ty,fences:Yv,heading:Xv,hr:Zn,html:ry,lheading:qu,list:ny,newline:Qv,paragraph:Nu,table:Gn,text:ey},Ou=ge("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Zn).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ri).getRegex(),oy={...ua,table:Ou,paragraph:ge(sa).replace("hr",Zn).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Ou).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ri).getRegex()},ay={...ua,html:ge(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ca).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Gn,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ge(sa).replace("hr",Zn).replace("heading",` *#{1,6} *[^
]`).replace("lheading",qu).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},sy=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,ly=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,ju=/^( {2,}|\\)\n(?!\s*$)/,cy=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,ii=/[\p{P}\p{S}]/u,da=/[\s\p{P}\p{S}]/u,zu=/[^\s\p{P}\p{S}]/u,uy=ge(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,da).getRegex(),Hu=/(?!~)[\p{P}\p{S}]/u,dy=/(?!~)[\s\p{P}\p{S}]/u,fy=/(?:[^\s\p{P}\p{S}]|~)/u,hy=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,Uu=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,py=ge(Uu,"u").replace(/punct/g,ii).getRegex(),gy=ge(Uu,"u").replace(/punct/g,Hu).getRegex(),Vu="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",my=ge(Vu,"gu").replace(/notPunctSpace/g,zu).replace(/punctSpace/g,da).replace(/punct/g,ii).getRegex(),vy=ge(Vu,"gu").replace(/notPunctSpace/g,fy).replace(/punctSpace/g,dy).replace(/punct/g,Hu).getRegex(),yy=ge("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,zu).replace(/punctSpace/g,da).replace(/punct/g,ii).getRegex(),wy=ge(/\\(punct)/,"gu").replace(/punct/g,ii).getRegex(),by=ge(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),xy=ge(ca).replace("(?:-->|$)","-->").getRegex(),_y=ge("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",xy).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ni=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,ky=ge(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",ni).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Wu=ge(/^!?\[(label)\]\[(ref)\]/).replace("label",ni).replace("ref",la).getRegex(),Ku=ge(/^!?\[(ref)\](?:\[\])?/).replace("ref",la).getRegex(),Sy=ge("reflink|nolink(?!\\()","g").replace("reflink",Wu).replace("nolink",Ku).getRegex(),fa={_backpedal:Gn,anyPunctuation:wy,autolink:by,blockSkip:hy,br:ju,code:ly,del:Gn,emStrongLDelim:py,emStrongRDelimAst:my,emStrongRDelimUnd:yy,escape:sy,link:ky,nolink:Ku,punctuation:uy,reflink:Wu,reflinkSearch:Sy,tag:_y,text:cy,url:Gn},Cy={...fa,link:ge(/^!?\[(label)\]\((.*?)\)/).replace("label",ni).getRegex(),reflink:ge(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ni).getRegex()},oa={...fa,emStrongRDelimAst:vy,emStrongLDelim:gy,url:ge(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Ey={...oa,br:ge(ju).replace("{2,}","*").getRegex(),text:ge(oa.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ti={normal:ua,gfm:oy,pedantic:ay},Wn={normal:fa,gfm:oa,breaks:Ey,pedantic:Cy},Ty={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Du=r=>Ty[r];vn=class{constructor(e){be(this,"options");be(this,"rules");be(this,"lexer");this.options=e||qt}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Kn(n,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let n=t[0],i=Py(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:i}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){let i=Kn(n,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(n=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Kn(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let n=Kn(t[0],`
`).split(`
`),i="",o="",a=[];for(;n.length>0;){let s=!1,l=[],c;for(c=0;c<n.length;c++)if(this.rules.other.blockquoteStart.test(n[c]))l.push(n[c]),s=!0;else if(!s)l.push(n[c]);else break;n=n.slice(c);let u=l.join(`
`),d=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${u}`:u,o=o?`${o}
${d}`:d;let f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,a,!0),this.lexer.state.top=f,n.length===0)break;let m=a.at(-1);if((m==null?void 0:m.type)==="code")break;if((m==null?void 0:m.type)==="blockquote"){let b=m,E=b.raw+`
`+n.join(`
`),S=this.blockquote(E);a[a.length-1]=S,i=i.substring(0,i.length-b.raw.length)+S.raw,o=o.substring(0,o.length-b.text.length)+S.text;break}else if((m==null?void 0:m.type)==="list"){let b=m,E=b.raw+`
`+n.join(`
`),S=this.list(E);a[a.length-1]=S,i=i.substring(0,i.length-m.raw.length)+S.raw,o=o.substring(0,o.length-b.raw.length)+S.raw,n=E.substring(a.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:a,text:o}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),i=n.length>1,o={type:"list",raw:"",ordered:i,start:i?+n.slice(0,-1):"",loose:!1,items:[]};n=i?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=i?n:"[*+-]");let a=this.rules.other.listItemRegex(n),s=!1;for(;e;){let c=!1,u="",d="";if(!(t=a.exec(e))||this.rules.block.hr.test(e))break;u=t[0],e=e.substring(u.length);let f=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,g=>" ".repeat(3*g.length)),m=e.split(`
`,1)[0],b=!f.trim(),E=0;if(this.options.pedantic?(E=2,d=f.trimStart()):b?E=t[1].length+1:(E=t[2].search(this.rules.other.nonSpaceChar),E=E>4?1:E,d=f.slice(E),E+=t[1].length),b&&this.rules.other.blankLine.test(m)&&(u+=m+`
`,e=e.substring(m.length+1),c=!0),!c){let g=this.rules.other.nextBulletRegex(E),h=this.rules.other.hrRegex(E),p=this.rules.other.fencesBeginRegex(E),w=this.rules.other.headingBeginRegex(E),k=this.rules.other.htmlBeginRegex(E);for(;e;){let R=e.split(`
`,1)[0],B;if(m=R,this.options.pedantic?(m=m.replace(this.rules.other.listReplaceNesting,"  "),B=m):B=m.replace(this.rules.other.tabCharGlobal,"    "),p.test(m)||w.test(m)||k.test(m)||g.test(m)||h.test(m))break;if(B.search(this.rules.other.nonSpaceChar)>=E||!m.trim())d+=`
`+B.slice(E);else{if(b||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||p.test(f)||w.test(f)||h.test(f))break;d+=`
`+m}!b&&!m.trim()&&(b=!0),u+=R+`
`,e=e.substring(R.length+1),f=B.slice(E)}}o.loose||(s?o.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(s=!0));let S=null,y;this.options.gfm&&(S=this.rules.other.listIsTask.exec(d),S&&(y=S[0]!=="[ ] ",d=d.replace(this.rules.other.listReplaceTask,""))),o.items.push({type:"list_item",raw:u,task:!!S,checked:y,loose:!1,text:d,tokens:[]}),o.raw+=u}let l=o.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;o.raw=o.raw.trimEnd();for(let c=0;c<o.items.length;c++)if(this.lexer.state.top=!1,o.items[c].tokens=this.lexer.blockTokens(o.items[c].text,[]),!o.loose){let u=o.items[c].tokens.filter(f=>f.type==="space"),d=u.length>0&&u.some(f=>this.rules.other.anyLine.test(f.raw));o.loose=d}if(o.loose)for(let c=0;c<o.items.length;c++)o.items[c].loose=!0;return o}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",o=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:i,title:o}}}table(e){var s;let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let n=Lu(t[1]),i=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),o=(s=t[3])!=null&&s.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],a={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===i.length){for(let l of i)this.rules.other.tableAlignRight.test(l)?a.align.push("right"):this.rules.other.tableAlignCenter.test(l)?a.align.push("center"):this.rules.other.tableAlignLeft.test(l)?a.align.push("left"):a.align.push(null);for(let l=0;l<n.length;l++)a.header.push({text:n[l],tokens:this.lexer.inline(n[l]),header:!0,align:a.align[l]});for(let l of o)a.rows.push(Lu(l,a.header.length).map((c,u)=>({text:c,tokens:this.lexer.inline(c),header:!1,align:a.align[u]})));return a}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let a=Kn(n.slice(0,-1),"\\");if((n.length-a.length)%2===0)return}else{let a=Ay(t[2],"()");if(a>-1){let l=(t[0].indexOf("!")===0?5:4)+t[1].length+a;t[2]=t[2].substring(0,a),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let i=t[2],o="";if(this.options.pedantic){let a=this.rules.other.pedanticHrefTitle.exec(i);a&&(i=a[1],o=a[3])}else o=t[3]?t[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?i=i.slice(1):i=i.slice(1,-1)),Ru(t,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:o&&o.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let i=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),o=t[i.toLowerCase()];if(!o){let a=n[0].charAt(0);return{type:"text",raw:a,text:a}}return Ru(n,o,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!i||i[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(i[1]||i[2]||"")||!n||this.rules.inline.punctuation.exec(n)){let a=[...i[0]].length-1,s,l,c=a,u=0,d=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,t=t.slice(-1*e.length+a);(i=d.exec(t))!=null;){if(s=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!s)continue;if(l=[...s].length,i[3]||i[4]){c+=l;continue}else if((i[5]||i[6])&&a%3&&!((a+l)%3)){u+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+u);let f=[...i[0]][0].length,m=e.slice(0,a+i.index+f+l);if(Math.min(a,l)%2){let E=m.slice(1,-1);return{type:"em",raw:m,text:E,tokens:this.lexer.inlineTokens(E)}}let b=m.slice(2,-2);return{type:"strong",raw:m,text:b,tokens:this.lexer.inlineTokens(b)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," "),i=this.rules.other.nonSpaceChar.test(n),o=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return i&&o&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let n,i;return t[2]==="@"?(n=t[1],i="mailto:"+n):(n=t[1],i=n),{type:"link",raw:t[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n,i;let t;if(t=this.rules.inline.url.exec(e)){let o,a;if(t[2]==="@")o=t[0],a="mailto:"+o;else{let s;do s=t[0],t[0]=(i=(n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])!=null?i:"";while(s!==t[0]);o=t[0],t[1]==="www."?a="http://"+t[0]:a=t[0]}return{type:"link",raw:t[0],text:o,href:a,tokens:[{type:"text",raw:o,text:o}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},He=class{constructor(e){be(this,"tokens");be(this,"options");be(this,"state");be(this,"tokenizer");be(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||qt,this.options.tokenizer=this.options.tokenizer||new vn,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:Ne,block:ti.normal,inline:Wn.normal};this.options.pedantic?(t.block=ti.pedantic,t.inline=Wn.pedantic):this.options.gfm&&(t.block=ti.gfm,this.options.breaks?t.inline=Wn.breaks:t.inline=Wn.gfm),this.tokenizer.rules=t}static get rules(){return{block:ti,inline:Wn}}static lex(e,t){return new He(t).lex(e)}static lexInline(e,t){return new He(t).inlineTokens(e)}lex(e){e=e.replace(Ne.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){let n=this.inlineQueue[t];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){var i,o,a;for(this.options.pedantic&&(e=e.replace(Ne.tabCharGlobal,"    ").replace(Ne.spaceLine,""));e;){let s;if((o=(i=this.options.extensions)==null?void 0:i.block)!=null&&o.some(c=>(s=c.call({lexer:this},e,t))?(e=e.substring(s.raw.length),t.push(s),!0):!1))continue;if(s=this.tokenizer.space(e)){e=e.substring(s.raw.length);let c=t.at(-1);s.raw.length===1&&c!==void 0?c.raw+=`
`:t.push(s);continue}if(s=this.tokenizer.code(e)){e=e.substring(s.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+s.raw,c.text+=`
`+s.text,this.inlineQueue.at(-1).src=c.text):t.push(s);continue}if(s=this.tokenizer.fences(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.heading(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.hr(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.blockquote(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.list(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.html(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.def(e)){e=e.substring(s.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+s.raw,c.text+=`
`+s.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title});continue}if(s=this.tokenizer.table(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.lheading(e)){e=e.substring(s.raw.length),t.push(s);continue}let l=e;if((a=this.options.extensions)!=null&&a.startBlock){let c=1/0,u=e.slice(1),d;this.options.extensions.startBlock.forEach(f=>{d=f.call({lexer:this},u),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(l=e.substring(0,c+1))}if(this.state.top&&(s=this.tokenizer.paragraph(l))){let c=t.at(-1);n&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=`
`+s.raw,c.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):t.push(s),n=l.length!==e.length,e=e.substring(s.raw.length);continue}if(s=this.tokenizer.text(e)){e=e.substring(s.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=`
`+s.raw,c.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):t.push(s);continue}if(e){let c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var s,l,c;let n=e,i=null;if(this.tokens.links){let u=Object.keys(this.tokens.links);if(u.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(n))!=null;)u.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.blockSkip.exec(n))!=null;)n=n.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(n))!=null;)n=n.slice(0,i.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let o=!1,a="";for(;e;){o||(a=""),o=!1;let u;if((l=(s=this.options.extensions)==null?void 0:s.inline)!=null&&l.some(f=>(u=f.call({lexer:this},e,t))?(e=e.substring(u.raw.length),t.push(u),!0):!1))continue;if(u=this.tokenizer.escape(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.tag(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.link(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(u.raw.length);let f=t.at(-1);u.type==="text"&&(f==null?void 0:f.type)==="text"?(f.raw+=u.raw,f.text+=u.text):t.push(u);continue}if(u=this.tokenizer.emStrong(e,n,a)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.codespan(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.br(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.del(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.autolink(e)){e=e.substring(u.raw.length),t.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(e))){e=e.substring(u.raw.length),t.push(u);continue}let d=e;if((c=this.options.extensions)!=null&&c.startInline){let f=1/0,m=e.slice(1),b;this.options.extensions.startInline.forEach(E=>{b=E.call({lexer:this},m),typeof b=="number"&&b>=0&&(f=Math.min(f,b))}),f<1/0&&f>=0&&(d=e.substring(0,f+1))}if(u=this.tokenizer.inlineText(d)){e=e.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(a=u.raw.slice(-1)),o=!0;let f=t.at(-1);(f==null?void 0:f.type)==="text"?(f.raw+=u.raw,f.text+=u.text):t.push(u);continue}if(e){let f="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return t}},yn=class{constructor(e){be(this,"options");be(this,"parser");this.options=e||qt}space(e){return""}code({text:e,lang:t,escaped:n}){var a;let i=(a=(t||"").match(Ne.notSpaceStart))==null?void 0:a[0],o=e.replace(Ne.endingNewline,"")+`
`;return i?'<pre><code class="language-'+gt(i)+'">'+(n?o:gt(o,!0))+`</code></pre>
`:"<pre><code>"+(n?o:gt(o,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,n=e.start,i="";for(let s=0;s<e.items.length;s++){let l=e.items[s];i+=this.listitem(l)}let o=t?"ol":"ul",a=t&&n!==1?' start="'+n+'"':"";return"<"+o+a+`>
`+i+"</"+o+`>
`}listitem(e){var n;let t="";if(e.task){let i=this.checkbox({checked:!!e.checked});e.loose?((n=e.tokens[0])==null?void 0:n.type)==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+gt(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" ",escaped:!0}):t+=i+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let o=0;o<e.header.length;o++)n+=this.tablecell(e.header[o]);t+=this.tablerow({text:n});let i="";for(let o=0;o<e.rows.length;o++){let a=e.rows[o];n="";for(let s=0;s<a.length;s++)n+=this.tablecell(a[s]);i+=this.tablerow({text:n})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+i+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${gt(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let i=this.parser.parseInline(n),o=Mu(e);if(o===null)return i;e=o;let a='<a href="'+e+'"';return t&&(a+=' title="'+gt(t)+'"'),a+=">"+i+"</a>",a}image({href:e,title:t,text:n}){let i=Mu(e);if(i===null)return gt(n);e=i;let o=`<img src="${e}" alt="${n}"`;return t&&(o+=` title="${gt(t)}"`),o+=">",o}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:gt(e.text)}},Jn=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},Ue=class{constructor(e){be(this,"options");be(this,"renderer");be(this,"textRenderer");this.options=e||qt,this.options.renderer=this.options.renderer||new yn,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Jn}static parse(e,t){return new Ue(t).parse(e)}static parseInline(e,t){return new Ue(t).parseInline(e)}parse(e,t=!0){var i,o;let n="";for(let a=0;a<e.length;a++){let s=e[a];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[s.type]){let c=s,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){n+=u||"";continue}}let l=s;switch(l.type){case"space":{n+=this.renderer.space(l);continue}case"hr":{n+=this.renderer.hr(l);continue}case"heading":{n+=this.renderer.heading(l);continue}case"code":{n+=this.renderer.code(l);continue}case"table":{n+=this.renderer.table(l);continue}case"blockquote":{n+=this.renderer.blockquote(l);continue}case"list":{n+=this.renderer.list(l);continue}case"html":{n+=this.renderer.html(l);continue}case"paragraph":{n+=this.renderer.paragraph(l);continue}case"text":{let c=l,u=this.renderer.text(c);for(;a+1<e.length&&e[a+1].type==="text";)c=e[++a],u+=`
`+this.renderer.text(c);t?n+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):n+=u;continue}default:{let c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return n}parseInline(e,t=this.renderer){var i,o;let n="";for(let a=0;a<e.length;a++){let s=e[a];if((o=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&o[s.type]){let c=this.options.extensions.renderers[s.type].call({parser:this},s);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){n+=c||"";continue}}let l=s;switch(l.type){case"escape":{n+=t.text(l);break}case"html":{n+=t.html(l);break}case"link":{n+=t.link(l);break}case"image":{n+=t.image(l);break}case"strong":{n+=t.strong(l);break}case"em":{n+=t.em(l);break}case"codespan":{n+=t.codespan(l);break}case"br":{n+=t.br(l);break}case"del":{n+=t.del(l);break}case"text":{n+=t.text(l);break}default:{let c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return n}},Ft=class{constructor(e){be(this,"options");be(this,"block");this.options=e||qt}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?He.lex:He.lexInline}provideParser(){return this.block?Ue.parse:Ue.parseInline}};be(Ft,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));Qn=class{constructor(...e){be(this,"defaults",aa());be(this,"options",this.setOptions);be(this,"parse",this.parseMarkdown(!0));be(this,"parseInline",this.parseMarkdown(!1));be(this,"Parser",Ue);be(this,"Renderer",yn);be(this,"TextRenderer",Jn);be(this,"Lexer",He);be(this,"Tokenizer",vn);be(this,"Hooks",Ft);this.use(...e)}walkTokens(e,t){var i,o;let n=[];for(let a of e)switch(n=n.concat(t.call(this,a)),a.type){case"table":{let s=a;for(let l of s.header)n=n.concat(this.walkTokens(l.tokens,t));for(let l of s.rows)for(let c of l)n=n.concat(this.walkTokens(c.tokens,t));break}case"list":{let s=a;n=n.concat(this.walkTokens(s.items,t));break}default:{let s=a;(o=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&o[s.type]?this.defaults.extensions.childTokens[s.type].forEach(l=>{let c=s[l].flat(1/0);n=n.concat(this.walkTokens(c,t))}):s.tokens&&(n=n.concat(this.walkTokens(s.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{let i={...n};if(i.async=this.defaults.async||i.async||!1,n.extensions&&(n.extensions.forEach(o=>{if(!o.name)throw new Error("extension name required");if("renderer"in o){let a=t.renderers[o.name];a?t.renderers[o.name]=function(...s){let l=o.renderer.apply(this,s);return l===!1&&(l=a.apply(this,s)),l}:t.renderers[o.name]=o.renderer}if("tokenizer"in o){if(!o.level||o.level!=="block"&&o.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let a=t[o.level];a?a.unshift(o.tokenizer):t[o.level]=[o.tokenizer],o.start&&(o.level==="block"?t.startBlock?t.startBlock.push(o.start):t.startBlock=[o.start]:o.level==="inline"&&(t.startInline?t.startInline.push(o.start):t.startInline=[o.start]))}"childTokens"in o&&o.childTokens&&(t.childTokens[o.name]=o.childTokens)}),i.extensions=t),n.renderer){let o=this.defaults.renderer||new yn(this.defaults);for(let a in n.renderer){if(!(a in o))throw new Error(`renderer '${a}' does not exist`);if(["options","parser"].includes(a))continue;let s=a,l=n.renderer[s],c=o[s];o[s]=(...u)=>{let d=l.apply(o,u);return d===!1&&(d=c.apply(o,u)),d||""}}i.renderer=o}if(n.tokenizer){let o=this.defaults.tokenizer||new vn(this.defaults);for(let a in n.tokenizer){if(!(a in o))throw new Error(`tokenizer '${a}' does not exist`);if(["options","rules","lexer"].includes(a))continue;let s=a,l=n.tokenizer[s],c=o[s];o[s]=(...u)=>{let d=l.apply(o,u);return d===!1&&(d=c.apply(o,u)),d}}i.tokenizer=o}if(n.hooks){let o=this.defaults.hooks||new Ft;for(let a in n.hooks){if(!(a in o))throw new Error(`hook '${a}' does not exist`);if(["options","block"].includes(a))continue;let s=a,l=n.hooks[s],c=o[s];Ft.passThroughHooks.has(a)?o[s]=u=>{if(this.defaults.async)return Promise.resolve(l.call(o,u)).then(f=>c.call(o,f));let d=l.call(o,u);return c.call(o,d)}:o[s]=(...u)=>{let d=l.apply(o,u);return d===!1&&(d=c.apply(o,u)),d}}i.hooks=o}if(n.walkTokens){let o=this.defaults.walkTokens,a=n.walkTokens;i.walkTokens=function(s){let l=[];return l.push(a.call(this,s)),o&&(l=l.concat(o.call(this,s))),l}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return He.lex(e,t!=null?t:this.defaults)}parser(e,t){return Ue.parse(e,t!=null?t:this.defaults)}parseMarkdown(e){return(n,i)=>{let o={...i},a={...this.defaults,...o},s=this.onError(!!a.silent,!!a.async);if(this.defaults.async===!0&&o.async===!1)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n=="undefined"||n===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));a.hooks&&(a.hooks.options=a,a.hooks.block=e);let l=a.hooks?a.hooks.provideLexer():e?He.lex:He.lexInline,c=a.hooks?a.hooks.provideParser():e?Ue.parse:Ue.parseInline;if(a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(n):n).then(u=>l(u,a)).then(u=>a.hooks?a.hooks.processAllTokens(u):u).then(u=>a.walkTokens?Promise.all(this.walkTokens(u,a.walkTokens)).then(()=>u):u).then(u=>c(u,a)).then(u=>a.hooks?a.hooks.postprocess(u):u).catch(s);try{a.hooks&&(n=a.hooks.preprocess(n));let u=l(n,a);a.hooks&&(u=a.hooks.processAllTokens(u)),a.walkTokens&&this.walkTokens(u,a.walkTokens);let d=c(u,a);return a.hooks&&(d=a.hooks.postprocess(d)),d}catch(u){return s(u)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let i="<p>An error occurred:</p><pre>"+gt(n.message+"",!0)+"</pre>";return t?Promise.resolve(i):i}if(t)return Promise.reject(n);throw n}}},Bt=new Qn;ve.options=ve.setOptions=function(r){return Bt.setOptions(r),ve.defaults=Bt.defaults,Fu(ve.defaults),ve};ve.getDefaults=aa;ve.defaults=qt;ve.use=function(...r){return Bt.use(...r),ve.defaults=Bt.defaults,Fu(ve.defaults),ve};ve.walkTokens=function(r,e){return Bt.walkTokens(r,e)};ve.parseInline=Bt.parseInline;ve.Parser=Ue;ve.parser=Ue.parse;ve.Renderer=yn;ve.TextRenderer=Jn;ve.Lexer=He;ve.lexer=He.lex;ve.Tokenizer=vn;ve.Hooks=Ft;ve.parse=ve;Kx=ve.options,Gx=ve.setOptions,Jx=ve.use,Qx=ve.walkTokens,Zx=ve.parseInline,Yx=Ue.parse,Xx=He.lex});var ke,Ge=j(()=>{ke=class{constructor(e,t,n){this.plugin=e,this.previewRender=t,this.marked=n}prepare(){return Promise.resolve()}postprocess(e){return Promise.resolve(e)}beforePublish(){return Promise.resolve()}cleanup(){return Promise.resolve()}isPluginInstlled(e){let t=this.plugin.app.plugins.plugins;return Object.prototype.hasOwnProperty.call(t,e)}}});function Yu(r){if(!r)return"";let e=/\[!(.*?)\]/,t=r.match(e);return t?t[1].trim():""}function wa(r){return r?r.split(/\r?\n/).map(e=>e.replace(/^>\s?/,"")).join(`
`).trim():""}function Ly(r,e){let t=r.charAt(0).toUpperCase()+r.slice(1).toLowerCase(),n=e.indexOf("]")+1;(e.indexOf("]-")>0||e.indexOf("]+")>0)&&(n=n+1);let i=e.indexOf(`
`);if(i===-1&&(i=e.length),n>=i)return t;let o=e.slice(n,i).trim();return o!==""&&(t=o),t}function Ry(r){return r&&r.replace(/<p([^>]*)>([\s\S]*?)<\/p>/g,'<p$1><span class="callout-text">$2</span></p>')}var Iy,ha,$y,Oy,pa,ga,ma,va,ya,Ju,Dy,My,Qu,Zu,oi,Xu=j(()=>{Ge();Iy='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-pencil"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"></path><path d="m15 5 4 4"></path></svg>',ha='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-clipboard-list"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><path d="M12 11h4"></path><path d="M12 16h4"></path><path d="M8 11h.01"></path><path d="M8 16h.01"></path></svg>',$y='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg>',Oy='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check-circle-2"><circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path></svg>',pa='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>',ga='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg>',ma='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-help-circle"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><path d="M12 17h.01"></path></svg>',va='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg>',ya='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>',Ju='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-zap"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>',Dy='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-bug"><path d="m8 2 1.88 1.88"></path><path d="M14.12 3.88 16 2"></path><path d="M9 7.13v-1a3.003 3.003 0 1 1 6 0v1"></path><path d="M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6"></path><path d="M12 20v-9"></path><path d="M6.53 9C4.6 8.8 3 7.1 3 5"></path><path d="M6 13H2"></path><path d="M3 21c0-2.1 1.7-3.9 3.8-4"></path><path d="M20.97 5c0 2.1-1.6 3.8-3.5 4"></path><path d="M22 13h-4"></path><path d="M17.2 17c2.1.1 3.8 1.9 3.8 4"></path></svg>',My='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>',Qu='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-quote"><path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z"></path><path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z"></path></svg>',Zu=new Map(Object.entries({note:{icon:Iy},abstract:{icon:ha},summary:{icon:ha},tldr:{icon:ha},info:{icon:$y},todo:{icon:Oy},tip:{icon:pa},hint:{icon:pa},important:{icon:pa},success:{icon:ga},check:{icon:ga},done:{icon:ga},question:{icon:ma},help:{icon:ma},faq:{icon:ma},warning:{icon:va},caution:{icon:va},attention:{icon:va},failure:{icon:ya},fail:{icon:ya},missing:{icon:ya},danger:{icon:Ju},error:{icon:Ju},bug:{icon:Dy},example:{icon:My},quote:{icon:Qu},cite:{icon:Qu}}));oi=class extends ke{prepare(){return this.marked||console.error("marked is not ready"),Promise.resolve()}async rendererBlockquote(e){let t=e.text||wa(e.raw||"");return`<blockquote dir="auto"><span class="icon-pin"></span><div class="blockquote-inner">${(await this.marked.parseInline(t)).replace(/\n/gm,"<br>").trim()}</div></blockquote>`}async rendererCallout(e){let t=e.text||wa(e.raw||""),n=Yu(t);if(!n)return this.rendererBlockquote(e);let i=n.toLowerCase(),o=Ly(n,t),a=t.indexOf(`
`),s="";if(a>0){let u=t.slice(a+1).trim();u&&(s=await this.marked.parse(u)),!s&&u&&(s=(await this.marked.parseInline(u)).replace(/\n/gm,"<br>")),s=Ry(s)}let l=Zu.get(i)||Zu.get("note"),c=l?l.icon:"";return`<section class="one2mp-callout" data-callout="${i}"><div class="callout-title"><div class="callout-icon">${c}</div><div class="callout-title-inner">${o}</div></div><div class="callout-content">${s}</div></section>`}markedExtension(){return{async:!0,walkTokens:async e=>{if(e.type!=="blockquote")return;let t=e,n=t.raw||"",i=wa(n);!t.text&&i&&(t.text=i),Yu(i||t.text)?e.html=await this.rendererCallout(t):e.html=await this.rendererBlockquote(t)},extensions:[{name:"blockquote",level:"block",renderer:e=>e.html}]}}}});var Fy,ai,By,Yn,qy,Ny,ed,td,nd=j(()=>{Fy=r=>r&&r.replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"),ai=r=>r.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),By=r=>{let e=r.match(/```mpcard\s*([\s\S]*?)```/i);return e?e[1].trim():r.trim()},Yn=(r,e)=>{var i,o;let t=new RegExp(`\\b${e}=("([^"]*)"|'([^']*)')`,"i"),n=r.match(t);return n?Fy(((o=(i=n[2])!=null?i:n[3])!=null?o:"").trim()):""},qy=r=>{let e=r.split(/\r?\n/).map(i=>i.trim()).filter(i=>i.length>0),t={},n=/^(\w+):\s*"?(.*?)"?$/;for(let i of e){let o=i.match(n);if(o){let a=o[1].trim().toLowerCase(),s=o[2].trim();t[a]=s}}return{id:t.id||"",headimg:t.headimg||t.avatar||"",nickname:t.nickname||t.name||"",signature:t.signature||t.desc||t.description||"",alias:t.alias||""}},Ny=r=>{let e=By(r);if(!e)return null;if(/<mp-common-profile/i.test(e)||/\bdata-id=/.test(e))return{id:Yn(e,"data-id"),headimg:Yn(e,"data-headimg"),nickname:Yn(e,"data-nickname"),signature:Yn(e,"data-signature"),alias:Yn(e,"data-alias"),rawHtml:e};let t=qy(e);return{id:t.id||"",headimg:t.headimg||"",nickname:t.nickname||"",signature:t.signature||"",alias:t.alias,rawHtml:""}},ed=r=>{let e=Ny(r);if(!e||!e.id||!e.rawHtml)return null;let t=e.rawHtml.trim();return/<mp-common-profile/i.test(t)?(/^\s*<section/i.test(t)||(t=`<section class="mp_profile_iframe_wrp" nodeleaf="">${t}</section>`),{info:e,html:t}):null},td=r=>{let e=ai(r.headimg||""),t=ai(r.nickname||""),n=ai(r.signature||"");return`<section${r.id?` data-id="${ai(r.id)}"`:""} class="one2mp-mpcard-wrapper"><div class="one2mp-mpcard-content"><img class="one2mp-mpcard-headimg" width="54" height="54" src="${e}"></img><div class="one2mp-mpcard-info"><div class="one2mp-mpcard-nickname">${t}</div><div class="one2mp-mpcard-signature">${n}</div></div></div><div class="one2mp-mpcard-foot">\u516C\u4F17\u53F7</div></section>`}});var rd,si,id=j(()=>{Fe();en();Vn();Ge();rd=require("obsidian");ia();nd();si=class extends ke{constructor(){super(...arguments);this.mermaidIndex=0;this.admonitionIndex=0;this.chartsIndex=0}prepare(){return this.mermaidIndex=0,this.admonitionIndex=0,this.chartsIndex=0,nt.getInstance().cleanup(),Promise.resolve()}static srcToBlob(t){let n=t.split(",")[1],i=atob(n),o=new Array(i.length);for(let s=0;s<i.length;s++)o[s]=i.charCodeAt(s);let a=new Uint8Array(o);return new Blob([a],{type:"image/png"})}getHighlightProfile(t){if(!t)return null;let n=t.toLowerCase(),i=new Set(["const","let","var","function","return","if","else","for","while","switch","case","break","continue","class","new","this","try","catch","finally","throw","import","export","from","extends","super","await","async","typeof","instanceof","in","of","interface","type","enum","public","private","protected","readonly","implements","constructor","static","get","set"]),o=new Set(["def","class","import","from","return","if","elif","else","for","while","try","except","finally","with","as","pass","break","continue","lambda","yield","True","False","None"]),a=new Set(["true","false","null"]),s=new Set(["if","then","fi","for","do","done","case","esac","function","in","while","until","return","export","local","readonly"]);return{js:{keywords:i,lineComment:"//",blockComment:{start:"/*",end:"*/"},allowBacktick:!0},javascript:{keywords:i,lineComment:"//",blockComment:{start:"/*",end:"*/"},allowBacktick:!0},ts:{keywords:i,lineComment:"//",blockComment:{start:"/*",end:"*/"},allowBacktick:!0},typescript:{keywords:i,lineComment:"//",blockComment:{start:"/*",end:"*/"},allowBacktick:!0},json:{keywords:a},py:{keywords:o,lineComment:"#"},python:{keywords:o,lineComment:"#"},sh:{keywords:s,lineComment:"#"},bash:{keywords:s,lineComment:"#"},shell:{keywords:s,lineComment:"#"},zsh:{keywords:s,lineComment:"#"}}[n]||null}escapeHtml(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}preserveSpaces(t){return t.replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/ /g,"&nbsp;")}isIdentifierStart(t){let n=t.charCodeAt(0);return n>=65&&n<=90||n>=97&&n<=122||t==="_"||t==="$"}isIdentifierPart(t){let n=t.charCodeAt(0);return n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||t==="_"||t==="$"}highlightLine(t,n,i){let o=[],a=0,s=(c,u)=>{u&&o.push({type:c,text:u})};for(;a<t.length;){let c=t[a];if(n.inBlockComment&&i.blockComment){let d=t.indexOf(i.blockComment.end,a);if(d>=0){s("comment",t.slice(a,d+i.blockComment.end.length)),a=d+i.blockComment.end.length,n.inBlockComment=!1;continue}s("comment",t.slice(a)),a=t.length;continue}if(n.inString){let d="";for(;a<t.length;){let f=t[a];if(d+=f,f==="\\"&&a+1<t.length){d+=t[a+1],a+=2;continue}if(a+=1,f===n.stringChar){n.inString=!1;break}}s("string",d);continue}if(i.lineComment&&t.startsWith(i.lineComment,a)){s("comment",t.slice(a));break}if(i.blockComment&&t.startsWith(i.blockComment.start,a)){n.inBlockComment=!0;continue}if(c==="'"||c==='"'||c==="`"&&i.allowBacktick){n.inString=!0,n.stringChar=c;continue}if(c===" "||c==="	"){let d=a;for(;a<t.length&&(t[a]===" "||t[a]==="	");)a+=1;s("plain",t.slice(d,a));continue}let u=c.charCodeAt(0);if(u>=48&&u<=57||c==="."&&a+1<t.length&&t[a+1]>="0"&&t[a+1]<="9"){let d=a;for(a+=1;a<t.length;){let f=t[a];if(f>="0"&&f<="9"||f==="."||f==="_"||f==="x"||f==="X"||f>="a"&&f<="f"||f>="A"&&f<="F"){a+=1;continue}break}s("number",t.slice(d,a));continue}if(this.isIdentifierStart(c)){let d=a;for(a+=1;a<t.length&&this.isIdentifierPart(t[a]);)a+=1;let f=t.slice(d,a);i.keywords.has(f)?s("keyword",f):s("plain",f);continue}s("plain",c),a+=1}return{html:o.map(c=>{let u=this.preserveSpaces(this.escapeHtml(c.text));return c.type==="plain"?u:`<span class="o2any-token-${c.type}">${u}</span>`}).join(""),state:n}}codeRenderer(t,n){var f;let i=(f=(n||"").match(/^\S*/))==null?void 0:f[0],o=t.replace(/\n$/,""),a=this.getHighlightProfile(i||""),s=o.split(/\r?\n/),l="",c={inBlockComment:!1,inString:!1,stringChar:""};for(let m of s){let b=m;if(a){let E=this.highlightLine(m,c,a);b=E.html,c.inBlockComment=E.state.inBlockComment,c.inString=E.state.inString,c.stringChar=E.state.stringChar}else b=this.preserveSpaces(this.escapeHtml(m));b.length===0&&(b="<br>"),l+="<code>"+b+"</code>"}let u='<section class="code-section code-snippet__fix">',d="";return i?d=u+`<pre style="max-width:1000% !important;" class="hljs o2any-codeblock language-${i}">${l}</pre></section>`:d=u+`<pre class="hljs o2any-codeblock">${l}</pre></section>`,d}static getMathType(t){if(!t)return null;let n=t.toLowerCase();return n=n.trim(),n==="am"||n==="asciimath"?"asciimath":n==="latex"||n==="tex"?"latex":null}renderAdmonition(t,n){let i=Ae.getInstance(this.plugin.app).queryElement(this.admonitionIndex,".callout.admonition");if(!i)return $("render.admonition-failed");this.admonitionIndex++;let o=i.querySelector(".edit-block-button");o&&o.parentNode.removeChild(o);let a=i.querySelector(".callout-fold");if(a)try{a.parentNode.removeChild(a)}catch(s){console.error(s)}return i.outerHTML}renderAdmonitionAsync(t,n){let o=Ae.getInstance(this.plugin.app).queryElement(this.admonitionIndex,".callout.admonition");if(!o)return $("render.admonition-failed");this.admonitionIndex++;let a=o.querySelector(".edit-block-button");a&&a.parentNode.removeChild(a);let s=o.querySelector(".callout-fold");if(s)try{s.parentNode.removeChild(s)}catch(l){console.error(l)}return cl(o)}async renderMermaidAsync(t){var u;t.html=$("render.mermaid-failed");let n=this.mermaidIndex;this.mermaidIndex++;let i=Ae.getInstance(this.plugin.app),o=i.queryElement(n,".mermaid");if(!o)return;await i.waitForSelector(o,"svg",5e3);let a=o.querySelector("svg");if(!a)return;let s=o.closest(".one2mp-render-preview"),l=(u=s==null?void 0:s.classList.contains("one2mp-render-preview-visible"))!=null?u:!1,c=o.classList.contains("one2mp-mermaid-visible");try{s==null||s.classList.add("one2mp-render-preview-visible"),o.classList.add("one2mp-mermaid-visible");let{width:d,height:f}=this.getMermaidSize(a),m=await i.domToImage(a,{width:d,height:f});t.html=`<section id="one2mp-mermaid-${n}" class="mermaid"><img src="${m}" class="mermaid-image" style="width:${d}px;height:auto;"></section>`}catch(d){console.error(d)}finally{s&&!l&&s.classList.remove("one2mp-render-preview-visible"),c||o.classList.remove("one2mp-mermaid-visible")}}getMermaidSize(t){var a;let n=t.getBoundingClientRect(),i=Math.round(n.width),o=Math.round(n.height);if(!i||!o){let s=(a=t.viewBox)==null?void 0:a.baseVal;s&&s.width&&s.height&&(i=Math.round(s.width),o=Math.round(s.height))}if(!i||!o){let s=t.getAttribute("width"),l=t.getAttribute("height"),c=s?parseFloat(s):0,u=l?parseFloat(l):0;c&&(i=Math.round(c)),u&&(o=Math.round(u))}return i||(i=800),o||(o=400),{width:i,height:o}}renderCharts(t){if(!this.isPluginInstlled("obsidian-charts"))return console.debug("charts plugin not installed."),new rd.Notice($("rnder.charts-plugin-not-installed")),!1;let n=this.plugin.resourceManager.getMarkdownRenderedElement(this.chartsIndex,".block-language-chart");if(!n)return $("render.charts-failed");let i=`charts-img-${this.chartsIndex}`;this.chartsIndex++;let o=n.querySelector("canvas");if(o){let a="image/png",s=o.toDataURL(a);return`<section id="${i}" class="charts" >
			<img src="${s}" class="charts-image" />
			</section>`}return $("render.charts-failed")}renderWewriteProfile(t){let n=t.text.split(/\r?\n/).filter(s=>s.trim()!==""),i={},o=/^(\w+):\s*"?(.*?)"?$/;return n.forEach(s=>{let l=s.match(o);if(l){let c=l[1].trim().toLocaleLowerCase(),u=l[2].trim();i[c]=u}}),`<div class="one2mp-profile-card">
		<a class="one2mp-profile-card-link" href="${i.url}">
			<div class="card-main">
				<div class="avatar">
					<img src="${i.avatar}" alt="${i.nickname}" avatar class="one2mp-avatar-image" >
				</div>
			<div class="content">
				<div class="title">${i.nickname}</div>
				<div class="description">${i.description}</div>
				<div class="meta">${i.tips}</div>
			</div>
			<div class="arrow"><i class="weui-icon-arrow"></i></div>
			</div>
			<div class="card-footer">${i.footer}</div>
		</a>
  	</div>`}renderMpcard(t){let n=ed(t.text);if(!n)return"<span>\u516C\u4F17\u53F7\u540D\u7247\u6570\u636E\u9519\u8BEF\uFF0C\u7F3A\u5C11id</span>";let{info:i,html:o}=n;return!i.headimg&&!i.nickname&&!i.signature?"<span>\u516C\u4F17\u53F7\u540D\u7247\u6570\u636E\u4E3A\u7A7A</span>":(nt.getInstance().setCardData(i.id,o),td({...i,nickname:i.nickname||$("render.mpcard-default-name"),signature:i.signature||$("render.mpcard-default-signature")}))}markedExtension(){return{extensions:[{name:"code",level:"block",renderer:t=>t.lang&&t.lang.trim().toLocaleLowerCase()=="mermaid"?t.html:t.lang&&t.lang.trim().toLocaleLowerCase()=="chart"?this.renderCharts(t):t.lang&&t.lang.trim().toLocaleLowerCase()=="one2mp-profile"?this.renderWewriteProfile(t):t.lang&&t.lang.trim().toLocaleLowerCase()=="mpcard"?this.renderMpcard(t):t.lang&&t.lang.trim().toLocaleLowerCase().startsWith("ad-")?t.html:this.codeRenderer(t.text,t.lang)}],async:!0,walkTokens:async t=>{if(t.lang&&t.lang.trim().toLocaleLowerCase()=="mermaid"&&await this.renderMermaidAsync(t),t.lang&&t.lang.trim().toLocaleLowerCase().startsWith("ad-")){let n=t.lang.trim().toLocaleLowerCase().replace("ad-","");n===""&&(n="note"),t.html=this.renderAdmonitionAsync(t,n)}}}}}});var li,od=j(()=>{Ge();li=class extends ke{constructor(){super(...arguments);this.mermaidIndex=0;this.admonitionIndex=0;this.chartsIndex=0}extractOne2MpCaptions(t){let n=/^wwcap:\s*(.*)$/gim,i=[],o;for(;(o=n.exec(t))!==null;)i.push(o[1].trim());return i}codespanRenderer(t){t=t.trim();let n=this.extractOne2MpCaptions(t);return n.length>0?`<div class="one2mp-image-caption">${n[0]}</div>`:`<span class="one2mp-codespan">${t}</span>`}markedExtension(){return{extensions:[{name:"codespan",level:"inline",renderer:t=>t.html}],walkTokens:t=>{t.type==="codespan"&&(t.html=this.codespanRenderer(t.text))}}}}});function ad(r){let e=/^pdf#page=(\d+)(&rect=.*?)$/,t=r.lastIndexOf("|");t>0&&(r=r.substring(0,t));let n=r.lastIndexOf(".");if(n==-1)return"note";let i=r.substring(n+1);if(e.test(i))return"pdf-crop";if(r.startsWith("https://mmbiz.qpic.cn/")||r.startsWith("http://mmbiz.qpic.cn/"))return"image";switch(i.toLocaleLowerCase()){case"md":return"note";case"png":case"jpg":case"jpeg":case"gif":case"bmp":return"image";case"webp":return"webp";case"svg":return"svg";case"pdf":return"pdf";case"mp4":return"video";case"mp3":case"wma":case"wav":case"amr":return"voice";case"excalidraw":return"excalidraw";default:return"file"}}var sd,jy,er,Xn,ld=j(()=>{sd=require("obsidian");Vn();Ge();Fe();fr();jy=/^!\[\[(.*?)\]\]/;er=class extends ke{constructor(){super(...arguments);this.index=0;this.videoIndex=0;this.voiceIndex=0;this.pdfCropIndex=0;this.embedMarkdownIndex=0;this.excalidrawIndex=0;this.markdownEmbedIndex=0}generateId(){return this.index+=1,`fid-${this.index}`}prepare(){return this.videoIndex=0,this.voiceIndex=0,this.pdfCropIndex=0,this.index=0,this.embedMarkdownIndex=0,this.excalidrawIndex=0,this.markdownEmbedIndex=0,Promise.resolve()}searchFile(t){let n=this.resolvePath(t),i=this.plugin.app.vault,o=i.config.attachmentFolderPath||"",a=n,s=null;if(s=i.getFileByPath(n),s||(s=i.getFileByPath(t),s)||o!=""&&(a=o+"/"+t,s=i.getFileByPath(a),s||(a=o+"/"+n,s=i.getFileByPath(a),s)))return s;let l=i.getAllLoadedFiles();for(let c of l)if(c.path.includes(t))return c;return null}resolvePath(t){let n=this.getActiveFileDir();if(!t.includes("/"))return t;let i=n.split("/"),o=t.split("/");i.pop();for(let a of o)a!=="."&&(a===".."?i.pop():i.push(a));return i.join("/")}getActiveFileDir(){let t=this.plugin.app.workspace.getActiveFile();if(t==null)return"";let n=t.path.split("/");return n.pop(),n.length==0?"":n.join("/")}getImagePath(t){if(t.startsWith("http"))return t;let n=this.searchFile(t);return n==null?(console.error("File not found"+t),""):n instanceof sd.TFile?this.plugin.app.vault.getResourcePath(n):""}isImage(t){return t=t.toLowerCase(),t.endsWith(".png")||t.endsWith(".jpg")||t.endsWith(".jpeg")||t.endsWith(".gif")||t.endsWith(".bmp")||t.endsWith(".webp")}parseImageLink(t){if(t.includes("|")){let n=t.split("|"),i=n[0];if(!this.isImage(i))return null;let o=null,a=null;if(n.length==2){let s=n[1].toLowerCase().split("x");o=parseInt(s[0]),s.length==2&&s[1]!=""&&(a=parseInt(s[1]))}return{path:i,width:o,height:a}}return{path:t,width:null,height:null}}getHeaderLevel(t){let n=t.trimStart().match(/^#{1,6}/);return n?n[0].length:0}async getFileContent(t,n,i){let o=await this.plugin.app.vault.adapter.read(t.path);if(n==null&&i==null)return o;let a="",s=o.split(`
`);if(n){let l=0,c=!1;for(let u of s){if(c){if(l==this.getHeaderLevel(u))break;a+=u+`
`;continue}if(!u.trim().startsWith("#"))continue;let d=u.trim().split(" ");d.length==2&&n.trim()==d[1].trim()&&this.getHeaderLevel(u)&&(a+=u+`
`,l=this.getHeaderLevel(u),c=!0)}}if(i)for(let l=0;l<s.length;l++){let c=s[l];if(c.indexOf(i)>=0){if(a=c.replace(i,""),a.trim()=="")for(let u=l-1;u>=0;u--){let d=s[u];if(d.trim()!=""){a=d;break}}break}}return a}parseFileLink(t){let i=t.split("|")[0].split("#"),o=i[0],a=null,s=null;return i.length==2&&(i[1].startsWith("^")?s=i[1]:a=i[1]),{path:o,head:a,block:s}}async renderFile(t){let{path:n,head:i,block:o}=this.parseFileLink(t),a=null;if(n===""?a=this.plugin.app.workspace.getActiveFile():(n.endsWith(".md")||(n=n+".md"),a=this.searchFile(n)),a==null){let u="File not found:"+n;console.error(u);return}let s=await this.getFileContent(a,i,o),{content:l}=Zt(s);return await this.marked.parse(l)}parseLinkStyle(t){let n="",i='style="width:100%;height:100%"',o="left",a=["left","center","right"];if(t.includes("|")){let s=t.split("|");n=s[0];let l="";if(s.length==2?a.includes(s[1])?o=s[1]:l=s[1]:s.length==3&&(l=s[1],a.includes(s[1])?(l=s[2],o=s[1]):(l=s[1],o=s[2])),l!=""){let c=l.split("x");c.length==2?i=`style="width:${c[0]}px;height:${c[1]}px;"`:i=`style="width:${c[0]}px;"`}}else n=t;return{filename:n,style:i,postion:o}}parseSVGLink(t){let n="note-embed-svg-left",i=new Map([["left","note-embed-svg-left"],["center","note-embed-svg-center"],["right","note-embed-svg-right"]]),{filename:o,style:a,postion:s}=this.parseLinkStyle(t);return n=i.get(s)||n,{filename:o,style:a,classname:n}}async renderSVGFile(t,n){let i=this.searchFile(t);if(i==null){let a=$("render.file-not-found")+i;console.error(a),this.previewRender.updateElementByID(n,a);return}let o=await this.getFileContent(i,null,null);er.fileCache.set(t,o),this.previewRender.updateElementByID(n,o)}markedExtension(){return{extensions:[{name:"Embed",level:"inline",start:t=>t.indexOf("![["),tokenizer:t=>{let n=t.match(jy);return n==null?void 0:{type:"Embed",raw:n[0],href:n[1],text:n[1]}},renderer:t=>{let n=ad(t.href);if(console.debug("render embed type:",t,n),n=="image"||n=="webp"){let i=this.parseImageLink(t.href);if(i){let o=this.getImagePath(i.path),a=i.width?`width="${i.width}"`:"",s=i.height?`height="${i.height}"`:"";return`<img src="${o}" alt="${t.text}" ${a} ${s} />`}}else if(n=="svg"){let i=this.parseSVGLink(t.href),o=this.generateId(),a=$("render.rendering");return er.fileCache.has(i.filename)?a=er.fileCache.get(i.filename)||$("render.render-failed"):this.renderSVGFile(i.filename,o),`<span class="${i.classname}"><span class="note-embed-svg" id="${o}" ${i.style}>${a}</span></span>`}else{if(n=="excalidraw")return t.html;if(n=="pdf-crop")return this.renderPdfCrop(t.href);if(n=="note")return t.html;if(n=="video")return this.renderVideo(t.href);if(n=="voice")return this.renderVoice(t.href)}}}],async:!0,walkTokens:async t=>{if(t.type!=="Embed")return;let n=ad(t.href);n==="excalidraw"?await this.renderExcalidrawAsync(t):n==="note"&&await this.renderMarkdownEmbedAsync(t)}}}async renderExcalidrawAsync(t){if(!this.isPluginInstlled("obsidian-excalidraw-plugin"))return!1;t.html=$("render.excalidraw-failed");let n=this.excalidrawIndex;this.excalidrawIndex++;let i=Ae.getInstance(this.plugin.app),o=i.queryElement(n,"div.excalidraw-svg");if(!o){console.error("renderExcalidrawAsync error:","root is null");return}o.removeAttribute("style");try{let a=o.querySelector("img");a&&(a.setAttr("width","100%"),a.setAttr("height","100%"),a.setAttr("style","width:100%;height:100%"));let s=await i.domToImage(o);t.html=`<section class="excalidraw" ><img src="${s}" class="exclaidraw-image" ></section>`}catch(a){console.error("renderExcalidrawAsync error:",a)}}async renderMarkdownEmbedAsync(t){let n=t.href,i=await this.renderFile(n);t.html=`<div class="markdown-embed inline-embed is-loaded">${i}</div>`}renderPdfCrop(t){if(!this.isPluginInstlled("pdf-plus"))return!1;let n=Ae.getInstance(this.plugin.app).queryElement(this.pdfCropIndex,".pdf-cropped-embed");return n?(this.pdfCropIndex++,`<section class="pdf-crop">${n.outerHTML}</section>`):$("render.pdf-crop-failed")}renderVideo(t){let n=Ae.getInstance(this.plugin.app).queryElement(this.videoIndex,"video");return n?(this.videoIndex++,`<section class="video">${n.outerHTML}</section>`):"render video failed"}renderVoice(t){let n=Ae.getInstance(this.plugin.app).queryElement(this.voiceIndex,"audio");return n?(this.voiceIndex++,`<section class="audio">${n.outerHTML}</section>`):"render voice failed"}},Xn=er;Xn.fileCache=new Map});var cd,ci,ud=j(()=>{Ge();cd=require("obsidian"),ci=class extends ke{postprocess(e){let t=(0,cd.sanitizeHTMLToDom)(e),n=createEl("div");n.appendChild(t);let i=n.querySelectorAll("h1, h2, h3, h4, h5, h6");for(let o of i){let a=o.textContent;o.empty(),o.createSpan({text:" ",cls:"one2mp-heading-prefix"}),o.createSpan({cls:"one2mp-heading-outbox"}).createSpan({text:a||"",cls:"one2mp-heading-leaf"}),o.createSpan({cls:"one2mp-heading-tail"})}return Promise.resolve(n.innerHTML)}markedExtension(){return{extensions:[]}}}});function Hy(){let r=globalThis.MathJax;return r!=null?r:null}function dd(r,e=!1){var n;let t=Hy();if(t!=null&&t.tex2svg){let i=t.tex2svg(r,{display:e}),o=(n=i.querySelector("svg"))!=null?n:i;return new XMLSerializer().serializeToString(o)}return zy(r)}var zy,fd=j(()=>{zy=r=>r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")});var hd,Uy,ui,pd=j(()=>{fd();Ge();hd=/^(\${1,2})(?!\$)((?:\\.|[^\\\n])*?(?:\\.|[^\\\n$]))\1/,Uy=/^(\${1,2})\n((?:\\[^]|[^\\])+?)\n\1(?:\n|$)/,ui=class extends ke{renderer(e,t,n=""){n===""&&(n="InlineMath");let i=dd(e.text,!t);return t?`<span  class="inline-math">${i}</span>`:`<section  class="block-math">${i}</section>`}markedExtension(){return{extensions:[this.inlineMath(),this.blockMath()]}}inlineMath(){return{name:"InlineMath",level:"inline",start(e){let t,n=e;for(;n;){if(t=n.indexOf("$"),t===-1)return;if(n.substring(t).match(hd))return t;n=n.substring(t+1).replace(/^\$+/,"")}},tokenizer(e){let t=e.match(hd);if(t)return{type:"InlineMath",raw:t[0],text:t[2].trim(),displayMode:t[1].length===2}},renderer:e=>this.renderer(e,!0)}}blockMath(){return{name:"BlockMath",level:"block",tokenizer(e){let t=e.match(Uy);if(t)return{type:"BlockMath",raw:t[0],text:t[2].trim(),displayMode:t[1].length===2}},renderer:e=>this.renderer(e,!1)}}}});var Vy,Wy,di,gd=j(()=>{Vn();Ge();Vy=/`(ris|fas):([a-z0-9-]+)`/i,Wy=/^`(ris|fas):([a-z0-9-]+)`/i,di=class extends ke{constructor(){super(...arguments);this.remixIndex=0}prepare(){return this.remixIndex=0,Promise.resolve()}render(){let t=Ae.getInstance(this.plugin.app).queryElement(this.remixIndex,".obsidian-icon.react-icon");return t?(this.remixIndex++,t.outerHTML):"<span>remix icon not found </span>"}markedExtension(){return{extensions:[{name:"remixIcon",level:"inline",start:t=>{let n=t.match(Vy);if(n)return n.index},tokenizer:t=>{let n=t.match(Wy);if(n)return{type:"remixIcon",raw:n[0],text:n[0].trim(),lang:n[1]}},renderer:()=>this.render()}]}}}});var fi,md=j(()=>{Ge();fi=class extends ke{markedExtension(){return{extensions:[{name:"table",level:"block",renderer:e=>{let t=(o,a)=>{var u;let s=o.align,l=s?` style="text-align:${s};"`:"",c=(u=o.tokens)!=null&&u.length?this.marked.Parser.parseInline(o.tokens):o.text;return`<${a}${l}>${c}</${a}>`},n=e.header.map(o=>t(o,"th")),i=e.rows.map(o=>`<tr>${o.map(s=>t(s,"td")).join("")}</tr>`);return`<section class="table-container"><table><thead><tr>${n.join("")}</tr></thead><tbody>${i.join("")}</tbody></table></section>`}}]}}}});var hi,vd=j(()=>{Ge();hi=class extends ke{markedExtension(){return{extensions:[{name:"footnote",level:"block",start:e=>{var t;return(t=e.match(/\[\^(\w+)\]:/))==null?void 0:t.index},tokenizer:e=>{let n=/^\[\^(\w+)\]:\s*(.*)/.exec(e);if(n)return{type:"footnote",raw:n[0],id:n[1],text:n[2],tokens:[]}},renderer:e=>{if(e.type==="footnote")return`<div id="footnote-${e.id}" class="footnote"><span class="footnote-id">\u3010${e.id}\u3011 </span>${e.text}</div>`}},{name:"footnoteMark",level:"inline",start:e=>{var t;return(t=e.match(/\[\^(\w+)\]/))==null?void 0:t.index},tokenizer:e=>{let n=/^\[\^(\w+)\]/.exec(e);if(n)return{type:"footnoteMark",raw:n[0],id:n[1],tokens:[]}},renderer:e=>{if(e.type==="footnoteMark")return`<a>${e.text}<sup>\u3010${e.id}\u3011</sup></a>`}}]}}}});var pi,yd=j(()=>{Ge();pi=class extends ke{constructor(){super(...arguments);this.allLinks=[]}prepare(){return this.allLinks=[],Promise.resolve()}postprocess(t){var a,s;if(!this.allLinks.length)return Promise.resolve(t);let n=[],i=new Map;for(let l of this.allLinks){let c=i.get(l.href);if(!c){let m={href:l.href,text:l.text};i.set(l.href,m),n.push(m);continue}let u=((a=c.text)==null?void 0:a.trim())||"",d=((s=l.text)==null?void 0:s.trim())||"";d&&d!==l.href&&(u===l.href||d.length>u.length)&&(c.text=d)}let o=n.map(l=>{var d;let c=(d=l.text)==null?void 0:d.trim();return`<li>${c&&c!==l.href?c:"\u5916\u94FE"}\uFF1A<a data-linktype="2" data-link="${l.href}" href="${l.href}">${l.href}</a>&nbsp;\u21A9</li>`});return Promise.resolve(`${t}<section class="foot-links"><hr class="foot-links-separator"><ol>${o.join("")}</ol></section>`)}markedExtension(){return{extensions:[{name:"link",level:"inline",renderer:t=>{let n=i=>i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;");if(t.href.startsWith("http")){let i=(t.text||"").trim(),o=n(t.href);return!i||i===t.href?`<strong>(${o})</strong>`:`${n(i)}<strong>(${o})</strong>`}else return`<a href="${t.href}">${t.text}</a>`}}]}}}});function Ky(r){return/^h[1-6]$/i.test(r.tagName)}function wd(r){return Ky(r)?parseInt(r.tagName.charAt(1),10):null}function Gy(r,e){let t=wd(e),n=wd(r);return n===null?!0:t===null||t>n}var bd,gi,xd=j(()=>{bd=require("obsidian");Ge();gi=class extends ke{processHeading(e,t){var a;let n=["h1","h2","h3","h4","h5","h6"],i=t.trim().toLowerCase();if(!n.includes(i))return e;let o=e.querySelectorAll(t.trim());for(let s=0;s<o.length;s++){let l=o[s];if(l){let c=createEl("details");c.createEl("summary",{text:(a=l.textContent)!=null?a:""});let u=l.nextSibling;for(;u&&Gy(l,u);){let d=u.nextSibling;c.appendChild(u),u=d}l.replaceWith(c)}}return e}postprocess(e){let t=this.previewRender.articleProperties.get("folded-headings");if(t===void 0||!t)return Promise.resolve(e);let n=(0,bd.sanitizeHTMLToDom)(e),i=createEl("div");i.appendChild(n);let o=t.split(",");for(let a of o)this.processHeading(i,a);return Promise.resolve(i.innerHTML)}markedExtension(){return{extensions:[]}}}});var tr,mi,_d=j(()=>{tr=require("obsidian");Ge();mi=class extends ke{isImageFile(e){if(!(e instanceof tr.TFile))return!1;let t=e.extension.toLowerCase();return["png","jpg","jpeg","gif","bmp","webp","svg"].includes(t)}findImageFile(e){var m,b,E,S,y;let t=this.plugin.app.vault,n=this.plugin.app.workspace.getActiveFile(),i=(b=(m=n==null?void 0:n.parent)==null?void 0:m.path)!=null?b:"",o="app://obsidian.md/",a=e.trim();if(a.startsWith(o)&&(a=decodeURIComponent(a.slice(o.length))),a=a.split("|")[0].split("?")[0].split("#")[0],!a)return null;let s=this.plugin.app.metadataCache.getFirstLinkpathDest(a,(E=n==null?void 0:n.path)!=null?E:"");if(this.isImageFile(s))return s;if(a.includes("/")){let g=a.split("/").pop()||a;if(s=this.plugin.app.metadataCache.getFirstLinkpathDest(g,(S=n==null?void 0:n.path)!=null?S:""),this.isImageFile(s))return s}let l=t.config,c=(y=l==null?void 0:l.attachmentFolderPath)!=null?y:"",u=a.split("/").pop()||a,d=[];if(!c||c===".")i?(d.push(`${i}/${a}`),d.push(`${i}/${u}`)):d.push(a,u);else if(c.startsWith("./")){let g=c.slice(2),h=i?`${i}/${g}`:g;d.push(`${h}/${a}`),d.push(`${h}/${u}`)}else d.push(`${c}/${a}`),d.push(`${c}/${u}`);for(let g of d)if(s=t.getAbstractFileByPath(g),this.isImageFile(s))return s;let f=t.getAllLoadedFiles();for(let g of f)if(g instanceof tr.TFile&&g.basename===u&&this.isImageFile(g))return g;return null}resolveImageSrc(e){let t=e.trim();if(!t||/^(https?:|data:)/i.test(t))return t;let n=this.findImageFile(t);return n?this.plugin.app.vault.getResourcePath(n):e}processImage(e){var n,i,o;let t=e.querySelectorAll("img");for(let a=0;a<t.length;a++){let s=t[a],l=(n=s.getAttribute("class"))==null?void 0:n.split(" ");if(l!=null&&l.includes("one2mp-avatar-image"))continue;let c=s.getAttribute("src");c&&s.setAttribute("src",this.resolveImageSrc(c));let d=((i=s.getAttribute("title"))==null?void 0:i.trim())||"",f=createEl("figure",{cls:"image-with-caption"});if((o=s.parentNode)==null||o.insertBefore(f,s),f.appendChild(s),d){let m=f.createEl("div",{cls:"image-caption-row"});m.createEl("div",{cls:"triangle"}),m.createEl("figcaption",{cls:"image-caption",text:d})}}return e}postprocess(e){let t=(0,tr.sanitizeHTMLToDom)(e),n=createEl("div");return n.appendChild(t),this.processImage(n),Promise.resolve(n.innerHTML)}markedExtension(){return{renderer:{image:e=>{let t=this.resolveImageSrc(e.href||""),n=e.text?`alt="${e.text}"`:'alt=""',i=e.title?` title="${e.title}"`:"";return`<img src="${t}" ${n}${i} />`}},extensions:[]}}}});var vi,Jy,kd,Sd=j(()=>{vi={header:{start:["%%hh%%","%%hh%"],end:["%%/hh%%","%%/hh%"]},footer:{start:["%%tt%%","%%tt%"],end:["%%/tt%%","%%/tt%"]}},Jy=r=>r.trim().toLowerCase(),kd=r=>r&&r.split(/\r?\n/).filter(n=>{let i=Jy(n);return![...vi.header.start,...vi.header.end,...vi.footer.start,...vi.footer.end].includes(i)}).join(`
`)});var Ed={};xt(Ed,{WechatRender:()=>jt});var Cd,Qy,Zy,Nt,jt,ba=j(()=>{Gu();Cd=require("obsidian");Un();Xu();id();od();ld();ud();pd();gd();md();vd();yd();xd();_d();Sd();fr();Qy={gfm:!0,breaks:!0},Zy=r=>{let e=r.split(/\r?\n/),t=o=>/^[\t ]*([-*_])\1\1+[\t ]*$/.test(o),n=o=>{let a=o.trim();return a?/^!\[\[.+\]\]$/.test(a)?!0:/^!\[[^\]]*]\([^)]+\)$/.test(a):!1},i=[];for(let o=0;o<e.length;o+=1){let a=e[o];t(a)&&o>0&&n(e[o-1])&&i.length&&i[i.length-1].trim()!==""&&i.push(""),i.push(a)}return i.join(`
`)},Nt=class{constructor(e,t){this.extensions=[];this.delayParse=e=>new Promise((t,n)=>{setTimeout(()=>{this.plugin.app.vault.adapter.read(e).then(i=>this.parse(i)).then(i=>this.postprocess(i)).then(t).catch(i=>{let o=i instanceof Error?i:new Error(String(i));n(o)})},100)});this.plugin=e,this.previewRender=t,this.client=tt.getInstance(e),this.marked=new Qn,this.marked.use(Qy),this.marked.use({renderer:{list(n){let i="";if(n.items)for(let s of n.items)i+=this.listitem(s);let o=n.ordered?"ol":"ul",a=n.ordered&&n.start!==1?' start="'+n.start+'"':"";return"<"+o+a+' class="list-paddingleft-1">'+i+"</"+o+">"},listitem(n){return`<li><section>${n.tokens?this.parser.parse(n.tokens):n.text||""}</section></li>`}}}),this.useExtensions()}static getInstance(e,t){return Nt.instance||(Nt.instance=new Nt(e,t)),Nt.instance}static resetInstance(){Nt.instance=null}addExtension(e){this.extensions.push(e),this.marked.use(e.markedExtension())}useExtensions(){this.addExtension(new hi(this.plugin,this.previewRender,this.marked)),this.addExtension(new ci(this.plugin,this.previewRender,this.marked)),this.addExtension(new Xn(this.plugin,this.previewRender,this.marked)),this.addExtension(new si(this.plugin,this.previewRender,this.marked)),this.addExtension(new li(this.plugin,this.previewRender,this.marked)),this.addExtension(new ui(this.plugin,this.previewRender,this.marked)),this.addExtension(new di(this.plugin,this.previewRender,this.marked)),this.addExtension(new oi(this.plugin,this.previewRender,this.marked)),this.addExtension(new fi(this.plugin,this.previewRender,this.marked)),this.addExtension(new pi(this.plugin,this.previewRender,this.marked)),this.addExtension(new gi(this.plugin,this.previewRender,this.marked)),this.addExtension(new mi(this.plugin,this.previewRender,this.marked))}async parse(e){let{content:t}=Zt(e),n=kd(t),i=Zy(n);for(let o of this.extensions)await o.prepare();return await this.marked.parse(i)}async postprocess(e){let t=e;for(let n of this.extensions)t=await n.postprocess(t);return t=this.removeEmptyListItems(t),t}removeEmptyListItems(e){let t=document.createElement("div");return t.appendChild((0,Cd.sanitizeHTMLToDom)(e)),t.querySelectorAll("ol li, ul li").forEach(n=>{let i=n.querySelector("img, video, figure"),o=n.innerHTML.replace(/<br\s*\/?>/gi,"").replace(/&nbsp;/gi,"").replace(/\u00A0/g,"").replace(/<span[^>]*>\s*<\/span>/gi,"").replace(/<section[^>]*>\s*<\/section>/gi,"").replace(/<div[^>]*>\s*<\/div>/gi,"").replace(/[\s\u200B-\u200D]+/g,"").trim();!i&&o===""&&n.remove()}),t.innerHTML}async parseNote(e){let t=await this.plugin.app.vault.adapter.read(e),n=await this.parse(t);return n=await this.postprocess(n),n}},jt=Nt;jt.instance=null});var xa,wn,Td=j(()=>{xa=require("obsidian"),wn=class{constructor(e){this.app=e}parseObsidianUrl(e){let t=/obsidian:\/\/open\?vault=(.*?)&file=([^,]*),?(.*)$/,n=e.match(t);return n&&n[2]?decodeURIComponent(n[2]):null}getFileFromPath(e){let t=this.app.vault.getAbstractFileByPath(e);return t instanceof xa.TFile?t:null}getDisplayUrl(e){if(e)try{return this.app.vault.getResourcePath(e)}catch(t){console.error("Error reading file:",t)}return null}getInternalLinkDisplayUrl(e){let t=this.parseObsidianUrl(e);if(t){let n=this.getFileFromPath(t);if(n)return this.getDisplayUrl(n)}return null}}});var De,Pe,nr,_a,Ad,Pd=j(()=>{De={title:"\u6807\u9898",author:"\u4F5C\u8005",digest:"\u6458\u8981",sourceUrl:"\u539F\u6587\u94FE\u63A5",cover:"\u5C01\u9762\u56FE",openComment:"\u5F00\u542F\u8BC4\u8BBA",onlyFans:"\u4EC5\u7C89\u4E1D\u53EF\u8BC4\u8BBA"},Pe={title:[De.title,"title"],author:[De.author,"author"],digest:[De.digest,"digest","description","summary"],sourceUrl:[De.sourceUrl,"content_source_url","source_url"],cover:[De.cover,"cover","thumbnail","one2mp_cover"],openComment:[De.openComment,"need_open_comment","open_comment"],onlyFans:[De.onlyFans,"only_fans_can_comment"]},nr=(r,e)=>{if(r)for(let t of e){let n=r[t];if(typeof n=="string"&&n.trim()!=="")return n.trim()}},_a=(r,e)=>{if(!r)return;let t=new Set(["1","true","yes","y","on","\u662F","\u5F00\u542F","\u5F00"]),n=new Set(["0","false","no","n","off","\u5426","\u5173\u95ED","\u5173"]);for(let i of e){let o=r[i];if(typeof o=="boolean")return o?1:0;if(typeof o=="number")return o>0?1:0;if(typeof o=="string"){let a=o.trim().toLowerCase();if(t.has(a))return 1;if(n.has(a))return 0}}},Ad=r=>{if(!r)return null;for(let e of Pe.cover){let t=r[e];if(typeof t=="string"&&t.trim()!=="")return t.trim()}return null}});var ye,yi,ka,Id=j(()=>{ye=require("obsidian");Hn();Td();en();Un();Fe();Mi();Pd();yi=class{constructor(e,t){this.coverImageRef=null;this.coverImageWrap=null;this.coverImageEl=null;this.coverNaturalWidth=0;this.coverNaturalHeight=0;this.coverTransform={scale:1,offsetX:0,offsetY:0};this.coverResizeObserver=null;this.coverFrontmatterKey=De.cover;this.coverVaultPrefix="vault:";this.coverImageExtensions=["png","jpg","jpeg","gif","webp","bmp","svg","tiff"];this.plugin=e,this.localDraftmanager=bt.getInstance(e),this.BuildUI(t),this.coverResizeDebounced=(0,ye.debounce)(()=>this.handleCoverFrameResize(),80),typeof ResizeObserver!="undefined"&&(this.coverResizeObserver=new ResizeObserver(()=>{this.coverResizeDebounced()}),this.coverResizeObserver.observe(this.coverFrame)),this.plugin.messageService.registerListener("wechat-account-changed",()=>{this.updateLocalDraft()}),this.plugin.messageService.registerListener("active-file-changed",()=>{this.updateLocalDraft()}),this.plugin.messageService.registerListener("set-draft-cover-image",n=>{this.coverImageRef=n,this.cover_image=this.resolveCoverUrl(n),this.resetCoverCropState(this.coverImageRef),this.setCoverImage(this.cover_image),this.saveCoverToFrontmatter(this.coverImageRef),this.activeLocalDraft&&(this.activeLocalDraft.thumb_media_id=void 0,this.localDraftmanager.setDraft(this.activeLocalDraft))}),this.plugin.messageService.registerListener("set-image-as-cover",n=>{this.coverImageRef=n.url,this.cover_image=this.resolveCoverUrl(n.url),this.resetCoverCropState(this.coverImageRef),this.setCoverImage(this.cover_image),this.saveCoverToFrontmatter(this.coverImageRef),this.activeLocalDraft&&(this.activeLocalDraft.thumb_media_id=n.media_id,this.localDraftmanager.setDraft(this.activeLocalDraft))}),this.updateLocalDraft()}updateDraftDraftId(e){this.activeLocalDraft!==void 0&&(this.activeLocalDraft.last_draft_id=e)}resetCoverTransform(){this.coverTransform={scale:1,offsetX:0,offsetY:0}}async resetCoverCropState(e){this.activeLocalDraft&&(delete this.activeLocalDraft.cover_crop_scale,delete this.activeLocalDraft.cover_crop_offset_x,delete this.activeLocalDraft.cover_crop_offset_y,delete this.activeLocalDraft.pic_crop_235_1,delete this.activeLocalDraft.pic_crop_1_1,e!==void 0?this.activeLocalDraft.cover_crop_ref=e||void 0:delete this.activeLocalDraft.cover_crop_ref,await this.localDraftmanager.setDraft(this.activeLocalDraft))}restoreCoverTransform(){this.resetCoverTransform()}applyCoverTransform(e=!1){!this.coverImageEl||!this.coverImageWrap||(this.coverImageWrap.setCssProps({left:"0",top:"0",width:"100%",height:"100%",transform:"none"}),this.coverImageEl.setCssProps({width:"100%",height:"100%","object-fit":"cover"}))}handleCoverFrameResize(){this.coverImageEl&&this.applyCoverTransform(!1)}onNoteRename(e){let t=this.plugin.app.workspace.getActiveFile();t===void 0||e!==t||this.activeLocalDraft!==void 0&&(this.activeLocalDraft.notePath=e.path,bt.getInstance(this.plugin).setDraft(this.activeLocalDraft))}getActiveLocalDraft(){return this.activeLocalDraft}getRootEl(){return this.rootEl}BuildUI(e){this.rootEl=e.createDiv({cls:"one2mp-meta-card"});let t=this.rootEl.createDiv({cls:"one2mp-cover-container"});t.createDiv({cls:"one2mp-cover-hint",text:$("views.article-header.cover-image-description")}),this.coverFrame=this.createCoverFrame(t),ye.Platform.isMobile&&t.createDiv({cls:"one2mp-cover-mobile-action"}).createEl("button",{cls:"one2mp-cover-mobile-button",text:$("views.article-header.cover-image-mobile-button")}).addEventListener("click",()=>{this.openMobileCoverModal()});let n=this.rootEl.createDiv({cls:"one2mp-digest-container"});this.digestInput=new ye.TextAreaComponent(n),this.digestInput.setPlaceholder($("views.article-header.digest-text")),this.digestInput.inputEl.rows=4,this.digestInput.inputEl.addClass("one2mp-digest-input"),this.digestInput.onChange(i=>{let o=this.activeLocalDraft;o&&(o.digest=i,(async()=>(await this.localDraftmanager.setDraft(o),await this.saveDigestToFrontmatter(i)))())})}async saveDigestToFrontmatter(e){let t=this.getActiveMarkdownFile();t&&await this.plugin.app.fileManager.processFrontMatter(t,n=>{n[De.digest]=e,n[Pe.digest[0]]&&Pe.digest[0]!==De.digest&&delete n[Pe.digest[0]]})}getActiveMarkdownFile(){let e=this.plugin.app.workspace.getActiveFile();return!e||e.extension!=="md"&&e.extension!=="markdown"?null:e}getCoverFromFrontmatter(){var n,i;let e=this.getActiveMarkdownFile();if(!e)return null;let t=(i=(n=this.plugin.app.metadataCache.getFileCache(e))==null?void 0:n.frontmatter)!=null?i:null;return Ad(t)}getVaultRelativePathFromAbsolute(e){let t=this.plugin.app.vault.adapter;if(!(t instanceof ye.FileSystemAdapter))return null;let n=t.getBasePath();if(!e.startsWith(n))return null;let i=e.slice(n.length);return(i.startsWith("/")||i.startsWith("\\"))&&(i=i.slice(1)),i.replace(/\\/g,"/")}getActiveRootFolder(){let e=this.getActiveMarkdownFile();if(!e)return null;let t=e.path.split("/");return t.length<=1?null:t[0]||null}getVaultPathCandidates(e){let t=e.replace(/^\/+/,""),n=[t],i=this.getActiveRootFolder();return i&&!t.startsWith(`${i}/`)&&n.push(`${i}/${t}`),n}resolveCoverUrl(e){if(!e||!e.trim())return null;let t=e.trim();if(t.startsWith(this.coverVaultPrefix)){let i=t.slice(this.coverVaultPrefix.length);for(let o of this.getVaultPathCandidates(i)){let a=this.plugin.app.vault.getAbstractFileByPath(o);if(a instanceof ye.TFile)return this.plugin.app.vault.getResourcePath(a)}return null}if(t.startsWith("obsidian://")){let o=new wn(this.plugin.app).parseObsidianUrl(t);if(o){let a=this.plugin.app.vault.getAbstractFileByPath(o);if(a instanceof ye.TFile)return this.plugin.app.vault.getResourcePath(a)}}let n=this.plugin.app.vault.getAbstractFileByPath(t);return n instanceof ye.TFile?this.plugin.app.vault.getResourcePath(n):t}getCoverFileFromRef(e){if(!e||!e.trim())return null;let t=e.trim();if(t.startsWith(this.coverVaultPrefix)){let i=t.slice(this.coverVaultPrefix.length);for(let o of this.getVaultPathCandidates(i)){let a=this.plugin.app.vault.getAbstractFileByPath(o);if(a instanceof ye.TFile)return a}return null}if(t.startsWith("obsidian://")){let o=new wn(this.plugin.app).parseObsidianUrl(t);if(o){let a=this.plugin.app.vault.getAbstractFileByPath(o);return a instanceof ye.TFile?a:null}}let n=this.plugin.app.vault.getAbstractFileByPath(t);return n instanceof ye.TFile?n:null}async saveCoverToFrontmatter(e){let t=this.getActiveMarkdownFile();t&&await this.plugin.app.fileManager.processFrontMatter(t,n=>{if(e&&e.trim()!==""){n[this.coverFrontmatterKey]=e;for(let i of Pe.cover)i!==this.coverFrontmatterKey&&delete n[i]}else for(let i of Pe.cover)delete n[i]})}createCoverFrame(e){let t=e.createDiv({cls:"cover-frame",attr:{droppable:!0}});return t.ondragenter=n=>{n.preventDefault(),t.addClass("image-on-dragover")},t.ondragleave=n=>{n.preventDefault(),t.removeClass("image-on-dragover")},t.ondragover=n=>{n.preventDefault()},t.addEventListener("drop",n=>{this.handleCoverDrop(n,t)}),t}async handleCoverDrop(e,t){var o,a,s,l,c;e.preventDefault();let n=e.dataTransfer,i=(a=(o=n==null?void 0:n.getData("text/uri-list"))==null?void 0:o.trim())!=null?a:"";if(i||(i=(l=(s=n==null?void 0:n.getData("text/plain"))==null?void 0:s.trim())!=null?l:""),i.includes(`
`)&&(i=(c=i.split(/\r?\n/).map(d=>d.trim()).filter(d=>d&&!d.startsWith("#"))[0])!=null?c:""),this.activeLocalDraft||await this.updateLocalDraft(),i){let u=null,d=null;if(i.startsWith("obsidian://")){let m=new wn(this.plugin.app).parseObsidianUrl(i);m&&(u=`${this.coverVaultPrefix}${m}`,d=this.resolveCoverUrl(u))}else if(i.startsWith("http")||i.startsWith("https")){if(u=i,d=i,this.activeLocalDraft){let f=await this.getCoverImageMediaId(i);f?(t.setAttr("data-media_id",f),this.activeLocalDraft.thumb_media_id=f):(t.removeAttribute("data-media_id"),this.activeLocalDraft.thumb_media_id=void 0)}}else if(i.startsWith("file://")){let f=decodeURIComponent(i.replace("file://","")),m=this.getVaultRelativePathFromAbsolute(f);m?(u=`${this.coverVaultPrefix}${m}`,d=this.resolveCoverUrl(u)):ye.Platform.isMobile?(new ye.Notice($("views.article-header.cover-file-not-supported")),u=null,d=""):(u=i,d=i)}else this.plugin.app.vault.getAbstractFileByPath(i)instanceof ye.TFile?(u=`${this.coverVaultPrefix}${i}`,d=this.resolveCoverUrl(u)):(u=null,d="",this.setCoverImageXY());this.activeLocalDraft!==void 0&&(this.activeLocalDraft.cover_image_url=u||"",await this.localDraftmanager.setDraft(this.activeLocalDraft)),this.coverImageRef=u,this.cover_image=d,await this.resetCoverCropState(u),await this.saveCoverToFrontmatter(this.coverImageRef),this.setCoverImage(this.cover_image||"")}t.removeClass("image-on-dragover")}openMobileCoverModal(){new ka(this.plugin,this.coverImageExtensions,async e=>{let{filePath:t,url:n}=e,i=null;t?i=`${this.coverVaultPrefix}${t}`:n&&(i=n),await this.applyCoverRef(i)}).open()}async applyCoverRef(e){let t=e?this.resolveCoverUrl(e):"";this.activeLocalDraft&&(this.activeLocalDraft.cover_image_url=e||"",this.activeLocalDraft.thumb_media_id=void 0,await this.localDraftmanager.setDraft(this.activeLocalDraft)),this.coverImageRef=e,this.cover_image=t,await this.resetCoverCropState(e),await this.saveCoverToFrontmatter(this.coverImageRef),this.setCoverImage(this.cover_image||"")}setCoverImage(e){var a,s;for(;this.coverFrame.firstChild;)this.coverFrame.firstChild.remove();if(this.coverImageEl=null,this.coverImageWrap=null,this.coverNaturalWidth=0,this.coverNaturalHeight=0,!e){(a=this.coverFrame.parentElement)==null||a.removeClass("has-image");return}(s=this.coverFrame.parentElement)==null||s.addClass("has-image");let t=new Image;t.decoding="async",t.loading="lazy";let n=document.createElement("div");n.className="one2mp-cover-image-wrap",t.className="one2mp-cover-image",n.appendChild(t),this.coverFrame.appendChild(n),this.coverImageWrap=n,this.coverImageEl=t;let i=!1,o=()=>{i||(i=!0,this.coverNaturalWidth=t.naturalWidth||t.width,this.coverNaturalHeight=t.naturalHeight||t.height,this.resetCoverTransform(),this.restoreCoverTransform(),this.applyCoverTransform(!1))};t.onload=o,t.src=e,t.complete&&t.naturalWidth&&o()}resetImage(){this.setCoverImageXY(0,0)}async checkCoverImage(){if(await this.syncDraftFromFrontmatter(),this.activeLocalDraft!==void 0)if(this.activeLocalDraft.thumb_media_id===void 0||!this.activeLocalDraft.thumb_media_id){let e=this.coverImageRef||this.cover_image;if(e){let t=await this.getCoverImageMediaId(e,!0);return this.activeLocalDraft.thumb_media_id=t,!0}}else return!0;return!1}async getCoverImageMediaId(e,t=!1){let n;if(t){let i,o=this.getCoverFileFromRef(e);if(o){let s=await this.plugin.app.vault.readBinary(o);i=new Blob([s])}else{let s=this.resolveCoverUrl(e);i=await Cn(s||e,this.plugin.app)}if(i===void 0||!i)return;let a=await tt.getInstance(this.plugin).uploadMaterial(i,"banner-cover.png","image");if(a){let{errcode:s,media_id:l}=a;if(s!==0){new ye.Notice($("views.article-header.upload-cover-image-error"));return}else n=l}}return n}setCoverImageXY(e=0,t=0){if(!this.coverImageEl){this.setCoverImage(this.cover_image);return}this.applyCoverTransform(!1)}getFrontmatter(){var t,n;let e=this.getActiveMarkdownFile();return e&&(n=(t=this.plugin.app.metadataCache.getFileCache(e))==null?void 0:t.frontmatter)!=null?n:null}async migrateFrontmatterKeys(){let e=this.getActiveMarkdownFile();if(!e)return;let t=this.getFrontmatter();if(!t)return;let n=[{canonical:De.title,aliases:Pe.title},{canonical:De.author,aliases:Pe.author},{canonical:De.digest,aliases:Pe.digest},{canonical:De.sourceUrl,aliases:Pe.sourceUrl},{canonical:De.cover,aliases:Pe.cover},{canonical:De.openComment,aliases:Pe.openComment},{canonical:De.onlyFans,aliases:Pe.onlyFans}];n.some(o=>o.aliases.some(a=>a!==o.canonical&&t[a]!==void 0))&&await this.plugin.app.fileManager.processFrontMatter(e,o=>{for(let a of n)if(o[a.canonical]===void 0){for(let s of a.aliases)if(s!==a.canonical&&o[s]!==void 0){o[a.canonical]=o[s],delete o[s];break}}else for(let s of a.aliases)s!==a.canonical&&o[s]!==void 0&&delete o[s]})}async syncDraftFromFrontmatter(){if(!this.activeLocalDraft)return;let e=this.getFrontmatter(),t=this.getActiveMarkdownFile(),n=nr(e,Pe.title)||(t==null?void 0:t.basename)||this.activeLocalDraft.title||"",i=nr(e,Pe.author),o=nr(e,Pe.digest),a=nr(e,Pe.sourceUrl),s=_a(e,Pe.openComment),l=_a(e,Pe.onlyFans);this.activeLocalDraft.title=n,this.activeLocalDraft.author=i,this.activeLocalDraft.digest=o,this.digestInput&&this.digestInput.setValue(o||""),this.activeLocalDraft.content_source_url=a,s!==void 0?this.activeLocalDraft.need_open_comment=s:this.activeLocalDraft.need_open_comment===void 0&&(this.activeLocalDraft.need_open_comment=1),l!==void 0?this.activeLocalDraft.only_fans_can_comment=l:this.activeLocalDraft.only_fans_can_comment===void 0&&(this.activeLocalDraft.only_fans_can_comment=0),await this.localDraftmanager.setDraft(this.activeLocalDraft),this.plugin.messageService.sendMessage("draft-title-updated",n)}async updateLocalDraft(){return this.activeLocalDraft=await this.localDraftmanager.getDrafOfActiveNote(),await this.updateHeaderProporties(),!0}async updateHeaderProporties(){await this.migrateFrontmatterKeys();let t=this.getCoverFromFrontmatter();this.activeLocalDraft!==void 0&&(await this.syncDraftFromFrontmatter(),!t&&this.activeLocalDraft.cover_image_url&&(t=this.activeLocalDraft.cover_image_url),this.activeLocalDraft.cover_image_url=t||"",this.activeLocalDraft.cover_crop_ref!==(t||"")&&await this.resetCoverCropState(t||void 0),await this.localDraftmanager.setDraft(this.activeLocalDraft));let n=t||"",i=this.coverImageRef||"",o=n!==i;this.coverImageRef=n,this.cover_image=this.resolveCoverUrl(this.coverImageRef),o||!this.coverImageEl?this.setCoverImage(this.cover_image):this.setCoverImageXY()}},ka=class extends ye.Modal{constructor(t,n,i){super(t.app);this.plugin=t;this.imageExtensions=n;this.onSubmit=i}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h3",{text:$("views.article-header.cover-image-mobile-title")}),new ye.Setting(t).setName($("views.article-header.cover-image-mobile-vault")).setDesc($("views.article-header.cover-image-mobile-vault-desc")).addText(a=>{this.fileInput=a,this.fileInput.setPlaceholder($("views.article-header.cover-image-mobile-vault-placeholder")),new Qt(this.plugin.app,this.fileInput.inputEl,this.imageExtensions)}),new ye.Setting(t).setName($("views.article-header.cover-image-mobile-url")).setDesc($("views.article-header.cover-image-mobile-url-desc")).addText(a=>{this.urlInput=a,this.urlInput.setPlaceholder("https://")});let o=t.createDiv("modal-button-container");o.createEl("button",{text:$("modals.confirm")}).addEventListener("click",()=>{var c,u;let a=(c=this.fileInput)==null?void 0:c.getValue().trim(),s=(u=this.urlInput)==null?void 0:u.getValue().trim();if(!a&&!s){new ye.Notice($("views.article-header.cover-image-mobile-required"));return}let l=null;if(a){let d=this.plugin.app.vault.getAbstractFileByPath(a);if(!(d instanceof ye.TFile)){new ye.Notice($("views.article-header.cover-image-mobile-invalid"));return}l=d.path}this.onSubmit({filePath:l,url:s||null}),this.close()}),o.createEl("button",{text:$("modals.cancel")}).addEventListener("click",()=>{this.close()})}onClose(){this.contentEl.empty()}}});var Re,wi,$d=j(()=>{Re=require("obsidian");Fe();Hn();wi=class extends Re.Modal{constructor(t,n){super(t);this.plugin=n,this.updateCurrentAccount()}updateCurrentAccount(){let t=this.plugin.settings.selectedMPAccount;t&&(this.account=this.plugin.getMPAccountByName(t))}onOpen(){let{contentEl:t}=this;if(t.empty(),t.addClass("one2mp-publish-modal"),t.createEl("h2",{text:$("publish-config.title")}),!this.account){new Re.Notice($("wechat-api.select-an-wechat-mp-account-first")),this.close();return}this.renderMPCardSection(t),this.renderOtherSettings(t)}renderMPCardSection(t){let n=t.createEl("details",{cls:"one2mp-config-section"});n.open=!0,n.createEl("summary",{text:$("publish-config.mp-card-settings")});let i=n.createDiv({cls:"one2mp-config-content"}),o=i.createDiv({cls:"one2mp-card-preview"});this.renderCardPreview(o);let a=i.createDiv({cls:"one2mp-card-parser"});a.createEl("p",{text:$("publish-config.paste-html-guide"),cls:"setting-item-description"});let s=new Re.TextAreaComponent(a);s.setPlaceholder("<mp-common-profile ... >"),s.inputEl.rows=3,s.inputEl.setCssProps({width:"100%"});let c=a.createDiv({cls:"one2mp-parser-actions"}).createEl("button",{text:$("publish-config.parse-and-save")});c.onclick=()=>{let f=s.getValue();this.parseAndSaveCard(f)?(s.setValue(""),this.renderCardPreview(o),new Re.Notice($("publish-config.card-updated"))):new Re.Notice($("publish-config.parse-failed"))};let u=i.createEl("details",{cls:"one2mp-manual-edit"});u.createEl("summary",{text:$("publish-config.manual-edit")});let d=u.createDiv();this.renderManualFields(d,o)}renderCardPreview(t){t.empty();let n=this.plugin.settings.defaultMpcard;if(n&&n.includes("```mpcard")){let i=n.replace(/```mpcard|```/g,"").trim().split(`
`),o={};i.forEach(c=>{let[u,...d]=c.split(":");u&&d&&(o[u.trim()]=d.join(":").trim())});let a=t.createDiv({cls:"one2mp-mpcard-wrapper"});a.setCssProps({"max-width":"100%"});let s=a.createDiv({cls:"one2mp-mpcard-content"});if(o.headimg){let c=s.createEl("img",{cls:"one2mp-mpcard-headimg"});c.src=o.headimg}let l=s.createDiv({cls:"one2mp-mpcard-info"});l.createDiv({cls:"one2mp-mpcard-nickname",text:o.nickname||"No Nickname"}),l.createDiv({cls:"one2mp-mpcard-signature",text:o.signature||"No Signature"})}else t.createDiv({text:$("publish-config.mpcard-empty"),cls:"setting-item-description"})}parseAndSaveCard(t){let n=t.match(/data-nickname="([^"]*)"/),i=t.match(/data-headimg="([^"]*)"/),o=t.match(/data-signature="([^"]*)"/),a=t.match(/data-id="([^"]*)"/);return!n&&!i?!1:(n&&(this.plugin.settings.defaultMpcardNickname=n[1]),i&&(this.plugin.settings.defaultMpcardHeadimg=i[1]),o&&(this.plugin.settings.defaultMpcardSignature=o[1]),a&&(this.plugin.settings.defaultMpcardId=a[1]),this.saveSettings(),!0)}saveSettings(){var s,l,c,u;let t=[],n=(s=this.plugin.settings.defaultMpcardId)==null?void 0:s.trim(),i=(l=this.plugin.settings.defaultMpcardHeadimg)==null?void 0:l.trim(),o=(c=this.plugin.settings.defaultMpcardNickname)==null?void 0:c.trim(),a=(u=this.plugin.settings.defaultMpcardSignature)==null?void 0:u.trim();n&&t.push(`id: ${n}`),i&&t.push(`headimg: ${i}`),o&&t.push(`nickname: ${o}`),a&&t.push(`signature: ${a}`),t.length>0?this.plugin.settings.defaultMpcard=["```mpcard",...t,"```"].join(`
`):this.plugin.settings.defaultMpcard="",this.plugin.saveSettings()}renderManualFields(t,n){new Re.Setting(t).setName($("settings.default-mpcard-nickname")).setClass("one2mp-setting-wide").addText(i=>i.setValue(this.plugin.settings.defaultMpcardNickname||"").onChange(o=>{this.plugin.settings.defaultMpcardNickname=o,this.saveSettings(),this.renderCardPreview(n)})),new Re.Setting(t).setName($("settings.default-mpcard-headimg")).setClass("one2mp-setting-wide").addText(i=>i.setValue(this.plugin.settings.defaultMpcardHeadimg||"").onChange(o=>{this.plugin.settings.defaultMpcardHeadimg=o,this.saveSettings(),this.renderCardPreview(n)})),new Re.Setting(t).setName($("settings.default-mpcard-signature")).setClass("one2mp-setting-wide").addTextArea(i=>i.setValue(this.plugin.settings.defaultMpcardSignature||"").setPlaceholder("...").onChange(o=>{this.plugin.settings.defaultMpcardSignature=o,this.saveSettings(),this.renderCardPreview(n)})),t.findAll("textarea").forEach(i=>i.rows=4),new Re.Setting(t).setName($("settings.default-mpcard-biz-id")).setDesc($("settings.default-mpcard-biz-id-desc")).setClass("one2mp-setting-wide").addText(i=>i.setValue(this.plugin.settings.defaultMpcardId||"").onChange(o=>{this.plugin.settings.defaultMpcardId=o,this.saveSettings()}))}renderOtherSettings(t){let n=t.createEl("details",{cls:"one2mp-config-section"});n.createEl("summary",{text:$("publish-config.other-settings")});let i=n.createDiv({cls:"one2mp-config-content"});new Re.Setting(i).setName($("settings.draft-previewer-wechat-id")).setDesc($("settings.draft-only-visible-for-the-wechat-user-o")).addText(a=>a.setValue(this.plugin.settings.previewer_wxname||"").onChange(s=>{this.plugin.settings.previewer_wxname=s,this.plugin.saveSettings()})).addButton(a=>{a.setButtonText($("views.preview-draft")).setIcon("eye").setTooltip($("settings.preview-draft-tooltip")).onClick(()=>{(async()=>{var u;if(!((u=this.plugin.settings.previewer_wxname)!=null&&u.trim())){new Re.Notice($("views.previewer.preview-draft-missing-wxid"));return}let s=await bt.getInstance(this.plugin).getDrafOfActiveNote(),l=s==null?void 0:s.last_draft_id;if(!l){new Re.Notice($("views.previewer.preview-draft-missing-id"));return}await this.plugin.wechatClient.senfForPreview(l)&&new Re.Notice($("views.previewer.preview-draft-sent"))})()})})}onClose(){let{contentEl:t}=this;t.empty()}}});var Dd={};xt(Dd,{ThemeSelector:()=>Sa});var Od,Sa,Md=j(()=>{Od=require("obsidian");Sn();Fe();Sa=class{constructor(e){this.plugin=e,this._themeManager=Yt.getInstance(e),this.plugin.messageService.registerListener("custom-theme-folder-changed",()=>{this.updateThemeOptions()})}async dropdown(e){this._themeDropdown=e,await this.updateThemeOptions(),e.onChange(t=>{this.plugin.settings.custom_theme=t,this.plugin.saveSettings(),this.plugin.messageService.sendMessage("custom-theme-changed",t)})}async updateThemeOptions(){let e=await this._themeManager.loadThemes();this._themeDropdown.selectEl.length=0,this._themeDropdown.addOption("--default--",$("views.theme-manager.default-theme")),e.forEach(t=>{this._themeDropdown.addOption(t.path,t.name)}),this.plugin.settings.custom_theme===void 0||!this.plugin.settings.custom_theme?this._themeDropdown.setValue("--default--"):this._themeDropdown.setValue(this.plugin.settings.custom_theme)}onThemeChange(e){e instanceof Od.TFile&&e.extension==="md"&&e.path.startsWith(this.plugin.settings.css_styles_folder)&&this.updateThemeOptions()}startWatchThemes(){this.plugin.registerEvent(this.plugin.app.vault.on("rename",e=>{this.onThemeChange(e)})),this.plugin.registerEvent(this.plugin.app.vault.on("modify",e=>{this.onThemeChange(e)})),this.plugin.registerEvent(this.plugin.app.vault.on("create",e=>{this.onThemeChange(e)})),this.plugin.registerEvent(this.plugin.app.vault.on("delete",e=>{this.onThemeChange(e)}))}}});var Ld={};xt(Ld,{PreviewPanel:()=>Ea,VIEW_TYPE_ONE2MP_PREVIEW:()=>Ca});var me,Ca,Ea,Rd=j(()=>{me=require("obsidian");Fe();Vn();$u();ia();ba();Ei();Un();Id();$d();Ca="one2mp-article-preview",Ea=class extends me.ItemView{constructor(t,n){super(t);this.markdownView=null;this.listeners=[];this.messageUnsubscribes=[];this.themeSelector=null;this.themeManagerModule=null;this.allowRender=!1;this.initialRenderScheduled=!1;this.debouncedRender=(0,me.debounce)(async()=>{this.plugin.settings.realTimeRender&&await this.renderDraft()},1e3);this.debouncedUpdate=(0,me.debounce)(async()=>{this.plugin.settings.realTimeRender&&await this.renderDraft()},1e3);this.debouncedCustomThemeChange=(0,me.debounce)(t=>{this.renderDraft(!0)},2e3);this.articleProperties=new Map;this.editorView=null;this.isActive=!1;this.plugin=n,this.wechatClient=tt.getInstance(this.plugin)}getViewType(){return Ca}getDisplayText(){return $("views.previewer.one2mp-previewer")}getIcon(){return"one2mp-logo"}async onOpen(){var t,n;await this.ensureThemeSelector(),this.buildUI(),this.startListen(),this.isActive=!0,this.markdownView=(t=st.getInstance(this.plugin).getCurrentMarkdownView())!=null?t:null,this.scheduleInitialRender(),this.messageUnsubscribes.push(this.plugin.messageService.registerListener("draft-title-updated",i=>{this.setPreviewTitle(i)})),(n=this.themeSelector)==null||n.startWatchThemes(),this.messageUnsubscribes.push(this.plugin.messageService.registerListener("custom-theme-changed",i=>{this.debouncedCustomThemeChange(i)})),this.plugin.messageService.sendMessage("active-file-changed",null),await this.loadComponents()}scheduleInitialRender(){if(this.initialRenderScheduled)return;this.initialRenderScheduled=!0;let t=()=>{this.renderDraft(!0)};this.plugin.app.workspace.onLayoutReady(()=>{let n=window.requestIdleCallback;typeof n=="function"?n(t,{timeout:2e3}):setTimeout(t,300)})}async ensureThemeSelector(){if(this.themeSelector)return;let{ThemeSelector:t}=await Promise.resolve().then(()=>(Md(),Dd));this.themeSelector=new t(this.plugin)}async getThemeManager(){return this.themeManagerModule||(this.themeManagerModule=await Promise.resolve().then(()=>(Sn(),pr))),this.themeManagerModule.ThemeManager}getArticleProperties(){let t=this.plugin.app.workspace.getActiveFile();if((t==null?void 0:t.extension)==="md"||(t==null?void 0:t.extension)==="markdown"){let n=this.app.metadataCache.getCache(t.path),i=n==null?void 0:n.frontmatter;this.articleProperties.clear(),i!=null&&Object.keys(i).forEach(o=>{this.articleProperties.set(o,i[o])})}return this.articleProperties}async setArticleProperties(){let t=this.getCurrentMarkdownFile();if(t&&this.articleProperties.size>0){let n=this.app.vault.getAbstractFileByPath(t);if(!(n instanceof me.TFile))throw new Error($("views.previewer.file-not-found-path",[t]));await this.app.fileManager.processFrontMatter(n,i=>{this.articleProperties.forEach((o,a)=>{i[a]=o})})}}getCurrentMarkdownFile(){var i,o;let t=this.plugin.app.workspace.getActiveFile(),n=this.plugin.app.workspace.getLeavesOfType("markdown");for(let a of n){let s=a.view;if(((i=s.file)==null?void 0:i.path)===(t==null?void 0:t.path))return(o=s.file)==null?void 0:o.path}return null}buildUI(){let t=this.containerEl.children[1];t.empty(),t.addClass("one2mp-preview-container"),this.buildToolbar(t);let n=t.createDiv({cls:"one2mp-main-scroll-area"});this.draftHeader=new yi(this.plugin,n),this.previewTitleEl=n.createDiv({cls:"one2mp-preview-title"}),this.setPreviewTitle(),this.renderDiv=n.createDiv({cls:"render-container"}),this.renderDiv.id="render-div",this.renderPreviewer=n.createDiv({cls:"one2mp-render-preview"}),this.containerDiv=this.renderDiv.createDiv({cls:"one2mp-article"}),this.articleDiv=this.containerDiv.createDiv({cls:"article-div"})}buildToolbar(t){let n=t.createDiv({cls:"one2mp-preview-toolbar"}),i=n.createDiv({cls:"toolbar-group-left"});this.accountDropdown=new me.DropdownComponent(i),this.updateAccountOptions(),this.accountDropdown.onChange(f=>{this.plugin.settings.selectedMPAccount=f,this.plugin.saveSettings(),this.plugin.messageService.sendMessage("wechat-account-changed",f),new me.Notice(`Switched to: ${f}`)}),n.createDiv({cls:"toolbar-group-center"});let o=n.createDiv({cls:"toolbar-group-right"}),a=o.createDiv({cls:"one2mp-toolbar-actions-group"}),s=new me.DropdownComponent(a);this.themeSelector?this.themeSelector.dropdown(s):(s.addOption("--default--",$("views.theme-manager.default-theme")),s.setDisabled(!0));let l=(f,m,b)=>{let E=a.createEl("button",{cls:"clickable-icon one2mp-toolbar-btn"});return(0,me.setIcon)(E,f),E.setAttribute("aria-label",m),E.onclick=b,E};l("settings",$("views.previewer.publish-config"),()=>{new wi(this.app,this.plugin).open()}),l("refresh-cw",$("views.previewer.render-article"),()=>{this.renderDraft(!0)}),l("clipboard-copy",$("views.previewer.copy-article-to-clipboard"),()=>{var m,b;let f=this.getArticleContent();if((m=navigator.clipboard)!=null&&m.write&&window.ClipboardItem){navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([f],{type:"text/html"})})]).then(()=>{new me.Notice($("views.previewer.article-copied-to-clipboard"))}).catch(E=>{console.warn("\u590D\u5236\u5230\u526A\u8D34\u677F\u5931\u8D25",E)});return}if((b=navigator.clipboard)!=null&&b.writeText){navigator.clipboard.writeText(f).then(()=>{new me.Notice($("views.previewer.article-copied-to-clipboard"))}).catch(E=>{console.warn("\u590D\u5236\u5230\u526A\u8D34\u677F\u5931\u8D25",E)});return}new me.Notice($("settings.clipboard-not-supported"))}),l("send-horizontal",$("views.previewer.send-article-to-draft-box"),()=>{(async()=>await this.checkCoverImage()?this.sendArticleToDraftBox():new me.Notice($("views.previewer.please-set-cover-image")))()});let c=o.createDiv({cls:"one2mp-toolbar-ip"}),u=f=>{if(c.empty(),!f.direct&&!f.proxy){c.setText("IP: ...");return}let m=(b,E)=>{let S=c.createDiv({cls:"one2mp-ip-subrow"});S.createSpan({text:b+": ",cls:"label"});let y=E==="single"?f.direct||f.proxy:E==="direct"?f.direct:f.proxy;S.createSpan({text:y,cls:"value"}),S.title=`\u70B9\u51FB\u5237\u65B0\u5E76\u590D\u5236 ${b} IP`,S.onclick=g=>{g.stopPropagation(),(async()=>{var h;new me.Notice("\u6B63\u5728\u5237\u65B0 IP...");try{let p=await this.plugin.updateIpAddress();u(p);let w=E==="single"?p.direct||p.proxy:E==="direct"?p.direct:p.proxy;w?(h=navigator.clipboard)!=null&&h.writeText?(await navigator.clipboard.writeText(w),new me.Notice(`${b} IP \u5DF2\u5237\u65B0\u5E76\u590D\u5236`)):new me.Notice($("settings.clipboard-not-supported")):new me.Notice("\u65E0\u6CD5\u83B7\u53D6 IP")}catch(p){new me.Notice("\u5237\u65B0 IP \u5931\u8D25"),console.error(p)}})()}};f.direct===f.proxy||!f.proxy||!f.direct?m("IP","single"):(f.direct&&m("\u76F4\u8FDE","direct"),f.proxy&&m("\u4EE3\u7406","proxy"))},d={};try{d=JSON.parse(this.plugin.settings.ipAddress||"{}")}catch(f){console.debug("Failed to parse cached IP address:",f)}u(d),this.plugin.updateIpAddress().then(f=>{u(f)}).catch(f=>{console.debug("Failed to refresh IP address:",f)})}updateAccountOptions(){let t=this.accountDropdown;t.selectEl.empty(),this.plugin.settings.mpAccounts.length===0?t.addOption("",$("modals.publish-config.no-account")):(this.plugin.settings.mpAccounts.forEach(n=>{t.addOption(n.accountName,n.accountName)}),this.plugin.settings.selectedMPAccount&&t.setValue(this.plugin.settings.selectedMPAccount))}setPreviewTitle(t){var o,a;if(!this.previewTitleEl)return;let n=(a=(o=this.app.workspace.getActiveFile())==null?void 0:o.basename)!=null?a:$("views.previewer.article-title"),i=t&&t.trim()?t.trim():n;this.previewTitleEl.setText(i),this.previewTitleEl.setAttr("title",i)}async checkCoverImage(){return this.draftHeader.checkCoverImage()}async sendArticleToDraftBox(){let t=this.articleDiv.firstElementChild;if(t){let i=await this.getThemeManager();i&&await i.getInstance(this.plugin).applyTheme(t)}await Eu(this.articleDiv,this.plugin.wechatClient),await Tu(this.articleDiv,this.plugin.wechatClient),await Au(this.articleDiv,this.plugin.wechatClient,this.app),await Iu(this.articleDiv,this.plugin.wechatClient);let n=await this.wechatClient.sendArticleToDraftBox(this.draftHeader.getActiveLocalDraft(),this.getArticleContent());if(n){this.draftHeader.updateDraftDraftId(n);let i=await this.wechatClient.getDraftById(this.plugin.settings.selectedMPAccount,n);if(i){this.openUrl(i[0].url);let o={media_id:n,content:{news_item:i},update_time:Date.now()};this.plugin.messageService.sendMessage("draft-item-updated",o)}}}getArticleContent(){let t=this.articleDiv.firstElementChild,n=t==null?void 0:t.querySelector("p"),i=n&&window.getComputedStyle(n).color||t&&window.getComputedStyle(t).color||void 0,o=this.articleDiv.cloneNode(!0);return Pu(o,i),nt.getInstance().restoreCard(o.innerHTML)}onClose(){return this.stopListen(),this.messageUnsubscribes.forEach(t=>t()),this.messageUnsubscribes=[],Promise.resolve()}async parseActiveMarkdown(){var s;this.getArticleProperties();let t=st.getInstance(this.plugin).getCurrentMarkdownView()||this.markdownView;if(!t)return $("views.previewer.not-a-markdown-view");this.articleDiv.empty(),this.elementMap=new Map;let n=(s=t.file)!=null?s:this.app.workspace.getActiveFile();if(!n)return"<h1>No active file</h1>";if(n.extension!=="md")return"<h1>Not a markdown file</h1>";await Ae.getInstance(this.plugin.app).render(n.path,this.renderPreviewer,this);let i=await jt.getInstance(this.plugin,this).parseNote(n.path),o=createEl("section",{cls:"one2mp-article-content one2mp"}),a=(0,me.sanitizeHTMLToDom)(i);o.appendChild(a),this.articleDiv.empty(),this.articleDiv.appendChild(o);for(let[l,c]of this.elementMap.entries()){let u=this.articleDiv.querySelector("#"+l);if(u)if(typeof c=="string"){let d=st.getInstance(this.plugin).getFileOfLink(c);if(d){let f=this.plugin.app.vault.getFileByPath(d.path);if(f){let m=await jt.getInstance(this.plugin,this).parseNote(f.path);u.empty(),u.appendChild((0,me.sanitizeHTMLToDom)(m))}}}else u.appendChild(c)}}async renderDraft(t=!1){if(t&&(this.allowRender=!0),!this.allowRender||!this.isViewActive()||(await this.parseActiveMarkdown(),this.articleDiv===null||this.articleDiv.firstChild===null))return;let n=this.articleDiv.firstChild,i=()=>{n.isConnected&&(async()=>{let a=await this.getThemeManager();a&&await a.getInstance(this.plugin).applyTheme(n)})()},o=window.requestIdleCallback;typeof o=="function"?o(i):setTimeout(i,0)}isViewActive(){return this.isActive&&!this.app.workspace.rightSplit.collapsed}startListen(){this.registerEvent(this.plugin.app.vault.on("rename",i=>{this.draftHeader.onNoteRename(i)})),this.registerEvent(this.app.workspace.on("layout-change",()=>{let i=this.app.workspace.getLeavesOfType(Ca).length>0;this.isActive=i}));let t=this.app.workspace.on("editor-change",()=>{this.onEditorChange()});this.listeners.push(t);let n=this.app.workspace.on("active-leaf-change",i=>{i&&(i.view.getViewType()==="markdown"?(this.markdownView=i.view,this.lastLeaf=i,this.plugin.messageService.sendMessage("active-file-changed",null),this.debouncedUpdate()):this.isActive=i.view===this)});this.listeners.push(n)}stopListen(){this.listeners.forEach(t=>this.app.workspace.offref(t))}onEditorChange(){this.debouncedRender()}updateElementByID(t,n){let i=this.articleDiv.querySelector("#"+t);if(!i)return;let o=(0,me.sanitizeHTMLToDom)(n);i.empty(),i.appendChild(o)}addElementByID(t,n){typeof n=="string"?this.elementMap.set(t,n):this.elementMap.set(t,n.cloneNode(!0))}async loadComponents(){let t=this,n=async(i,o=new Set)=>{var s,l;if(o.has(i))return;o.add(i);let a=i;if((s=a._children)!=null&&s.length)for(let c of a._children)await n(c,o);try{if(((l=i==null?void 0:i.constructor)==null?void 0:l.name)==="SheetElement"){let u=i.onload();u&&typeof u.then=="function"&&await u}}catch(c){console.error("Error calling onload()",c)}};await n(t)}openUrl(t){if(!t)return;if(typeof window!="undefined"&&typeof window.open=="function"){window.open(t);return}let n=this.app;if(n.openWithDefaultApp){n.openWithDefaultApp(t);return}new me.Notice($("views.previewer.open-url-not-supported"))}}});var ew={};xt(ew,{default:()=>bi});module.exports=ef(ew);var Je=require("obsidian");var Ci=require("obsidian");async function Aa(){let r=async()=>{try{return(await(0,Ci.requestUrl)("https://api.ipify.org?format=json")).json.ip}catch(i){console.warn("Failed to fetch proxy IP",i);return}},e=async()=>{try{return(await(0,Ci.requestUrl)("https://myip.ipip.net/json")).json.data.ip}catch(i){console.warn("Failed to fetch direct IP",i);return}},[t,n]=await Promise.all([r(),e()]);return{proxy:t,direct:n}}Ei();Fe();var Ga=require("obsidian");Fe();var lr=class extends Ga.Modal{constructor(t,n,i){super(t);this.message=n;this.resolve=i}onOpen(){let{contentEl:t}=this;t.createEl("p",{text:this.message});let n=t.createDiv("modal-button-container");n.createEl("button",{text:$("modals.confirm")}).addEventListener("click",()=>{this.resolve(!0),this.close()}),n.createEl("button",{text:$("modals.cancel")}).addEventListener("click",()=>{this.resolve(!1),this.close()})}onClose(){let{contentEl:t}=this;t.empty()}};var re=require("obsidian");Fe();var ur=require("obsidian"),cr=class extends ur.AbstractInputSuggest{constructor(t,n){super(t,n);this.inputEl=n}getSuggestions(t){return this.app.vault.getAllLoadedFiles().filter(i=>i instanceof ur.TFolder).filter(i=>i.path.toLowerCase().includes(t.toLowerCase()))}renderSuggestion(t,n){n.setText(t.path)}selectSuggestion(t){this.inputEl.value=t.path,this.inputEl.trigger("input"),this.close()}};Mi();var gr=class extends re.PluginSettingTab{constructor(t,n){super(t,n);this.plugin=n}display(){let{containerEl:t}=this;t.empty(),t.addClass("one2mp-settings"),this.createAccountManagement(t),this.createGeneralSettings(t),this.creatCSSStyleSetting(t),this.createBackupRestore(t)}createAccountManagement(t){new re.Setting(t).setName($("settings.wechat-account")).setHeading().addExtraButton(i=>{i.setIcon("plus").setTooltip($("settings.create-new-account")).onClick(()=>{this.createNewAccount()})});let n=t.createDiv({cls:"one2mp-appid-guide"});n.createEl("span",{text:$("settings.appid-secret-guide")+" ",cls:"setting-item-description"}),n.createEl("a",{href:"https://developers.weixin.qq.com/console/",text:$("settings.appid-secret-guide-link")}).setAttr("target","_blank"),this.plugin.settings.mpAccounts.length===0?t.createDiv({cls:"one2mp-no-account"}).createEl("p",{text:$("settings.select-account")}):this.plugin.settings.mpAccounts.forEach((i,o)=>{this.renderAccountItem(t,i,o)})}renderAccountItem(t,n,i){let a=t.createDiv({cls:"one2mp-account-item"}).createEl("details");i===0&&(a.open=!0);let s=a.createEl("summary");s.setText(n.accountName||$("settings.new-account"));let l=a.createDiv({cls:"one2mp-account-details"});new re.Setting(l).setName($("settings.account-name")).setDesc($("settings.account-name-for-your-wechat-official")).setClass("one2mp-setting-wide").addText(u=>u.setValue(n.accountName).onChange(d=>{n.accountName=d,s.setText(d),this.plugin.settings.selectedMPAccount===this.plugin.settings.mpAccounts[i].accountName&&(this.plugin.settings.selectedMPAccount=d),this.plugin.saveSettings()})),new re.Setting(l).setName($("settings.appid")).setDesc($("settings.appid-for-your-wechat-official-account")).setClass("one2mp-setting-wide").addText(u=>u.setValue(n.appId).setPlaceholder("wx...").onChange(d=>{n.appId=d.trim(),this.plugin.saveSettings()})),new re.Setting(l).setName($("settings.app-secret")).setDesc($("settings.app-secret-for-your-wechat-official")).setClass("one2mp-setting-wide").addText(u=>u.setValue(n.appSecret).setPlaceholder("...").onChange(d=>{let f=d.replace(/\s+/g,"");f!==d&&u.setValue(f),n.appSecret=f,this.plugin.saveSettings()}));let c=new re.Setting(l).setName("");c.addButton(u=>{u.setTooltip($("settings.click-to-connect-wechat-server")).setIcon("plug-zap").setButtonText($("settings.test-connection")).onClick(()=>{(async()=>await this.plugin.TestAccessToken(n.accountName)?new re.Notice($("settings.successfully-connected-to-wechat-server")):new re.Notice($("settings.failed-to-connect-to-wechat-server")))()})}),c.addButton(u=>{u.setTooltip($("settings.delete-account")).setIcon("trash-2").setButtonText($("settings.delete-account")).setClass("mod-warning").onClick(()=>{var d;this.plugin.settings.mpAccounts.splice(i,1),this.plugin.settings.selectedMPAccount===n.accountName&&(this.plugin.settings.selectedMPAccount=(d=this.plugin.settings.mpAccounts[0])==null?void 0:d.accountName),this.plugin.saveSettings(),this.display()})})}createNewAccount(){let t=1,n=$("settings.new-account");for(;this.plugin.settings.mpAccounts.some(o=>o.accountName===n);)t++,n=`${$("settings.new-account")} ${t}`;let i={accountName:n,appId:"",appSecret:""};this.plugin.settings.mpAccounts.push(i),this.plugin.settings.selectedMPAccount||(this.plugin.settings.selectedMPAccount=n),this.plugin.saveSettings(),this.display()}createGeneralSettings(t){new re.Setting(t).setName($("settings.general-settings")).setHeading();let n=new re.Setting(t).setName($("settings.public-ip-address")).setDesc($("settings.you-should-add-this-ip-to-ip-whitelist-o")),i=a=>{n.controlEl.empty(),n.controlEl.addClass("one2mp-ip-container");let s=(l,c)=>{if(!c)return;let u=n.controlEl.createDiv({cls:"one2mp-ip-row"});u.createSpan({cls:"one2mp-ip-label",text:l}),u.createSpan({cls:"one2mp-ip-value",text:c}),u.title=$("settings.copy-ip-to-clipboard"),u.onclick=()=>{var d;if(!((d=navigator.clipboard)!=null&&d.writeText)){new re.Notice($("settings.clipboard-not-supported"));return}navigator.clipboard.writeText(c).then(()=>{new re.Notice($("settings.ip-copied-to-clipboard"))}).catch(f=>{console.warn("\u590D\u5236 IP \u5931\u8D25",f)})}};if(!a.direct&&!a.proxy){n.controlEl.createSpan({text:$("settings.no-ip-address"),cls:"text-muted"});return}a.direct===a.proxy||!a.proxy||!a.direct?s("\u516C\u7F51 IP",a.direct||a.proxy):(s("\u76F4\u8FDE",a.direct),s("\u4EE3\u7406",a.proxy))};(()=>{let a={};try{a=JSON.parse(this.plugin.settings.ipAddress||"{}")}catch(s){a={direct:this.plugin.settings.ipAddress}}i(a)})(),this.plugin.updateIpAddress().then(a=>{i(a)}).catch(()=>{}),new re.Setting(t).setName($("settings.real-time-render")).setDesc($("settings.enable-real-time-rendering")).addToggle(a=>{a.setValue(this.plugin.settings.realTimeRender).onChange(s=>{this.plugin.settings.realTimeRender=s,this.plugin.saveSettings()})})}creatCSSStyleSetting(t){new re.Setting(t).setName($("settings.custom-themes")).setHeading(),new re.Setting(t).setName($("settings.custom-themes-folder")).setDesc($("settings.the-folder-where-your-custom-themes")).addSearch(n=>{new cr(this.app,n.inputEl),n.setPlaceholder($("settings.themes-folder-path")).setValue(this.plugin.settings.css_styles_folder).onChange(i=>{this.plugin.settings.css_styles_folder=i,this.plugin.saveThemeFolderDebounce()})}).addExtraButton(n=>{n.setIcon("download").setTooltip($("views.theme-manager.download-predefined-custom-themes")).onClick(()=>{(async()=>{let{ThemeManager:i}=await Promise.resolve().then(()=>(Sn(),pr));new re.Notice($("views.theme-manager.download-started")),i.getInstance(this.plugin).downloadThemes()})()})}),new re.Setting(t).setName($("settings.theme-download-overwrite")).setDesc($("settings.theme-download-overwrite-desc")).addToggle(n=>{n.setValue(this.plugin.settings.themeDownloadOverwrite).onChange(i=>{this.plugin.settings.themeDownloadOverwrite=i,this.plugin.saveSettings()})})}createBackupRestore(t){new re.Setting(t).setName($("settings.import-export-one2mp-account")).setHeading().setDesc($("settings.import-or-export-your-account-info-for-b")).addExtraButton(n=>{n.setIcon("upload").setTooltip($("settings.import-account-info")).onClick(()=>{this.importSettings()})}).addExtraButton(n=>{n.setIcon("download").setTooltip($("settings.export-account-info")).onClick(()=>{this.exportSettings()})})}async exportSettings(){try{let t=JSON.stringify(this.plugin.settings,null,2);if(!window.showSaveFilePicker||re.Platform.isMobile){let a=new Date().toISOString().slice(0,10),s="one2mp-settings",l=`one2mp-settings-${a}.json`,c=`${s}/${l}`;return this.app.vault.getAbstractFileByPath(s)||await this.app.vault.createFolder(s),await this.app.vault.adapter.write(c,t),new re.Notice($("settings.settings-exported-to-vault",[c])),!0}let n=new Blob([t],{type:"application/json"}),o=await(await window.showSaveFilePicker({suggestedName:`one2mp-settings-${new Date().toISOString().slice(0,10)}.json`,types:[{description:"JSON Files",accept:{"application/json":[".json"]}}]})).createWritable();return await o.write(n),await o.close(),new re.Notice($("settings.settings-exported")),!0}catch(t){if(t instanceof Error&&t.name==="AbortError")return!1;let n=t instanceof Error?t.message:String(t);return new re.Notice(`${$("settings.settings-exporting-failed")}${n}`),console.error(t),!1}}async importSettingsFromVault(){let t=new re.Modal(this.app);t.contentEl.createEl("h3",{text:$("settings.import-settings-title")}),t.contentEl.createEl("p",{text:$("settings.import-settings-hint")});let n=new re.TextComponent(t.contentEl);n.setPlaceholder($("settings.import-settings-placeholder")),new Qt(this.app,n.inputEl,["json"]);let i=t.contentEl.createDiv({cls:"modal-button-container"}),o=new re.ButtonComponent(i);o.setButtonText($("settings.cancel")),o.onClick(()=>t.close());let a=new re.ButtonComponent(i);a.setButtonText($("settings.import-settings-confirm")),a.setCta(),a.onClick(async()=>{let s=n.getValue().trim();if(!s){new re.Notice($("settings.import-settings-empty-path"));return}let l=this.app.vault.getAbstractFileByPath(s);if(!(l instanceof re.TFile)){new re.Notice($("settings.import-settings-file-not-found"));return}try{let c=await this.app.vault.read(l);await this.applyImportedSettings(c),t.close()}catch(c){let u=c instanceof Error?c.message:String(c);new re.Notice(`${$("settings.settings-imported-failed")}${u}`),console.error(c)}}),t.open()}async applyImportedSettings(t){let n;try{n=JSON.parse(t)}catch(a){new re.Notice($("settings.invalid-json-file"));return}let{mpAccounts:i,css_styles_folder:o}=n;if(i===void 0||o===void 0){new re.Notice($("settings.invalid-wewerite-settings-file"));return}this.plugin.settings=n,this.plugin.saveSettings(),this.display(),new re.Notice($("settings.settings-imported-successfully"))}importSettings(){try{if(re.Platform.isMobile){this.importSettingsFromVault();return}let t=document.createElement("input");t.type="file",t.accept=".json",t.onchange=n=>{(()=>{var s;let o=(s=n.target.files)==null?void 0:s[0];if(!o)return;let a=new FileReader;a.onload=l=>{(async()=>{var c;try{let u=(c=l.target)==null?void 0:c.result;await this.applyImportedSettings(u)}catch(u){let d=u instanceof Error?u.message:String(u);new re.Notice(`${$("settings.settings-imported-failed")}${d}`),console.error(u)}})()},a.readAsText(o)})()},t.click()}catch(t){let n=t instanceof Error?t.message:String(t);new re.Notice(`${$("settings.settings-imported-error")}${n}`),console.error(t)}}};en();var Dr=null,$c=async()=>{if(Dr)return Dr;try{let{default:r}=await Promise.resolve().then(()=>(Bo(),Fo));return Dr=new r("one2mp-settings"),Dr}catch(r){return console.warn("PouchDB \u521D\u59CB\u5316\u5931\u8D25\uFF0C\u8DF3\u8FC7\u65E7\u914D\u7F6E\u8FC1\u79FB",r),null}},Oc=async()=>{await $c()},Dc=1,Kg=async()=>{let r=await $c();if(r)return new Promise(e=>{r.get("one2mp-settings").then(t=>{e(t)}).catch(t=>{console.warn("Error getting One2MpSetting:",t),e(void 0)})})},Mc=async r=>{var e;try{let t=await r.loadData();if(t!=null&&t.settings)return t.custom_theme_folder&&!t.settings.css_styles_folder&&(t.settings.css_styles_folder=t.custom_theme_folder),t.settings;let n=await Kg();if(n){let i={...t,settings:n,custom_theme_folder:(e=n.css_styles_folder)!=null?e:t==null?void 0:t.custom_theme_folder,settings_version:Dc};await r.saveData(i)}return n}catch(t){console.error("Error loading One2MpSetting:",t);return}},Lc=async(r,e)=>{var t;try{let n=await r.loadData(),i=n==null?void 0:n.settings;if(i&&Xt(e,i))return;let o={...n,settings:e,custom_theme_folder:(t=e.css_styles_folder)!=null?t:n==null?void 0:n.custom_theme_folder,settings_version:Dc};await r.saveData(o)}catch(n){console.error("Error setting One2MpSetting:",n)}};Hn();var Gr=class{constructor(){this.listeners=new Map}registerListener(e,t){let n=this.listeners.get(e);return n==null||n===null?this.listeners.set(e,[t]):n.push(t),()=>this.unregisterListener(e,t)}unregisterListener(e,t){let n=this.listeners.get(e);if(!n)return;let i=n.filter(o=>o!==t);if(i.length===0){this.listeners.delete(e);return}this.listeners.set(e,i)}sendMessage(e,t){let n=this.listeners.get(e);n==null||n===null||n.forEach(i=>i(t))}};Un();var Jr=class{constructor(e){this.spinnerEl=e,this.spinnerEl.addClass("spinner-container");let t=this.spinnerEl.createDiv({cls:"spinner-dots"});for(let n=0;n<6;n++)t.createDiv({cls:`spinner-dot spinner-dot${n+1}`}).setCssProps({"animation-delay":`${n*.3}s`});this.spinnerText=this.spinnerEl.createDiv({cls:"spinner-text"})}showSpinner(e=""){this.spinnerEl.setCssProps({display:"flex"}),this.spinnerText.setText(e)}isSpinning(){return getComputedStyle(this.spinnerEl).display!=="none"}hideSpinner(){this.spinnerEl.setCssProps({display:"none"})}unload(){this.spinnerEl.remove()}};var Zr=require("obsidian");Fe();var Qr=class extends Zr.Modal{constructor(t,n,i=""){super(t);this.initialContent=i;this.inputEl=null;this.onSubmit=n}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h3",{text:$("modals.mpcard.title")}),t.createEl("p",{text:$("modals.mpcard.hint")}),this.inputEl=t.createEl("textarea",{cls:"one2mp-mpcard-input"}),this.inputEl.placeholder=$("modals.mpcard.placeholder"),this.initialContent&&(this.inputEl.value=this.initialContent),this.inputEl.focus();let n=t.createDiv("modal-button-container");n.createEl("button",{text:$("modals.mpcard.insert")}).addEventListener("click",()=>{var a,s;let i=(s=(a=this.inputEl)==null?void 0:a.value)!=null?s:"",o=this.normalizeMpcard(i);if(!o){new Zr.Notice($("modals.mpcard.empty"));return}this.onSubmit(o),this.close()}),n.createEl("button",{text:$("modals.cancel")}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:t}=this;t.empty(),this.inputEl=null}normalizeMpcard(t){let n=t.trim();if(!n)return"";if(n.startsWith("```")){let i=n.split(/\r?\n/);return/```\\s*mpcard/i.test(i[0])||(i[0]="```mpcard"),i.slice(1).some(a=>a.trim()==="```")||i.push("```"),`
${i.join(`
`)}
`}return`
\`\`\`mpcard
${n}
\`\`\`
`}};var bn="one2mp-article-preview",Yy={mpAccounts:[],ipAddress:"",css_styles_folder:"one2mp-css-styles",codeLineNumber:!0,accountDataPath:"one2mp-accounts",useCenterToken:!1,realTimeRender:!0,defaultMpcard:"",defaultMpcardId:"",defaultMpcardHeadimg:"",defaultMpcardNickname:"",defaultMpcardSignature:"",themeDownloadOverwrite:!1},Fd="one2mp-logo",Xy=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="100" height="100">
	<path d="M 15.560304092607304 33.94050605385342C 29.693661897802365 -1.1141138324752404 70.30633810219763 -1.1141138324752404 84.43969590739269 33.940506053853426C 51.84603073656342 45.353262378865885 48.15396926343658 45.353262378865885 15.560304092607304 33.94050605385342Z" fill="#84D473" />
	<path d="M 81.12777768298169 28.204095418660252C 104.41929012195195 57.97125226189857 84.1129520197543 93.14286157057666 46.688081775588984 87.85539852748633C 53.1011774563413 53.92207832459788 54.947208192904725 50.72465929653623 81.12777768298169 28.204095418660252Z" fill="#3AB54A" />
	<path d="M 53.31191822441101 87.85539852748633C 15.887047980245676 93.14286157057666 -4.419290121951946 57.971252261898584 18.872222317018313 28.204095418660245Q 45.052791807095275 50.72465929653624 28.163984663890915 52.681125554913244L 38.40889008453118 53.10582854123025L 29.748893224046313 58.59608482676403Q 46.898822543658696 53.92207832459788 53.31191822441101 87.85539852748633Z" fill="#27753D" />
</svg>`,bi=class extends Je.Plugin{constructor(){super(...arguments);this.editorChangeListener=null;this.resourceManager=st.getInstance(this);this.active=!1;this.previewPanelCtor=null;this.saveSettings=(0,Je.debounce)(async()=>{delete this.settings._id,delete this.settings._rev,this.trimSettings(),await Lc(this,this.settings),await this.saveThemeFolder()},3e3);this.saveThemeFolderDebounce=(0,Je.debounce)(async()=>{await this.saveThemeFolder()},3e3)}async saveThemeFolder(){this.trimSettings();let t={...this.settings};delete t._id,delete t._rev;let n={custom_theme_folder:this.settings.css_styles_folder},i=await this.loadData();await this.saveData({...i!=null?i:{},...n,settings:t}),this.messageService.sendMessage("custom-theme-folder-changed",null)}async loadThemeFolder(){let t=await this.loadData();t&&t.custom_theme_folder&&(this.settings.css_styles_folder=t.custom_theme_folder)}trimSettings(){var t,n,i,o;this.settings.mpAccounts.forEach(a=>{a.accountName=a.accountName.trim(),a.appId=a.appId.trim(),a.appSecret=a.appSecret.trim()}),this.settings.ipAddress=(t=this.settings.ipAddress)==null?void 0:t.trim(),this.settings.selectedMPAccount=(n=this.settings.selectedMPAccount)==null?void 0:n.trim(),this.settings.accountDataPath=(i=this.settings.accountDataPath)==null?void 0:i.trim(),this.settings.css_styles_folder=(o=this.settings.css_styles_folder)==null?void 0:o.trim()}async writeStartupLog(t,n){let i="o2any-startup.log",o=new Date().toISOString(),a=n?` ${this.formatStartupError(n)}`:"",s=`[${o}] ${t}${a}
`;try{let l=this.app.vault.adapter;await l.exists(i)?await l.append(i,s):await l.write(i,s)}catch(l){console.error("O2Any \u542F\u52A8\u65E5\u5FD7\u5199\u5165\u5931\u8D25",l)}}formatStartupError(t){return t instanceof Error?`${t.name}: ${t.message}${t.stack?`
${t.stack}`:""}`:String(t)}createSpinner(){this.spinner=new Jr(this.addStatusBarItem())}showSpinner(t=""){this.spinner.showSpinner(t)}isSpinning(){return this.spinner.isSpinning()}hideSpinner(){this.spinner.hideSpinner()}async loadSettings(){this.settings=Object.assign({},Yy,await Mc(this)),await this.loadThemeFolder()}async updateIpAddress(){try{let t=await Aa();return this.settings.ipAddress=JSON.stringify(t),this.saveSettings(),t}catch(t){return console.error("Error fetching public IP address:",t),{}}}async activateView(){let{workspace:t}=this.app,n=t.getLeavesOfType(bn).find(i=>i.view.getViewType()===bn);n==null&&(n=t.getRightLeaf(!1),await(n==null?void 0:n.setViewState({type:bn,active:!0}))),n&&t.revealLeaf(n)}getAccessToken(t){let n=this.getMPAccountByName(t);return n===void 0?(new Je.Notice($("main.no-wechat-mp-account-selected")),!1):n.access_token}async TestAccessToken(t){if(this.settings.useCenterToken)return this.wechatClient.requestToken();{let n=this.getMPAccountByName(t);if(n===void 0)return new Je.Notice($("main.no-wechat-mp-account-selected")),!1;let i=await this.wechatClient.getAccessToken(n.appId,n.appSecret);if(i)return this.setAccessToken(t,i.access_token,i.expires_in),i.access_token}return!1}async refreshAccessToken(t){if(this.settings.useCenterToken)return this.wechatClient.requestToken();if(t===void 0)return!1;let n=this.getMPAccountByName(t);if(n===void 0)return new Je.Notice($("main.no-wechat-mp-account-selected")),!1;let{appId:i,appSecret:o}=n;if(i===void 0||o===void 0||!i||!o)return new Je.Notice($("main.please-check-you-appid-and-appsecret")),!1;let{access_token:a,expires_in:s,lastRefreshTime:l}=n;if(a===void 0||a===""){let c=await this.wechatClient.getAccessToken(i,o);if(c)return this.setAccessToken(t,c.access_token,c.expires_in),c.access_token}else if(l+s*1e3<new Date().getTime()){let c=await this.wechatClient.getAccessToken(i,o);if(c)return this.setAccessToken(t,c.access_token,c.expires_in),c.access_token}else return a;return!1}getMPAccountByName(t){return this.settings.mpAccounts.find(n=>n.accountName===t)}getSelectedMPAccount(){return this.getMPAccountByName(this.settings.selectedMPAccount)}setAccessToken(t,n,i){let o=this.getMPAccountByName(t);o!==void 0&&(o.access_token=n,o.lastRefreshTime=new Date().getTime(),o.expires_in=i,this.saveSettings())}confirm(t){return new Promise(n=>{new lr(this.app,t,n).open()})}initDB(){Oc(),ea()}async onload(){await this.writeStartupLog("onload:start");try{this.initDB(),this.messageService=new Gr,await this.loadSettings(),this.wechatClient=tt.getInstance(this),(0,Je.addIcon)(Fd,Xy);let t=await Promise.resolve().then(()=>(Rd(),Ld));this.previewPanelCtor=t.PreviewPanel,this.registerViews(),this.addCommand({id:"open-previewer",name:$("main.open-previewer"),callback:()=>{this.activateView()}}),this.addRibbonIcon(Fd,$("main.open-previewer"),()=>{this.activateView()}),this.addSettingTab(new gr(this.app,this)),this.createSpinner(),this.messageService.registerListener("show-spinner",n=>{this.showSpinner(n)}),this.messageService.registerListener("hide-spinner",()=>{this.hideSpinner()}),this.registerEvent(this.app.workspace.on("editor-menu",(n,i)=>{n.addItem(o=>{o.setTitle($("main.insert-mpcard")),o.onClick(()=>{let a=this.settings.defaultMpcard||this.buildDefaultMpcard();new Qr(this.app,l=>{i.replaceSelection(l)},a).open()})})}))}catch(t){throw await this.writeStartupLog("onload:error",t),t}await this.writeStartupLog("onload:ready")}buildDefaultMpcard(){var s,l,c,u;let t=[],n=(s=this.settings.defaultMpcardId)==null?void 0:s.trim(),i=(l=this.settings.defaultMpcardHeadimg)==null?void 0:l.trim(),o=(c=this.settings.defaultMpcardNickname)==null?void 0:c.trim(),a=(u=this.settings.defaultMpcardSignature)==null?void 0:u.trim();return n&&t.push(`id: ${n}`),i&&t.push(`headimg: ${i}`),o&&t.push(`nickname: ${o}`),a&&t.push(`signature: ${a}`),t.length===0?"":["```mpcard",...t,"```"].join(`
`)}registerViewOnce(t){if(this.app.workspace.getLeavesOfType(t).length===0&&t===bn){if(!this.previewPanelCtor){new Je.Notice("\u9884\u89C8\u5668\u672A\u52A0\u8F7D\uFF0C\u65E0\u6CD5\u6CE8\u518C\u89C6\u56FE");return}this.registerView(t,n=>new this.previewPanelCtor(n,this))}}registerViews(){this.registerViewOnce(bn)}onunload(){this.editorChangeListener&&this.app.workspace.offref(this.editorChangeListener),this.spinner.unload(),this.app.workspace.getLeavesOfType(bn).forEach(t=>t.detach()),tt.resetInstance(),(async()=>{let{ThemeManager:t}=await Promise.resolve().then(()=>(Sn(),pr));t.resetInstance()})(),(async()=>{let{LocalDraftManager:t}=await Promise.resolve().then(()=>(Hn(),_u));t.resetInstance();let{WechatRender:n}=await Promise.resolve().then(()=>(ba(),Ed));n.resetInstance()})()}};
//![[]]
