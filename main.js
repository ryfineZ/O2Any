/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var sf=Object.create;var Tn=Object.defineProperty;var lf=Object.getOwnPropertyDescriptor;var cf=Object.getOwnPropertyNames;var uf=Object.getPrototypeOf,df=Object.prototype.hasOwnProperty;var ff=(r,e,t)=>e in r?Tn(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var j=(r,e)=>()=>(r&&(e=r(r=0)),e);var Pi=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Ct=(r,e)=>{for(var t in e)Tn(r,t,{get:e[t],enumerable:!0})},Mo=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of cf(e))!df.call(r,i)&&i!==t&&Tn(r,i,{get:()=>e[i],enumerable:!(n=lf(e,i))||n.enumerable});return r};var Qt=(r,e,t)=>(t=r!=null?sf(uf(r)):{},Mo(e||!r||!r.__esModule?Tn(t,"default",{value:r,enumerable:!0}):t,r)),hf=r=>Mo(Tn({},"__esModule",{value:!0}),r);var be=(r,e,t)=>(ff(r,typeof e!="symbol"?e+"":e,t),t);var Fo,ft,Ii=j(()=>{Fo=require("obsidian"),ft=class{constructor(e){this.plugin=e,this.init()}static getInstance(e){return this.instance||(this.instance=new ft(e)),this.instance}init(){}getCurrentMarkdownView(){var n;let e=this.plugin.app.workspace.getActiveFile(),t=this.plugin.app.workspace.getLeavesOfType("markdown");for(let i of t){let a=i.view;if(((n=a.file)==null?void 0:n.path)===(e==null?void 0:e.path))return a}return null}forceRenderActiveMarkdownView(){let e=this.getCurrentMarkdownView();e&&this.plugin.app.workspace.trigger("render",e)}queryElements(e){let t=this.getCurrentMarkdownView();if(!t)return[];let n=t.getMode()==="preview"?".markdown-preview-view":".markdown-source-view",i=t.containerEl.querySelector(n);return i?i.querySelectorAll(e):[]}getMarkdownViewContainer(){let e=this.getCurrentMarkdownView();return e?e.containerEl:null}getMarkdownRenderedElement(e,t){let n=this.queryElements(t);if(n.length<=e)return null;let i=n[e];return i||null}getFileOfLink(e){return this.plugin.app.metadataCache.getFirstLinkpathDest(e,"")}async getLinkFileContent(e){let t=this.getFileOfLink(e);return t?await this.plugin.app.vault.adapter.read(t.path):null}async saveImageFromUrl(e){var d;let t=this.plugin.app.workspace.getActiveFile();if(!t)return null;let n=t.basename,i=((d=t.parent)==null?void 0:d.path)||"",a=e.split("/"),s=a[a.length-1].split("?")[0].split(".").pop(),l=new Date().toISOString().replace(/[:.]/g,"-").replace("T","_"),c=`${n}_generated_${l}.${s||"jpg"}`,u=i==="/"?`/${c}`:`${i}/${c}`;try{let f=await(0,Fo.requestUrl)({url:e});if(f.status!==200)throw new Error("Failed to fetch image");let m=f.arrayBuffer;return await this.plugin.app.vault.adapter.writeBinary(u,m),u}catch(f){return console.error("Error saving image:",f),null}}}});var ne,An,Bo,pf,gf,qo,No,Pn,jo,mf,cr,vf,Go,Zt,yf,wf,Oi,bf,xf,_f,Li,ur,kf,Xt,ht,en,dr,Jo,zo,tn,fr,Ho,Uo,Mi,Wo,Di,Ri,Sf,Yt,Fi,Ef,Bi,Vo,Ko,lr,Cf,$t,De,kw,Sw,Ew,Cw,Tw,Aw,Pw,$w,Iw,Dw,Ow,Lw,Mw,Rw,Qo=j(()=>{ne=r=>typeof r=="string",An=()=>{let r,e,t=new Promise((n,i)=>{r=n,e=i});return t.resolve=r,t.reject=e,t},Bo=r=>r==null?"":""+r,pf=(r,e,t)=>{r.forEach(n=>{e[n]&&(t[n]=e[n])})},gf=/###/g,qo=r=>r&&r.indexOf("###")>-1?r.replace(gf,"."):r,No=r=>!r||ne(r),Pn=(r,e,t)=>{let n=ne(e)?e.split("."):e,i=0;for(;i<n.length-1;){if(No(r))return{};let a=qo(n[i]);!r[a]&&t&&(r[a]=new t),Object.prototype.hasOwnProperty.call(r,a)?r=r[a]:r={},++i}return No(r)?{}:{obj:r,k:qo(n[i])}},jo=(r,e,t)=>{let{obj:n,k:i}=Pn(r,e,Object);if(n!==void 0||e.length===1){n[i]=t;return}let a=e[e.length-1],o=e.slice(0,e.length-1),s=Pn(r,o,Object);for(;s.obj===void 0&&o.length;)a=`${o[o.length-1]}.${a}`,o=o.slice(0,o.length-1),s=Pn(r,o,Object),s!=null&&s.obj&&typeof s.obj[`${s.k}.${a}`]!="undefined"&&(s.obj=void 0);s.obj[`${s.k}.${a}`]=t},mf=(r,e,t,n)=>{let{obj:i,k:a}=Pn(r,e,Object);i[a]=i[a]||[],i[a].push(t)},cr=(r,e)=>{let{obj:t,k:n}=Pn(r,e);if(t&&Object.prototype.hasOwnProperty.call(t,n))return t[n]},vf=(r,e,t)=>{let n=cr(r,t);return n!==void 0?n:cr(e,t)},Go=(r,e,t)=>{for(let n in e)n!=="__proto__"&&n!=="constructor"&&(n in r?ne(r[n])||r[n]instanceof String||ne(e[n])||e[n]instanceof String?t&&(r[n]=e[n]):Go(r[n],e[n],t):r[n]=e[n]);return r},Zt=r=>r.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),yf={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},wf=r=>ne(r)?r.replace(/[&<>"'\/]/g,e=>yf[e]):r,Oi=class{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){let t=this.regExpMap.get(e);if(t!==void 0)return t;let n=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,n),this.regExpQueue.push(e),n}},bf=[" ",",","?","!",";"],xf=new Oi(20),_f=(r,e,t)=>{e=e||"",t=t||"";let n=bf.filter(o=>e.indexOf(o)<0&&t.indexOf(o)<0);if(n.length===0)return!0;let i=xf.getRegExp(`(${n.map(o=>o==="?"?"\\?":o).join("|")})`),a=!i.test(r);if(!a){let o=r.indexOf(t);o>0&&!i.test(r.substring(0,o))&&(a=!0)}return a},Li=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!r)return;if(r[e])return Object.prototype.hasOwnProperty.call(r,e)?r[e]:void 0;let n=e.split(t),i=r;for(let a=0;a<n.length;){if(!i||typeof i!="object")return;let o,s="";for(let l=a;l<n.length;++l)if(l!==a&&(s+=t),s+=n[l],o=i[s],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&l<n.length-1)continue;a+=l-a+1;break}i=o}return i},ur=r=>r==null?void 0:r.replace("_","-"),kf={type:"logger",log(r){this.output("log",r)},warn(r){this.output("warn",r)},error(r){this.output("error",r)},output(r,e){var t,n;(n=(t=console==null?void 0:console[r])==null?void 0:t.apply)==null||n.call(t,console,e)}},Xt=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||kf,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,n,i){return i&&!this.debug?null:(ne(e[0])&&(e[0]=`${n}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new Xt(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new Xt(this.logger,e)}},ht=new Xt,en=class{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(n=>{this.observers[n]||(this.observers[n]=new Map);let i=this.observers[n].get(t)||0;this.observers[n].set(t,i+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(o=>{let[s,l]=o;for(let c=0;c<l;c++)s(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(o=>{let[s,l]=o;for(let c=0;c<l;c++)s.apply(s,[e,...n])})}},dr=class extends en{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){let t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,n){var c,u;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,o=i.ignoreJSONStructure!==void 0?i.ignoreJSONStructure:this.options.ignoreJSONStructure,s;e.indexOf(".")>-1?s=e.split("."):(s=[e,t],n&&(Array.isArray(n)?s.push(...n):ne(n)&&a?s.push(...n.split(a)):s.push(n)));let l=cr(this.data,s);return!l&&!t&&!n&&e.indexOf(".")>-1&&(e=s[0],t=s[1],n=s.slice(2).join(".")),l||!o||!ne(n)?l:Li((u=(c=this.data)==null?void 0:c[e])==null?void 0:u[t],n,a)}addResource(e,t,n,i){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1},o=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,s=[e,t];n&&(s=s.concat(o?n.split(o):n)),e.indexOf(".")>-1&&(s=e.split("."),i=t,t=s[1]),this.addNamespaces(t),jo(this.data,s,i),a.silent||this.emit("added",e,t,n,i)}addResources(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(let a in n)(ne(n[a])||Array.isArray(n[a]))&&this.addResource(e,t,a,n[a],{silent:!0});i.silent||this.emit("added",e,t,n)}addResourceBundle(e,t,n,i,a){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},s=[e,t];e.indexOf(".")>-1&&(s=e.split("."),i=n,n=t,t=s[1]),this.addNamespaces(t);let l=cr(this.data,s)||{};o.skipCopy||(n=JSON.parse(JSON.stringify(n))),i?Go(l,n,a):l={...l,...n},jo(this.data,s,l),o.silent||this.emit("added",e,t,n)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){let t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(i=>t[i]&&Object.keys(t[i]).length>0)}toJSON(){return this.data}},Jo={processors:{},addPostProcessor(r){this.processors[r.name]=r},handle(r,e,t,n,i){return r.forEach(a=>{var o,s;e=(s=(o=this.processors[a])==null?void 0:o.process(e,t,n,i))!=null?s:e}),e}},zo={},tn=class extends en{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),pf(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=ht.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;let n=this.resolve(e,t);return(n==null?void 0:n.res)!==void 0}extractFromKey(e,t){let n=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");let i=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator,a=t.ns||this.options.defaultNS||[],o=n&&e.indexOf(n)>-1,s=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!_f(e,n,i);if(o&&!s){let l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:ne(a)?[a]:a};let c=e.split(n);(n!==i||n===i&&this.options.ns.indexOf(c[0])>-1)&&(a=c.shift()),e=c.join(i)}return{key:e,namespaces:ne(a)?[a]:a}}translate(e,t,n){if(typeof t!="object"&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),typeof t=="object"&&(t={...t}),t||(t={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);let i=t.returnDetails!==void 0?t.returnDetails:this.options.returnDetails,a=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator,{key:o,namespaces:s}=this.extractFromKey(e[e.length-1],t),l=s[s.length-1],c=t.lng||this.language,u=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((c==null?void 0:c.toLowerCase())==="cimode"){if(u){let p=t.nsSeparator||this.options.nsSeparator;return i?{res:`${l}${p}${o}`,usedKey:o,exactUsedKey:o,usedLng:c,usedNS:l,usedParams:this.getUsedParamsDetails(t)}:`${l}${p}${o}`}return i?{res:o,usedKey:o,exactUsedKey:o,usedLng:c,usedNS:l,usedParams:this.getUsedParamsDetails(t)}:o}let d=this.resolve(e,t),f=d==null?void 0:d.res,m=(d==null?void 0:d.usedKey)||o,w=(d==null?void 0:d.exactUsedKey)||o,C=Object.prototype.toString.apply(f),k=["[object Number]","[object Function]","[object RegExp]"],v=t.joinArrays!==void 0?t.joinArrays:this.options.joinArrays,g=!this.i18nFormat||this.i18nFormat.handleAsObject,h=!ne(f)&&typeof f!="boolean"&&typeof f!="number";if(g&&f&&h&&k.indexOf(C)<0&&!(ne(v)&&Array.isArray(f))){if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");let p=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,f,{...t,ns:s}):`key '${o} (${this.language})' returned an object instead of string.`;return i?(d.res=p,d.usedParams=this.getUsedParamsDetails(t),d):p}if(a){let p=Array.isArray(f),b=p?[]:{},S=p?w:m;for(let R in f)if(Object.prototype.hasOwnProperty.call(f,R)){let B=`${S}${a}${R}`;b[R]=this.translate(B,{...t,joinArrays:!1,ns:s}),b[R]===B&&(b[R]=f[R])}f=b}}else if(g&&ne(v)&&Array.isArray(f))f=f.join(v),f&&(f=this.extendTranslation(f,e,t,n));else{let p=!1,b=!1,S=t.count!==void 0&&!ne(t.count),R=tn.hasDefaultValue(t),B=S?this.pluralResolver.getSuffix(c,t.count,t):"",F=t.ordinal&&S?this.pluralResolver.getSuffix(c,t.count,{ordinal:!1}):"",K=S&&!t.ordinal&&t.count===0,W=K&&t[`defaultValue${this.options.pluralSeparator}zero`]||t[`defaultValue${B}`]||t[`defaultValue${F}`]||t.defaultValue;!this.isValidLookup(f)&&R&&(p=!0,f=W),this.isValidLookup(f)||(b=!0,f=o);let Q=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&b?void 0:f,G=R&&W!==f&&this.options.updateMissing;if(b||p||G){if(this.logger.log(G?"updateKey":"missingKey",c,l,o,G?W:f),a){let y=this.resolve(o,{...t,keySeparator:!1});y&&y.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let Z=[],te=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if(this.options.saveMissingTo==="fallback"&&te&&te[0])for(let y=0;y<te.length;y++)Z.push(te[y]);else this.options.saveMissingTo==="all"?Z=this.languageUtils.toResolveHierarchy(t.lng||this.language):Z.push(t.lng||this.language);let se=(y,x,_)=>{var A;let E=R&&_!==f?_:Q;this.options.missingKeyHandler?this.options.missingKeyHandler(y,l,x,E,G,t):(A=this.backendConnector)!=null&&A.saveMissing&&this.backendConnector.saveMissing(y,l,x,E,G,t),this.emit("missingKey",y,l,x,f)};this.options.saveMissing&&(this.options.saveMissingPlurals&&S?Z.forEach(y=>{let x=this.pluralResolver.getSuffixes(y,t);K&&t[`defaultValue${this.options.pluralSeparator}zero`]&&x.indexOf(`${this.options.pluralSeparator}zero`)<0&&x.push(`${this.options.pluralSeparator}zero`),x.forEach(_=>{se([y],o+_,t[`defaultValue${_}`]||W)})}):se(Z,o,W))}f=this.extendTranslation(f,e,t,d,n),b&&f===o&&this.options.appendNamespaceToMissingKey&&(f=`${l}:${o}`),(b||p)&&this.options.parseMissingKeyHandler&&(f=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${l}:${o}`:o,p?f:void 0))}return i?(d.res=f,d.usedParams=this.getUsedParamsDetails(t),d):f}extendTranslation(e,t,n,i,a){var c,u;var o=this;if((c=this.i18nFormat)!=null&&c.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});let d=ne(e)&&(((u=n==null?void 0:n.interpolation)==null?void 0:u.skipOnVariables)!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables),f;if(d){let w=e.match(this.interpolator.nestingRegexp);f=w&&w.length}let m=n.replace&&!ne(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(m={...this.options.interpolation.defaultVariables,...m}),e=this.interpolator.interpolate(e,m,n.lng||this.language||i.usedLng,n),d){let w=e.match(this.interpolator.nestingRegexp),C=w&&w.length;f<C&&(n.nest=!1)}!n.lng&&i&&i.res&&(n.lng=this.language||i.usedLng),n.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var w=arguments.length,C=new Array(w),k=0;k<w;k++)C[k]=arguments[k];return(a==null?void 0:a[0])===C[0]&&!n.context?(o.logger.warn(`It seems you are nesting recursively key: ${C[0]} in key: ${t[0]}`),null):o.translate(...C,t)},n)),n.interpolation&&this.interpolator.reset()}let s=n.postProcess||this.options.postProcess,l=ne(s)?[s]:s;return e!=null&&(l!=null&&l.length)&&n.applyPostProcessor!==!1&&(e=Jo.handle(l,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),e}resolve(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n,i,a,o,s;return ne(e)&&(e=[e]),e.forEach(l=>{if(this.isValidLookup(n))return;let c=this.extractFromKey(l,t),u=c.key;i=u;let d=c.namespaces;this.options.fallbackNS&&(d=d.concat(this.options.fallbackNS));let f=t.count!==void 0&&!ne(t.count),m=f&&!t.ordinal&&t.count===0,w=t.context!==void 0&&(ne(t.context)||typeof t.context=="number")&&t.context!=="",C=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);d.forEach(k=>{var v,g;this.isValidLookup(n)||(s=k,!zo[`${C[0]}-${k}`]&&((v=this.utils)!=null&&v.hasLoadedNamespace)&&!((g=this.utils)!=null&&g.hasLoadedNamespace(s))&&(zo[`${C[0]}-${k}`]=!0,this.logger.warn(`key "${i}" for languages "${C.join(", ")}" won't get resolved as namespace "${s}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),C.forEach(h=>{var S;if(this.isValidLookup(n))return;o=h;let p=[u];if((S=this.i18nFormat)!=null&&S.addLookupKeys)this.i18nFormat.addLookupKeys(p,u,h,k,t);else{let R;f&&(R=this.pluralResolver.getSuffix(h,t.count,t));let B=`${this.options.pluralSeparator}zero`,F=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(f&&(p.push(u+R),t.ordinal&&R.indexOf(F)===0&&p.push(u+R.replace(F,this.options.pluralSeparator)),m&&p.push(u+B)),w){let K=`${u}${this.options.contextSeparator}${t.context}`;p.push(K),f&&(p.push(K+R),t.ordinal&&R.indexOf(F)===0&&p.push(K+R.replace(F,this.options.pluralSeparator)),m&&p.push(K+B))}}let b;for(;b=p.pop();)this.isValidLookup(n)||(a=b,n=this.getResource(h,k,b,t))}))})}),{res:n,usedKey:i,exactUsedKey:a,usedLng:o,usedNS:s}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,n){var a;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return(a=this.i18nFormat)!=null&&a.getResource?this.i18nFormat.getResource(e,t,n,i):this.resourceStore.getResource(e,t,n,i)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=e.replace&&!ne(e.replace),i=n?e.replace:e;if(n&&typeof e.count!="undefined"&&(i.count=e.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!n){i={...i};for(let a of t)delete i[a]}return i}static hasDefaultValue(e){let t="defaultValue";for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t===n.substring(0,t.length)&&e[n]!==void 0)return!0;return!1}},fr=class{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=ht.create("languageUtils")}getScriptPartFromCode(e){if(e=ur(e),!e||e.indexOf("-")<0)return null;let t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=ur(e),!e||e.indexOf("-")<0)return e;let t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(ne(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch(n){}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(n=>{if(t)return;let i=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(i))&&(t=i)}),!t&&this.options.supportedLngs&&e.forEach(n=>{if(t)return;let i=this.getLanguagePartFromCode(n);if(this.isSupportedCode(i))return t=i;t=this.options.supportedLngs.find(a=>{if(a===i)return a;if(!(a.indexOf("-")<0&&i.indexOf("-")<0)&&(a.indexOf("-")>0&&i.indexOf("-")<0&&a.substring(0,a.indexOf("-"))===i||a.indexOf(i)===0&&i.length>1))return a})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),ne(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}toResolveHierarchy(e,t){let n=this.getFallbackCodes(t||this.options.fallbackLng||[],e),i=[],a=o=>{o&&(this.isSupportedCode(o)?i.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return ne(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&a(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&a(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&a(this.getLanguagePartFromCode(e))):ne(e)&&a(this.formatLanguageCode(e)),n.forEach(o=>{i.indexOf(o)<0&&a(this.formatLanguageCode(o))}),i}},Ho={zero:0,one:1,two:2,few:3,many:4,other:5},Uo={select:r=>r===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})},Mi=class{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=ht.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=ur(e==="dev"?"en":e),i=t.ordinal?"ordinal":"cardinal",a=JSON.stringify({cleanedCode:n,type:i});if(a in this.pluralRulesCache)return this.pluralRulesCache[a];let o;try{o=new Intl.PluralRules(n,{type:i})}catch(s){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),Uo;if(!e.match(/-|_/))return Uo;let l=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(l,t)}return this.pluralRulesCache[a]=o,o}needsPlural(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=this.getRule(e,t);return n||(n=this.getRule("dev",t)),(n==null?void 0:n.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,n).map(i=>`${t}${i}`)}getSuffixes(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=this.getRule(e,t);return n||(n=this.getRule("dev",t)),n?n.resolvedOptions().pluralCategories.sort((i,a)=>Ho[i]-Ho[a]).map(i=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${i}`):[]}getSuffix(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=this.getRule(e,n);return i?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${i.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,n))}},Wo=function(r,e,t){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=vf(r,e,t);return!a&&i&&ne(t)&&(a=Li(r,t,n),a===void 0&&(a=Li(e,t,n))),a},Di=r=>r.replace(/\$/g,"$$$$"),Ri=class{constructor(){var t;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=ht.create("interpolator"),this.options=e,this.format=((t=e==null?void 0:e.interpolation)==null?void 0:t.format)||(n=>n),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});let{escape:t,escapeValue:n,useRawValueToEscape:i,prefix:a,prefixEscaped:o,suffix:s,suffixEscaped:l,formatSeparator:c,unescapeSuffix:u,unescapePrefix:d,nestingPrefix:f,nestingPrefixEscaped:m,nestingSuffix:w,nestingSuffixEscaped:C,nestingOptionsSeparator:k,maxReplaces:v,alwaysFormat:g}=e.interpolation;this.escape=t!==void 0?t:wf,this.escapeValue=n!==void 0?n:!0,this.useRawValueToEscape=i!==void 0?i:!1,this.prefix=a?Zt(a):o||"{{",this.suffix=s?Zt(s):l||"}}",this.formatSeparator=c||",",this.unescapePrefix=u?"":d||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=f?Zt(f):m||Zt("$t("),this.nestingSuffix=w?Zt(w):C||Zt(")"),this.nestingOptionsSeparator=k||",",this.maxReplaces=v||1e3,this.alwaysFormat=g!==void 0?g:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){let e=(t,n)=>(t==null?void 0:t.source)===n?(t.lastIndex=0,t):new RegExp(n,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,n,i){var m;let a,o,s,l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},c=w=>{if(w.indexOf(this.formatSeparator)<0){let g=Wo(t,l,w,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(g,void 0,n,{...i,...t,interpolationkey:w}):g}let C=w.split(this.formatSeparator),k=C.shift().trim(),v=C.join(this.formatSeparator).trim();return this.format(Wo(t,l,k,this.options.keySeparator,this.options.ignoreJSONStructure),v,n,{...i,...t,interpolationkey:k})};this.resetRegExp();let u=(i==null?void 0:i.missingInterpolationHandler)||this.options.missingInterpolationHandler,d=((m=i==null?void 0:i.interpolation)==null?void 0:m.skipOnVariables)!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:w=>Di(w)},{regex:this.regexp,safeValue:w=>this.escapeValue?Di(this.escape(w)):Di(w)}].forEach(w=>{for(s=0;a=w.regex.exec(e);){let C=a[1].trim();if(o=c(C),o===void 0)if(typeof u=="function"){let v=u(e,a,i);o=ne(v)?v:""}else if(i&&Object.prototype.hasOwnProperty.call(i,C))o="";else if(d){o=a[0];continue}else this.logger.warn(`missed to pass in variable ${C} for interpolating ${e}`),o="";else!ne(o)&&!this.useRawValueToEscape&&(o=Bo(o));let k=w.safeValue(o);if(e=e.replace(a[0],k),d?(w.regex.lastIndex+=o.length,w.regex.lastIndex-=a[0].length):w.regex.lastIndex=0,s++,s>=this.maxReplaces)break}}),e}nest(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,a,o,s=(l,c)=>{var C;let u=this.nestingOptionsSeparator;if(l.indexOf(u)<0)return l;let d=l.split(new RegExp(`${u}[ ]*{`)),f=`{${d[1]}`;l=d[0],f=this.interpolate(f,o);let m=f.match(/'/g),w=f.match(/"/g);(((C=m==null?void 0:m.length)!=null?C:0)%2===0&&!w||w.length%2!==0)&&(f=f.replace(/'/g,'"'));try{o=JSON.parse(f),c&&(o={...c,...o})}catch(k){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,k),`${l}${u}${f}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,l};for(;i=this.nestingRegexp.exec(e);){let l=[];o={...n},o=o.replace&&!ne(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;let c=!1;if(i[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(i[1])){let u=i[1].split(this.formatSeparator).map(d=>d.trim());i[1]=u.shift(),l=u,c=!0}if(a=t(s.call(this,i[1].trim(),o),o),a&&i[0]===e&&!ne(a))return a;ne(a)||(a=Bo(a)),a||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${e}`),a=""),c&&(a=l.reduce((u,d)=>this.format(u,d,n.lng,{...n,interpolationkey:i[1].trim()}),a.trim())),e=e.replace(i[0],a),this.regexp.lastIndex=0}return e}},Sf=r=>{let e=r.toLowerCase().trim(),t={};if(r.indexOf("(")>-1){let n=r.split("(");e=n[0].toLowerCase().trim();let i=n[1].substring(0,n[1].length-1);e==="currency"&&i.indexOf(":")<0?t.currency||(t.currency=i.trim()):e==="relativetime"&&i.indexOf(":")<0?t.range||(t.range=i.trim()):i.split(";").forEach(o=>{if(o){let[s,...l]=o.split(":"),c=l.join(":").trim().replace(/^'+|'+$/g,""),u=s.trim();t[u]||(t[u]=c),c==="false"&&(t[u]=!1),c==="true"&&(t[u]=!0),isNaN(c)||(t[u]=parseInt(c,10))}})}return{formatName:e,formatOptions:t}},Yt=r=>{let e={};return(t,n,i)=>{let a=i;i&&i.interpolationkey&&i.formatParams&&i.formatParams[i.interpolationkey]&&i[i.interpolationkey]&&(a={...a,[i.interpolationkey]:void 0});let o=n+JSON.stringify(a),s=e[o];return s||(s=r(ur(n),i),e[o]=s),s(t)}},Fi=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=ht.create("formatter"),this.options=e,this.formats={number:Yt((t,n)=>{let i=new Intl.NumberFormat(t,{...n});return a=>i.format(a)}),currency:Yt((t,n)=>{let i=new Intl.NumberFormat(t,{...n,style:"currency"});return a=>i.format(a)}),datetime:Yt((t,n)=>{let i=new Intl.DateTimeFormat(t,{...n});return a=>i.format(a)}),relativetime:Yt((t,n)=>{let i=new Intl.RelativeTimeFormat(t,{...n});return a=>i.format(a,n.range||"day")}),list:Yt((t,n)=>{let i=new Intl.ListFormat(t,{...n});return a=>i.format(a)})},this.init(e)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=t.interpolation.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=Yt(t)}format(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=t.split(this.formatSeparator);if(a.length>1&&a[0].indexOf("(")>1&&a[0].indexOf(")")<0&&a.find(s=>s.indexOf(")")>-1)){let s=a.findIndex(l=>l.indexOf(")")>-1);a[0]=[a[0],...a.splice(1,s)].join(this.formatSeparator)}return a.reduce((s,l)=>{var d;let{formatName:c,formatOptions:u}=Sf(l);if(this.formats[c]){let f=s;try{let m=((d=i==null?void 0:i.formatParams)==null?void 0:d[i.interpolationkey])||{},w=m.locale||m.lng||i.locale||i.lng||n;f=this.formats[c](s,w,{...u,...i,...m})}catch(m){this.logger.warn(m)}return f}else this.logger.warn(`there was no format function for ${c}`);return s},e)}},Ef=(r,e)=>{r.pending[e]!==void 0&&(delete r.pending[e],r.pendingCount--)},Bi=class extends en{constructor(e,t,n){var a,o;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=n,this.languageUtils=n.languageUtils,this.options=i,this.logger=ht.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],(o=(a=this.backend)==null?void 0:a.init)==null||o.call(a,n,i.backend,i)}queueLoad(e,t,n,i){let a={},o={},s={},l={};return e.forEach(c=>{let u=!0;t.forEach(d=>{let f=`${c}|${d}`;!n.reload&&this.store.hasResourceBundle(c,d)?this.state[f]=2:this.state[f]<0||(this.state[f]===1?o[f]===void 0&&(o[f]=!0):(this.state[f]=1,u=!1,o[f]===void 0&&(o[f]=!0),a[f]===void 0&&(a[f]=!0),l[d]===void 0&&(l[d]=!0)))}),u||(s[c]=!0)}),(Object.keys(a).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(a),pending:Object.keys(o),toLoadLanguages:Object.keys(s),toLoadNamespaces:Object.keys(l)}}loaded(e,t,n){let i=e.split("|"),a=i[0],o=i[1];t&&this.emit("failedLoading",a,o,t),!t&&n&&this.store.addResourceBundle(a,o,n,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&n&&(this.state[e]=0);let s={};this.queue.forEach(l=>{mf(l.loaded,[a],o),Ef(l,e),t&&l.errors.push(t),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(c=>{s[c]||(s[c]={});let u=l.loaded[c];u.length&&u.forEach(d=>{s[c][d]===void 0&&(s[c][d]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",s),this.queue=this.queue.filter(l=>!l.done)}read(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,o=arguments.length>5?arguments[5]:void 0;if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:n,tried:i,wait:a,callback:o});return}this.readingCalls++;let s=(c,u)=>{if(this.readingCalls--,this.waitingReads.length>0){let d=this.waitingReads.shift();this.read(d.lng,d.ns,d.fcName,d.tried,d.wait,d.callback)}if(c&&u&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,n,i+1,a*2,o)},a);return}o(c,u)},l=this.backend[n].bind(this.backend);if(l.length===2){try{let c=l(e,t);c&&typeof c.then=="function"?c.then(u=>s(null,u)).catch(s):s(null,c)}catch(c){s(c)}return}return l(e,t,s)}prepareLoading(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();ne(e)&&(e=this.languageUtils.toResolveHierarchy(e)),ne(t)&&(t=[t]);let a=this.queueLoad(e,t,n,i);if(!a.toLoad.length)return a.pending.length||i(),null;a.toLoad.forEach(o=>{this.loadOne(o)})}load(e,t,n){this.prepareLoading(e,t,{},n)}reload(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}loadOne(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=e.split("|"),i=n[0],a=n[1];this.read(i,a,"read",void 0,void 0,(o,s)=>{o&&this.logger.warn(`${t}loading namespace ${a} for language ${i} failed`,o),!o&&s&&this.logger.log(`${t}loaded namespace ${a} for language ${i}`,s),this.loaded(e,o,s)})}saveMissing(e,t,n,i,a){var l,c,u,d,f;let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if((c=(l=this.services)==null?void 0:l.utils)!=null&&c.hasLoadedNamespace&&!((d=(u=this.services)==null?void 0:u.utils)!=null&&d.hasLoadedNamespace(t))){this.logger.warn(`did not save key "${n}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if((f=this.backend)!=null&&f.create){let m={...o,isUpdate:a},w=this.backend.create.bind(this.backend);if(w.length<6)try{let C;w.length===5?C=w(e,t,n,i,m):C=w(e,t,n,i),C&&typeof C.then=="function"?C.then(k=>s(null,k)).catch(s):s(null,C)}catch(C){s(C)}else w(e,t,n,i,s,m)}!e||!e[0]||this.store.addResource(e[0],t,n,i)}}},Vo=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:r=>{let e={};if(typeof r[1]=="object"&&(e=r[1]),ne(r[1])&&(e.defaultValue=r[1]),ne(r[2])&&(e.tDescription=r[2]),typeof r[2]=="object"||typeof r[3]=="object"){let t=r[3]||r[2];Object.keys(t).forEach(n=>{e[n]=t[n]})}return e},interpolation:{escapeValue:!0,format:r=>r,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),Ko=r=>{var e,t;return ne(r.ns)&&(r.ns=[r.ns]),ne(r.fallbackLng)&&(r.fallbackLng=[r.fallbackLng]),ne(r.fallbackNS)&&(r.fallbackNS=[r.fallbackNS]),((t=(e=r.supportedLngs)==null?void 0:e.indexOf)==null?void 0:t.call(e,"cimode"))<0&&(r.supportedLngs=r.supportedLngs.concat(["cimode"])),typeof r.initImmediate=="boolean"&&(r.initAsync=r.initImmediate),r},lr=()=>{},Cf=r=>{Object.getOwnPropertyNames(Object.getPrototypeOf(r)).forEach(t=>{typeof r[t]=="function"&&(r[t]=r[t].bind(r))})},$t=class extends en{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(super(),this.options=Ko(e),this.services={},this.logger=ht,this.modules={external:[]},Cf(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof t=="function"&&(n=t,t={}),t.defaultNS==null&&t.ns&&(ne(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));let i=Vo();this.options={...i,...this.options,...Ko(t)},this.options.interpolation={...i.interpolation,...this.options.interpolation},t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);let a=u=>u?typeof u=="function"?new u:u:null;if(!this.options.isClone){this.modules.logger?ht.init(a(this.modules.logger),this.options):ht.init(null,this.options);let u;this.modules.formatter?u=this.modules.formatter:u=Fi;let d=new fr(this.options);this.store=new dr(this.options.resources,this.options);let f=this.services;f.logger=ht,f.resourceStore=this.store,f.languageUtils=d,f.pluralResolver=new Mi(d,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),u&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(f.formatter=a(u),f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new Ri(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new Bi(a(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",function(m){for(var w=arguments.length,C=new Array(w>1?w-1:0),k=1;k<w;k++)C[k-1]=arguments[k];e.emit(m,...C)}),this.modules.languageDetector&&(f.languageDetector=a(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=a(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new tn(this.services,this.options),this.translator.on("*",function(m){for(var w=arguments.length,C=new Array(w>1?w-1:0),k=1;k<w;k++)C[k-1]=arguments[k];e.emit(m,...C)}),this.modules.external.forEach(m=>{m.init&&m.init(this)})}if(this.format=this.options.interpolation.format,n||(n=lr),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){let u=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);u.length>0&&u[0]!=="dev"&&(this.options.lng=u[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(u=>{this[u]=function(){return e.store[u](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(u=>{this[u]=function(){return e.store[u](...arguments),e}});let l=An(),c=()=>{let u=(d,f)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(f),n(d,f)};if(this.languages&&!this.isInitialized)return u(null,this.t.bind(this));this.changeLanguage(this.options.lng,u)};return this.options.resources||!this.options.initAsync?c():setTimeout(c,0),l}loadResources(e){var a,o;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lr,i=ne(e)?e:this.language;if(typeof e=="function"&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if((i==null?void 0:i.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();let s=[],l=c=>{if(!c||c==="cimode")return;this.services.languageUtils.toResolveHierarchy(c).forEach(d=>{d!=="cimode"&&s.indexOf(d)<0&&s.push(d)})};i?l(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(u=>l(u)),(o=(a=this.options.preload)==null?void 0:a.forEach)==null||o.call(a,c=>l(c)),this.services.backendConnector.load(s,this.options.ns,c=>{!c&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(c)})}else n(null)}reloadResources(e,t,n){let i=An();return typeof e=="function"&&(n=e,e=void 0),typeof t=="function"&&(n=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),n||(n=lr),this.services.backendConnector.reload(e,t,a=>{i.resolve(),n(a)}),i}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&Jo.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let t=0;t<this.languages.length;t++){let n=this.languages[t];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}changeLanguage(e,t){var n=this;this.isLanguageChangingTo=e;let i=An();this.emit("languageChanging",e);let a=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},o=(l,c)=>{c?(a(c),this.translator.changeLanguage(c),this.isLanguageChangingTo=void 0,this.emit("languageChanged",c),this.logger.log("languageChanged",c)):this.isLanguageChangingTo=void 0,i.resolve(function(){return n.t(...arguments)}),t&&t(l,function(){return n.t(...arguments)})},s=l=>{var u,d;!e&&!l&&this.services.languageDetector&&(l=[]);let c=ne(l)?l:this.services.languageUtils.getBestMatchFromCodes(l);c&&(this.language||a(c),this.translator.language||this.translator.changeLanguage(c),(d=(u=this.services.languageDetector)==null?void 0:u.cacheUserLanguage)==null||d.call(u,c)),this.loadResources(c,f=>{o(f,c)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?s(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(s):this.services.languageDetector.detect(s):s(e),i}getFixedT(e,t,n){var i=this;let a=function(o,s){let l;if(typeof s!="object"){for(var c=arguments.length,u=new Array(c>2?c-2:0),d=2;d<c;d++)u[d-2]=arguments[d];l=i.options.overloadTranslationOptionHandler([o,s].concat(u))}else l={...s};l.lng=l.lng||a.lng,l.lngs=l.lngs||a.lngs,l.ns=l.ns||a.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||n||a.keyPrefix);let f=i.options.keySeparator||".",m;return l.keyPrefix&&Array.isArray(o)?m=o.map(w=>`${l.keyPrefix}${f}${w}`):m=l.keyPrefix?`${l.keyPrefix}${f}${o}`:o,i.t(m,l)};return ne(e)?a.lng=e:a.lngs=e,a.ns=t,a.keyPrefix=n,a}t(){var i;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(i=this.translator)==null?void 0:i.translate(...t)}exists(){var i;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(i=this.translator)==null?void 0:i.exists(...t)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;let n=t.lng||this.resolvedLanguage||this.languages[0],i=this.options?this.options.fallbackLng:!1,a=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;let o=(s,l)=>{let c=this.services.backendConnector.state[`${s}|${l}`];return c===-1||c===0||c===2};if(t.precheck){let s=t.precheck(this,o);if(s!==void 0)return s}return!!(this.hasResourceBundle(n,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(n,e)&&(!i||o(a,e)))}loadNamespaces(e,t){let n=An();return this.options.ns?(ne(e)&&(e=[e]),e.forEach(i=>{this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}),this.loadResources(i=>{n.resolve(),t&&t(i)}),n):(t&&t(),Promise.resolve())}loadLanguages(e,t){let n=An();ne(e)&&(e=[e]);let i=this.options.preload||[],a=e.filter(o=>i.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return a.length?(this.options.preload=i.concat(a),this.loadResources(o=>{n.resolve(),t&&t(o)}),n):(t&&t(),Promise.resolve())}dir(e){var i,a;if(e||(e=this.resolvedLanguage||(((i=this.languages)==null?void 0:i.length)>0?this.languages[0]:this.language)),!e)return"rtl";let t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=((a=this.services)==null?void 0:a.languageUtils)||new fr(Vo());return t.indexOf(n.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return new $t(e,t)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:lr,n=e.forkResourceStore;n&&delete e.forkResourceStore;let i={...this.options,...e,isClone:!0},a=new $t(i);if((e.debug!==void 0||e.prefix!==void 0)&&(a.logger=a.logger.clone(e)),["store","services","language"].forEach(s=>{a[s]=this[s]}),a.services={...this.services},a.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},n){let s=Object.keys(this.store.data).reduce((l,c)=>(l[c]={...this.store.data[c]},Object.keys(l[c]).reduce((u,d)=>(u[d]={...l[c][d]},u),{})),{});a.store=new dr(s,i),a.services.resourceStore=a.store}return a.translator=new tn(a.services,i),a.translator.on("*",function(s){for(var l=arguments.length,c=new Array(l>1?l-1:0),u=1;u<l;u++)c[u-1]=arguments[u];a.emit(s,...c)}),a.init(i,t),a.translator.options=i,a.translator.backendConnector.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}},De=$t.createInstance();De.createInstance=$t.createInstance;kw=De.createInstance,Sw=De.dir,Ew=De.init,Cw=De.loadResources,Tw=De.reloadResources,Aw=De.use,Pw=De.changeLanguage,$w=De.getFixedT,Iw=De.t,Dw=De.exists,Ow=De.setDefaultNamespace,Lw=De.hasLoadedNamespace,Mw=De.loadNamespaces,Rw=De.loadLanguages});var Yo,Zo=j(()=>{Yo={assets:{draft:"Draft",image:"Image","invalid-draft":"Invalid draft: missing account name or note path.",news:"News",video:"Video",voice:"Voice"},main:{"no-wechat-mp-account-selected":"No WeChat MP account selected.","please-check-you-appid-and-appsecret":"Please check your AppID and AppSecret.","open-previewer":"Article render previewer","fetch-wechat-profile":"Fetching WeChat profile","insert-mpcard":"Insert official account card","mpcard-not-configured":"No official account card configured. Paste the HTML in publish config first."},modals:{"be-careful":"Caution!",cancel:"Cancel",caution:"Caution!",confirm:"Confirm",delete:{action:"To proceed with deletion, click below.",message:"Are you sure you want to delete this item?",title:"Confirm Delete",warning:"This action is permanent and cannot be undone."},enter:"Enter",escape:"Escape",mpcard:{empty:"Please paste official account card content.",hint:"Copy the official account card code block from WeChat backend and paste it here.",insert:"Insert",placeholder:"Example:\n```mpcard\nid: gh_xxx\nheadimg: https://...\nnickname: Official Account\nsignature: Account description\n```",title:"Insert official account card"},ok:"OK",publish:{failed:"Publication failed",message:"Are you sure you want to publish this article?",success:"Published successfully",title:"Confirm publish",warning:"Publishing outside of WeChat MP may not be as efficient and some features might not work as expected (e.g., tags, pushing to public accounts)."},"publish-config":{"card-tab":"Official account card","options-tab":"Article options","mpcard-desc":"Paste the HTML code copied after inserting an official account card in WeChat editor.","copy-script":"Copy extract script","script-copied":"Script copied to clipboard.","mpcard-input":"Card HTML","mpcard-input-desc":"Paste <mp-common-profile> or a <section> that contains it.","mpcard-empty":"No official account card configured.","save-mpcard":"Parse and save","clear-mpcard":"Clear card","no-account":"No official account selected.","invalid-mpcard":"Invalid card content or missing data-id.","mpcard-saved":"Official account card saved.","no-active-file":"No active Markdown file.",title:"Title",author:"Author",digest:"Digest","source-url":"Source URL","open-comment":"Enable comments","only-fans":"Fans only comments","cover-empty":"Cover image not set."},space:"Space"},render:{"admonition-failed":"<section>Admonition rendering failed</section>","callout-failed":"<span>Callout rendering failed</span>","charts-failed":"<section>Charts rendering failed</section>","excalidraw-failed":"Excalidraw rendering failed","faild-canvas-context":"Failed to get canvas context.","failed-to-convert-canvas-to-blob":"Failed to convert canvas to Blob.","file-not-found":"File not found: {0}","mermaid-failed":"<section>Mermaid rendering failed</section>","pdf-crop-failed":"<span>Pdf cropping failed</span>","render-failed":"Rendering failed.","charts-plugin-not-installed":"Charts plugin not installed.","mpcard-default-name":"Official Account","mpcard-default-signature":"Account description",rendering:"Rendering...","failed-to-parse-custom-css":"Custom CSS parsing failed: {0}"},settings:{"account-info":"Account info","account-name":"Public account name","account-name-for-your-wechat-official":"WeChat official account name","add-ip-address-ipv4-0-to-wechat-mp-ip-wh":"Add IP address [{0}] to WeChat MP IP whitelist.",appid:"AppID","app-secret":"AppSecret","app-secret-for-your-wechat-official":"AppSecret for your WeChat official account","appid-for-your-wechat-official-account":"AppID for your WeChat official account","be-carefull-delete-account":"Caution! This will delete all settings and data for the account.","check-if-your-account-setting-is-correct":"Check if your account settings are correct.","click-to-connect-wechat-server":"Click to connect to WeChat server","successfully-connected-to-wechat-server":"Successfully connected to WeChat server.",fetching:"Fetching...","failed-to-connect-to-wechat-server":"Failed to connect to WeChat server.","copy-ip-address-to-clipboard":"Copy IP address to clipboard","copy-ip-to-clipboard":"Copy IP to clipboard","clipboard-not-supported":"Clipboard is not available on this platform.","create-new-account":"Create new account","custom-themes":"Custom themes","custom-themes-folder":"Custom themes folder","general-settings":"General settings","default-mpcard-biz-id":"Biz ID (data-id)","default-mpcard-biz-id-desc":"Base64 ID from the HTML.","delete-account":"Delete account","draft-previewer-wechat-id":"Draft previewer WeChat ID","draft-only-visible-for-the-wechat-user-o":"Draft visible only to the WeChat user. Requires API permission.","preview-draft-tooltip":"Send preview (API permission required)","enable-real-time-rendering":"Enable real-time rendering of markdown content","real-time-render":"Real-time Render","failed-to-get-wechat-access-token":"Failed to get WeChat access token.","if-your-device-cannot-get-static-pubic-i":"If your device cannot get a static public IP, use our center token server to get tokens. We will not misuse your AppID or AppSecret.","appid-secret-guide":"AppID and AppSecret are now available in WeChat Developer Console \u2192 Official Account \u2192 Basic Info.","appid-secret-guide-link":"Open WeChat Developer Console to get AppID / AppSecret","import-account-info":"Import Account Info","export-account-info":"Export Account Info","import-export-one2mp-account":"Import/Export Account Information","import-or-export-your-account-info-for-b":"Import or export your account info for backup and restore.","import-settings-title":"Import settings from vault","import-settings-hint":"Select a JSON settings file stored in your vault.","import-settings-placeholder":"Type or select a JSON file path","import-settings-confirm":"Import","import-settings-empty-path":"Please choose a settings file.","import-settings-file-not-found":"Settings file not found.","invalid-json-file":"Invalid JSON file.","invalid-wewerite-settings-file":"Invalid One2MP settings file.","ip-copied-to-clipboard":"IP copied to clipboard.","new-account":"New account","no-ip-address":"No IP address","public-ip-address":"Public IP address","select-account":"Select account","select-wechat-mp-account":"Select WeChat MP account","send-article-to-draft-box-successfully":"Article sent to draft box successfully.","settings-exported":"Settings exported successfully.","settings-exporting-failed":"Failed to export settings.","settings-exported-to-vault":"Settings exported to vault: {0}","settings-imported-error":"Error importing settings.","settings-imported-failed":"Failed to import settings.","settings-imported-successfully":"Settings imported successfully.","default-mpcard":"Default official account card","default-mpcard-desc":"Save a default official account card (used for right-click insert).","default-mpcard-placeholder":"Paste the official account card code block","default-mpcard-id":"Account ID","default-mpcard-id-desc":"Official account user_name.","default-mpcard-id-placeholder":"gh_xxx","default-mpcard-headimg":"Avatar URL","default-mpcard-headimg-desc":"Official account avatar link.","default-mpcard-headimg-placeholder":"https://...","default-mpcard-nickname":"Account name","default-mpcard-nickname-desc":"Official account display name.","default-mpcard-nickname-placeholder":"Account name","default-mpcard-signature":"Account description","default-mpcard-signature-desc":"Official account description.","default-mpcard-signature-placeholder":"Account description","default-mpcard-sync":"Sync account info","default-mpcard-sync-success":"Default official account card synced.","default-mpcard-sync-failed":"Failed to sync official account card.","default-mpcard-sync-partial":"Only nickname was synced. Please fill avatar/signature manually.","theme-download-overwrite":"Overwrite themes on download","theme-download-overwrite-desc":"When enabled, download will overwrite existing themes with the same name.","test-connection":"Test connection","choose-the-account-to-modify":"Choose the account to modify","the-folder-where-your-custom-themes":"Folder where your custom themes are stored.","themes-folder-path":"Themes folder path","use-center-token-server":"Use center token server","wechat-account":"WeChat account","you-should-add-this-ip-to-ip-whitelist-o":'Add this IP address to whitelist. Click the image in "account information" below to visit the WeChat MP platform.',"your-wechat-official-account":"Your WeChat official account"},views:{"article-header":{"article-title":"Article title","article-title-placeholder":"Enter article title",author:"Author","author-name":"Author name","comments-description":"Comments are closed by default.","cover-image":"Cover image","cover-image-description":"Cover image is required. Drag from vault or use an online image URL.","cover-file-not-supported":"Local file cover is not supported on mobile. Use a vault image or URL.","cover-image-mobile-button":"Choose/upload cover","cover-image-mobile-title":"Set cover image","cover-image-mobile-vault":"Select from vault","cover-image-mobile-vault-desc":"Choose an image path from the vault.","cover-image-mobile-vault-placeholder":"Type or select an image path","cover-image-mobile-url":"Use an image URL","cover-image-mobile-url-desc":"Enter an image URL.","cover-image-mobile-required":"Provide at least one cover image source.","cover-image-mobile-invalid":"Invalid image path. Please check and try again.","reset-cover-crop":"Reset crop",digest:"Digest","digest-text":"Enter digest text","only-fans-can-comment":"Only fans can comment","only-fans-can-comment-description":"Everyone can comment by default.","open-comments":"Open comments","testing-button":"Testing button",title:"Draft header"},"delete-draft":"Delete draft","delete-image":"Delete image","free-publish":"Free publish","no-title-article":"Article without title.","other-type-has-not-been-implemented":"Other type not implemented.","preview-draft":"Preview draft",previewer:{"article-copied-to-clipboard":"Article copied to clipboard.","open-url-not-supported":"Opening links is not supported on this platform.","article-render-failed":"Failed to render article.","article-title":"Article title","copy-article-to-clipboard":"Copy article to clipboard","publish-config":"Publish config","generate-template":"Generate WeChat template","file-not-found-path":"File not found: {0}","not-a-markdown-view":"Not a markdown view","please-set-cover-image":"Please set a cover image.","preview-draft-missing-id":"Send to draft first before previewing.","preview-draft-missing-wxid":"Set the previewer WeChat ID in Publish config first.","preview-draft-sent":"Preview message sent to WeChat.","render-article":"Render article","send-article-to-draft-box":"Send article to draft box","template-created":"WeChat template created.","template-file-created":"Template file created: one2mp-template.md","testing-button":"Testing button","to-verify-the-images-in-article":"Verify images in the article","one2mp-previewer":"O2Any previewer"},"send-mass-message":"Send mass message","theme-manager":{"default-theme":"Default theme","download-predefined-custom-themes":"Download predefined custom themes","download-started":"Theme download started. Please wait\u2026","download-themes-mobile-not-supported":"Theme download is not supported on mobile.","download-summary":"Theme download finished: {0} success, {1} failed, {2} skipped","error-downloading-theme":"Error downloading theme","error-downloading-themes":"Error downloading themes.","failed-to-fetch-themes-json-themesrespon":"Failed to fetch themes.json: {0}","total-themes-length-themes-downloaded":"Total {0} themes downloaded."},platform:{wechat:"WeChat",zhihu:"Zhihu",redbook:"Xiaohongshu"},zhihu:{copy:"Copy",open:"Open Zhihu",refresh:"Refresh",copied:"Copied to clipboard."},redbook:{copy:"Copy Text",export:"Export Package",open:"Open Xiaohongshu",refresh:"Refresh",copied:"Text copied.",empty:"No text to copy.","no-active-file":"No active Markdown file."}},"wechat-api":{"add-ip-address-ipv4-0-to-wechat-mp-ip-wh":"Add IP address [{0}] to WeChat MP IP whitelist.","failed-to-get-wechat-access-token":"Failed to get WeChat access token.","image-size-exceeds-10m":"Image size exceeds 10MB limit","video-size-exceeds-10m":"Video size exceeds 10MB limit","voice-size-exceeds-2m":"Voice size exceeds 2MB limit","select-an-wechat-mp-account-first":"Select a WeChat MP account first.","send-article-to-draft-box-successfully":"Article sent to draft box successfully.","uploading-material-type":"uploading material {0}"}}});var es,Xo=j(()=>{es={assets:{draft:"\u8349\u7A3F",image:"\u56FE\u7247","invalid-draft":"\u65E0\u6548\u8349\u7A3F\uFF1A\u7F3A\u5C11\u8D26\u53F7\u540D\u79F0\u6216\u7B14\u8BB0\u8DEF\u5F84\u3002",news:"\u56FE\u6587\u6D88\u606F",video:"\u89C6\u9891",voice:"\u8BED\u97F3"},main:{"no-wechat-mp-account-selected":"\u672A\u9009\u62E9\u5FAE\u4FE1\u516C\u4F17\u53F7\u8D26\u53F7\u3002","please-check-you-appid-and-appsecret":"\u8BF7\u68C0\u67E5\u60A8\u7684AppID\u548CAppSecret\u3002","open-previewer":"\u6587\u7AE0\u6E32\u67D3\u9884\u89C8","fetch-wechat-profile":"\u63D0\u53D6\u516C\u4F17\u53F7\u4FE1\u606F","insert-mpcard":"\u63D2\u5165\u516C\u4F17\u53F7\u540D\u7247","mpcard-not-configured":"\u672A\u914D\u7F6E\u516C\u4F17\u53F7\u540D\u7247\uFF0C\u8BF7\u5148\u5728\u53D1\u5E03\u914D\u7F6E\u4E2D\u7C98\u8D34\u516C\u4F17\u53F7\u540D\u7247HTML\u3002"},modals:{"be-careful":"\u6CE8\u610F\uFF01",cancel:"\u53D6\u6D88",caution:"\u6CE8\u610F\uFF01",confirm:"\u786E\u8BA4",delete:{action:"\u70B9\u51FB\u4E0B\u65B9\u6309\u94AE\u7EE7\u7EED\u5220\u9664\u3002",message:"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u9879\u5417\uFF1F",title:"\u786E\u8BA4\u5220\u9664",warning:"\u6B64\u64CD\u4F5C\u4E0D\u53EF\u64A4\u9500\u3002"},enter:"\u56DE\u8F66",escape:"Esc\u952E",mpcard:{empty:"\u8BF7\u8F93\u5165\u516C\u4F17\u53F7\u540D\u7247\u5185\u5BB9\u3002",hint:"\u8BF7\u5728\u516C\u4F17\u53F7\u540E\u53F0\u590D\u5236\u516C\u4F17\u53F7\u540D\u7247\u7684\u4EE3\u7801\u5757\u5185\u5BB9\uFF0C\u5E76\u7C98\u8D34\u5230\u8FD9\u91CC\u3002",insert:"\u63D2\u5165",placeholder:"\u793A\u4F8B:\n```mpcard\nid: gh_xxx\nheadimg: https://...\nnickname: \u516C\u4F17\u53F7\u540D\u79F0\nsignature: \u516C\u4F17\u53F7\u4ECB\u7ECD\n```",title:"\u63D2\u5165\u516C\u4F17\u53F7\u540D\u7247"},ok:"\u786E\u5B9A",publish:{failed:"\u53D1\u5E03\u5931\u8D25",message:"\u786E\u5B9A\u8981\u53D1\u5E03\u8FD9\u7BC7\u6587\u7AE0\u5417\uFF1F",success:"\u53D1\u5E03\u6210\u529F",title:"\u786E\u8BA4\u53D1\u5E03",warning:"\u5728\u5FAE\u4FE1\u516C\u4F17\u53F7\u5E73\u53F0\u5916\u53D1\u5E03\u53EF\u80FD\u6548\u7387\u8F83\u4F4E\uFF0C\u90E8\u5206\u529F\u80FD\u53EF\u80FD\u65E0\u6CD5\u6B63\u5E38\u4F7F\u7528\uFF08\u5982\u6807\u7B7E\u3001\u63A8\u9001\u5230\u516C\u4F17\u53F7\u7B49\uFF09\u3002"},space:"\u7A7A\u683C"},"publish-config":{title:"\u6587\u7AE0\u53D1\u5E03\u914D\u7F6E","mp-card-settings":"\u516C\u4F17\u53F7\u540D\u7247\u914D\u7F6E","paste-html-guide":"\u8BF7\u4ECE\u6D4F\u89C8\u5668\u63D2\u4EF6\u6216\u516C\u4F17\u53F7\u540E\u53F0\u590D\u5236\u540D\u7247 HTML \u4EE3\u7801 (<mp-common-profile...>) \u5E76\u7C98\u8D34\u5230\u4E0B\u65B9\uFF1A","parse-and-save":"\u89E3\u6790\u5E76\u4FDD\u5B58","card-updated":"\u540D\u7247\u4FE1\u606F\u5DF2\u66F4\u65B0","parse-failed":"\u89E3\u6790\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5 HTML \u4EE3\u7801\u683C\u5F0F","manual-edit":"\u624B\u52A8\u7F16\u8F91 (\u9AD8\u7EA7)","other-settings":"\u5176\u4ED6\u53D1\u5E03\u53C2\u6570","card-tab":"\u516C\u4F17\u53F7\u540D\u7247","options-tab":"\u6587\u7AE0\u53C2\u6570","mpcard-desc":"\u8BF7\u7C98\u8D34\u516C\u4F17\u53F7\u540E\u53F0\u4E2D\u63D2\u5165\u540D\u7247\u540E\u590D\u5236\u5230\u7684 HTML \u4EE3\u7801\u3002","copy-script":"\u590D\u5236\u63D0\u53D6\u811A\u672C","script-copied":"\u811A\u672C\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F\u3002","mpcard-input":"\u540D\u7247 HTML","mpcard-input-desc":"\u7C98\u8D34 <mp-common-profile> \u6216\u5305\u542B\u5B83\u7684 <section> \u4EE3\u7801\u3002","mpcard-empty":"\u5C1A\u672A\u914D\u7F6E\u516C\u4F17\u53F7\u540D\u7247\u3002","save-mpcard":"\u89E3\u6790\u5E76\u4FDD\u5B58","clear-mpcard":"\u6E05\u7A7A\u540D\u7247","no-account":"\u672A\u9009\u62E9\u516C\u4F17\u53F7\u8D26\u53F7\u3002","invalid-mpcard":"\u540D\u7247\u5185\u5BB9\u65E0\u6548\u6216\u7F3A\u5C11 data-id\u3002","mpcard-saved":"\u516C\u4F17\u53F7\u540D\u7247\u5DF2\u4FDD\u5B58\u3002","no-active-file":"\u672A\u627E\u5230\u53EF\u7F16\u8F91\u7684 Markdown \u6587\u4EF6\u3002","field-title":"\u6807\u9898",author:"\u4F5C\u8005",digest:"\u6458\u8981","source-url":"\u539F\u6587\u94FE\u63A5","open-comment":"\u5F00\u542F\u8BC4\u8BBA","only-fans":"\u4EC5\u7C89\u4E1D\u53EF\u8BC4\u8BBA","cover-empty":"\u672A\u8BBE\u7F6E\u5C01\u9762\u56FE\u3002"},render:{"admonition-failed":"<section>Admonition\u6E32\u67D3\u5931\u8D25</section>","callout-failed":"<span>Callout\u6E32\u67D3\u5931\u8D25</span>","charts-failed":"<section>\u56FE\u8868\u6E32\u67D3\u5931\u8D25</section>","excalidraw-failed":"Excalidraw\u6E32\u67D3\u5931\u8D25","faild-canvas-context":"\u83B7\u53D6canvas\u4E0A\u4E0B\u6587\u5931\u8D25\u3002","failed-to-convert-canvas-to-blob":"\u5C06canvas\u8F6C\u6362\u4E3ABlob\u5931\u8D25\u3002","file-not-found":"\u6587\u4EF6\u672A\u627E\u5230\uFF1A{0}","mermaid-failed":"<section>Mermaid\u6E32\u67D3\u5931\u8D25</section>","pdf-crop-failed":"<span>PDF\u88C1\u526A\u5931\u8D25</span>","render-failed":"\u6E32\u67D3\u5931\u8D25\u3002","charts-plugin-not-installed":"\u56FE\u8868\u63D2\u4EF6\u672A\u5B89\u88C5\u3002","mpcard-default-name":"\u516C\u4F17\u53F7\u540D\u79F0","mpcard-default-signature":"\u516C\u4F17\u53F7\u4ECB\u7ECD",rendering:"\u6E32\u67D3\u4E2D...","failed-to-parse-custom-css":"\u5B9A\u5236\u98CE\u683C\u5B58\u5728CSS\u8BED\u6CD5\u9519\u8BEF\uFF1A{0}"},settings:{"account-info":"\u8D26\u53F7\u4FE1\u606F","account-name":"\u516C\u4F17\u53F7\u540D\u79F0","account-name-for-your-wechat-official":"\u5FAE\u4FE1\u516C\u4F17\u53F7\u540D\u79F0","add-ip-address-ipv4-0-to-wechat-mp-ip-wh":"\u5C06IP\u5730\u5740[{0}]\u6DFB\u52A0\u5230\u5FAE\u4FE1\u516C\u4F17\u53F7IP\u767D\u540D\u5355\u3002",appid:"AppID","app-secret":"AppSecret","app-secret-for-your-wechat-official":"\u5FAE\u4FE1\u516C\u4F17\u53F7AppSecret","appid-for-your-wechat-official-account":"\u5FAE\u4FE1\u516C\u4F17\u53F7AppID","be-carefull-delete-account":"\u6CE8\u610F\uFF01\u8FD9\u5C06\u5220\u9664\u8BE5\u8D26\u53F7\u7684\u6240\u6709\u8BBE\u7F6E\u548C\u6570\u636E\u3002","check-if-your-account-setting-is-correct":"\u68C0\u67E5\u8D26\u53F7\u8BBE\u7F6E\u662F\u5426\u6B63\u786E\u3002","click-to-connect-wechat-server":"\u70B9\u51FB\u8FDE\u63A5\u5FAE\u4FE1\u670D\u52A1\u5668","successfully-connected-to-wechat-server":"\u6210\u529F\u8FDE\u63A5\u5230\u5FAE\u4FE1\u670D\u52A1\u5668\u3002",fetching:"\u83B7\u53D6\u4E2D...","failed-to-connect-to-wechat-server":"\u8FDE\u63A5\u5FAE\u4FE1\u670D\u52A1\u5668\u5931\u8D25\u3002","copy-ip-address-to-clipboard":"\u590D\u5236IP\u5730\u5740\u5230\u526A\u8D34\u677F","copy-ip-to-clipboard":"\u590D\u5236IP\u5230\u526A\u8D34\u677F","clipboard-not-supported":"\u5F53\u524D\u5E73\u53F0\u4E0D\u652F\u6301\u526A\u8D34\u677F\u3002","create-new-account":"\u521B\u5EFA\u65B0\u8D26\u53F7","custom-themes":"\u81EA\u5B9A\u4E49\u4E3B\u9898","custom-themes-folder":"\u81EA\u5B9A\u4E49\u4E3B\u9898\u6587\u4EF6\u5939","theme-download-overwrite":"\u4E0B\u8F7D\u4E3B\u9898\u65F6\u8986\u76D6\u540C\u540D\u6587\u4EF6","theme-download-overwrite-desc":"\u5F00\u542F\u5219\u8986\u76D6\u5DF2\u6709\u540C\u540D\u4E3B\u9898\uFF0C\u5173\u95ED\u5219\u8DF3\u8FC7\u3002","general-settings":"\u901A\u7528\u8BBE\u7F6E","default-mpcard-biz-id":"Biz ID\uFF08data-id\uFF09","default-mpcard-biz-id-desc":"HTML \u4E2D\u7684 base64 ID\u3002","delete-account":"\u5220\u9664\u8D26\u53F7","draft-previewer-wechat-id":"\u8349\u7A3F\u9884\u89C8\u8005\u5FAE\u4FE1ID","draft-only-visible-for-the-wechat-user-o":"\u8349\u7A3F\u4EC5\u5BF9\u5FAE\u4FE1\u7528\u6237\u53EF\u89C1\uFF0C\u9700\u516C\u4F17\u53F7\u63A5\u53E3\u6743\u9650\u3002","preview-draft-tooltip":"\u53D1\u9001\u8349\u7A3F\u9884\u89C8\uFF08\u9700\u63A5\u53E3\u6743\u9650\uFF09","enable-real-time-rendering":"\u542F\u7528Markdown\u5185\u5BB9\u7684\u5B9E\u65F6\u6E32\u67D3","real-time-render":"\u5B9E\u65F6\u6E32\u67D3","failed-to-get-wechat-access-token":"\u83B7\u53D6\u5FAE\u4FE1access token\u5931\u8D25\u3002","if-your-device-cannot-get-static-pubic-i":"\u5982\u679C\u60A8\u7684\u8BBE\u5907\u65E0\u6CD5\u83B7\u53D6\u9759\u6001\u516C\u7F51IP\uFF0C\u8BF7\u4F7F\u7528\u6211\u4EEC\u7684\u4E2D\u5FC3\u4EE4\u724C\u670D\u52A1\u5668\u83B7\u53D6\u4EE4\u724C\u3002\u6211\u4EEC\u4E0D\u4F1A\u6EE5\u7528\u60A8\u7684AppID\u6216AppSecret\u3002","appid-secret-guide":"AppID \u4E0E AppSecret \u73B0\u5728\u9700\u8981\u5728\u300C\u5FAE\u4FE1\u5F00\u53D1\u8005\u5E73\u53F0-\u516C\u4F17\u53F7-\u57FA\u7840\u4FE1\u606F\u300D\u4E2D\u83B7\u53D6\u3002","appid-secret-guide-link":"\u6253\u5F00\u5FAE\u4FE1\u5F00\u53D1\u8005\u5E73\u53F0\u83B7\u53D6 AppID / AppSecret","import-account-info":"\u5BFC\u5165\u8D26\u53F7\u4FE1\u606F","export-account-info":"\u5BFC\u51FA\u8D26\u53F7\u4FE1\u606F","import-export-one2mp-account":"\u5BFC\u5165/\u5BFC\u51FA\u8D26\u53F7\u4FE1\u606F","import-or-export-your-account-info-for-b":"\u5BFC\u5165\u6216\u5BFC\u51FA\u60A8\u7684\u8D26\u53F7\u4FE1\u606F\u4EE5\u8FDB\u884C\u5907\u4EFD\u548C\u6062\u590D\u3002","import-settings-title":"\u4ECE\u4ED3\u5E93\u5BFC\u5165\u8BBE\u7F6E","import-settings-hint":"\u8BF7\u9009\u62E9\u4FDD\u5B58\u5728\u4ED3\u5E93\u4E2D\u7684 JSON \u8BBE\u7F6E\u6587\u4EF6\u3002","import-settings-placeholder":"\u8F93\u5165\u6216\u9009\u62E9 JSON \u6587\u4EF6\u8DEF\u5F84","import-settings-confirm":"\u5BFC\u5165","import-settings-empty-path":"\u8BF7\u9009\u62E9\u8BBE\u7F6E\u6587\u4EF6\u3002","import-settings-file-not-found":"\u672A\u627E\u5230\u8BBE\u7F6E\u6587\u4EF6\u3002","invalid-json-file":"\u65E0\u6548\u7684JSON\u6587\u4EF6\u3002","invalid-wewerite-settings-file":"\u65E0\u6548\u7684One2MP\u8BBE\u7F6E\u6587\u4EF6\u3002","ip-copied-to-clipboard":"IP\u5730\u5740\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F\u3002","new-account":"\u65B0\u5EFA\u8D26\u53F7","no-ip-address":"\u65E0IP\u5730\u5740","public-ip-address":"\u516C\u7F51IP\u5730\u5740","select-account":"\u9009\u62E9\u8D26\u53F7","select-wechat-mp-account":"\u9009\u62E9\u5FAE\u4FE1\u516C\u4F17\u53F7\u8D26\u53F7","send-article-to-draft-box-successfully":"\u6587\u7AE0\u6210\u529F\u53D1\u9001\u5230\u8349\u7A3F\u7BB1\u3002","settings-exported":"\u8BBE\u7F6E\u5BFC\u51FA\u6210\u529F\u3002","settings-exporting-failed":"\u8BBE\u7F6E\u5BFC\u51FA\u5931\u8D25\u3002","settings-exported-to-vault":"\u8BBE\u7F6E\u5DF2\u5BFC\u51FA\u5230\u4ED3\u5E93\uFF1A{0}","settings-imported-error":"\u8BBE\u7F6E\u5BFC\u5165\u51FA\u9519\u3002","settings-imported-failed":"\u8BBE\u7F6E\u5BFC\u5165\u5931\u8D25\u3002","settings-imported-successfully":"\u8BBE\u7F6E\u5BFC\u5165\u6210\u529F\u3002","default-mpcard":"\u9ED8\u8BA4\u516C\u4F17\u53F7\u540D\u7247","default-mpcard-desc":"\u4FDD\u5B58\u9ED8\u8BA4\u516C\u4F17\u53F7\u540D\u7247\uFF08\u53EF\u5728\u53F3\u952E\u63D2\u5165\u65F6\u81EA\u52A8\u586B\u5145\uFF09\u3002","default-mpcard-placeholder":"\u7C98\u8D34\u516C\u4F17\u53F7\u540D\u7247\u4EE3\u7801\u5757","default-mpcard-id":"\u8D26\u53F7ID","default-mpcard-id-desc":"\u516C\u4F17\u53F7\u539F\u59CBID\uFF08user_name\uFF09\u3002","default-mpcard-id-placeholder":"gh_xxx","default-mpcard-headimg":"\u5934\u50CFURL","default-mpcard-headimg-desc":"\u516C\u4F17\u53F7\u5934\u50CF\u94FE\u63A5\u3002","default-mpcard-headimg-placeholder":"https://...","default-mpcard-nickname":"\u516C\u4F17\u53F7\u540D\u79F0","default-mpcard-nickname-desc":"\u516C\u4F17\u53F7\u663E\u793A\u540D\u79F0\u3002","default-mpcard-nickname-placeholder":"\u516C\u4F17\u53F7\u540D\u79F0","default-mpcard-signature":"\u516C\u4F17\u53F7\u4ECB\u7ECD","default-mpcard-signature-desc":"\u516C\u4F17\u53F7\u7B80\u4ECB/\u7B7E\u540D\u3002","default-mpcard-signature-placeholder":"\u516C\u4F17\u53F7\u4ECB\u7ECD","default-mpcard-sync":"\u4E00\u952E\u540C\u6B65\u8D26\u53F7\u4FE1\u606F","default-mpcard-sync-success":"\u5DF2\u540C\u6B65\u9ED8\u8BA4\u516C\u4F17\u53F7\u540D\u7247\u3002","default-mpcard-sync-failed":"\u540C\u6B65\u516C\u4F17\u53F7\u540D\u7247\u5931\u8D25\u3002","default-mpcard-sync-partial":"\u4EC5\u540C\u6B65\u5230\u6635\u79F0\u4FE1\u606F\uFF0C\u8BF7\u624B\u52A8\u8865\u5145\u5934\u50CF/\u4ECB\u7ECD\u3002","test-connection":"\u6D4B\u8BD5\u8FDE\u63A5","choose-the-account-to-modify":"\u9009\u62E9\u8981\u4FEE\u6539\u7684\u8D26\u53F7","the-folder-where-your-custom-themes":"\u5B58\u50A8\u81EA\u5B9A\u4E49\u4E3B\u9898\u7684\u6587\u4EF6\u5939\u3002","themes-folder-path":"\u4E3B\u9898\u6587\u4EF6\u5939\u8DEF\u5F84","use-center-token-server":"\u4F7F\u7528\u4E2D\u5FC3\u4EE4\u724C\u670D\u52A1\u5668","wechat-account":"\u5FAE\u4FE1\u516C\u4F17\u53F7\u8D26\u53F7","you-should-add-this-ip-to-ip-whitelist-o":"\u8BF7\u5C06\u6B64IP\u6DFB\u52A0\u5230IP\u767D\u540D\u5355\u4E2D\u3002\u70B9\u51FB\u4E0B\u65B9\u8D26\u53F7\u4FE1\u606F\u4E2D\u7684\u56FE\u7247\u8BBF\u95EE\u201C\u5FAE\u4FE1\u516C\u4F17\u53F7\u5E73\u53F0\u201D\u8FDB\u884C\u8BBE\u7F6E\u3002","your-wechat-official-account":"\u60A8\u7684\u5FAE\u4FE1\u516C\u4F17\u53F7"},views:{"article-header":{"article-title":"\u6587\u7AE0\u6807\u9898","article-title-placeholder":"\u8F93\u5165\u6587\u7AE0\u6807\u9898",author:"\u4F5C\u8005","author-name":"\u4F5C\u8005\u540D\u79F0","comments-description":"\u8BC4\u8BBA\u9ED8\u8BA4\u5173\u95ED\u3002","cover-image":"\u5C01\u9762\u56FE\u7247","cover-image-description":"\u6587\u7AE0\u5FC5\u987B\u5305\u542B\u5C01\u9762\u56FE\u7247\u3002\u53EF\u4ECE\u672C\u5730\u4ED3\u5E93\u62D6\u653E\u56FE\u7247\u6216\u4F7F\u7528\u7F51\u7EDC\u56FE\u7247\u94FE\u63A5\u3002","cover-file-not-supported":"\u79FB\u52A8\u7AEF\u4E0D\u652F\u6301\u672C\u5730\u6587\u4EF6\u5C01\u9762\uFF0C\u8BF7\u4F7F\u7528\u4ED3\u5E93\u56FE\u7247\u6216\u7F51\u7EDC\u94FE\u63A5\u3002","cover-image-mobile-button":"\u9009\u62E9/\u4E0A\u4F20\u5C01\u9762","cover-image-mobile-title":"\u8BBE\u7F6E\u5C01\u9762\u56FE\u7247","cover-image-mobile-vault":"\u4ECE\u4ED3\u5E93\u9009\u62E9\u56FE\u7247","cover-image-mobile-vault-desc":"\u9009\u62E9\u4ED3\u5E93\u4E2D\u7684\u56FE\u7247\u8DEF\u5F84\u3002","cover-image-mobile-vault-placeholder":"\u8F93\u5165\u6216\u9009\u62E9\u56FE\u7247\u8DEF\u5F84","cover-image-mobile-url":"\u4F7F\u7528\u7F51\u7EDC\u56FE\u7247\u94FE\u63A5","cover-image-mobile-url-desc":"\u8F93\u5165\u56FE\u7247\u7684\u7F51\u7EDC\u94FE\u63A5\u3002","cover-image-mobile-required":"\u8BF7\u81F3\u5C11\u63D0\u4F9B\u4E00\u4E2A\u5C01\u9762\u56FE\u7247\u6765\u6E90\u3002","cover-image-mobile-invalid":"\u56FE\u7247\u8DEF\u5F84\u65E0\u6548\uFF0C\u8BF7\u68C0\u67E5\u540E\u518D\u8BD5\u3002","reset-cover-crop":"\u91CD\u7F6E\u88C1\u526A",digest:"\u6458\u8981","digest-text":"\u8F93\u5165\u6458\u8981\u6587\u672C","only-fans-can-comment":"\u4EC5\u7C89\u4E1D\u53EF\u8BC4\u8BBA","only-fans-can-comment-description":"\u9ED8\u8BA4\u6240\u6709\u4EBA\u90FD\u53EF\u8BC4\u8BBA","open-comments":"\u5F00\u542F\u8BC4\u8BBA","testing-button":"\u6D4B\u8BD5\u6309\u94AE",title:"\u6587\u7AE0\u5C5E\u6027"},"delete-draft":"\u5220\u9664\u8349\u7A3F","delete-image":"\u5220\u9664\u56FE\u7247","free-publish":"\u514D\u8D39\u53D1\u5E03","no-title-article":"\u65E0\u6807\u9898\u6587\u7AE0\u3002","other-type-has-not-been-implemented":"\u5176\u4ED6\u7C7B\u578B\u5C1A\u672A\u5B9E\u73B0\u3002","preview-draft":"\u9884\u89C8\u8349\u7A3F",previewer:{"article-copied-to-clipboard":"\u6587\u7AE0\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F\u3002","open-url-not-supported":"\u5F53\u524D\u5E73\u53F0\u4E0D\u652F\u6301\u6253\u5F00\u94FE\u63A5\u3002","article-render-failed":"\u6587\u7AE0\u6E32\u67D3\u5931\u8D25\u3002","article-title":"\u6587\u7AE0\u6807\u9898","copy-article-to-clipboard":"\u590D\u5236\u6587\u7AE0\u5230\u526A\u8D34\u677F","publish-config":"\u53D1\u5E03\u914D\u7F6E","generate-template":"\u751F\u6210\u516C\u4F17\u53F7\u6A21\u677F","file-not-found-path":"\u6587\u4EF6\u672A\u627E\u5230\uFF1A{0}","not-a-markdown-view":"\u4E0D\u662FMarkdown\u89C6\u56FE","please-set-cover-image":"\u8BF7\u8BBE\u7F6E\u5C01\u9762\u56FE\u7247\u3002","preview-draft-missing-id":"\u8BF7\u5148\u53D1\u9001\u5230\u8349\u7A3F\u7BB1\u518D\u9884\u89C8\u3002","preview-draft-missing-wxid":"\u8BF7\u5728\u53D1\u5E03\u914D\u7F6E\u4E2D\u586B\u5199\u8349\u7A3F\u9884\u89C8\u8005\u5FAE\u4FE1ID\u3002","preview-draft-sent":"\u9884\u89C8\u6D88\u606F\u5DF2\u53D1\u9001\u5230\u5FAE\u4FE1\u3002","render-article":"\u6E32\u67D3\u6587\u7AE0","send-article-to-draft-box":"\u53D1\u9001\u6587\u7AE0\u5230\u8349\u7A3F\u7BB1","template-created":"\u516C\u4F17\u53F7\u6A21\u677F\u5DF2\u751F\u6210\u3002","template-file-created":"\u5DF2\u521B\u5EFA\u6A21\u677F\u6587\u4EF6\uFF1Aone2mp-template.md","testing-button":"\u6D4B\u8BD5\u6309\u94AE","to-verify-the-images-in-article":"\u9A8C\u8BC1\u6587\u7AE0\u4E2D\u7684\u56FE\u7247","one2mp-previewer":"O2Any\u9884\u89C8\u5668"},"send-mass-message":"\u7FA4\u53D1\u6D88\u606F","theme-manager":{"default-theme":"\u9ED8\u8BA4\u4E3B\u9898","download-predefined-custom-themes":"\u4E0B\u8F7D\u5B9A\u5236\u4E3B\u9898","download-themes-mobile-not-supported":"\u79FB\u52A8\u7AEF\u6682\u4E0D\u652F\u6301\u4E3B\u9898\u4E0B\u8F7D\u3002","error-downloading-theme":"\u4E0B\u8F7D\u4E3B\u9898\u51FA\u9519","error-downloading-themes":"\u4E0B\u8F7D\u4E3B\u9898\u51FA\u9519\u3002","failed-to-fetch-themes-json-themesrespon":"\u83B7\u53D6themes.json\u5931\u8D25\uFF1A{0}","total-themes-length-themes-downloaded":"\u5171\u4E0B\u8F7D{0}\u4E2A\u4E3B\u9898\u3002","download-started":"\u5F00\u59CB\u4E0B\u8F7D\u4E3B\u9898\uFF0C\u8BF7\u7A0D\u5019\u2026","download-summary":"\u4E3B\u9898\u4E0B\u8F7D\u5B8C\u6210\uFF1A\u6210\u529F {0} \u4E2A\uFF0C\u5931\u8D25 {1} \u4E2A\uFF0C\u8DF3\u8FC7 {2} \u4E2A"},platform:{wechat:"\u516C\u4F17\u53F7",zhihu:"\u77E5\u4E4E",redbook:"\u5C0F\u7EA2\u4E66"},zhihu:{copy:"\u590D\u5236",open:"\u6253\u5F00\u77E5\u4E4E",refresh:"\u5237\u65B0",copied:"\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F\u3002"},redbook:{copy:"\u590D\u5236\u6587\u6848",export:"\u5BFC\u51FA\u7D20\u6750\u5305",open:"\u6253\u5F00\u5C0F\u7EA2\u4E66",refresh:"\u5237\u65B0",copied:"\u5C0F\u7EA2\u4E66\u6587\u6848\u5DF2\u590D\u5236\u3002",empty:"\u6CA1\u6709\u53EF\u590D\u5236\u7684\u6587\u6848\u3002","no-active-file":"\u672A\u627E\u5230\u53EF\u7F16\u8F91\u7684 Markdown \u6587\u4EF6\u3002"}},"wechat-api":{"add-ip-address-ipv4-0-to-wechat-mp-ip-wh":"\u5C06IP\u5730\u5740[{0}]\u6DFB\u52A0\u5230\u5FAE\u4FE1\u516C\u4F17\u53F7IP\u767D\u540D\u5355\u3002","failed-to-get-wechat-access-token":"\u83B7\u53D6\u5FAE\u4FE1access token\u5931\u8D25\u3002","image-size-exceeds-10m":"\u56FE\u7247\u5927\u5C0F\u8D85\u8FC710MB\u9650\u5236","video-size-exceeds-10m":"\u89C6\u9891\u5927\u5C0F\u8D85\u8FC710MB\u9650\u5236","voice-size-exceeds-2m":"\u8BED\u97F3\u5927\u5C0F\u8D85\u8FC72MB\u9650\u5236","select-an-wechat-mp-account-first":"\u8BF7\u5148\u9009\u62E9\u4E00\u4E2A\u5FAE\u4FE1\u516C\u4F17\u53F7\u8D26\u53F7\u3002","send-article-to-draft-box-successfully":"\u6587\u7AE0\u6210\u529F\u53D1\u9001\u5230\u8349\u7A3F\u7BB1\u3002","uploading-material-type":"\u4E0A\u4F20\u7D20\u6750\u7C7B\u578B\uFF1A{0}"}}});function $(r,e){let t=De.t(r);if(e!==void 0)for(let n=0;n<e.length;n++)t=t.replace(`{${n}}`,e[n]);return t}var ts,Fe=j(()=>{Qo();ts=require("obsidian");Zo();Xo();De.init({debug:!1,lng:ts.moment.locale(),fallbackLng:"en",interpolation:{escapeValue:!1},resources:{en:{translation:Yo},zh:{translation:es}}}).catch(r=>{console.error("i18n init failed:",r)});window.$t=$});var mr,nn,qi=j(()=>{mr=require("obsidian"),nn=class extends mr.AbstractInputSuggest{constructor(t,n,i=[]){super(t,n);this.inputEl=n;this.extensions=i}getSuggestions(t){let n=t.toLowerCase();return this.app.vault.getAllLoadedFiles().filter(a=>a instanceof mr.TFile).filter(a=>this.extensions.length&&!this.extensions.includes(a.extension)?!1:a.path.toLowerCase().includes(n))}renderSuggestion(t,n){n.setText(t.path)}selectSuggestion(t){this.inputEl.value=t.path,this.inputEl.trigger("input"),this.close()}}});var Pf,rn,vr=j(()=>{Pf=r=>{let e=r.trim();return e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'")?e.slice(1,-1):e},rn=r=>{if(!r.startsWith("---"))return{data:{},content:r};let e=r.indexOf(`
---`,3);if(e===-1)return{data:{},content:r};let t=r.slice(3,e).trim(),i=r.slice(e+4).replace(/^\r?\n/,""),a={};if(t)for(let o of t.split(/\r?\n/)){let s=o.match(/^([^:#]+):\s*(.*)$/);if(!s)continue;let l=s[1].trim(),c=Pf(s[2]);l&&(a[l]=c)}return{data:a,content:i}}});var is,rs=j(()=>{is=`/* 00_one2mp.css 
	\u5B9A\u4E49one2mp\u7684\u57FA\u672C\u8272\u7CFB

*/
:root {
  /* \u4E3B\u8272\u7CFB */
  --one2mp-primary: #2c3e50;
  --one2mp-secondary: #3498db;
  --one2mp-accent: #e67e22;
  --one2mp-primary-light: #d0e4ff;
  
  /* \u4E2D\u6027\u8272 */
  --one2mp-bg: transparent;
  --one2mp-bg-alt: var(--one2mp-primary);
  --one2mp-text: #333333;
  --one2mp-text-color: var(--one2mp-text);
  --one2mp-text-alt: #ffffff;
  --one2mp-border:#999999;
  
  /* \u72B6\u6001\u8272 */
  --one2mp-success: #27ae60;
  --one2mp-success: #28a745;
  --one2mp-warning: #ff9800;
  --one2mp-error: #e74c3c;
  --one2mp-danger:  #dc3545;
  --one2mp-blue: #1e3a8a;
}	

:root {
	--one2mp-font-size: 16px;
	--one2mp-line-height: 1.8;
	--one2mp-text-indent: 0;
	--one2mp-letter-spacing: 0;
	--one2mp-word-spacing: 0;
	--one2mp-text-align: left;
	--one2mp-text-decoration: none;
	--one2mp-border-width: 1px;
	--one2mp-border-style: solid;
	--one2mp-border-radius: 4px;
	--one2mp-border-radius-sm: 2px;
	--one2mp-border-radius-lg: 6px;
	--one2mp-border-radius-xl: 8px;
}
body{
	font-size: var(--one2mp-font-size);
	line-height: var(--one2mp-line-height);
	text-indent: var(--one2mp-text-indent);
	letter-spacing: var(--one2mp-letter-spacing);
	word-spacing: var(--one2mp-word-spacing);
	text-align: var(--one2mp-text-align);
	text-decoration: var(--one2mp-text-decoration);
	border-width: var(--one2mp-border-width);
	border-style: var(--one2mp-border-style);
	border-radius: var(--one2mp-border-radius);
} 
`});var os,as=j(()=>{os=`/**
* \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u9875\u9762\u7248\u5F0F\u548C\u57FA\u672C\u5B57\u4F53\u98CE\u683C\u7684\u6837\u5F0F
*/

:root {
	/* page  layout */
	--article-max-width: none;
	--article-min-width: 200px;
	--article-padding: 0px;
	--article-margin: 0px;
	--article-background-color: var(--one2mp-bg);
	--article-background-image: none;
	--article-background-repeat: repeat;
	--article-background-size: auto;
	--article-background-position: left top;
	
}

.one2mp {
	max-width: var(--article-max-width);
	min-width: var(--article-min-width);
	padding: var(--article-padding);
	margin: var(--article-margin);
	background-color: var(--article-background-color);
	background-image: var(--article-background-image);
	background-repeat: var(--article-background-repeat);
	background-size: var(--article-background-size);
	background-position: var(--article-background-position);
	
}
`});var ls,ss=j(()=>{ls=`/**
 * \u5B9A\u4E49icon,image \u7684\u57FA\u672C\u6837\u5F0F
 */
:root {
	/* --icon-pin: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='%23333' viewBox='0 0 24 24'%3E%3Cpath d='M12 0c.6 0 1 .4 1 1v7h1l2.4-4c.3-.6 1-.7 1.4-.4.5.3.7 1 .4 1.5L16 9l5 5v1h-7v7h-1l-5-5-3.9 2.6c-.5.3-1.1.2-1.4-.3-.3-.5-.2-1.1.3-1.4L8 13l-4-5.3c-.3-.5-.2-1.2.3-1.5.5-.3 1.2-.2 1.5.3L10 9V1c0-.6.4-1 1-1z'/%3E%3C/svg%3E"); */

	/* --icon-pencil: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 24 24'%3E%3Cpath d='M17.25 2.08a1.5 1.5 0 0 1 2.12 0l2.55 2.55a1.5 1.5 0 0 1 0 2.12l-2.34 2.34-4.67-4.67L17.25 2.08zM13.89 4.89l4.67 4.67L7.5 20.61H2v-5.5L13.89 4.89z'/%3E%3C/svg%3E"); */
	/* --icon-clip: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 24 24'%3E%3Cpath d='M16.5 3.5a5.002 5.002 0 0 1 3.536 8.536L10.828 21.244a7 7 0 0 1-9.9-9.9L12.121.15a1 1 0 1 1 1.415 1.414L2.343 12.757a5 5 0 1 0 7.07 7.071l9.207-9.207a3 3 0 1 0-4.243-4.243L5.464 16.464a1 1 0 1 1-1.414-1.414L16.5 3.5z'/%3E%3C/svg%3E"); */
	/* --icon-book:   url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='none' viewBox='0 0 24 24'><rect x='3' y='3' width='14' height='18' rx='2' fill='%23F5F5F5' stroke='%23BDBDBD' stroke-width='1.5'/><line x1='6' y1='6' x2='14' y2='6' stroke='%239E9E9E' stroke-width='1'/><line x1='6' y1='9' x2='14' y2='9' stroke='%239E9E9E' stroke-width='1'/><line x1='6' y1='12' x2='14' y2='12' stroke='%239E9E9E' stroke-width='1'/><path d='M17.5 4.5L19.5 6.5L9 17L6 17L6 14L17.5 4.5Z' fill='%23FFEB3B' stroke='%23FBC02D' stroke-width='1'/><path d='M6 17L6.5 18L7.5 18.5L9 17H6Z' fill='%23795548'/><circle cx='18.5' cy='5.5' r='1' fill='%23E91E63'/></svg>"); */
	/* --bg-img-student: linear-gradient(transparent 29px, #ddd 30px), */




	--icon-pin: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 42'%3E%3Cpath fill='%23ff4444' d='M16 1C9 1 3 7 3 14c0 10 11 21 13 21s13-11 13-21c0-7-6-13-13-13zm0 20a7 7 0 1 1 0-14 7 7 0 0 1 0 14z'/%3E%3C/svg%3E");
	
}
`});var us,cs=j(()=>{us=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u5B57\u4F53\u7248\u5F0F\u6837\u5F0F
 */
:root {

	/* typography */
	--article-font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji;
	--article-font-weight: 400;
	--article-word-break: break-word;
	--article-letter-space: 0px;
	--article-text-font-size: 15px;
	--article-text-color: var(--one2mp-text);
	--article-line-height: var(--one2mp-line-height);
	--article-text-align: left;
	--article-text-indent: 0;
	--article-font-style: normal;
}

.one2mp {
	font-family: var(--article-font-family);
	font-weight: var(--article-font-weight);
	word-break: var(--article-word-break);
	letter-spacing: var(--article-letter-space);
	color: var(--article-text-color);
	font-size: var(--article-text-font-size);
	line-height: var(--article-line-height);
	text-align: var(--article-text-align);
	text-indent: var(--article-text-indent);
	font-style: var(--article-font-style); 
}

`});var fs,ds=j(()=>{fs=`/**
* \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u6B63\u6587\u6837\u5F0F
*/

:root {
	--paragraph-font-family: var(--article-font-family);
	--paragraph-font-weight: var(--article-font-weight);
	--paragraph-font-size: var(--article-text-font-size);
	--paragraph-word-break: var(--article-word-break);
	--paragraph-text-color: var(--article-text-color);
	--paragraph-letter-space: var(--article-letter-space);
	--paragraph-line-height: var(--article-line-height);
	--paragraph-text-align: var(--article-text-align);
	--paragraph-text-indent: var(--article-text-indent);
	--paragraph-font-style: var(--article-font-style);
	--paragraph-margin: var(--article-margin);
}

.one2mp > p {
	font-family: var(--paragraph-font-family);
	font-weight: var(--paragraph-font-weight);
	font-size: var(--paragraph-font-size);
	color: var(--paragraph-text-color);
	word-break: var(--paragraph-word-break);
	letter-spacing: var(--paragraph-letter-space);
	line-height: var(--paragraph-line-height);
	text-align: var(--paragraph-text-align);
	text-indent: var(--paragraph-text-indent);
	font-style: var(--paragraph-font-style);
	margin: var(--paragraph-margin);
}
`});var ps,hs=j(()=>{ps=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u4FEE\u9970\u6027\u6587\u5B57\u7684\u98CE\u683C\uFF1A
 - \u7C97\u4F53

 */
:root {
	--strong-font-family: var(--article-font-family);
	--strong-font-weight: 600;
	--strong-font-style: bold;
	--strong-font-size: var(--article-text-font-size);
	--strong-line-height: var(--article-line-height);
	--strong-letter-spacing: var(--article-letter-space);
	--strong-text-align: var(--article-text-align);
	--strong-text-indent: var(--article-text-indent);
	--strong-color: var(--one2mp-primary);
}

.one2mp strong {
	font-family: var(--strong-font-family);
	font-weight: var(--strong-font-weight);
	font-size: var(--strong-font-size);
	line-height: var(--strong-line-height);
	letter-spacing: var(--strong-letter-spacing);
	text-align: var(--strong-text-align);
	text-indent: var(--strong-text-indent);
	color: var(--strong-color);
}
`});var ms,gs=j(()=>{ms=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u4FEE\u9970\u6027\u6587\u5B57\u7684\u98CE\u683C\uFF1A
 - \u659C\u4F53
 - 

 */
:root {
	--em-font-family: var(--article-font-family);
	--em-font-weight: var(--article-font-weight);
	--em-font-size: var(--article-text-font-size);
	--em-line-height: var(--article-line-height);
	--em-letter-spacing: var(--article-letter-space);
	--em-text-align: var(--article-text-align);
	--em-text-indent: var(--article-text-indent);
	--em-color: var(--article-text-color);
	--em-font-style: italic;
	
}

.one2mp em {
	font-family: var(--em-font-family);
	font-weight: var(--em-font-weight);
	font-size: var(--em-font-size);
	line-height: var(--em-line-height);
	letter-spacing: var(--em-letter-spacing);
	text-align: var(--em-text-align);
	text-indent: var(--em-text-indent);
	color: var(--em-color);
	font-style: var(--em-font-style);
}
`});var ys,vs=j(()=>{ys=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u4FEE\u9970\u6027\u6587\u5B57\u7684\u98CE\u683C\uFF1A
 - \u659C\u4F53
 - 

 */
:root {
	--u-font-family: var(--article-font-family);
	--u-font-weight: var(--article-font-weight);
	--u-font-size: var(--article-text-font-size);
	--u-line-height: var(--article-line-height);
	--u-letter-spacing: var(--article-letter-space);
	--u-text-align: var(--article-text-align);
	--u-text-indent: var(--article-text-indent);
	--u-color: var(--article-text-color);
	--u-font-style: normal;
	--u-text-decoration: underline;
	--u-text-decoration-thickness: 1px;
	--u-text-decoration-style: solid;
	--u-text-decoration-color: var(--article-text-color);
	--u-underline-offset: 0.2em;
}

.one2mp u {
	font-family: var(--u-font-family);
	font-weight: var(--u-font-weight);
	font-size: var(--u-font-size);
	line-height: var(--u-line-height);
	letter-spacing: var(--u-letter-spacing);
	text-align: var(--u-text-align);
	text-indent: var(--u-text-indent);
	color: var(--u-color);
	font-style: var(--u-font-style);
	text-decoration:  var(--u-text-decoration);
	text-decoration-thickness: var(--u-text-decoration-thickness);
	text-decoration-style: var(--u-text-decoration-style);
	text-decoration-color: var(--u-text-decoration-color);
	text-underline-offset: var(--u-underline-offset)
}
`});var bs,ws=j(()=>{bs=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u4FEE\u9970\u6027\u6587\u5B57\u7684\u98CE\u683C\uFF1A
 - \u659C\u4F53
 - 

 */
:root {
	--del-font-family: var(--article-font-family);
	--del-font-weight: var(--article-font-weight);
	--del-font-size: var(--article-text-font-size);
	--del-line-height: var(--article-line-height);
	--del-letter-spacing: var(--article-letter-space);
	--del-text-align: var(--article-text-align);
	--del-text-indent: var(--article-text-indent);
	--del-color: var(--article-text-color);
	--del-font-style: normal;
	--del-text-decoration: line-through;
	--del-text-decoration-thickness: 1px;
	--del-text-decoration-style: solid;
	--del-text-decoration-color: var(--article-text-color);
}

.one2mp del {
	font-family: var(--del-font-family);
	font-weight: var(--del-font-weight);
	font-size: var(--del-font-size);
	line-height: var(--del-line-height);
	letter-spacing: var(--del-letter-spacing);
	text-align: var(--del-text-align);
	text-indent: var(--del-text-indent);
	color: var(--del-color);
	font-style: var(--del-font-style);
	text-decoration:  var(--del-text-decoration);
	text-decoration-thickness: var(--del-text-decoration-thickness);
	text-decoration-style: var(--del-text-decoration-style);
	text-decoration-color: var(--del-text-decoration-color);
}
`});var Ni,xs=j(()=>{Ni=`:root{
	--codespan-color: #e5c07b;
	--codespan-background-color: #282c34;
	--codespan-padding: 2px 4px;
	--codespan-border-radius: 4px;
	--codespan-font-size: 0.9rem;
	--codespan-font-family: "Fira Code", "Fira Mono", "Source Code Pro", "Roboto Mono", monospace;
	--codespan-font-weight: 500;
}

.one2mp .one2mp-codespan {
	color: var(--codespan-color, #e5c07b);
	background-color: var(--codespan-background-color, #282c34);
	padding: var(--codespan-padding, 2px);
	border-radius: var(--codespan-border-radius, 4px);
	font-size: var(--codespan-font-size, 0.9rem);
	font-family: var(--codespan-font-family, "Fira Code", "Fira Mono", "Source Code Pro", "Roboto Mono", monospace);
	font-weight: var(--codespan-font-weight, 500);

}
`});var ks,_s=j(()=>{ks=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u6807\u9898\u7684\u57FA\u672C\u6837\u5F0F
 */

:root {
	--heading-font-family: var(--article-font-family);
	--heading-font-weight: 600;
	--heading-color: var(--article-text-color);
	--heading-line-height: 1.5;
	--heading-letter-spacing: var(--article-letter-space);
	--heading-text-align: var(--article-text-align);
	--heading-font-style: normal;
	--heading-margin: 1rem 0;
	--heading-text-decoration-style: none;
	--heading-text-decoration-thickness: 0;
	--heading-text-decoration-color: transparent; 
	--heading-radius: var(--one2mp-radius);
	--heading-border-bottom-width: 0;
	--heading-border-bottom-style: none;
	--heading-border-bottom-color: transparent;
	--heading-padding: 0;
	--heading-display: flex;
	--heading-tail-display: none;
	--heading-tail-content: " ";
	--heading-tail-shadow-color: rgb(239, 235, 233);
	--heading-tail-shadow-height: 0;
	--heading-tail-shadow-width: 0;
	
}

/* \u6807\u9898 */
.one2mp h1,
.one2mp h2,
.one2mp h3,
.one2mp h4,
.one2mp h5,
.one2mp h6 {
	font-family: var(--heading-font-family);
	font-weight: var(--heading-font-weight);
	color: var(--heading-color);
	line-height: var(--heading-line-height);
	letter-spacing: var(--heading-letter-spacing);
	text-align: var(--heading-text-align);
	font-style: var(--heading-font-style);
	margin: var(--heading-margin);
	text-decoration-style: var(--heading-text-decoration-style);
	text-decoration-thickness: var(--heading-text-decoration-thickness);
	text-decoration-color: var(--heading-text-decoration-color);
	display: var(--heading-display);
}

.one2mp .one2mp-heading-prefix {
	display: none;
}
.one2mp .one2mp-heading-outbox {
	display: block;
}
.one2mp .one2mp-heading-leaf {
	display: block;
}
.one2mp .one2mp-heading-tail {
	display: none;
}
`});var Es,Ss=j(()=>{Es=`/**
h1  \u6807\u9898
*/

:root {

	--h1-font-family: var(--heading-font-family);
	--h1-font-weight: var(--heading-font-weight);
	--h1-color: var(--heading-color);
	--h1-font-size: 2.2rem;
	--h1-line-height: var(--heading-line-height);
	--h1-letter-spacing: var(--heading-letter-spacing);
	--h1-text-align: var(--heading-text-align);
	--h1-font-style: var(--heading-font-style);
	--h1-text-decoration-style: var(--heading-text-decoration-style);
	--h1-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h1-text-decoration-color: var(--heading-text-decoration-color);
	--h1-margin: var(--heading-margin);
	/* --h1-bg: var(--one2mp-primary); */
	--h1-bg: var(--one2mp-bg);
	--h1-border-bottom-width: var(--heading-border-bottom-width);
	/* --h1-border-bottom-color: var(--h1-bg); */
	--h1-border-bottom-color: var(--heading-border-bottom-color);
	--h1-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h1-prefix-display: none;
	--h1-prefix-color: var(--h1-color);
	--h1-font-style: normal;
	--h1-text-align: var(--h1-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h1-outbox-display: block;
	--h1-outbox-radius: var(--one2mp-border-radius);
	--h1-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h1-leaf-display: block;
	--h1-leaf-padding: var(--heading-padding);
	--h1-leaf-color: var(--h1-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h1-tail-display: inline-block; */
	--h1-tail-display: none;
	--h1-tail-content: " ";
	--h1-tail-vertical-align: bottom;
	--h1-tail-display: var(--heading-tail-display);
	--h1-tail-content: var(--heading-tail-content);
	--h1-tail-shadow-color: var(--heading-tail-shadow-color);
	--h1-tail-shadow-height: var(--heading-tail-shadow-height);
	--h1-tail-shadow-width: var(--heading-tail-shadow-width);
	--h1-display: flex;
}

.one2mp h1 {
	font-family: var(--h1-font-family);
	font-weight: var(--h1-font-weight);
	font-size: var(--h1-font-size);
	line-height: var(--h1-line-height);
	letter-spacing: var(--h1-letter-spacing);
	text-align: var(--h1-text-align);
	color: var(--h1-color);
	font-style: var(--h1-font-style);
	text-decoration-style: var(--h1-text-decoration-style);
	text-decoration-thickness: var(--h1-text-decoration-thickness);
	text-decoration-color: var(--h1-text-decoration-color);
	margin: var(--h1-margin);
	border-bottom-width: var(--h1-border-bottom-width);
	border-bottom-style: var(--h1-border-bottom-style);
	border-bottom-color: var(--h1-border-bottom-color);
	display: var(--h1-display);
}


.one2mp h1 .one2mp-heading-prefix {
	display: var(--h1-prefix-display);
	color: var(--h1-prefix-color);
	font-style: var(--h1-font-style);
	text-align: var(--h1-text-align);

}

.one2mp h1 .one2mp-heading-outbox {
	border-top-right-radius: var(--h1-outbox-radius);
	border-top-left-radius: var(--h1-outbox-radius);
	background-color: var(--h1-bg);
	padding: var(--h1-outbox-padding);
	display: block;
}

.one2mp h1 .one2mp-heading-leaf {
	padding-left: var(--h1-leaf-padding);
	padding-right: var(--h1-leaf-padding);
	font-weight: var(--h1-font-weight);
	display: var(--h1-leaf-display);
	color: var(--h1-leaf-color)
}

.one2mp h1 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h1-tail-display);
	content: var(--h1-tail-content);
	vertical-align: var(--h1-tail-vertical-align);
	border-bottom: var(--h1-tail-shadow-height) solid var(--h1-tail-shadow-color);
	border-right: var(--h1-tail-shadow-width) solid transparent;

}
`});var Ts,Cs=j(()=>{Ts=`/**
h2  \u6807\u9898
*/

:root {
	--h2-font-family: var(--heading-font-family);
	--h2-font-weight: var(--heading-font-weight);
	--h2-color: var(--heading-color);
	--h2-font-size: 2rem;
	--h2-line-height: var(--heading-line-height);
	--h2-letter-spacing: var(--heading-letter-spacing);
	--h2-text-align: var(--heading-text-align);
	--h2-font-style: var(--heading-font-style);
	--h2-text-decoration-style: var(--heading-text-decoration-style);
	--h2-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h2-text-decoration-color: var(--heading-text-decoration-color);
	--h2-margin: var(--heading-margin);
	/* --h2-bg: var(--one2mp-primary); */
	--h2-bg: var(--one2mp-bg);
	--h2-border-bottom-width: var(--heading-border-bottom-width);
	/* --h2-border-bottom-color: var(--h2-bg); */
	--h2-border-bottom-color: var(--heading-border-bottom-color);
	--h2-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h2-prefix-display: none;
	--h2-prefix-color: var(--h2-color);
	--h2-font-style: normal;
	--h2-text-align: var(--h2-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h2-outbox-display: block;
	--h2-outbox-radius: var(--one2mp-border-radius);
	--h2-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h2-leaf-display: block;
	--h2-leaf-padding: var(--heading-padding);
	--h2-leaf-color: var(--h2-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h2-tail-display: inline-block; */
	--h2-tail-display: none;
	--h2-tail-content: " ";
	--h2-tail-vertical-align: bottom;
	--h2-tail-display: var(--heading-tail-display);
	--h2-tail-content: var(--heading-tail-content);
	--h2-tail-shadow-color: var(--heading-tail-shadow-color);
	--h2-tail-shadow-height: var(--heading-tail-shadow-height);
	--h2-tail-shadow-width: var(--heading-tail-shadow-width);
	--h2-display: flex;
}
.one2mp h2 {
	font-family: var(--h2-font-family);
	font-weight: var(--h2-font-weight);
	font-size: var(--h2-font-size);
	line-height: var(--h2-line-height);
	letter-spacing: var(--h2-letter-spacing);
	text-align: var(--h2-text-align);
	color: var(--h2-color);
	font-style: var(--h2-font-style);
	text-decoration-style: var(--h2-text-decoration-style);
	text-decoration-thickness: var(--h2-text-decoration-thickness);
	text-decoration-color: var(--h2-text-decoration-color);
	margin: var(--h2-margin);
	border-bottom-width: var(--h2-border-bottom-width);
	border-bottom-style: var(--h2-border-bottom-style);
	border-bottom-color: var(--h2-border-bottom-color);
	display: var(--h2-display);
}


.one2mp h2 .one2mp-heading-prefix {
	display: var(--h2-prefix-display);
	color: var(--h2-prefix-color);
	font-style: var(--h2-font-style);
	text-align: var(--h2-text-align);

}
.one2mp h2 .one2mp-heading-outbox {
	border-top-right-radius: var(--h2-outbox-radius);
	border-top-left-radius: var(--h2-outbox-radius);
	background-color: var(--h2-bg);
	padding: var(--h2-outbox-padding);
	display: block;
}
.one2mp h2 .one2mp-heading-leaf {
	padding-left: var(--h2-leaf-padding);
	padding-right: var(--h2-leaf-padding);
	font-weight:  var(--h2-font-weight);
	display: var(--h2-leaf-display);
	color: var(--h2-leaf-color)
}
.one2mp h2 .one2mp-heading-tail {
	box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizelegibility;
    display: var(--h2-tail-display);
    content: var(--h2-tail-content);
    vertical-align: var(--h2-tail-vertical-align);
	border-bottom: var(--h2-tail-shadow-height) solid var(--h2-tail-shadow-color);
	border-right: var(--h2-tail-shadow-width) solid transparent;
}
`});var Ps,As=j(()=>{Ps=`/**
h3  \u6807\u9898
*/

:root {
	--h3-font-family: var(--heading-font-family);
	--h3-font-weight: var(--heading-font-weight);
	--h3-color: var(--heading-color);
	--h3-font-size: 1.8rem;
	--h3-line-height: var(--heading-line-height);
	--h3-letter-spacing: var(--heading-letter-spacing);
	--h3-text-align: var(--heading-text-align);
	--h3-font-style: var(--heading-font-style);
	--h3-text-decoration-style: var(--heading-text-decoration-style);
	--h3-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h3-text-decoration-color: var(--heading-text-decoration-color);
	--h3-margin: var(--heading-margin);
	/* --h3-bg: var(--one2mp-primary); */
	--h3-bg: var(--one2mp-bg);
	--h3-border-bottom-width: var(--heading-border-bottom-width);
	/* --h3-border-bottom-color: var(--h3-bg); */
	--h3-border-bottom-color: var(--heading-border-bottom-color);
	--h3-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h3-prefix-display: none;
	--h3-prefix-color: var(--h3-color);
	--h3-font-style: normal;
	--h3-text-align: var(--h3-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h3-outbox-display: block;
	--h3-outbox-radius: var(--one2mp-border-radius);
	--h3-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h3-leaf-display: block;
	--h3-leaf-padding: var(--heading-padding);
	--h3-leaf-color: var(--h3-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h3-tail-display: inline-block; */
	--h3-tail-display: none;
	--h3-tail-content: " ";
	--h3-tail-vertical-align: bottom;
	--h3-tail-display: var(--heading-tail-display);
	--h3-tail-content: var(--heading-tail-content);
	--h3-tail-shadow-color: var(--heading-tail-shadow-color);
	--h3-tail-shadow-height: var(--heading-tail-shadow-height);
	--h3-tail-shadow-width: var(--heading-tail-shadow-width);
	--h3-display: flex;
}

.one2mp h3 {
	font-family: var(--h3-font-family);
	font-weight: var(--h3-font-weight);
	font-size: var(--h3-font-size);
	line-height: var(--h3-line-height);
	letter-spacing: var(--h3-letter-spacing);
	text-align: var(--h3-text-align);
	color: var(--h3-color);
	font-style: var(--h3-font-style);
	text-decoration-style: var(--h3-text-decoration-style);
	text-decoration-thickness: var(--h3-text-decoration-thickness);
	text-decoration-color: var(--h3-text-decoration-color);
	margin: var(--h3-margin);
	border-bottom-width: var(--h3-border-bottom-width);
	border-bottom-style: var(--h3-border-bottom-style);
	border-bottom-color: var(--h3-border-bottom-color);
	display: var(--h3-display);
}


.one2mp h3 .one2mp-heading-prefix {
	display: var(--h3-prefix-display);
	color: var(--h3-prefix-color);
	font-style: var(--h3-font-style);
	text-align: var(--h3-text-align);

}

.one2mp h3 .one2mp-heading-outbox {
	border-top-right-radius: var(--h3-outbox-radius);
	border-top-left-radius: var(--h3-outbox-radius);
	background-color: var(--h3-bg);
	padding: var(--h3-outbox-padding);
	display: block;
}

.one2mp h3 .one2mp-heading-leaf {
	padding-left: var(--h3-leaf-padding);
	padding-right: var(--h3-leaf-padding);
	font-weight: var(--h3-font-weight);
	display: var(--h3-leaf-display);
	color: var(--h3-leaf-color)
}

.one2mp h3 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h3-tail-display);
	content: var(--h3-tail-content);
	vertical-align: var(--h3-tail-vertical-align);
	border-bottom: var(--h3-tail-shadow-height) solid var(--h3-tail-shadow-color);
	border-right: var(--h3-tail-shadow-width) solid transparent;
}
`});var Is,$s=j(()=>{Is=`/**
h4  \u6807\u9898
*/

:root {
	--h4-font-family: var(--heading-font-family);
	--h4-font-weight: var(--heading-font-weight);
	--h4-color: var(--heading-color);
	--h4-font-size: 1.5rem;
	--h4-line-height: var(--heading-line-height);
	--h4-letter-spacing: var(--heading-letter-spacing);
	--h4-text-align: var(--heading-text-align);
	--h4-font-style: var(--heading-font-style);
	--h4-text-decoration-style: var(--heading-text-decoration-style);
	--h4-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h4-text-decoration-color: var(--heading-text-decoration-color);
	--h4-margin: var(--heading-margin);
	/* --h4-bg: var(--one2mp-primary); */
	--h4-bg: var(--one2mp-bg);
	--h4-border-bottom-width: var(--heading-border-bottom-width);
	/* --h4-border-bottom-color: var(--h4-bg); */
	--h4-border-bottom-color: var(--heading-border-bottom-color);
	--h4-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h4-prefix-display: none;
	--h4-prefix-color: var(--h4-color);
	--h4-font-style: normal;
	--h4-text-align: var(--h4-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h4-outbox-display: block;
	--h4-outbox-radius: var(--one2mp-border-radius);
	--h4-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h4-leaf-display: block;
	--h4-leaf-padding: var(--heading-padding);
	--h4-leaf-color: var(--h4-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h4-tail-display: inline-block; */
	--h4-tail-display: none;
	--h4-tail-content: " ";
	--h4-tail-vertical-align: bottom;
	--h4-tail-display: var(--heading-tail-display);
	--h4-tail-content: var(--heading-tail-content);
	--h4-tail-shadow-color: var(--heading-tail-shadow-color);
	--h4-tail-shadow-height: var(--heading-tail-shadow-height);
	--h4-tail-shadow-width: var(--heading-tail-shadow-width);
	--h4-display: flex;
}


.one2mp h4 {
	font-family: var(--h4-font-family);
	font-weight: var(--h4-font-weight);
	font-size: var(--h4-font-size);
	line-height: var(--h4-line-height);
	letter-spacing: var(--h4-letter-spacing);
	text-align: var(--h4-text-align);
	color: var(--h4-color);
	font-style: var(--h4-font-style);
	text-decoration-style: var(--h4-text-decoration-style);
	text-decoration-thickness: var(--h4-text-decoration-thickness);
	text-decoration-color: var(--h4-text-decoration-color);
	margin: var(--h4-margin);
	border-bottom-width: var(--h4-border-bottom-width);
	border-bottom-style: var(--h4-border-bottom-style);
	border-bottom-color: var(--h4-border-bottom-color);
	display: var(--h4-display);
}


.one2mp h4 .one2mp-heading-prefix {
	display: var(--h4-prefix-display);
	color: var(--h4-prefix-color);
	font-style: var(--h4-font-style);
	text-align: var(--h4-text-align);

}

.one2mp h4 .one2mp-heading-outbox {
	border-top-right-radius: var(--h4-outbox-radius);
	border-top-left-radius: var(--h4-outbox-radius);
	background-color: var(--h4-bg);
	padding: var(--h4-outbox-padding);
	display: block;
}

.one2mp h4 .one2mp-heading-leaf {
	padding-left: var(--h4-leaf-padding);
	padding-right: var(--h4-leaf-padding);
	font-weight: var(--h4-font-weight);
	display: var(--h4-leaf-display);
	color: var(--h4-leaf-color)
}

.one2mp h4 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h4-tail-display);
	content: var(--h4-tail-content);
	vertical-align: var(--h4-tail-vertical-align);
	border-bottom: var(--h4-tail-shadow-height) solid var(--h4-tail-shadow-color);
	border-right: var(--h4-tail-shadow-width) solid transparent;
}
`});var Os,Ds=j(()=>{Os=`/**
h5  \u6807\u9898
*/

:root {
	--h5-font-family: var(--heading-font-family);
	--h5-font-weight: var(--heading-font-weight);
	--h5-color: var(--heading-color);
	--h5-font-size: 1.2rem;
	--h5-line-height: var(--heading-line-height);
	--h5-letter-spacing: var(--heading-letter-spacing);
	--h5-text-align: var(--heading-text-align);
	--h5-font-style: var(--heading-font-style);
	--h5-text-decoration-style: var(--heading-text-decoration-style);
	--h5-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h5-text-decoration-color: var(--heading-text-decoration-color);
	--h5-margin: var(--heading-margin);
	/* --h5-bg: var(--one2mp-primary); */
	--h5-bg: var(--one2mp-bg);
	--h5-border-bottom-width: var(--heading-border-bottom-width);
	/* --h5-border-bottom-color: var(--h5-bg); */
	--h5-border-bottom-color: var(--heading-border-bottom-color);
	--h5-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h5-prefix-display: none;
	--h5-prefix-color: var(--h5-color);
	--h5-font-style: normal;
	--h5-text-align: var(--h5-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h5-outbox-display: block;
	--h5-outbox-radius: var(--one2mp-border-radius);
	--h5-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h5-leaf-display: block;
	--h5-leaf-padding: var(--heading-padding);
	--h5-leaf-color: var(--h5-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h5-tail-display: inline-block; */
	--h5-tail-display: none;
	--h5-tail-content: " ";
	--h5-tail-vertical-align: bottom;
	--h5-tail-display: var(--heading-tail-display);
	--h5-tail-content: var(--heading-tail-content);
	--h5-tail-shadow-color: var(--heading-tail-shadow-color);
	--h5-tail-shadow-height: var(--heading-tail-shadow-height);
	--h5-tail-shadow-width: var(--heading-tail-shadow-width);
	--h5-display: flex;
}

.one2mp h5 {
	font-family: var(--h5-font-family);
	font-weight: var(--h5-font-weight);
	font-size: var(--h5-font-size);
	line-height: var(--h5-line-height);
	letter-spacing: var(--h5-letter-spacing);
	text-align: var(--h5-text-align);
	color: var(--h5-color);
	font-style: var(--h5-font-style);
	text-decoration-style: var(--h5-text-decoration-style);
	text-decoration-thickness: var(--h5-text-decoration-thickness);
	text-decoration-color: var(--h5-text-decoration-color);
	margin: var(--h5-margin);
	border-bottom-width: var(--h5-border-bottom-width);
	border-bottom-style: var(--h5-border-bottom-style);
	border-bottom-color: var(--h5-border-bottom-color);
	display: var(--h5-display);
}


.one2mp h5 .one2mp-heading-prefix {
	display: var(--h5-prefix-display);
	color: var(--h5-prefix-color);
	font-style: var(--h5-font-style);
	text-align: var(--h5-text-align);

}

.one2mp h5 .one2mp-heading-outbox {
	border-top-right-radius: var(--h5-outbox-radius);
	border-top-left-radius: var(--h5-outbox-radius);
	background-color: var(--h5-bg);
	padding: var(--h5-outbox-padding);
	display: block;
}

.one2mp h5 .one2mp-heading-leaf {
	padding-left: var(--h5-leaf-padding);
	padding-right: var(--h5-leaf-padding);
	font-weight: var(--h5-font-weight);
	display: var(--h5-leaf-display);
	color: var(--h5-leaf-color)
}

.one2mp h5 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h5-tail-display);
	content: var(--h5-tail-content);
	vertical-align: var(--h5-tail-vertical-align);
	border-bottom: var(--h5-tail-shadow-height) solid var(--h5-tail-shadow-color);
	border-right: var(--h5-tail-shadow-width) solid transparent;
}
`});var Ms,Ls=j(()=>{Ms=`/**
h6  \u6807\u9898
*/

:root {
	--h6-font-family: var(--heading-font-family);
	--h6-font-weight: var(--heading-font-weight);
	--h6-color: var(--heading-color);
	--h6-font-size: 1rem;
	--h6-line-height: var(--heading-line-height);
	--h6-letter-spacing: var(--heading-letter-spacing);
	--h6-text-align: var(--heading-text-align);
	--h6-font-style: var(--heading-font-style);
	--h6-text-decoration-style: var(--heading-text-decoration-style);
	--h6-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h6-text-decoration-color: var(--heading-text-decoration-color);
	--h6-margin: var(--heading-margin);
	/* --h6-bg: var(--one2mp-primary); */
	--h6-bg: var(--one2mp-bg);
	--h6-border-bottom-width: var(--heading-border-bottom-width);
	/* --h6-border-bottom-color: var(--h6-bg); */
	--h6-border-bottom-color: var(--heading-border-bottom-color);
	--h6-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h6-prefix-display: none;
	--h6-prefix-color: var(--h6-color);
	--h6-font-style: normal;
	--h6-text-align: var(--h6-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h6-outbox-display: block;
	--h6-outbox-radius: var(--one2mp-border-radius);
	--h6-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h6-leaf-display: block;
	--h6-leaf-padding: var(--heading-padding);
	--h6-leaf-color: var(--h6-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h6-tail-display: inline-block; */
	--h6-tail-display: none;
	--h6-tail-content: " ";
	--h6-tail-vertical-align: bottom;
	--h6-tail-display: var(--heading-tail-display);
	--h6-tail-content: var(--heading-tail-content);
	--h6-tail-shadow-color: var(--heading-tail-shadow-color);
	--h6-tail-shadow-height: var(--heading-tail-shadow-height);
	--h6-tail-shadow-width: var(--heading-tail-shadow-width);
	--h6-display: flex;
}

.one2mp h6 {
	font-family: var(--h6-font-family);
	font-weight: var(--h6-font-weight);
	font-size: var(--h6-font-size);
	line-height: var(--h6-line-height);
	letter-spacing: var(--h6-letter-spacing);
	text-align: var(--h6-text-align);
	color: var(--h6-color);
	font-style: var(--h6-font-style);
	text-decoration-style: var(--h6-text-decoration-style);
	text-decoration-thickness: var(--h6-text-decoration-thickness);
	text-decoration-color: var(--h6-text-decoration-color);
	margin: var(--h6-margin);
	border-bottom-width: var(--h6-border-bottom-width);
	border-bottom-style: var(--h6-border-bottom-style);
	border-bottom-color: var(--h6-border-bottom-color);
	display: var(--h6-display);
}


.one2mp h6 .one2mp-heading-prefix {
	display: var(--h6-prefix-display);
	color: var(--h6-prefix-color);
	font-style: var(--h6-font-style);
	text-align: var(--h6-text-align);

}

.one2mp h6 .one2mp-heading-outbox {
	border-top-right-radius: var(--h6-outbox-radius);
	border-top-left-radius: var(--h6-outbox-radius);
	background-color: var(--h6-bg);
	padding: var(--h6-outbox-padding);
	display: block;
}

.one2mp h6 .one2mp-heading-leaf {
	padding-left: var(--h6-leaf-padding);
	padding-right: var(--h6-leaf-padding);
	font-weight: var(--h6-font-weight);
	display: var(--h6-leaf-display);
	color: var(--h6-leaf-color)
}

.one2mp h6 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h6-tail-display);
	content: var(--h6-tail-content);
	vertical-align: var(--h6-tail-vertical-align);
	border-bottom: var(--h6-tail-shadow-height) solid var(--h6-tail-shadow-color);
	border-right: var(--h6-tail-shadow-width) solid transparent;
}
`});var Fs,Rs=j(()=>{Fs=`:root {
	--image-border-radius: var(--one2mp-border-radius);
	--image-border-width: 0px;
	--image-border-color: transparent;
	--image-border-style: solid;
	--image-frame-padding: 0px;
	--image-caption-triangle: hidden;
	--image-caption-triangle-width: 0rem;
	--image-caption-margin-top: -1rem;
	--image-caption-text-color: var(--one2mp-text-color);
	--image-cation-font-size: 0.8rem;
	--image-caption-font-weight: normal;
	--image-caption-font-style: normal;
	--image-caption-font-family: var(--article-font-family);
	--image-caption-line-height: 1.5;
	--image-caption-text-align: center;
}

.one2mp img:not(.one2mp-profile-card img) {
	border-radius: var(--image-border-radius);
	border-width: var(--image-border-width); 
	border-style: var(--image-border-style);
	border-color: var(--image-border-color);
	box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
	margin: 0.0 0;
}

.image-with-caption {
	position: relative;
	display: inline-block;
	text-align: center;
	/* \u9ED8\u8BA4\u5C45\u4E2D\uFF0C\u53EF\u901A\u8FC7\u7C7B\u63A7\u5236 */
	font-family: "Arial", sans-serif;
	border-radius: var(--image-border-radius);
	border-width: var(--image-border-width); 
	border-style: var(--image-border-style);
	border-color: var(--image-border-color);
	box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
	padding: var(--image-frame-padding);
	margin: 0;
}

.image-with-caption img {
	max-width: 100%;
	height: auto;
	display: block;
}

/* \u5BF9\u9F50\u65B9\u5F0F\u63A7\u5236 */
.image-with-caption.align-left {
	text-align: left;
}

.image-with-caption.align-center {
	text-align: center;
}

.image-with-caption.align-right {
	text-align: right;
}

/* \u4F2A\u5143\u7D20\u4F5C\u4E3A\u56FE\u7247\u6807\u9898 */
.image-caption {
	font-size: 0.9rem;
	color: gray;
	position: relative;
	margin-right: auto;
}

.image-caption-row {
	display: flex;
	align-items: center;
	gap: 0.5em;
	/* \u4E09\u89D2\u5F62\u548C\u6587\u5B57\u4E4B\u95F4\u7684\u95F4\u8DDD */
	margin-bottom: 0.5em;
	position: relative;
	top: -0.3rem;
}

.image-with-caption .triangle {
	width: 0;
	height: 0;
	border: var(--image-caption-triangle-width, 0.3rem) solid transparent;
	border-bottom-color: var(--image-border-color, #555);
	position: relative;
	top: -0.3rem;
	margin-left: auto;
}

.one2mp .caption {
	font-size: 0.9rem;
	color: var(--image-border-color, #555);
	position: relative;
	width: 100%;
	text-align: center;
	top: var(--image-caption-margin-top, -2rem);
}

.one2mp .one2mp-image-caption {
	font-size: var(--image-cation-font-size);
	color: var(--image-caption-text-color);
	font-weight: var(--image-caption-font-weight);
	font-style: var(--image-caption-font-style);
	font-family: var(--image-caption-font-family);
	line-height: var(--image-caption-line-height);
	text-align: var(--image-caption-text-align);
	position: relative;
	width: 100%;
	text-align: var(--image-caption-text-align);
	top: var(--image-caption-margin-top, -2rem);
}
`});var qs,Bs=j(()=>{qs=`/* list */
:root {
	--list-text-color: var(--article-text-color, #333);
	--list-bg-color: var(--article-bg-color, #fff);
	--list-padding-left: 0.5rem;
	--list-line-height: var(--article-line-height, 1.6);
	--list-ul-style: disc;
	--list-ol-style: decimal;
	--list-item-margin-bottom: 3px;
	--list-margin-top: 3px;
	--list-margin-buton: 3px;
	--list-margin-left: 1rem;
	--list-text-indent: 0;
}
.one2mp ol,
.one2mp ul:not(.one2mp .code-section ul) {
	color: var(--list-text-color, #333);
	/* background-color: var(--list-bg-color, #fff); */
	padding-left: var(--list-padding-left);
	margin-left: var(--list-margin-left, 1rem);
	margin-top: var(--list-margin-top, 0);
	margin-bottom: var(--list-margin-bottom, 0);
	line-height: var(--list-line-height, 1.5);
	text-indent: var(--list-text-indent, 0);

}

.one2mp ol {
	list-style-type: var(--list-ol-style, decimal);
}
.one2mp ul:not(.one2mp .code-section ul) {
	list-style-type: var(--list-ul-style, disc);
}


.one2mp ol li,
.one2mp ul li:not(.one2mp .code-section ul li) {
	margin-bottom: var(--list-item-margin-bottom, 3px);
	line-height: var(--list-line-height, 1.6);
	padding-left: var(--list-padding-left);
}

.one2mp ul li ul {
  list-style-type: circle;
  padding-left: var(--list-padding-left);
}
`});var js,Ns=j(()=>{js=`:root {
  --footnote-color:  #a0a0a0;
  --footnote-hover-color: #666;
  --footnote-font-size: 12px;
  --hr-color: #ccc;
  --hr-height: 1px;
  --hr-margin: 1em 0;
}

.one2mp hr {
	border-bottom: var(--hr-height, 1px) solid var(--hr-color, #eaeaea);
	border-bottom: none;
	border-left: none;
	border-right: none;
	margin-top: 20px;
	margin-bottom: 20px;
}

.one2mp .foot-links hr {
	margin-top: 2rem;
	margin-bottom: 0.5rem;
}

.one2mp .foot-links {
	font-size: var(--footnote-font-size, 12px);
	color: var(--footnote-color, #a0a0a0);
}

/* footnote */
.one2mp .footnote-id {
	color: var(--wechat-footnote-text-color, #999);
	margin-right: 0.5em;

}

.one2mp .footnote {
	font-size: 0.9em;
	font-weight: 300;
	margin-left: 0.5em;
}
`});var Hs,zs=j(()=>{Hs=`:root {
	--table-border-color: var(--one2mp-border-color, #454545);
	--table-border-width: var(--one2mp-border-width, 1px);
	--table-border-style: var(--one2mp-border-style, solid);
	--table-padding: var(--one2mp-padding, 16px);
	--table-margin: var(--one2mp-margin, 0);
	--table-background-color: var(--one2mp-bg, #fff);
	--table-background-color-alt: #eaeaea;
	--table-background-color-hover: var(--one2mp-bg-alt, #0d5c7e);
	--table-font-size: var(--one2mp-font-size, 16px);
	--table-font-weight: var(--one2mp-font-weight, 400);
	--table-line-height: var(--one2mp-line-height, 1.4);
	--table-text-align: var(--one2mp-text-align, left);
	--table-text-indent: var(--one2mp-text-indent, 0);
	--table-text-color: var(--one2mp-text-color, #333);
	--table-header-color: var(--one2mp-header-color, #333);
	--table-header-background-color: #b9b9b9;
	--table-header-font-weight: var(--one2mp-header-font-weight, 600);
	--table-header-line-height: var(--one2mp-header-line-height, 1.5);
	--table-header-text-align: var(--one2mp-header-text-align, left);
	--table-min-width: var(--one2mp-min-width, 100px);
	--table-container-overflow: auto;
	--tabble-radius: 0;
	--table-width: max-content;
	--tabble-white-space: nowrap;
	--table-layout: fixed;
	--table-collapse: collapse;
	--table-td-max-width: 200px;
	--table-td-min-width: 50px;
	--table-td-text-align: left;
	--table-td-word-break: break-word;
	--table-td-white-space: normal;
}

.one2mp .table-container {
	display: flex;
	width: 100%;
	overflow-x: var(--table-container-overflow);
	padding: 1px;
	box-shadow: 0 4px 8px var(--one2mp-shadow, (0, 0, 0, 0.1));
}

.one2mp table {
	border-collapse: var(--table-collapse);
	width: var(--table-width);
	border-color: var(--table-border-color);
	white-space: var(--tabble-white-space);
	table-layout: var(--table-layout);
}

.one2mp thead tr {
	background-color: var(--table-header-background-color);
	color: var(--table-header-color);
	text-align: var(--table-header-text-align);
	line-height: var(--table-header-line-height);
	font-weight: var(--table-header-font-weight);
}
 
.one2mp thead th {
	background-color: var(--table-header-background-color);
	color: var(--table-header-color);
}

/* table body text */
.one2mp tbody tr{
	line-height: var(--table-line-height, 1.5);
	text-align: var(--table-text-align, left);
	background-color: var(--table-background-color); 
	color: var(--table-text-color);
	font-size: var(--table-font-size);
	font-weight: var(--table-font-weight);
}
/* border */
.one2mp th,
.one2mp tr,
.one2mp td {
	border-color: var(--table-border-color);
	border-width: var(--table-border-width);
	border-style: solid;
	max-width: var(--table-td-max-width);
	min-width: var(--table-td-min-width);
	text-align: var(--table-td-text-align);
	word-break: var(--table-td-word-break);
	white-space: var(--table-td-white-space);
}

.one2mp td {
	background-color: var(--table-background-color);
	color: var(--table-text-color);
}

.one2mp tr:nth-child(even) {
	background-color: var(--table-background-color-alt);
	/* \u5076\u6570\u884C\u80CC\u666F\u8272 */;
}

.one2mp tr:nth-child(even) td {
	background-color: var(--table-background-color-alt);
}

.one2mp thead tr:first-child th:first-child {
	border-top-left-radius: var(--tabble-radius);
}
.one2mp thead tr:first-child th:last-child {
	border-top-right-radius: var(--tabble-radius);
}
.one2mp tbody tr:last-child td:first-child {
	border-bottom-left-radius: var(--tabble-radius);
}
.one2mp tbody tr:last-child td:last-child {
	border-bottom-right-radius: var(--tabble-radius);
}
`});var Ws,Us=j(()=>{Ws=`/* code section */

:root {
	--code-container-background-color: #282c34;
	/*#1E1E1E;*/
	--code-section-background-color: #282c34;
	--code-color: #abb2bf;
	--code-comment-color: #5c6370;
	--code-keyword-color: #c678dd;
	--code-name-color: #e06c75;
	--code-literal-color: #56b6c2;
	--code-string-color: #98c379;
	--code-variable-color: #d19a66;
	--code-symbol-color: #61aeee;
	--code-class-color: #e6c07b;
	--code-line-height: 1.6;
	--code-line-color: rgb(253, 247, 247);
	--code-font-size: 0.9rem;
	--code-padding: 8px;
	--code-border-radius: 6px;
	--code-banner-display: inline-block;
	--code-border-color: rgb(166, 166, 166);
	--code-border-width: 0.5px;
}

.one2mp code {
	display: inline;
	color: var(--code-color, rgb(153, 153, 153));
	line-height: var(--code-line-height, 1.6);
}

.one2mp .code-container {
	display: flex;
	flex-direction: column;
	border-radius: var(--code-border-radius, 4px);
	background: var(--code-container-background-color, #1E1E1E);
	box-shadow: rgba(0, 0, 0, 0.55) 0px 10px 10px -10px;
	border-width: var(--code-border-width);
	border-style: solid;
	border-color: var(--code-border-color);
}


.one2mp .code-section-banner {
	background-image: url('https://mmbiz.qpic.cn/mmbiz_svg/QAm7hEbaujTQuIH8VVl7W7PicH14grAZxd7oUx579CB2wpytwlLSpiaq2DXBpNUz8R6ckkAuO8tBLr52XjAsvR67mh3oibs2dYK/640?wx_fmt=svg&from=appmsg&tp=webp&wxfrom=15&wx_lazy=1');
	background-position: 10px 10px;
	background-size: 40px auto;
	background-repeat: no-repeat;
	display: var(--code-banner-display, inline-block);
	height: 32px;
	width: 100%;
	border-bottom: solid 0.5px var(--code-color, rgb(153, 153, 153));
}

.one2mp .code-section {
	display: flex;
	flex-grow: 1;
	font-size: var(--code-font-size, 0.9rem);
	line-height: var(--code-line-height, 1.6);
	border-radius: var(--code-border-radius, 4px);
}

.one2mp .code-section pre {
	position: relative;
	padding: 2px;
	margin: 0;
	flex: 1;
	overflow: auto;
	border-bottom-left-radius: var(--code-border-radius, 4px);
	border-bottom-right-radius: var(--code-border-radius, 4px);

}


.one2mp .code-section code {
	display: block;
	padding: 10px 5px !important;
	padding-left: .5em;
	font-family: Consolas, Monaco, Menlo, monospace;
	white-space: pre-wrap !important;
	word-wrap: break-word !important;
	overflow-x: auto;
}

.one2mp .code-section ul {
	padding-top: var(--code-padding, 8px);
	padding-bottom: var(--code-padding, 8px);
	position: relative;
	overflow: hidden;
	background: var(--code-section-background-color, #282c34) !important;
	display: flex;
	flex-direction: column;
	flex-shrink: 0;
	counter-reset: line;
	margin: 0;
	padding: 10px 0 0 0;
	white-space: normal;
	width: fit-content;
	user-select: none;
	border-right: solid 0.5px rgb(166, 166, 166);
	padding-right: 5px;
	color: var(--code-line-color, green);
	border-bottom-left-radius: var(--code-border-radius, 4px);
}

.one2mp .code-section ul>li {
	position: relative;
	margin: 0;
	display: list-item;
	text-align: right;
	text-wrap: nowrap;
	line-height: var(--code-line-height, 1.6);
	font-size: var(--code-font-size, 0.9rem);
	font-family: Menlo-Regular, Menlo, Monaco, Consolas, "Courier New", monospace;
	list-style-type: none;
	color: var(--code-line-color, red);
	padding-left: 1rem;

}

.one2mp .code-section ul>li::marker {
	content: none;
}

.one2mp pre code .hljs {
	display: block;
	overflow-x: auto;
	padding: 1em
}

.one2mp code .hljs {
	padding: 3px 5px
}

/*
  
  Atom One Dark by Daniel Gamage
  Original One Dark Syntax theme from https://github.com/atom/one-dark-syntax
  
  base:    #282c34
  mono-1:  #abb2bf
  mono-2:  #818896
  mono-3:  #5c6370
  hue-1:   #56b6c2
  hue-2:   #61aeee
  hue-3:   #c678dd
  hue-4:   #98c379
  hue-5:   #e06c75
  hue-5-2: #be5046
  hue-6:   #d19a66
  hue-6-2: #e6c07b
  
  */
.one2mp .hljs {
	color: var(--code-color, #abb2bf);
	background: var(--code-section-background-color, #282c34)
}

.one2mp .hljs-comment,
.one2mp .hljs-quote {
	color: var(--code-color, #5c6370);
	font-style: italic
}

.one2mp .hljs-doctag,
.one2mp .hljs-keyword,
.one2mp .hljs-formula {
	color: var(--code-keyword-color, #c678dd)
}

.one2mp .hljs-section,
.one2mp .hljs-name,
.one2mp .hljs-selector-tag,
.one2mp .hljs-deletion,
.one2mp .hljs-subst {
	color: var(--code-name-color, #e06c75)
}

.one2mp .hljs-literal {
	color: var(--code-literal-color, #56b6c2)
}

.one2mp .hljs-string,
.one2mp .hljs-regexp,
.one2mp .hljs-addition,
.one2mp .hljs-attribute,
.one2mp .hljs-meta .one2mp .hljs-string {
	color: var(--code-string-color, #98c379)
}

.one2mp .hljs-attr,
.one2mp .hljs-variable,
.one2mp .hljs-template-variable,
.one2mp .hljs-type,
.one2mp .hljs-selector-class,
.one2mp .hljs-selector-attr,
.one2mp .hljs-selector-pseudo,
.one2mp .hljs-number {
	color: var(--code-variable-color, #d19a66)
}

.one2mp .hljs-symbol,
.one2mp .hljs-bullet,
.one2mp .hljs-link,
.one2mp .hljs-meta,
.one2mp .hljs-selector-id,
.one2mp .hljs-title {
	color: var(--code-symbol-color, #61aeee)
}

.one2mp .hljs-built_in,
.one2mp .hljs-title.class_,
.one2mp .hljs-class .one2mp .hljs-title {
	color: var (--code-class-color, #e6c07b)
}

.one2mp .hljs-emphasis {
	font-style: italic
}

.one2mp .hljs-strong {
	font-weight: bold
}

.one2mp .hljs-link {
	text-decoration: underline
}`});var Ks,Vs=j(()=>{Ks=`:root {
	--blockquote-color: rgba(0, 0, 0, 0.5);
	--blockquote-border-color:  var(--blockquote-color);
	--blockquote-border-width: 0px;
	--blockquote-border-style: solid;	
	--blockquote-border-radius: 4px;
	--blockquote-padding: 20px;
	--blockquote-margin: 0px;
	--blockquote-font-size: 1em;
	--blockquote-background-color: rgba(0, 0, 0, 0.05);
	--blockquote-inner-background-color: var(--blockquote-background-color);
	--blockquote-font-family: var(--article-font-family);
	--blockquote-font-style: italic;
}

.one2mp blockquote {
	border-left-width: var(--blockquote-border-width);
	border-left-style: var(--blockquote-border-style);
	border-left-color: var(--blockquote-border-color);
	border-radius: var(--blockquote-border-radius);
	padding: var(--blockquote-padding);
	margin: var(--blockquote-margin);
	color: var(--one2mp-secondary);	
	background-color: var(--blockquote-background-color);
	line-height: var(--one2mp-line-height);
	text-indent: 0;
	color: var(--blockquote-color);
	font-family: var(--blockquote-font-family);
	font-size: var(--blockquote-font-size);
	font-style: var(--blockquote-font-style);
}

.blockquote-inner {
  background: transparent;
  padding: 0px;
  transform: skew(0.0deg, 0.0deg); /* \u62B5\u6D88\u5916\u5C42\u503E\u659C\uFF0C\u8BA9\u5185\u5BB9\u4E0D\u6B6A */
}

/* .icon-pin {
  position: absolute;
  top: -12px;
  right: -12px;
  width: 24px;
  height: 24px;
  background-image: var(--icon-book);
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  pointer-events: none;
  visibility: visible
} */
`});var Js,Gs=j(()=>{Js=`:root{
	--link-color: var(--one2mp-secondary, rgb(0, 102, 204));
	--link-hover-color: var(--one2mp-primary-light, rgb(0, 128, 255));
	--link-active-color: var(--one2mp-primary, rgb(0, 128, 255));
}


.one2mp a {
	font-weight: 500;
	text-decoration: none;
	color: var(--link-color, rgb(0, 102, 204));
}

.one2mp a:hover,
.one2mp a:active {
	border-bottom: 1.5px solid var(--link-color, rgb(0, 102, 204));
	color: var(--link-hover-color, rgb(0, 128, 255));
}

.one2mp a:before {
	content: "\u21F2";
}
`});var Zs,Qs=j(()=>{Zs=`/* Callout Styles */

:root {
    --callout-background-color: rgba(8, 109, 221, 0.04);
	--callout-box-shadow: 0 8px 16px rgba(0, 0, 0, 0.16);
    --callout-border-color: rgba(8, 109, 221, 0.18);
	--callout-border-radius: var(--one2mp-border-radius, 4px);
	--callout-border-width: 0px;
    --callout-icon-color: rgba(8, 109, 221, 0.5);
    --callout-icon-size: 1.25em;
    --callout-icon-margin: 0.25em;
    --callout-text-color: var(--article-text-color, #333333);
	--cursor: pointer;
}

.one2mp-callout {
    overflow: hidden;
    border-style: solid;
    border-color: var(--callout-border-color, rgba(8, 109, 221, 0.25));
    border-width: var(--callout-border-width, 0px);
    border-radius: var(--callout-border-radius, 4px);
    margin: 1em 0;
    background-color: var(--callout-background-color, rgba(8, 109, 221, 0.1));
    padding: 12px 12px 12px 24px;
    opacity: 1;
    filter: none;
}

.one2mp-callout:not(.admonition).drop-shadow {
    box-shadow: var(--callout-box-shadow, 0 4px 8px  rgba(0, 0, 0, 0.2));
}

.one2mp-callout:not(.admonition) .no-title {
    display: none;
}


@supports selector(:has(*)) {

    :has(.one2mp-callout .callout-title .callout-title-inner:dir(rtl)),
    .one2mp-callout:has(> .callout-title .callout-title-inner:dir(rtl)) {
        direction: rtl;
    }

    :has(.one2mp-callout .callout-title .callout-title-inner:dir(rtl))>.callout-title,
    .one2mp-callout:has(> .callout-title .callout-title-inner:dir(rtl))>.callout-title {
        direction: rtl;
        --direction: -1;
    }

    :has(.one2mp-callout .callout-title .callout-title-inner:dir(rtl))>.callout-title .callout-icon svg.svg-icon,
    .one2mp-callout:has(> .callout-title .callout-title-inner:dir(rtl))>.callout-title .callout-icon svg.svg-icon {
        transform: scale(-1, 1);
    }
}

.one2mp-callout {
    background-color: var(--callout-background-color, rgba(8, 109, 221, 0.1));
    box-shadow: var(--callout-box-shadow, 0 4px 8px  rgba(0, 0, 0, 0.2));
}


.callout-icon {
    height: 1em;
}

.one2mp-callout[data-callout="summary"] {
    background-color: rgba(0, 191, 188, 0.04);
}
.one2mp-callout[data-callout="abstract"],
.one2mp-callout[data-callout="tldr"] {
    background-color: rgba(0, 176, 255, 0.04);
}

.one2mp-callout[data-callout="info"] {
    background-color: rgba(8, 109, 221, 0.04);
}

.one2mp-callout[data-callout="todo"] {
    background-color: rgba(8, 109, 221, 0.04);
}

.one2mp-callout[data-callout="important"] {
    background-color: rgba(8, 191, 188, 0.04);
}

.one2mp-callout[data-callout="tip"],
.one2mp-callout[data-callout="hint"] {
    background-color: rgba(8, 191, 188, 0.04);
}

.one2mp-callout[data-callout="success"],
.one2mp-callout[data-callout="check"],
.one2mp-callout[data-callout="done"] {
    background-color: rgba(8, 185, 78, 0.04);

}

.one2mp-callout[data-callout="question"],
.one2mp-callout[data-callout="help"],
.one2mp-callout[data-callout="faq"] {
    background-color: rgba(236, 117, 0, 0.04);
}

.one2mp-callout[data-callout="warning"],
.one2mp-callout[data-callout="caution"],
.one2mp-callout[data-callout="attention"] {
    background-color: rgba(236, 117, 0, 0.04);
}

.one2mp-callout[data-callout="failure"],
.one2mp-callout[data-callout="fail"],
.one2mp-callout[data-callout="missing"] {
    background-color: rgba(233, 49, 71, 0.04);
}

.one2mp-callout[data-callout="danger"],
.one2mp-callout[data-callout="error"] {
    background-color: rgba(233, 49, 71, 0.04);
}

.one2mp-callout[data-callout="bug"] {
    background-color: rgba(233, 49, 71, 0.04);
}

.one2mp-callout[data-callout="example"] {
    background-color: rgba(120, 82, 238, 0.04);
}

.one2mp-callout[data-callout="quote"],
.one2mp-callout[data-callout="cite"] {
    background-color: rgba(158, 158, 158, 0.04);
}

/* title start */
.one2mp-callout.is-collapsible  {
    cursor: var(--cursor);
}


.callout-title {
    padding: 0;
    display: flex;
    gap: 4px;
    font-size: inherit;
    line-height: 1.3;
    align-items: flex-start;
    color: rgb(8, 109, 221);
}


.one2mp-callout[data-callout="summary"] .callout-title  {
    color: rgb(0, 191, 188);
}
.one2mp-callout[data-callout="abstract"] .callout-title ,
.one2mp-callout[data-callout="tldr"] .callout-title {
    color: rgb(0, 176, 255);
}

.one2mp-callout[data-callout="info"] .callout-title {
    color: rgb(8, 109, 221);
}

.one2mp-callout[data-callout="todo"] .callout-title {
    color: rgb(8, 109, 221);
}

.one2mp-callout[data-callout="important"] .callout-title {
    color: rgb(8, 191, 188);
}

.one2mp-callout[data-callout="tip"] .callout-title ,
.one2mp-callout[data-callout="hint"] .callout-title {
    color: rgb(8, 191, 188);
}

.one2mp-callout[data-callout="success"] .callout-title ,
.one2mp-callout[data-callout="check"] .callout-title ,
.one2mp-callout[data-callout="done"] .callout-title {
    color: rgb(8, 185, 78);

}

.one2mp-callout[data-callout="question"] .callout-title ,
.one2mp-callout[data-callout="help"] .callout-title ,
.one2mp-callout[data-callout="faq"] .callout-title {
    color: rgb(236, 117, 0);
}

.one2mp-callout[data-callout="warning"] .callout-title ,
.one2mp-callout[data-callout="caution"] .callout-title ,
.one2mp-callout[data-callout="attention"] .callout-title {
    color: rgb(236, 117, 0);
}

.one2mp-callout[data-callout="failure"] .callout-title ,
.one2mp-callout[data-callout="fail"] .callout-title ,
.one2mp-callout[data-callout="missing"] .callout-title {
    color: rgb(233, 49, 71);
}

.one2mp-callout[data-callout="danger"]  .callout-title ,
.one2mp-callout[data-callout="error"] .callout-title {
    color: rgb(233, 49, 71);
}

.one2mp-callout[data-callout="bug"] .callout-title {
    color: rgb(233, 49, 71);
}

.one2mp-callout[data-callout="example"] .callout-title {
    color: rgb(120, 82, 238);
}

.one2mp-callout[data-callout="quote"] .callout-title ,
.one2mp-callout[data-callout="cite"]  .callout-title {
    color: rgb(158, 158, 158);
}

/* title end */
.callout-content {
    overflow-x: auto;
    padding: 0; 
    background-color: transparent;
    opacity: 1;
    filter: none;
}

.one2mp-callout .callout-content p,
.one2mp-callout .callout-content li,
.one2mp-callout .callout-content span,
.one2mp-callout .callout-content strong,
.one2mp-callout .callout-content em,
.one2mp-callout .callout-content a,
.one2mp-callout .callout-content code,
.one2mp-callout .callout-text {
    color: var(--callout-text-color, #333333);
    opacity: 1;
}

.one2mp-callout .callout-text {
    color: var(--article-text-color, #333333) !important;
    opacity: 1 !important;
}

.callout-content .one2mp-callout {
    margin-top: 20px;
}

.callout-icon {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
}



.callout-title-inner {
    font-weight: 600; 
    color: inherit; 
}

.callout-fold {
    display: flex;
    align-items: center;
    padding-inline-end: 8px; 
}


.callout-fold .svg-icon {
    transition: transform 100ms ease-in-out;
}

.callout-fold.is-collapsed .svg-icon {
    transform: rotate(-1 * -1 * 90deg);
}
`});var Xs,Ys=j(()=>{Xs=`.admonition {
    margin-top: 1.5em;
    margin-bottom: 1.5em;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.admonition.no-title .admonition-content {
    margin-top: 0;
    margin-bottom: 0;
}

.admonition li.task-list-item.is-checked p {
    text-decoration: line-through;
}

.admonition.no-drop {
    box-shadow: none;
}

.admonition.no-drop>.admonition-title.no-title+.admonition-content,
.admonition.no-drop .admonition .admonition-title.no-title+.admonition-content {
    margin-top: 0;
    margin-bottom: 0;
}

.admonition.no-drop .admonition .admonition-content {
    border-right: .0625em solid rgba(233, 233,123, .2);
    border-bottom: .0625em solid rgba(233, 233,123, .2);
}

.admonition.no-drop .admonition .admonition-title.no-title+.admonition-content {
    border-top: .0625em solid rgba(233, 233,123, .2);
}

:is(.markdown-source-view.mod-cm6) .admonition .math-block>mjx-container,
:is(.markdown-reading-view) .admonition .math-block>mjx-container {
    display: block;
    text-align: center;
    padding: 1em;
}

:is(.markdown-reading-view) .admonition .math-block>mjx-container {
    padding: .0625em;
}

*:not(.is-live-preview) .admonition.no-content {
    display: none;
}

.admonition {
    margin-top: 0px;
    margin-bottom: .75em;
}

.admonition.no-content {
    opacity: .1;
}

.admonition-content p {
    line-height: inherit;
    margin: revert;
}

.admonition-content p br {
    display: initial;
}

.admonition-content p ul>li>ul {
    border-left: 2px;
    border-left-color: #ababab;
    border-left-style: solid;
}

.admonition-content:first-child {
    margin-top: .8em;
}

.admonition-content:last-child {
    margin-bottom: .8em;
}

.admonition-title.no-title {
    display: none;
}

.admonition-title:hover+.admonition-content .admonition-content-copy {
    opacity: .7;
}

.admonition-content,
.callout-content {
    position: relative;
}

.admonition-content-copy {
    color: #ababab;
    cursor: pointer;
    opacity: 0;
    position: absolute;
    margin: .375em;
    right: 0;
    top: 0;
    transition: .3s opacity ease-in;
}

.admonition-content-copy:hover {
    color: inherit;
}

.admonition:hover .admonition-content-copy,
.callout:hover .admonition-content-copy,
.admonition-content-copy:hover {
    opacity: 1;
}


.admonition-content ul,
.admonition-content ol {
    white-space: normal;
}

.admonition-title-icon,
.fa {
    height: 1.2em;
    width: 1.2em;
}
`});var tl,el=j(()=>{tl=`.one2mp .inline-math{
    display: inline-block;
    padding: 0 0.5rem;
}

.one2mp .block-math {
    display: flex;
    width: 100%;
    overflow: auto;
    padding: 0.5rem;
}

.one2mp .block-math svg {
    width: fit-content;
    margin: auto;
}
`});var rl,nl=j(()=>{rl=`.one2mp .mermaid {
    display: flex;
    flex-direction: column;
    padding: 0;
    border: none;
    border-radius: 0;
    background: transparent;
    box-shadow: none;
}

.one2mp .mermaid image {
    width: 100%;
    margin: auto;
}

.one2mp .mermaid img {
    border: none;
    border-radius: 0;
    box-shadow: none;
    display: block;
}
`});var al,il=j(()=>{al=`.one2mp .charts {
    display: flex;
    flex-direction: column;
    padding: 3px;
    border: solid 1px #ccc;
    border-radius: 3px;
}

.one2mp .charts image
 {
    width: 100%;
    margin: auto;
}
`});var sl,ol=j(()=>{sl=`/* icon */

.obsidian-icon {
	font-size: inherit;
	display: inline-block;
	width: 1.8rem;
	text-align: center;
}

/* p .obsidian-icon {
	width: 1.75em
} */

.obsidian-icon.react-icon>svg {
	vertical-align: middle;
	margin-bottom: 3px;
}

.obsidian-icon.react-icon{
	width: 1.8rem;;
}
`});var cl,ll=j(()=>{cl=`/* summary */
.one2mp details {
	border: none;
	outline: none;
	/* border-left: 4px solid #3eaf7c; */
	padding-left: var(--wechat-collapse-padding, 1em);
	margin-left: var(--wechat-collapse-margin, 0);
	background-color: var(--wechat-collapse-bg-color, #f5f5f5);
}

.one2mp details summary {
	cursor: pointer;
	border: none;
	outline: none;
	margin: 0px -17px;
}

.one2mp details summary::-webkit-details-marker {
	color: var(--wechat-collapse-bg-color, #f5f5f5);
}
`});var dl,ul=j(()=>{dl=`
    :root{
		--profile-background-color: #fafafa;
		--profile-title-color: #1f1f1f;
		--profile-description-color: #333;
		--profile-meta-color: #666;
		--profile-border-color: #eee;
		--profile-footer-color: #999;
		--profile-footer-bg-color: #fafafa;
		--profile-avatar-size: 64px;
		--profile-width: 600px;
		--profile-radius: 12px;
	}
	.one2mp-profile-card {
      background-color: var(--profile-background-color, #fff);
      border-radius: var(--profile-radius, 12px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
      overflow: hidden;
      width: var(--profile-width, 600px);
    }

    .one2mp-profile-card .card-main {
      display: flex;
      align-items: center;
      padding: 20px;
    }

    .one2mp-profile-card .avatar {
      width: var(--profile-avatar-size, 64px);
      height: var(--profile-avatar-size, 64px);
      border-radius: 50%;
      overflow: hidden;
      margin-right: 16px;
      flex-shrink: 0;
    }

    .one2mp-profile-card .avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .one2mp-profile-card .content {
      flex-grow: 1;
    }

    .one2mp-profile-card .title {
      font-size: 20px;
      font-weight: bold;
      color: var(--profile-title-color, #1f1f1f);
      margin-bottom: 6px;
    }

    .one2mp-profile-card .description {
      font-size: 16px;
      color: var(--profile-description-color, #555);
      margin-bottom: 8px;
    }

    .one2mp-profile-card .meta {
      font-size: 14px;
      color: var(--profile-meta-color, #888);
    }

    .one2mp-profile-card .arrow {
      font-size: 20px;
      color: #999;
      margin-left: 12px;
    }

    .one2mp-profile-card .card-footer {
      background-color: var(--profile-footer-bg-color, #f7f7f7);
      padding: 10px 20px;
      font-size: 14px;
      color: var(--profile-footer-color, #999);
      border-top: 1px solid var(--profile-border-color, #eee);
    }
`});var hl,fl=j(()=>{hl=`.one2mp-mpcard-wrapper {
  margin: 20px 20px;
  background-color: rgb(250, 250, 250);
  padding: 10px 20px;
  border-radius: 10px;
}

.one2mp-mpcard-content {
  display: flex;
  align-items: center;
}

.one2mp-mpcard-headimg {
  border: none !important;
  border-radius: 27px !important;
  box-shadow: none !important;
  width: 54px !important;
  height: 54px !important;
  margin: 0 !important;
}

.one2mp-mpcard-info {
  margin-left: 10px;
}

.one2mp-mpcard-nickname {
  font-size: 17px;
  font-weight: 500;
  color: rgba(0, 0, 0, 0.9);
}

.one2mp-mpcard-signature {
  font-size: 14px;
  color: rgba(0, 0, 0, 0.55);
}

.one2mp-mpcard-foot {
  margin-top: 20px;
  padding-top: 10px;
  border-top: 1px solid #ececec;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.3);
}
`});var pl,ch,uh,dh,yr,gl=j(()=>{rs();as();ss();cs();ds();hs();gs();vs();ws();xs();_s();Ss();Cs();As();$s();Ds();Ls();Rs();Bs();Ns();zs();Us();Vs();Gs();Qs();Ys();el();nl();il();ol();ll();ul();fl();pl=require("obsidian");Fe();ch=[is,os,ls,us,fs,ps,ms,ys,bs,Ni,ks,Es,Ts,Ps,Is,Os,Ms,Fs,qs,js,Hs,Ws,Ks,Js,Zs,Xs,tl,rl,al,sl,Ni,cl,dl,hl],uh=["appmsg_","wx_","wx-","common-webchat","weui-"],dh=r=>uh.some(e=>r.startsWith(e)),yr=class{constructor(){this.vars=new Map;this.rules=new Map}async init(e){await this.buildBaseCSS();try{this.mergeCssText(e)}catch(t){new pl.Notice($("render.failed-to-parse-custom-css",[t])),console.error(t)}}async buildBaseCSS(){this.vars.clear(),this.rules.clear();for(let e of ch)this.mergeCssText(e)}resolveCssVars(e,t,n=0){let a=/var\(\s*--([\w-]+)(?:\s*,\s*((?:\((?:[^()]|\([^()]*\))*\)|[^)\s]|[\s\S])*?))?\s*\)/g,o=e,s;do s=!1,o=o.replace(a,(l,c,u)=>{let d=`--${c}`;if(t.has(d)){let f=t.get(d);return s=!0,f}else return u!==void 0?(s=!0,u):(console.warn(`Variable ${d} not found and no fallback provided`),"")}),n++;while(s&&n<10);return o}mergeCssText(e){if(!e||!e.trim())return;let t=this.parseCssText(e);this.mergeVars(t.vars),this.mergeRules(t.rules)}mergeVars(e){for(let[t,n]of e.entries())this.vars.set(t,n)}mergeRules(e){for(let[t,n]of e.entries()){let i=this.rules.get(t);i||(i=new Map,this.rules.set(t,i));for(let[a,o]of n.entries()){let s=i.get(a);(s===void 0||!s.important||o.important)&&i.set(a,o)}}}parseCssText(e){let t=new Map,n=new Map,i=this.parseWithCssSheet(e);return i?(this.collectRulesFromList(i.cssRules,t,n),{vars:t,rules:n}):(this.parseWithFallback(e,t,n),{vars:t,rules:n})}parseWithCssSheet(e){if(typeof CSSStyleSheet=="undefined")return null;let t=new CSSStyleSheet;try{return t.replaceSync(e),t}catch(n){return console.debug("CSSStyleSheet \u89E3\u6790\u5931\u8D25",n),null}}collectRulesFromList(e,t,n){for(let i of Array.from(e))i.type===CSSRule.STYLE_RULE?this.collectStyleRule(i,t,n):"cssRules"in i&&this.collectRulesFromList(i.cssRules,t,n)}collectStyleRule(e,t,n){if(!e.selectorText)return;let i=e.selectorText.split(",").map(a=>a.trim()).filter(Boolean);if(i.length!==0)for(let a of i){if(a===":root"){this.collectVariables(e.style,t);continue}this.collectDeclarations(a,e.style,n)}}collectVariables(e,t){for(let n=0;n<e.length;n++){let i=e.item(n);if(!i||!i.startsWith("--"))continue;let a=e.getPropertyValue(i).trim();a&&t.set(i,a)}}collectDeclarations(e,t,n){let i=n.get(e);i||(i=new Map,n.set(e,i));for(let a=0;a<t.length;a++){let o=t.item(a);if(!o||o.startsWith("--"))continue;let s=t.getPropertyValue(o).trim();s&&i.set(o,{value:s,important:t.getPropertyPriority(o)==="important"})}}parseWithFallback(e,t,n){let i=e.replace(/\/\*[\s\S]*?\*\//g,""),a=/([^{@}]+)\{([^}]*)\}/g,o;for(;(o=a.exec(i))!==null;){let s=o[1].trim();if(!s||s.startsWith("@"))continue;let l=o[2],c=this.parseDeclarations(l),u=s.split(",").map(d=>d.trim()).filter(Boolean);for(let d of u){if(d===":root"){for(let[m,w]of c.entries())m.startsWith("--")&&t.set(m,w.value);continue}let f=n.get(d);f||(f=new Map,n.set(d,f));for(let[m,w]of c.entries())m.startsWith("--")||f.set(m,w)}}}parseDeclarations(e){let t=new Map,n=e.split(";");for(let i of n){let a=i.trim();if(!a)continue;let o=a.indexOf(":");if(o===-1)continue;let s=a.slice(0,o).trim();if(!s)continue;let l=a.slice(o+1).trim(),c=!1;l.endsWith("!important")&&(c=!0,l=l.replace(/!important$/i,"").trim()),l&&t.set(s,{value:l,important:c})}return t}normalizeSelector(e){let t=e.match(/::(before|after)/),n=t?t[1]:null;return{baseSelector:n?e.replace(/::(before|after)/g,""):e,pseudo:n}}ensurePseudoElement(e,t,n){let i=`data-one2mp-pseudo-${t}`,a=e.querySelector(`[${i}]`);return a||(a=document.createElement("span"),a.setAttribute(i,"true"),t==="before"?e.prepend(a):e.append(a)),n&&(a.textContent=n.replace(/(^")|("$)/g,"")),a}applyStyleToElement(e){this.rules.forEach((n,i)=>{let{baseSelector:a,pseudo:o}=this.normalizeSelector(i);try{if(e.matches(a)){let s=e;if(o){let l=n.get("content");s=this.ensurePseudoElement(e,o,l==null?void 0:l.value)}n.forEach((l,c)=>{if(c==="content")return;let u=this.resolveCssVars(l.value,this.vars);s.setCssProps({[c]:l.important?`${u} !important`:u})})}}catch(s){console.debug("error selector=>",i," | Error=>",s.message)}});let t=e.firstElementChild;for(;t;)this.applyStyleToElement(t),t=t.nextElementSibling;return e}removeClassName(e){let t=e.getAttribute("class");if(t){let i=t.split(" ");for(let a of i)dh(a)||e.classList.remove(a)}e.removeAttribute("class");let n=e.firstElementChild;for(;n;)this.removeClassName(n),n=n.nextElementSibling}}});var wr={};Ct(wr,{ThemeManager:()=>an});var Be,ji,an,$n=j(()=>{Be=require("obsidian");Fe();vr();gl();ji=class{constructor(e){this.cssMerger=null;this.cachedCssKey=null;this.themes=[];this.plugin=e}async downloadThemes(){var n;let e=["https://raw.githubusercontent.com/ryfineZ/O2Any/main/themes/","https://fastly.jsdelivr.net/gh/ryfineZ/O2Any@main/themes/","https://ghproxy.com/https://raw.githubusercontent.com/ryfineZ/O2Any/main/themes/","https://gitee.com/ryfineZ/O2Any/raw/main/themes/","https://raw.githubusercontent.com/ryfineZ/O2Any/master/themes/","https://fastly.jsdelivr.net/gh/ryfineZ/O2Any@master/themes/","https://ghproxy.com/https://raw.githubusercontent.com/ryfineZ/O2Any/master/themes/","https://gitee.com/ryfineZ/O2Any/raw/master/themes/"],t=this.normalizeThemeFolder(this.plugin.settings.css_styles_folder);this.plugin.app.vault.getAbstractFileByPath(t)||await this.plugin.app.vault.createFolder(t);try{let i="",a,o=null;for(let m of e)try{if(a=await(0,Be.requestUrl)(`${m}themes.json`),a.status===200){i=m;break}o=new Error(a.text)}catch(w){o=w instanceof Error?w:new Error(String(w))}if(!a||a.status!==200||!i)throw new Error($("views.theme-manager.failed-to-fetch-themes-json-themesrespon",[(n=o==null?void 0:o.message)!=null?n:"unknown"]));let l=a.json.themes,c=0,u=0,d=0,f=this.plugin.settings.themeDownloadOverwrite;for(let m of l)try{let w=encodeURIComponent(m.file),C=await(0,Be.requestUrl)(`${i}${w}`);if(C.status!==200){console.warn(`Failed to download ${m.file}: ${C.text}`),u+=1;continue}let k=C.text,v=`${t}/${m.file}`,g=this.plugin.app.vault.getAbstractFileByPath(v);if(g){if(!f){d+=1;continue}if(g instanceof Be.TFile){await this.plugin.app.vault.modify(g,k),c+=1;continue}u+=1;continue}await this.plugin.app.vault.create(v,k),c+=1}catch(w){console.error(w),u+=1,new Be.Notice($("views.theme-manager.error-downloading-theme")+w.message);continue}new Be.Notice($("views.theme-manager.download-summary",[String(c),String(u),String(d)]))}catch(i){console.error("Error downloading themes:",i),new Be.Notice($("views.theme-manager.error-downloading-themes"))}}static getInstance(e){return this.instance||(this.instance=new ji(e)),this.instance}static resetInstance(){this.instance=null}async loadThemes(){this.themes=[];let e=this.normalizeThemeFolder(this.plugin.settings.css_styles_folder),t=this.plugin.app.vault.getAbstractFileByPath(e);return t instanceof Be.TFolder&&(this.themes=await this.getAllThemesInFolder(t)),this.themes}normalizeThemeFolder(e){let t=(e!=null?e:"").trim();return t||(t="one2mp-css-styles"),t=(0,Be.normalizePath)(t),t.startsWith("/")&&(t=t.slice(1)),t}cleanCSS(e){e=e.replace(/```[cC][Ss]{2}\s*|\s*```/g,"").trim();let t=/\/\*[\s\S]*?\*\//g,n=/\/\/.*/g,i=/\s+/g,a=/[\u200B\u00AD\uFEFF\u00A0]/g;return e.replace(t,"").replace(n,"").replace(i," ").replace(a,"").trim()}async extractCSSblocks(e){let t=[],n=this.plugin.app.vault.getFileByPath(e);if(!n)return"";let i=this.plugin.app.metadataCache.getFileCache(n);if(!(i!=null&&i.sections))return"";let a=await this.plugin.app.vault.read(n);for(let o of i.sections)if(o.type==="code"){let s=a.substring(o.position.start.offset,o.position.end.offset);if(!/^```css/i.test(s))continue;let l=s.indexOf(`
`),c=s.lastIndexOf(`
`),u=s.substring(l+1,c).trim();t.push(u)}return t.join(`
`)}async getThemeContent(e){let t=this.plugin.app.vault.getFileByPath(e);if(!t)return"";let n=await this.plugin.app.vault.cachedRead(t),i=/```[cC][Ss]{2}\s*([\s\S]+?)\s*```/gs,a=[],o;for(;(o=i.exec(n))!==null;)a.push(this.cleanCSS(o[1].trim()));return console.debug("cssBlocks=>",a),a.join(`
`)}async getCSS(){let e="";return this.plugin.settings.custom_theme&&(e=await this.extractCSSblocks(this.plugin.settings.custom_theme)),e}getShadowStleSheet(){let e=new CSSStyleSheet;return e.replaceSync(`
  /* \u6EDA\u52A8\u6761\u6837\u5F0F we use shadow dom, make the preview looks better.*/
.table-container::-webkit-scrollbar {
	width: 8px;
	height: 8px;
	background-color: var(--scrollbar-bg);
}

.table-container::-webkit-scrollbar-thumb {
	background-color: var(--scrollbar-thumb-bg);
    -webkit-border-radius: var(--radius-l);
    background-clip: padding-box;
    border: 2px solid transparent;
    border-width: 3px 3px 3px 2px;
    min-height: 45px;
}
.table-container::-webkit-scrollbar-thumb:hover {
	background-color: var(--scrollbar-thumb-hover-bg);
}

.one2mp-article::-webkit-scrollbar-corner{
	background: transparent;
}

.one2mp-article pre::-webkit-scrollbar {
	width: 8px;
	height: 8px;
	background-color: var(--scrollbar-bg);
}

.one2mp-article pre::-webkit-scrollbar-thumb {
	background-color: var(--scrollbar-thumb-bg);
    -webkit-border-radius: var(--radius-l);
    background-clip: padding-box;
    border: 2px solid transparent;
    border-width: 3px 3px 3px 2px;
    min-height: 45px;
}

.one2mp-article pre::-webkit-scrollbar-thumb:hover {
	background-color: var(--scrollbar-thumb-hover-bg);
}

.one2mp-article::-webkit-scrollbar-corner{
	background: transparent;
}
`),e}async getAllThemesInFolder(e){let t=[],n=async i=>{let a=i.children.map(async o=>{if(o instanceof Be.TFile&&o.extension==="md"){let s=await this.getThemeProperties(o);s&&t.push(s)}else o instanceof Be.TFolder&&await n(o)});await Promise.all(a)};return await n(e),t}async getThemeProperties(e){let t=await this.plugin.app.vault.cachedRead(e),{data:n}=rn(t),i=(n.theme_name||"").trim();if(i)return{name:i,path:e.path}}async applyTheme(e){var a;let t=await this.getCSS(),n=t;if((!this.cssMerger||this.cachedCssKey!==n)&&(this.cssMerger=new yr,await this.cssMerger.init(t),this.cachedCssKey=n),((a=e.dataset)==null?void 0:a.one2mpThemeKey)===n)return e;let i=this.cssMerger.applyStyleToElement(e);return i.dataset.one2mpThemeKey=n,i}},an=ji;an.instance=null});function on(r,e){if(r===e)return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;let t=Object.keys(r),n=Object.keys(e);if(t.length!==n.length)return!1;for(let i of t){let a=r,o=e;if(!n.includes(i)||!on(a[i],o[i]))return!1}return!0}async function In(r,e){if(!r)throw new Error(`Invalid URL: ${r}`);if(r.startsWith("data:"))return fh(r);if(e&&r.startsWith("app://")){let t=r.slice(6),n=t.indexOf("/"),i=n>=0?t.slice(n+1):t;i=decodeURIComponent(i),i=i.split("?")[0].split("#")[0];let a=i.replace(/^\/+/,""),o=i.startsWith("/")?i:`/${i}`,s=e.vault.adapter;if(s instanceof lt.FileSystemAdapter){let c=s.getBasePath();if(o.startsWith(c)){let u=o.slice(c.length);(u.startsWith("/")||u.startsWith("\\"))&&(u=u.slice(1));let d=ml(e,u);if(d instanceof lt.TFile){let f=await e.vault.readBinary(d);return new Blob([f])}}}let l=ml(e,a);if(l instanceof lt.TFile){let c=await e.vault.readBinary(l);return new Blob([c])}throw new Error(`Image not found in vault: ${i}`)}try{let t=await(0,lt.requestUrl)(r);if(!t.arrayBuffer)throw new Error(`Failed to fetch image from ${r}`);return new Blob([t.arrayBuffer])}catch(t){let n=t instanceof Error?t.message:String(t);throw new Error(`Error fetching image from ${r}: ${n}`)}}function fh(r){let[e,t]=r.split(","),n=e.match(/data:(.*?);base64/),i=n?n[1]:"application/octet-stream",a=atob(t),o=new Uint8Array(a.length);for(let s=0;s<a.length;s+=1)o[s]=a.charCodeAt(s);return new Blob([o],{type:i})}function vl(r){return et(r).replaceAll(/<div /g,"<section ").replaceAll(/<\/div>/g,"</section>")}function et(r){return new XMLSerializer().serializeToString(r)}function tt(r){return Array.from(r.childNodes).map(e=>et(e)).join("")}var lt,ml,ze=j(()=>{lt=require("obsidian");ml=(r,e)=>{var u,d,f,m,w,C,k,v;let t=r.vault,n=r.workspace.getActiveFile(),i=t.config,a=(u=i==null?void 0:i.attachmentFolderPath)!=null?u:"",o=e.trim();if(!o)return null;o=o.split("|")[0].split("?")[0].split("#")[0],(o.startsWith("/")||o.startsWith("\\"))&&(o=o.slice(1));let s=t.getAbstractFileByPath(o);if(s instanceof lt.TFile)return s;let l=r.metadataCache.getFirstLinkpathDest(o,(d=n==null?void 0:n.path)!=null?d:"");if(l instanceof lt.TFile)return l;if((f=n==null?void 0:n.parent)!=null&&f.path){let g=`${n.parent.path}/${o}`,h=t.getAbstractFileByPath(g);if(h instanceof lt.TFile)return h}let c=o.split("/").pop()||o;if(a){let g=[];if(a.startsWith("./")){let h=a.slice(2);g.push(`${(w=(m=n==null?void 0:n.parent)==null?void 0:m.path)!=null?w:""}/${h}/${c}`),g.push(`${(k=(C=n==null?void 0:n.parent)==null?void 0:C.path)!=null?k:""}/${h}/${o}`)}else g.push(`${a}/${c}`),g.push(`${a}/${o}`),(v=n==null?void 0:n.parent)!=null&&v.path&&(g.push(`${n.parent.path}/${a}/${c}`),g.push(`${n.parent.path}/${a}/${o}`));for(let h of g){let p=t.getAbstractFileByPath(h);if(p instanceof lt.TFile)return p}}return null}});var zi=Pi((yl,wl)=>{(function(r){if(typeof yl=="object")wl.exports=r();else if(typeof define=="function"&&define.amd)define(r);else{var e;try{e=window}catch(t){e=self}e.SparkMD5=r()}})(function(r){"use strict";var e=function(v,g){return v+g&4294967295},t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(v,g,h,p,b,S){return g=e(e(g,v),e(p,S)),e(g<<b|g>>>32-b,h)}function i(v,g){var h=v[0],p=v[1],b=v[2],S=v[3];h+=(p&b|~p&S)+g[0]-680876936|0,h=(h<<7|h>>>25)+p|0,S+=(h&p|~h&b)+g[1]-389564586|0,S=(S<<12|S>>>20)+h|0,b+=(S&h|~S&p)+g[2]+606105819|0,b=(b<<17|b>>>15)+S|0,p+=(b&S|~b&h)+g[3]-1044525330|0,p=(p<<22|p>>>10)+b|0,h+=(p&b|~p&S)+g[4]-176418897|0,h=(h<<7|h>>>25)+p|0,S+=(h&p|~h&b)+g[5]+1200080426|0,S=(S<<12|S>>>20)+h|0,b+=(S&h|~S&p)+g[6]-1473231341|0,b=(b<<17|b>>>15)+S|0,p+=(b&S|~b&h)+g[7]-45705983|0,p=(p<<22|p>>>10)+b|0,h+=(p&b|~p&S)+g[8]+1770035416|0,h=(h<<7|h>>>25)+p|0,S+=(h&p|~h&b)+g[9]-1958414417|0,S=(S<<12|S>>>20)+h|0,b+=(S&h|~S&p)+g[10]-42063|0,b=(b<<17|b>>>15)+S|0,p+=(b&S|~b&h)+g[11]-1990404162|0,p=(p<<22|p>>>10)+b|0,h+=(p&b|~p&S)+g[12]+1804603682|0,h=(h<<7|h>>>25)+p|0,S+=(h&p|~h&b)+g[13]-40341101|0,S=(S<<12|S>>>20)+h|0,b+=(S&h|~S&p)+g[14]-1502002290|0,b=(b<<17|b>>>15)+S|0,p+=(b&S|~b&h)+g[15]+1236535329|0,p=(p<<22|p>>>10)+b|0,h+=(p&S|b&~S)+g[1]-165796510|0,h=(h<<5|h>>>27)+p|0,S+=(h&b|p&~b)+g[6]-1069501632|0,S=(S<<9|S>>>23)+h|0,b+=(S&p|h&~p)+g[11]+643717713|0,b=(b<<14|b>>>18)+S|0,p+=(b&h|S&~h)+g[0]-373897302|0,p=(p<<20|p>>>12)+b|0,h+=(p&S|b&~S)+g[5]-701558691|0,h=(h<<5|h>>>27)+p|0,S+=(h&b|p&~b)+g[10]+38016083|0,S=(S<<9|S>>>23)+h|0,b+=(S&p|h&~p)+g[15]-660478335|0,b=(b<<14|b>>>18)+S|0,p+=(b&h|S&~h)+g[4]-405537848|0,p=(p<<20|p>>>12)+b|0,h+=(p&S|b&~S)+g[9]+568446438|0,h=(h<<5|h>>>27)+p|0,S+=(h&b|p&~b)+g[14]-1019803690|0,S=(S<<9|S>>>23)+h|0,b+=(S&p|h&~p)+g[3]-187363961|0,b=(b<<14|b>>>18)+S|0,p+=(b&h|S&~h)+g[8]+1163531501|0,p=(p<<20|p>>>12)+b|0,h+=(p&S|b&~S)+g[13]-1444681467|0,h=(h<<5|h>>>27)+p|0,S+=(h&b|p&~b)+g[2]-51403784|0,S=(S<<9|S>>>23)+h|0,b+=(S&p|h&~p)+g[7]+1735328473|0,b=(b<<14|b>>>18)+S|0,p+=(b&h|S&~h)+g[12]-1926607734|0,p=(p<<20|p>>>12)+b|0,h+=(p^b^S)+g[5]-378558|0,h=(h<<4|h>>>28)+p|0,S+=(h^p^b)+g[8]-2022574463|0,S=(S<<11|S>>>21)+h|0,b+=(S^h^p)+g[11]+1839030562|0,b=(b<<16|b>>>16)+S|0,p+=(b^S^h)+g[14]-35309556|0,p=(p<<23|p>>>9)+b|0,h+=(p^b^S)+g[1]-1530992060|0,h=(h<<4|h>>>28)+p|0,S+=(h^p^b)+g[4]+1272893353|0,S=(S<<11|S>>>21)+h|0,b+=(S^h^p)+g[7]-155497632|0,b=(b<<16|b>>>16)+S|0,p+=(b^S^h)+g[10]-1094730640|0,p=(p<<23|p>>>9)+b|0,h+=(p^b^S)+g[13]+681279174|0,h=(h<<4|h>>>28)+p|0,S+=(h^p^b)+g[0]-358537222|0,S=(S<<11|S>>>21)+h|0,b+=(S^h^p)+g[3]-722521979|0,b=(b<<16|b>>>16)+S|0,p+=(b^S^h)+g[6]+76029189|0,p=(p<<23|p>>>9)+b|0,h+=(p^b^S)+g[9]-640364487|0,h=(h<<4|h>>>28)+p|0,S+=(h^p^b)+g[12]-421815835|0,S=(S<<11|S>>>21)+h|0,b+=(S^h^p)+g[15]+530742520|0,b=(b<<16|b>>>16)+S|0,p+=(b^S^h)+g[2]-995338651|0,p=(p<<23|p>>>9)+b|0,h+=(b^(p|~S))+g[0]-198630844|0,h=(h<<6|h>>>26)+p|0,S+=(p^(h|~b))+g[7]+1126891415|0,S=(S<<10|S>>>22)+h|0,b+=(h^(S|~p))+g[14]-1416354905|0,b=(b<<15|b>>>17)+S|0,p+=(S^(b|~h))+g[5]-57434055|0,p=(p<<21|p>>>11)+b|0,h+=(b^(p|~S))+g[12]+1700485571|0,h=(h<<6|h>>>26)+p|0,S+=(p^(h|~b))+g[3]-1894986606|0,S=(S<<10|S>>>22)+h|0,b+=(h^(S|~p))+g[10]-1051523|0,b=(b<<15|b>>>17)+S|0,p+=(S^(b|~h))+g[1]-2054922799|0,p=(p<<21|p>>>11)+b|0,h+=(b^(p|~S))+g[8]+1873313359|0,h=(h<<6|h>>>26)+p|0,S+=(p^(h|~b))+g[15]-30611744|0,S=(S<<10|S>>>22)+h|0,b+=(h^(S|~p))+g[6]-1560198380|0,b=(b<<15|b>>>17)+S|0,p+=(S^(b|~h))+g[13]+1309151649|0,p=(p<<21|p>>>11)+b|0,h+=(b^(p|~S))+g[4]-145523070|0,h=(h<<6|h>>>26)+p|0,S+=(p^(h|~b))+g[11]-1120210379|0,S=(S<<10|S>>>22)+h|0,b+=(h^(S|~p))+g[2]+718787259|0,b=(b<<15|b>>>17)+S|0,p+=(S^(b|~h))+g[9]-343485551|0,p=(p<<21|p>>>11)+b|0,v[0]=h+v[0]|0,v[1]=p+v[1]|0,v[2]=b+v[2]|0,v[3]=S+v[3]|0}function a(v){var g=[],h;for(h=0;h<64;h+=4)g[h>>2]=v.charCodeAt(h)+(v.charCodeAt(h+1)<<8)+(v.charCodeAt(h+2)<<16)+(v.charCodeAt(h+3)<<24);return g}function o(v){var g=[],h;for(h=0;h<64;h+=4)g[h>>2]=v[h]+(v[h+1]<<8)+(v[h+2]<<16)+(v[h+3]<<24);return g}function s(v){var g=v.length,h=[1732584193,-271733879,-1732584194,271733878],p,b,S,R,B,F;for(p=64;p<=g;p+=64)i(h,a(v.substring(p-64,p)));for(v=v.substring(p-64),b=v.length,S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=0;p<b;p+=1)S[p>>2]|=v.charCodeAt(p)<<(p%4<<3);if(S[p>>2]|=128<<(p%4<<3),p>55)for(i(h,S),p=0;p<16;p+=1)S[p]=0;return R=g*8,R=R.toString(16).match(/(.*?)(.{0,8})$/),B=parseInt(R[2],16),F=parseInt(R[1],16)||0,S[14]=B,S[15]=F,i(h,S),h}function l(v){var g=v.length,h=[1732584193,-271733879,-1732584194,271733878],p,b,S,R,B,F;for(p=64;p<=g;p+=64)i(h,o(v.subarray(p-64,p)));for(v=p-64<g?v.subarray(p-64):new Uint8Array(0),b=v.length,S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=0;p<b;p+=1)S[p>>2]|=v[p]<<(p%4<<3);if(S[p>>2]|=128<<(p%4<<3),p>55)for(i(h,S),p=0;p<16;p+=1)S[p]=0;return R=g*8,R=R.toString(16).match(/(.*?)(.{0,8})$/),B=parseInt(R[2],16),F=parseInt(R[1],16)||0,S[14]=B,S[15]=F,i(h,S),h}function c(v){var g="",h;for(h=0;h<4;h+=1)g+=t[v>>h*8+4&15]+t[v>>h*8&15];return g}function u(v){var g;for(g=0;g<v.length;g+=1)v[g]=c(v[g]);return v.join("")}u(s("hello"))!=="5d41402abc4b2a76b9719d911017c592"&&(e=function(v,g){var h=(v&65535)+(g&65535),p=(v>>16)+(g>>16)+(h>>16);return p<<16|h&65535}),typeof ArrayBuffer!="undefined"&&!ArrayBuffer.prototype.slice&&function(){function v(g,h){return g=g|0||0,g<0?Math.max(g+h,0):Math.min(g,h)}ArrayBuffer.prototype.slice=function(g,h){var p=this.byteLength,b=v(g,p),S=p,R,B,F,K;return h!==r&&(S=v(h,p)),b>S?new ArrayBuffer(0):(R=S-b,B=new ArrayBuffer(R),F=new Uint8Array(B),K=new Uint8Array(this,b,R),F.set(K),B)}}();function d(v){return/[\u0080-\uFFFF]/.test(v)&&(v=unescape(encodeURIComponent(v))),v}function f(v,g){var h=v.length,p=new ArrayBuffer(h),b=new Uint8Array(p),S;for(S=0;S<h;S+=1)b[S]=v.charCodeAt(S);return g?b:p}function m(v){return String.fromCharCode.apply(null,new Uint8Array(v))}function w(v,g,h){var p=new Uint8Array(v.byteLength+g.byteLength);return p.set(new Uint8Array(v)),p.set(new Uint8Array(g),v.byteLength),h?p:p.buffer}function C(v){var g=[],h=v.length,p;for(p=0;p<h-1;p+=2)g.push(parseInt(v.substr(p,2),16));return String.fromCharCode.apply(String,g)}function k(){this.reset()}return k.prototype.append=function(v){return this.appendBinary(d(v)),this},k.prototype.appendBinary=function(v){this._buff+=v,this._length+=v.length;var g=this._buff.length,h;for(h=64;h<=g;h+=64)i(this._hash,a(this._buff.substring(h-64,h)));return this._buff=this._buff.substring(h-64),this},k.prototype.end=function(v){var g=this._buff,h=g.length,p,b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],S;for(p=0;p<h;p+=1)b[p>>2]|=g.charCodeAt(p)<<(p%4<<3);return this._finish(b,h),S=u(this._hash),v&&(S=C(S)),this.reset(),S},k.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},k.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},k.prototype.setState=function(v){return this._buff=v.buff,this._length=v.length,this._hash=v.hash,this},k.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},k.prototype._finish=function(v,g){var h=g,p,b,S;if(v[h>>2]|=128<<(h%4<<3),h>55)for(i(this._hash,v),h=0;h<16;h+=1)v[h]=0;p=this._length*8,p=p.toString(16).match(/(.*?)(.{0,8})$/),b=parseInt(p[2],16),S=parseInt(p[1],16)||0,v[14]=b,v[15]=S,i(this._hash,v)},k.hash=function(v,g){return k.hashBinary(d(v),g)},k.hashBinary=function(v,g){var h=s(v),p=u(h);return g?C(p):p},k.ArrayBuffer=function(){this.reset()},k.ArrayBuffer.prototype.append=function(v){var g=w(this._buff.buffer,v,!0),h=g.length,p;for(this._length+=v.byteLength,p=64;p<=h;p+=64)i(this._hash,o(g.subarray(p-64,p)));return this._buff=p-64<h?new Uint8Array(g.buffer.slice(p-64)):new Uint8Array(0),this},k.ArrayBuffer.prototype.end=function(v){var g=this._buff,h=g.length,p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b,S;for(b=0;b<h;b+=1)p[b>>2]|=g[b]<<(b%4<<3);return this._finish(p,h),S=u(this._hash),v&&(S=C(S)),this.reset(),S},k.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},k.ArrayBuffer.prototype.getState=function(){var v=k.prototype.getState.call(this);return v.buff=m(v.buff),v},k.ArrayBuffer.prototype.setState=function(v){return v.buff=f(v.buff,!0),k.prototype.setState.call(this,v)},k.ArrayBuffer.prototype.destroy=k.prototype.destroy,k.ArrayBuffer.prototype._finish=k.prototype._finish,k.ArrayBuffer.hash=function(v,g){var h=l(new Uint8Array(v)),p=u(h);return g?C(p):p},k})});function Hi(){if(!xr&&(xr=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!xr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return xr(hh)}var xr,hh,bl=j(()=>{hh=new Uint8Array(16)});var xl,_l=j(()=>{xl=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i});function ph(r){return typeof r=="string"&&xl.test(r)}var kl,Sl=j(()=>{_l();kl=ph});function gh(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(Le[r[e+0]]+Le[r[e+1]]+Le[r[e+2]]+Le[r[e+3]]+"-"+Le[r[e+4]]+Le[r[e+5]]+"-"+Le[r[e+6]]+Le[r[e+7]]+"-"+Le[r[e+8]]+Le[r[e+9]]+"-"+Le[r[e+10]]+Le[r[e+11]]+Le[r[e+12]]+Le[r[e+13]]+Le[r[e+14]]+Le[r[e+15]]).toLowerCase();if(!kl(t))throw TypeError("Stringified UUID is invalid");return t}var Le,_r,El,Cl=j(()=>{Sl();Le=[];for(_r=0;_r<256;++_r)Le.push((_r+256).toString(16).substr(1));El=gh});function mh(r,e,t){r=r||{};var n=r.random||(r.rng||Hi)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(var i=0;i<16;++i)e[t+i]=n[i];return e}return El(n)}var Dn,Tl=j(()=>{bl();Cl();Dn=mh});var Al=j(()=>{Tl()});var Pl=Pi(Ui=>{"use strict";Ui.stringify=function(e){var t=[];t.push({obj:e});for(var n="",i,a,o,s,l,c,u,d,f,m,w;i=t.pop();)if(a=i.obj,o=i.prefix||"",s=i.val||"",n+=o,s)n+=s;else if(typeof a!="object")n+=typeof a=="undefined"?null:JSON.stringify(a);else if(a===null)n+="null";else if(Array.isArray(a)){for(t.push({val:"]"}),l=a.length-1;l>=0;l--)c=l===0?"":",",t.push({obj:a[l],prefix:c});t.push({val:"["})}else{u=[];for(d in a)a.hasOwnProperty(d)&&u.push(d);for(t.push({val:"}"}),l=u.length-1;l>=0;l--)f=u[l],m=a[f],w=l>0?",":"",w+=JSON.stringify(f)+":",t.push({obj:m,prefix:w});t.push({val:"{"})}return n};function sn(r,e,t){var n=t[t.length-1];r===n.element&&(t.pop(),n=t[t.length-1]);var i=n.element,a=n.index;if(Array.isArray(i))i.push(r);else if(a===e.length-2){var o=e.pop();i[o]=r}else e.push(r)}Ui.parse=function(r){for(var e=[],t=[],n=0,i,a,o,s,l,c,u,d,f;;){if(i=r[n++],i==="}"||i==="]"||typeof i=="undefined"){if(e.length===1)return e.pop();sn(e.pop(),e,t);continue}switch(i){case" ":case"	":case`
`:case":":case",":break;case"n":n+=3,sn(null,e,t);break;case"t":n+=3,sn(!0,e,t);break;case"f":n+=4,sn(!1,e,t);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(a="",n--;;)if(o=r[n++],/[\d\.\-e\+]/.test(o))a+=o;else{n--;break}sn(parseFloat(a),e,t);break;case'"':for(s="",l=void 0,c=0;u=r[n++],u!=='"'||l==="\\"&&c%2===1;)s+=u,l=u,l==="\\"?c++:c=0;sn(JSON.parse('"'+s+'"'),e,t);break;case"[":d={element:[],index:e.length},e.push(d.element),t.push(d);break;case"{":f={element:{},index:e.length},e.push(f.element),t.push(f);break;default:throw new Error("unexpectedly reached end of input: "+i)}}}});var ja={};Ct(ja,{default:()=>im});function vh(r){return typeof ArrayBuffer!="undefined"&&r instanceof ArrayBuffer||typeof Blob!="undefined"&&r instanceof Blob}function yh(r){return r instanceof ArrayBuffer?r.slice(0):r.slice(0,r.size,r.type)}function bh(r){var e=Object.getPrototypeOf(r);if(e===null)return!0;var t=e.constructor;return typeof t=="function"&&t instanceof t&&rc.call(t)==wh}function Ie(r){var e,t,n;if(!r||typeof r!="object")return r;if(Array.isArray(r)){for(e=[],t=0,n=r.length;t<n;t++)e[t]=Ie(r[t]);return e}if(r instanceof Date&&isFinite(r))return r.toISOString();if(vh(r))return yh(r);if(!bh(r))return r;e={};for(t in r)if(Object.prototype.hasOwnProperty.call(r,t)){var i=Ie(r[t]);typeof i!="undefined"&&(e[t]=i)}return e}function ic(r){var e=!1;return function(...t){if(e)throw new Error("once called more than once");e=!0,r.apply(this,t)}}function ac(r){return function(...e){e=Ie(e);var t=this,n=typeof e[e.length-1]=="function"?e.pop():!1,i=new Promise(function(a,o){var s;try{var l=ic(function(c,u){c?o(c):a(u)});e.push(l),s=r.apply(t,e),s&&typeof s.then=="function"&&a(s)}catch(c){o(c)}});return n&&i.then(function(a){n(null,a)},n),i}}function xh(r,e,t){if(r.constructor.listeners("debug").length){for(var n=["api",r.name,e],i=0;i<t.length-1;i++)n.push(t[i]);r.constructor.emit("debug",n);var a=t[t.length-1];t[t.length-1]=function(o,s){var l=["api",r.name,e];l=l.concat(o?["error",o]:["success",s]),r.constructor.emit("debug",l),a(o,s)}}}function Ee(r,e){return ac(function(...t){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var n=this;return xh(n,r,t),this.taskqueue.isReady?e.apply(this,t):new Promise(function(i,a){n.taskqueue.addTask(function(o){o?a(o):i(n[r].apply(n,t))})})})}function Fn(r,e){for(var t={},n=0,i=e.length;n<i;n++){var a=e[n];a in r&&(t[a]=r[a])}return t}function $l(r){return r}function kh(r){return[{ok:r}]}function oc(r,e,t){var n=e.docs,i=new Map;n.forEach(function(C){i.has(C.id)?i.get(C.id).push(C):i.set(C.id,[C])});var a=i.size,o=0,s=new Array(a);function l(){var C=[];s.forEach(function(k){k.docs.forEach(function(v){C.push({id:k.id,docs:[v]})})}),t(null,{results:C})}function c(){++o===a&&l()}function u(C,k,v){s[C]={id:k,docs:v},c()}var d=[];i.forEach(function(C,k){d.push(k)});var f=0;function m(){if(!(f>=d.length)){var C=Math.min(f+_h,d.length),k=d.slice(f,C);w(k,f),f+=k.length}}function w(C,k){C.forEach(function(v,g){var h=k+g,p=i.get(v),b=Fn(p[0],["atts_since","attachments"]);b.open_revs=p.map(function(R){return R.rev}),b.open_revs=b.open_revs.filter($l);var S=$l;b.open_revs.length===0&&(delete b.open_revs,S=kh),["revs","attachments","binary","ajax","latest"].forEach(function(R){R in e&&(b[R]=e[R])}),r.get(v,b,function(R,B){var F;R?F=[{error:R}]:F=S(B),u(h,v,F),m()})})}m()}function Ar(){return ia}function it(r){if(typeof console!="undefined"&&typeof console[r]=="function"){var e=Array.prototype.slice.call(arguments,1);console[r].apply(console,e)}}function Sh(r,e){var t=6e5;r=parseInt(r,10)||0,e=parseInt(e,10),e!==e||e<=r?e=(r||1)<<1:e=e+1,e>t&&(r=t>>1,e=t);var n=Math.random(),i=e-r;return~~(i*n+r)}function Eh(r){var e=0;return r||(e=2e3),Sh(r,e)}function oa(r,e){it("info","The above "+r+" is totally normal. "+e)}function ie(r,e){function t(n){for(var i=Object.getOwnPropertyNames(r),a=0,o=i.length;a<o;a++)typeof r[i[a]]!="function"&&(this[i[a]]=r[i[a]]);this.stack===void 0&&(this.stack=new Error().stack),n!==void 0&&(this.reason=n)}return t.prototype=xe.prototype,new t(e)}function fn(r){if(typeof r!="object"){var e=r;r=Ta,r.data=e}return"error"in r&&r.error==="conflict"&&(r.name="conflict",r.status=409),"name"in r||(r.name=r.error||"unknown"),"status"in r||(r.status=500),"message"in r||(r.message=r.message||r.reason),"stack"in r||(r.stack=new Error().stack),r}function Ih(r,e,t){try{return!r(e,t)}catch(i){var n="Filter function threw: "+i.toString();return ie(Rr,n)}}function Pa(r){var e={},t=r.filter&&typeof r.filter=="function";return e.query=r.query_params,function(i){i.doc||(i.doc={});var a=t&&Ih(r.filter,i.doc,e);if(typeof a=="object")return a;if(a)return!1;if(!r.include_docs)delete i.doc;else if(!r.attachments)for(var o in i.doc._attachments)Object.prototype.hasOwnProperty.call(i.doc._attachments,o)&&(i.doc._attachments[o].stub=!0);return!0}}function cc(r){var e;if(r?typeof r!="string"?e=ie(sc):/^_/.test(r)&&!/^_(design|local)/.test(r)&&(e=ie(Ah)):e=ie(Th),e)throw e}function mt(r){return typeof r._remote=="boolean"?r._remote:typeof r.type=="function"?(it("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),r.type()==="http"):!1}function Dh(r,e){return"listenerCount"in r?r.listenerCount(e):vt.default.listenerCount(r,e)}function sa(r){if(!r)return null;var e=r.split("/");return e.length===2?e:e.length===1?[r,r]:null}function Dl(r){var e=sa(r);return e?e.join("/"):null}function uc(r){for(var e=Lh.exec(r),t={},n=14;n--;){var i=Ol[n],a=e[n]||"",o=["user","password"].indexOf(i)!==-1;t[i]=o?decodeURIComponent(a):a}return t[Ll]={},t[Ol[12]].replace(Oh,function(s,l,c){l&&(t[Ll][l]=c)}),t}function $a(r,e){var t=[],n=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t.push(i),n.push(e[i]));return t.push(r),Function.apply(null,t).apply(null,n)}function Pr(r,e,t){return r.get(e).catch(function(n){if(n.status!==404)throw n;return{}}).then(function(n){var i=n._rev,a=t(n);return a?(a._id=e,a._rev=i,Mh(r,a,t)):{updated:!1,rev:i}})}function Mh(r,e,t){return r.put(e).then(function(n){return{updated:!0,rev:n.rev}},function(n){if(n.status!==409)throw n;return Pr(r,e._id,t)})}function Da(r,e){r=r||[],e=e||{};try{return new Blob(r,e)}catch(a){if(a.name!=="TypeError")throw a;for(var t=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,n=new t,i=0;i<r.length;i+=1)n.append(r[i]);return n.getBlob(e.type)}}function Rh(r){for(var e=r.length,t=new ArrayBuffer(e),n=new Uint8Array(t),i=0;i<e;i++)n[i]=r.charCodeAt(i);return t}function Oa(r,e){return Da([Rh(r)],{type:e})}function La(r,e){return Oa(Ia(r),e)}function Fh(r){for(var e="",t=new Uint8Array(r),n=t.byteLength,i=0;i<n;i++)e+=String.fromCharCode(t[i]);return e}function dc(r,e){var t=new FileReader,n=typeof t.readAsBinaryString=="function";t.onloadend=function(i){var a=i.target.result||"";if(n)return e(a);e(Fh(a))},n?t.readAsBinaryString(r):t.readAsArrayBuffer(r)}function fc(r,e){dc(r,function(t){e(t)})}function Ma(r,e){fc(r,function(t){e(Bn(t))})}function Bh(r,e){var t=new FileReader;t.onloadend=function(n){var i=n.target.result||new ArrayBuffer(0);e(i)},t.readAsArrayBuffer(r)}function jh(r){return Bn(r)}function zh(r,e,t,n,i){(t>0||n<e.size)&&(e=e.slice(t,n)),Bh(e,function(a){r.append(a),i()})}function Hh(r,e,t,n,i){(t>0||n<e.length)&&(e=e.substring(t,n)),r.appendBinary(e),i()}function Ra(r,e){var t=typeof r=="string",n=t?r.length:r.size,i=Math.min(Nh,n),a=Math.ceil(n/i),o=0,s=t?new Tr.default:new Tr.default.ArrayBuffer,l=t?Hh:zh;function c(){qh(d)}function u(){var f=s.end(!0),m=jh(f);e(m),s.destroy()}function d(){var f=o*i,m=f+i;o++,o<a?l(s,r,f,m,c):l(s,r,f,m,u)}d()}function hc(r){return Tr.default.hash(r)}function pc(r,e){if(!e)return Dn().replace(/-/g,"").toLowerCase();var t=Object.assign({},r);return delete t._rev_tree,hc(JSON.stringify(t))}function Rt(r){for(var e,t,n,i=r.rev_tree.slice(),a;a=i.pop();){var o=a.ids,s=o[2],l=a.pos;if(s.length){for(var c=0,u=s.length;c<u;c++)i.push({pos:l+1,ids:s[c]});continue}var d=!!o[1].deleted,f=o[0];(!e||(n!==d?n:t!==l?t<l:e<f))&&(e=f,t=l,n=d)}return t+"-"+e}function Ft(r,e){for(var t=r.slice(),n;n=t.pop();)for(var i=n.pos,a=n.ids,o=a[2],s=e(o.length===0,i,a[0],n.ctx,a[1]),l=0,c=o.length;l<c;l++)t.push({pos:i+1,ids:o[l],ctx:s})}function Uh(r,e){return r.pos-e.pos}function Fa(r){var e=[];Ft(r,function(i,a,o,s,l){i&&e.push({rev:a+"-"+o,pos:a,opts:l})}),e.sort(Uh).reverse();for(var t=0,n=e.length;t<n;t++)delete e[t].pos;return e}function Ba(r){for(var e=Rt(r),t=Fa(r.rev_tree),n=[],i=0,a=t.length;i<a;i++){var o=t[i];o.rev!==e&&!o.opts.deleted&&n.push(o.rev)}return n}function Wh(r){var e=[];return Ft(r.rev_tree,function(t,n,i,a,o){o.status==="available"&&!t&&(e.push(n+"-"+i),o.status="missing")}),e}function Vh(r,e){let t=[],n=r.slice(),i;for(;i=n.pop();){let{pos:a,ids:o}=i,s=`${a}-${o[0]}`,l=o[2];if(t.push(s),s===e){if(l.length!==0)throw new Error("The requested revision is not a leaf");return t.reverse()}(l.length===0||l.length>1)&&(t=[]);for(let c=0,u=l.length;c<u;c++)n.push({pos:a+1,ids:l[c]})}if(t.length===0)throw new Error("The requested revision does not exist");return t.reverse()}function gc(r){for(var e=[],t=r.slice(),n;n=t.pop();){var i=n.pos,a=n.ids,o=a[0],s=a[1],l=a[2],c=l.length===0,u=n.history?n.history.slice():[];u.push({id:o,opts:s}),c&&e.push({pos:i+1-u.length,ids:u});for(var d=0,f=l.length;d<f;d++)t.push({pos:i+1,ids:l[d],history:u})}return e.reverse()}function Kh(r,e){return r.pos-e.pos}function Gh(r,e,t){for(var n=0,i=r.length,a;n<i;)a=n+i>>>1,t(r[a],e)<0?n=a+1:i=a;return n}function Jh(r,e,t){var n=Gh(r,e,t);r.splice(n,0,e)}function Ml(r,e){for(var t,n,i=e,a=r.length;i<a;i++){var o=r[i],s=[o.id,o.opts,[]];n?(n[2].push(s),n=s):t=n=s}return t}function Qh(r,e){return r[0]<e[0]?-1:1}function Rl(r,e){for(var t=[{tree1:r,tree2:e}],n=!1;t.length>0;){var i=t.pop(),a=i.tree1,o=i.tree2;(a[1].status||o[1].status)&&(a[1].status=a[1].status==="available"||o[1].status==="available"?"available":"missing");for(var s=0;s<o[2].length;s++){if(!a[2][0]){n="new_leaf",a[2][0]=o[2][s];continue}for(var l=!1,c=0;c<a[2].length;c++)a[2][c][0]===o[2][s][0]&&(t.push({tree1:a[2][c],tree2:o[2][s]}),l=!0);l||(n="new_branch",Jh(a[2],o[2][s],Qh))}}return{conflicts:n,tree:r}}function mc(r,e,t){var n=[],i=!1,a=!1,o;if(!r.length)return{tree:[e],conflicts:"new_leaf"};for(var s=0,l=r.length;s<l;s++){var c=r[s];if(c.pos===e.pos&&c.ids[0]===e.ids[0])o=Rl(c.ids,e.ids),n.push({pos:c.pos,ids:o.tree}),i=i||o.conflicts,a=!0;else if(t!==!0){var u=c.pos<e.pos?c:e,d=c.pos<e.pos?e:c,f=d.pos-u.pos,m=[],w=[];for(w.push({ids:u.ids,diff:f,parent:null,parentIdx:null});w.length>0;){var C=w.pop();if(C.diff===0){C.ids[0]===d.ids[0]&&m.push(C);continue}for(var k=C.ids[2],v=0,g=k.length;v<g;v++)w.push({ids:k[v],diff:C.diff-1,parent:C.ids,parentIdx:v})}var h=m[0];h?(o=Rl(h.ids,d.ids),h.parent[2][h.parentIdx]=o.tree,n.push({pos:u.pos,ids:u.ids}),i=i||o.conflicts,a=!0):n.push(c)}else n.push(c)}return a||n.push(e),n.sort(Kh),{tree:n,conflicts:i||"internal_node"}}function Zh(r,e){for(var t=gc(r),n,i,a=0,o=t.length;a<o;a++){var s=t[a],l=s.ids,c;if(l.length>e){n||(n={});var u=l.length-e;c={pos:s.pos+u,ids:Ml(l,u)};for(var d=0;d<u;d++){var f=s.pos+d+"-"+l[d].id;n[f]=!0}}else c={pos:s.pos,ids:Ml(l,0)};i?i=mc(i,c,!0).tree:i=[c]}return n&&Ft(i,function(m,w,C){delete n[w+"-"+C]}),{tree:i,revs:n?Object.keys(n):[]}}function vc(r,e,t){var n=mc(r,e),i=Zh(n.tree,t);return{tree:i.tree,stemmedRevs:i.revs,conflicts:n.conflicts}}function Yh(r,e){for(var t=r.slice(),n=e.split("-"),i=parseInt(n[0],10),a=n[1],o;o=t.pop();){if(o.pos===i&&o.ids[0]===a)return!0;for(var s=o.ids[2],l=0,c=s.length;l<c;l++)t.push({pos:o.pos+1,ids:s[l]})}return!1}function Xh(r){return r.ids}function _t(r,e){e||(e=Rt(r));for(var t=e.substring(e.indexOf("-")+1),n=r.rev_tree.map(Xh),i;i=n.pop();){if(i[0]===t)return!!i[1].deleted;n=n.concat(i[2])}}function Mt(r){return typeof r=="string"&&r.startsWith("_local/")}function ep(r,e){for(var t=e.rev_tree.slice(),n;n=t.pop();){var i=n.pos,a=n.ids,o=a[0],s=a[1],l=a[2],c=l.length===0,u=n.history?n.history.slice():[];if(u.push({id:o,pos:i,opts:s}),c)for(var d=0,f=u.length;d<f;d++){var m=u[d],w=m.pos+"-"+m.id;if(w===r)return i+"-"+o}for(var C=0,k=l.length;C<k;C++)t.push({pos:i+1,ids:l[C],history:u})}throw new Error("Unable to resolve latest revision for id "+e.id+", rev "+r)}function tp(r,e,t,n){try{r.emit("change",e,t,n)}catch(i){it("error",'Error in .on("change", function):',i)}}function np(r,e,t){var n=[{rev:r._rev}];t.style==="all_docs"&&(n=Fa(e.rev_tree).map(function(a){return{rev:a.rev}}));var i={id:e.id,changes:n,doc:r};return _t(e,r._rev)&&(i.deleted=!0),t.conflicts&&(i.doc._conflicts=Ba(e),i.doc._conflicts.length||delete i.doc._conflicts),i}function Vi(r,e){return function(t,n){t||n[0]&&n[0].error?(t=t||n[0],t.docId=e,r(t)):r(null,n.length?n[0]:n)}}function rp(r){for(var e=0;e<r.length;e++){var t=r[e];if(t._deleted)delete t._attachments;else if(t._attachments)for(var n=Object.keys(t._attachments),i=0;i<n.length;i++){var a=n[i];t._attachments[a]=Fn(t._attachments[a],["data","digest","content_type","length","revpos","stub"])}}}function ip(r,e){if(r._id===e._id){let t=r._revisions?r._revisions.start:0,n=e._revisions?e._revisions.start:0;return t-n}return r._id<e._id?-1:1}function ap(r){var e={},t=[];return Ft(r,function(n,i,a,o){var s=i+"-"+a;return n&&(e[s]=0),o!==void 0&&t.push({from:o,to:s}),s}),t.reverse(),t.forEach(function(n){e[n.from]===void 0?e[n.from]=1+e[n.to]:e[n.from]=Math.min(e[n.from],1+e[n.to])}),e}function op(r){var e="limit"in r?r.keys.slice(r.skip,r.limit+r.skip):r.skip>0?r.keys.slice(r.skip):r.keys;r.keys=e,r.skip=0,delete r.limit,r.descending&&(e.reverse(),r.descending=!1)}function yc(r){var e=r._compactionQueue[0],t=e.opts,n=e.callback;r.get("_local/compaction").catch(function(){return!1}).then(function(i){i&&i.last_seq&&(t.last_seq=i.last_seq),r._compact(t,function(a,o){a?n(a):n(null,o),yt(function(){r._compactionQueue.shift(),r._compactionQueue.length&&yc(r)})})})}function sp(r,e,t){return r.get("_local/purges").then(function(n){let i=n.purgeSeq+1;return n.purges.push({docId:e,rev:t,purgeSeq:i}),n.purges.length>self.purged_infos_limit&&n.purges.splice(0,n.purges.length-self.purged_infos_limit),n.purgeSeq=i,n}).catch(function(n){if(n.status!==404)throw n;return{_id:"_local/purges",purges:[{docId:e,rev:t,purgeSeq:0}],purgeSeq:0}}).then(function(n){return r.put(n)})}function lp(r){return r.charAt(0)==="_"?r+" is not a valid attachment name, attachment names cannot start with '_'":!1}function Ki(r){return r===null||typeof r!="object"||Array.isArray(r)}function Gi(r){return typeof r=="string"&&cp.test(r)}function up(r,e){var t=r.match(/([a-z-]*):\/\/(.*)/);if(t)return{name:/https?/.test(t[1])?t[1]+"://"+t[2]:t[2],adapter:t[1]};var n=oe.adapters,i=oe.preferredAdapters,a=oe.prefix,o=e.adapter;if(!o)for(var s=0;s<i.length;++s){if(o=i[s],o==="idb"&&"websql"in n&&Ar()&&localStorage["_pouch__websqldb_"+a+r]){it("log",'PouchDB is downgrading "'+r+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}var l=n[o],c=l&&"use_prefix"in l?l.use_prefix:!0;return{name:c?a+r:r,adapter:o}}function dp(r,e){r.prototype=Object.create(e.prototype,{constructor:{value:r}})}function wc(r,e){let t=function(...n){if(!(this instanceof t))return new t(...n);e.apply(this,n)};return dp(t,r),t}function fp(r){function e(n){r.removeListener("closed",t),n||r.constructor.emit("destroyed",r.name)}function t(){r.removeListener("destroyed",e),r.constructor.emit("unref",r)}r.once("destroyed",e),r.once("closed",t),r.constructor.emit("ref",r)}function hp(r){Object.keys(vt.default.prototype).forEach(function(t){typeof vt.default.prototype[t]=="function"&&(r[t]=Fl[t].bind(Fl))});var e=r._destructionListeners=new Map;r.on("ref",function(n){e.has(n.name)||e.set(n.name,[]),e.get(n.name).push(n)}),r.on("unref",function(n){if(e.has(n.name)){var i=e.get(n.name),a=i.indexOf(n);a<0||(i.splice(a,1),i.length>1?e.set(n.name,i):e.delete(n.name))}}),r.on("destroyed",function(n){if(e.has(n)){var i=e.get(n);e.delete(n),i.forEach(function(a){a.emit("destroyed",!0)})}})}function qa(r,e){for(var t=r,n=0,i=e.length;n<i;n++){var a=e[n];if(t=t[a],!t)break}return t}function gp(r,e){return r<e?-1:r>e?1:0}function Na(r){for(var e=[],t="",n=0,i=r.length;n<i;n++){var a=r[n];n>0&&r[n-1]==="\\"&&(a==="$"||a===".")?t=t.substring(0,t.length-1)+a:a==="."?(e.push(t),t=""):t+=a}return e.push(t),e}function xc(r){return mp.indexOf(r)>-1}function _c(r){return Object.keys(r)[0]}function vp(r){return r[_c(r)]}function Mn(r){var e={},t={$or:!0,$nor:!0};return r.forEach(function(n){Object.keys(n).forEach(function(i){var a=n[i];if(typeof a!="object"&&(a={$eq:a}),xc(i))if(a instanceof Array){if(t[i]){t[i]=!1,e[i]=a;return}var o=[];e[i].forEach(function(l){Object.keys(a).forEach(function(c){var u=a[c],d=Math.max(Object.keys(l).length,Object.keys(u).length),f=Mn([l,u]);Object.keys(f).length<=d||o.push(f)})}),e[i]=o}else e[i]=Mn([a]);else{var s=e[i]=e[i]||{};Object.keys(a).forEach(function(l){var c=a[l];if(l==="$gt"||l==="$gte")return yp(l,c,s);if(l==="$lt"||l==="$lte")return wp(l,c,s);if(l==="$ne")return bp(c,s);if(l==="$eq")return xp(c,s);if(l==="$regex")return _p(c,s);s[l]=c})}})}),e}function yp(r,e,t){typeof t.$eq=="undefined"&&(typeof t.$gte!="undefined"?r==="$gte"?e>t.$gte&&(t.$gte=e):e>=t.$gte&&(delete t.$gte,t.$gt=e):typeof t.$gt!="undefined"?r==="$gte"?e>t.$gt&&(delete t.$gt,t.$gte=e):e>t.$gt&&(t.$gt=e):t[r]=e)}function wp(r,e,t){typeof t.$eq=="undefined"&&(typeof t.$lte!="undefined"?r==="$lte"?e<t.$lte&&(t.$lte=e):e<=t.$lte&&(delete t.$lte,t.$lt=e):typeof t.$lt!="undefined"?r==="$lte"?e<t.$lt&&(delete t.$lt,t.$lte=e):e<t.$lt&&(t.$lt=e):t[r]=e)}function bp(r,e){"$ne"in e?e.$ne.push(r):e.$ne=[r]}function xp(r,e){delete e.$gt,delete e.$gte,delete e.$lt,delete e.$lte,delete e.$ne,e.$eq=r}function _p(r,e){"$regex"in e?e.$regex.push(r):e.$regex=[r]}function kc(r){for(var e in r){if(Array.isArray(r))for(var t in r)r[t].$and&&(r[t]=Mn(r[t].$and));var n=r[e];typeof n=="object"&&kc(n)}return r}function Sc(r,e){for(var t in r){t==="$and"&&(e=!0);var n=r[t];typeof n=="object"&&(e=Sc(n,e))}return e}function kp(r){var e=Ie(r);Sc(e,!1)&&(e=kc(e),"$and"in e&&(e=Mn(e.$and))),["$or","$nor"].forEach(function(o){o in e&&e[o].forEach(function(s){for(var l=Object.keys(s),c=0;c<l.length;c++){var u=l[c],d=s[u];(typeof d!="object"||d===null)&&(s[u]={$eq:d})}})}),"$not"in e&&(e.$not=Mn([e.$not]));for(var t=Object.keys(e),n=0;n<t.length;n++){var i=t[n],a=e[i];(typeof a!="object"||a===null)&&(a={$eq:a}),e[i]=a}return da(e),e}function da(r){Object.keys(r).forEach(function(e){var t=r[e];Array.isArray(t)?t.forEach(function(n){n&&typeof n=="object"&&da(n)}):e==="$ne"?r.$ne=[t]:e==="$regex"?r.$regex=[t]:t&&typeof t=="object"&&da(t)})}function Sp(r,e,t){for(var n="",i=t-r.length;n.length<i;)n+=e;return n}function Ep(r,e,t){var n=Sp(r,e,t);return n+r}function Ce(r,e){if(r===e)return 0;r=Bt(r),e=Bt(e);var t=pa(r),n=pa(e);if(t-n!==0)return t-n;switch(typeof r){case"number":return r-e;case"boolean":return r<e?-1:1;case"string":return Ip(r,e)}return Array.isArray(r)?$p(r,e):Dp(r,e)}function Bt(r){switch(typeof r){case"undefined":return null;case"number":return r===1/0||r===-1/0||isNaN(r)?null:r;case"object":var e=r;if(Array.isArray(r)){var t=r.length;r=new Array(t);for(var n=0;n<t;n++)r[n]=Bt(e[n])}else{if(r instanceof Date)return r.toJSON();if(r!==null){r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=e[i];typeof a!="undefined"&&(r[i]=Bt(a))}}}}return r}function Cp(r){if(r!==null)switch(typeof r){case"boolean":return r?1:0;case"number":return Op(r);case"string":return r.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var e=Array.isArray(r),t=e?r:Object.keys(r),n=-1,i=t.length,a="";if(e)for(;++n<i;)a+=ut(t[n]);else for(;++n<i;){var o=t[n];a+=ut(o)+ut(r[o])}return a}return""}function ut(r){var e="\0";return r=Bt(r),pa(r)+ha+Cp(r)+e}function Tp(r,e){var t=e,n,i=r[e]==="1";if(i)n=0,e++;else{var a=r[e]==="0";e++;var o="",s=r.substring(e,e+fa),l=parseInt(s,10)+Ec;for(a&&(l=-l),e+=fa;;){var c=r[e];if(c==="\0")break;o+=c,e++}o=o.split("."),o.length===1?n=parseInt(o,10):n=parseFloat(o[0]+"."+o[1]),a&&(n=n-10),l!==0&&(n=parseFloat(n+"e"+l))}return{num:n,length:e-t}}function Ap(r,e){var t=r.pop();if(e.length){var n=e[e.length-1];t===n.element&&(e.pop(),n=e[e.length-1]);var i=n.element,a=n.index;if(Array.isArray(i))i.push(t);else if(a===r.length-2){var o=r.pop();i[o]=t}else r.push(t)}}function Pp(r){for(var e=[],t=[],n=0;;){var i=r[n++];if(i==="\0"){if(e.length===1)return e.pop();Ap(e,t);continue}switch(i){case"1":e.push(null);break;case"2":e.push(r[n]==="1"),n++;break;case"3":var a=Tp(r,n);e.push(a.num),n+=a.length;break;case"4":for(var o="";;){var s=r[n];if(s==="\0")break;o+=s,n++}o=o.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),e.push(o);break;case"5":var l={element:[],index:e.length};e.push(l.element),t.push(l);break;case"6":var c={element:{},index:e.length};e.push(c.element),t.push(c);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+i)}}}function $p(r,e){for(var t=Math.min(r.length,e.length),n=0;n<t;n++){var i=Ce(r[n],e[n]);if(i!==0)return i}return r.length===e.length?0:r.length>e.length?1:-1}function Ip(r,e){return r===e?0:r>e?1:-1}function Dp(r,e){for(var t=Object.keys(r),n=Object.keys(e),i=Math.min(t.length,n.length),a=0;a<i;a++){var o=Ce(t[a],n[a]);if(o!==0||(o=Ce(r[t[a]],e[n[a]]),o!==0))return o}return t.length===n.length?0:t.length>n.length?1:-1}function pa(r){var e=["boolean","number","string","object"],t=e.indexOf(typeof r);if(~t)return r===null?1:Array.isArray(r)?5:t<3?t+2:t+3;if(Array.isArray(r))return 5}function Op(r){if(r===0)return"1";var e=r.toExponential().split(/e\+?/),t=parseInt(e[1],10),n=r<0,i=n?"0":"2",a=(n?-t:t)-Ec,o=Ep(a.toString(),"0",fa);i+=ha+o;var s=Math.abs(parseFloat(e[0]));n&&(s=10-s);var l=s.toFixed(20);return l=l.replace(/\.?0+$/,""),i+=ha+l,i}function Lp(r){function e(t){return r.map(function(n){var i=_c(n),a=Na(i),o=qa(t,a);return o})}return function(t,n){var i=e(t.doc),a=e(n.doc),o=Ce(i,a);return o!==0?o:gp(t.doc._id,n.doc._id)}}function Mp(r,e,t){if(r=r.filter(function(o){return un(o.doc,e.selector,t)}),e.sort){var n=Lp(e.sort);r=r.sort(n),typeof e.sort[0]!="string"&&vp(e.sort[0])==="desc"&&(r=r.reverse())}if("limit"in e||"skip"in e){var i=e.skip||0,a=("limit"in e?e.limit:r.length)+i;r=r.slice(i,a)}return r}function un(r,e,t){return t.every(function(n){var i=e[n],a=Na(n),o=qa(r,a);return xc(n)?Rp(n,i,r):Dr(i,r,a,o)})}function Dr(r,e,t,n){return r?typeof r=="object"?Object.keys(r).every(function(i){var a=r[i];if(i.indexOf("$")===0)return Bl(i,e,a,t,n);var o=Na(i);if(n===void 0&&typeof a!="object"&&o.length>0)return!1;var s=qa(n,o);return typeof a=="object"?Dr(a,e,t,s):Bl("$eq",e,a,o,s)}):r===n:!0}function Rp(r,e,t){return r==="$or"?e.some(function(n){return un(t,n,Object.keys(n))}):r==="$not"?!un(t,e,Object.keys(e)):!e.find(function(n){return un(t,n,Object.keys(n))})}function Bl(r,e,t,n,i){if(!Nl[r])throw new Error('unknown operator "'+r+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return Nl[r](e,t,n,i)}function On(r){return typeof r!="undefined"&&r!==null}function It(r){return typeof r!="undefined"}function Fp(r,e){if(typeof r!="number"||parseInt(r,10)!==r)return!1;var t=e[0],n=e[1];return r%t===n}function ql(r,e){return e.some(function(t){return r instanceof Array?r.some(function(n){return Ce(t,n)===0}):Ce(t,r)===0})}function Bp(r,e){return e.every(function(t){return r.some(function(n){return Ce(t,n)===0})})}function qp(r,e){return r.length===e}function Np(r,e){var t=new RegExp(e);return t.test(r)}function jp(r,e){switch(e){case"null":return r===null;case"boolean":return typeof r=="boolean";case"number":return typeof r=="number";case"string":return typeof r=="string";case"array":return r instanceof Array;case"object":return{}.toString.call(r)==="[object Object]"}}function zp(r,e){if(typeof e!="object")throw new Error("Selector error: expected a JSON object");e=kp(e);var t={doc:r},n=Mp([t],{selector:e},Object.keys(e));return n&&n.length===1}function Hp(r){return $a(`"use strict";
return `+r+";",{})}function Up(r){var e=["return function(doc) {",'  "use strict";',"  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+r+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join(`
`);return $a(e,{})}function Wp(r,e){if(r.selector&&r.filter&&r.filter!=="_selector"){var t=typeof r.filter=="string"?r.filter:"function";return e(new Error('selector invalid for filter "'+t+'"'))}e()}function Vp(r){r.view&&!r.filter&&(r.filter="_view"),r.selector&&!r.filter&&(r.filter="_selector"),r.filter&&typeof r.filter=="string"&&(r.filter==="_view"?r.view=Dl(r.view):r.filter=Dl(r.filter))}function Kp(r,e){return e.filter&&typeof e.filter=="string"&&!e.doc_ids&&!mt(r.db)}function Gp(r,e){var t=e.complete;if(e.filter==="_view"){if(!e.view||typeof e.view!="string"){var n=ie(Rr,"`view` filter parameter not found or invalid.");return t(n)}var i=sa(e.view);r.db.get("_design/"+i[0],function(o,s){if(r.isCancelled)return t(null,{status:"cancelled"});if(o)return t(fn(o));var l=s&&s.views&&s.views[i[1]]&&s.views[i[1]].map;if(!l)return t(ie(nt,s.views?"missing json key: "+i[1]:"missing json key: views"));e.filter=Up(l),r.doChanges(e)})}else if(e.selector)e.filter=function(o){return zp(o,e.selector)},r.doChanges(e);else{var a=sa(e.filter);r.db.get("_design/"+a[0],function(o,s){if(r.isCancelled)return t(null,{status:"cancelled"});if(o)return t(fn(o));var l=s&&s.filters&&s.filters[a[1]];if(!l)return t(ie(nt,s&&s.filters?"missing json key: "+a[1]:"missing json key: filters"));e.filter=Hp(l),r.doChanges(e)})}}function Jp(r){r._changesFilterPlugin={validate:Wp,normalize:Vp,shouldFilter:Kp,filter:Gp}}function Qp(r,e,t){return new Promise(function(n){var i=Da([""]);let a;if(typeof t=="function"){let s=t(i);a=r.objectStore(e).put(s)}else{let o=t;a=r.objectStore(e).put(i,o)}a.onsuccess=function(){var o=navigator.userAgent.match(/Chrome\/(\d+)/),s=navigator.userAgent.match(/Edge\//);n(s||!o||parseInt(o[1],10)>=43)},a.onerror=r.onabort=function(o){o.preventDefault(),o.stopPropagation(),n(!1)}}).catch(function(){return!1})}function Cc(r){return r.reduce(function(e,t){return e[t]=!0,e},{})}function jl(r){if(!/^\d+-/.test(r))return ie(Er);var e=r.indexOf("-"),t=r.substring(0,e),n=r.substring(e+1);return{prefix:parseInt(t,10),id:n}}function Xp(r,e){for(var t=r.start-r.ids.length+1,n=r.ids,i=[n[0],e,[]],a=1,o=n.length;a<o;a++)i=[n[a],{status:"missing"},[i]];return[{pos:t,ids:i}]}function Tc(r,e,t){t||(t={deterministic_revs:!0});var n,i,a,o={status:"available"};if(r._deleted&&(o.deleted=!0),e)if(r._id||(r._id=Fr()),i=pc(r,t.deterministic_revs),r._rev){if(a=jl(r._rev),a.error)return a;r._rev_tree=[{pos:a.prefix,ids:[a.id,{status:"missing"},[[i,o,[]]]]}],n=a.prefix+1}else r._rev_tree=[{pos:1,ids:[i,o,[]]}],n=1;else if(r._revisions&&(r._rev_tree=Xp(r._revisions,o),n=r._revisions.start,i=r._revisions.ids[0]),!r._rev_tree){if(a=jl(r._rev),a.error)return a;n=a.prefix,i=a.id,r._rev_tree=[{pos:n,ids:[i,o,[]]}]}cc(r._id),r._rev=n+"-"+i;var s={metadata:{},data:{}};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){var c=l[0]==="_";if(c&&!Zp[l]){var u=ie(Il,l);throw u.message=Il.message+": "+l,u}else c&&!Yp[l]?s.metadata[l.slice(1)]=r[l]:s.data[l]=r[l]}return s}function eg(r){try{return Ia(r)}catch(t){var e=ie(lc,"Attachment is not a valid base64 string");return{error:e}}}function tg(r,e,t){var n=eg(r.data);if(n.error)return t(n.error);r.length=n.length,e==="blob"?r.data=Oa(n,r.content_type):e==="base64"?r.data=Bn(n):r.data=n,Ra(n,function(i){r.digest="md5-"+i,t()})}function ng(r,e,t){Ra(r.data,function(n){r.digest="md5-"+n,r.length=r.data.size||r.data.length||0,e==="binary"?fc(r.data,function(i){r.data=i,t()}):e==="base64"?Ma(r.data,function(i){r.data=i,t()}):t()})}function rg(r,e,t){if(r.stub)return t();typeof r.data=="string"?tg(r,e,t):ng(r,e,t)}function ig(r,e,t){if(!r.length)return t();var n=0,i;r.forEach(function(o){var s=o.data&&o.data._attachments?Object.keys(o.data._attachments):[],l=0;if(!s.length)return a();function c(d){i=d,l++,l===s.length&&a()}for(var u in o.data._attachments)Object.prototype.hasOwnProperty.call(o.data._attachments,u)&&rg(o.data._attachments[u],e,c)});function a(){n++,r.length===n&&(i?t(i):t())}}function ag(r,e,t,n,i,a,o,s){if(Yh(e.rev_tree,t.metadata.rev)&&!s)return n[i]=t,a();var l=e.winningRev||Rt(e),c="deleted"in e?e.deleted:_t(e,l),u="deleted"in t.metadata?t.metadata.deleted:_t(t.metadata),d=/^1-/.test(t.metadata.rev);if(c&&!u&&s&&d){var f=t.data;f._rev=l,f._id=t.metadata.id,t=Tc(f,s)}var m=vc(e.rev_tree,t.metadata.rev_tree[0],r),w=s&&(c&&u&&m.conflicts!=="new_leaf"||!c&&m.conflicts!=="new_leaf"||c&&!u&&m.conflicts==="new_branch");if(w){var C=ie(dn);return n[i]=C,a()}var k=t.metadata.rev;t.metadata.rev_tree=m.tree,t.stemmedRevs=m.stemmedRevs||[],e.rev_map&&(t.metadata.rev_map=e.rev_map);var v=Rt(t.metadata),g=_t(t.metadata,v),h=c===g?0:c<g?-1:1,p;k===v?p=g:p=_t(t.metadata,k),o(t,v,g,p,!0,h,i,a)}function og(r){return r.metadata.rev_tree[0].ids[1].status==="missing"}function sg(r,e,t,n,i,a,o,s,l){r=r||1e3;function c(C,k,v){var g=Rt(C.metadata),h=_t(C.metadata,g);if("was_delete"in s&&h)return a[k]=ie(nt,"deleted"),v();var p=u&&og(C);if(p){var b=ie(dn);return a[k]=b,v()}var S=h?0:1;o(C,g,h,h,!1,S,k,v)}var u=s.new_edits,d=new Map,f=0,m=e.length;function w(){++f===m&&l&&l()}e.forEach(function(C,k){if(C._id&&Mt(C._id)){var v=C._deleted?"_removeLocal":"_putLocal";t[v](C,{ctx:i},function(h,p){a[k]=h||p,w()});return}var g=C.metadata.id;d.has(g)?(m--,d.get(g).push([C,k])):d.set(g,[[C,k]])}),d.forEach(function(C,k){var v=0;function g(){++v<C.length?h():w()}function h(){var p=C[v],b=p[0],S=p[1];if(n.has(k))ag(r,n.get(k),b,a,S,g,o,u);else{var R=vc([],b.metadata.rev_tree[0],r);b.metadata.rev_tree=R.tree,b.stemmedRevs=R.stemmedRevs||[],c(b,S,g)}}h()})}function cg(r){try{return JSON.parse(r)}catch(e){return Ca.default.parse(r)}}function ug(r){try{return JSON.stringify(r)}catch(e){return Ca.default.stringify(r)}}function gt(r){return function(e){var t="unknown_error";e.target&&e.target.error&&(t=e.target.error.name||e.target.error.message),r(ie(Aa,t,e.type))}}function ga(r,e,t){return{data:ug(r),winningRev:e,deletedOrLocal:t?"1":"0",seq:r.seq,id:r.id}}function Lt(r){if(!r)return null;var e=cg(r.data);return e.winningRev=r.winningRev,e.deleted=r.deletedOrLocal==="1",e.seq=r.seq,e}function Or(r){if(!r)return r;var e=r._doc_id_rev.lastIndexOf(":");return r._id=r._doc_id_rev.substring(0,e-1),r._rev=r._doc_id_rev.substring(e+1),delete r._doc_id_rev,r}function Ac(r,e,t,n){t?n(r?typeof r!="string"?r:La(r,e):Da([""],{type:e})):r?typeof r!="string"?dc(r,function(i){n(Bn(i))}):n(r):n("")}function Pc(r,e,t,n){var i=Object.keys(r._attachments||{});if(!i.length)return n&&n();var a=0;function o(){++a===i.length&&n&&n()}function s(l,c){var u=l._attachments[c],d=u.digest,f=t.objectStore(rt).get(d);f.onsuccess=function(m){u.body=m.target.result.body,o()}}i.forEach(function(l){e.attachments&&e.include_docs?s(r,l):(r._attachments[l].stub=!0,o())})}function ma(r,e){return Promise.all(r.map(function(t){if(t.doc&&t.doc._attachments){var n=Object.keys(t.doc._attachments);return Promise.all(n.map(function(i){var a=t.doc._attachments[i];if("body"in a){var o=a.body,s=a.content_type;return new Promise(function(l){Ac(o,s,e,function(c){t.doc._attachments[i]=Object.assign(Fn(a,["digest","content_type"]),{data:c}),l()})})}}))}}))}function $c(r,e,t){var n=[],i=t.objectStore(Me),a=t.objectStore(rt),o=t.objectStore(Ot),s=r.length;function l(){s--,s||c()}function c(){n.length&&n.forEach(function(u){var d=o.index("digestSeq").count(IDBKeyRange.bound(u+"::",u+"::\uFFFF",!1,!1));d.onsuccess=function(f){var m=f.target.result;m||a.delete(u)}})}r.forEach(function(u){var d=i.index("_doc_id_rev"),f=e+"::"+u;d.getKey(f).onsuccess=function(m){var w=m.target.result;if(typeof w!="number")return l();i.delete(w);var C=o.index("seq").openCursor(IDBKeyRange.only(w));C.onsuccess=function(k){var v=k.target.result;if(v){var g=v.value.digestSeq.split("::")[0];n.push(g),o.delete(v.primaryKey),v.continue()}else l()}}})}function dt(r,e,t){try{return{txn:r.transaction(e,t)}}catch(n){return{error:n}}}function dg(r,e,t,n,i,a){for(var o=e.docs,s,l,c,u,d,f,m,w,C=0,k=o.length;C<k;C++){var v=o[C];v._id&&Mt(v._id)||(v=o[C]=Tc(v,t.new_edits,r),v.error&&!m&&(m=v))}if(m)return a(m);var g=!1,h=0,p=new Array(o.length),b=new Map,S=!1,R=n._meta.blobSupport?"blob":"base64";ig(o,R,function(E){if(E)return a(E);B()});function B(){var E=[Te,Me,rt,pt,Ot,qe],A=dt(i,E,"readwrite");if(A.error)return a(A.error);s=A.txn,s.onabort=gt(a),s.ontimeout=gt(a),s.oncomplete=Q,l=s.objectStore(Te),c=s.objectStore(Me),u=s.objectStore(rt),d=s.objectStore(Ot),f=s.objectStore(qe),f.get(qe).onsuccess=function(L){w=L.target.result,W()},Z(function(L){if(L)return S=!0,a(L);Y()})}function F(){g=!0,W()}function K(){sg(r.revs_limit,o,n,b,s,p,te,t,F)}function W(){!w||!g||(w.docCount+=h,f.put(w))}function Y(){if(!o.length)return;var E=0;function A(){++E===o.length&&K()}function L(O){var D=Lt(O.target.result);D&&b.set(D.id,D),A()}for(var q=0,I=o.length;q<I;q++){var T=o[q];if(T._id&&Mt(T._id)){A();continue}var P=l.get(T.metadata.id);P.onsuccess=L}}function Q(){S||(Ln.notify(n._meta.name),a(null,p))}function G(E,A){var L=u.get(E);L.onsuccess=function(q){if(q.target.result)A();else{var I=ie($h,"unknown stub attachment with digest "+E);I.status=412,A(I)}}}function Z(E){var A=[];if(o.forEach(function(T){T.data&&T.data._attachments&&Object.keys(T.data._attachments).forEach(function(P){var O=T.data._attachments[P];O.stub&&A.push(O.digest)})}),!A.length)return E();var L=0,q;function I(){++L===A.length&&E(q)}A.forEach(function(T){G(T,function(P){P&&!q&&(q=P),I()})})}function te(E,A,L,q,I,T,P,O){E.metadata.winningRev=A,E.metadata.deleted=L;var D=E.data;D._id=E.metadata.id,D._rev=E.metadata.rev,q&&(D._deleted=!0);var M=D._attachments&&Object.keys(D._attachments).length;if(M)return y(E,A,L,I,P,O);h+=T,W(),se(E,A,L,I,P,O)}function se(E,A,L,q,I,T){var P=E.data,O=E.metadata;P._doc_id_rev=O.id+"::"+O.rev,delete P._id,delete P._rev;function D(ee){var le=E.stemmedRevs||[];q&&n.auto_compaction&&(le=le.concat(Wh(E.metadata))),le&&le.length&&$c(le,E.metadata.id,s),O.seq=ee.target.result;var ce=ga(O,A,L),V=l.put(ce);V.onsuccess=J}function M(ee){ee.preventDefault(),ee.stopPropagation();var le=c.index("_doc_id_rev"),ce=le.getKey(P._doc_id_rev);ce.onsuccess=function(V){var z=c.put(P,V.target.result);z.onsuccess=D}}function J(){p[I]={ok:!0,id:O.id,rev:O.rev},b.set(E.metadata.id,E.metadata),x(E,O.seq,T)}var U=c.put(P);U.onsuccess=D,U.onerror=M}function y(E,A,L,q,I,T){var P=E.data,O=0,D=Object.keys(P._attachments);function M(){O===D.length&&se(E,A,L,q,I,T)}function J(){O++,M()}D.forEach(function(U){var ee=E.data._attachments[U];if(ee.stub)O++,M();else{var le=ee.data;delete ee.data,ee.revpos=parseInt(A,10);var ce=ee.digest;_(ce,le,J)}})}function x(E,A,L){var q=0,I=Object.keys(E.data._attachments||{});if(!I.length)return L();function T(){++q===I.length&&L()}function P(D){var M=E.data._attachments[D].digest,J=d.put({seq:A,digestSeq:M+"::"+A});J.onsuccess=T,J.onerror=function(U){U.preventDefault(),U.stopPropagation(),T()}}for(var O=0;O<I.length;O++)P(I[O])}function _(E,A,L){var q=u.count(E);q.onsuccess=function(I){var T=I.target.result;if(T)return L();var P={digest:E,body:A},O=u.put(P);O.onsuccess=L}}}function Ic(r,e,t,n,i){n===-1&&(n=1e3);var a=typeof r.getAll=="function"&&typeof r.getAllKeys=="function"&&n>1&&!t,o,s,l;function c(m){s=m.target.result,o&&i(o,s,l)}function u(m){o=m.target.result,s&&i(o,s,l)}function d(){if(!o.length)return i();var m=o[o.length-1],w;if(e&&e.upper)try{w=IDBKeyRange.bound(m,e.upper,!0,e.upperOpen)}catch(C){if(C.name==="DataError"&&C.code===0)return i()}else w=IDBKeyRange.lowerBound(m,!0);e=w,o=null,s=null,r.getAll(e,n).onsuccess=c,r.getAllKeys(e,n).onsuccess=u}function f(m){var w=m.target.result;if(!w)return i();i([w.key],[w.value],w)}a?(l={continue:d},r.getAll(e,n).onsuccess=c,r.getAllKeys(e,n).onsuccess=u):t?r.openCursor(e,"prev").onsuccess=f:r.openCursor(e).onsuccess=f}function fg(r,e,t){if(typeof r.getAll=="function"){r.getAll(e).onsuccess=t;return}var n=[];function i(a){var o=a.target.result;o?(n.push(o.value),o.continue()):t({target:{result:n}})}r.openCursor(e).onsuccess=i}function hg(r,e,t){var n=new Array(r.length),i=0;r.forEach(function(a,o){e.get(a).onsuccess=function(s){s.target.result?n[o]=s.target.result:n[o]={key:a,error:"not_found"},i++,i===r.length&&t(r,n,{})}})}function pg(r,e,t,n,i){try{if(r&&e)return i?IDBKeyRange.bound(e,r,!t,!1):IDBKeyRange.bound(r,e,!1,!t);if(r)return i?IDBKeyRange.upperBound(r):IDBKeyRange.lowerBound(r);if(e)return i?IDBKeyRange.lowerBound(e,!t):IDBKeyRange.upperBound(e,!t);if(n)return IDBKeyRange.only(n)}catch(a){return{error:a}}return null}function gg(r,e,t){var n="startkey"in r?r.startkey:!1,i="endkey"in r?r.endkey:!1,a="key"in r?r.key:!1,o="keys"in r?r.keys:!1,s=r.skip||0,l=typeof r.limit=="number"?r.limit:-1,c=r.inclusive_end!==!1,u,d;if(!o&&(u=pg(n,i,c,a,r.descending),d=u&&u.error,d&&!(d.name==="DataError"&&d.code===0)))return t(ie(Aa,d.name,d.message));var f=[Te,Me,qe];r.attachments&&f.push(rt);var m=dt(e,f,"readonly");if(m.error)return t(m.error);var w=m.txn;w.oncomplete=Y,w.onabort=gt(t);var C=w.objectStore(Te),k=w.objectStore(Me),v=w.objectStore(qe),g=k.index("_doc_id_rev"),h=[],p,b;v.get(qe).onsuccess=function(Q){p=Q.target.result.docCount},r.update_seq&&(k.openKeyCursor(null,"prev").onsuccess=Q=>{var G=Q.target.result;G&&G.key&&(b=G.key)});function S(Q,G,Z){var te=Q.id+"::"+Z;g.get(te).onsuccess=function(y){if(G.doc=Or(y.target.result)||{},r.conflicts){var x=Ba(Q);x.length&&(G.doc._conflicts=x)}Pc(G.doc,r,w)}}function R(Q,G){var Z={id:G.id,key:G.id,value:{rev:Q}},te=G.deleted;te?o&&(h.push(Z),Z.value.deleted=!0,Z.doc=null):s--<=0&&(h.push(Z),r.include_docs&&S(G,Z,Q))}function B(Q){for(var G=0,Z=Q.length;G<Z&&h.length!==l;G++){var te=Q[G];if(te.error&&o){h.push(te);continue}var se=Lt(te),y=se.winningRev;R(y,se)}}function F(Q,G,Z){Z&&(B(G),h.length<l&&Z.continue())}function K(Q){var G=Q.target.result;r.descending&&(G=G.reverse()),B(G)}function W(){var Q={total_rows:p,offset:r.skip,rows:h};r.update_seq&&b!==void 0&&(Q.update_seq=b),t(null,Q)}function Y(){r.attachments?ma(h,r.binary).then(W):W()}if(!(d||l===0)){if(o)return hg(o,C,F);if(l===-1)return fg(C,u,K);Ic(C,u,r.descending,l+s,F)}}function mg(r,e){var t=r.objectStore(Te).index("deletedOrLocal");t.count(IDBKeyRange.only("0")).onsuccess=function(n){e(n.target.result)}}function vg(r,e,t,n){try{r(e,t)}catch(i){n.emit("error",i)}}function zl(){va||!ya.length||(va=!0,ya.shift()())}function yg(r,e,t){ya.push(function(){r(function(a,o){vg(e,a,o,t),va=!1,yt(function(){zl(t)})})}),zl()}function wg(r,e,t,n){if(r=Ie(r),r.continuous){var i=t+":"+Fr();return Ln.addListener(t,i,e,r),Ln.notify(t),{cancel:function(){Ln.removeListener(t,i)}}}var a=r.doc_ids&&new Set(r.doc_ids);r.since=r.since||0;var o=r.since,s="limit"in r?r.limit:-1;s===0&&(s=1);var l=[],c=0,u=Pa(r),d=new Map,f,m,w,C;function k(B,F,K){if(!K||!B.length)return;var W=new Array(B.length),Y=new Array(B.length);function Q(te,se){var y=r.processChange(se,te,r);o=y.seq=te.seq;var x=u(y);return typeof x=="object"?Promise.reject(x):x?(c++,r.return_docs&&l.push(y),r.attachments&&r.include_docs?new Promise(function(_){Pc(se,r,f,function(){ma([y],r.binary).then(function(){_(y)})})}):Promise.resolve(y)):Promise.resolve()}function G(){for(var te=[],se=0,y=W.length;se<y&&c!==s;se++){var x=W[se];if(x){var _=Y[se];te.push(Q(_,x))}}Promise.all(te).then(function(E){for(var A=0,L=E.length;A<L;A++)E[A]&&r.onChange(E[A])}).catch(r.complete),c!==s&&K.continue()}var Z=0;F.forEach(function(te,se){var y=Or(te),x=B[se];g(y,x,function(_,E){Y[se]=_,W[se]=E,++Z===B.length&&G()})})}function v(B,F,K,W){if(K.seq!==F)return W();if(K.winningRev===B._rev)return W(K,B);var Y=B._id+"::"+K.winningRev,Q=C.get(Y);Q.onsuccess=function(G){W(K,Or(G.target.result))}}function g(B,F,K){if(a&&!a.has(B._id))return K();var W=d.get(B._id);if(W)return v(B,F,W,K);w.get(B._id).onsuccess=function(Y){W=Lt(Y.target.result),d.set(B._id,W),v(B,F,W,K)}}function h(){r.complete(null,{results:l,last_seq:o})}function p(){!r.continuous&&r.attachments?ma(l).then(h):h()}var b=[Te,Me];r.attachments&&b.push(rt);var S=dt(n,b,"readonly");if(S.error)return r.complete(S.error);f=S.txn,f.onabort=gt(r.complete),f.oncomplete=p,m=f.objectStore(Me),w=f.objectStore(Te),C=m.index("_doc_id_rev");var R=r.since&&!r.descending?IDBKeyRange.lowerBound(r.since,!0):null;Ic(m,R,r.descending,s,k)}function Dc(r,e){var t=this;yg(function(n){bg(t,r,n)},e,t.constructor)}function bg(r,e,t){var n=e.name,i=null,a=null;r._meta=null;function o(k){return function(v,g){v&&v instanceof Error&&!v.reason&&a&&(v.reason=a),k(v,g)}}function s(k){var v=k.createObjectStore(Te,{keyPath:"id"});k.createObjectStore(Me,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),k.createObjectStore(rt,{keyPath:"digest"}),k.createObjectStore(qe,{keyPath:"id",autoIncrement:!1}),k.createObjectStore(Ji),v.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),k.createObjectStore(pt,{keyPath:"_id"});var g=k.createObjectStore(Ot,{autoIncrement:!0});g.createIndex("seq","seq"),g.createIndex("digestSeq","digestSeq",{unique:!0})}function l(k,v){var g=k.objectStore(Te);g.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),g.openCursor().onsuccess=function(h){var p=h.target.result;if(p){var b=p.value,S=_t(b);b.deletedOrLocal=S?"1":"0",g.put(b),p.continue()}else v()}}function c(k){k.createObjectStore(pt,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function u(k,v){var g=k.objectStore(pt),h=k.objectStore(Te),p=k.objectStore(Me),b=h.openCursor();b.onsuccess=function(S){var R=S.target.result;if(R){var B=R.value,F=B.id,K=Mt(F),W=Rt(B);if(K){var Y=F+"::"+W,Q=F+"::",G=F+"::~",Z=p.index("_doc_id_rev"),te=IDBKeyRange.bound(Q,G,!1,!1),se=Z.openCursor(te);se.onsuccess=function(y){if(se=y.target.result,!se)h.delete(R.primaryKey),R.continue();else{var x=se.value;x._doc_id_rev===Y&&g.put(x),p.delete(se.primaryKey),se.continue()}}}else R.continue()}else v&&v()}}function d(k){var v=k.createObjectStore(Ot,{autoIncrement:!0});v.createIndex("seq","seq"),v.createIndex("digestSeq","digestSeq",{unique:!0})}function f(k,v){var g=k.objectStore(Me),h=k.objectStore(rt),p=k.objectStore(Ot),b=h.count();b.onsuccess=function(S){var R=S.target.result;if(!R)return v();g.openCursor().onsuccess=function(B){var F=B.target.result;if(!F)return v();for(var K=F.value,W=F.primaryKey,Y=Object.keys(K._attachments||{}),Q={},G=0;G<Y.length;G++){var Z=K._attachments[Y[G]];Q[Z.digest]=!0}var te=Object.keys(Q);for(G=0;G<te.length;G++){var se=te[G];p.put({seq:W,digestSeq:se+"::"+W})}F.continue()}}}function m(k){function v(b){return b.data?Lt(b):(b.deleted=b.deletedOrLocal==="1",b)}var g=k.objectStore(Me),h=k.objectStore(Te),p=h.openCursor();p.onsuccess=function(b){var S=b.target.result;if(!S)return;var R=v(S.value);R.winningRev=R.winningRev||Rt(R);function B(){var K=R.id+"::",W=R.id+"::\uFFFF",Y=g.index("_doc_id_rev").openCursor(IDBKeyRange.bound(K,W)),Q=0;Y.onsuccess=function(G){var Z=G.target.result;if(!Z)return R.seq=Q,F();var te=Z.primaryKey;te>Q&&(Q=te),Z.continue()}}function F(){var K=ga(R,R.winningRev,R.deleted),W=h.put(K);W.onsuccess=function(){S.continue()}}if(R.seq)return F();B()}}r._remote=!1,r.type=function(){return"idb"},r._id=ac(function(k){k(null,r._meta.instanceId)}),r._bulkDocs=function(v,g,h){dg(e,v,g,r,i,o(h))},r._get=function(v,g,h){var p,b,S,R=g.ctx;if(!R){var B=dt(i,[Te,Me,rt],"readonly");if(B.error)return h(B.error);R=B.txn}function F(){h(S,{doc:p,metadata:b,ctx:R})}R.objectStore(Te).get(v).onsuccess=function(K){if(b=Lt(K.target.result),!b)return S=ie(nt,"missing"),F();var W;if(g.rev)W=g.latest?ep(g.rev,b):g.rev;else{W=b.winningRev;var Y=_t(b);if(Y)return S=ie(nt,"deleted"),F()}var Q=R.objectStore(Me),G=b.id+"::"+W;Q.index("_doc_id_rev").get(G).onsuccess=function(Z){if(p=Z.target.result,p&&(p=Or(p)),!p)return S=ie(nt,"missing"),F();F()}}},r._getAttachment=function(k,v,g,h,p){var b;if(h.ctx)b=h.ctx;else{var S=dt(i,[Te,Me,rt],"readonly");if(S.error)return p(S.error);b=S.txn}var R=g.digest,B=g.content_type;b.objectStore(rt).get(R).onsuccess=function(F){var K=F.target.result.body;Ac(K,B,h.binary,function(W){p(null,W)})}},r._info=function(v){var g,h,p=dt(i,[qe,Me],"readonly");if(p.error)return v(p.error);var b=p.txn;b.objectStore(qe).get(qe).onsuccess=function(S){h=S.target.result.docCount},b.objectStore(Me).openKeyCursor(null,"prev").onsuccess=function(S){var R=S.target.result;g=R?R.key:0},b.oncomplete=function(){v(null,{doc_count:h,update_seq:g,idb_attachment_format:r._meta.blobSupport?"binary":"base64"})}},r._allDocs=function(v,g){gg(v,i,o(g))},r._changes=function(v){return wg(v,r,n,i)},r._close=function(k){i.close(),ln.delete(n),k()},r._getRevisionTree=function(k,v){var g=dt(i,[Te],"readonly");if(g.error)return v(g.error);var h=g.txn,p=h.objectStore(Te).get(k);p.onsuccess=function(b){var S=Lt(b.target.result);S?v(null,S.rev_tree):v(ie(nt))}},r._doCompaction=function(k,v,g){var h=[Te,Me,rt,Ot],p=dt(i,h,"readwrite");if(p.error)return g(p.error);var b=p.txn,S=b.objectStore(Te);S.get(k).onsuccess=function(R){var B=Lt(R.target.result);Ft(B.rev_tree,function(W,Y,Q,G,Z){var te=Y+"-"+Q;v.indexOf(te)!==-1&&(Z.status="missing")}),$c(v,k,b);var F=B.winningRev,K=B.deleted;b.objectStore(Te).put(ga(B,F,K))},b.onabort=gt(g),b.oncomplete=function(){g()}},r._getLocal=function(k,v){var g=dt(i,[pt],"readonly");if(g.error)return v(g.error);var h=g.txn,p=h.objectStore(pt).get(k);p.onerror=gt(v),p.onsuccess=function(b){var S=b.target.result;S?(delete S._doc_id_rev,v(null,S)):v(ie(nt))}},r._putLocal=function(k,v,g){typeof v=="function"&&(g=v,v={}),delete k._revisions;var h=k._rev,p=k._id;h?k._rev="0-"+(parseInt(h.split("-")[1],10)+1):k._rev="0-1";var b=v.ctx,S;if(!b){var R=dt(i,[pt],"readwrite");if(R.error)return g(R.error);b=R.txn,b.onerror=gt(g),b.oncomplete=function(){S&&g(null,S)}}var B=b.objectStore(pt),F;h?(F=B.get(p),F.onsuccess=function(K){var W=K.target.result;if(!W||W._rev!==h)g(ie(dn));else{var Y=B.put(k);Y.onsuccess=function(){S={ok:!0,id:k._id,rev:k._rev},v.ctx&&g(null,S)}}}):(F=B.add(k),F.onerror=function(K){g(ie(dn)),K.preventDefault(),K.stopPropagation()},F.onsuccess=function(){S={ok:!0,id:k._id,rev:k._rev},v.ctx&&g(null,S)})},r._removeLocal=function(k,v,g){typeof v=="function"&&(g=v,v={});var h=v.ctx;if(!h){var p=dt(i,[pt],"readwrite");if(p.error)return g(p.error);h=p.txn,h.oncomplete=function(){b&&g(null,b)}}var b,S=k._id,R=h.objectStore(pt),B=R.get(S);B.onerror=gt(g),B.onsuccess=function(F){var K=F.target.result;!K||K._rev!==k._rev?g(ie(nt)):(R.delete(S),b={ok:!0,id:S,rev:"0-0"},v.ctx&&g(null,b))}},r._destroy=function(k,v){Ln.removeAllListeners(n);var g=Zi.get(n);g&&g.result&&(g.result.close(),ln.delete(n));var h=indexedDB.deleteDatabase(n);h.onsuccess=function(){Zi.delete(n),Ar()&&n in localStorage&&delete localStorage[n],v(null,{ok:!0})},h.onerror=gt(v)};var w=ln.get(n);if(w)return i=w.idb,r._meta=w.global,yt(function(){t(null,r)});var C=indexedDB.open(n,lg);Zi.set(n,C),C.onupgradeneeded=function(k){var v=k.target.result;if(k.oldVersion<1)return s(v);var g=k.currentTarget.transaction;k.oldVersion<3&&c(v),k.oldVersion<4&&d(v);var h=[l,u,f,m],p=k.oldVersion;function b(){var S=h[p-1];p++,S&&S(g,b)}b()},C.onsuccess=function(k){i=k.target.result,i.onversionchange=function(){i.close(),ln.delete(n)},i.onabort=function(F){it("error","Database has a global failure",F.target.error),a=F.target.error,i.close(),ln.delete(n)};var v=i.transaction([qe,Ji,Te],"readwrite"),g=!1,h,p,b,S;function R(){typeof b=="undefined"||!g||(r._meta={name:n,instanceId:S,blobSupport:b},ln.set(n,{idb:i,global:r._meta}),t(null,r))}function B(){if(!(typeof p=="undefined"||typeof h=="undefined")){var F=n+"_id";F in h?S=h[F]:h[F]=S=Fr(),h.docCount=p,v.objectStore(qe).put(h)}}v.objectStore(qe).get(qe).onsuccess=function(F){h=F.target.result||{id:qe},B()},mg(v,function(F){p=F,B()}),Qi||(Qi=Qp(v,Ji,"key")),Qi.then(function(F){b=F,R()}),v.oncomplete=function(){g=!0,R()},v.onabort=gt(t)},C.onerror=function(k){var v=k.target.error&&k.target.error.message;v?v.indexOf("stored database is a higher version")!==-1&&(v=new Error('This DB was created with the newer "indexeddb" adapter, but you are trying to open it with the older "idb" adapter')):v="Failed to open indexedDB, are you in private browsing mode?",it("error",v),t(ie(Aa,v))}}function xg(r){r.adapter("idb",Dc,!0)}function _g(r,e){return new Promise(function(t,n){var i=0,a=0,o=0,s=r.length,l;function c(){i++,r[a++]().then(d,f)}function u(){++o===s?l?n(l):t():m()}function d(){i--,u()}function f(w){i--,l=l||w,u()}function m(){for(;i<e&&a<s;)c()}m()})}function Xi(r){let e=r.doc||r.ok,t=e&&e._attachments;t&&Object.keys(t).forEach(function(n){let i=t[n];i.data=La(i.data,i.content_type)})}function Dt(r){return/^_design/.test(r)?"_design/"+encodeURIComponent(r.slice(8)):r.startsWith("_local/")?"_local/"+encodeURIComponent(r.slice(7)):encodeURIComponent(r)}function Hl(r){return!r._attachments||!Object.keys(r._attachments)?Promise.resolve():Promise.all(Object.keys(r._attachments).map(function(e){let t=r._attachments[e];if(t.data&&typeof t.data!="string")return new Promise(function(n){Ma(t.data,n)}).then(function(n){t.data=n})}))}function Cg(r){if(!r.prefix)return!1;let e=uc(r.prefix).protocol;return e==="http"||e==="https"}function Tg(r,e){if(Cg(e)){let i=e.name.substr(e.prefix.length);r=e.prefix.replace(/\/?$/,"/")+encodeURIComponent(i)}let t=uc(r);(t.user||t.password)&&(t.auth={username:t.user,password:t.password});let n=t.path.replace(/(^\/|\/$)/g,"").split("/");return t.db=n.pop(),t.db.indexOf("%")===-1&&(t.db=encodeURIComponent(t.db)),t.path=n.join("/"),t}function $e(r,e){return Cr(r,r.db+"/"+e)}function Cr(r,e){let t=r.path?"/":"";return r.protocol+"://"+r.host+(r.port?":"+r.port:"")+"/"+r.path+t+e}function Sr(r){let e=Object.keys(r);return e.length===0?"":"?"+e.map(t=>t+"="+encodeURIComponent(r[t])).join("&")}function Ag(r){let e=typeof navigator!="undefined"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",t=e.indexOf("msie")!==-1,n=e.indexOf("trident")!==-1,i=e.indexOf("edge")!==-1,a=!("method"in r)||r.method==="GET";return(t||n||i)&&a}function wa(r,e){let t=this,n=Tg(r.name,r),i=$e(n,"");r=Ie(r);let a=async function(d,f){if(f=f||{},f.headers=f.headers||new cn,f.credentials="include",r.auth||n.auth){let C=r.auth||n.auth,k=C.username+":"+C.password,v=Bn(unescape(encodeURIComponent(k)));f.headers.set("Authorization","Basic "+v)}let m=r.headers||{};return Object.keys(m).forEach(function(C){f.headers.append(C,m[C])}),Ag(f)&&(d+=(d.indexOf("?")===-1?"?":"&")+"_nonce="+Date.now()),await(r.fetch||bc)(d,f)};function o(d,f){return Ee(d,function(...m){c().then(function(){return f.apply(this,m)}).catch(function(w){m.pop()(w)})}).bind(t)}async function s(d,f){let m={};f=f||{},f.headers=f.headers||new cn,f.headers.get("Content-Type")||f.headers.set("Content-Type","application/json"),f.headers.get("Accept")||f.headers.set("Accept","application/json");let w=await a(d,f);m.ok=w.ok,m.status=w.status;let C=await w.json();if(m.data=C,!m.ok)throw m.data.status=m.status,fn(m.data);return Array.isArray(m.data)&&(m.data=m.data.map(function(k){return k.error||k.missing?fn(k):k})),m}let l;async function c(){return r.skip_setup?Promise.resolve():l||(l=s(i).catch(function(d){return d&&d.status&&d.status===404?(oa(404,"PouchDB is just detecting if the remote exists."),s(i,{method:"PUT"})):Promise.reject(d)}).catch(function(d){return d&&d.status&&d.status===412?!0:Promise.reject(d)}),l.catch(function(){l=null}),l)}yt(function(){e(null,t)}),t._remote=!0,t.type=function(){return"http"},t.id=o("id",async function(d){let f;try{f=await(await a(Cr(n,""))).json()}catch(w){f={}}let m=f&&f.uuid?f.uuid+n.db:$e(n,"");d(null,m)}),t.compact=o("compact",async function(d,f){typeof d=="function"&&(f=d,d={}),d=Ie(d),await s($e(n,"_compact"),{method:"POST"});function m(){t.info(function(w,C){C&&!C.compact_running?f(null,{ok:!0}):setTimeout(m,d.interval||200)})}m()}),t.bulkGet=Ee("bulkGet",function(d,f){let m=this;async function w(g){let h={};d.revs&&(h.revs=!0),d.attachments&&(h.attachments=!0),d.latest&&(h.latest=!0);try{let p=await s($e(n,"_bulk_get"+Sr(h)),{method:"POST",body:JSON.stringify({docs:d.docs})});d.attachments&&d.binary&&p.data.results.forEach(function(b){b.docs.forEach(Xi)}),g(null,p.data)}catch(p){g(p)}}function C(){let g=Sg,h=Math.ceil(d.docs.length/g),p=0,b=new Array(h);function S(R){return function(B,F){b[R]=F.results,++p===h&&f(null,{results:b.flat()})}}for(let R=0;R<h;R++){let B=Fn(d,["revs","attachments","binary","latest"]);B.docs=d.docs.slice(R*g,Math.min(d.docs.length,(R+1)*g)),oc(m,B,S(R))}}let k=Cr(n,""),v=Yi[k];typeof v!="boolean"?w(function(g,h){g?(Yi[k]=!1,oa(g.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),C()):(Yi[k]=!0,f(null,h))}):v?w(f):C()}),t._info=async function(d){try{await c();let m=await(await a($e(n,""))).json();m.host=$e(n,""),d(null,m)}catch(f){d(f)}},t.fetch=async function(d,f){await c();let m=d.substring(0,1)==="/"?Cr(n,d.substring(1)):$e(n,d);return a(m,f)},t.get=o("get",async function(d,f,m){typeof f=="function"&&(m=f,f={}),f=Ie(f);let w={};f.revs&&(w.revs=!0),f.revs_info&&(w.revs_info=!0),f.latest&&(w.latest=!0),f.open_revs&&(f.open_revs!=="all"&&(f.open_revs=JSON.stringify(f.open_revs)),w.open_revs=f.open_revs),f.rev&&(w.rev=f.rev),f.conflicts&&(w.conflicts=f.conflicts),f.update_seq&&(w.update_seq=f.update_seq),d=Dt(d);function C(g){let h=g._attachments,p=h&&Object.keys(h);if(!h||!p.length)return;async function b(R){let B=h[R],F=Dt(g._id)+"/"+u(R)+"?rev="+g._rev,K=await a($e(n,F)),W;"buffer"in K?W=await K.buffer():W=await K.blob();let Y;if(f.binary){let Q=Object.getOwnPropertyDescriptor(W.__proto__,"type");(!Q||Q.set)&&(W.type=B.content_type),Y=W}else Y=await new Promise(function(Q){Ma(W,Q)});delete B.stub,delete B.length,B.data=Y}let S=p.map(function(R){return function(){return b(R)}});return _g(S,5)}function k(g){return Array.isArray(g)?Promise.all(g.map(function(h){if(h.ok)return C(h.ok)})):C(g)}let v=$e(n,d+Sr(w));try{let g=await s(v);f.attachments&&await k(g.data),m(null,g.data)}catch(g){g.docId=d,m(g)}}),t.remove=o("remove",async function(d,f,m,w){let C;typeof f=="string"?(C={_id:d,_rev:f},typeof m=="function"&&(w=m,m={})):(C=d,typeof f=="function"?(w=f,m={}):(w=m,m=f));let k=C._rev||m.rev,v=$e(n,Dt(C._id))+"?rev="+k;try{let g=await s(v,{method:"DELETE"});w(null,g.data)}catch(g){w(g)}});function u(d){return d.split("/").map(encodeURIComponent).join("/")}t.getAttachment=o("getAttachment",async function(d,f,m,w){typeof m=="function"&&(w=m,m={});let C=m.rev?"?rev="+m.rev:"",k=$e(n,Dt(d))+"/"+u(f)+C,v;try{let g=await a(k,{method:"GET"});if(!g.ok)throw g;v=g.headers.get("content-type");let h;if(typeof process!="undefined"&&!process.browser&&typeof g.buffer=="function"?h=await g.buffer():h=await g.blob(),typeof process!="undefined"&&!process.browser){let p=Object.getOwnPropertyDescriptor(h.__proto__,"type");(!p||p.set)&&(h.type=v)}w(null,h)}catch(g){w(g)}}),t.removeAttachment=o("removeAttachment",async function(d,f,m,w){let C=$e(n,Dt(d)+"/"+u(f))+"?rev="+m;try{let k=await s(C,{method:"DELETE"});w(null,k.data)}catch(k){w(k)}}),t.putAttachment=o("putAttachment",async function(d,f,m,w,C,k){typeof C=="function"&&(k=C,C=w,w=m,m=null);let v=Dt(d)+"/"+u(f),g=$e(n,v);if(m&&(g+="?rev="+m),typeof w=="string"){let h;try{h=Ia(w)}catch(p){return k(ie(lc,"Attachment is not a valid base64 string"))}w=h?Oa(h,C):""}try{let h=await s(g,{headers:new cn({"Content-Type":C}),method:"PUT",body:w});k(null,h.data)}catch(h){k(h)}}),t._bulkDocs=async function(d,f,m){d.new_edits=f.new_edits;try{await c(),await Promise.all(d.docs.map(Hl));let w=await s($e(n,"_bulk_docs"),{method:"POST",body:JSON.stringify(d)});m(null,w.data)}catch(w){m(w)}},t._put=async function(d,f,m){try{await c(),await Hl(d);let w=await s($e(n,Dt(d._id)),{method:"PUT",body:JSON.stringify(d)});m(null,w.data)}catch(w){w.docId=d&&d._id,m(w)}},t.allDocs=o("allDocs",async function(d,f){typeof d=="function"&&(f=d,d={}),d=Ie(d);let m={},w,C="GET";d.conflicts&&(m.conflicts=!0),d.update_seq&&(m.update_seq=!0),d.descending&&(m.descending=!0),d.include_docs&&(m.include_docs=!0),d.attachments&&(m.attachments=!0),d.key&&(m.key=JSON.stringify(d.key)),d.start_key&&(d.startkey=d.start_key),d.startkey&&(m.startkey=JSON.stringify(d.startkey)),d.end_key&&(d.endkey=d.end_key),d.endkey&&(m.endkey=JSON.stringify(d.endkey)),typeof d.inclusive_end!="undefined"&&(m.inclusive_end=!!d.inclusive_end),typeof d.limit!="undefined"&&(m.limit=d.limit),typeof d.skip!="undefined"&&(m.skip=d.skip);let k=Sr(m);typeof d.keys!="undefined"&&(C="POST",w={keys:d.keys});try{let v=await s($e(n,"_all_docs"+k),{method:C,body:JSON.stringify(w)});d.include_docs&&d.attachments&&d.binary&&v.data.rows.forEach(Xi),f(null,v.data)}catch(v){f(v)}}),t._changes=function(d){let f="batch_size"in d?d.batch_size:kg;d=Ie(d),d.continuous&&!("heartbeat"in d)&&(d.heartbeat=Eg);let m="timeout"in d?d.timeout:30*1e3;"timeout"in d&&d.timeout&&m-d.timeout<kr&&(m=d.timeout+kr),"heartbeat"in d&&d.heartbeat&&m-d.heartbeat<kr&&(m=d.heartbeat+kr);let w={};"timeout"in d&&d.timeout&&(w.timeout=d.timeout);let C=typeof d.limit!="undefined"?d.limit:!1,k=C;if(d.style&&(w.style=d.style),(d.include_docs||d.filter&&typeof d.filter=="function")&&(w.include_docs=!0),d.attachments&&(w.attachments=!0),d.continuous&&(w.feed="longpoll"),d.seq_interval&&(w.seq_interval=d.seq_interval),d.conflicts&&(w.conflicts=!0),d.descending&&(w.descending=!0),d.update_seq&&(w.update_seq=!0),"heartbeat"in d&&d.heartbeat&&(w.heartbeat=d.heartbeat),d.filter&&typeof d.filter=="string"&&(w.filter=d.filter),d.view&&typeof d.view=="string"&&(w.filter="_view",w.view=d.view),d.query_params&&typeof d.query_params=="object")for(let B in d.query_params)Object.prototype.hasOwnProperty.call(d.query_params,B)&&(w[B]=d.query_params[B]);let v="GET",g;d.doc_ids?(w.filter="_doc_ids",v="POST",g={doc_ids:d.doc_ids}):d.selector&&(w.filter="_selector",v="POST",g={selector:d.selector});let h=new AbortController,p,b=async function(B,F){if(d.aborted)return;w.since=B,typeof w.since=="object"&&(w.since=JSON.stringify(w.since)),d.descending?C&&(w.limit=k):w.limit=!C||k>f?f:k;let K=$e(n,"_changes"+Sr(w)),W={signal:h.signal,method:v,body:JSON.stringify(g)};if(p=B,!d.aborted)try{await c();let Y=await s(K,W);F(null,Y.data)}catch(Y){F(Y)}},S={results:[]},R=function(B,F){if(d.aborted)return;let K=0;if(F&&F.results){K=F.results.length,S.last_seq=F.last_seq;let Y=null,Q=null;typeof F.pending=="number"&&(Y=F.pending),(typeof S.last_seq=="string"||typeof S.last_seq=="number")&&(Q=S.last_seq);let G={};G.query=d.query_params,F.results=F.results.filter(function(Z){k--;let te=Pa(d)(Z);return te&&(d.include_docs&&d.attachments&&d.binary&&Xi(Z),d.return_docs&&S.results.push(Z),d.onChange(Z,Y,Q)),te})}else if(B){d.aborted=!0,d.complete(B);return}F&&F.last_seq&&(p=F.last_seq);let W=C&&k<=0||F&&K<f||d.descending;d.continuous&&!(C&&k<=0)||!W?yt(function(){b(p,R)}):d.complete(null,S)};return b(d.since||0,R),{cancel:function(){d.aborted=!0,h.abort()}}},t.revsDiff=o("revsDiff",async function(d,f,m){typeof f=="function"&&(m=f,f={});try{let w=await s($e(n,"_revs_diff"),{method:"POST",body:JSON.stringify(d)});m(null,w.data)}catch(w){m(w)}}),t._close=function(d){d()},t._destroy=async function(d,f){try{let m=await s($e(n,""),{method:"DELETE"});f(null,m)}catch(m){m.status===404?f(null,{ok:!0}):f(m)}}}function Pg(r){r.adapter("http",wa,!1),r.adapter("https",wa,!1)}function Oc(r,e){return e&&r.then(function(t){yt(function(){e(null,t)})},function(t){yt(function(){e(t)})}),r}function $g(r){return function(...e){var t=e.pop(),n=r.apply(this,e);return typeof t=="function"&&Oc(n,t),n}}function Ig(r,e){return r.then(function(t){return e().then(function(){return t})},function(t){return e().then(function(){throw t})})}function ea(r,e){return function(){var t=arguments,n=this;return r.add(function(){return e.apply(n,t)})}}function Ul(r){var e=new Set(r),t=new Array(e.size),n=-1;return e.forEach(function(i){t[++n]=i}),t}function ta(r){var e=new Array(r.size),t=-1;return r.forEach(function(n,i){e[++t]=i}),e}function Wl(r){var e="builtin "+r+" function requires map values to be numbers or number arrays";return new pn(e)}function ba(r){for(var e=0,t=0,n=r.length;t<n;t++){var i=r[t];if(typeof i!="number")if(Array.isArray(i)){e=typeof e=="number"?[e]:e;for(var a=0,o=i.length;a<o;a++){var s=i[a];if(typeof s!="number")throw Wl("_sum");typeof e[a]=="undefined"?e.push(s):e[a]+=s}}else throw Wl("_sum");else typeof e=="number"?e+=i:e[0]+=i}return e}function Lc(r,e){return $a("return ("+r.replace(/;\s*$/,"")+");",{emit:e,sum:ba,log:Dg,isArray:Og,toJSON:Lg})}function Vl(r){if(!r)return"undefined";switch(typeof r){case"function":return r.toString();case"string":return r.toString();default:return JSON.stringify(r)}}function Mg(r,e){return Vl(r)+Vl(e)+"undefined"}async function Kl(r,e,t,n,i,a){let o=Mg(t,n),s;if(!i&&(s=r._cachedViews=r._cachedViews||{},s[o]))return s[o];let l=r.info().then(async function(c){let u=c.db_name+"-mrview-"+(i?"temp":hc(o));function d(k){k.views=k.views||{};let v=e;v.indexOf("/")===-1&&(v=e+"/"+e);let g=k.views[v]=k.views[v]||{};if(!g[u])return g[u]=!0,k}await Pr(r,"_local/"+a,d);let m=(await r.registerDependentDatabase(u)).db;m.auto_compaction=!0;let w={name:u,db:m,sourceDB:r,adapter:r.adapter,mapFun:t,reduceFun:n},C;try{C=await w.db.get("_local/lastSeq")}catch(k){if(k.status!==404)throw k}return w.seq=C?C.seq:0,s&&w.db.once("destroyed",function(){delete s[o]}),w});return s&&(s[o]=l),l}function na(r){return r.indexOf("/")===-1?[r,r]:r.split("/")}function Fg(r){return r.length===1&&/^1-/.test(r[0].rev)}function Ql(r,e,t){try{r.emit("error",e)}catch(n){it("error",`The user's map/reduce function threw an uncaught error.
You can debug this error by doing:
myDatabase.on('error', function (err) { debugger; });
Please double-check your map/reduce function.`),it("error",e,t)}}function Bg(r,e,t,n){function i(y,x,_){try{x(_)}catch(E){Ql(y,E,{fun:x,doc:_})}}function a(y,x,_,E,A){try{return{output:x(_,E,A)}}catch(L){return Ql(y,L,{fun:x,keys:_,values:E,rereduce:A}),{error:L}}}function o(y,x){let _=Ce(y.key,x.key);return _!==0?_:Ce(y.value,x.value)}function s(y,x,_){return _=_||0,typeof x=="number"?y.slice(_,x+_):_>0?y.slice(_):y}function l(y){let x=y.value;return x&&typeof x=="object"&&x._id||y.id}function c(y){for(let x of y.rows){let _=x.doc&&x.doc._attachments;if(_)for(let E of Object.keys(_)){let A=_[E];_[E].data=La(A.data,A.content_type)}}}function u(y){return function(x){return y.include_docs&&y.attachments&&y.binary&&c(x),x}}function d(y,x,_,E){let A=x[y];typeof A!="undefined"&&(E&&(A=encodeURIComponent(JSON.stringify(A))),_.push(y+"="+A))}function f(y){if(typeof y!="undefined"){let x=Number(y);return!isNaN(x)&&x===parseInt(y,10)?x:y}}function m(y){return y.group_level=f(y.group_level),y.limit=f(y.limit),y.skip=f(y.skip),y}function w(y){if(y){if(typeof y!="number")return new xt(`Invalid value for integer: "${y}"`);if(y<0)return new xt(`Invalid value for positive integer: "${y}"`)}}function C(y,x){let _=y.descending?"endkey":"startkey",E=y.descending?"startkey":"endkey";if(typeof y[_]!="undefined"&&typeof y[E]!="undefined"&&Ce(y[_],y[E])>0)throw new xt("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(x.reduce&&y.reduce!==!1){if(y.include_docs)throw new xt("{include_docs:true} is invalid for reduce");if(y.keys&&y.keys.length>1&&!y.group&&!y.group_level)throw new xt("Multi-key fetches for reduce views must use {group: true}")}for(let A of["group_level","limit","skip"]){let L=w(y[A]);if(L)throw L}}async function k(y,x,_){let E=[],A,L="GET",q;if(d("reduce",_,E),d("include_docs",_,E),d("attachments",_,E),d("limit",_,E),d("descending",_,E),d("group",_,E),d("group_level",_,E),d("skip",_,E),d("stale",_,E),d("conflicts",_,E),d("startkey",_,E,!0),d("start_key",_,E,!0),d("endkey",_,E,!0),d("end_key",_,E,!0),d("inclusive_end",_,E),d("key",_,E,!0),d("update_seq",_,E),E=E.join("&"),E=E===""?"":"?"+E,typeof _.keys!="undefined"){let O=`keys=${encodeURIComponent(JSON.stringify(_.keys))}`;O.length+E.length+1<=2e3?E+=(E[0]==="?"?"&":"?")+O:(L="POST",typeof x=="string"?A={keys:_.keys}:x.keys=_.keys)}if(typeof x=="string"){let P=na(x),O=await y.fetch("_design/"+P[0]+"/_view/"+P[1]+E,{headers:new cn({"Content-Type":"application/json"}),method:L,body:JSON.stringify(A)});q=O.ok;let D=await O.json();if(!q)throw D.status=O.status,fn(D);for(let M of D.rows)if(M.value&&M.value.error&&M.value.error==="builtin_reduce_error")throw new Error(M.reason);return new Promise(function(M){M(D)}).then(u(_))}A=A||{};for(let P of Object.keys(x))Array.isArray(x[P])?A[P]=x[P]:A[P]=x[P].toString();let I=await y.fetch("_temp_view"+E,{headers:new cn({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(A)});q=I.ok;let T=await I.json();if(!q)throw T.status=I.status,fn(T);return new Promise(function(P){P(T)}).then(u(_))}function v(y,x,_){return new Promise(function(E,A){y._query(x,_,function(L,q){if(L)return A(L);E(q)})})}function g(y){return new Promise(function(x,_){y._viewCleanup(function(E,A){if(E)return _(E);x(A)})})}function h(y){return function(x){if(x.status===404)return y;throw x}}async function p(y,x,_){let E="_local/doc_"+y,A={_id:E,keys:[]},L=_.get(y),q=L[0],I=L[1];function T(){return Fg(I)?Promise.resolve(A):x.db.get(E).catch(h(A))}function P(J){return J.keys.length?x.db.allDocs({keys:J.keys,include_docs:!0}):Promise.resolve({rows:[]})}function O(J,U){let ee=[],le=new Set;for(let V of U.rows){let z=V.doc;if(z&&(ee.push(z),le.add(z._id),z._deleted=!q.has(z._id),!z._deleted)){let H=q.get(z._id);"value"in H&&(z.value=H.value)}}let ce=ta(q);for(let V of ce)if(!le.has(V)){let z={_id:V},H=q.get(V);"value"in H&&(z.value=H.value),ee.push(z)}return J.keys=Ul(ce.concat(J.keys)),ee.push(J),ee}let D=await T(),M=await P(D);return O(D,M)}function b(y){return y.sourceDB.get("_local/purges").then(function(x){let _=x.purgeSeq;return y.db.get("_local/purgeSeq").then(function(E){return E._rev}).catch(h(void 0)).then(function(E){return y.db.put({_id:"_local/purgeSeq",_rev:E,purgeSeq:_})})}).catch(function(x){if(x.status!==404)throw x})}function S(y,x,_){var E="_local/lastSeq";return y.db.get(E).catch(h({_id:E,seq:0})).then(function(A){var L=ta(x);return Promise.all(L.map(function(q){return p(q,y,x)})).then(function(q){var I=q.flat();return A.seq=_,I.push(A),y.db.bulkDocs({docs:I})}).then(()=>b(y))})}function R(y){let x=typeof y=="string"?y:y.name,_=Gl[x];return _||(_=Gl[x]=new Rn),_}async function B(y,x){return ea(R(y),function(){return F(y,x)})()}async function F(y,x){let _,E,A;function L(V,z){let H={id:E._id,key:Bt(V)};typeof z!="undefined"&&z!==null&&(H.value=Bt(z)),_.push(H)}let q=e(y.mapFun,L),I=y.seq||0;function T(){return y.sourceDB.info().then(function(V){A=y.sourceDB.activeTasks.add({name:"view_indexing",total_items:V.update_seq-I})})}function P(V,z){return function(){return S(y,V,z)}}let O=0,D={view:y.name,indexed_docs:O};y.sourceDB.emit("indexing",D);let M=new Rn;async function J(){let V=await y.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:I,limit:x.changes_batch_size}),z=await U();return ee(V,z)}function U(){return y.db.get("_local/purgeSeq").then(function(V){return V.purgeSeq}).catch(h(-1)).then(function(V){return y.sourceDB.get("_local/purges").then(function(z){let H=z.purges.filter(function(pe,ae){return ae>V}).map(pe=>pe.docId),he=H.filter(function(pe,ae){return H.indexOf(pe)===ae});return Promise.all(he.map(function(pe){return y.sourceDB.get(pe).then(function(ae){return{docId:pe,doc:ae}}).catch(h({docId:pe}))}))}).catch(h([]))})}function ee(V,z){let H=V.results;if(!H.length&&!z.length)return;for(let ae of z)if(H.findIndex(function(Ke){return Ke.id===ae.docId})<0){let Ke={_id:ae.docId,doc:{_id:ae.docId,_deleted:1},changes:[]};ae.doc&&(Ke.doc=ae.doc,Ke.changes.push({rev:ae.doc._rev})),H.push(Ke)}let he=le(H);M.add(P(he,I)),O=O+H.length;let pe={view:y.name,last_seq:V.last_seq,results_count:H.length,indexed_docs:O};if(y.sourceDB.emit("indexing",pe),y.sourceDB.activeTasks.update(A,{completed_items:O}),!(H.length<x.changes_batch_size))return J()}function le(V){let z=new Map;for(let H of V){if(H.doc._id[0]!=="_"){_=[],E=H.doc,E._deleted||i(y.sourceDB,q,E),_.sort(o);let he=ce(_);z.set(H.doc._id,[he,H.changes])}I=H.seq}return z}function ce(V){let z=new Map,H;for(let he=0,pe=V.length;he<pe;he++){let ae=V[he],je=[ae.key,ae.id];he>0&&Ce(ae.key,H)===0&&je.push(he),z.set(ut(je),ae),H=ae.key}return z}try{await T(),await J(),await M.finish(),y.seq=I,y.sourceDB.activeTasks.remove(A)}catch(V){y.sourceDB.activeTasks.remove(A,V)}}function K(y,x,_){_.group_level===0&&delete _.group_level;let E=_.group||_.group_level,A=t(y.reduceFun),L=[],q=isNaN(_.group_level)?Number.POSITIVE_INFINITY:_.group_level;for(let I of x){let T=L[L.length-1],P=E?I.key:null;if(E&&Array.isArray(P)&&(P=P.slice(0,q)),T&&Ce(T.groupKey,P)===0){T.keys.push([I.key,I.id]),T.values.push(I.value);continue}L.push({keys:[[I.key,I.id]],values:[I.value],groupKey:P})}x=[];for(let I of L){let T=a(y.sourceDB,A,I.keys,I.values,!1);if(T.error&&T.error instanceof pn)throw T.error;x.push({value:T.error?null:T.output,key:I.groupKey})}return{rows:s(x,_.limit,_.skip)}}function W(y,x){return ea(R(y),function(){return Y(y,x)})()}async function Y(y,x){let _,E=y.reduceFun&&x.reduce!==!1,A=x.skip||0;typeof x.keys!="undefined"&&!x.keys.length&&(x.limit=0,delete x.keys);async function L(I){I.include_docs=!0;let T=await y.db.allDocs(I);return _=T.total_rows,T.rows.map(function(P){if("value"in P.doc&&typeof P.doc.value=="object"&&P.doc.value!==null){let D=Object.keys(P.doc.value).sort(),M=["id","key","value"];if(!(D<M||D>M))return P.doc.value}let O=Pp(P.doc._id);return{key:O[0],id:O[1],value:"value"in P.doc?P.doc.value:null}})}async function q(I){let T;if(E?T=K(y,I,x):typeof x.keys=="undefined"?T={total_rows:_,offset:A,rows:I}:T={total_rows:_,offset:A,rows:s(I,x.limit,x.skip)},x.update_seq&&(T.update_seq=y.seq),x.include_docs){let P=Ul(I.map(l)),O=await y.sourceDB.allDocs({keys:P,include_docs:!0,conflicts:x.conflicts,attachments:x.attachments,binary:x.binary}),D=new Map;for(let M of O.rows)D.set(M.id,M.doc);for(let M of I){let J=l(M),U=D.get(J);U&&(M.doc=U)}}return T}if(typeof x.keys!="undefined"){let T=x.keys.map(function(D){let M={startkey:ut([D]),endkey:ut([D,{}])};return x.update_seq&&(M.update_seq=!0),L(M)}),O=(await Promise.all(T)).flat();return q(O)}else{let I={descending:x.descending};x.update_seq&&(I.update_seq=!0);let T,P;if("start_key"in x&&(T=x.start_key),"startkey"in x&&(T=x.startkey),"end_key"in x&&(P=x.end_key),"endkey"in x&&(P=x.endkey),typeof T!="undefined"&&(I.startkey=x.descending?ut([T,{}]):ut([T])),typeof P!="undefined"){let D=x.inclusive_end!==!1;x.descending&&(D=!D),I.endkey=ut(D?[P,{}]:[P])}if(typeof x.key!="undefined"){let D=ut([x.key]),M=ut([x.key,{}]);I.descending?(I.endkey=D,I.startkey=M):(I.startkey=D,I.endkey=M)}E||(typeof x.limit=="number"&&(I.limit=x.limit),I.skip=A);let O=await L(I);return q(O)}}async function Q(y){return(await y.fetch("_view_cleanup",{headers:new cn({"Content-Type":"application/json"}),method:"POST"})).json()}async function G(y){try{let x=await y.get("_local/"+r),_=new Map;for(let T of Object.keys(x.views)){let P=na(T),O="_design/"+P[0],D=P[1],M=_.get(O);M||(M=new Set,_.set(O,M)),M.add(D)}let E={keys:ta(_),include_docs:!0},A=await y.allDocs(E),L={};for(let T of A.rows){let P=T.key.substring(8);for(let O of _.get(T.key)){let D=P+"/"+O;x.views[D]||(D=O);let M=Object.keys(x.views[D]),J=T.doc&&T.doc.views&&T.doc.views[O];for(let U of M)L[U]=L[U]||J}}let I=Object.keys(L).filter(function(T){return!L[T]}).map(function(T){return ea(R(T),function(){return new y.constructor(T,y.__opts).destroy()})()});return Promise.all(I).then(function(){return{ok:!0}})}catch(x){if(x.status===404)return{ok:!0};throw x}}async function Z(y,x,_){if(typeof y._query=="function")return v(y,x,_);if(mt(y))return k(y,x,_);let E={changes_batch_size:y.__opts.view_update_changes_batch_size||Rg};if(typeof x!="string")return C(_,x),Jl.add(async function(){let A=await Kl(y,"temp_view/temp_view",x.map,x.reduce,!0,r);return Ig(B(A,E).then(function(){return W(A,_)}),function(){return A.db.destroy()})}),Jl.finish();{let A=x,L=na(A),q=L[0],I=L[1],T=await y.get("_design/"+q);if(x=T.views&&T.views[I],!x)throw new hn(`ddoc ${T._id} has no view named ${I}`);n(T,I),C(_,x);let P=await Kl(y,A,x.map,x.reduce,!1,r);return _.stale==="ok"||_.stale==="update_after"?(_.stale==="update_after"&&yt(function(){B(P,E)}),W(P,_)):(await B(P,E),W(P,_))}}function te(y,x,_){let E=this;typeof x=="function"&&(_=x,x={}),x=x?m(x):{},typeof y=="function"&&(y={map:y});let A=Promise.resolve().then(function(){return Z(E,y,x)});return Oc(A,_),A}let se=$g(function(){let y=this;return typeof y._viewCleanup=="function"?g(y):mt(y)?Q(y):G(y)});return{query:te,viewCleanup:se}}function qg(r){if(/^_sum/.test(r))return ra._sum;if(/^_count/.test(r))return ra._count;if(/^_stats/.test(r))return ra._stats;if(/^_/.test(r))throw new Error(r+" is not a supported reduce function.")}function Ng(r,e){if(typeof r=="function"&&r.length===2){var t=r;return function(n){return t(n,e)}}else return Lc(r.toString(),e)}function jg(r){var e=r.toString(),t=qg(e);return t||Lc(e)}function zg(r,e){var t=r.views&&r.views[e];if(typeof t.map!="string")throw new hn("ddoc "+r._id+" has no string view named "+e+", instead found object of type: "+typeof t.map)}function Ug(r,e,t){return Mc.query.call(this,r,e,t)}function Wg(r){return Mc.viewCleanup.call(this,r)}function Kg(r,e,t){return!r._attachments||!r._attachments[t]||r._attachments[t].digest!==e._attachments[t].digest}function Zl(r,e){var t=Object.keys(e._attachments);return Promise.all(t.map(function(n){return r.getAttachment(e._id,n,{rev:e._rev})}))}function Gg(r,e,t){var n=mt(e)&&!mt(r),i=Object.keys(t._attachments);return n?r.get(t._id).then(function(a){return Promise.all(i.map(function(o){return Kg(a,t,o)?e.getAttachment(t._id,o):r.getAttachment(a._id,o)}))}).catch(function(a){if(a.status!==404)throw a;return Zl(e,t)}):Zl(e,t)}function Jg(r){var e=[];return Object.keys(r).forEach(function(t){var n=r[t].missing;n.forEach(function(i){e.push({id:t,rev:i})})}),{docs:e,revs:!0,latest:!0}}function Qg(r,e,t,n){t=Ie(t);var i=[],a=!0;function o(){var l=Jg(t);if(l.docs.length)return r.bulkGet(l).then(function(c){if(n.cancelled)throw new Error("cancelled");return Promise.all(c.results.map(function(u){return Promise.all(u.docs.map(function(d){var f=d.ok;return d.error&&(a=!1),!f||!f._attachments?f:Gg(e,r,f).then(m=>{var w=Object.keys(f._attachments);return m.forEach(function(C,k){var v=f._attachments[w[k]];delete v.stub,delete v.length,v.data=C}),f})}))})).then(function(u){i=i.concat(u.flat().filter(Boolean))})})}function s(){return{ok:a,docs:i}}return Promise.resolve().then(o).then(s)}function xa(r,e,t,n,i){return r.get(e).catch(function(a){if(a.status===404)return(r.adapter==="http"||r.adapter==="https")&&oa(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:n,_id:e,history:[],replicator:Xl,version:Yl};throw a}).then(function(a){if(!i.cancelled&&a.last_seq!==t)return a.history=(a.history||[]).filter(function(o){return o.session_id!==n}),a.history.unshift({last_seq:t,session_id:n}),a.history=a.history.slice(0,Zg),a.version=Yl,a.replicator=Xl,a.session_id=n,a.last_seq=t,r.put(a).catch(function(o){if(o.status===409)return xa(r,e,t,n,i);throw o})})}function Yg(r,e){return r.session_id===e.session_id?{last_seq:r.last_seq,history:r.history}:Rc(r.history,e.history)}function Rc(r,e){var t=r[0],n=r.slice(1),i=e[0],a=e.slice(1);if(!t||e.length===0)return{last_seq:ct,history:[]};var o=t.session_id;if(_a(o,e))return{last_seq:t.last_seq,history:r};var s=i.session_id;return _a(s,n)?{last_seq:i.last_seq,history:a}:Rc(n,a)}function _a(r,e){var t=e[0],n=e.slice(1);return!r||e.length===0?!1:r===t.session_id?!0:_a(r,n)}function tc(r){return typeof r.status=="number"&&Math.floor(r.status/100)===4}function Fc(r,e,t,n,i){return this instanceof Lr?Fc:new Lr(r,e,t,n,i)}function Xg(r,e,t,n){if(r.retry===!1){e.emit("error",t),e.removeAllListeners();return}if(typeof r.back_off_function!="function"&&(r.back_off_function=Eh),e.emit("requestError",t),e.state==="active"||e.state==="pending"){e.emit("paused",t),e.state="stopped";var i=function(){r.current_back_off=nc},a=function(){e.removeListener("active",i)};e.once("paused",a),e.once("active",i)}r.current_back_off=r.current_back_off||nc,r.current_back_off=r.back_off_function(r.current_back_off),setTimeout(n,r.current_back_off)}function em(r){return Object.keys(r).sort(Ce).reduce(function(e,t){return e[t]=r[t],e},{})}function tm(r,e,t){var n=t.doc_ids?t.doc_ids.sort(Ce):"",i=t.filter?t.filter.toString():"",a="",o="",s="";return t.selector&&(s=JSON.stringify(t.selector)),t.filter&&t.query_params&&(a=JSON.stringify(em(t.query_params))),t.filter&&t.filter==="_view"&&(o=t.view.toString()),Promise.all([r.id(),e.id()]).then(function(l){var c=l[0]+l[1]+i+o+a+n+s;return new Promise(function(u){Ra(c,u)})}).then(function(l){return l=l.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+l})}function Bc(r,e,t,n,i){var a=[],o,s={seq:0,changes:[],docs:[]},l=!1,c=!1,u=!1,d=0,f=0,m=t.continuous||t.live||!1,w=t.batch_size||100,C=t.batches_limit||10,k=t.style||"all_docs",v=!1,g=t.doc_ids,h=t.selector,p,b,S=[],R=Fr(),B;i=i||{ok:!0,start_time:new Date().toISOString(),docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var F={};n.ready(r,e);function K(){return b?Promise.resolve():tm(r,e,t).then(function(T){p=T;var P={};t.checkpoint===!1?P={writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:t.checkpoint==="source"?P={writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:t.checkpoint==="target"?P={writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:P={writeSourceCheckpoint:!0,writeTargetCheckpoint:!0},b=new Fc(r,e,p,n,P)})}function W(){if(S=[],o.docs.length!==0){var T=o.docs,P={timeout:t.timeout};return e.bulkDocs({docs:T,new_edits:!1},P).then(function(O){if(n.cancelled)throw y(),new Error("cancelled");var D=Object.create(null);O.forEach(function(J){J.error&&(D[J.id]=J)});var M=Object.keys(D).length;i.doc_write_failures+=M,i.docs_written+=T.length-M,T.forEach(function(J){var U=D[J._id];if(U){i.errors.push(U);var ee=(U.name||"").toLowerCase();if(ee==="unauthorized"||ee==="forbidden")n.emit("denied",Ie(U));else throw U}else S.push(J)})},function(O){throw i.doc_write_failures+=T.length,O})}}function Y(){if(o.error)throw new Error("There was a problem getting docs.");i.last_seq=f=o.seq;var T=Ie(i);return S.length&&(T.docs=S,typeof o.pending=="number"&&(T.pending=o.pending,delete o.pending),n.emit("change",T)),l=!0,r.info().then(function(P){var O=r.activeTasks.get(B);if(!(!o||!O)){var D=O.completed_items||0,M=parseInt(P.update_seq,10)-parseInt(d,10);r.activeTasks.update(B,{completed_items:D+o.changes.length,total_items:M})}}),b.writeCheckpoint(o.seq,R).then(function(){if(n.emit("checkpoint",{checkpoint:o.seq}),l=!1,n.cancelled)throw y(),new Error("cancelled");o=void 0,A()}).catch(function(P){throw I(P),P})}function Q(){var T={};return o.changes.forEach(function(P){n.emit("checkpoint",{revs_diff:P}),P.id!=="_user/"&&(T[P.id]=P.changes.map(function(O){return O.rev}))}),e.revsDiff(T).then(function(P){if(n.cancelled)throw y(),new Error("cancelled");o.diffs=P})}function G(){return Qg(r,e,o.diffs,n).then(function(T){o.error=!T.ok,T.docs.forEach(function(P){delete o.diffs[P._id],i.docs_read++,o.docs.push(P)})})}function Z(){if(!(n.cancelled||o)){if(a.length===0){te(!0);return}o=a.shift(),n.emit("checkpoint",{start_next_batch:o.seq}),Q().then(G).then(W).then(Y).then(Z).catch(function(T){se("batch processing terminated with error",T)})}}function te(T){if(s.changes.length===0){a.length===0&&!o&&((m&&F.live||c)&&(n.state="pending",n.emit("paused")),c&&y());return}(T||c||s.changes.length>=w)&&(a.push(s),s={seq:0,changes:[],docs:[]},(n.state==="pending"||n.state==="stopped")&&(n.state="active",n.emit("active")),Z())}function se(T,P){u||(P.message||(P.message=T),i.ok=!1,i.status="aborting",a=[],s={seq:0,changes:[],docs:[]},y(P))}function y(T){if(!u&&!(n.cancelled&&(i.status="cancelled",l)))if(i.status=i.status||"complete",i.end_time=new Date().toISOString(),i.last_seq=f,u=!0,r.activeTasks.remove(B,T),T){T=ie(T),T.result=i;var P=(T.name||"").toLowerCase();P==="unauthorized"||P==="forbidden"?(n.emit("error",T),n.removeAllListeners()):Xg(t,n,T,function(){Bc(r,e,t,n)})}else n.emit("complete",i),n.removeAllListeners()}function x(T,P,O){if(n.cancelled)return y();typeof P=="number"&&(s.pending=P);var D=Pa(t)(T);if(!D){var M=r.activeTasks.get(B);if(M){var J=M.completed_items||0;r.activeTasks.update(B,{completed_items:++J})}return}s.seq=T.seq||O,s.changes.push(T),n.emit("checkpoint",{pending_batch:s.seq}),yt(function(){te(a.length===0&&F.live)})}function _(T){if(v=!1,n.cancelled)return y();if(T.results.length>0)F.since=T.results[T.results.length-1].seq,A(),te(!0);else{var P=function(){m?(F.live=!0,A()):c=!0,te(!0)};!o&&T.results.length===0?(l=!0,b.writeCheckpoint(T.last_seq,R).then(function(){if(l=!1,i.last_seq=f=T.last_seq,n.cancelled)throw y(),new Error("cancelled");P()}).catch(I)):P()}}function E(T){if(v=!1,n.cancelled)return y();se("changes rejected",T)}function A(){if(!(!v&&!c&&a.length<C))return;v=!0;function T(){O.cancel()}function P(){n.removeListener("cancel",T)}n._changes&&(n.removeListener("cancel",n._abortChanges),n._changes.cancel()),n.once("cancel",T);var O=r.changes(F).on("change",x);O.then(P,P),O.then(_).catch(E),t.retry&&(n._changes=O,n._abortChanges=T)}function L(T){return r.info().then(function(P){var O=typeof t.since=="undefined"?parseInt(P.update_seq,10)-parseInt(T,10):parseInt(P.update_seq,10);return B=r.activeTasks.add({name:`${m?"continuous ":""}replication from ${P.db_name}`,total_items:O}),T})}function q(){K().then(function(){if(n.cancelled){y();return}return b.getCheckpoint().then(L).then(function(T){f=T,d=T,F={since:f,limit:w,batch_size:w,style:k,doc_ids:g,selector:h,return_docs:!0},t.filter&&(typeof t.filter!="string"?F.include_docs=!0:F.filter=t.filter),"heartbeat"in t&&(F.heartbeat=t.heartbeat),"timeout"in t&&(F.timeout=t.timeout),t.query_params&&(F.query_params=t.query_params),t.view&&(F.view=t.view),A()})}).catch(function(T){se("getCheckpoint rejected with ",T)})}function I(T){l=!1,se("writeCheckpoint completed with error",T)}if(n.cancelled){y();return}n._addedListeners||(n.once("cancel",y),typeof t.complete=="function"&&(n.once("error",t.complete),n.once("complete",function(T){t.complete(null,T)})),n._addedListeners=!0),typeof t.since=="undefined"?q():K().then(function(){return l=!0,b.writeCheckpoint(t.since,R)}).then(function(){if(l=!1,n.cancelled){y();return}f=t.since,q()}).catch(I)}function Mr(r,e){var t=e.PouchConstructor;return typeof r=="string"?new t(r,e):r}function Sa(r,e,t,n){if(typeof t=="function"&&(n=t,t={}),typeof t=="undefined"&&(t={}),t.doc_ids&&!Array.isArray(t.doc_ids))throw ie(Rr,"`doc_ids` filter parameter is not a list.");t.complete=n,t=Ie(t),t.continuous=t.continuous||t.live,t.retry="retry"in t?t.retry:!1,t.PouchConstructor=t.PouchConstructor||this;var i=new ka(t),a=Mr(r,t),o=Mr(e,t);return Bc(a,o,t,i),i}function nm(r,e,t,n){return typeof t=="function"&&(n=t,t={}),typeof t=="undefined"&&(t={}),t=Ie(t),t.PouchConstructor=t.PouchConstructor||this,r=Mr(r,t),e=Mr(e,t),new Ea(r,e,t,n)}function rm(r){r.replicate=Sa,r.sync=nm,Object.defineProperty(r.prototype,"replicate",{get:function(){var e=this;return typeof this.replicateMethods=="undefined"&&(this.replicateMethods={from:function(t,n,i){return e.constructor.replicate(t,e,n,i)},to:function(t,n,i){return e.constructor.replicate(e,t,n,i)}}),this.replicateMethods}}),r.prototype.sync=function(e,t,n){return this.constructor.sync(this,e,t,n)}}var Tr,Ca,vt,rc,wh,_h,ia,yt,aa,xe,B0,Ch,nt,dn,sc,Th,Ah,q0,Ta,lc,N0,Ph,Il,Rr,Wi,j0,Aa,z0,H0,U0,Er,W0,$h,V0,Ol,Ll,Oh,Lh,Ia,Bn,qh,Nh,Fr,la,cp,$r,ca,Ir,oe,bc,cn,ua,Fl,pp,mp,Ec,fa,ha,Nl,Zp,Yp,lg,Te,Me,rt,Ot,qe,pt,Ji,Ln,va,ya,ln,Qi,Zi,kg,Sg,kr,Eg,Yi,xt,hn,pn,Dg,Og,Lg,Rn,Gl,Jl,Rg,ra,Hg,Mc,Vg,Yl,Xl,Zg,ct,Lr,ec,nc,ka,Ea,im,za=j(()=>{Tr=Qt(zi());Al();Ca=Qt(Pl()),vt=Qt(require("events"));rc=Function.prototype.toString,wh=rc.call(Object);_h=6;try{localStorage.setItem("_pouch_check_localstorage",1),ia=!!localStorage.getItem("_pouch_check_localstorage")}catch(r){ia=!1}yt=typeof queueMicrotask=="function"?queueMicrotask:function(e){Promise.resolve().then(e)},aa=class extends vt.default{constructor(){super(),this._listeners={},Ar()&&addEventListener("storage",e=>{this.emit(e.key)})}addListener(e,t,n,i){if(this._listeners[t])return;var a=!1,o=this;function s(){if(!o._listeners[t])return;if(a){a="waiting";return}a=!0;var l=Fn(i,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);function c(){a=!1}n.changes(l).on("change",function(u){u.seq>i.since&&!i.cancelled&&(i.since=u.seq,i.onChange(u))}).on("complete",function(){a==="waiting"&&yt(s),a=!1}).on("error",c)}this._listeners[t]=s,this.on(e,s)}removeListener(e,t){t in this._listeners&&(super.removeListener(e,this._listeners[t]),delete this._listeners[t])}notifyLocalWindows(e){Ar()&&(localStorage[e]=localStorage[e]==="a"?"b":"a")}notify(e){this.emit(e),this.notifyLocalWindows(e)}};xe=class extends Error{constructor(e,t,n){super(),this.status=e,this.name=t,this.message=n,this.error=!0}toString(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})}},B0=new xe(401,"unauthorized","Name or password is incorrect."),Ch=new xe(400,"bad_request","Missing JSON list of 'docs'"),nt=new xe(404,"not_found","missing"),dn=new xe(409,"conflict","Document update conflict"),sc=new xe(400,"bad_request","_id field must contain a string"),Th=new xe(412,"missing_id","_id is required for puts"),Ah=new xe(400,"bad_request","Only reserved document ids may start with underscore."),q0=new xe(412,"precondition_failed","Database not open"),Ta=new xe(500,"unknown_error","Database encountered an unknown error"),lc=new xe(500,"badarg","Some query argument is invalid"),N0=new xe(400,"invalid_request","Request was invalid"),Ph=new xe(400,"query_parse_error","Some query parameter is invalid"),Il=new xe(500,"doc_validation","Bad special document member"),Rr=new xe(400,"bad_request","Something wrong with the request"),Wi=new xe(400,"bad_request","Document must be a JSON object"),j0=new xe(404,"not_found","Database not found"),Aa=new xe(500,"indexed_db_went_bad","unknown"),z0=new xe(500,"web_sql_went_bad","unknown"),H0=new xe(500,"levelDB_went_went_bad","unknown"),U0=new xe(403,"forbidden","Forbidden by design doc validate_doc_update function"),Er=new xe(400,"bad_request","Invalid rev format"),W0=new xe(412,"file_exists","The database could not be created, the file already exists."),$h=new xe(412,"missing_stub","A pre-existing attachment stub wasn't found"),V0=new xe(413,"invalid_url","Provided URL is invalid");Ol=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],Ll="queryKey",Oh=/(?:^|&)([^&=]*)=?([^&]*)/g,Lh=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;Ia=function(r){return atob(r)},Bn=function(r){return btoa(r)};qh=self.setImmediate||self.setTimeout,Nh=32768;Fr=Dn;la=class extends vt.default{constructor(e,t,n){super(),this.db=e,t=t?Ie(t):{};var i=t.complete=ic((s,l)=>{s?Dh(this,"error")>0&&this.emit("error",s):this.emit("complete",l),this.removeAllListeners(),e.removeListener("destroyed",a)});n&&(this.on("complete",function(s){n(null,s)}),this.on("error",n));let a=()=>{this.cancel()};e.once("destroyed",a),t.onChange=(s,l,c)=>{this.isCancelled||tp(this,s,l,c)};var o=new Promise(function(s,l){t.complete=function(c,u){c?l(c):s(u)}});this.once("cancel",function(){e.removeListener("destroyed",a),t.complete(null,{status:"cancelled"})}),this.then=o.then.bind(o),this.catch=o.catch.bind(o),this.then(function(s){i(null,s)},i),e.taskqueue.isReady?this.validateChanges(t):e.taskqueue.addTask(s=>{s?t.complete(s):this.isCancelled?this.emit("cancel"):this.validateChanges(t)})}cancel(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")}validateChanges(e){var t=e.complete;oe._changesFilterPlugin?oe._changesFilterPlugin.validate(e,n=>{if(n)return t(n);this.doChanges(e)}):this.doChanges(e)}doChanges(e){var t=e.complete;if(e=Ie(e),"live"in e&&!("continuous"in e)&&(e.continuous=e.live),e.processChange=np,e.since==="latest"&&(e.since="now"),e.since||(e.since=0),e.since==="now"){this.db.info().then(i=>{if(this.isCancelled){t(null,{status:"cancelled"});return}e.since=i.update_seq,this.doChanges(e)},t);return}if(oe._changesFilterPlugin){if(oe._changesFilterPlugin.normalize(e),oe._changesFilterPlugin.shouldFilter(this,e))return oe._changesFilterPlugin.filter(this,e)}else["doc_ids","filter","selector","view"].forEach(function(i){i in e&&it("warn",'The "'+i+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')});"descending"in e||(e.descending=!1),e.limit=e.limit===0?1:e.limit,e.complete=t;var n=this.db._changes(e);if(n&&typeof n.cancel=="function"){let i=this.cancel;this.cancel=(...a)=>{n.cancel(),i.apply(this,a)}}}};cp=/^\d+-[^-]*$/;$r=class extends vt.default{_setup(){this.post=Ee("post",function(e,t,n){if(typeof t=="function"&&(n=t,t={}),Ki(e))return n(ie(Wi));this.bulkDocs({docs:[e]},t,Vi(n,e._id))}).bind(this),this.put=Ee("put",function(e,t,n){if(typeof t=="function"&&(n=t,t={}),Ki(e))return n(ie(Wi));if(cc(e._id),"_rev"in e&&!Gi(e._rev))return n(ie(Er));if(Mt(e._id)&&typeof this._putLocal=="function")return e._deleted?this._removeLocal(e,n):this._putLocal(e,n);let i=o=>{typeof this._put=="function"&&t.new_edits!==!1?this._put(e,t,o):this.bulkDocs({docs:[e]},t,Vi(o,e._id))};t.force&&e._rev?(a(),i(function(o){var s=o?null:{ok:!0,id:e._id,rev:e._rev};n(o,s)})):i(n);function a(){var o=e._rev.split("-"),s=o[1],l=parseInt(o[0],10),c=l+1,u=pc();e._revisions={start:c,ids:[u,s]},e._rev=c+"-"+u,t.new_edits=!1}}).bind(this),this.putAttachment=Ee("putAttachment",function(e,t,n,i,a){var o=this;typeof a=="function"&&(a=i,i=n,n=null),typeof a=="undefined"&&(a=i,i=n,n=null),a||it("warn","Attachment",t,"on document",e,"is missing content_type");function s(l){var c="_rev"in l?parseInt(l._rev,10):0;return l._attachments=l._attachments||{},l._attachments[t]={content_type:a,data:i,revpos:++c},o.put(l)}return o.get(e).then(function(l){if(l._rev!==n)throw ie(dn);return s(l)},function(l){if(l.reason===nt.message)return s({_id:e});throw l})}).bind(this),this.removeAttachment=Ee("removeAttachment",function(e,t,n,i){this.get(e,(a,o)=>{if(a){i(a);return}if(o._rev!==n){i(ie(dn));return}if(!o._attachments)return i();delete o._attachments[t],Object.keys(o._attachments).length===0&&delete o._attachments,this.put(o,i)})}).bind(this),this.remove=Ee("remove",function(e,t,n,i){var a;typeof t=="string"?(a={_id:e,_rev:t},typeof n=="function"&&(i=n,n={})):(a=e,typeof t=="function"?(i=t,n={}):(i=n,n=t)),n=n||{},n.was_delete=!0;var o={_id:a._id,_rev:a._rev||n.rev};if(o._deleted=!0,Mt(o._id)&&typeof this._removeLocal=="function")return this._removeLocal(a,i);this.bulkDocs({docs:[o]},n,Vi(i,o._id))}).bind(this),this.revsDiff=Ee("revsDiff",function(e,t,n){typeof t=="function"&&(n=t,t={});var i=Object.keys(e);if(!i.length)return n(null,{});var a=0,o=new Map;function s(c,u){o.has(c)||o.set(c,{missing:[]}),o.get(c).missing.push(u)}function l(c,u){var d=e[c].slice(0);Ft(u,function(f,m,w,C,k){var v=m+"-"+w,g=d.indexOf(v);g!==-1&&(d.splice(g,1),k.status!=="available"&&s(c,v))}),d.forEach(function(f){s(c,f)})}i.forEach(function(c){this._getRevisionTree(c,function(u,d){if(u&&u.status===404&&u.message==="missing")o.set(c,{missing:e[c]});else{if(u)return n(u);l(c,d)}if(++a===i.length){var f={};return o.forEach(function(m,w){f[w]=m}),n(null,f)}})},this)}).bind(this),this.bulkGet=Ee("bulkGet",function(e,t){oc(this,e,t)}).bind(this),this.compactDocument=Ee("compactDocument",function(e,t,n){this._getRevisionTree(e,(i,a)=>{if(i)return n(i);var o=ap(a),s=[],l=[];Object.keys(o).forEach(function(c){o[c]>t&&s.push(c)}),Ft(a,function(c,u,d,f,m){var w=u+"-"+d;m.status==="available"&&s.indexOf(w)!==-1&&l.push(w)}),this._doCompaction(e,l,n)})}).bind(this),this.compact=Ee("compact",function(e,t){typeof e=="function"&&(t=e,e={}),e=e||{},this._compactionQueue=this._compactionQueue||[],this._compactionQueue.push({opts:e,callback:t}),this._compactionQueue.length===1&&yc(this)}).bind(this),this.get=Ee("get",function(e,t,n){if(typeof t=="function"&&(n=t,t={}),t=t||{},typeof e!="string")return n(ie(sc));if(Mt(e)&&typeof this._getLocal=="function")return this._getLocal(e,n);var i=[];let a=()=>{var l=[],c=i.length;if(!c)return n(null,l);i.forEach(u=>{this.get(e,{rev:u,revs:t.revs,latest:t.latest,attachments:t.attachments,binary:t.binary},function(d,f){if(d)l.push({missing:u});else{for(var m,w=0,C=l.length;w<C;w++)if(l[w].ok&&l[w].ok._rev===f._rev){m=!0;break}m||l.push({ok:f})}c--,c||n(null,l)})})};if(t.open_revs){if(t.open_revs==="all")this._getRevisionTree(e,function(l,c){if(l)return n(l);i=Fa(c).map(function(u){return u.rev}),a()});else if(Array.isArray(t.open_revs)){i=t.open_revs;for(var o=0;o<i.length;o++){var s=i[o];if(!Gi(s))return n(ie(Er))}a()}else return n(ie(Ta,"function_clause"));return}return this._get(e,t,(l,c)=>{if(l)return l.docId=e,n(l);var u=c.doc,d=c.metadata,f=c.ctx;if(t.conflicts){var m=Ba(d);m.length&&(u._conflicts=m)}if(_t(d,u._rev)&&(u._deleted=!0),t.revs||t.revs_info){for(var w=u._rev.split("-"),C=parseInt(w[0],10),k=w[1],v=gc(d.rev_tree),g=null,h=0;h<v.length;h++){var p=v[h];let Q=p.ids.findIndex(G=>G.id===k);var b=Q===C-1;(b||!g&&Q!==-1)&&(g=p)}if(!g)return l=new Error("invalid rev tree"),l.docId=e,n(l);let W=u._rev.split("-")[1],Y=g.ids.findIndex(Q=>Q.id===W)+1;var S=g.ids.length-Y;if(g.ids.splice(Y,S),g.ids.reverse(),t.revs&&(u._revisions={start:g.pos+g.ids.length-1,ids:g.ids.map(function(Q){return Q.id})}),t.revs_info){var R=g.pos+g.ids.length;u._revs_info=g.ids.map(function(Q){return R--,{rev:R+"-"+Q.id,status:Q.opts.status}})}}if(t.attachments&&u._attachments){var B=u._attachments,F=Object.keys(B).length;if(F===0)return n(null,u);Object.keys(B).forEach(W=>{this._getAttachment(u._id,W,B[W],{binary:t.binary,metadata:d,ctx:f},function(Y,Q){var G=u._attachments[W];G.data=Q,delete G.stub,delete G.length,--F||n(null,u)})})}else{if(u._attachments)for(var K in u._attachments)Object.prototype.hasOwnProperty.call(u._attachments,K)&&(u._attachments[K].stub=!0);n(null,u)}})}).bind(this),this.getAttachment=Ee("getAttachment",function(e,t,n,i){n instanceof Function&&(i=n,n={}),this._get(e,n,(a,o)=>{if(a)return i(a);if(o.doc._attachments&&o.doc._attachments[t])n.ctx=o.ctx,n.binary=!0,n.metadata=o.metadata,this._getAttachment(e,t,o.doc._attachments[t],n,i);else return i(ie(nt))})}).bind(this),this.allDocs=Ee("allDocs",function(e,t){if(typeof e=="function"&&(t=e,e={}),e.skip=typeof e.skip!="undefined"?e.skip:0,e.start_key&&(e.startkey=e.start_key),e.end_key&&(e.endkey=e.end_key),"keys"in e){if(!Array.isArray(e.keys))return t(new TypeError("options.keys must be an array"));var n=["startkey","endkey","key"].filter(function(i){return i in e})[0];if(n){t(ie(Ph,"Query parameter `"+n+"` is not compatible with multi-get"));return}if(!mt(this)&&(op(e),e.keys.length===0))return this._allDocs({limit:0},t)}return this._allDocs(e,t)}).bind(this),this.close=Ee("close",function(e){return this._closed=!0,this.emit("closed"),this._close(e)}).bind(this),this.info=Ee("info",function(e){this._info((t,n)=>{if(t)return e(t);n.db_name=n.db_name||this.name,n.auto_compaction=!!(this.auto_compaction&&!mt(this)),n.adapter=this.adapter,e(null,n)})}).bind(this),this.id=Ee("id",function(e){return this._id(e)}).bind(this),this.bulkDocs=Ee("bulkDocs",function(e,t,n){if(typeof t=="function"&&(n=t,t={}),t=t||{},Array.isArray(e)&&(e={docs:e}),!e||!e.docs||!Array.isArray(e.docs))return n(ie(Ch));for(var i=0;i<e.docs.length;++i){let l=e.docs[i];if(Ki(l))return n(ie(Wi));if("_rev"in l&&!Gi(l._rev))return n(ie(Er))}var a;if(e.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(c){a=a||lp(c),l._attachments[c].content_type||it("warn","Attachment",c,"on document",l._id,"is missing content_type")})}),a)return n(ie(Rr,a));"new_edits"in t||("new_edits"in e?t.new_edits=e.new_edits:t.new_edits=!0);var o=this;!t.new_edits&&!mt(o)&&e.docs.sort(ip),rp(e.docs);var s=e.docs.map(function(l){return l._id});this._bulkDocs(e,t,function(l,c){if(l)return n(l);if(t.new_edits||(c=c.filter(function(f){return f.error})),!mt(o))for(var u=0,d=c.length;u<d;u++)c[u].id=c[u].id||s[u];n(null,c)})}).bind(this),this.registerDependentDatabase=Ee("registerDependentDatabase",function(e,t){var n=Ie(this.__opts);this.__opts.view_adapter&&(n.adapter=this.__opts.view_adapter);var i=new this.constructor(e,n);function a(o){return o.dependentDbs=o.dependentDbs||{},o.dependentDbs[e]?!1:(o.dependentDbs[e]=!0,o)}Pr(this,"_local/_pouch_dependentDbs",a).then(function(){t(null,{db:i})}).catch(t)}).bind(this),this.destroy=Ee("destroy",function(e,t){typeof e=="function"&&(t=e,e={});var n="use_prefix"in this?this.use_prefix:!0;let i=()=>{this._destroy(e,(a,o)=>{if(a)return t(a);this._destroyed=!0,this.emit("destroyed"),t(null,o||{ok:!0})})};if(mt(this))return i();this.get("_local/_pouch_dependentDbs",(a,o)=>{if(a)return a.status!==404?t(a):i();var s=o.dependentDbs,l=this.constructor,c=Object.keys(s).map(u=>{var d=n?u.replace(new RegExp("^"+l.prefix),""):u;return new l(d,this.__opts).destroy()});Promise.all(c).then(i,t)})}).bind(this)}_compact(e,t){var n={return_docs:!1,last_seq:e.last_seq||0,since:e.last_seq||0},i=[],a,o=0;let s=u=>{this.activeTasks.update(a,{completed_items:++o}),i.push(this.compactDocument(u.id,0))},l=u=>{this.activeTasks.remove(a,u),t(u)},c=u=>{var d=u.last_seq;Promise.all(i).then(()=>Pr(this,"_local/compaction",f=>!f.last_seq||f.last_seq<d?(f.last_seq=d,f):!1)).then(()=>{this.activeTasks.remove(a),t(null,{ok:!0})}).catch(l)};this.info().then(u=>{a=this.activeTasks.add({name:"database_compaction",total_items:u.update_seq-n.last_seq}),this.changes(n).on("change",s).on("complete",c).on("error",l)})}changes(e,t){return typeof e=="function"&&(t=e,e={}),e=e||{},e.return_docs="return_docs"in e?e.return_docs:!e.live,new la(this,e,t)}type(){return typeof this._type=="function"?this._type():this.adapter}};$r.prototype.purge=Ee("_purge",function(r,e,t){if(typeof this._purge=="undefined")return t(ie(Ta,"Purge is not implemented in the "+this.adapter+" adapter."));var n=this;n._getRevisionTree(r,(i,a)=>{if(i)return t(i);if(!a)return t(ie(nt));let o;try{o=Vh(a,e)}catch(s){return t(s.message||s)}n._purge(r,o,(s,l)=>{if(s)return t(s);sp(n,r,e).then(function(){return t(null,l)})})})});ca=class{constructor(){this.isReady=!1,this.failed=!1,this.queue=[]}execute(){var e;if(this.failed)for(;e=this.queue.shift();)e(this.failed);else for(;e=this.queue.shift();)e()}fail(e){this.failed=e,this.execute()}ready(e){this.isReady=!0,this.db=e,this.execute()}addTask(e){this.queue.push(e),this.failed&&this.execute()}};Ir=class extends $r{constructor(e,t){super(),this._setup(e,t)}_setup(e,t){if(super._setup(),t=t||{},e&&typeof e=="object"&&(t=e,e=t.name,delete t.name),t.deterministic_revs===void 0&&(t.deterministic_revs=!0),this.__opts=t=Ie(t),this.auto_compaction=t.auto_compaction,this.purged_infos_limit=t.purged_infos_limit||1e3,this.prefix=oe.prefix,typeof e!="string")throw new Error("Missing/invalid DB name");var n=(t.prefix||"")+e,i=up(n,t);if(t.name=i.name,t.adapter=t.adapter||i.adapter,this.name=e,this._adapter=t.adapter,oe.emit("debug",["adapter","Picked adapter: ",t.adapter]),!oe.adapters[t.adapter]||!oe.adapters[t.adapter].valid())throw new Error("Invalid Adapter: "+t.adapter);if(t.view_adapter&&(!oe.adapters[t.view_adapter]||!oe.adapters[t.view_adapter].valid()))throw new Error("Invalid View Adapter: "+t.view_adapter);this.taskqueue=new ca,this.adapter=t.adapter,oe.adapters[t.adapter].call(this,t,a=>{if(a)return this.taskqueue.fail(a);fp(this),this.emit("created",this),oe.emit("created",this.name),this.taskqueue.ready(this)})}},oe=wc(Ir,function(r,e){Ir.prototype._setup.call(this,r,e)}),bc=fetch,cn=Headers,ua=class{constructor(){this.tasks={}}list(){return Object.values(this.tasks)}add(e){let t=Dn();return this.tasks[t]={id:t,name:e.name,total_items:e.total_items,created_at:new Date().toJSON()},t}get(e){return this.tasks[e]}remove(e,t){return delete this.tasks[e],this.tasks}update(e,t){let n=this.tasks[e];if(typeof n!="undefined"){let i={id:n.id,name:n.name,created_at:n.created_at,total_items:t.total_items||n.total_items,completed_items:t.completed_items||n.completed_items,updated_at:new Date().toJSON()};this.tasks[e]=i}return this.tasks}};oe.adapters={};oe.preferredAdapters=[];oe.prefix="_pouch_";Fl=new vt.default;hp(oe);oe.adapter=function(r,e,t){e.valid()&&(oe.adapters[r]=e,t&&oe.preferredAdapters.push(r))};oe.plugin=function(r){if(typeof r=="function")r(oe);else{if(typeof r!="object"||Object.keys(r).length===0)throw new Error('Invalid plugin: got "'+r+'", expected an object or a function');Object.keys(r).forEach(function(e){oe.prototype[e]=r[e]})}return this.__defaults&&(oe.__defaults=Object.assign({},this.__defaults)),oe};oe.defaults=function(r){let e=wc(oe,function(t,n){n=n||{},t&&typeof t=="object"&&(n=t,t=n.name,delete n.name),n=Object.assign({},e.__defaults,n),oe.call(this,t,n)});return e.preferredAdapters=oe.preferredAdapters.slice(),Object.keys(oe).forEach(function(t){t in e||(e[t]=oe[t])}),e.__defaults=Object.assign({},this.__defaults,r),e};oe.fetch=function(r,e){return bc(r,e)};oe.prototype.activeTasks=oe.activeTasks=new ua;pp="9.0.0";mp=["$or","$nor","$not"];Ec=-324,fa=3,ha="";Nl={$elemMatch:function(r,e,t,n){return!Array.isArray(n)||n.length===0?!1:typeof n[0]=="object"&&n[0]!==null?n.some(function(i){return un(i,e,Object.keys(e))}):n.some(function(i){return Dr(e,r,t,i)})},$allMatch:function(r,e,t,n){return!Array.isArray(n)||n.length===0?!1:typeof n[0]=="object"&&n[0]!==null?n.every(function(i){return un(i,e,Object.keys(e))}):n.every(function(i){return Dr(e,r,t,i)})},$eq:function(r,e,t,n){return It(n)&&Ce(n,e)===0},$gte:function(r,e,t,n){return It(n)&&Ce(n,e)>=0},$gt:function(r,e,t,n){return It(n)&&Ce(n,e)>0},$lte:function(r,e,t,n){return It(n)&&Ce(n,e)<=0},$lt:function(r,e,t,n){return It(n)&&Ce(n,e)<0},$exists:function(r,e,t,n){return e?It(n):!It(n)},$mod:function(r,e,t,n){return On(n)&&Fp(n,e)},$ne:function(r,e,t,n){return e.every(function(i){return Ce(n,i)!==0})},$in:function(r,e,t,n){return On(n)&&ql(n,e)},$nin:function(r,e,t,n){return On(n)&&!ql(n,e)},$size:function(r,e,t,n){return On(n)&&Array.isArray(n)&&qp(n,e)},$all:function(r,e,t,n){return Array.isArray(n)&&Bp(n,e)},$regex:function(r,e,t,n){return On(n)&&typeof n=="string"&&e.every(function(i){return Np(n,i)})},$type:function(r,e,t,n){return jp(n,e)}};oe.plugin(Jp);oe.version=pp;Zp=Cc(["_id","_rev","_access","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),Yp=Cc(["_access","_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);lg=5,Te="document-store",Me="by-sequence",rt="attach-store",Ot="attach-seq-store",qe="meta-store",pt="local-store",Ji="detect-blob-support";Ln=new aa;va=!1,ya=[];ln=new Map,Zi=new Map;Dc.valid=function(){try{return typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(r){return!1}};kg=25,Sg=50,kr=5e3,Eg=1e4,Yi={};wa.valid=function(){return!0};xt=class extends Error{constructor(e){super(),this.status=400,this.name="query_parse_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,xt)}catch(t){}}},hn=class extends Error{constructor(e){super(),this.status=404,this.name="not_found",this.message=e,this.error=!0;try{Error.captureStackTrace(this,hn)}catch(t){}}},pn=class extends Error{constructor(e){super(),this.status=500,this.name="invalid_value",this.message=e,this.error=!0;try{Error.captureStackTrace(this,pn)}catch(t){}}};Dg=it.bind(null,"log"),Og=Array.isArray,Lg=JSON.parse;Rn=class{constructor(){this.promise=Promise.resolve()}add(e){return this.promise=this.promise.catch(()=>{}).then(()=>e()),this.promise}finish(){return this.promise}};Gl={},Jl=new Rn,Rg=50;ra={_sum:function(r,e){return ba(e)},_count:function(r,e){return e.length},_stats:function(r,e){function t(n){for(var i=0,a=0,o=n.length;a<o;a++){var s=n[a];i+=s*s}return i}return{sum:ba(e),min:Math.min.apply(null,e),max:Math.max.apply(null,e),count:e.length,sumsqr:t(e)}}};Hg="mrviews",Mc=Bg(Hg,Ng,jg,zg);Vg={query:Ug,viewCleanup:Wg};Yl=1,Xl="pouchdb",Zg=5,ct=0;Lr=class{constructor(e,t,n,i,a={writeSourceCheckpoint:!0,writeTargetCheckpoint:!0}){this.src=e,this.target=t,this.id=n,this.returnValue=i,this.opts=a,typeof a.writeSourceCheckpoint=="undefined"&&(a.writeSourceCheckpoint=!0),typeof a.writeTargetCheckpoint=="undefined"&&(a.writeTargetCheckpoint=!0)}writeCheckpoint(e,t){var n=this;return this.updateTarget(e,t).then(function(){return n.updateSource(e,t)})}updateTarget(e,t){return this.opts.writeTargetCheckpoint?xa(this.target,this.id,e,t,this.returnValue):Promise.resolve(!0)}updateSource(e,t){if(this.opts.writeSourceCheckpoint){var n=this;return xa(this.src,this.id,e,t,this.returnValue).catch(function(i){if(tc(i))return n.opts.writeSourceCheckpoint=!1,!0;throw i})}else return Promise.resolve(!0)}getCheckpoint(){var e=this;return!e.opts.writeSourceCheckpoint&&!e.opts.writeTargetCheckpoint?Promise.resolve(ct):e.opts&&e.opts.writeSourceCheckpoint&&!e.opts.writeTargetCheckpoint?e.src.get(e.id).then(function(t){return t.last_seq||ct}).catch(function(t){if(t.status!==404)throw t;return ct}):e.target.get(e.id).then(function(t){return e.opts&&e.opts.writeTargetCheckpoint&&!e.opts.writeSourceCheckpoint?t.last_seq||ct:e.src.get(e.id).then(function(n){if(t.version!==n.version)return ct;var i;return t.version?i=t.version.toString():i="undefined",i in ec?ec[i](t,n):ct},function(n){if(n.status===404&&t.last_seq)return e.src.put({_id:e.id,last_seq:ct}).then(function(){return ct},function(i){return tc(i)?(e.opts.writeSourceCheckpoint=!1,t.last_seq):ct});throw n})}).catch(function(t){if(t.status!==404)throw t;return ct})}},ec={undefined:function(r,e){return Ce(r.last_seq,e.last_seq)===0?e.last_seq:0},1:function(r,e){return Yg(e,r).last_seq}};nc=0;ka=class extends vt.default{constructor(){super(),this.cancelled=!1,this.state="pending";let e=new Promise((t,n)=>{this.once("complete",t),this.once("error",n)});this.then=function(t,n){return e.then(t,n)},this.catch=function(t){return e.catch(t)},this.catch(function(){})}cancel(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")}ready(e,t){if(this._readyCalled)return;this._readyCalled=!0;let n=()=>{this.cancel()};e.once("destroyed",n),t.once("destroyed",n);function i(){e.removeListener("destroyed",n),t.removeListener("destroyed",n)}this.once("complete",i),this.once("error",i)}};Ea=class extends vt.default{constructor(e,t,n,i){super(),this.canceled=!1;let a=n.push?Object.assign({},n,n.push):n,o=n.pull?Object.assign({},n,n.pull):n;this.push=Sa(e,t,a),this.pull=Sa(t,e,o),this.pushPaused=!0,this.pullPaused=!0;let s=h=>{this.emit("change",{direction:"pull",change:h})},l=h=>{this.emit("change",{direction:"push",change:h})},c=h=>{this.emit("denied",{direction:"push",doc:h})},u=h=>{this.emit("denied",{direction:"pull",doc:h})},d=()=>{this.pushPaused=!0,this.pullPaused&&this.emit("paused")},f=()=>{this.pullPaused=!0,this.pushPaused&&this.emit("paused")},m=()=>{this.pushPaused=!1,this.pullPaused&&this.emit("active",{direction:"push"})},w=()=>{this.pullPaused=!1,this.pushPaused&&this.emit("active",{direction:"pull"})},C={},k=h=>(p,b)=>{(p==="change"&&(b===s||b===l)||p==="denied"&&(b===u||b===c)||p==="paused"&&(b===f||b===d)||p==="active"&&(b===w||b===m))&&(p in C||(C[p]={}),C[p][h]=!0,Object.keys(C[p]).length===2&&this.removeAllListeners(p))};n.live&&(this.push.on("complete",this.pull.cancel.bind(this.pull)),this.pull.on("complete",this.push.cancel.bind(this.push)));function v(h,p,b){h.listeners(p).indexOf(b)==-1&&h.on(p,b)}this.on("newListener",function(h){h==="change"?(v(this.pull,"change",s),v(this.push,"change",l)):h==="denied"?(v(this.pull,"denied",u),v(this.push,"denied",c)):h==="active"?(v(this.pull,"active",w),v(this.push,"active",m)):h==="paused"&&(v(this.pull,"paused",f),v(this.push,"paused",d))}),this.on("removeListener",function(h){h==="change"?(this.pull.removeListener("change",s),this.push.removeListener("change",l)):h==="denied"?(this.pull.removeListener("denied",u),this.push.removeListener("denied",c)):h==="active"?(this.pull.removeListener("active",w),this.push.removeListener("active",m)):h==="paused"&&(this.pull.removeListener("paused",f),this.push.removeListener("paused",d))}),this.pull.on("removeListener",k("pull")),this.push.on("removeListener",k("push"));let g=Promise.all([this.push,this.pull]).then(h=>{let p={push:h[0],pull:h[1]};return this.emit("complete",p),i&&i(null,p),this.removeAllListeners(),p},h=>{if(this.cancel(),i?i(h):this.emit("error",h),this.removeAllListeners(),i)throw h});this.then=function(h,p){return g.then(h,p)},this.catch=function(h){return g.catch(h)}}cancel(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())}};oe.plugin(xg).plugin(Pg).plugin(Vg).plugin(rm);im=oe});function Ha(r,e){function t(n){for(var i=Object.getOwnPropertyNames(r),a=0,o=i.length;a<o;a++)typeof r[i[a]]!="function"&&(this[i[a]]=r[i[a]]);this.stack===void 0&&(this.stack=new Error().stack),n!==void 0&&(this.reason=n)}return t.prototype=_e.prototype,new t(e)}function qn(r){if(typeof r!="object"){var e=r;r=cm,r.data=e}return"error"in r&&r.error==="conflict"&&(r.name="conflict",r.status=409),"name"in r||(r.name=r.error||"unknown"),"status"in r||(r.status=500),"message"in r||(r.message=r.message||r.reason),"stack"in r||(r.stack=new Error().stack),r}var _e,J0,Q0,Z0,Y0,om,sm,lm,X0,cm,ex,tx,nx,rx,um,ix,ax,ox,sx,lx,cx,ux,dx,fx,hx,qr=j(()=>{_e=class extends Error{constructor(e,t,n){super(),this.status=e,this.name=t,this.message=n,this.error=!0}toString(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})}},J0=new _e(401,"unauthorized","Name or password is incorrect."),Q0=new _e(400,"bad_request","Missing JSON list of 'docs'"),Z0=new _e(404,"not_found","missing"),Y0=new _e(409,"conflict","Document update conflict"),om=new _e(400,"bad_request","_id field must contain a string"),sm=new _e(412,"missing_id","_id is required for puts"),lm=new _e(400,"bad_request","Only reserved document ids may start with underscore."),X0=new _e(412,"precondition_failed","Database not open"),cm=new _e(500,"unknown_error","Database encountered an unknown error"),ex=new _e(500,"badarg","Some query argument is invalid"),tx=new _e(400,"invalid_request","Request was invalid"),nx=new _e(400,"query_parse_error","Some query parameter is invalid"),rx=new _e(500,"doc_validation","Bad special document member"),um=new _e(400,"bad_request","Something wrong with the request"),ix=new _e(400,"bad_request","Document must be a JSON object"),ax=new _e(404,"not_found","Database not found"),ox=new _e(500,"indexed_db_went_bad","unknown"),sx=new _e(500,"web_sql_went_bad","unknown"),lx=new _e(500,"levelDB_went_went_bad","unknown"),cx=new _e(403,"forbidden","Forbidden by design doc validate_doc_update function"),ux=new _e(400,"bad_request","Invalid rev format"),dx=new _e(412,"file_exists","The database could not be created, the file already exists."),fx=new _e(412,"missing_stub","A pre-existing attachment stub wasn't found"),hx=new _e(413,"invalid_url","Provided URL is invalid")});var gn,Ua=j(()=>{gn=Headers});function fm(r,e){r=r||[],e=e||{};try{return new Blob(r,e)}catch(a){if(a.name!=="TypeError")throw a;for(var t=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,n=new t,i=0;i<r.length;i+=1)n.append(r[i]);return n.getBlob(e.type)}}function hm(r){for(var e=r.length,t=new ArrayBuffer(e),n=new Uint8Array(t),i=0;i<e;i++)n[i]=r.charCodeAt(i);return t}function pm(r,e){return fm([hm(r)],{type:e})}function Uc(r,e){return pm(dm(r),e)}var dm,Wa=j(()=>{dm=function(r){return atob(r)}});function gm(r,e,t){for(var n="",i=t-r.length;n.length<i;)n+=e;return n}function mm(r,e,t){var n=gm(r,e,t);return n+r}function Se(r,e){if(r===e)return 0;r=Tt(r),e=Tt(e);var t=Ga(r),n=Ga(e);if(t-n!==0)return t-n;switch(typeof r){case"number":return r-e;case"boolean":return r<e?-1:1;case"string":return xm(r,e)}return Array.isArray(r)?bm(r,e):_m(r,e)}function Tt(r){switch(typeof r){case"undefined":return null;case"number":return r===1/0||r===-1/0||isNaN(r)?null:r;case"object":var e=r;if(Array.isArray(r)){var t=r.length;r=new Array(t);for(var n=0;n<t;n++)r[n]=Tt(e[n])}else{if(r instanceof Date)return r.toJSON();if(r!==null){r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var a=e[i];typeof a!="undefined"&&(r[i]=Tt(a))}}}}return r}function vm(r){if(r!==null)switch(typeof r){case"boolean":return r?1:0;case"number":return km(r);case"string":return r.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var e=Array.isArray(r),t=e?r:Object.keys(r),n=-1,i=t.length,a="";if(e)for(;++n<i;)a+=at(t[n]);else for(;++n<i;){var o=t[n];a+=at(o)+at(r[o])}return a}return""}function at(r){var e="\0";return r=Tt(r),Ga(r)+Ka+vm(r)+e}function ym(r,e){var t=e,n,i=r[e]==="1";if(i)n=0,e++;else{var a=r[e]==="0";e++;var o="",s=r.substring(e,e+Va),l=parseInt(s,10)+Wc;for(a&&(l=-l),e+=Va;;){var c=r[e];if(c==="\0")break;o+=c,e++}o=o.split("."),o.length===1?n=parseInt(o,10):n=parseFloat(o[0]+"."+o[1]),a&&(n=n-10),l!==0&&(n=parseFloat(n+"e"+l))}return{num:n,length:e-t}}function wm(r,e){var t=r.pop();if(e.length){var n=e[e.length-1];t===n.element&&(e.pop(),n=e[e.length-1]);var i=n.element,a=n.index;if(Array.isArray(i))i.push(t);else if(a===r.length-2){var o=r.pop();i[o]=t}else r.push(t)}}function Vc(r){for(var e=[],t=[],n=0;;){var i=r[n++];if(i==="\0"){if(e.length===1)return e.pop();wm(e,t);continue}switch(i){case"1":e.push(null);break;case"2":e.push(r[n]==="1"),n++;break;case"3":var a=ym(r,n);e.push(a.num),n+=a.length;break;case"4":for(var o="";;){var s=r[n];if(s==="\0")break;o+=s,n++}o=o.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),e.push(o);break;case"5":var l={element:[],index:e.length};e.push(l.element),t.push(l);break;case"6":var c={element:{},index:e.length};e.push(c.element),t.push(c);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+i)}}}function bm(r,e){for(var t=Math.min(r.length,e.length),n=0;n<t;n++){var i=Se(r[n],e[n]);if(i!==0)return i}return r.length===e.length?0:r.length>e.length?1:-1}function xm(r,e){return r===e?0:r>e?1:-1}function _m(r,e){for(var t=Object.keys(r),n=Object.keys(e),i=Math.min(t.length,n.length),a=0;a<i;a++){var o=Se(t[a],n[a]);if(o!==0||(o=Se(r[t[a]],e[n[a]]),o!==0))return o}return t.length===n.length?0:t.length>n.length?1:-1}function Ga(r){var e=["boolean","number","string","object"],t=e.indexOf(typeof r);if(~t)return r===null?1:Array.isArray(r)?5:t<3?t+2:t+3;if(Array.isArray(r))return 5}function km(r){if(r===0)return"1";var e=r.toExponential().split(/e\+?/),t=parseInt(e[1],10),n=r<0,i=n?"0":"2",a=(n?-t:t)-Wc,o=mm(a.toString(),"0",Va);i+=Ka+o;var s=Math.abs(parseFloat(e[0]));n&&(s=10-s);var l=s.toFixed(20);return l=l.replace(/\.?0+$/,""),i+=Ka+l,i}var Wc,Va,Ka,Nr=j(()=>{Wc=-324,Va=3,Ka=""});function Nn(r){return Kc.default.hash(r)}var Kc,xx,jr=j(()=>{Wa();Kc=Qt(zi()),xx=self.setImmediate||self.setTimeout});function Em(r){return typeof ArrayBuffer!="undefined"&&r instanceof ArrayBuffer||typeof Blob!="undefined"&&r instanceof Blob}function Cm(r){return r instanceof ArrayBuffer?r.slice(0):r.slice(0,r.size,r.type)}function Am(r){var e=Object.getPrototypeOf(r);if(e===null)return!0;var t=e.constructor;return typeof t=="function"&&t instanceof t&&Qc.call(t)==Tm}function kt(r){var e,t,n;if(!r||typeof r!="object")return r;if(Array.isArray(r)){for(e=[],t=0,n=r.length;t<n;t++)e[t]=kt(r[t]);return e}if(r instanceof Date&&isFinite(r))return r.toISOString();if(Em(r))return Cm(r);if(!Am(r))return r;e={};for(t in r)if(Object.prototype.hasOwnProperty.call(r,t)){var i=kt(r[t]);typeof i!="undefined"&&(e[t]=i)}return e}function zr(r){if(typeof console!="undefined"&&typeof console[r]=="function"){var e=Array.prototype.slice.call(arguments,1);console[r].apply(console,e)}}function Pm(){}function St(r){return typeof r._remote=="boolean"?r._remote:typeof r.type=="function"?(zr("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),r.type()==="http"):!1}function mn(r,e,t){return r.get(e).catch(function(n){if(n.status!==404)throw n;return{}}).then(function(n){var i=n._rev,a=t(n);return a?(a._id=e,a._rev=i,Im(r,a,t)):{updated:!1,rev:i}})}function Im(r,e,t){return r.put(e).then(function(n){return{updated:!0,rev:n.rev}},function(n){if(n.status!==409)throw n;return mn(r,e._id,t)})}var Sm,Qc,Tm,Gc,jn,$m,Jc,zn=j(()=>{qr();Sm=Qt(require("events"));jr();Qc=Function.prototype.toString,Tm=Qc.call(Object);try{localStorage.setItem("_pouch_check_localstorage",1),Gc=!!localStorage.getItem("_pouch_check_localstorage")}catch(r){Gc=!1}jn=typeof queueMicrotask=="function"?queueMicrotask:function(e){Promise.resolve().then(e)};$m=Pm.name;$m?Jc=function(r){return r.name}:Jc=function(r){var e=r.toString().match(/^\s*function\s*(?:(\S+)\s*)?\(/);return e&&e[1]?e[1]:""}});function Ja(r,e){return e&&r.then(function(t){jn(function(){e(null,t)})},function(t){jn(function(){e(t)})}),r}function Zc(r){return function(...e){var t=e.pop(),n=r.apply(this,e);return typeof t=="function"&&Ja(n,t),n}}function Yc(r,e){return r.then(function(t){return e().then(function(){return t})},function(t){return e().then(function(){throw t})})}function Hr(r,e){return function(){var t=arguments,n=this;return r.add(function(){return e.apply(n,t)})}}function Qa(r){var e=new Set(r),t=new Array(e.size),n=-1;return e.forEach(function(i){t[++n]=i}),t}function Ur(r){var e=new Array(r.size),t=-1;return r.forEach(function(n,i){e[++t]=i}),e}var wt,vn,yn,Xc=j(()=>{zn();wt=class extends Error{constructor(e){super(),this.status=400,this.name="query_parse_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,wt)}catch(t){}}},vn=class extends Error{constructor(e){super(),this.status=404,this.name="not_found",this.message=e,this.error=!0;try{Error.captureStackTrace(this,vn)}catch(t){}}},yn=class extends Error{constructor(e){super(),this.status=500,this.name="invalid_value",this.message=e,this.error=!0;try{Error.captureStackTrace(this,yn)}catch(t){}}}});function eu(r){if(!r)return"undefined";switch(typeof r){case"function":return r.toString();case"string":return r.toString();default:return JSON.stringify(r)}}function Dm(r,e){return eu(r)+eu(e)+"undefined"}async function tu(r,e,t,n,i,a){let o=Dm(t,n),s;if(!i&&(s=r._cachedViews=r._cachedViews||{},s[o]))return s[o];let l=r.info().then(async function(c){let u=c.db_name+"-mrview-"+(i?"temp":Nn(o));function d(k){k.views=k.views||{};let v=e;v.indexOf("/")===-1&&(v=e+"/"+e);let g=k.views[v]=k.views[v]||{};if(!g[u])return g[u]=!0,k}await mn(r,"_local/"+a,d);let m=(await r.registerDependentDatabase(u)).db;m.auto_compaction=!0;let w={name:u,db:m,sourceDB:r,adapter:r.adapter,mapFun:t,reduceFun:n},C;try{C=await w.db.get("_local/lastSeq")}catch(k){if(k.status!==404)throw k}return w.seq=C?C.seq:0,s&&w.db.once("destroyed",function(){delete s[o]}),w});return s&&(s[o]=l),l}function Za(r){return r.indexOf("/")===-1?[r,r]:r.split("/")}function Lm(r){return r.length===1&&/^1-/.test(r[0].rev)}function iu(r,e,t){try{r.emit("error",e)}catch(n){zr("error",`The user's map/reduce function threw an uncaught error.
You can debug this error by doing:
myDatabase.on('error', function (err) { debugger; });
Please double-check your map/reduce function.`),zr("error",e,t)}}function Mm(r,e,t,n){function i(y,x,_){try{x(_)}catch(E){iu(y,E,{fun:x,doc:_})}}function a(y,x,_,E,A){try{return{output:x(_,E,A)}}catch(L){return iu(y,L,{fun:x,keys:_,values:E,rereduce:A}),{error:L}}}function o(y,x){let _=Se(y.key,x.key);return _!==0?_:Se(y.value,x.value)}function s(y,x,_){return _=_||0,typeof x=="number"?y.slice(_,x+_):_>0?y.slice(_):y}function l(y){let x=y.value;return x&&typeof x=="object"&&x._id||y.id}function c(y){for(let x of y.rows){let _=x.doc&&x.doc._attachments;if(_)for(let E of Object.keys(_)){let A=_[E];_[E].data=Uc(A.data,A.content_type)}}}function u(y){return function(x){return y.include_docs&&y.attachments&&y.binary&&c(x),x}}function d(y,x,_,E){let A=x[y];typeof A!="undefined"&&(E&&(A=encodeURIComponent(JSON.stringify(A))),_.push(y+"="+A))}function f(y){if(typeof y!="undefined"){let x=Number(y);return!isNaN(x)&&x===parseInt(y,10)?x:y}}function m(y){return y.group_level=f(y.group_level),y.limit=f(y.limit),y.skip=f(y.skip),y}function w(y){if(y){if(typeof y!="number")return new wt(`Invalid value for integer: "${y}"`);if(y<0)return new wt(`Invalid value for positive integer: "${y}"`)}}function C(y,x){let _=y.descending?"endkey":"startkey",E=y.descending?"startkey":"endkey";if(typeof y[_]!="undefined"&&typeof y[E]!="undefined"&&Se(y[_],y[E])>0)throw new wt("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(x.reduce&&y.reduce!==!1){if(y.include_docs)throw new wt("{include_docs:true} is invalid for reduce");if(y.keys&&y.keys.length>1&&!y.group&&!y.group_level)throw new wt("Multi-key fetches for reduce views must use {group: true}")}for(let A of["group_level","limit","skip"]){let L=w(y[A]);if(L)throw L}}async function k(y,x,_){let E=[],A,L="GET",q;if(d("reduce",_,E),d("include_docs",_,E),d("attachments",_,E),d("limit",_,E),d("descending",_,E),d("group",_,E),d("group_level",_,E),d("skip",_,E),d("stale",_,E),d("conflicts",_,E),d("startkey",_,E,!0),d("start_key",_,E,!0),d("endkey",_,E,!0),d("end_key",_,E,!0),d("inclusive_end",_,E),d("key",_,E,!0),d("update_seq",_,E),E=E.join("&"),E=E===""?"":"?"+E,typeof _.keys!="undefined"){let O=`keys=${encodeURIComponent(JSON.stringify(_.keys))}`;O.length+E.length+1<=2e3?E+=(E[0]==="?"?"&":"?")+O:(L="POST",typeof x=="string"?A={keys:_.keys}:x.keys=_.keys)}if(typeof x=="string"){let P=Za(x),O=await y.fetch("_design/"+P[0]+"/_view/"+P[1]+E,{headers:new gn({"Content-Type":"application/json"}),method:L,body:JSON.stringify(A)});q=O.ok;let D=await O.json();if(!q)throw D.status=O.status,qn(D);for(let M of D.rows)if(M.value&&M.value.error&&M.value.error==="builtin_reduce_error")throw new Error(M.reason);return new Promise(function(M){M(D)}).then(u(_))}A=A||{};for(let P of Object.keys(x))Array.isArray(x[P])?A[P]=x[P]:A[P]=x[P].toString();let I=await y.fetch("_temp_view"+E,{headers:new gn({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(A)});q=I.ok;let T=await I.json();if(!q)throw T.status=I.status,qn(T);return new Promise(function(P){P(T)}).then(u(_))}function v(y,x,_){return new Promise(function(E,A){y._query(x,_,function(L,q){if(L)return A(L);E(q)})})}function g(y){return new Promise(function(x,_){y._viewCleanup(function(E,A){if(E)return _(E);x(A)})})}function h(y){return function(x){if(x.status===404)return y;throw x}}async function p(y,x,_){let E="_local/doc_"+y,A={_id:E,keys:[]},L=_.get(y),q=L[0],I=L[1];function T(){return Lm(I)?Promise.resolve(A):x.db.get(E).catch(h(A))}function P(J){return J.keys.length?x.db.allDocs({keys:J.keys,include_docs:!0}):Promise.resolve({rows:[]})}function O(J,U){let ee=[],le=new Set;for(let V of U.rows){let z=V.doc;if(z&&(ee.push(z),le.add(z._id),z._deleted=!q.has(z._id),!z._deleted)){let H=q.get(z._id);"value"in H&&(z.value=H.value)}}let ce=Ur(q);for(let V of ce)if(!le.has(V)){let z={_id:V},H=q.get(V);"value"in H&&(z.value=H.value),ee.push(z)}return J.keys=Qa(ce.concat(J.keys)),ee.push(J),ee}let D=await T(),M=await P(D);return O(D,M)}function b(y){return y.sourceDB.get("_local/purges").then(function(x){let _=x.purgeSeq;return y.db.get("_local/purgeSeq").then(function(E){return E._rev}).catch(h(void 0)).then(function(E){return y.db.put({_id:"_local/purgeSeq",_rev:E,purgeSeq:_})})}).catch(function(x){if(x.status!==404)throw x})}function S(y,x,_){var E="_local/lastSeq";return y.db.get(E).catch(h({_id:E,seq:0})).then(function(A){var L=Ur(x);return Promise.all(L.map(function(q){return p(q,y,x)})).then(function(q){var I=q.flat();return A.seq=_,I.push(A),y.db.bulkDocs({docs:I})}).then(()=>b(y))})}function R(y){let x=typeof y=="string"?y:y.name,_=nu[x];return _||(_=nu[x]=new Hn),_}async function B(y,x){return Hr(R(y),function(){return F(y,x)})()}async function F(y,x){let _,E,A;function L(V,z){let H={id:E._id,key:Tt(V)};typeof z!="undefined"&&z!==null&&(H.value=Tt(z)),_.push(H)}let q=e(y.mapFun,L),I=y.seq||0;function T(){return y.sourceDB.info().then(function(V){A=y.sourceDB.activeTasks.add({name:"view_indexing",total_items:V.update_seq-I})})}function P(V,z){return function(){return S(y,V,z)}}let O=0,D={view:y.name,indexed_docs:O};y.sourceDB.emit("indexing",D);let M=new Hn;async function J(){let V=await y.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:I,limit:x.changes_batch_size}),z=await U();return ee(V,z)}function U(){return y.db.get("_local/purgeSeq").then(function(V){return V.purgeSeq}).catch(h(-1)).then(function(V){return y.sourceDB.get("_local/purges").then(function(z){let H=z.purges.filter(function(pe,ae){return ae>V}).map(pe=>pe.docId),he=H.filter(function(pe,ae){return H.indexOf(pe)===ae});return Promise.all(he.map(function(pe){return y.sourceDB.get(pe).then(function(ae){return{docId:pe,doc:ae}}).catch(h({docId:pe}))}))}).catch(h([]))})}function ee(V,z){let H=V.results;if(!H.length&&!z.length)return;for(let ae of z)if(H.findIndex(function(Ke){return Ke.id===ae.docId})<0){let Ke={_id:ae.docId,doc:{_id:ae.docId,_deleted:1},changes:[]};ae.doc&&(Ke.doc=ae.doc,Ke.changes.push({rev:ae.doc._rev})),H.push(Ke)}let he=le(H);M.add(P(he,I)),O=O+H.length;let pe={view:y.name,last_seq:V.last_seq,results_count:H.length,indexed_docs:O};if(y.sourceDB.emit("indexing",pe),y.sourceDB.activeTasks.update(A,{completed_items:O}),!(H.length<x.changes_batch_size))return J()}function le(V){let z=new Map;for(let H of V){if(H.doc._id[0]!=="_"){_=[],E=H.doc,E._deleted||i(y.sourceDB,q,E),_.sort(o);let he=ce(_);z.set(H.doc._id,[he,H.changes])}I=H.seq}return z}function ce(V){let z=new Map,H;for(let he=0,pe=V.length;he<pe;he++){let ae=V[he],je=[ae.key,ae.id];he>0&&Se(ae.key,H)===0&&je.push(he),z.set(at(je),ae),H=ae.key}return z}try{await T(),await J(),await M.finish(),y.seq=I,y.sourceDB.activeTasks.remove(A)}catch(V){y.sourceDB.activeTasks.remove(A,V)}}function K(y,x,_){_.group_level===0&&delete _.group_level;let E=_.group||_.group_level,A=t(y.reduceFun),L=[],q=isNaN(_.group_level)?Number.POSITIVE_INFINITY:_.group_level;for(let I of x){let T=L[L.length-1],P=E?I.key:null;if(E&&Array.isArray(P)&&(P=P.slice(0,q)),T&&Se(T.groupKey,P)===0){T.keys.push([I.key,I.id]),T.values.push(I.value);continue}L.push({keys:[[I.key,I.id]],values:[I.value],groupKey:P})}x=[];for(let I of L){let T=a(y.sourceDB,A,I.keys,I.values,!1);if(T.error&&T.error instanceof yn)throw T.error;x.push({value:T.error?null:T.output,key:I.groupKey})}return{rows:s(x,_.limit,_.skip)}}function W(y,x){return Hr(R(y),function(){return Y(y,x)})()}async function Y(y,x){let _,E=y.reduceFun&&x.reduce!==!1,A=x.skip||0;typeof x.keys!="undefined"&&!x.keys.length&&(x.limit=0,delete x.keys);async function L(I){I.include_docs=!0;let T=await y.db.allDocs(I);return _=T.total_rows,T.rows.map(function(P){if("value"in P.doc&&typeof P.doc.value=="object"&&P.doc.value!==null){let D=Object.keys(P.doc.value).sort(),M=["id","key","value"];if(!(D<M||D>M))return P.doc.value}let O=Vc(P.doc._id);return{key:O[0],id:O[1],value:"value"in P.doc?P.doc.value:null}})}async function q(I){let T;if(E?T=K(y,I,x):typeof x.keys=="undefined"?T={total_rows:_,offset:A,rows:I}:T={total_rows:_,offset:A,rows:s(I,x.limit,x.skip)},x.update_seq&&(T.update_seq=y.seq),x.include_docs){let P=Qa(I.map(l)),O=await y.sourceDB.allDocs({keys:P,include_docs:!0,conflicts:x.conflicts,attachments:x.attachments,binary:x.binary}),D=new Map;for(let M of O.rows)D.set(M.id,M.doc);for(let M of I){let J=l(M),U=D.get(J);U&&(M.doc=U)}}return T}if(typeof x.keys!="undefined"){let T=x.keys.map(function(D){let M={startkey:at([D]),endkey:at([D,{}])};return x.update_seq&&(M.update_seq=!0),L(M)}),O=(await Promise.all(T)).flat();return q(O)}else{let I={descending:x.descending};x.update_seq&&(I.update_seq=!0);let T,P;if("start_key"in x&&(T=x.start_key),"startkey"in x&&(T=x.startkey),"end_key"in x&&(P=x.end_key),"endkey"in x&&(P=x.endkey),typeof T!="undefined"&&(I.startkey=x.descending?at([T,{}]):at([T])),typeof P!="undefined"){let D=x.inclusive_end!==!1;x.descending&&(D=!D),I.endkey=at(D?[P,{}]:[P])}if(typeof x.key!="undefined"){let D=at([x.key]),M=at([x.key,{}]);I.descending?(I.endkey=D,I.startkey=M):(I.startkey=D,I.endkey=M)}E||(typeof x.limit=="number"&&(I.limit=x.limit),I.skip=A);let O=await L(I);return q(O)}}async function Q(y){return(await y.fetch("_view_cleanup",{headers:new gn({"Content-Type":"application/json"}),method:"POST"})).json()}async function G(y){try{let x=await y.get("_local/"+r),_=new Map;for(let T of Object.keys(x.views)){let P=Za(T),O="_design/"+P[0],D=P[1],M=_.get(O);M||(M=new Set,_.set(O,M)),M.add(D)}let E={keys:Ur(_),include_docs:!0},A=await y.allDocs(E),L={};for(let T of A.rows){let P=T.key.substring(8);for(let O of _.get(T.key)){let D=P+"/"+O;x.views[D]||(D=O);let M=Object.keys(x.views[D]),J=T.doc&&T.doc.views&&T.doc.views[O];for(let U of M)L[U]=L[U]||J}}let I=Object.keys(L).filter(function(T){return!L[T]}).map(function(T){return Hr(R(T),function(){return new y.constructor(T,y.__opts).destroy()})()});return Promise.all(I).then(function(){return{ok:!0}})}catch(x){if(x.status===404)return{ok:!0};throw x}}async function Z(y,x,_){if(typeof y._query=="function")return v(y,x,_);if(St(y))return k(y,x,_);let E={changes_batch_size:y.__opts.view_update_changes_batch_size||Om};if(typeof x!="string")return C(_,x),ru.add(async function(){let A=await tu(y,"temp_view/temp_view",x.map,x.reduce,!0,r);return Yc(B(A,E).then(function(){return W(A,_)}),function(){return A.db.destroy()})}),ru.finish();{let A=x,L=Za(A),q=L[0],I=L[1],T=await y.get("_design/"+q);if(x=T.views&&T.views[I],!x)throw new vn(`ddoc ${T._id} has no view named ${I}`);n(T,I),C(_,x);let P=await tu(y,A,x.map,x.reduce,!1,r);return _.stale==="ok"||_.stale==="update_after"?(_.stale==="update_after"&&jn(function(){B(P,E)}),W(P,_)):(await B(P,E),W(P,_))}}function te(y,x,_){let E=this;typeof x=="function"&&(_=x,x={}),x=x?m(x):{},typeof y=="function"&&(y={map:y});let A=Promise.resolve().then(function(){return Z(E,y,x)});return Ja(A,_),A}let se=Zc(function(){let y=this;return typeof y._viewCleanup=="function"?g(y):St(y)?Q(y):G(y)});return{query:te,viewCleanup:se}}var Hn,nu,ru,Om,au,ou=j(()=>{Wa();Nr();qr();Ua();zn();jr();Xc();Hn=class{constructor(){this.promise=Promise.resolve()}add(e){return this.promise=this.promise.catch(()=>{}).then(()=>e()),this.promise}finish(){return this.promise}};nu={},ru=new Hn,Om=50;au=Mm});function bn(r,e){for(var t=r,n=0,i=e.length;n<i;n++){var a=e[n];if(t=t[a],!t)break}return t}function uu(r,e,t){for(var n=0,i=e.length;n<i-1;n++){var a=e[n];r=r[a]=r[a]||{}}r[e[i-1]]=t}function Vr(r,e){return r<e?-1:r>e?1:0}function At(r){for(var e=[],t="",n=0,i=r.length;n<i;n++){var a=r[n];n>0&&r[n-1]==="\\"&&(a==="$"||a===".")?t=t.substring(0,t.length-1)+a:a==="."?(e.push(t),t=""):t+=a}return e.push(t),e}function du(r){return Rm.indexOf(r)>-1}function He(r){return Object.keys(r)[0]}function Kr(r){return r[He(r)]}function Wn(r){var e={},t={$or:!0,$nor:!0};return r.forEach(function(n){Object.keys(n).forEach(function(i){var a=n[i];if(typeof a!="object"&&(a={$eq:a}),du(i))if(a instanceof Array){if(t[i]){t[i]=!1,e[i]=a;return}var o=[];e[i].forEach(function(l){Object.keys(a).forEach(function(c){var u=a[c],d=Math.max(Object.keys(l).length,Object.keys(u).length),f=Wn([l,u]);Object.keys(f).length<=d||o.push(f)})}),e[i]=o}else e[i]=Wn([a]);else{var s=e[i]=e[i]||{};Object.keys(a).forEach(function(l){var c=a[l];if(l==="$gt"||l==="$gte")return Fm(l,c,s);if(l==="$lt"||l==="$lte")return Bm(l,c,s);if(l==="$ne")return qm(c,s);if(l==="$eq")return Nm(c,s);if(l==="$regex")return jm(c,s);s[l]=c})}})}),e}function Fm(r,e,t){typeof t.$eq=="undefined"&&(typeof t.$gte!="undefined"?r==="$gte"?e>t.$gte&&(t.$gte=e):e>=t.$gte&&(delete t.$gte,t.$gt=e):typeof t.$gt!="undefined"?r==="$gte"?e>t.$gt&&(delete t.$gt,t.$gte=e):e>t.$gt&&(t.$gt=e):t[r]=e)}function Bm(r,e,t){typeof t.$eq=="undefined"&&(typeof t.$lte!="undefined"?r==="$lte"?e<t.$lte&&(t.$lte=e):e<=t.$lte&&(delete t.$lte,t.$lt=e):typeof t.$lt!="undefined"?r==="$lte"?e<t.$lt&&(delete t.$lt,t.$lte=e):e<t.$lt&&(t.$lt=e):t[r]=e)}function qm(r,e){"$ne"in e?e.$ne.push(r):e.$ne=[r]}function Nm(r,e){delete e.$gt,delete e.$gte,delete e.$lt,delete e.$lte,delete e.$ne,e.$eq=r}function jm(r,e){"$regex"in e?e.$regex.push(r):e.$regex=[r]}function fu(r){for(var e in r){if(Array.isArray(r))for(var t in r)r[t].$and&&(r[t]=Wn(r[t].$and));var n=r[e];typeof n=="object"&&fu(n)}return r}function hu(r,e){for(var t in r){t==="$and"&&(e=!0);var n=r[t];typeof n=="object"&&(e=hu(n,e))}return e}function Gr(r){var e=kt(r);hu(e,!1)&&(e=fu(e),"$and"in e&&(e=Wn(e.$and))),["$or","$nor"].forEach(function(o){o in e&&e[o].forEach(function(s){for(var l=Object.keys(s),c=0;c<l.length;c++){var u=l[c],d=s[u];(typeof d!="object"||d===null)&&(s[u]={$eq:d})}})}),"$not"in e&&(e.$not=Wn([e.$not]));for(var t=Object.keys(e),n=0;n<t.length;n++){var i=t[n],a=e[i];(typeof a!="object"||a===null)&&(a={$eq:a}),e[i]=a}return Ya(e),e}function Ya(r){Object.keys(r).forEach(function(e){var t=r[e];Array.isArray(t)?t.forEach(function(n){n&&typeof n=="object"&&Ya(n)}):e==="$ne"?r.$ne=[t]:e==="$regex"?r.$regex=[t]:t&&typeof t=="object"&&Ya(t)})}function zm(r){function e(t){return r.map(function(n){var i=He(n),a=At(i),o=bn(t,a);return o})}return function(t,n){var i=e(t.doc),a=e(n.doc),o=Se(i,a);return o!==0?o:Vr(t.doc._id,n.doc._id)}}function Xa(r,e,t){if(r=r.filter(function(o){return wn(o.doc,e.selector,t)}),e.sort){var n=zm(e.sort);r=r.sort(n),typeof e.sort[0]!="string"&&Kr(e.sort[0])==="desc"&&(r=r.reverse())}if("limit"in e||"skip"in e){var i=e.skip||0,a=("limit"in e?e.limit:r.length)+i;r=r.slice(i,a)}return r}function wn(r,e,t){return t.every(function(n){var i=e[n],a=At(n),o=bn(r,a);return du(n)?Hm(n,i,r):Wr(i,r,a,o)})}function Wr(r,e,t,n){return r?typeof r=="object"?Object.keys(r).every(function(i){var a=r[i];if(i.indexOf("$")===0)return su(i,e,a,t,n);var o=At(i);if(n===void 0&&typeof a!="object"&&o.length>0)return!1;var s=bn(n,o);return typeof a=="object"?Wr(a,e,t,s):su("$eq",e,a,o,s)}):r===n:!0}function Hm(r,e,t){return r==="$or"?e.some(function(n){return wn(t,n,Object.keys(n))}):r==="$not"?!wn(t,e,Object.keys(e)):!e.find(function(n){return wn(t,n,Object.keys(n))})}function su(r,e,t,n,i){if(!cu[r])throw new Error('unknown operator "'+r+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return cu[r](e,t,n,i)}function Un(r){return typeof r!="undefined"&&r!==null}function qt(r){return typeof r!="undefined"}function Um(r,e){if(typeof r!="number"||parseInt(r,10)!==r)return!1;var t=e[0],n=e[1];return r%t===n}function lu(r,e){return e.some(function(t){return r instanceof Array?r.some(function(n){return Se(t,n)===0}):Se(t,r)===0})}function Wm(r,e){return e.every(function(t){return r.some(function(n){return Se(t,n)===0})})}function Vm(r,e){return r.length===e}function Km(r,e){var t=new RegExp(e);return t.test(r)}function Gm(r,e){switch(e){case"null":return r===null;case"boolean":return typeof r=="boolean";case"number":return typeof r=="number";case"string":return typeof r=="string";case"array":return r instanceof Array;case"object":return{}.toString.call(r)==="[object Object]"}}function Vn(r,e){if(typeof e!="object")throw new Error("Selector error: expected a JSON object");e=Gr(e);var t={doc:r},n=Xa([t],{selector:e},Object.keys(e));return n&&n.length===1}var Rm,cu,pu=j(()=>{zn();Nr();Rm=["$or","$nor","$not"];cu={$elemMatch:function(r,e,t,n){return!Array.isArray(n)||n.length===0?!1:typeof n[0]=="object"&&n[0]!==null?n.some(function(i){return wn(i,e,Object.keys(e))}):n.some(function(i){return Wr(e,r,t,i)})},$allMatch:function(r,e,t,n){return!Array.isArray(n)||n.length===0?!1:typeof n[0]=="object"&&n[0]!==null?n.every(function(i){return wn(i,e,Object.keys(e))}):n.every(function(i){return Wr(e,r,t,i)})},$eq:function(r,e,t,n){return qt(n)&&Se(n,e)===0},$gte:function(r,e,t,n){return qt(n)&&Se(n,e)>=0},$gt:function(r,e,t,n){return qt(n)&&Se(n,e)>0},$lte:function(r,e,t,n){return qt(n)&&Se(n,e)<=0},$lt:function(r,e,t,n){return qt(n)&&Se(n,e)<0},$exists:function(r,e,t,n){return e?qt(n):!qt(n)},$mod:function(r,e,t,n){return Un(n)&&Um(n,e)},$ne:function(r,e,t,n){return e.every(function(i){return Se(n,i)!==0})},$in:function(r,e,t,n){return Un(n)&&lu(n,e)},$nin:function(r,e,t,n){return Un(n)&&!lu(n,e)},$size:function(r,e,t,n){return Un(n)&&Array.isArray(n)&&Vm(n,e)},$all:function(r,e,t,n){return Array.isArray(n)&&Wm(n,e)},$regex:function(r,e,t,n){return Un(n)&&typeof n=="string"&&e.every(function(i){return Km(n,i)})},$type:function(r,e,t,n){return Gm(n,e)}}});var Cu={};Ct(Cu,{default:()=>ny});function no(r){let e={};for(let t of r)Object.assign(e,t);return e}function Qm(r,e){let t={};for(let n of e){let i=At(n),a=bn(r,i);typeof a!="undefined"&&uu(t,i,a)}return t}function yu(r,e){for(let t=0,n=Math.min(r.length,e.length);t<n;t++)if(r[t]!==e[t])return!1;return!0}function Zm(r,e){return r.length>e.length?!1:yu(r,e)}function Ym(r,e){r=r.slice();for(let t of e){if(!r.length)break;let n=r.indexOf(t);if(n===-1)return!1;r.splice(n,1)}return!0}function Xm(r){let e={};for(let t of r)e[t]=!0;return e}function ev(r,e){let t=null,n=-1;for(let i of r){let a=e(i);a>n&&(n=a,t=i)}return t}function gu(r,e){if(r.length!==e.length)return!1;for(let t=0,n=r.length;t<n;t++)if(r[t]!==e[t])return!1;return!0}function tv(r){return Array.from(new Set(r))}function Kn(r){return function(...e){let t=e[e.length-1];if(typeof t=="function"){let n=t.bind(null,null),i=t.bind(null);r.apply(this,e.slice(0,-1)).then(n,i)}else return r.apply(this,e)}}function wu(r){r=kt(r),r.index||(r.index={});for(let e of["type","name","ddoc"])r.index[e]&&(r[e]=r.index[e],delete r.index[e]);return r.fields&&(r.index.fields=r.fields,delete r.fields),r.type||(r.type="json"),r}function Jr(r){return typeof r=="object"&&r!==null}function nv(r,e,t){let n="",i=e,a=!0;if(["$in","$nin","$or","$and","$mod","$nor","$all"].indexOf(r)!==-1&&(Array.isArray(e)||(n="Query operator "+r+" must be an array.")),["$not","$elemMatch","$allMatch"].indexOf(r)!==-1&&(!Array.isArray(e)&&Jr(e)||(n="Query operator "+r+" must be an object.")),r==="$mod"&&Array.isArray(e))if(e.length!==2)n="Query operator $mod must be in the format [divisor, remainder], where divisor and remainder are both integers.";else{let o=e[0],s=e[1];o===0&&(n="Query operator $mod's divisor cannot be 0, cannot divide by zero.",a=!1),(typeof o!="number"||parseInt(o,10)!==o)&&(n="Query operator $mod's divisor is not an integer.",i=o),parseInt(s,10)!==s&&(n="Query operator $mod's remainder is not an integer.",i=s)}if(r==="$exists"&&typeof e!="boolean"&&(n="Query operator $exists must be a boolean."),r==="$type"){let o=["null","boolean","number","string","array","object"],s='"'+o.slice(0,o.length-1).join('", "')+'", or "'+o[o.length-1]+'"';(typeof e!="string"||o.indexOf(e)==-1)&&(n="Query operator $type must be a string. Supported values: "+s+".")}if(r==="$size"&&parseInt(e,10)!==e&&(n="Query operator $size must be a integer."),r==="$regex"&&typeof e!="string"&&(t?n="Query operator $regex must be a string.":e instanceof RegExp||(n="Query operator $regex must be a string or an instance of a javascript regular expression.")),n){if(a){let o=i===null?" ":Array.isArray(i)?" array":" "+typeof i,s=Jr(i)?JSON.stringify(i,null,"	"):i;n+=" Received"+o+": "+s}throw new Error(n)}}function Qr(r,e){if(Array.isArray(r))for(let t of r)Jr(t)&&Qr(t,e);else for(let[t,n]of Object.entries(r))rv.indexOf(t)!==-1&&nv(t,n,e),av.indexOf(t)===-1&&iv.indexOf(t)===-1&&Jr(n)&&Qr(n,e)}async function Gn(r,e,t){t.body&&(t.body=JSON.stringify(t.body),t.headers=new gn({"Content-type":"application/json"}));let n=await r.fetch(e,t),i=await n.json();if(!n.ok){i.status=n.status;let a=Ha(i);throw qn(a)}return i}async function ov(r,e){return await Gn(r,"_index",{method:"POST",body:wu(e)})}async function sv(r,e){return Qr(e.selector,!0),await Gn(r,"_find",{method:"POST",body:e})}async function lv(r,e){return await Gn(r,"_explain",{method:"POST",body:e})}async function cv(r){return await Gn(r,"_index",{method:"GET"})}async function uv(r,e){let t=e.ddoc,n=e.type||"json",i=e.name;if(!t)throw new Error("you must provide an index's ddoc");if(!i)throw new Error("you must provide an index's name");let a="_index/"+[t,n,i].map(encodeURIComponent).join("/");return await Gn(r,a,{method:"DELETE"})}function bu(r,e){for(let t of e)if(r=r[t],r===void 0)return;return r}function dv(r,e,t){return function(n){if(t&&!Vn(n,t))return;let i=[];for(let a of r){let o=bu(n,At(a));if(o===void 0)return;i.push(o)}e(i)}}function fv(r,e,t){let n=At(r);return function(i){if(t&&!Vn(i,t))return;let a=bu(i,n);a!==void 0&&e(a)}}function hv(r,e,t){return function(n){t&&!Vn(n,t)||e(n[r])}}function pv(r,e,t){return function(n){if(t&&!Vn(n,t))return;let i=r.map(a=>n[a]);e(i)}}function gv(r){return r.every(e=>e.indexOf(".")===-1)}function mv(r,e,t){let n=gv(r),i=r.length===1;return n?i?hv(r[0],e,t):pv(r,e,t):i?fv(r[0],e,t):dv(r,e,t)}function vv(r,e){let t=Object.keys(r.fields),n=r.partial_filter_selector;return mv(t,e,n)}function yv(){throw new Error("reduce not supported")}function wv(r,e){let t=r.views[e];if(!t.map||!t.map.fields)throw new Error("ddoc "+r._id+" with view "+e+" doesn't have map.fields defined. maybe it wasn't created by this plugin?")}function ro(r){return r._customFindAbstractMapper?{query:function(t,n){let i=eo.query.bind(this);return r._customFindAbstractMapper.query.call(this,t,n,i)},viewCleanup:function(){let t=eo.viewCleanup.bind(this);return r._customFindAbstractMapper.viewCleanup.call(this,t)}}:eo}function bv(r){if(!Array.isArray(r))throw new Error("invalid sort json - should be an array");return r.map(function(e){if(typeof e=="string"){let t={};return t[e]="asc",t}else return e})}function _v(r){let e=[];return typeof r=="string"?e.push(r):e=r,e.map(function(t){return t.replace(xv,"")})}function xu(r){return r.fields=r.fields.map(function(e){if(typeof e=="string"){let t={};return t[e]="asc",t}return e}),r.partial_filter_selector&&(r.partial_filter_selector=Gr(r.partial_filter_selector)),r}function kv(r,e){return e.def.fields.map(t=>{let n=He(t);return bn(r,At(n))})}function Sv(r,e,t){let n=t.def.fields,i=0;for(let a of r){let o=kv(a.doc,t);if(n.length===1)o=o[0];else for(;o.length>e.length;)o.pop();if(Math.abs(Se(o,e))>0)break;++i}return i>0?r.slice(i):r}function Ev(r){let e=kt(r);return delete e.startkey,delete e.endkey,delete e.inclusive_start,delete e.inclusive_end,"endkey"in r&&(e.startkey=r.endkey),"startkey"in r&&(e.endkey=r.startkey),"inclusive_start"in r&&(e.inclusive_end=r.inclusive_start),"inclusive_end"in r&&(e.inclusive_start=r.inclusive_end),e}function Cv(r){let e=r.fields.filter(function(t){return Kr(t)==="asc"});if(e.length!==0&&e.length!==r.fields.length)throw new Error("unsupported mixed sorting")}function Tv(r,e){if(e.defaultUsed&&r.sort){let t=r.sort.filter(function(n){return Object.keys(n)[0]!=="_id"}).map(function(n){return Object.keys(n)[0]});if(t.length>0)throw new Error('Cannot sort on field(s) "'+t.join(",")+'" when using the default index')}e.defaultUsed}function Av(r){if(typeof r.selector!="object")throw new Error("you must provide a selector when you find()")}function Pv(r,e){let t=Object.keys(r),n=e?e.map(He):[],i;return t.length>=n.length?i=t:i=n,n.length===0?{fields:i}:(i=i.sort(function(a,o){let s=n.indexOf(a);s===-1&&(s=Number.MAX_VALUE);let l=n.indexOf(o);return l===-1&&(l=Number.MAX_VALUE),s<l?-1:s>l?1:0}),{fields:i,sortOrder:e.map(He)})}async function $v(r,e){e=wu(e);let t=kt(e.index);e.index=xu(e.index),Cv(e.index);let n;function i(){return n||(n=Nn(JSON.stringify(e)))}let a=e.name||"idx-"+i(),o=e.ddoc||"idx-"+i(),s="_design/"+o,l=!1,c=!1;function u(f){return f._rev&&f.language!=="query"&&(l=!0),f.language="query",f.views=f.views||{},c=!!f.views[a],c?!1:(f.views[a]={map:{fields:no(e.index.fields),partial_filter_selector:e.index.partial_filter_selector},reduce:"_count",options:{def:t}},f)}if(r.constructor.emit("debug",["find","creating index",s]),await mn(r,s,u),l)throw new Error('invalid language for ddoc with id "'+s+'" (should be "query")');let d=o+"/"+a;return await ro(r).query.call(r,d,{limit:0,reduce:!1}),{id:s,name:a,result:c?"exists":"created"}}async function _u(r){let e=await r.allDocs({startkey:"_design/",endkey:"_design/\uFFFF",include_docs:!0}),t={indexes:[{ddoc:null,name:"_all_docs",type:"special",def:{fields:[{_id:"asc"}]}}]};return t.indexes=vu(t.indexes,e.rows.filter(function(n){return n.doc.language==="query"}).map(function(n){return(n.doc.views!==void 0?Object.keys(n.doc.views):[]).map(function(a){let o=n.doc.views[a];return{ddoc:n.id,name:a,type:"json",def:xu(o.options.def)}})})),t.indexes.sort(function(n,i){return Vr(n.name,i.name)}),t.total_rows=t.indexes.length,t}function Dv(r,e){return r.def.fields.some(t=>He(t)===e)}function Ov(r,e){let t=r[e];return He(t)!=="$eq"}function ku(r,e){let t=e.def.fields.map(He);return r.slice().sort(function(n,i){let a=t.indexOf(n),o=t.indexOf(i);return a===-1&&(a=Number.MAX_VALUE),o===-1&&(o=Number.MAX_VALUE),Vr(a,o)})}function Lv(r,e,t){t=ku(t,r);let n=!1;for(let i=0,a=t.length;i<a;i++){let o=t[i];if(n||!Dv(r,o))return t.slice(i);i<a-1&&Ov(e,o)&&(n=!0)}return[]}function Mv(r){let e=[];for(let[t,n]of Object.entries(r))for(let i of Object.keys(n))i==="$ne"&&e.push(t);return e}function Rv(r,e,t,n){let i=vu(r,Lv(e,t,n),Mv(t));return ku(tv(i),e)}function Fv(r,e,t){if(e){let n=Zm(e,r),i=yu(t,r);return n&&i}return Ym(t,r)}function Su(r){return Bv.indexOf(r)===-1}function qv(r,e){let t=r[0],n=e[t];return typeof n=="undefined"?!0:!(Object.keys(n).length===1&&He(n)==="$ne")}function Nv(r,e,t,n){let i=r.def.fields.map(He);return Fv(i,e,t)?qv(i,n):!1}function jv(r,e,t,n){return n.filter(function(i){return Nv(i,t,e,r)})}function zv(r,e,t,n,i){let a=jv(r,e,t,n);if(a.length===0){if(i)throw{error:"no_usable_index",message:"There is no index available for this selector."};let l=n[0];return l.defaultUsed=!0,l}if(a.length===1&&!i)return a[0];let o=Xm(e);function s(l){let c=l.def.fields.map(He),u=0;for(let d of c)o[d]&&u++;return u}if(i){let l="_design/"+i[0],c=i.length===2?i[1]:!1,u=a.find(function(d){return!!(c&&d.ddoc===l&&c===d.name||d.ddoc===l)});if(!u)throw{error:"unknown_error",message:"Could not find that index or could not use that index for the query"};return u}return ev(a,s)}function Hv(r,e){switch(r){case"$eq":return{key:e};case"$lte":return{endkey:e};case"$gte":return{startkey:e};case"$lt":return{endkey:e,inclusive_end:!1};case"$gt":return{startkey:e,inclusive_start:!1}}return{startkey:Zr}}function Uv(r,e){let t=He(e.def.fields[0]),n=r[t]||{},i=[],a=Object.keys(n),o;for(let s of a){Su(s)&&i.push(t);let l=n[s],c=Hv(s,l);o?o=no([o,c]):o=c}return{queryOpts:o,inMemoryFields:i}}function Wv(r,e){switch(r){case"$eq":return{startkey:e,endkey:e};case"$lte":return{endkey:e};case"$gte":return{startkey:e};case"$lt":return{endkey:e,inclusive_end:!1};case"$gt":return{startkey:e,inclusive_start:!1}}}function Vv(r,e){let t=e.def.fields.map(He),n=[],i=[],a=[],o,s;function l(u){o!==!1&&i.push(Zr),s!==!1&&a.push(to),n=t.slice(u)}for(let u=0,d=t.length;u<d;u++){let f=t[u],m=r[f];if(!m||!Object.keys(m).length){l(u);break}else if(Object.keys(m).some(Su)){l(u);break}else if(u>0){let k="$gt"in m||"$gte"in m||"$lt"in m||"$lte"in m,v=Object.keys(r[t[u-1]]),g=gu(v,["$eq"]),h=gu(v,Object.keys(m));if(k&&!g&&!h){l(u);break}}let w=Object.keys(m),C=null;for(let k of w){let v=m[k],g=Wv(k,v);C?C=no([C,g]):C=g}i.push("startkey"in C?C.startkey:Zr),a.push("endkey"in C?C.endkey:to),"inclusive_start"in C&&(o=C.inclusive_start),"inclusive_end"in C&&(s=C.inclusive_end)}let c={startkey:i,endkey:a};return typeof o!="undefined"&&(c.inclusive_start=o),typeof s!="undefined"&&(c.inclusive_end=s),{queryOpts:c,inMemoryFields:n}}function Kv(r){return Object.keys(r).map(function(t){return r[t]}).some(function(t){return typeof t=="object"&&Object.keys(t).length===0})}function Gv(r){return{queryOpts:{startkey:null},inMemoryFields:[Object.keys(r)]}}function Jv(r,e){return e.defaultUsed?Gv(r,e):e.def.fields.length===1?Uv(r,e):Vv(r,e)}function Qv(r,e){let t=r.selector,n=r.sort;if(Kv(t))return Object.assign({},Iv,{index:e[0]});let i=Pv(t,n),a=i.fields,o=i.sortOrder,s=zv(t,a,o,e,r.use_index),l=Jv(t,s),c=l.queryOpts,u=l.inMemoryFields,d=Rv(u,s,t,a);return{queryOpts:c,index:s,inMemoryFields:d}}function Zv(r){return r.ddoc.substring(8)+"/"+r.name}async function Yv(r,e){let t=kt(e);t.descending?("endkey"in t&&typeof t.endkey!="string"&&(t.endkey=""),"startkey"in t&&typeof t.startkey!="string"&&(t.limit=0)):("startkey"in t&&typeof t.startkey!="string"&&(t.startkey=""),"endkey"in t&&typeof t.endkey!="string"&&(t.limit=0)),"key"in t&&typeof t.key!="string"&&(t.limit=0),t.limit>0&&t.indexes_count&&(t.original_limit=t.limit,t.limit+=t.indexes_count);let n=await r.allDocs(t);return n.rows=n.rows.filter(function(i){return!/^_design\//.test(i.id)}),t.original_limit&&(t.limit=t.original_limit),n.rows=n.rows.slice(0,t.limit),n}async function Xv(r,e,t){return t.name==="_all_docs"?Yv(r,e):ro(r).query.call(r,Zv(t),e)}async function Eu(r,e,t){e.selector&&(Qr(e.selector,!1),e.selector=Gr(e.selector)),e.sort&&(e.sort=bv(e.sort)),e.use_index&&(e.use_index=_v(e.use_index)),"limit"in e||(e.limit=25),Av(e);let n=await _u(r);r.constructor.emit("debug",["find","planning query",e]);let i=Qv(e,n.indexes);r.constructor.emit("debug",["find","query plan",i]);let a=i.index;Tv(e,a);let o=Object.assign({include_docs:!0,reduce:!1,indexes_count:n.total_rows},i.queryOpts);if("startkey"in o&&"endkey"in o&&Se(o.startkey,o.endkey)>0)return{docs:[]};if(e.sort&&typeof e.sort[0]!="string"&&Kr(e.sort[0])==="desc"&&(o.descending=!0,o=Ev(o)),i.inMemoryFields.length||(o.limit=e.limit,"skip"in e&&(o.skip=e.skip)),t)return Promise.resolve(i,o);let l=await Xv(r,o,a);o.inclusive_start===!1&&(l.rows=Sv(l.rows,o.startkey,a)),i.inMemoryFields.length&&(l.rows=Xa(l.rows,e,i.inMemoryFields));let c={docs:l.rows.map(function(u){let d=u.doc;return e.fields?Qm(d,e.fields):d})};return a.defaultUsed&&(c.warning="No matching index found, create an index to optimize query time."),c}async function ey(r,e){let t=await Eu(r,e,!0);return{dbname:r.name,index:t.index,selector:e.selector,range:{start_key:t.queryOpts.startkey,end_key:t.queryOpts.endkey},opts:{use_index:e.use_index||[],bookmark:"nil",limit:e.limit,skip:e.skip,sort:e.sort||{},fields:e.fields,conflicts:!1,r:[49]},limit:e.limit,skip:e.skip||0,fields:e.fields}}async function ty(r,e){if(!e.ddoc)throw new Error("you must supply an index.ddoc when deleting");if(!e.name)throw new Error("you must supply an index.name when deleting");let t=e.ddoc,n=e.name;function i(a){return Object.keys(a.views).length===1&&a.views[n]?{_id:t,_deleted:!0}:(delete a.views[n],a)}return await mn(r,t,i),await ro(r).viewCleanup.apply(r),{ok:!0}}var Jm,mu,vu,rv,iv,av,eo,xv,Zr,to,Iv,Bv,xn,ny,Tu=j(()=>{qr();Ua();ou();jr();Nr();pu();zn();Jm=(...r)=>r.flat(1/0),mu=(...r)=>{let e=[];for(let t of r)Array.isArray(t)?e=e.concat(mu(...t)):e.push(t);return e},vu=typeof Array.prototype.flat=="function"?Jm:mu;rv=["$all","$allMatch","$and","$elemMatch","$exists","$in","$mod","$nin","$nor","$not","$or","$regex","$size","$type"],iv=["$in","$nin","$mod","$all"],av=["$eq","$gt","$gte","$lt","$lte"];eo=au("indexes",vv,yv,wv);xv=/^_design\//;Zr=null,to={"\uFFFF":{}},Iv={queryOpts:{limit:0,startkey:to,endkey:Zr},inMemoryFields:[]};Bv=["$eq","$gt","$gte","$lt","$lte"];xn={};xn.createIndex=Kn(async function(r){if(typeof r!="object")throw new Error("you must provide an index to create");return(St(this)?ov:$v)(this,r)});xn.find=Kn(async function(r){if(typeof r!="object")throw new Error("you must provide search parameters to find()");return(St(this)?sv:Eu)(this,r)});xn.explain=Kn(async function(r){if(typeof r!="object")throw new Error("you must provide search parameters to explain()");return(St(this)?lv:ey)(this,r)});xn.getIndexes=Kn(async function(){return(St(this)?cv:_u)(this)});xn.deleteIndex=Kn(async function(r){if(typeof r!="object")throw new Error("you must provide an index to delete");return(St(this)?uv:ty)(this,r)});ny=xn});var $u={};Ct($u,{LocalDraftManager:()=>Et,initDraftDB:()=>io});var Au,Yr,Pu,io,Nt,Et,Jn=j(()=>{Au=require("obsidian");ze();Fe();Yr=null,Pu=async()=>{if(Yr)return Yr;try{let{default:r}=await Promise.resolve().then(()=>(za(),ja)),{default:e}=await Promise.resolve().then(()=>(Tu(),Cu));return r.plugin(e),Yr=new r("one2mp-local-drafts"),Yr}catch(r){return console.warn("PouchDB \u521D\u59CB\u5316\u5931\u8D25\uFF0C\u6539\u7528\u5185\u5B58\u8349\u7A3F\u5B58\u50A8",r),null}},io=async()=>{await Pu()},Nt=class{constructor(e){this.db=null;this.fallbackDrafts={};this.fallbackLoaded=!1;this.plugin=e}static getInstance(e){return Nt.instance||(Nt.instance=new Nt(e)),Nt.instance}static resetInstance(){Nt.instance=null}async ensureFallbackLoaded(){if(!this.fallbackLoaded)try{let e=await this.plugin.loadData(),t=e==null?void 0:e.local_drafts;t&&typeof t=="object"&&(this.fallbackDrafts=t)}catch(e){console.warn("\u52A0\u8F7D\u672C\u5730\u8349\u7A3F\u7F13\u5B58\u5931\u8D25",e)}finally{this.fallbackLoaded=!0}}async saveFallbackDrafts(){try{let e=await this.plugin.loadData();await this.plugin.saveData({...e!=null?e:{},local_drafts:this.fallbackDrafts})}catch(e){console.warn("\u4FDD\u5B58\u672C\u5730\u8349\u7A3F\u7F13\u5B58\u5931\u8D25",e)}}async getDb(){return this.db!==null?this.db:Au.Platform.isMobile?null:(this.db=await Pu(),this.db)}async getDrafOfActiveNote(){let e,t=this.plugin.settings.selectedMPAccount;if(t!==void 0&&t){let n=this.plugin.app.workspace.getActiveFile();n&&(e=await this.getDraft(t,n.path),e===void 0&&(e={accountName:t,notePath:n.path,title:n.basename,_id:t+n.path},await this.setDraft(e)),e.title.trim()===""&&(e.title=n.basename,await this.setDraft(e)))}return e}isActiveNoteDraft(e){let t=this.plugin.app.workspace.getActiveFile();return e===void 0&&t===null?!0:e!==void 0&&t?e.notePath===t.path:!1}async getDraft(e,t){let n=await this.getDb();return n?new Promise(i=>{n.get(e+t).then(a=>{i(a)}).catch(()=>{i(void 0)})}):(await this.ensureFallbackLoaded(),this.fallbackDrafts[e+t])}async setDraft(e){let t=i=>i instanceof Error?i:new Error(String(i)),n=await this.getDb();if(!n){if(await this.ensureFallbackLoaded(),!e.accountName||!e.notePath)throw new Error($("assets.invalid-draft"));e._id||(e._id=e.accountName+e.notePath);let i=this.fallbackDrafts[e._id];return i&&on(e,i)||(this.fallbackDrafts[e._id]={...e},await this.saveFallbackDrafts()),!0}return new Promise((i,a)=>{if(!e.accountName||!e.notePath)return a(new Error($("assets.invalid-draft")));e._id||(e._id=e.accountName+e.notePath),n.get(e._id).then(o=>{if(on(e,o)){i(!0);return}else return e._rev=o._rev,n.put(e).then(()=>i(!0)).catch(()=>{i(!1)});i(!1)}).catch(o=>{if(o.status===404)return n.put(e).then(()=>i(!0)).catch(s=>{console.error("Error creating new draft:",s),a(t(s))});console.error("Error checking existing draft:",o),a(t(o))})})}},Et=Nt;Et.instance=null});function Je(r){return ry.get(r)||"unknow error."}var ry,Iu=j(()=>{ry=new Map([[-1,"\u7CFB\u7EDF\u7E41\u5FD9\uFF0C\u6B64\u65F6\u8BF7\u5F00\u53D1\u8005\u7A0D\u5019\u518D\u8BD5"],[0,"\u8BF7\u6C42\u6210\u529F"],[40001,"\u83B7\u53D6 access_token \u65F6 AppSecret \u9519\u8BEF\uFF0C\u6216\u8005 access_token \u65E0\u6548\u3002\u8BF7\u5F00\u53D1\u8005\u8BA4\u771F\u6BD4\u5BF9 AppSecret \u7684\u6B63\u786E\u6027\uFF0C\u6216\u67E5\u770B\u662F\u5426\u6B63\u5728\u4E3A\u6070\u5F53\u7684\u516C\u4F17\u53F7\u8C03\u7528\u63A5\u53E3"],[40002,"\u4E0D\u5408\u6CD5\u7684\u51ED\u8BC1\u7C7B\u578B"],[40003,"\u4E0D\u5408\u6CD5\u7684 OpenID \uFF0C\u8BF7\u5F00\u53D1\u8005\u786E\u8BA4 OpenID \uFF08\u8BE5\u7528\u6237\uFF09\u662F\u5426\u5DF2\u5173\u6CE8\u516C\u4F17\u53F7\uFF0C\u6216\u662F\u5426\u662F\u5176\u4ED6\u516C\u4F17\u53F7\u7684 OpenID"],[40004,"\u4E0D\u5408\u6CD5\u7684\u5A92\u4F53\u6587\u4EF6\u7C7B\u578B"],[40005,"\u4E0D\u5408\u6CD5\u7684\u6587\u4EF6\u7C7B\u578B"],[40006,"\u4E0D\u5408\u6CD5\u7684\u6587\u4EF6\u5927\u5C0F"],[40007,"\u4E0D\u5408\u6CD5\u7684\u5A92\u4F53\u6587\u4EF6 id"],[40008,"\u4E0D\u5408\u6CD5\u7684\u6D88\u606F\u7C7B\u578B"],[40009,"\u4E0D\u5408\u6CD5\u7684\u56FE\u7247\u6587\u4EF6\u5927\u5C0F"],[40010,"\u4E0D\u5408\u6CD5\u7684\u8BED\u97F3\u6587\u4EF6\u5927\u5C0F"],[40011,"\u4E0D\u5408\u6CD5\u7684\u89C6\u9891\u6587\u4EF6\u5927\u5C0F"],[40012,"\u4E0D\u5408\u6CD5\u7684\u7F29\u7565\u56FE\u6587\u4EF6\u5927\u5C0F"],[40013,"\u4E0D\u5408\u6CD5\u7684 AppID \uFF0C\u8BF7\u5F00\u53D1\u8005\u68C0\u67E5 AppID \u7684\u6B63\u786E\u6027\uFF0C\u907F\u514D\u5F02\u5E38\u5B57\u7B26\uFF0C\u6CE8\u610F\u5927\u5C0F\u5199"],[40014,"\u4E0D\u5408\u6CD5\u7684 access_token \uFF0C\u8BF7\u5F00\u53D1\u8005\u8BA4\u771F\u6BD4\u5BF9 access_token \u7684\u6709\u6548\u6027\uFF08\u5982\u662F\u5426\u8FC7\u671F\uFF09\uFF0C\u6216\u67E5\u770B\u662F\u5426\u6B63\u5728\u4E3A\u6070\u5F53\u7684\u516C\u4F17\u53F7\u8C03\u7528\u63A5\u53E3"],[40015,"\u4E0D\u5408\u6CD5\u7684\u83DC\u5355\u7C7B\u578B"],[40016,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE\u4E2A\u6570"],[40017,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE\u7C7B\u578B"],[40018,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE\u540D\u5B57\u957F\u5EA6"],[40019,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE KEY \u957F\u5EA6"],[40020,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE URL \u957F\u5EA6"],[40021,"\u4E0D\u5408\u6CD5\u7684\u83DC\u5355\u7248\u672C\u53F7"],[40022,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u7EA7\u6570"],[40023,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE\u4E2A\u6570"],[40024,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE\u7C7B\u578B"],[40025,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE\u540D\u5B57\u957F\u5EA6"],[40026,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE KEY \u957F\u5EA6"],[40027,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE URL \u957F\u5EA6"],[40028,"\u4E0D\u5408\u6CD5\u7684\u81EA\u5B9A\u4E49\u83DC\u5355\u4F7F\u7528\u7528\u6237"],[40029,"\u65E0\u6548\u7684 oauth_code"],[40030,"\u4E0D\u5408\u6CD5\u7684 refresh_token"],[40031,"\u4E0D\u5408\u6CD5\u7684 openid \u5217\u8868"],[40032,"\u4E0D\u5408\u6CD5\u7684 openid \u5217\u8868\u957F\u5EA6"],[40033,"\u4E0D\u5408\u6CD5\u7684\u8BF7\u6C42\u5B57\u7B26\uFF0C\u4E0D\u80FD\u5305\u542B \\uxxxx \u683C\u5F0F\u7684\u5B57\u7B26"],[40035,"\u4E0D\u5408\u6CD5\u7684\u53C2\u6570"],[40038,"\u4E0D\u5408\u6CD5\u7684\u8BF7\u6C42\u683C\u5F0F"],[40039,"\u4E0D\u5408\u6CD5\u7684 URL \u957F\u5EA6"],[40048,"\u65E0\u6548\u7684url"],[40050,"\u4E0D\u5408\u6CD5\u7684\u5206\u7EC4 id"],[40051,"\u5206\u7EC4\u540D\u5B57\u4E0D\u5408\u6CD5"],[40060,"\u5220\u9664\u5355\u7BC7\u56FE\u6587\u65F6\uFF0C\u6307\u5B9A\u7684 article_idx \u4E0D\u5408\u6CD5"],[40117,"\u5206\u7EC4\u540D\u5B57\u4E0D\u5408\u6CD5"],[40118,"media_id \u5927\u5C0F\u4E0D\u5408\u6CD5"],[40119,"button \u7C7B\u578B\u9519\u8BEF"],[40120,"\u5B50 button \u7C7B\u578B\u9519\u8BEF"],[40121,"\u4E0D\u5408\u6CD5\u7684 media_id \u7C7B\u578B"],[40125,"\u65E0\u6548\u7684appsecret"],[40132,"\u5FAE\u4FE1\u53F7\u4E0D\u5408\u6CD5"],[40137,"\u4E0D\u652F\u6301\u7684\u56FE\u7247\u683C\u5F0F"],[40155,"\u8BF7\u52FF\u6DFB\u52A0\u5176\u4ED6\u516C\u4F17\u53F7\u7684\u4E3B\u9875\u94FE\u63A5"],[40163,"oauth_code\u5DF2\u4F7F\u7528"],[40164,"IP\u5730\u5740\u4E0D\u5728\u767D\u540D\u5355\u4E0A\uFF0C\u5C06ip\u6DFB\u52A0\u5230ip\u767D\u540D\u5355\u5217\u8868\u5373\u53EF"],[40227,"\u6807\u9898\u4E3A\u7A7A"],[40243,"AppSecret\u5DF2\u88AB\u51BB\u7ED3\uFF0C\u8BF7\u767B\u5F55MP\u89E3\u51BB\u540E\u518D\u6B21\u8C03\u7528"],[40249,"\u4E0D\u652F\u6301\u4E0B\u53D1\u8425\u9500/\u63A8\u5E7F\u7C7B\u7684\u6D88\u606F\u5185\u5BB9"],[40250,"\u4E0B\u53D1\u6D88\u606F\u5185\u5BB9\u4E0D\u89C4\u8303\uFF08\u5305\u542B\u7A7A\u503C\u7B49\uFF09\uFF0C\u5EFA\u8BAE\u68C0\u67E5\u5185\u5BB9\u89C4\u8303\u6027\u540E\u518D\u4E0B\u53D1"],[40251,"\u56E0\u5386\u53F2\u8FDD\u89C4\u5BFC\u81F4\u5E73\u53F0\u9650\u5236\u8D26\u53F7\u8C03\u7528\u4E0A\u9650\uFF0C\u5F53\u524D\u5DF2\u5230\u8FBE\u4E0B\u53D1\u4E0A\u9650"],[40252,"\u6B63\u5728\u8C03\u7528\u7684\u6A21\u677F\u4E0B\u53D1\u7684\u90E8\u5206\u5185\u5BB9\u5DF2\u8FDB\u5165\u5E73\u53F0\u5BA1\u6838\u6D41\u7A0B\uFF0C\u5728\u5BA1\u6838\u5B8C\u6210\u524D\uFF0C\u76F8\u5173\u5185\u5BB9\u6682\u65F6\u65E0\u6CD5\u4E0B\u53D1"],[41001,"\u7F3A\u5C11 access_token \u53C2\u6570"],[41002,"\u7F3A\u5C11 appid \u53C2\u6570"],[41003,"\u7F3A\u5C11 refresh_token \u53C2\u6570"],[41004,"\u7F3A\u5C11 secret \u53C2\u6570"],[41005,"\u7F3A\u5C11\u591A\u5A92\u4F53\u6587\u4EF6\u6570\u636E"],[41006,"\u7F3A\u5C11 media_id \u53C2\u6570"],[41007,"\u7F3A\u5C11\u5B50\u83DC\u5355\u6570\u636E"],[41008,"\u7F3A\u5C11 oauth code"],[41009,"\u7F3A\u5C11 openid"],[42001,"access_token \u8D85\u65F6\uFF0C\u8BF7\u68C0\u67E5 access_token \u7684\u6709\u6548\u671F\uFF0C\u8BF7\u53C2\u8003\u57FA\u7840\u652F\u6301 - \u83B7\u53D6 access_token \u4E2D\uFF0C\u5BF9 access_token \u7684\u8BE6\u7EC6\u673A\u5236\u8BF4\u660E"],[42002,"refresh_token \u8D85\u65F6"],[42003,"oauth_code \u8D85\u65F6"],[42007,"\u7528\u6237\u4FEE\u6539\u5FAE\u4FE1\u5BC6\u7801\uFF0C accesstoken \u548C refreshtoken \u5931\u6548\uFF0C\u9700\u8981\u91CD\u65B0\u6388\u6743"],[42010,"\u76F8\u540C media_id \u7FA4\u53D1\u8FC7\u5FEB\uFF0C\u8BF7\u91CD\u8BD5"],[43001,"\u9700\u8981 GET \u8BF7\u6C42"],[43002,"\u9700\u8981 POST \u8BF7\u6C42"],[43003,"\u9700\u8981 HTTPS \u8BF7\u6C42"],[43004,"\u9700\u8981\u63A5\u6536\u8005\u5173\u6CE8"],[43005,"\u9700\u8981\u597D\u53CB\u5173\u7CFB"],[43019,"\u9700\u8981\u5C06\u63A5\u6536\u8005\u4ECE\u9ED1\u540D\u5355\u4E2D\u79FB\u9664"],[43116,"\u8BE5\u6A21\u677F\u56E0\u6EE5\u7528\u88AB\u6EE5\u7528\u8FC7\u591A\uFF0C\u5DF2\u88AB\u9650\u5236\u4E0B\u53D1"],[44001,"\u591A\u5A92\u4F53\u6587\u4EF6\u4E3A\u7A7A"],[44002,"POST \u7684\u6570\u636E\u5305\u4E3A\u7A7A"],[44003,"\u56FE\u6587\u6D88\u606F\u5185\u5BB9\u4E3A\u7A7A"],[44004,"\u6587\u672C\u6D88\u606F\u5185\u5BB9\u4E3A\u7A7A"],[44008,"\u97F3\u9891\u5185\u5BB9\u5BA1\u6838\u5931\u8D25"],[44009,"\u56FE\u6587\u4E2D\u7684\u97F3\u9891\u5185\u5BB9\u5BA1\u6838\u5931\u8D25"],[45001,"\u591A\u5A92\u4F53\u6587\u4EF6\u5927\u5C0F\u8D85\u8FC7\u9650\u5236"],[45002,"\u6D88\u606F\u5185\u5BB9\u8D85\u8FC7\u9650\u5236"],[45003,"\u6807\u9898\u5B57\u6BB5\u8D85\u8FC7\u9650\u5236"],[45004,"\u63CF\u8FF0\u5B57\u6BB5\u8D85\u8FC7\u9650\u5236"],[45005,"\u94FE\u63A5\u5B57\u6BB5\u8D85\u8FC7\u9650\u5236"],[45006,"\u56FE\u7247\u94FE\u63A5\u5B57\u6BB5\u8D85\u8FC7\u9650\u5236"],[45007,"\u8BED\u97F3\u64AD\u653E\u65F6\u95F4\u8D85\u8FC7\u9650\u5236"],[45008,"\u56FE\u6587\u6D88\u606F\u8D85\u8FC7\u9650\u5236"],[45009,"\u63A5\u53E3\u8C03\u7528\u8D85\u8FC7\u9650\u5236"],[45010,"\u521B\u5EFA\u83DC\u5355\u4E2A\u6570\u8D85\u8FC7\u9650\u5236"],[45011,"API \u8C03\u7528\u592A\u9891\u7E41\uFF0C\u8BF7\u7A0D\u5019\u518D\u8BD5"],[45015,"\u56DE\u590D\u65F6\u95F4\u8D85\u8FC7\u9650\u5236"],[45016,"\u7CFB\u7EDF\u5206\u7EC4\uFF0C\u4E0D\u5141\u8BB8\u4FEE\u6539"],[45017,"\u5206\u7EC4\u540D\u5B57\u8FC7\u957F"],[45018,"\u5206\u7EC4\u6570\u91CF\u8D85\u8FC7\u4E0A\u9650"],[45047,"\u5BA2\u670D\u63A5\u53E3\u4E0B\u884C\u6761\u6570\u8D85\u8FC7\u4E0A\u9650"],[45064,"\u521B\u5EFA\u83DC\u5355\u5305\u542B\u672A\u5173\u8054\u7684\u5C0F\u7A0B\u5E8F"],[45065,"\u76F8\u540C clientmsgid \u5DF2\u5B58\u5728\u7FA4\u53D1\u8BB0\u5F55\uFF0C\u8FD4\u56DE\u6570\u636E\u4E2D\u5E26\u6709\u5DF2\u5B58\u5728\u7684\u7FA4\u53D1\u4EFB\u52A1\u7684 msgid"],[45066,"\u76F8\u540C clientmsgid \u91CD\u8BD5\u901F\u5EA6\u8FC7\u5FEB\uFF0C\u8BF7\u95F4\u96941\u5206\u949F\u91CD\u8BD5"],[45067,"clientmsgid \u957F\u5EA6\u8D85\u8FC7\u9650\u5236"],[45110,"\u4F5C\u8005\u5B57\u6570\u8D85\u51FA\u9650\u5236"],[46001,"\u4E0D\u5B58\u5728\u5A92\u4F53\u6570\u636E"],[46002,"\u4E0D\u5B58\u5728\u7684\u83DC\u5355\u7248\u672C"],[46003,"\u4E0D\u5B58\u5728\u7684\u83DC\u5355\u6570\u636E"],[46004,"\u4E0D\u5B58\u5728\u7684\u7528\u6237"],[47001,"\u89E3\u6790 JSON/XML \u5185\u5BB9\u9519\u8BEF"],[47003,"\u53C2\u6570\u503C\u4E0D\u7B26\u5408\u9650\u5236\u8981\u6C42\uFF0C\u8BE6\u60C5\u53EF\u53C2\u8003\u53C2\u6570\u503C\u5185\u5BB9\u9650\u5236\u8BF4\u660E"],[48001,"api \u529F\u80FD\u672A\u6388\u6743\uFF0C\u8BF7\u786E\u8BA4\u516C\u4F17\u53F7\u5DF2\u83B7\u5F97\u8BE5\u63A5\u53E3\uFF0C\u53EF\u4EE5\u5728\u516C\u4F17\u5E73\u53F0\u5B98\u7F51 - \u5F00\u53D1\u8005\u4E2D\u5FC3\u9875\u4E2D\u67E5\u770B\u63A5\u53E3\u6743\u9650"],[48002,"\u7C89\u4E1D\u62D2\u6536\u6D88\u606F\uFF08\u7C89\u4E1D\u5728\u516C\u4F17\u53F7\u9009\u9879\u4E2D\uFF0C\u5173\u95ED\u4E86 \u201C \u63A5\u6536\u6D88\u606F \u201D \uFF09"],[48004,"api \u63A5\u53E3\u88AB\u5C01\u7981\uFF0C\u8BF7\u767B\u5F55 mp.weixin.qq.com \u67E5\u770B\u8BE6\u60C5"],[48005,"api \u7981\u6B62\u5220\u9664\u88AB\u81EA\u52A8\u56DE\u590D\u548C\u81EA\u5B9A\u4E49\u83DC\u5355\u5F15\u7528\u7684\u7D20\u6750"],[48006,"api \u7981\u6B62\u6E05\u96F6\u8C03\u7528\u6B21\u6570\uFF0C\u56E0\u4E3A\u6E05\u96F6\u6B21\u6570\u8FBE\u5230\u4E0A\u9650"],[48008,"\u6CA1\u6709\u8BE5\u7C7B\u578B\u6D88\u606F\u7684\u53D1\u9001\u6743\u9650"],[48021,"\u81EA\u52A8\u4FDD\u5B58\u7684\u8349\u7A3F\u65E0\u6CD5\u9884\u89C8/\u53D1\u9001\uFF0C\u8BF7\u5148\u624B\u52A8\u4FDD\u5B58\u8349\u7A3F"],[50001,"\u7528\u6237\u672A\u6388\u6743\u8BE5 api"],[50002,"\u7528\u6237\u53D7\u9650\uFF0C\u53EF\u80FD\u662F\u8FDD\u89C4\u540E\u63A5\u53E3\u88AB\u5C01\u7981"],[50005,"\u7528\u6237\u672A\u5173\u6CE8\u516C\u4F17\u53F7"],[53500,"\u53D1\u5E03\u529F\u80FD\u88AB\u5C01\u7981"],[53501,"\u9891\u7E41\u8BF7\u6C42\u53D1\u5E03"],[53502,"Publish ID \u65E0\u6548"],[53600,"Article ID \u65E0\u6548"],[61451,"\u53C2\u6570\u9519\u8BEF (invalid parameter)"],[61452,"\u65E0\u6548\u5BA2\u670D\u8D26\u53F7 (invalid kf_account)"],[61453,"\u5BA2\u670D\u8D26\u53F7\u5DF2\u5B58\u5728 (kf_account exsited)"],[61454,"\u5BA2\u670D\u8D26\u53F7\u540D\u957F\u5EA6\u8D85\u8FC7\u9650\u5236 ( \u4EC5\u5141\u8BB8 10 \u4E2A\u82F1\u6587\u5B57\u7B26\uFF0C\u4E0D\u5305\u62EC @ \u53CA @ \u540E\u7684\u516C\u4F17\u53F7\u7684\u5FAE\u4FE1\u53F7 )(invalid   kf_acount length)"],[61455,"\u5BA2\u670D\u8D26\u53F7\u540D\u5305\u542B\u975E\u6CD5\u5B57\u7B26 ( \u4EC5\u5141\u8BB8\u82F1\u6587 + \u6570\u5B57 )(illegal character in     kf_account)"],[61456,"\u5BA2\u670D\u8D26\u53F7\u4E2A\u6570\u8D85\u8FC7\u9650\u5236 (10 \u4E2A\u5BA2\u670D\u8D26\u53F7 )(kf_account count exceeded)"],[61457,"\u65E0\u6548\u5934\u50CF\u6587\u4EF6\u7C7B\u578B (invalid   file type)"],[61450,"\u7CFB\u7EDF\u9519\u8BEF (system error)"],[61500,"\u65E5\u671F\u683C\u5F0F\u9519\u8BEF"],[63001,"\u90E8\u5206\u53C2\u6570\u4E3A\u7A7A"],[63002,"\u65E0\u6548\u7684\u7B7E\u540D"],[65301,"\u4E0D\u5B58\u5728\u6B64 menuid \u5BF9\u5E94\u7684\u4E2A\u6027\u5316\u83DC\u5355"],[65302,"\u6CA1\u6709\u76F8\u5E94\u7684\u7528\u6237"],[65303,"\u6CA1\u6709\u9ED8\u8BA4\u83DC\u5355\uFF0C\u4E0D\u80FD\u521B\u5EFA\u4E2A\u6027\u5316\u83DC\u5355"],[65304,"MatchRule \u4FE1\u606F\u4E3A\u7A7A"],[65305,"\u4E2A\u6027\u5316\u83DC\u5355\u6570\u91CF\u53D7\u9650"],[65306,"\u4E0D\u652F\u6301\u4E2A\u6027\u5316\u83DC\u5355\u7684\u8D26\u53F7"],[65307,"\u4E2A\u6027\u5316\u83DC\u5355\u4FE1\u606F\u4E3A\u7A7A"],[65308,"\u5305\u542B\u6CA1\u6709\u54CD\u5E94\u7C7B\u578B\u7684 button"],[65309,"\u4E2A\u6027\u5316\u83DC\u5355\u5F00\u5173\u5904\u4E8E\u5173\u95ED\u72B6\u6001"],[65310,"\u586B\u5199\u4E86\u7701\u4EFD\u6216\u57CE\u5E02\u4FE1\u606F\uFF0C\u56FD\u5BB6\u4FE1\u606F\u4E0D\u80FD\u4E3A\u7A7A"],[65311,"\u586B\u5199\u4E86\u57CE\u5E02\u4FE1\u606F\uFF0C\u7701\u4EFD\u4FE1\u606F\u4E0D\u80FD\u4E3A\u7A7A"],[65312,"\u4E0D\u5408\u6CD5\u7684\u56FD\u5BB6\u4FE1\u606F"],[65313,"\u4E0D\u5408\u6CD5\u7684\u7701\u4EFD\u4FE1\u606F"],[65314,"\u4E0D\u5408\u6CD5\u7684\u57CE\u5E02\u4FE1\u606F"],[65316,"\u8BE5\u516C\u4F17\u53F7\u7684\u83DC\u5355\u8BBE\u7F6E\u4E86\u8FC7\u591A\u7684\u57DF\u540D\u5916\u8DF3\uFF08\u6700\u591A\u8DF3\u8F6C\u5230 3 \u4E2A\u57DF\u540D\u7684\u94FE\u63A5\uFF09"],[65317,"\u4E0D\u5408\u6CD5\u7684 URL"],[87009,"\u65E0\u6548\u7684\u7B7E\u540D"],[89503,"\u6B64\u6B21\u8C03\u7528\u9700\u8981\u7BA1\u7406\u5458\u786E\u8BA4\uFF0C\u8BF7\u8010\u5FC3\u7B49\u5019"],[89506,"\u8BE5IP\u8C03\u7528\u6C42\u8BF7\u6C42\u5DF2\u88AB\u516C\u4F17\u53F7\u7BA1\u7406\u5458\u62D2\u7EDD\uFF0C\u8BF724\u5C0F\u65F6\u540E\u518D\u8BD5\uFF0C\u5EFA\u8BAE\u8C03\u7528\u524D\u4E0E\u7BA1\u7406\u5458\u6C9F\u901A\u786E\u8BA4"],[89507,"\u8BE5IP\u8C03\u7528\u6C42\u8BF7\u6C42\u5DF2\u88AB\u516C\u4F17\u53F7\u7BA1\u7406\u5458\u62D2\u7EDD\uFF0C\u8BF71\u5C0F\u65F6\u540E\u518D\u8BD5\uFF0C\u5EFA\u8BAE\u8C03\u7528\u524D\u4E0E\u7BA1\u7406\u5458\u6C9F\u901A\u786E\u8BA4"],[900100,"	POST \u6570\u636E\u53C2\u6570\u4E0D\u5408\u6CD5"],[900100,"	\u8FDC\u7AEF\u670D\u52A1\u4E0D\u53EF\u7528"],[900100,"	Ticket \u4E0D\u5408\u6CD5"],[900100,"	\u83B7\u53D6\u6447\u5468\u8FB9\u7528\u6237\u4FE1\u606F\u5931\u8D25"],[900100,"	\u83B7\u53D6\u5546\u6237\u4FE1\u606F\u5931\u8D25"],[900100,"	\u83B7\u53D6 OpenID \u5931\u8D25"],[900100,"	\u4E0A\u4F20\u6587\u4EF6\u7F3A\u5931"],[900100,"	\u4E0A\u4F20\u7D20\u6750\u7684\u6587\u4EF6\u7C7B\u578B\u4E0D\u5408\u6CD5"],[900100,"	\u4E0A\u4F20\u7D20\u6750\u7684\u6587\u4EF6\u5C3A\u5BF8\u4E0D\u5408\u6CD5"],[900101,"	\u4E0A\u4F20\u5931\u8D25"],[900102,"	\u8D26\u53F7\u4E0D\u5408\u6CD5"],[900102,"	\u5DF2\u6709\u8BBE\u5907\u6FC0\u6D3B\u7387\u4F4E\u4E8E 50% \uFF0C\u4E0D\u80FD\u65B0\u589E\u8BBE\u5907"],[900102,"	\u8BBE\u5907\u7533\u8BF7\u6570\u4E0D\u5408\u6CD5\uFF0C\u5FC5\u987B\u4E3A\u5927\u4E8E 0 \u7684\u6570\u5B57"],[900102,"	\u5DF2\u5B58\u5728\u5BA1\u6838\u4E2D\u7684\u8BBE\u5907 ID \u7533\u8BF7"],[900102,"	\u4E00\u6B21\u67E5\u8BE2\u8BBE\u5907 ID \u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7 50"],[900102,"	\u8BBE\u5907 ID \u4E0D\u5408\u6CD5"],[900102,"	\u9875\u9762 ID \u4E0D\u5408\u6CD5"],[900102,"	\u9875\u9762\u53C2\u6570\u4E0D\u5408\u6CD5"],[900102,"	\u4E00\u6B21\u5220\u9664\u9875\u9762 ID \u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7 10"],[900102,"	\u9875\u9762\u5DF2\u5E94\u7528\u5728\u8BBE\u5907\u4E2D\uFF0C\u8BF7\u5148\u89E3\u9664\u5E94\u7528\u5173\u7CFB\u518D\u5220\u9664"],[900103,"	\u4E00\u6B21\u67E5\u8BE2\u9875\u9762 ID \u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7 50"],[900103,"	\u65F6\u95F4\u533A\u95F4\u4E0D\u5408\u6CD5"],[900103,"	\u4FDD\u5B58\u8BBE\u5907\u4E0E\u9875\u9762\u7684\u7ED1\u5B9A\u5173\u7CFB\u53C2\u6570\u9519\u8BEF"],[900103,"	\u95E8\u5E97 ID \u4E0D\u5408\u6CD5"],[900103,"	\u8BBE\u5907\u5907\u6CE8\u4FE1\u606F\u8FC7\u957F"],[900103,"	\u8BBE\u5907\u7533\u8BF7\u53C2\u6570\u4E0D\u5408\u6CD5"],[900103,"	\u67E5\u8BE2\u8D77\u59CB\u503C begin \u4E0D\u5408\u6CD5"],[40114,"invalid index value"],[41039,"invalid content_source_url"],[45166,"invalid content"],[88e3,"without comment privilege"]])});function iy(r){let e=/\b(?:\d{1,3}\.){3}\d{1,3}\b/g,t=/(?:::ffff:)?([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::(?:ffff:)?(?:\d{1,3}\.){3}\d{1,3}/g,n=r.match(e)||[],i=r.match(t)||[];return{ipv4:n,ipv6:i}}var X,jt,ot,Qn=j(()=>{X=require("obsidian");Iu();Fe();jt=class{constructor(e){this.baseUrl="https://api.weixin.qq.com/cgi-bin";this.plugin=e}static getInstance(e){return jt.instance||(jt.instance=new jt(e)),jt.instance}static resetInstance(){jt.instance=null}async requestToken(){let e="https://wewrite.3thinking.cn/mp_token",t=this.plugin.getSelectedMPAccount();if(t===void 0)return new X.Notice($("wechat-api.select-an-wechat-mp-account-first")),null;let{appId:n,appSecret:i,doc_id:a}=t,o;a===void 0||!a?o={app_id:n,secret:i}:o={doc_id:a};try{let s=await(0,X.requestUrl)({method:"POST",url:e,headers:{"Content-Type":"application/json"},throw:!1,body:JSON.stringify(o)});if(s.status!==200)return new X.Notice(s.text,0),null;let{code:l,data:c}=s.json;if(l!==0){if(l==-2)return t.doc_id=void 0,this.plugin.saveSettings(),await this.requestToken();if(l==-10&&c.errcode===40164){let{ipv4:u}=iy(c.errmsg);u[0]!==void 0&&u[0]&&new X.Notice($("wechat-api.add-ip-address-ipv4-0-to-wechat-mp-ip-wh",[u[0]]))}return null}return c.last_token===void 0?(new X.Notice($("wechat-api.failed-to-get-wechat-access-token"),0),null):(t.access_token=c.last_token,t.doc_id=c.doc_id,t.expires_in=c.expiretime,t.lastRefreshTime=new Date().getTime(),this.plugin.saveSettings(),c.last_token)}catch(s){return console.error("Get wechat access token error:",s),new X.Notice($("wechat-api.failed-to-get-wechat-access-token"),0),null}}getHeaders(){return{"Accept-Encoding":"gzip, deflate, br","Accept-Language":"zh-CN,zh;q=0.9,en;q=0.8"}}async getAccessToken(e,t){let i={url:`${this.baseUrl}/token?grant_type=client_credential&appid=${e}&secret=${t}`,method:"GET",headers:this.getHeaders()},a=await(0,X.requestUrl)(i),{access_token:o,errcode:s,expires_in:l}=a.json;return o===void 0?(new X.Notice(Je(s),0),!1):{access_token:o,expires_in:l}}async getAccountBasicInfo(e){let t=e!=null?e:this.plugin.settings.selectedMPAccount;if(!t)return new X.Notice($("wechat-api.select-an-wechat-mp-account-first")),null;let n=await this.plugin.refreshAccessToken(t);if(!n)return null;let i=`${this.baseUrl}/account/getaccountbasicinfo?access_token=${n}`,a=await(0,X.requestUrl)({method:"GET",url:i,throw:!1}),{errcode:o}=a.json;return o!==void 0&&o!==0?(new X.Notice(Je(o),0),null):a.json}async getBatchMaterial(e,t,n=0,i=10){let a=await this.plugin.refreshAccessToken(e);if(!a)return!1;let o="https://api.weixin.qq.com/cgi-bin/material/batchget_material?access_token="+a;return await(await(0,X.requestUrl)({method:"POST",url:o,throw:!1,body:JSON.stringify({type:t,offset:n,count:i})})).json}async sendArticleToDraftBox(e,t){let n=await this.plugin.refreshAccessToken(this.plugin.settings.selectedMPAccount);if(!n)return!1;let i="https://api.weixin.qq.com/cgi-bin/draft/add?access_token="+n,a={articles:[{title:e.title,content:t,digest:e.digest,thumb_media_id:e.thumb_media_id,...e.content_source_url&&{content_source_url:e.content_source_url},...e.need_open_comment!==void 0&&{need_open_comment:e.need_open_comment},...e.only_fans_can_comment!==void 0&&{only_fans_can_comment:e.only_fans_can_comment},...e.pic_crop_235_1&&{pic_crop_235_1:e.pic_crop_235_1},...e.pic_crop_1_1&&{pic_crop_1_1:e.pic_crop_1_1},...e.author&&{author:e.author}}]},o=await(0,X.requestUrl)({method:"POST",url:i,throw:!1,body:JSON.stringify(a)}),{errcode:s,media_id:l}=o.json;return s!==void 0&&s!==0?(new X.Notice(Je(s),0),!1):(new X.Notice($("wechat-api.send-article-to-draft-box-successfully")),l)}async uploadXMaterial(e,t,n){if(n==="video"){if(e.size>1024*1024*10)return new X.Notice($("wechat-api.video-size-exceeds-10m")),!1}else if(n==="voice"){if(e.size>1024*1024*2)return new X.Notice($("wechat-api.voice-size-exceeds-2m")),!1}else if(e.size>1024*1024*10)return new X.Notice($("wechat-api.image-size-exceeds-10m")),!1;let i=await this.plugin.refreshAccessToken(this.plugin.settings.selectedMPAccount);if(!i)return!1;let a=`https://api.weixin.qq.com/cgi-bin/media/uploadimg?access_token=${i}`;n===void 0&&e.size>=1024*1024&&(n="image"),n!==void 0&&(a=`https://api.weixin.qq.com/cgi-bin/material/add_material?access_token=${i}&type=${n}`);let o=16,s="one2mpBoundary"+Array(o+1).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,o),l=[],c=JSON.stringify({title:"title of video",content:"content of video"});l.push(`--${s}\r
Content-Disposition: form-data; name="media"; filename="${t}"\r
Content-Type: "application/octet-stream"\r
\r
`);let u=await(0,X.getBlobArrayBuffer)(e);l.push(u),l.push(`\r
`),n==="video"&&l.push(`--${s}\r
Content-Disposition: form-data; name="description"\r
Content-Type: application/json\r
\r
`+c+`\r
`),l.push(`--${s}--\r
`);let d=new TextEncoder,f=l.map(v=>typeof v=="string"?d.encode(v):v),m=await new Blob(f).arrayBuffer(),w={method:"POST",url:a,contentType:`multipart/form-data; boundary=${s}`,body:m},k=await(await(0,X.requestUrl)(w)).json;return(k.errcode===void 0||k.errcode==0)&&this.plugin.messageService.sendMessage(n+"-item-updated",k),{url:k.url||"",media_id:k.media_id||"",errcode:k.errcode||0,errmsg:k.errmsg||""}}async uploadMaterial(e,t,n){if(n==="video"){if(e.size>1024*1024*10)return new X.Notice($("wechat-api.video-size-exceeds-10m")),!1}else if(n==="voice"){if(e.size>1024*1024*2)return new X.Notice($("wechat-api.voice-size-exceeds-2m")),!1}else if(e.size>1024*1024*10)return new X.Notice($("wechat-api.image-size-exceeds-10m")),!1;let i=await this.plugin.refreshAccessToken(this.plugin.settings.selectedMPAccount);if(!i)return!1;let a=`https://api.weixin.qq.com/cgi-bin/media/uploadimg?access_token=${i}`;n===void 0&&e.size>=1024*1024&&(n="image"),n!==void 0&&(a=`https://api.weixin.qq.com/cgi-bin/material/add_material?access_token=${i}&type=${n}`);let o={title:"title of video",introduction:"content of video"},s=await(0,X.getBlobArrayBuffer)(e),l=t,c="----WebKitFormBoundary"+Math.random().toString(36).substring(2),u=[];u.push(`--${c}\r
Content-Disposition: form-data; name="media"; filename="${l}"\r
Content-Type: application/octet-stream\r
\r
`),u.push(new Uint8Array(s)),u.push(`\r
`),n==="video"&&o&&u.push(`--${c}\r
Content-Disposition: form-data; name="description"\r
Content-Type: application/json\r
\r
`+JSON.stringify(o)+`\r
`),u.push(`--${c}--\r
`);let d=new TextEncoder,f=u.map(m=>typeof m=="string"?d.encode(m):m).reduce((m,w)=>{let C=new Uint8Array(m.length+w.length);return C.set(m),C.set(w,m.length),C},new Uint8Array(0));try{this.plugin.showSpinner($("wechat-api.uploading-material-type",[n||"unknown"]));let m=await(0,X.requestUrl)({url:a,method:"POST",headers:{"Content-Type":`multipart/form-data; boundary=${c}`},body:f.buffer});this.plugin.hideSpinner();let w=await m.json;return w.errcode!==void 0&&w.errcode!==0?(console.error("\u4E0A\u4F20\u7D20\u6750\u5931\u8D25:",w),new X.Notice(Je(w.errcode)||w.errmsg||"\u4E0A\u4F20\u7D20\u6750\u5931\u8D25",0),null):(this.plugin.messageService.sendMessage(n+"-item-updated",w),{url:w.url||"",media_id:w.media_id||"",errcode:w.errcode||0,errmsg:w.errmsg||""})}catch(m){throw this.plugin.hideSpinner(),console.error("\u4E0A\u4F20\u7D20\u6750\u65F6\u51FA\u9519:",m),m}}async getMaterialList(e,t,n=0,i=20){let a=await this.plugin.refreshAccessToken(e);if(!a)return!1;let o=`${this.baseUrl}/material/batchget_material?access_token=${a}`,s={type:t,offset:n,count:i},l={url:o,method:"POST",headers:this.getHeaders(),body:JSON.stringify(s)};return(await(0,X.requestUrl)(l)).json}async getMaterialById(e,t){if(!e)return!1;t===void 0&&(t=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(t);if(!n)return!1;let i=`${this.baseUrl}/material/get_material?access_token=${n}`,a={media_id:e},o={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)};return(await(0,X.requestUrl)(o)).json}async getBatchDraftList(e,t=0,n=20){let i=await this.plugin.refreshAccessToken(e);if(!i)return!1;let a=`${this.baseUrl}/draft/batchget?access_token=${i}`,o={offset:t,count:n,no_content:!1},s={url:a,method:"POST",headers:this.getHeaders(),body:JSON.stringify(o)};return(await(0,X.requestUrl)(s)).json}async getMaterialCounts(e){let t=await this.plugin.refreshAccessToken(e);if(!t)return!1;let i={url:`${this.baseUrl}/material/get_materialcount?access_token=${t}`,method:"GET",headers:this.getHeaders()},a=await(0,X.requestUrl)(i),{errcode:o}=a.json;return o!==void 0&&o!==0?(new X.Notice(Je(o),0),!1):a.json}async getDraftCount(e){let t=await this.plugin.refreshAccessToken(e);if(!t)return!1;let i={url:`${this.baseUrl}/draft/count?access_token=${t}`,method:"GET",headers:this.getHeaders()},a=await(0,X.requestUrl)(i),{errcode:o,total_count:s}=a.json;return o!==void 0&&o!==0?(new X.Notice(Je(o),0),!1):s}async getDraftById(e,t){let n=await this.plugin.refreshAccessToken(e);if(!n)return!1;let i=`${this.baseUrl}/draft/get?access_token=${n}`,a={media_id:t},o={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)},s=await(0,X.requestUrl)(o),{errcode:l,news_item:c}=s.json;return l!==void 0&&l!==0?(new X.Notice(Je(l),0),!1):c}async publishDraft(e,t=""){t||(t=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(t);if(!n)return!1;let i=`${this.baseUrl}/freepublish/submit?access_token=${n}`,a={media_id:e},o={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)},s=await(0,X.requestUrl)(o),{errcode:l,publish_id:c}=s.json;return l!==void 0&&l!==0?(new X.Notice(Je(l),0),!1):c}async deleteMedia(e,t=""){t||(t=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(t);if(!n)return!1;let i=`${this.baseUrl}/material/del_material?access_token=${n}`,a={media_id:e},o={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)},s=await(0,X.requestUrl)(o),{errcode:l}=s.json;return l!==void 0&&l!==0?(new X.Notice(Je(l),0),!1):!0}async deleteDraft(e,t=""){t||(t=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(t);if(!n)return!1;let i=`${this.baseUrl}/draft/delete?access_token=${n}`,a={media_id:e},o={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)},s=await(0,X.requestUrl)(o),{errcode:l}=s.json;return l!==void 0&&l!==0?(new X.Notice(Je(l),0),!1):!0}async massSendAll(e,t=""){t||(t=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(t);if(!n)return!1;let i=`${this.baseUrl}/message/mass/sendall?access_token=${n}`,a={filter:{is_to_all:!0},mpnews:{media_id:e},msgtype:"mpnews"},o={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)},s=await(0,X.requestUrl)(o),{errcode:l}=s.json;return l!==void 0&&l!==0?(new X.Notice(Je(l),0),!1):!0}async senfForPreview(e,t="",n=""){n||(n=this.plugin.settings.selectedMPAccount),t||(t=this.plugin.settings.previewer_wxname);let i=await this.plugin.refreshAccessToken(n);if(!i)return!1;let a=`${this.baseUrl}/message/mass/preview?access_token=${i}`,o={towxname:t,mpnews:{media_id:e},msgtype:"mpnews"},s={url:a,method:"POST",headers:this.getHeaders(),body:JSON.stringify(o)},l=await(0,X.requestUrl)(s),{errcode:c}=l.json;return c!==void 0&&c!==0?(new X.Notice(Je(c),0),!1):!0}},ot=jt;ot.instance=null});var Du=Pi((ao,oo)=>{(function(r){"use strict";let e=R(),t=B(),n=F(),i=K(),a={copyDefaultStyles:!0,imagePlaceholder:void 0,cacheBust:!1,useCredentials:!1,httpTimeout:3e4,styleCaching:"strict",corsImg:void 0},o={toSvg:d,toPng:m,toJpeg:w,toBlob:C,toPixelData:f,toCanvas:k,impl:{fontFaces:n,images:i,util:e,inliner:t,urlCache:[],options:{}}};typeof ao=="object"&&typeof oo=="object"?oo.exports=o:r.domtoimage=o;let s=(typeof Node=="undefined"?void 0:Node.ELEMENT_NODE)||1,l=(r===void 0?void 0:r.getComputedStyle)||(typeof window=="undefined"?void 0:window.getComputedStyle)||globalThis.getComputedStyle,c=(r===void 0?void 0:r.atob)||(typeof window=="undefined"?void 0:window.atob)||globalThis.atob;function u(_){return _===""||_==="none"}function d(_,E){let A=o.impl.util.getWindow(_);E||(E={}),v(E);let L=[];return Promise.resolve(_).then(q).then(D=>p(D,E,null,A)).then(b).then(S).then(P).then(O).then(I).then(T);function q(D){if(D.nodeType===s)return D;let M=D,J=D.parentNode,U=document.createElement("span");return M.replaceWith(U),U.append(D),L.push({parent:J,child:M,wrapper:U}),U}function I(D){for(;L.length>0;){let M=L.pop();M.parent.replaceChild(M.child,M.wrapper)}return D}function T(D){return o.impl.urlCache=[],x(),D}function P(D){if(E.bgcolor&&(D.style.backgroundColor=E.bgcolor),E.width&&(D.style.width=`${E.width}px`),E.height&&(D.style.height=`${E.height}px`),E.style)for(let J of Object.keys(E.style))D.style[J]=E.style[J];let M=null;return typeof E.onclone=="function"&&(M=E.onclone(D)),Promise.resolve(M).then(()=>D)}function O(D){let M=E.width||e.width(D),J=E.height||e.height(D);return Promise.resolve(D).then(U=>(U.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(U))).then(e.escapeXhtml).then(U=>{let ee=(e.isDimensionMissing(M)?' width="100%"':` width="${M}"`)+(e.isDimensionMissing(J)?' height="100%"':` height="${J}"`);return`<svg xmlns="http://www.w3.org/2000/svg"${(e.isDimensionMissing(M)?"":` width="${M}"`)+(e.isDimensionMissing(J)?"":` height="${J}"`)}><foreignObject${ee}>${U}</foreignObject></svg>`}).then(U=>`data:image/svg+xml;charset=utf-8,${U}`)}}function f(_,E){return g(_,E).then(A=>A.getContext("2d").getImageData(0,0,e.width(_),e.height(_)).data)}function m(_,E={}){return g(_,E).then(A=>A.toDataURL())}function w(_,E){return g(_,E).then(A=>A.toDataURL("image/jpeg",(E?E.quality:void 0)||1))}function C(_,E){return g(_,E).then(e.canvasToBlob)}function k(_,E){return g(_,E)}function v(_){_.copyDefaultStyles===void 0?o.impl.options.copyDefaultStyles=a.copyDefaultStyles:o.impl.options.copyDefaultStyles=_.copyDefaultStyles,_.imagePlaceholder===void 0?o.impl.options.imagePlaceholder=a.imagePlaceholder:o.impl.options.imagePlaceholder=_.imagePlaceholder,o.impl.options.cacheBust=_.cacheBust===void 0?a.cacheBust:_.cacheBust,o.impl.options.corsImg=_.corsImg===void 0?a.corsImg:_.corsImg,o.impl.options.useCredentials=_.useCredentials===void 0?a.useCredentials:_.useCredentials,o.impl.options.httpTimeout=_.httpTimeout===void 0?a.httpTimeout:_.httpTimeout,o.impl.options.styleCaching=_.styleCaching===void 0?a.styleCaching:_.styleCaching,o.impl.options.requestUrl=_.requestUrl,o.impl.options.type=_.type||"image/png",o.impl.options.quality=_.quality||1}function g(_,E){return E||(E={}),d(_,E).then(e.makeImage).then(L=>{let q=typeof E.scale=="number"?E.scale:1,I=A(_,q),T=I.getContext("2d");return T.msImageSmoothingEnabled=!1,T.imageSmoothingEnabled=!1,L&&(T.scale(q,q),T.drawImage(L,0,0)),I});function A(L,q){let I=E.width||e.width(L),T=E.height||e.height(L);e.isDimensionMissing(I)&&(I=e.isDimensionMissing(T)?300:T*2),e.isDimensionMissing(T)&&(T=I/2);let P=document.createElement("canvas");if(P.width=I*q,P.height=T*q,E.bgcolor){let O=P.getContext("2d");O.fillStyle=E.bgcolor,O.fillRect(0,0,P.width,P.height)}return P}}let h=null;function p(_,E,A,L){let q=E.filter;if(_===h||e.isHTMLScriptElement(_)||e.isHTMLStyleElement(_)||e.isHTMLLinkElement(_)||A!==null&&q&&!q(_))return Promise.resolve();return Promise.resolve(_).then(I).then(D=>P(D,T(_))).then(D=>O(D,_));function I(D){return e.isHTMLCanvasElement(D)?e.makeImage(D.toDataURL()):D.cloneNode(!1)}function T(D){return e.isElementHostForOpenShadowRoot(D)?D.shadowRoot:D}function P(D,M){let J=le(M),U=Promise.resolve();if(J.length>0){let ce=l(ee(M));for(let V of e.asArray(J))U=U.then(()=>p(V,E,ce,L).then(z=>{z&&D.append(z)}))}return U.then(()=>D);function ee(ce){return e.isShadowRoot(ce)?ce.host:ce}function le(ce){return e.isShadowSlotElement(ce)?ce.assignedNodes():ce.childNodes}}function O(D,M){if(!e.isElement(D)||e.isShadowSlotElement(M))return Promise.resolve(D);return Promise.resolve().then(J).then(U).then(ee).then(le).then(()=>D);function J(){V(M,D);function ce(z,H){H.font=z.font,H.fontFamily=z.fontFamily,H.fontFeatureSettings=z.fontFeatureSettings,H.fontKerning=z.fontKerning,H.fontSize=z.fontSize,H.fontStretch=z.fontStretch,H.fontStyle=z.fontStyle,H.fontVariant=z.fontVariant,H.fontVariantCaps=z.fontVariantCaps,H.fontVariantEastAsian=z.fontVariantEastAsian,H.fontVariantLigatures=z.fontVariantLigatures,H.fontVariantNumeric=z.fontVariantNumeric,H.fontVariationSettings=z.fontVariationSettings,H.fontWeight=z.fontWeight}function V(z,H){let he=l(z);if(he.cssText)H.style.cssText=he.cssText,ce(he,H.style);else{if(Q(E,z,he,A,H),A===null){for(let je of["inset-block","inset-block-start","inset-block-end"])H.style.removeProperty(je);for(let je of["left","right","top","bottom"])H.style.getPropertyValue(je)&&W(H.style,je,"0px")}let pe="-webkit-background-clip",ae=he.getPropertyValue(pe);ae&&ae!=="border-box"&&W(H.style,pe,ae)}}}function U(){}function ee(){e.isHTMLTextAreaElement(M)&&(D.value=M.value,D.textContent=M.value),e.isHTMLInputElement(M)&&D.setAttribute("value",M.value)}function le(){if(e.isSVGElement(D)&&(D.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.isSVGRectElement(D)))for(let ce of["width","height"]){let V=D.getAttribute(ce);V&&(D.style[ce]=V)}}}}function b(_){return Promise.resolve(_)}function S(_){return i.inlineAll(_).then(()=>_)}function R(){let _=0;return{escape:Zd,isDataUrl:z,canvasToBlob:pe,resolveUrl:ae,getAndEncode:Qd,uid:je,delay:Yd,asArray:Xd,escapeXhtml:ef,makeImage:Ke,width:tf,height:nf,getWindow:E,isElement:I,isElementHostForOpenShadowRoot:A,isShadowRoot:L,isInShadowRoot:q,isHTMLElement:P,isHTMLCanvasElement:T,isHTMLInputElement:D,isHTMLImageElement:O,isHTMLLinkElement:M,isHTMLScriptElement:J,isHTMLStyleElement:U,isHTMLTextAreaElement:ee,isShadowSlotElement:le,isSVGElement:ce,isSVGRectElement:V,isDimensionMissing:H};function E(N){let fe=N?N.ownerDocument:void 0;return(fe?fe.defaultView:void 0)||r||window}function A(N){return I(N)&&N.shadowRoot!==null}function L(N){return N instanceof E(N).ShadowRoot}function q(N){return N!==null&&Object.hasOwn(N,"getRootNode")&&L(N.getRootNode())}function I(N){return N instanceof E(N).Element}function T(N){return N instanceof E(N).HTMLCanvasElement}function P(N){return N instanceof E(N).HTMLElement}function O(N){return N instanceof E(N).HTMLImageElement}function D(N){return N instanceof E(N).HTMLInputElement}function M(N){return N instanceof E(N).HTMLLinkElement}function J(N){return N instanceof E(N).HTMLScriptElement}function U(N){return N instanceof E(N).HTMLStyleElement}function ee(N){return N instanceof E(N).HTMLTextAreaElement}function le(N){return q(N)&&N instanceof E(N).HTMLSlotElement}function ce(N){return N instanceof E(N).SVGElement}function V(N){return N instanceof E(N).SVGRectElement}function z(N){return N.search(/^(data:)/)!==-1}function H(N){return isNaN(N)||N<=0}function he(N){return new Promise(fe=>{let ue=c(N.toDataURL().split(",")[1]),ge=ue.length,we=new Uint8Array(ge);for(let Xe=0;Xe<ge;Xe++)we[Xe]=ue.charCodeAt(Xe);fe(new Blob([we],{type:o.impl.options.type}))})}function pe(N){return N.toBlob?new Promise(fe=>{N.toBlob(fe,o.impl.options.type,o.impl.options.quality)}):he(N)}function ae(N,fe){let ue=document.implementation.createHTMLDocument(),ge=ue.createElement("base");ue.head.append(ge);let we=ue.createElement("a");return ue.body.append(we),ge.href=fe,we.href=N,we.href}function je(){return`u${N()}${_++}`;function N(){return`0000${Math.trunc(Math.random()*36**4).toString(36)}`.slice(-4)}}function Ke(N){return N==="data:,"?Promise.resolve():new Promise((fe,ue)=>{let ge=new Image;o.impl.options.useCredentials&&(ge.crossOrigin="use-credentials"),ge.addEventListener("load",()=>{window&&window.requestAnimationFrame?window.requestAnimationFrame(()=>{fe(ge)}):fe(ge)}),ge.onerror=ue,ge.src=N})}function Qd(N){let fe=o.impl.urlCache.find(ue=>ue.url===N);return fe||(fe={url:N,promise:null},o.impl.urlCache.push(fe)),fe.promise===null&&(o.impl.options.cacheBust&&(N+=(/\?/.test(N)?"&":"?")+Date.now()),o.impl.options.requestUrl&&N.startsWith("http")&&!N.startsWith("http://localhost/")?fe.promise=o.impl.options.requestUrl({url:N,method:"GET"}).then(ue=>new Promise(ge=>{let we=new FileReader;we.addEventListener("load",Xe=>{ge(Xe.target.result)}),we.readAsDataURL(new Blob([ue.arrayBuffer],{type:ue.headers["content-type"]}))})).catch(ue=>(console.error("cannot fetch resource: "+N+", error: "+ue),"")):fe.promise=new Promise(ue=>{let ge=o.impl.options.httpTimeout,we=new XMLHttpRequest;if(we.addEventListener("readystatechange",rf),we.ontimeout=af,we.responseType="blob",we.timeout=ge,o.impl.options.useCredentials&&(we.withCredentials=!0),o.impl.options.corsImg&&N.indexOf("http")===0&&!N.includes(window.location.origin)){let Ge=(o.impl.options.corsImg.method||"GET").toUpperCase()==="POST"?"POST":"GET";we.open(Ge,(o.impl.options.corsImg.url||"").replace("#{cors}",N),!0);let Ti=!1,Ai=o.impl.options.corsImg.headers||{};for(let Pt of Object.keys(Ai))Ai[Pt].includes("application/json")&&(Ti=!0),we.setRequestHeader(Pt,Ai[Pt]);let Jt=of(o.impl.options.corsImg.data||"");for(let Pt of Object.keys(Jt))typeof Jt[Pt]=="string"&&(Jt[Pt]=Jt[Pt].replace("#{cors}",N));we.send(Ti?JSON.stringify(Jt):Jt)}else we.open("GET",N,!0),we.send();let Xe;if(o.impl.options.imagePlaceholder){let Ge=o.impl.options.imagePlaceholder.split(/,/);Ge&&Ge[1]&&(Xe=Ge[1])}function rf(){if(we.readyState!==4)return;if(we.status>=300){Xe?ue(Xe):Ci(`cannot fetch resource: ${N}, status: ${we.status}`);return}let Ge=new FileReader;Ge.onloadend=function(){ue(Ge.result)},Ge.readAsDataURL(we.response)}function af(){Xe?ue(Xe):Ci(`timeout of ${ge}ms occured while fetching resource: ${N}`)}function of(Ge){try{return JSON.parse(JSON.stringify(Ge))}catch(Ti){Ci("corsImg.data is missing or invalid")}}function Ci(Ge){console.error(Ge),ue("")}})),fe.promise}function Zd(N){return N.replaceAll(/([.*+?^${}()|[\]\/\\])/g,"\\$1")}function Yd(N){return function(fe){return new Promise(ue=>{setTimeout(()=>{ue(fe)},N)})}}function Xd(N){let fe=[],ue=N.length;for(let ge=0;ge<ue;ge++)fe.push(N[ge]);return fe}function ef(N){let fe=N.replaceAll("%","%25").replaceAll("#","%23").replaceAll(`
`,"%0A"),ue="";for(let ge=0;ge<fe.length;ge++){let we=fe.charCodeAt(ge);we<=31||we===127||(ue+=fe[ge])}return ue}function tf(N){let fe=Gt(N,"width");if(!isNaN(fe))return fe;let ue=Gt(N,"border-left-width"),ge=Gt(N,"border-right-width");return N.scrollWidth+ue+ge}function nf(N){let fe=Gt(N,"height");if(!isNaN(fe))return fe;let ue=Gt(N,"border-top-width"),ge=Gt(N,"border-bottom-width");return N.scrollHeight+ue+ge}function Gt(N,fe){if(N.nodeType===s){let ue=l(N).getPropertyValue(fe);if(ue.slice(-2)==="px")return ue=ue.slice(0,-2),Number.parseFloat(ue)}return Number.NaN}}function B(){let _=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:q,shouldProcess:E,impl:{readUrls:A,inline:L}};function E(I){return I.search(_)!==-1}function A(I){let T=[],P;for(;(P=_.exec(I))!==null;)T.push(P[1]);return T.filter(O=>!e.isDataUrl(O))}function L(I,T,P,O){return Promise.resolve(T).then(M=>P?e.resolveUrl(M,P):M).then(O||e.getAndEncode).then(M=>I.replace(D(T),`$1${M}$3`));function D(M){return new RegExp(`(url\\(['"]?)(${e.escape(M)})(['"]?\\))`,"g")}}function q(I,T,P){if(O())return Promise.resolve(I);return Promise.resolve(I).then(A).then(D=>{let M=Promise.resolve(I);for(let J of D)M=M.then(U=>L(U,J,T,P));return M});function O(){return!E(I)}}}function F(){return{resolveAll:_,impl:{readAll:E}};function _(){return E().then(A=>Promise.all(A.map(L=>L.resolve()))).then(A=>A.join(`
`))}function E(){return Promise.resolve(e.asArray(document.styleSheets)).then(L).then(A).then(I=>I.map(q));function A(I){return I.filter(T=>T.type===CSSRule.FONT_FACE_RULE).filter(T=>t.shouldProcess(T.style.getPropertyValue("src")))}function L(I){let T=[];for(let P of I)if(Object.hasOwn(Object.getPrototypeOf(P),"cssRules"))try{e.asArray(P.cssRules||[]).forEach(T.push.bind(T))}catch(O){console.error(`domtoimage: Error while reading CSS rules from ${P.href}`,O.toString())}return T}function q(I){return{resolve:function(){let P=(I.parentStyleSheet||{}).href;return t.inlineAll(I.cssText,P)},src(){return I.style.getPropertyValue("src")}}}}}function K(){return{inlineAll:E,impl:{newImage:_}};function _(A){return{inline:L};function L(q){return e.isDataUrl(A.src)?Promise.resolve():Promise.resolve(A.src).then(q||e.getAndEncode).then(I=>new Promise(T=>{A.addEventListener("load",T),A.onerror=T,A.src=I}))}}function E(A){if(!e.isElement(A))return Promise.resolve(A);return L(A).then(()=>e.isHTMLImageElement(A)?_(A).inline():Promise.all(e.asArray(A.childNodes).map(q=>E(q))));function L(q){let T=["background","background-image"].map(P=>{let O=q.style.getPropertyValue(P),D=q.style.getPropertyPriority(P);return O?t.inlineAll(O).then(M=>{W(q.style,P,M,D)}):Promise.resolve()});return Promise.all(T).then(()=>q)}}}function W(_,E,A,L){let q=["background-clip"].includes(E),I=L?" !important":"";Y(_,E,A,I),q&&Y(_,`-webkit-${E}`,A,I)}function Y(_,E,A,L){if(!E)return;let q=_.cssText&&!_.cssText.trim().endsWith(";")?"; ":"";_.cssText+=`${q}${E}: ${A}${L};`}function Q(_,E,A,L,q){let I=o.impl.options.copyDefaultStyles?se(_,E):{},T=q.style;for(let O of P(e.asArray(A))){let D=A.getPropertyValue(O),M=I[O],J=L?L.getPropertyValue(O):void 0;if(D!==M||L&&D!==J||/border/.test(O)){let U=A.getPropertyPriority(O);W(T,O,D,U)}}function P(O){for(let D of["counter-reset","counter-increment","counter-set"])O.indexOf(D)<0&&!u(A.getPropertyValue(D))&&O.push(D);return O}}let G=null,Z={},te=new Set(["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","DETAILS","DIALOG","DD","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","LI","MAIN","NAV","OL","P","PRE","SECTION","SVG","TABLE","UL","math","svg","BODY","HEAD","HTML"]);function se(_,E){let A=P(E),L=O(A);if(Z[L])return Z[L];let q=y(),I=D(q.document,A),T=M(q,I);return J(I),Z[L]=T,T;function P(U){let ee=[];do{if(U.nodeType===s){let le=U.tagName;if(ee.push(le),te.has(le))break}U=U.parentNode}while(U);return ee}function O(U){return _.styleCaching==="relaxed"?U.filter((ee,le,ce)=>le===0||le===ce.length-1).join(">"):U.join(">")}function D(U,ee){let le=U.body;do{let ce=ee.pop(),V=U.createElement(ce);le.append(V),le=V}while(ee.length>0);return le.textContent="\u200B",le}function M(U,ee){let le={},ce=U.getComputedStyle(ee);for(let V of e.asArray(ce))le[V]=V==="width"||V==="height"?"auto":ce.getPropertyValue(V);return le}function J(U){do{let ee=U.parentElement;ee!==null&&U.remove(),U=ee}while(U&&U.tagName!=="BODY")}}function y(){if(h)return h.contentWindow;let _=document.characterSet||"UTF-8",E=document.doctype,A=E?`<!DOCTYPE ${L(E.name)} ${L(E.publicId)} ${L(E.systemId)}`.trim()+">":"";return h=document.createElement("iframe"),h.id="domtoimage-sandbox-"+e.uid(),h.classList.add("one2mp-domtoimage-sandbox"),document.body.append(h),q(h,A,_,"domtoimage-sandbox");function L(I){return I?I.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;"):""}function q(I,T,P,O){let D=document.createElement("meta");D.setAttribute("charset",P);try{let M=document.implementation.createHTMLDocument(O);M.head.append(D);let J=new XMLSerializer,U=T+J.serializeToString(M.documentElement);return I.setAttribute("srcdoc",U),I.contentWindow}catch(M){}return I.contentDocument.head.append(D),I.contentDocument.title=O,I.contentWindow}}function x(){h&&(h.remove(),h=null),G&&clearTimeout(G),G=setTimeout(()=>{G=null,Z={}},20*1e3)}})(ao)});var ri,Ou,Ae,Zn=j(()=>{ri=require("obsidian"),Ou=Qt(Du()),Ae=class{constructor(e){this.app=e;this.rendering=!1;this.app=e}static getInstance(e){return Ae.instance||(Ae.instance=new Ae(e)),Ae.instance}async render(e,t,n){if(e===void 0||!e||!e.toLowerCase().endsWith(".md")||!t||!n)return;this.container=t,this.container.addClass("one2mp-markdown-render-container"),this.view=n,this.container.empty(),this.container.show(),this.rendering=!0,this.mdv&&this.mdv.unload(),this.previewEl=createDiv(),this.markdownBody=this.previewEl.createDiv(),this.mdv=new ri.MarkdownRenderChild(this.markdownBody),this.view.addChild(this.mdv),this.container.appendChild(this.previewEl);let i=await this.app.vault.adapter.read(e);await ri.MarkdownRenderer.render(this.app,i,this.markdownBody,e,this.mdv);try{let a=[];/^\s*>+\s*\[!/m.test(i)&&a.push(this.waitForSelector(this.previewEl,".callout",1e3)),/```\s*mermaid/i.test(i)&&a.push(this.waitForSelector(this.previewEl,".mermaid svg",5e3)),a.length&&await Promise.all(a)}catch(a){console.warn("\u90E8\u5206\u63D2\u4EF6\u6E32\u67D3\u8D85\u65F6\uFF08\u975E\u81F4\u547D\uFF09",a)}this.rendering=!1}queryElement(e,t){if(this.previewEl===void 0||!this.previewEl||this.rendering||this.previewEl===void 0||!this.previewEl)return null;let n=this.previewEl.querySelectorAll(t);return e<0||e>=n.length?null:n[e]}async domToImage(e,t={}){return await Ou.default.toPng(e,t)}waitForSelector(e,t,n=1e3){return new Promise(i=>{if(e.querySelector(t))return i();let a=new MutationObserver(()=>{e.querySelector(t)&&(a.disconnect(),i())});a.observe(e,{childList:!0,subtree:!0}),setTimeout(()=>{a.disconnect(),i()},n)})}}});function ii(r,e){let t="";return r&&r.includes("/")&&(t=r.split("/")[1]||""),t||(t=e||"png"),`image-${new Date().getTime()}.${t}`}function ay(r){if(!r)return;let t=r.split("?")[0].split("#")[0].match(/\.([a-zA-Z0-9]+)$/);return t?t[1].toLowerCase():void 0}function ai(r,e){e.forEach(t=>{t.status==="rejected"&&console.error(`${r}\u4E0A\u4F20\u5931\u8D25:`,t.reason)})}function oy(r){return new Promise((e,t)=>{let n=new Image;n.onload=()=>{let s=document.createElement("canvas"),l=window.devicePixelRatio||1;s.width=n.width*l,s.height=n.height*l;let c=s.getContext("2d");if(!c){t(new Error($("render.faild-canvas-context")));return}c.drawImage(n,0,0),s.toBlob(u=>{u?e(u):t(new Error($("render.failed-to-convert-canvas-to-blob")))},"image/png")},n.onerror=s=>{let l=s instanceof Error?s.message:typeof s=="string"?s:JSON.stringify(s);t(new Error(l))};let a=new TextEncoder().encode(r),o=String.fromCharCode.apply(null,a);n.src=`data:image/svg+xml;base64,${btoa(o)}`})}function so(r){let e=r.split(";base64,");console.debug("parts:",e);let t=e[0].split(":")[1];console.debug("contentType",t);let n=window.atob(e[1]);console.debug("raw:",n);let i=n.length,a=new Uint8Array(i);for(let o=0;o<i;++o)a[o]=n.charCodeAt(o);return console.debug("uInt8Array byteLength:",a.byteLength),new Blob([a],{type:t})}function sy(r){let e=r.toDataURL("image/png");return so(e)}async function Lu(r,e){let t=[];r.querySelectorAll("svg").forEach(a=>{t.push(a)});let n=t.map(async a=>{let o=et(a);o.length<1e4||await oy(o).then(async s=>{let l=await e.uploadMaterial(s,ii(s.type,"png"));if(l&&l.url){let c=document.createElement("img");c.src=l.url,a.replaceWith(c)}else console.error("upload svg failed.")})}),i=await Promise.allSettled(n);ai("SVG",i)}async function Mu(r,e){let t=[];r.querySelectorAll("canvas").forEach(a=>{t.push(a)});let n=t.map(async a=>{let o=sy(a),s=await e.uploadMaterial(o,ii(o.type,"png"));if(s&&s.url){let l=document.createElement("img");l.src=s.url,a.replaceWith(l)}else console.error("upload canvas failed.")}),i=await Promise.allSettled(n);ai("Canvas",i)}async function Ru(r,e,t){let n=[];r.querySelectorAll("img").forEach(o=>{n.push(o)});let i=n.map(async o=>{let s,l=ay(o.src);if(!o.src.includes("://mmbiz.qpic.cn/")){if(o.src.startsWith("data:image/"))s=so(o.src);else try{s=await In(o.src,t)}catch(c){console.error(`Error fetching image from ${o.src}:`,c);return}s!==void 0&&await e.uploadMaterial(s,ii(s.type,l)).then(c=>{c&&c.url?o.src=c.url:console.error("upload image failed.")})}}),a=await Promise.allSettled(i);ai("\u56FE\u7247",a)}function Fu(r,e){var o;let t=r.classList.contains("one2mp")?r:(o=r.querySelector(".one2mp"))!=null?o:r,n=t.querySelector("p"),i=e||n&&window.getComputedStyle(n).color||window.getComputedStyle(t).color||"#333333",a=s=>{s.setCssProps({color:i,opacity:"1",filter:"none"})};r.querySelectorAll(".one2mp-callout .callout-text").forEach(a),r.querySelectorAll(".one2mp-callout .callout-content p, .one2mp-callout .callout-content li").forEach(a)}async function Bu(r,e){let t=[];r.querySelectorAll("video").forEach(a=>{t.push(a)});let n=t.map(async a=>{let o;a.src.includes("://mmbiz.qpic.cn/")||(a.src.startsWith("data:image/")?o=so(a.src):o=await In(a.src),o!==void 0&&await e.uploadMaterial(o,ii(o.type),"video").then(async s=>{if(s){let l=await e.getMaterialById(s.media_id);a.src=l.url}else console.error("upload video failed.")}))}),i=await Promise.allSettled(n);ai("\u89C6\u9891",i)}var qu=j(()=>{Fe();ze()});var st,lo=j(()=>{st=class{constructor(){this.cardData=new Map}static getInstance(){return st.instance||(st.instance=new st),st.instance}setCardData(e,t){this.cardData.set(e,t)}cleanup(){this.cardData.clear()}restoreCard(e){for(let[t,n]of this.cardData.entries()){let a=`<section[^>]*\\sdata-id="${t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}"[^>]*>(.*?)<\\/section>`,o=new RegExp(a,"gs");if(!o.test(e)){console.warn("\u6CA1\u6709\u516C\u4F17\u53F7\u4FE1\u606F\uFF1A",t);continue}e=e.replace(o,n)}return e}}});function uo(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}function Wu(r){Wt=r}function me(r,e=""){let t=typeof r=="string"?r:r.source,n={replace:(i,a)=>{let o=typeof a=="string"?a:a.source;return o=o.replace(Ne.caret,"$1"),t=t.replace(i,o),n},getRegex:()=>new RegExp(t,e)};return n}function bt(r,e){if(e){if(Ne.escapeTest.test(r))return r.replace(Ne.escapeReplace,ju)}else if(Ne.escapeTestNoEncode.test(r))return r.replace(Ne.escapeReplaceNoEncode,ju);return r}function zu(r){try{r=encodeURI(r).replace(Ne.percentDecode,"%")}catch(e){return null}return r}function Hu(r,e){var a;let t=r.replace(Ne.findPipe,(o,s,l)=>{let c=!1,u=s;for(;--u>=0&&l[u]==="\\";)c=!c;return c?"|":" |"}),n=t.split(Ne.splitPipe),i=0;if(n[0].trim()||n.shift(),n.length>0&&!((a=n.at(-1))!=null&&a.trim())&&n.pop(),e)if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(Ne.slashPipe,"|");return n}function Xn(r,e,t){let n=r.length;if(n===0)return"";let i=0;for(;i<n&&r.charAt(n-i-1)===e;)i++;return r.slice(0,n-i)}function Ny(r,e){if(r.indexOf(e[1])===-1)return-1;let t=0;for(let n=0;n<r.length;n++)if(r[n]==="\\")n++;else if(r[n]===e[0])t++;else if(r[n]===e[1]&&(t--,t<0))return n;return-1}function Uu(r,e,t,n,i){let a=e.href,o=e.title||null,s=r[1].replace(i.other.outputLinkReplace,"$1");if(r[0].charAt(0)!=="!"){n.state.inLink=!0;let l={type:"link",raw:t,href:a,title:o,text:s,tokens:n.inlineTokens(s)};return n.state.inLink=!1,l}return{type:"image",raw:t,href:a,title:o,text:s}}function jy(r,e,t){let n=r.match(t.other.indentCodeCompensation);if(n===null)return e;let i=n[1];return e.split(`
`).map(a=>{let o=a.match(t.other.beginningSpace);if(o===null)return a;let[s]=o;return s.length>=i.length?a.slice(i.length):a}).join(`
`)}function ve(r,e){return Ut.parse(r,e)}var Wt,er,Ne,ly,cy,uy,nr,dy,Vu,Ku,fo,fy,ho,hy,py,li,po,gy,Gu,my,go,Nu,vy,yy,wy,by,Ju,xy,ci,mo,Qu,_y,Zu,ky,Sy,Ey,Yu,Cy,Ty,Xu,Ay,Py,$y,Iy,Dy,Oy,Ly,si,My,ed,td,Ry,vo,Fy,co,By,oi,Yn,qy,ju,_n,Ue,kn,tr,We,zt,Ht,Ut,d1,f1,h1,p1,g1,m1,v1,yo=j(()=>{Wt=uo();er={exec:()=>null};Ne={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:r=>new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}#`),htmlBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}<(?:[a-z].*>|!--)`,"i")},ly=/^(?:[ \t]*(?:\n|$))+/,cy=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,uy=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,nr=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,dy=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Vu=/(?:[*+-]|\d{1,9}[.)])/,Ku=me(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Vu).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),fo=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,fy=/^[^\n]+/,ho=/(?!\s*\])(?:\\.|[^\[\]\\])+/,hy=me(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",ho).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),py=me(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Vu).getRegex(),li="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",po=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,gy=me("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",po).replace("tag",li).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Gu=me(fo).replace("hr",nr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",li).getRegex(),my=me(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Gu).getRegex(),go={blockquote:my,code:cy,def:hy,fences:uy,heading:dy,hr:nr,html:gy,lheading:Ku,list:py,newline:ly,paragraph:Gu,table:er,text:fy},Nu=me("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",nr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",li).getRegex(),vy={...go,table:Nu,paragraph:me(fo).replace("hr",nr).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Nu).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",li).getRegex()},yy={...go,html:me(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",po).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:er,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:me(fo).replace("hr",nr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Ku).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},wy=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,by=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Ju=/^( {2,}|\\)\n(?!\s*$)/,xy=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,ci=/[\p{P}\p{S}]/u,mo=/[\s\p{P}\p{S}]/u,Qu=/[^\s\p{P}\p{S}]/u,_y=me(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,mo).getRegex(),Zu=/(?!~)[\p{P}\p{S}]/u,ky=/(?!~)[\s\p{P}\p{S}]/u,Sy=/(?:[^\s\p{P}\p{S}]|~)/u,Ey=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,Yu=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Cy=me(Yu,"u").replace(/punct/g,ci).getRegex(),Ty=me(Yu,"u").replace(/punct/g,Zu).getRegex(),Xu="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Ay=me(Xu,"gu").replace(/notPunctSpace/g,Qu).replace(/punctSpace/g,mo).replace(/punct/g,ci).getRegex(),Py=me(Xu,"gu").replace(/notPunctSpace/g,Sy).replace(/punctSpace/g,ky).replace(/punct/g,Zu).getRegex(),$y=me("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Qu).replace(/punctSpace/g,mo).replace(/punct/g,ci).getRegex(),Iy=me(/\\(punct)/,"gu").replace(/punct/g,ci).getRegex(),Dy=me(/^<(scheme:[^\s<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Oy=me(po).replace("(?:-->|$)","-->").getRegex(),Ly=me("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Oy).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),si=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,My=me(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",si).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ed=me(/^!?\[(label)\]\[(ref)\]/).replace("label",si).replace("ref",ho).getRegex(),td=me(/^!?\[(ref)\](?:\[\])?/).replace("ref",ho).getRegex(),Ry=me("reflink|nolink(?!\\()","g").replace("reflink",ed).replace("nolink",td).getRegex(),vo={_backpedal:er,anyPunctuation:Iy,autolink:Dy,blockSkip:Ey,br:Ju,code:by,del:er,emStrongLDelim:Cy,emStrongRDelimAst:Ay,emStrongRDelimUnd:$y,escape:wy,link:My,nolink:td,punctuation:_y,reflink:ed,reflinkSearch:Ry,tag:Ly,text:xy,url:er},Fy={...vo,link:me(/^!?\[(label)\]\((.*?)\)/).replace("label",si).getRegex(),reflink:me(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",si).getRegex()},co={...vo,emStrongRDelimAst:Py,emStrongLDelim:Ty,url:me(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},By={...co,br:me(Ju).replace("{2,}","*").getRegex(),text:me(co.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},oi={normal:go,gfm:vy,pedantic:yy},Yn={normal:vo,gfm:co,breaks:By,pedantic:Fy},qy={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ju=r=>qy[r];_n=class{constructor(e){be(this,"options");be(this,"rules");be(this,"lexer");this.options=e||Wt}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Xn(n,`
`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let n=t[0],i=jy(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:i}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){let i=Xn(n,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(n=i.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Xn(t[0],`
`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let n=Xn(t[0],`
`).split(`
`),i="",a="",o=[];for(;n.length>0;){let s=!1,l=[],c;for(c=0;c<n.length;c++)if(this.rules.other.blockquoteStart.test(n[c]))l.push(n[c]),s=!0;else if(!s)l.push(n[c]);else break;n=n.slice(c);let u=l.join(`
`),d=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${u}`:u,a=a?`${a}
${d}`:d;let f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,o,!0),this.lexer.state.top=f,n.length===0)break;let m=o.at(-1);if((m==null?void 0:m.type)==="code")break;if((m==null?void 0:m.type)==="blockquote"){let w=m,C=w.raw+`
`+n.join(`
`),k=this.blockquote(C);o[o.length-1]=k,i=i.substring(0,i.length-w.raw.length)+k.raw,a=a.substring(0,a.length-w.text.length)+k.text;break}else if((m==null?void 0:m.type)==="list"){let w=m,C=w.raw+`
`+n.join(`
`),k=this.list(C);o[o.length-1]=k,i=i.substring(0,i.length-m.raw.length)+k.raw,a=a.substring(0,a.length-w.raw.length)+k.raw,n=C.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:o,text:a}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),i=n.length>1,a={type:"list",raw:"",ordered:i,start:i?+n.slice(0,-1):"",loose:!1,items:[]};n=i?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=i?n:"[*+-]");let o=this.rules.other.listItemRegex(n),s=!1;for(;e;){let c=!1,u="",d="";if(!(t=o.exec(e))||this.rules.block.hr.test(e))break;u=t[0],e=e.substring(u.length);let f=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,g=>" ".repeat(3*g.length)),m=e.split(`
`,1)[0],w=!f.trim(),C=0;if(this.options.pedantic?(C=2,d=f.trimStart()):w?C=t[1].length+1:(C=t[2].search(this.rules.other.nonSpaceChar),C=C>4?1:C,d=f.slice(C),C+=t[1].length),w&&this.rules.other.blankLine.test(m)&&(u+=m+`
`,e=e.substring(m.length+1),c=!0),!c){let g=this.rules.other.nextBulletRegex(C),h=this.rules.other.hrRegex(C),p=this.rules.other.fencesBeginRegex(C),b=this.rules.other.headingBeginRegex(C),S=this.rules.other.htmlBeginRegex(C);for(;e;){let R=e.split(`
`,1)[0],B;if(m=R,this.options.pedantic?(m=m.replace(this.rules.other.listReplaceNesting,"  "),B=m):B=m.replace(this.rules.other.tabCharGlobal,"    "),p.test(m)||b.test(m)||S.test(m)||g.test(m)||h.test(m))break;if(B.search(this.rules.other.nonSpaceChar)>=C||!m.trim())d+=`
`+B.slice(C);else{if(w||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||p.test(f)||b.test(f)||h.test(f))break;d+=`
`+m}!w&&!m.trim()&&(w=!0),u+=R+`
`,e=e.substring(R.length+1),f=B.slice(C)}}a.loose||(s?a.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(s=!0));let k=null,v;this.options.gfm&&(k=this.rules.other.listIsTask.exec(d),k&&(v=k[0]!=="[ ] ",d=d.replace(this.rules.other.listReplaceTask,""))),a.items.push({type:"list_item",raw:u,task:!!k,checked:v,loose:!1,text:d,tokens:[]}),a.raw+=u}let l=a.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;a.raw=a.raw.trimEnd();for(let c=0;c<a.items.length;c++)if(this.lexer.state.top=!1,a.items[c].tokens=this.lexer.blockTokens(a.items[c].text,[]),!a.loose){let u=a.items[c].tokens.filter(f=>f.type==="space"),d=u.length>0&&u.some(f=>this.rules.other.anyLine.test(f.raw));a.loose=d}if(a.loose)for(let c=0;c<a.items.length;c++)a.items[c].loose=!0;return a}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",a=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:i,title:a}}}table(e){var s;let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let n=Hu(t[1]),i=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),a=(s=t[3])!=null&&s.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===i.length){for(let l of i)this.rules.other.tableAlignRight.test(l)?o.align.push("right"):this.rules.other.tableAlignCenter.test(l)?o.align.push("center"):this.rules.other.tableAlignLeft.test(l)?o.align.push("left"):o.align.push(null);for(let l=0;l<n.length;l++)o.header.push({text:n[l],tokens:this.lexer.inline(n[l]),header:!0,align:o.align[l]});for(let l of a)o.rows.push(Hu(l,o.header.length).map((c,u)=>({text:c,tokens:this.lexer.inline(c),header:!1,align:o.align[u]})));return o}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let o=Xn(n.slice(0,-1),"\\");if((n.length-o.length)%2===0)return}else{let o=Ny(t[2],"()");if(o>-1){let l=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let i=t[2],a="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(i);o&&(i=o[1],a=o[3])}else a=t[3]?t[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?i=i.slice(1):i=i.slice(1,-1)),Uu(t,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:a&&a.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let i=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),a=t[i.toLowerCase()];if(!a){let o=n[0].charAt(0);return{type:"text",raw:o,text:o}}return Uu(n,a,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let i=this.rules.inline.emStrongLDelim.exec(e);if(!i||i[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(i[1]||i[2]||"")||!n||this.rules.inline.punctuation.exec(n)){let o=[...i[0]].length-1,s,l,c=o,u=0,d=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,t=t.slice(-1*e.length+o);(i=d.exec(t))!=null;){if(s=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!s)continue;if(l=[...s].length,i[3]||i[4]){c+=l;continue}else if((i[5]||i[6])&&o%3&&!((o+l)%3)){u+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+u);let f=[...i[0]][0].length,m=e.slice(0,o+i.index+f+l);if(Math.min(o,l)%2){let C=m.slice(1,-1);return{type:"em",raw:m,text:C,tokens:this.lexer.inlineTokens(C)}}let w=m.slice(2,-2);return{type:"strong",raw:m,text:w,tokens:this.lexer.inlineTokens(w)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," "),i=this.rules.other.nonSpaceChar.test(n),a=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return i&&a&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let n,i;return t[2]==="@"?(n=t[1],i="mailto:"+n):(n=t[1],i=n),{type:"link",raw:t[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n,i;let t;if(t=this.rules.inline.url.exec(e)){let a,o;if(t[2]==="@")a=t[0],o="mailto:"+a;else{let s;do s=t[0],t[0]=(i=(n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])!=null?i:"";while(s!==t[0]);a=t[0],t[1]==="www."?o="http://"+t[0]:o=t[0]}return{type:"link",raw:t[0],text:a,href:o,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},Ue=class{constructor(e){be(this,"tokens");be(this,"options");be(this,"state");be(this,"tokenizer");be(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Wt,this.options.tokenizer=this.options.tokenizer||new _n,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:Ne,block:oi.normal,inline:Yn.normal};this.options.pedantic?(t.block=oi.pedantic,t.inline=Yn.pedantic):this.options.gfm&&(t.block=oi.gfm,this.options.breaks?t.inline=Yn.breaks:t.inline=Yn.gfm),this.tokenizer.rules=t}static get rules(){return{block:oi,inline:Yn}}static lex(e,t){return new Ue(t).lex(e)}static lexInline(e,t){return new Ue(t).inlineTokens(e)}lex(e){e=e.replace(Ne.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){let n=this.inlineQueue[t];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){var i,a,o;for(this.options.pedantic&&(e=e.replace(Ne.tabCharGlobal,"    ").replace(Ne.spaceLine,""));e;){let s;if((a=(i=this.options.extensions)==null?void 0:i.block)!=null&&a.some(c=>(s=c.call({lexer:this},e,t))?(e=e.substring(s.raw.length),t.push(s),!0):!1))continue;if(s=this.tokenizer.space(e)){e=e.substring(s.raw.length);let c=t.at(-1);s.raw.length===1&&c!==void 0?c.raw+=`
`:t.push(s);continue}if(s=this.tokenizer.code(e)){e=e.substring(s.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+s.raw,c.text+=`
`+s.text,this.inlineQueue.at(-1).src=c.text):t.push(s);continue}if(s=this.tokenizer.fences(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.heading(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.hr(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.blockquote(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.list(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.html(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.def(e)){e=e.substring(s.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+s.raw,c.text+=`
`+s.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title});continue}if(s=this.tokenizer.table(e)){e=e.substring(s.raw.length),t.push(s);continue}if(s=this.tokenizer.lheading(e)){e=e.substring(s.raw.length),t.push(s);continue}let l=e;if((o=this.options.extensions)!=null&&o.startBlock){let c=1/0,u=e.slice(1),d;this.options.extensions.startBlock.forEach(f=>{d=f.call({lexer:this},u),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(l=e.substring(0,c+1))}if(this.state.top&&(s=this.tokenizer.paragraph(l))){let c=t.at(-1);n&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=`
`+s.raw,c.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):t.push(s),n=l.length!==e.length,e=e.substring(s.raw.length);continue}if(s=this.tokenizer.text(e)){e=e.substring(s.raw.length);let c=t.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=`
`+s.raw,c.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):t.push(s);continue}if(e){let c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){var s,l,c;let n=e,i=null;if(this.tokens.links){let u=Object.keys(this.tokens.links);if(u.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(n))!=null;)u.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.blockSkip.exec(n))!=null;)n=n.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(n))!=null;)n=n.slice(0,i.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let a=!1,o="";for(;e;){a||(o=""),a=!1;let u;if((l=(s=this.options.extensions)==null?void 0:s.inline)!=null&&l.some(f=>(u=f.call({lexer:this},e,t))?(e=e.substring(u.raw.length),t.push(u),!0):!1))continue;if(u=this.tokenizer.escape(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.tag(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.link(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(u.raw.length);let f=t.at(-1);u.type==="text"&&(f==null?void 0:f.type)==="text"?(f.raw+=u.raw,f.text+=u.text):t.push(u);continue}if(u=this.tokenizer.emStrong(e,n,o)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.codespan(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.br(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.del(e)){e=e.substring(u.raw.length),t.push(u);continue}if(u=this.tokenizer.autolink(e)){e=e.substring(u.raw.length),t.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(e))){e=e.substring(u.raw.length),t.push(u);continue}let d=e;if((c=this.options.extensions)!=null&&c.startInline){let f=1/0,m=e.slice(1),w;this.options.extensions.startInline.forEach(C=>{w=C.call({lexer:this},m),typeof w=="number"&&w>=0&&(f=Math.min(f,w))}),f<1/0&&f>=0&&(d=e.substring(0,f+1))}if(u=this.tokenizer.inlineText(d)){e=e.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(o=u.raw.slice(-1)),a=!0;let f=t.at(-1);(f==null?void 0:f.type)==="text"?(f.raw+=u.raw,f.text+=u.text):t.push(u);continue}if(e){let f="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return t}},kn=class{constructor(e){be(this,"options");be(this,"parser");this.options=e||Wt}space(e){return""}code({text:e,lang:t,escaped:n}){var o;let i=(o=(t||"").match(Ne.notSpaceStart))==null?void 0:o[0],a=e.replace(Ne.endingNewline,"")+`
`;return i?'<pre><code class="language-'+bt(i)+'">'+(n?a:bt(a,!0))+`</code></pre>
`:"<pre><code>"+(n?a:bt(a,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,n=e.start,i="";for(let s=0;s<e.items.length;s++){let l=e.items[s];i+=this.listitem(l)}let a=t?"ol":"ul",o=t&&n!==1?' start="'+n+'"':"";return"<"+a+o+`>
`+i+"</"+a+`>
`}listitem(e){var n;let t="";if(e.task){let i=this.checkbox({checked:!!e.checked});e.loose?((n=e.tokens[0])==null?void 0:n.type)==="paragraph"?(e.tokens[0].text=i+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=i+" "+bt(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:i+" ",text:i+" ",escaped:!0}):t+=i+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let a=0;a<e.header.length;a++)n+=this.tablecell(e.header[a]);t+=this.tablerow({text:n});let i="";for(let a=0;a<e.rows.length;a++){let o=e.rows[a];n="";for(let s=0;s<o.length;s++)n+=this.tablecell(o[s]);i+=this.tablerow({text:n})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+i+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${bt(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let i=this.parser.parseInline(n),a=zu(e);if(a===null)return i;e=a;let o='<a href="'+e+'"';return t&&(o+=' title="'+bt(t)+'"'),o+=">"+i+"</a>",o}image({href:e,title:t,text:n}){let i=zu(e);if(i===null)return bt(n);e=i;let a=`<img src="${e}" alt="${n}"`;return t&&(a+=` title="${bt(t)}"`),a+=">",a}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:bt(e.text)}},tr=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},We=class{constructor(e){be(this,"options");be(this,"renderer");be(this,"textRenderer");this.options=e||Wt,this.options.renderer=this.options.renderer||new kn,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new tr}static parse(e,t){return new We(t).parse(e)}static parseInline(e,t){return new We(t).parseInline(e)}parse(e,t=!0){var i,a;let n="";for(let o=0;o<e.length;o++){let s=e[o];if((a=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&a[s.type]){let c=s,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){n+=u||"";continue}}let l=s;switch(l.type){case"space":{n+=this.renderer.space(l);continue}case"hr":{n+=this.renderer.hr(l);continue}case"heading":{n+=this.renderer.heading(l);continue}case"code":{n+=this.renderer.code(l);continue}case"table":{n+=this.renderer.table(l);continue}case"blockquote":{n+=this.renderer.blockquote(l);continue}case"list":{n+=this.renderer.list(l);continue}case"html":{n+=this.renderer.html(l);continue}case"paragraph":{n+=this.renderer.paragraph(l);continue}case"text":{let c=l,u=this.renderer.text(c);for(;o+1<e.length&&e[o+1].type==="text";)c=e[++o],u+=`
`+this.renderer.text(c);t?n+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):n+=u;continue}default:{let c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return n}parseInline(e,t=this.renderer){var i,a;let n="";for(let o=0;o<e.length;o++){let s=e[o];if((a=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&a[s.type]){let c=this.options.extensions.renderers[s.type].call({parser:this},s);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){n+=c||"";continue}}let l=s;switch(l.type){case"escape":{n+=t.text(l);break}case"html":{n+=t.html(l);break}case"link":{n+=t.link(l);break}case"image":{n+=t.image(l);break}case"strong":{n+=t.strong(l);break}case"em":{n+=t.em(l);break}case"codespan":{n+=t.codespan(l);break}case"br":{n+=t.br(l);break}case"del":{n+=t.del(l);break}case"text":{n+=t.text(l);break}default:{let c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return n}},zt=class{constructor(e){be(this,"options");be(this,"block");this.options=e||Wt}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Ue.lex:Ue.lexInline}provideParser(){return this.block?We.parse:We.parseInline}};be(zt,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));Ht=class{constructor(...e){be(this,"defaults",uo());be(this,"options",this.setOptions);be(this,"parse",this.parseMarkdown(!0));be(this,"parseInline",this.parseMarkdown(!1));be(this,"Parser",We);be(this,"Renderer",kn);be(this,"TextRenderer",tr);be(this,"Lexer",Ue);be(this,"Tokenizer",_n);be(this,"Hooks",zt);this.use(...e)}walkTokens(e,t){var i,a;let n=[];for(let o of e)switch(n=n.concat(t.call(this,o)),o.type){case"table":{let s=o;for(let l of s.header)n=n.concat(this.walkTokens(l.tokens,t));for(let l of s.rows)for(let c of l)n=n.concat(this.walkTokens(c.tokens,t));break}case"list":{let s=o;n=n.concat(this.walkTokens(s.items,t));break}default:{let s=o;(a=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&a[s.type]?this.defaults.extensions.childTokens[s.type].forEach(l=>{let c=s[l].flat(1/0);n=n.concat(this.walkTokens(c,t))}):s.tokens&&(n=n.concat(this.walkTokens(s.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{let i={...n};if(i.async=this.defaults.async||i.async||!1,n.extensions&&(n.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if("renderer"in a){let o=t.renderers[a.name];o?t.renderers[a.name]=function(...s){let l=a.renderer.apply(this,s);return l===!1&&(l=o.apply(this,s)),l}:t.renderers[a.name]=a.renderer}if("tokenizer"in a){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=t[a.level];o?o.unshift(a.tokenizer):t[a.level]=[a.tokenizer],a.start&&(a.level==="block"?t.startBlock?t.startBlock.push(a.start):t.startBlock=[a.start]:a.level==="inline"&&(t.startInline?t.startInline.push(a.start):t.startInline=[a.start]))}"childTokens"in a&&a.childTokens&&(t.childTokens[a.name]=a.childTokens)}),i.extensions=t),n.renderer){let a=this.defaults.renderer||new kn(this.defaults);for(let o in n.renderer){if(!(o in a))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let s=o,l=n.renderer[s],c=a[s];a[s]=(...u)=>{let d=l.apply(a,u);return d===!1&&(d=c.apply(a,u)),d||""}}i.renderer=a}if(n.tokenizer){let a=this.defaults.tokenizer||new _n(this.defaults);for(let o in n.tokenizer){if(!(o in a))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let s=o,l=n.tokenizer[s],c=a[s];a[s]=(...u)=>{let d=l.apply(a,u);return d===!1&&(d=c.apply(a,u)),d}}i.tokenizer=a}if(n.hooks){let a=this.defaults.hooks||new zt;for(let o in n.hooks){if(!(o in a))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let s=o,l=n.hooks[s],c=a[s];zt.passThroughHooks.has(o)?a[s]=u=>{if(this.defaults.async)return Promise.resolve(l.call(a,u)).then(f=>c.call(a,f));let d=l.call(a,u);return c.call(a,d)}:a[s]=(...u)=>{let d=l.apply(a,u);return d===!1&&(d=c.apply(a,u)),d}}i.hooks=a}if(n.walkTokens){let a=this.defaults.walkTokens,o=n.walkTokens;i.walkTokens=function(s){let l=[];return l.push(o.call(this,s)),a&&(l=l.concat(a.call(this,s))),l}}this.defaults={...this.defaults,...i}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Ue.lex(e,t!=null?t:this.defaults)}parser(e,t){return We.parse(e,t!=null?t:this.defaults)}parseMarkdown(e){return(n,i)=>{let a={...i},o={...this.defaults,...a},s=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&a.async===!1)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n=="undefined"||n===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));o.hooks&&(o.hooks.options=o,o.hooks.block=e);let l=o.hooks?o.hooks.provideLexer():e?Ue.lex:Ue.lexInline,c=o.hooks?o.hooks.provideParser():e?We.parse:We.parseInline;if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(n):n).then(u=>l(u,o)).then(u=>o.hooks?o.hooks.processAllTokens(u):u).then(u=>o.walkTokens?Promise.all(this.walkTokens(u,o.walkTokens)).then(()=>u):u).then(u=>c(u,o)).then(u=>o.hooks?o.hooks.postprocess(u):u).catch(s);try{o.hooks&&(n=o.hooks.preprocess(n));let u=l(n,o);o.hooks&&(u=o.hooks.processAllTokens(u)),o.walkTokens&&this.walkTokens(u,o.walkTokens);let d=c(u,o);return o.hooks&&(d=o.hooks.postprocess(d)),d}catch(u){return s(u)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let i="<p>An error occurred:</p><pre>"+bt(n.message+"",!0)+"</pre>";return t?Promise.resolve(i):i}if(t)return Promise.reject(n);throw n}}},Ut=new Ht;ve.options=ve.setOptions=function(r){return Ut.setOptions(r),ve.defaults=Ut.defaults,Wu(ve.defaults),ve};ve.getDefaults=uo;ve.defaults=Wt;ve.use=function(...r){return Ut.use(...r),ve.defaults=Ut.defaults,Wu(ve.defaults),ve};ve.walkTokens=function(r,e){return Ut.walkTokens(r,e)};ve.parseInline=Ut.parseInline;ve.Parser=We;ve.parser=We.parse;ve.Renderer=kn;ve.TextRenderer=tr;ve.Lexer=Ue;ve.lexer=Ue.lex;ve.Tokenizer=_n;ve.Hooks=zt;ve.parse=ve;d1=ve.options,f1=ve.setOptions,h1=ve.use,p1=ve.walkTokens,g1=ve.parseInline,m1=We.parse,v1=Ue.lex});var ke,Qe=j(()=>{ke=class{constructor(e,t,n){this.plugin=e,this.previewRender=t,this.marked=n}prepare(){return Promise.resolve()}postprocess(e){return Promise.resolve(e)}beforePublish(){return Promise.resolve()}cleanup(){return Promise.resolve()}isPluginInstlled(e){let t=this.plugin.app.plugins.plugins;return Object.prototype.hasOwnProperty.call(t,e)}}});function ad(r){if(!r)return"";let e=/\[!(.*?)\]/,t=r.match(e);return t?t[1].trim():""}function Eo(r){return r?r.split(/\r?\n/).map(e=>e.replace(/^>\s?/,"")).join(`
`).trim():""}function Ky(r,e){let t=r.charAt(0).toUpperCase()+r.slice(1).toLowerCase(),n=e.indexOf("]")+1;(e.indexOf("]-")>0||e.indexOf("]+")>0)&&(n=n+1);let i=e.indexOf(`
`);if(i===-1&&(i=e.length),n>=i)return t;let a=e.slice(n,i).trim();return a!==""&&(t=a),t}function Gy(r){return r&&r.replace(/<p([^>]*)>([\s\S]*?)<\/p>/g,'<p$1><span class="callout-text">$2</span></p>')}var zy,wo,Hy,Uy,bo,xo,_o,ko,So,nd,Wy,Vy,rd,id,ui,od=j(()=>{Qe();zy='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-pencil"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"></path><path d="m15 5 4 4"></path></svg>',wo='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-clipboard-list"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><path d="M12 11h4"></path><path d="M12 16h4"></path><path d="M8 11h.01"></path><path d="M8 16h.01"></path></svg>',Hy='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg>',Uy='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check-circle-2"><circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path></svg>',bo='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>',xo='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg>',_o='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-help-circle"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><path d="M12 17h.01"></path></svg>',ko='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg>',So='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>',nd='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-zap"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>',Wy='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-bug"><path d="m8 2 1.88 1.88"></path><path d="M14.12 3.88 16 2"></path><path d="M9 7.13v-1a3.003 3.003 0 1 1 6 0v1"></path><path d="M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6"></path><path d="M12 20v-9"></path><path d="M6.53 9C4.6 8.8 3 7.1 3 5"></path><path d="M6 13H2"></path><path d="M3 21c0-2.1 1.7-3.9 3.8-4"></path><path d="M20.97 5c0 2.1-1.6 3.8-3.5 4"></path><path d="M22 13h-4"></path><path d="M17.2 17c2.1.1 3.8 1.9 3.8 4"></path></svg>',Vy='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>',rd='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-quote"><path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z"></path><path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z"></path></svg>',id=new Map(Object.entries({note:{icon:zy},abstract:{icon:wo},summary:{icon:wo},tldr:{icon:wo},info:{icon:Hy},todo:{icon:Uy},tip:{icon:bo},hint:{icon:bo},important:{icon:bo},success:{icon:xo},check:{icon:xo},done:{icon:xo},question:{icon:_o},help:{icon:_o},faq:{icon:_o},warning:{icon:ko},caution:{icon:ko},attention:{icon:ko},failure:{icon:So},fail:{icon:So},missing:{icon:So},danger:{icon:nd},error:{icon:nd},bug:{icon:Wy},example:{icon:Vy},quote:{icon:rd},cite:{icon:rd}}));ui=class extends ke{prepare(){return this.marked||console.error("marked is not ready"),Promise.resolve()}async rendererBlockquote(e){let t=e.text||Eo(e.raw||"");return`<blockquote dir="auto"><span class="icon-pin"></span><div class="blockquote-inner">${(await this.marked.parseInline(t)).replace(/\n/gm,"<br>").trim()}</div></blockquote>`}async rendererCallout(e){let t=e.text||Eo(e.raw||""),n=ad(t);if(!n)return this.rendererBlockquote(e);let i=n.toLowerCase(),a=Ky(n,t),o=t.indexOf(`
`),s="";if(o>0){let u=t.slice(o+1).trim();u&&(s=await this.marked.parse(u)),!s&&u&&(s=(await this.marked.parseInline(u)).replace(/\n/gm,"<br>")),s=Gy(s)}let l=id.get(i)||id.get("note"),c=l?l.icon:"";return`<section class="one2mp-callout" data-callout="${i}"><div class="callout-title"><div class="callout-icon">${c}</div><div class="callout-title-inner">${a}</div></div><div class="callout-content">${s}</div></section>`}markedExtension(){return{async:!0,walkTokens:async e=>{if(e.type!=="blockquote")return;let t=e,n=t.raw||"",i=Eo(n);!t.text&&i&&(t.text=i),ad(i||t.text)?e.html=await this.rendererCallout(t):e.html=await this.rendererBlockquote(t)},extensions:[{name:"blockquote",level:"block",renderer:e=>e.html}]}}}});var Jy,di,Qy,rr,Zy,Yy,sd,ld,cd=j(()=>{Jy=r=>r&&r.replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"),di=r=>r.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),Qy=r=>{let e=r.match(/```mpcard\s*([\s\S]*?)```/i);return e?e[1].trim():r.trim()},rr=(r,e)=>{var i,a;let t=new RegExp(`\\b${e}=("([^"]*)"|'([^']*)')`,"i"),n=r.match(t);return n?Jy(((a=(i=n[2])!=null?i:n[3])!=null?a:"").trim()):""},Zy=r=>{let e=r.split(/\r?\n/).map(i=>i.trim()).filter(i=>i.length>0),t={},n=/^(\w+):\s*"?(.*?)"?$/;for(let i of e){let a=i.match(n);if(a){let o=a[1].trim().toLowerCase(),s=a[2].trim();t[o]=s}}return{id:t.id||"",headimg:t.headimg||t.avatar||"",nickname:t.nickname||t.name||"",signature:t.signature||t.desc||t.description||"",alias:t.alias||""}},Yy=r=>{let e=Qy(r);if(!e)return null;if(/<mp-common-profile/i.test(e)||/\bdata-id=/.test(e))return{id:rr(e,"data-id"),headimg:rr(e,"data-headimg"),nickname:rr(e,"data-nickname"),signature:rr(e,"data-signature"),alias:rr(e,"data-alias"),rawHtml:e};let t=Zy(e);return{id:t.id||"",headimg:t.headimg||"",nickname:t.nickname||"",signature:t.signature||"",alias:t.alias,rawHtml:""}},sd=r=>{let e=Yy(r);if(!e||!e.id||!e.rawHtml)return null;let t=e.rawHtml.trim();return/<mp-common-profile/i.test(t)?(/^\s*<section/i.test(t)||(t=`<section class="mp_profile_iframe_wrp" nodeleaf="">${t}</section>`),{info:e,html:t}):null},ld=r=>{let e=di(r.headimg||""),t=di(r.nickname||""),n=di(r.signature||"");return`<section${r.id?` data-id="${di(r.id)}"`:""} class="one2mp-mpcard-wrapper"><div class="one2mp-mpcard-content"><img class="one2mp-mpcard-headimg" width="54" height="54" src="${e}"></img><div class="one2mp-mpcard-info"><div class="one2mp-mpcard-nickname">${t}</div><div class="one2mp-mpcard-signature">${n}</div></div></div><div class="one2mp-mpcard-foot">\u516C\u4F17\u53F7</div></section>`}});var ud,Sn,dd=j(()=>{Fe();ze();Zn();Qe();ud=require("obsidian");lo();cd();Sn=class extends ke{constructor(){super(...arguments);this.mermaidIndex=0;this.admonitionIndex=0;this.chartsIndex=0}prepare(){return this.mermaidIndex=0,this.admonitionIndex=0,this.chartsIndex=0,st.getInstance().cleanup(),Promise.resolve()}static srcToBlob(t){let n=t.split(",")[1],i=atob(n),a=new Array(i.length);for(let s=0;s<i.length;s++)a[s]=i.charCodeAt(s);let o=new Uint8Array(a);return new Blob([o],{type:"image/png"})}codeRenderer(t,n){var u;let i=(u=(n||"").match(/^\S*/))==null?void 0:u[0],a=t.replace(/\n$/,""),s=Sn.escapeHtml(a).split(`
`),l="";for(let d of s){let f=d.length===0?"<br>":d;l+=`<code>${f}</code>`}let c='<section class="code-section code-snippet__fix">';return i?c+`<pre class="hljs language-${i}">${l}</pre></section>`:c+`<pre>${l}</pre></section>`}static escapeHtml(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/'/g,"&#39;")}static getMathType(t){if(!t)return null;let n=t.toLowerCase();return n=n.trim(),n==="am"||n==="asciimath"?"asciimath":n==="latex"||n==="tex"?"latex":null}renderAdmonition(t,n){let i=Ae.getInstance(this.plugin.app).queryElement(this.admonitionIndex,".callout.admonition");if(!i)return $("render.admonition-failed");this.admonitionIndex++;let a=i.querySelector(".edit-block-button");a&&a.parentNode.removeChild(a);let o=i.querySelector(".callout-fold");if(o)try{o.parentNode.removeChild(o)}catch(s){console.error(s)}return et(i)}renderAdmonitionAsync(t,n){let a=Ae.getInstance(this.plugin.app).queryElement(this.admonitionIndex,".callout.admonition");if(!a)return $("render.admonition-failed");this.admonitionIndex++;let o=a.querySelector(".edit-block-button");o&&o.parentNode.removeChild(o);let s=a.querySelector(".callout-fold");if(s)try{s.parentNode.removeChild(s)}catch(l){console.error(l)}return vl(a)}async renderMermaidAsync(t){var u;t.html=$("render.mermaid-failed");let n=this.mermaidIndex;this.mermaidIndex++;let i=Ae.getInstance(this.plugin.app),a=i.queryElement(n,".mermaid");if(!a)return;await i.waitForSelector(a,"svg",5e3);let o=a.querySelector("svg");if(!o)return;let s=a.closest(".one2mp-render-preview"),l=(u=s==null?void 0:s.classList.contains("one2mp-render-preview-visible"))!=null?u:!1,c=a.classList.contains("one2mp-mermaid-visible");try{s==null||s.classList.add("one2mp-render-preview-visible"),a.classList.add("one2mp-mermaid-visible");let{width:d,height:f}=this.getMermaidSize(o),m=await i.domToImage(o,{width:d,height:f});t.html=`<section id="one2mp-mermaid-${n}" class="mermaid"><img src="${m}" class="mermaid-image" style="width:${d}px;height:auto;"></section>`}catch(d){console.error(d)}finally{s&&!l&&s.classList.remove("one2mp-render-preview-visible"),c||a.classList.remove("one2mp-mermaid-visible")}}getMermaidSize(t){var o;let n=t.getBoundingClientRect(),i=Math.round(n.width),a=Math.round(n.height);if(!i||!a){let s=(o=t.viewBox)==null?void 0:o.baseVal;s&&s.width&&s.height&&(i=Math.round(s.width),a=Math.round(s.height))}if(!i||!a){let s=t.getAttribute("width"),l=t.getAttribute("height"),c=s?parseFloat(s):0,u=l?parseFloat(l):0;c&&(i=Math.round(c)),u&&(a=Math.round(u))}return i||(i=800),a||(a=400),{width:i,height:a}}renderCharts(t){if(!this.isPluginInstlled("obsidian-charts"))return console.debug("charts plugin not installed."),new ud.Notice($("rnder.charts-plugin-not-installed")),!1;let n=this.plugin.resourceManager.getMarkdownRenderedElement(this.chartsIndex,".block-language-chart");if(!n)return $("render.charts-failed");let i=`charts-img-${this.chartsIndex}`;this.chartsIndex++;let a=n.querySelector("canvas");if(a){let o="image/png",s=a.toDataURL(o);return`<section id="${i}" class="charts" >
			<img src="${s}" class="charts-image" />
			</section>`}return $("render.charts-failed")}renderWewriteProfile(t){let n=t.text.split(/\r?\n/).filter(s=>s.trim()!==""),i={},a=/^(\w+):\s*"?(.*?)"?$/;return n.forEach(s=>{let l=s.match(a);if(l){let c=l[1].trim().toLocaleLowerCase(),u=l[2].trim();i[c]=u}}),`<div class="one2mp-profile-card">
		<a class="one2mp-profile-card-link" href="${i.url}">
			<div class="card-main">
				<div class="avatar">
					<img src="${i.avatar}" alt="${i.nickname}" avatar class="one2mp-avatar-image" >
				</div>
			<div class="content">
				<div class="title">${i.nickname}</div>
				<div class="description">${i.description}</div>
				<div class="meta">${i.tips}</div>
			</div>
			<div class="arrow"><i class="weui-icon-arrow"></i></div>
			</div>
			<div class="card-footer">${i.footer}</div>
		</a>
  	</div>`}renderMpcard(t){let n=sd(t.text);if(!n)return"<span>\u516C\u4F17\u53F7\u540D\u7247\u6570\u636E\u9519\u8BEF\uFF0C\u7F3A\u5C11id</span>";let{info:i,html:a}=n;return!i.headimg&&!i.nickname&&!i.signature?"<span>\u516C\u4F17\u53F7\u540D\u7247\u6570\u636E\u4E3A\u7A7A</span>":(st.getInstance().setCardData(i.id,a),ld({...i,nickname:i.nickname||$("render.mpcard-default-name"),signature:i.signature||$("render.mpcard-default-signature")}))}markedExtension(){return{extensions:[{name:"code",level:"block",renderer:t=>t.lang&&t.lang.trim().toLocaleLowerCase()=="mermaid"?t.html:t.lang&&t.lang.trim().toLocaleLowerCase()=="chart"?this.renderCharts(t):t.lang&&t.lang.trim().toLocaleLowerCase()=="one2mp-profile"?this.renderWewriteProfile(t):t.lang&&t.lang.trim().toLocaleLowerCase()=="mpcard"?this.renderMpcard(t):t.lang&&t.lang.trim().toLocaleLowerCase().startsWith("ad-")?t.html:this.codeRenderer(t.text,t.lang)}],async:!0,walkTokens:async t=>{if(t.lang&&t.lang.trim().toLocaleLowerCase()=="mermaid"&&await this.renderMermaidAsync(t),t.lang&&t.lang.trim().toLocaleLowerCase().startsWith("ad-")){let n=t.lang.trim().toLocaleLowerCase().replace("ad-","");n===""&&(n="note"),t.html=this.renderAdmonitionAsync(t,n)}}}}}});var fi,fd=j(()=>{Qe();fi=class extends ke{constructor(){super(...arguments);this.mermaidIndex=0;this.admonitionIndex=0;this.chartsIndex=0}extractOne2MpCaptions(t){let n=/^wwcap:\s*(.*)$/gim,i=[],a;for(;(a=n.exec(t))!==null;)i.push(a[1].trim());return i}codespanRenderer(t){t=t.trim();let n=this.extractOne2MpCaptions(t);return n.length>0?`<div class="one2mp-image-caption">${n[0]}</div>`:`<span class="one2mp-codespan">${t}</span>`}markedExtension(){return{extensions:[{name:"codespan",level:"inline",renderer:t=>t.html}],walkTokens:t=>{t.type==="codespan"&&(t.html=this.codespanRenderer(t.text))}}}}});function hd(r){let e=/^pdf#page=(\d+)(&rect=.*?)$/,t=r.lastIndexOf("|");t>0&&(r=r.substring(0,t));let n=r.lastIndexOf(".");if(n==-1)return"note";let i=r.substring(n+1);if(e.test(i))return"pdf-crop";if(r.startsWith("https://mmbiz.qpic.cn/")||r.startsWith("http://mmbiz.qpic.cn/"))return"image";switch(i.toLocaleLowerCase()){case"md":return"note";case"png":case"jpg":case"jpeg":case"gif":case"bmp":return"image";case"webp":return"webp";case"svg":return"svg";case"pdf":return"pdf";case"mp4":return"video";case"mp3":case"wma":case"wav":case"amr":return"voice";case"excalidraw":return"excalidraw";default:return"file"}}var pd,Xy,ar,ir,gd=j(()=>{pd=require("obsidian");Zn();Qe();Fe();vr();ze();Xy=/^!\[\[(.*?)\]\]/;ar=class extends ke{constructor(){super(...arguments);this.index=0;this.videoIndex=0;this.voiceIndex=0;this.pdfCropIndex=0;this.embedMarkdownIndex=0;this.excalidrawIndex=0;this.markdownEmbedIndex=0}generateId(){return this.index+=1,`fid-${this.index}`}prepare(){return this.videoIndex=0,this.voiceIndex=0,this.pdfCropIndex=0,this.index=0,this.embedMarkdownIndex=0,this.excalidrawIndex=0,this.markdownEmbedIndex=0,Promise.resolve()}searchFile(t){let n=this.resolvePath(t),i=this.plugin.app.vault,a=i.config.attachmentFolderPath||"",o=n,s=null;if(s=i.getFileByPath(n),s||(s=i.getFileByPath(t),s)||a!=""&&(o=a+"/"+t,s=i.getFileByPath(o),s||(o=a+"/"+n,s=i.getFileByPath(o),s)))return s;let l=i.getAllLoadedFiles();for(let c of l)if(c.path.includes(t))return c;return null}resolvePath(t){let n=this.getActiveFileDir();if(!t.includes("/"))return t;let i=n.split("/"),a=t.split("/");i.pop();for(let o of a)o!=="."&&(o===".."?i.pop():i.push(o));return i.join("/")}getActiveFileDir(){let t=this.plugin.app.workspace.getActiveFile();if(t==null)return"";let n=t.path.split("/");return n.pop(),n.length==0?"":n.join("/")}getImagePath(t){if(t.startsWith("http"))return t;let n=this.searchFile(t);return n==null?(console.error("File not found"+t),""):n instanceof pd.TFile?this.plugin.app.vault.getResourcePath(n):""}isImage(t){return t=t.toLowerCase(),t.endsWith(".png")||t.endsWith(".jpg")||t.endsWith(".jpeg")||t.endsWith(".gif")||t.endsWith(".bmp")||t.endsWith(".webp")}parseImageLink(t){if(t.includes("|")){let n=t.split("|"),i=n[0];if(!this.isImage(i))return null;let a=null,o=null;if(n.length==2){let s=n[1].toLowerCase().split("x");a=parseInt(s[0]),s.length==2&&s[1]!=""&&(o=parseInt(s[1]))}return{path:i,width:a,height:o}}return{path:t,width:null,height:null}}getHeaderLevel(t){let n=t.trimStart().match(/^#{1,6}/);return n?n[0].length:0}async getFileContent(t,n,i){let a=await this.plugin.app.vault.adapter.read(t.path);if(n==null&&i==null)return a;let o="",s=a.split(`
`);if(n){let l=0,c=!1;for(let u of s){if(c){if(l==this.getHeaderLevel(u))break;o+=u+`
`;continue}if(!u.trim().startsWith("#"))continue;let d=u.trim().split(" ");d.length==2&&n.trim()==d[1].trim()&&this.getHeaderLevel(u)&&(o+=u+`
`,l=this.getHeaderLevel(u),c=!0)}}if(i)for(let l=0;l<s.length;l++){let c=s[l];if(c.indexOf(i)>=0){if(o=c.replace(i,""),o.trim()=="")for(let u=l-1;u>=0;u--){let d=s[u];if(d.trim()!=""){o=d;break}}break}}return o}parseFileLink(t){let i=t.split("|")[0].split("#"),a=i[0],o=null,s=null;return i.length==2&&(i[1].startsWith("^")?s=i[1]:o=i[1]),{path:a,head:o,block:s}}async renderFile(t){let{path:n,head:i,block:a}=this.parseFileLink(t),o=null;if(n===""?o=this.plugin.app.workspace.getActiveFile():(n.endsWith(".md")||(n=n+".md"),o=this.searchFile(n)),o==null){let u="File not found:"+n;console.error(u);return}let s=await this.getFileContent(o,i,a),{content:l}=rn(s);return await this.marked.parse(l)}parseLinkStyle(t){let n="",i='style="width:100%;height:100%"',a="left",o=["left","center","right"];if(t.includes("|")){let s=t.split("|");n=s[0];let l="";if(s.length==2?o.includes(s[1])?a=s[1]:l=s[1]:s.length==3&&(l=s[1],o.includes(s[1])?(l=s[2],a=s[1]):(l=s[1],a=s[2])),l!=""){let c=l.split("x");c.length==2?i=`style="width:${c[0]}px;height:${c[1]}px;"`:i=`style="width:${c[0]}px;"`}}else n=t;return{filename:n,style:i,postion:a}}parseSVGLink(t){let n="note-embed-svg-left",i=new Map([["left","note-embed-svg-left"],["center","note-embed-svg-center"],["right","note-embed-svg-right"]]),{filename:a,style:o,postion:s}=this.parseLinkStyle(t);return n=i.get(s)||n,{filename:a,style:o,classname:n}}async renderSVGFile(t,n){let i=this.searchFile(t);if(i==null){let o=$("render.file-not-found")+i;console.error(o),this.previewRender.updateElementByID(n,o);return}let a=await this.getFileContent(i,null,null);ar.fileCache.set(t,a),this.previewRender.updateElementByID(n,a)}markedExtension(){return{extensions:[{name:"Embed",level:"inline",start:t=>t.indexOf("![["),tokenizer:t=>{let n=t.match(Xy);return n==null?void 0:{type:"Embed",raw:n[0],href:n[1],text:n[1]}},renderer:t=>{let n=hd(t.href);if(console.debug("render embed type:",t,n),n=="image"||n=="webp"){let i=this.parseImageLink(t.href);if(i){let a=this.getImagePath(i.path),o=i.width?`width="${i.width}"`:"",s=i.height?`height="${i.height}"`:"";return`<img src="${a}" alt="${t.text}" ${o} ${s} />`}}else if(n=="svg"){let i=this.parseSVGLink(t.href),a=this.generateId(),o=$("render.rendering");return ar.fileCache.has(i.filename)?o=ar.fileCache.get(i.filename)||$("render.render-failed"):this.renderSVGFile(i.filename,a),`<span class="${i.classname}"><span class="note-embed-svg" id="${a}" ${i.style}>${o}</span></span>`}else{if(n=="excalidraw")return t.html;if(n=="pdf-crop")return this.renderPdfCrop(t.href);if(n=="note")return t.html;if(n=="video")return this.renderVideo(t.href);if(n=="voice")return this.renderVoice(t.href)}}}],async:!0,walkTokens:async t=>{if(t.type!=="Embed")return;let n=hd(t.href);n==="excalidraw"?await this.renderExcalidrawAsync(t):n==="note"&&await this.renderMarkdownEmbedAsync(t)}}}async renderExcalidrawAsync(t){if(!this.isPluginInstlled("obsidian-excalidraw-plugin"))return!1;t.html=$("render.excalidraw-failed");let n=this.excalidrawIndex;this.excalidrawIndex++;let i=Ae.getInstance(this.plugin.app),a=i.queryElement(n,"div.excalidraw-svg");if(!a){console.error("renderExcalidrawAsync error:","root is null");return}a.removeAttribute("style");try{let o=a.querySelector("img");o&&(o.setAttr("width","100%"),o.setAttr("height","100%"),o.setAttr("style","width:100%;height:100%"));let s=await i.domToImage(a);t.html=`<section class="excalidraw" ><img src="${s}" class="exclaidraw-image" ></section>`}catch(o){console.error("renderExcalidrawAsync error:",o)}}async renderMarkdownEmbedAsync(t){let n=t.href,i=await this.renderFile(n);t.html=`<div class="markdown-embed inline-embed is-loaded">${i}</div>`}renderPdfCrop(t){if(!this.isPluginInstlled("pdf-plus"))return!1;let n=Ae.getInstance(this.plugin.app).queryElement(this.pdfCropIndex,".pdf-cropped-embed");return n?(this.pdfCropIndex++,`<section class="pdf-crop">${et(n)}</section>`):$("render.pdf-crop-failed")}renderVideo(t){let n=Ae.getInstance(this.plugin.app).queryElement(this.videoIndex,"video");return n?(this.videoIndex++,`<section class="video">${et(n)}</section>`):"render video failed"}renderVoice(t){let n=Ae.getInstance(this.plugin.app).queryElement(this.voiceIndex,"audio");return n?(this.voiceIndex++,`<section class="audio">${et(n)}</section>`):"render voice failed"}},ir=ar;ir.fileCache=new Map});var md,hi,vd=j(()=>{Qe();md=require("obsidian");ze();hi=class extends ke{postprocess(e){let t=(0,md.sanitizeHTMLToDom)(e),n=createEl("div");n.appendChild(t);let i=n.querySelectorAll("h1, h2, h3, h4, h5, h6");for(let a of i){let o=a.textContent;a.empty(),a.createSpan({text:" ",cls:"one2mp-heading-prefix"}),a.createSpan({cls:"one2mp-heading-outbox"}).createSpan({text:o||"",cls:"one2mp-heading-leaf"}),a.createSpan({cls:"one2mp-heading-tail"})}return Promise.resolve(tt(n))}markedExtension(){return{extensions:[]}}}});function tw(){let r=globalThis.MathJax;return r!=null?r:null}function Co(r){return r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function nw(r){var t;let e=r.tagName.toLowerCase()=="svg"?r:r.querySelector("svg");return e?ew.serializeToString(e):Co((t=r.textContent)!=null?t:"")}function yd(r,e=!1){let t=tw();if(!(t!=null&&t.tex2svg))return Co(r);try{let n=t.tex2svg(r,{display:e});return nw(n)}catch(n){return console.warn("MathJax \u6E32\u67D3\u5931\u8D25",n),Co(r)}}var ew,wd=j(()=>{ew=new XMLSerializer});var bd,rw,pi,xd=j(()=>{wd();Qe();bd=/^(\${1,2})(?!\$)((?:\\.|[^\\\n])*?(?:\\.|[^\\\n$]))\1/,rw=/^(\${1,2})\n((?:\\[^]|[^\\])+?)\n\1(?:\n|$)/,pi=class extends ke{renderer(e,t,n=""){n===""&&(n="InlineMath");let i=yd(e.text,!t);return t?`<span  class="inline-math">${i}</span>`:`<section  class="block-math">${i}</section>`}markedExtension(){return{extensions:[this.inlineMath(),this.blockMath()]}}inlineMath(){return{name:"InlineMath",level:"inline",start(e){let t,n=e;for(;n;){if(t=n.indexOf("$"),t===-1)return;if(n.substring(t).match(bd))return t;n=n.substring(t+1).replace(/^\$+/,"")}},tokenizer(e){let t=e.match(bd);if(t)return{type:"InlineMath",raw:t[0],text:t[2].trim(),displayMode:t[1].length===2}},renderer:e=>this.renderer(e,!0)}}blockMath(){return{name:"BlockMath",level:"block",tokenizer(e){let t=e.match(rw);if(t)return{type:"BlockMath",raw:t[0],text:t[2].trim(),displayMode:t[1].length===2}},renderer:e=>this.renderer(e,!1)}}}});var iw,aw,gi,_d=j(()=>{Zn();Qe();ze();iw=/`(ris|fas):([a-z0-9-]+)`/i,aw=/^`(ris|fas):([a-z0-9-]+)`/i,gi=class extends ke{constructor(){super(...arguments);this.remixIndex=0}prepare(){return this.remixIndex=0,Promise.resolve()}render(){let t=Ae.getInstance(this.plugin.app).queryElement(this.remixIndex,".obsidian-icon.react-icon");return t?(this.remixIndex++,et(t)):"<span>remix icon not found </span>"}markedExtension(){return{extensions:[{name:"remixIcon",level:"inline",start:t=>{let n=t.match(iw);if(n)return n.index},tokenizer:t=>{let n=t.match(aw);if(n)return{type:"remixIcon",raw:n[0],text:n[0].trim(),lang:n[1]}},renderer:()=>this.render()}]}}}});var mi,kd=j(()=>{Qe();mi=class extends ke{markedExtension(){return{extensions:[{name:"table",level:"block",renderer:e=>{let t=(a,o)=>{var u;let s=a.align,l=s?` style="text-align:${s};"`:"",c=(u=a.tokens)!=null&&u.length?this.marked.Parser.parseInline(a.tokens):a.text;return`<${o}${l}>${c}</${o}>`},n=e.header.map(a=>t(a,"th")),i=e.rows.map(a=>`<tr>${a.map(s=>t(s,"td")).join("")}</tr>`);return`<section class="table-container"><table><thead><tr>${n.join("")}</tr></thead><tbody>${i.join("")}</tbody></table></section>`}}]}}}});var vi,Sd=j(()=>{Qe();vi=class extends ke{markedExtension(){return{extensions:[{name:"footnote",level:"block",start:e=>{var t;return(t=e.match(/\[\^(\w+)\]:/))==null?void 0:t.index},tokenizer:e=>{let n=/^\[\^(\w+)\]:\s*(.*)/.exec(e);if(n)return{type:"footnote",raw:n[0],id:n[1],text:n[2],tokens:[]}},renderer:e=>{if(e.type==="footnote")return`<div id="footnote-${e.id}" class="footnote"><span class="footnote-id">\u3010${e.id}\u3011 </span>${e.text}</div>`}},{name:"footnoteMark",level:"inline",start:e=>{var t;return(t=e.match(/\[\^(\w+)\]/))==null?void 0:t.index},tokenizer:e=>{let n=/^\[\^(\w+)\]/.exec(e);if(n)return{type:"footnoteMark",raw:n[0],id:n[1],tokens:[]}},renderer:e=>{if(e.type==="footnoteMark")return`<a>${e.text}<sup>\u3010${e.id}\u3011</sup></a>`}}]}}}});var yi,Ed=j(()=>{Qe();yi=class extends ke{constructor(){super(...arguments);this.allLinks=[]}prepare(){return this.allLinks=[],Promise.resolve()}postprocess(t){var o,s;if(!this.allLinks.length)return Promise.resolve(t);let n=[],i=new Map;for(let l of this.allLinks){let c=i.get(l.href);if(!c){let m={href:l.href,text:l.text};i.set(l.href,m),n.push(m);continue}let u=((o=c.text)==null?void 0:o.trim())||"",d=((s=l.text)==null?void 0:s.trim())||"";d&&d!==l.href&&(u===l.href||d.length>u.length)&&(c.text=d)}let a=n.map(l=>{var d;let c=(d=l.text)==null?void 0:d.trim();return`<li>${c&&c!==l.href?c:"\u5916\u94FE"}\uFF1A<a data-linktype="2" data-link="${l.href}" href="${l.href}">${l.href}</a>&nbsp;\u21A9</li>`});return Promise.resolve(`${t}<section class="foot-links"><hr class="foot-links-separator"><ol>${a.join("")}</ol></section>`)}markedExtension(){return{extensions:[{name:"link",level:"inline",renderer:t=>{let n=i=>i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;");if(t.href.startsWith("http")){let i=(t.text||"").trim(),a=n(t.href);return!i||i===t.href?`<strong>(${a})</strong>`:`${n(i)}<strong>(${a})</strong>`}else return`<a href="${t.href}">${t.text}</a>`}}]}}}});function ow(r){return/^h[1-6]$/i.test(r.tagName)}function Cd(r){return ow(r)?parseInt(r.tagName.charAt(1),10):null}function sw(r,e){let t=Cd(e),n=Cd(r);return n===null?!0:t===null||t>n}var Td,wi,Ad=j(()=>{Td=require("obsidian");Qe();ze();wi=class extends ke{processHeading(e,t){var o;let n=["h1","h2","h3","h4","h5","h6"],i=t.trim().toLowerCase();if(!n.includes(i))return e;let a=e.querySelectorAll(t.trim());for(let s=0;s<a.length;s++){let l=a[s];if(l){let c=createEl("details");c.createEl("summary",{text:(o=l.textContent)!=null?o:""});let u=l.nextSibling;for(;u&&sw(l,u);){let d=u.nextSibling;c.appendChild(u),u=d}l.replaceWith(c)}}return e}postprocess(e){let t=this.previewRender.articleProperties.get("folded-headings");if(t===void 0||!t)return Promise.resolve(e);let n=(0,Td.sanitizeHTMLToDom)(e),i=createEl("div");i.appendChild(n);let a=t.split(",");for(let o of a)this.processHeading(i,o);return Promise.resolve(tt(i))}markedExtension(){return{extensions:[]}}}});var or,bi,Pd=j(()=>{or=require("obsidian");ze();Qe();bi=class extends ke{isImageFile(e){if(!(e instanceof or.TFile))return!1;let t=e.extension.toLowerCase();return["png","jpg","jpeg","gif","bmp","webp","svg"].includes(t)}findImageFile(e){var m,w,C,k,v;let t=this.plugin.app.vault,n=this.plugin.app.workspace.getActiveFile(),i=(w=(m=n==null?void 0:n.parent)==null?void 0:m.path)!=null?w:"",a="app://obsidian.md/",o=e.trim();if(o.startsWith(a)&&(o=decodeURIComponent(o.slice(a.length))),o=o.split("|")[0].split("?")[0].split("#")[0],!o)return null;let s=this.plugin.app.metadataCache.getFirstLinkpathDest(o,(C=n==null?void 0:n.path)!=null?C:"");if(this.isImageFile(s))return s;if(o.includes("/")){let g=o.split("/").pop()||o;if(s=this.plugin.app.metadataCache.getFirstLinkpathDest(g,(k=n==null?void 0:n.path)!=null?k:""),this.isImageFile(s))return s}let l=t.config,c=(v=l==null?void 0:l.attachmentFolderPath)!=null?v:"",u=o.split("/").pop()||o,d=[];if(!c||c===".")i?(d.push(`${i}/${o}`),d.push(`${i}/${u}`)):d.push(o,u);else if(c.startsWith("./")){let g=c.slice(2),h=i?`${i}/${g}`:g;d.push(`${h}/${o}`),d.push(`${h}/${u}`)}else d.push(`${c}/${o}`),d.push(`${c}/${u}`);for(let g of d)if(s=t.getAbstractFileByPath(g),this.isImageFile(s))return s;let f=t.getAllLoadedFiles();for(let g of f)if(g instanceof or.TFile&&g.basename===u&&this.isImageFile(g))return g;return null}resolveImageSrc(e){let t=e.trim();if(!t||/^(https?:|data:)/i.test(t))return t;let n=this.findImageFile(t);return n?this.plugin.app.vault.getResourcePath(n):e}processImage(e){var n,i,a;let t=e.querySelectorAll("img");for(let o=0;o<t.length;o++){let s=t[o],l=(n=s.getAttribute("class"))==null?void 0:n.split(" ");if(l!=null&&l.includes("one2mp-avatar-image"))continue;let c=s.getAttribute("src");c&&s.setAttribute("src",this.resolveImageSrc(c));let d=((i=s.getAttribute("title"))==null?void 0:i.trim())||"",f=createEl("figure",{cls:"image-with-caption"});if((a=s.parentNode)==null||a.insertBefore(f,s),f.appendChild(s),d){let m=f.createEl("div",{cls:"image-caption-row"});m.createEl("div",{cls:"triangle"}),m.createEl("figcaption",{cls:"image-caption",text:d})}}return e}postprocess(e){let t=(0,or.sanitizeHTMLToDom)(e),n=createEl("div");return n.appendChild(t),this.processImage(n),Promise.resolve(tt(n))}markedExtension(){return{renderer:{image:e=>{let t=this.resolveImageSrc(e.href||""),n=e.text?`alt="${e.text}"`:'alt=""',i=e.title?` title="${e.title}"`:"";return`<img src="${t}" ${n}${i} />`}},extensions:[]}}}});var xi,lw,$d,Id=j(()=>{xi={header:{start:["%%hh%%","%%hh%"],end:["%%/hh%%","%%/hh%"]},footer:{start:["%%tt%%","%%tt%"],end:["%%/tt%%","%%/tt%"]}},lw=r=>r.trim().toLowerCase(),$d=r=>r&&r.split(/\r?\n/).filter(n=>{let i=lw(n);return![...xi.header.start,...xi.header.end,...xi.footer.start,...xi.footer.end].includes(i)}).join(`
`)});var Od={};Ct(Od,{WechatRender:()=>Kt});var Dd,cw,uw,Vt,Kt,To=j(()=>{yo();Dd=require("obsidian");Qn();od();dd();fd();gd();vd();xd();_d();kd();Sd();Ed();Ad();Pd();Id();vr();ze();cw={gfm:!0,breaks:!0},uw=r=>{let e=r.split(/\r?\n/),t=a=>/^[\t ]*([-*_])\1\1+[\t ]*$/.test(a),n=a=>{let o=a.trim();return o?/^!\[\[.+\]\]$/.test(o)?!0:/^!\[[^\]]*]\([^)]+\)$/.test(o):!1},i=[];for(let a=0;a<e.length;a+=1){let o=e[a];t(o)&&a>0&&n(e[a-1])&&i.length&&i[i.length-1].trim()!==""&&i.push(""),i.push(o)}return i.join(`
`)},Vt=class{constructor(e,t){this.extensions=[];this.delayParse=e=>new Promise((t,n)=>{setTimeout(()=>{this.plugin.app.vault.adapter.read(e).then(i=>this.parse(i)).then(i=>this.postprocess(i)).then(t).catch(i=>{let a=i instanceof Error?i:new Error(String(i));n(a)})},100)});this.plugin=e,this.previewRender=t,this.client=ot.getInstance(e),this.marked=new Ht,this.marked.use(cw),this.marked.use({renderer:{list(n){let i="";if(n.items)for(let s of n.items)i+=this.listitem(s);let a=n.ordered?"ol":"ul",o=n.ordered&&n.start!==1?' start="'+n.start+'"':"";return"<"+a+o+' class="list-paddingleft-1">'+i+"</"+a+">"},listitem(n){return`<li><section>${n.tokens?this.parser.parse(n.tokens):n.text||""}</section></li>`}}}),this.useExtensions()}static getInstance(e,t){return Vt.instance||(Vt.instance=new Vt(e,t)),Vt.instance}static resetInstance(){Vt.instance=null}addExtension(e){this.extensions.push(e),this.marked.use(e.markedExtension())}useExtensions(){this.addExtension(new vi(this.plugin,this.previewRender,this.marked)),this.addExtension(new hi(this.plugin,this.previewRender,this.marked)),this.addExtension(new ir(this.plugin,this.previewRender,this.marked)),this.addExtension(new Sn(this.plugin,this.previewRender,this.marked)),this.addExtension(new fi(this.plugin,this.previewRender,this.marked)),this.addExtension(new pi(this.plugin,this.previewRender,this.marked)),this.addExtension(new gi(this.plugin,this.previewRender,this.marked)),this.addExtension(new ui(this.plugin,this.previewRender,this.marked)),this.addExtension(new mi(this.plugin,this.previewRender,this.marked)),this.addExtension(new yi(this.plugin,this.previewRender,this.marked)),this.addExtension(new wi(this.plugin,this.previewRender,this.marked)),this.addExtension(new bi(this.plugin,this.previewRender,this.marked))}async parse(e){let{content:t}=rn(e),n=$d(t),i=uw(n);for(let a of this.extensions)await a.prepare();return await this.marked.parse(i)}async postprocess(e){let t=e;for(let n of this.extensions)t=await n.postprocess(t);return t=this.removeEmptyListItems(t),t}removeEmptyListItems(e){let t=document.createElement("div");return t.appendChild((0,Dd.sanitizeHTMLToDom)(e)),t.querySelectorAll("ol li, ul li").forEach(n=>{let i=n.querySelector("img, video, figure"),a=tt(n).replace(/<br\s*\/?>/gi,"").replace(/&nbsp;/gi,"").replace(/\u00A0/g,"").replace(/<span[^>]*>\s*<\/span>/gi,"").replace(/<section[^>]*>\s*<\/section>/gi,"").replace(/<div[^>]*>\s*<\/div>/gi,"").replace(/[\s\u200B-\u200D]+/g,"").trim();!i&&a===""&&n.remove()}),tt(t)}async parseNote(e){let t=await this.plugin.app.vault.adapter.read(e),n=await this.parse(t);return n=await this.postprocess(n),n}},Kt=Vt;Kt.instance=null});var Ao,En,Ld=j(()=>{Ao=require("obsidian");ze();En=class{constructor(e){this.app=e}parseObsidianUrl(e){let t=/obsidian:\/\/open\?vault=(.*?)&file=([^,]*),?(.*)$/,n=e.match(t);return n&&n[2]?decodeURIComponent(n[2]):null}getFileFromPath(e){let t=this.app.vault.getAbstractFileByPath(e);return t instanceof Ao.TFile?t:null}getDisplayUrl(e){if(e)try{return this.app.vault.getResourcePath(e)}catch(t){console.error("Error reading file:",t)}return null}getInternalLinkDisplayUrl(e){let t=this.parseObsidianUrl(e);if(t){let n=this.getFileFromPath(t);if(n)return this.getDisplayUrl(n)}return null}}});var Oe,Pe,sr,Po,Md,Rd=j(()=>{Oe={title:"\u6807\u9898",author:"\u4F5C\u8005",digest:"\u6458\u8981",sourceUrl:"\u539F\u6587\u94FE\u63A5",cover:"\u5C01\u9762\u56FE",openComment:"\u5F00\u542F\u8BC4\u8BBA",onlyFans:"\u4EC5\u7C89\u4E1D\u53EF\u8BC4\u8BBA"},Pe={title:[Oe.title,"title"],author:[Oe.author,"author"],digest:[Oe.digest,"digest","description","summary"],sourceUrl:[Oe.sourceUrl,"content_source_url","source_url"],cover:[Oe.cover,"cover","thumbnail","one2mp_cover"],openComment:[Oe.openComment,"need_open_comment","open_comment"],onlyFans:[Oe.onlyFans,"only_fans_can_comment"]},sr=(r,e)=>{if(r)for(let t of e){let n=r[t];if(typeof n=="string"&&n.trim()!=="")return n.trim()}},Po=(r,e)=>{if(!r)return;let t=new Set(["1","true","yes","y","on","\u662F","\u5F00\u542F","\u5F00"]),n=new Set(["0","false","no","n","off","\u5426","\u5173\u95ED","\u5173"]);for(let i of e){let a=r[i];if(typeof a=="boolean")return a?1:0;if(typeof a=="number")return a>0?1:0;if(typeof a=="string"){let o=a.trim().toLowerCase();if(t.has(o))return 1;if(n.has(o))return 0}}},Md=r=>{if(!r)return null;for(let e of Pe.cover){let t=r[e];if(typeof t=="string"&&t.trim()!=="")return t.trim()}return null}});var ye,_i,$o,Fd=j(()=>{ye=require("obsidian");Jn();Ld();ze();Qn();Fe();qi();Rd();_i=class{constructor(e,t){this.coverImageRef=null;this.coverImageWrap=null;this.coverImageEl=null;this.coverNaturalWidth=0;this.coverNaturalHeight=0;this.coverTransform={scale:1,offsetX:0,offsetY:0};this.coverResizeObserver=null;this.coverFrontmatterKey=Oe.cover;this.coverVaultPrefix="vault:";this.coverImageExtensions=["png","jpg","jpeg","gif","webp","bmp","svg","tiff"];this.plugin=e,this.localDraftmanager=Et.getInstance(e),this.BuildUI(t),this.coverResizeDebounced=(0,ye.debounce)(()=>this.handleCoverFrameResize(),80),typeof ResizeObserver!="undefined"&&(this.coverResizeObserver=new ResizeObserver(()=>{this.coverResizeDebounced()}),this.coverResizeObserver.observe(this.coverFrame)),this.plugin.messageService.registerListener("wechat-account-changed",()=>{this.updateLocalDraft()}),this.plugin.messageService.registerListener("active-file-changed",()=>{this.updateLocalDraft()}),this.plugin.messageService.registerListener("set-draft-cover-image",n=>{this.coverImageRef=n,this.cover_image=this.resolveCoverUrl(n),this.resetCoverCropState(this.coverImageRef),this.setCoverImage(this.cover_image),this.saveCoverToFrontmatter(this.coverImageRef),this.activeLocalDraft&&(this.activeLocalDraft.thumb_media_id=void 0,this.localDraftmanager.setDraft(this.activeLocalDraft))}),this.plugin.messageService.registerListener("set-image-as-cover",n=>{this.coverImageRef=n.url,this.cover_image=this.resolveCoverUrl(n.url),this.resetCoverCropState(this.coverImageRef),this.setCoverImage(this.cover_image),this.saveCoverToFrontmatter(this.coverImageRef),this.activeLocalDraft&&(this.activeLocalDraft.thumb_media_id=n.media_id,this.localDraftmanager.setDraft(this.activeLocalDraft))}),this.updateLocalDraft()}updateDraftDraftId(e){this.activeLocalDraft!==void 0&&(this.activeLocalDraft.last_draft_id=e)}resetCoverTransform(){this.coverTransform={scale:1,offsetX:0,offsetY:0}}async resetCoverCropState(e){this.activeLocalDraft&&(delete this.activeLocalDraft.cover_crop_scale,delete this.activeLocalDraft.cover_crop_offset_x,delete this.activeLocalDraft.cover_crop_offset_y,delete this.activeLocalDraft.pic_crop_235_1,delete this.activeLocalDraft.pic_crop_1_1,e!==void 0?this.activeLocalDraft.cover_crop_ref=e||void 0:delete this.activeLocalDraft.cover_crop_ref,await this.localDraftmanager.setDraft(this.activeLocalDraft))}restoreCoverTransform(){this.resetCoverTransform()}applyCoverTransform(e=!1){!this.coverImageEl||!this.coverImageWrap||(this.coverImageWrap.setCssProps({left:"0",top:"0",width:"100%",height:"100%",transform:"none"}),this.coverImageEl.setCssProps({width:"100%",height:"100%","object-fit":"cover"}))}handleCoverFrameResize(){this.coverImageEl&&this.applyCoverTransform(!1)}onNoteRename(e){let t=this.plugin.app.workspace.getActiveFile();t===void 0||e!==t||this.activeLocalDraft!==void 0&&(this.activeLocalDraft.notePath=e.path,Et.getInstance(this.plugin).setDraft(this.activeLocalDraft))}getActiveLocalDraft(){return this.activeLocalDraft}getRootEl(){return this.rootEl}BuildUI(e){this.rootEl=e.createDiv({cls:"one2mp-meta-card"});let t=this.rootEl.createDiv({cls:"one2mp-cover-container"});t.createDiv({cls:"one2mp-cover-hint",text:$("views.article-header.cover-image-description")}),this.coverFrame=this.createCoverFrame(t),ye.Platform.isMobile&&t.createDiv({cls:"one2mp-cover-mobile-action"}).createEl("button",{cls:"one2mp-cover-mobile-button",text:$("views.article-header.cover-image-mobile-button")}).addEventListener("click",()=>{this.openMobileCoverModal()});let n=this.rootEl.createDiv({cls:"one2mp-digest-container"});this.digestInput=new ye.TextAreaComponent(n),this.digestInput.setPlaceholder($("views.article-header.digest-text")),this.digestInput.inputEl.rows=4,this.digestInput.inputEl.addClass("one2mp-digest-input"),this.digestInput.onChange(i=>{let a=this.activeLocalDraft;a&&(a.digest=i,(async()=>(await this.localDraftmanager.setDraft(a),await this.saveDigestToFrontmatter(i)))())})}async saveDigestToFrontmatter(e){let t=this.getActiveMarkdownFile();t&&await this.plugin.app.fileManager.processFrontMatter(t,n=>{n[Oe.digest]=e,n[Pe.digest[0]]&&Pe.digest[0]!==Oe.digest&&delete n[Pe.digest[0]]})}getActiveMarkdownFile(){let e=this.plugin.app.workspace.getActiveFile();return!e||e.extension!=="md"&&e.extension!=="markdown"?null:e}getCoverFromFrontmatter(){var n,i;let e=this.getActiveMarkdownFile();if(!e)return null;let t=(i=(n=this.plugin.app.metadataCache.getFileCache(e))==null?void 0:n.frontmatter)!=null?i:null;return Md(t)}getVaultRelativePathFromAbsolute(e){let t=this.plugin.app.vault.adapter;if(!(t instanceof ye.FileSystemAdapter))return null;let n=t.getBasePath();if(!e.startsWith(n))return null;let i=e.slice(n.length);return(i.startsWith("/")||i.startsWith("\\"))&&(i=i.slice(1)),i.replace(/\\/g,"/")}getActiveRootFolder(){let e=this.getActiveMarkdownFile();if(!e)return null;let t=e.path.split("/");return t.length<=1?null:t[0]||null}getVaultPathCandidates(e){let t=e.replace(/^\/+/,""),n=[t],i=this.getActiveRootFolder();return i&&!t.startsWith(`${i}/`)&&n.push(`${i}/${t}`),n}resolveCoverUrl(e){if(!e||!e.trim())return null;let t=e.trim();if(t.startsWith(this.coverVaultPrefix)){let i=t.slice(this.coverVaultPrefix.length);for(let a of this.getVaultPathCandidates(i)){let o=this.plugin.app.vault.getAbstractFileByPath(a);if(o instanceof ye.TFile)return this.plugin.app.vault.getResourcePath(o)}return null}if(t.startsWith("obsidian://")){let a=new En(this.plugin.app).parseObsidianUrl(t);if(a){let o=this.plugin.app.vault.getAbstractFileByPath(a);if(o instanceof ye.TFile)return this.plugin.app.vault.getResourcePath(o)}}let n=this.plugin.app.vault.getAbstractFileByPath(t);return n instanceof ye.TFile?this.plugin.app.vault.getResourcePath(n):t}getCoverFileFromRef(e){if(!e||!e.trim())return null;let t=e.trim();if(t.startsWith(this.coverVaultPrefix)){let i=t.slice(this.coverVaultPrefix.length);for(let a of this.getVaultPathCandidates(i)){let o=this.plugin.app.vault.getAbstractFileByPath(a);if(o instanceof ye.TFile)return o}return null}if(t.startsWith("obsidian://")){let a=new En(this.plugin.app).parseObsidianUrl(t);if(a){let o=this.plugin.app.vault.getAbstractFileByPath(a);return o instanceof ye.TFile?o:null}}let n=this.plugin.app.vault.getAbstractFileByPath(t);return n instanceof ye.TFile?n:null}async saveCoverToFrontmatter(e){let t=this.getActiveMarkdownFile();t&&await this.plugin.app.fileManager.processFrontMatter(t,n=>{if(e&&e.trim()!==""){n[this.coverFrontmatterKey]=e;for(let i of Pe.cover)i!==this.coverFrontmatterKey&&delete n[i]}else for(let i of Pe.cover)delete n[i]})}createCoverFrame(e){let t=e.createDiv({cls:"cover-frame",attr:{droppable:!0}});return t.ondragenter=n=>{n.preventDefault(),t.addClass("image-on-dragover")},t.ondragleave=n=>{n.preventDefault(),t.removeClass("image-on-dragover")},t.ondragover=n=>{n.preventDefault()},t.addEventListener("drop",n=>{this.handleCoverDrop(n,t)}),t}async handleCoverDrop(e,t){var a,o,s,l,c;e.preventDefault();let n=e.dataTransfer,i=(o=(a=n==null?void 0:n.getData("text/uri-list"))==null?void 0:a.trim())!=null?o:"";if(i||(i=(l=(s=n==null?void 0:n.getData("text/plain"))==null?void 0:s.trim())!=null?l:""),i.includes(`
`)&&(i=(c=i.split(/\r?\n/).map(d=>d.trim()).filter(d=>d&&!d.startsWith("#"))[0])!=null?c:""),this.activeLocalDraft||await this.updateLocalDraft(),i){let u=null,d=null;if(i.startsWith("obsidian://")){let m=new En(this.plugin.app).parseObsidianUrl(i);m&&(u=`${this.coverVaultPrefix}${m}`,d=this.resolveCoverUrl(u))}else if(i.startsWith("http")||i.startsWith("https")){if(u=i,d=i,this.activeLocalDraft){let f=await this.getCoverImageMediaId(i);f?(t.setAttr("data-media_id",f),this.activeLocalDraft.thumb_media_id=f):(t.removeAttribute("data-media_id"),this.activeLocalDraft.thumb_media_id=void 0)}}else if(i.startsWith("file://")){let f=decodeURIComponent(i.replace("file://","")),m=this.getVaultRelativePathFromAbsolute(f);m?(u=`${this.coverVaultPrefix}${m}`,d=this.resolveCoverUrl(u)):ye.Platform.isMobile?(new ye.Notice($("views.article-header.cover-file-not-supported")),u=null,d=""):(u=i,d=i)}else this.plugin.app.vault.getAbstractFileByPath(i)instanceof ye.TFile?(u=`${this.coverVaultPrefix}${i}`,d=this.resolveCoverUrl(u)):(u=null,d="",this.setCoverImageXY());this.activeLocalDraft!==void 0&&(this.activeLocalDraft.cover_image_url=u||"",await this.localDraftmanager.setDraft(this.activeLocalDraft)),this.coverImageRef=u,this.cover_image=d,await this.resetCoverCropState(u),await this.saveCoverToFrontmatter(this.coverImageRef),this.setCoverImage(this.cover_image||"")}t.removeClass("image-on-dragover")}openMobileCoverModal(){new $o(this.plugin,this.coverImageExtensions,async e=>{let{filePath:t,url:n}=e,i=null;t?i=`${this.coverVaultPrefix}${t}`:n&&(i=n),await this.applyCoverRef(i)}).open()}async applyCoverRef(e){let t=e?this.resolveCoverUrl(e):"";this.activeLocalDraft&&(this.activeLocalDraft.cover_image_url=e||"",this.activeLocalDraft.thumb_media_id=void 0,await this.localDraftmanager.setDraft(this.activeLocalDraft)),this.coverImageRef=e,this.cover_image=t,await this.resetCoverCropState(e),await this.saveCoverToFrontmatter(this.coverImageRef),this.setCoverImage(this.cover_image||"")}setCoverImage(e){var o,s;for(;this.coverFrame.firstChild;)this.coverFrame.firstChild.remove();if(this.coverImageEl=null,this.coverImageWrap=null,this.coverNaturalWidth=0,this.coverNaturalHeight=0,!e){(o=this.coverFrame.parentElement)==null||o.removeClass("has-image");return}(s=this.coverFrame.parentElement)==null||s.addClass("has-image");let t=new Image;t.decoding="async",t.loading="lazy";let n=document.createElement("div");n.className="one2mp-cover-image-wrap",t.className="one2mp-cover-image",n.appendChild(t),this.coverFrame.appendChild(n),this.coverImageWrap=n,this.coverImageEl=t;let i=!1,a=()=>{i||(i=!0,this.coverNaturalWidth=t.naturalWidth||t.width,this.coverNaturalHeight=t.naturalHeight||t.height,this.resetCoverTransform(),this.restoreCoverTransform(),this.applyCoverTransform(!1))};t.onload=a,t.src=e,t.complete&&t.naturalWidth&&a()}resetImage(){this.setCoverImageXY(0,0)}async checkCoverImage(){if(await this.syncDraftFromFrontmatter(),this.activeLocalDraft!==void 0)if(this.activeLocalDraft.thumb_media_id===void 0||!this.activeLocalDraft.thumb_media_id){let e=this.coverImageRef||this.cover_image;if(e){let t=await this.getCoverImageMediaId(e,!0);return this.activeLocalDraft.thumb_media_id=t,!0}}else return!0;return!1}async getCoverImageMediaId(e,t=!1){let n;if(t){let i,a=this.getCoverFileFromRef(e);if(a){let s=await this.plugin.app.vault.readBinary(a);i=new Blob([s])}else{let s=this.resolveCoverUrl(e);i=await In(s||e,this.plugin.app)}if(i===void 0||!i)return;let o=await ot.getInstance(this.plugin).uploadMaterial(i,"banner-cover.png","image");if(o){let{errcode:s,media_id:l}=o;if(s!==0){new ye.Notice($("views.article-header.upload-cover-image-error"));return}else n=l}}return n}setCoverImageXY(e=0,t=0){if(!this.coverImageEl){this.setCoverImage(this.cover_image);return}this.applyCoverTransform(!1)}getFrontmatter(){var t,n;let e=this.getActiveMarkdownFile();return e&&(n=(t=this.plugin.app.metadataCache.getFileCache(e))==null?void 0:t.frontmatter)!=null?n:null}async migrateFrontmatterKeys(){let e=this.getActiveMarkdownFile();if(!e)return;let t=this.getFrontmatter();if(!t)return;let n=[{canonical:Oe.title,aliases:Pe.title},{canonical:Oe.author,aliases:Pe.author},{canonical:Oe.digest,aliases:Pe.digest},{canonical:Oe.sourceUrl,aliases:Pe.sourceUrl},{canonical:Oe.cover,aliases:Pe.cover},{canonical:Oe.openComment,aliases:Pe.openComment},{canonical:Oe.onlyFans,aliases:Pe.onlyFans}];n.some(a=>a.aliases.some(o=>o!==a.canonical&&t[o]!==void 0))&&await this.plugin.app.fileManager.processFrontMatter(e,a=>{for(let o of n)if(a[o.canonical]===void 0){for(let s of o.aliases)if(s!==o.canonical&&a[s]!==void 0){a[o.canonical]=a[s],delete a[s];break}}else for(let s of o.aliases)s!==o.canonical&&a[s]!==void 0&&delete a[s]})}async syncDraftFromFrontmatter(){if(!this.activeLocalDraft)return;let e=this.getFrontmatter(),t=this.getActiveMarkdownFile(),n=sr(e,Pe.title)||(t==null?void 0:t.basename)||this.activeLocalDraft.title||"",i=sr(e,Pe.author),a=sr(e,Pe.digest),o=sr(e,Pe.sourceUrl),s=Po(e,Pe.openComment),l=Po(e,Pe.onlyFans);this.activeLocalDraft.title=n,this.activeLocalDraft.author=i,this.activeLocalDraft.digest=a,this.digestInput&&this.digestInput.setValue(a||""),this.activeLocalDraft.content_source_url=o,s!==void 0?this.activeLocalDraft.need_open_comment=s:this.activeLocalDraft.need_open_comment===void 0&&(this.activeLocalDraft.need_open_comment=1),l!==void 0?this.activeLocalDraft.only_fans_can_comment=l:this.activeLocalDraft.only_fans_can_comment===void 0&&(this.activeLocalDraft.only_fans_can_comment=0),await this.localDraftmanager.setDraft(this.activeLocalDraft),this.plugin.messageService.sendMessage("draft-title-updated",n)}async updateLocalDraft(){return this.activeLocalDraft=await this.localDraftmanager.getDrafOfActiveNote(),await this.updateHeaderProporties(),!0}async updateHeaderProporties(){await this.migrateFrontmatterKeys();let t=this.getCoverFromFrontmatter();this.activeLocalDraft!==void 0&&(await this.syncDraftFromFrontmatter(),!t&&this.activeLocalDraft.cover_image_url&&(t=this.activeLocalDraft.cover_image_url),this.activeLocalDraft.cover_image_url=t||"",this.activeLocalDraft.cover_crop_ref!==(t||"")&&await this.resetCoverCropState(t||void 0),await this.localDraftmanager.setDraft(this.activeLocalDraft));let n=t||"",i=this.coverImageRef||"",a=n!==i;this.coverImageRef=n,this.cover_image=this.resolveCoverUrl(this.coverImageRef),a||!this.coverImageEl?this.setCoverImage(this.cover_image):this.setCoverImageXY()}},$o=class extends ye.Modal{constructor(t,n,i){super(t.app);this.plugin=t;this.imageExtensions=n;this.onSubmit=i}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h3",{text:$("views.article-header.cover-image-mobile-title")}),new ye.Setting(t).setName($("views.article-header.cover-image-mobile-vault")).setDesc($("views.article-header.cover-image-mobile-vault-desc")).addText(o=>{this.fileInput=o,this.fileInput.setPlaceholder($("views.article-header.cover-image-mobile-vault-placeholder")),new nn(this.plugin.app,this.fileInput.inputEl,this.imageExtensions)}),new ye.Setting(t).setName($("views.article-header.cover-image-mobile-url")).setDesc($("views.article-header.cover-image-mobile-url-desc")).addText(o=>{this.urlInput=o,this.urlInput.setPlaceholder("https://")});let a=t.createDiv("modal-button-container");a.createEl("button",{text:$("modals.confirm")}).addEventListener("click",()=>{var c,u;let o=(c=this.fileInput)==null?void 0:c.getValue().trim(),s=(u=this.urlInput)==null?void 0:u.getValue().trim();if(!o&&!s){new ye.Notice($("views.article-header.cover-image-mobile-required"));return}let l=null;if(o){let d=this.plugin.app.vault.getAbstractFileByPath(o);if(!(d instanceof ye.TFile)){new ye.Notice($("views.article-header.cover-image-mobile-invalid"));return}l=d.path}this.onSubmit({filePath:l,url:s||null}),this.close()}),a.createEl("button",{text:$("modals.cancel")}).addEventListener("click",()=>{this.close()})}onClose(){this.contentEl.empty()}}});var Re,ki,Bd=j(()=>{Re=require("obsidian");Fe();Jn();ki=class extends Re.Modal{constructor(t,n){super(t);this.plugin=n,this.updateCurrentAccount()}updateCurrentAccount(){let t=this.plugin.settings.selectedMPAccount;t&&(this.account=this.plugin.getMPAccountByName(t))}onOpen(){let{contentEl:t}=this;if(t.empty(),t.addClass("one2mp-publish-modal"),t.createEl("h2",{text:$("publish-config.title")}),!this.account){new Re.Notice($("wechat-api.select-an-wechat-mp-account-first")),this.close();return}this.renderMPCardSection(t),this.renderOtherSettings(t)}renderMPCardSection(t){let n=t.createEl("details",{cls:"one2mp-config-section"});n.open=!0,n.createEl("summary",{text:$("publish-config.mp-card-settings")});let i=n.createDiv({cls:"one2mp-config-content"}),a=i.createDiv({cls:"one2mp-card-preview"});this.renderCardPreview(a);let o=i.createDiv({cls:"one2mp-card-parser"});o.createEl("p",{text:$("publish-config.paste-html-guide"),cls:"setting-item-description"});let s=new Re.TextAreaComponent(o);s.setPlaceholder("<mp-common-profile ... >"),s.inputEl.rows=3,s.inputEl.setCssProps({width:"100%"});let c=o.createDiv({cls:"one2mp-parser-actions"}).createEl("button",{text:$("publish-config.parse-and-save")});c.onclick=()=>{let f=s.getValue();this.parseAndSaveCard(f)?(s.setValue(""),this.renderCardPreview(a),new Re.Notice($("publish-config.card-updated"))):new Re.Notice($("publish-config.parse-failed"))};let u=i.createEl("details",{cls:"one2mp-manual-edit"});u.createEl("summary",{text:$("publish-config.manual-edit")});let d=u.createDiv();this.renderManualFields(d,a)}renderCardPreview(t){t.empty();let n=this.plugin.settings.defaultMpcard;if(n&&n.includes("```mpcard")){let i=n.replace(/```mpcard|```/g,"").trim().split(`
`),a={};i.forEach(c=>{let[u,...d]=c.split(":");u&&d&&(a[u.trim()]=d.join(":").trim())});let o=t.createDiv({cls:"one2mp-mpcard-wrapper"});o.setCssProps({"max-width":"100%"});let s=o.createDiv({cls:"one2mp-mpcard-content"});if(a.headimg){let c=s.createEl("img",{cls:"one2mp-mpcard-headimg"});c.src=a.headimg}let l=s.createDiv({cls:"one2mp-mpcard-info"});l.createDiv({cls:"one2mp-mpcard-nickname",text:a.nickname||"No Nickname"}),l.createDiv({cls:"one2mp-mpcard-signature",text:a.signature||"No Signature"})}else t.createDiv({text:$("publish-config.mpcard-empty"),cls:"setting-item-description"})}parseAndSaveCard(t){let n=t.match(/data-nickname="([^"]*)"/),i=t.match(/data-headimg="([^"]*)"/),a=t.match(/data-signature="([^"]*)"/),o=t.match(/data-id="([^"]*)"/);return!n&&!i?!1:(n&&(this.plugin.settings.defaultMpcardNickname=n[1]),i&&(this.plugin.settings.defaultMpcardHeadimg=i[1]),a&&(this.plugin.settings.defaultMpcardSignature=a[1]),o&&(this.plugin.settings.defaultMpcardId=o[1]),this.saveSettings(),!0)}saveSettings(){var s,l,c,u;let t=[],n=(s=this.plugin.settings.defaultMpcardId)==null?void 0:s.trim(),i=(l=this.plugin.settings.defaultMpcardHeadimg)==null?void 0:l.trim(),a=(c=this.plugin.settings.defaultMpcardNickname)==null?void 0:c.trim(),o=(u=this.plugin.settings.defaultMpcardSignature)==null?void 0:u.trim();n&&t.push(`id: ${n}`),i&&t.push(`headimg: ${i}`),a&&t.push(`nickname: ${a}`),o&&t.push(`signature: ${o}`),t.length>0?this.plugin.settings.defaultMpcard=["```mpcard",...t,"```"].join(`
`):this.plugin.settings.defaultMpcard="",this.plugin.saveSettings()}renderManualFields(t,n){new Re.Setting(t).setName($("settings.default-mpcard-nickname")).setClass("one2mp-setting-wide").addText(i=>i.setValue(this.plugin.settings.defaultMpcardNickname||"").onChange(a=>{this.plugin.settings.defaultMpcardNickname=a,this.saveSettings(),this.renderCardPreview(n)})),new Re.Setting(t).setName($("settings.default-mpcard-headimg")).setClass("one2mp-setting-wide").addText(i=>i.setValue(this.plugin.settings.defaultMpcardHeadimg||"").onChange(a=>{this.plugin.settings.defaultMpcardHeadimg=a,this.saveSettings(),this.renderCardPreview(n)})),new Re.Setting(t).setName($("settings.default-mpcard-signature")).setClass("one2mp-setting-wide").addTextArea(i=>i.setValue(this.plugin.settings.defaultMpcardSignature||"").setPlaceholder("...").onChange(a=>{this.plugin.settings.defaultMpcardSignature=a,this.saveSettings(),this.renderCardPreview(n)})),t.findAll("textarea").forEach(i=>i.rows=4),new Re.Setting(t).setName($("settings.default-mpcard-biz-id")).setDesc($("settings.default-mpcard-biz-id-desc")).setClass("one2mp-setting-wide").addText(i=>i.setValue(this.plugin.settings.defaultMpcardId||"").onChange(a=>{this.plugin.settings.defaultMpcardId=a,this.saveSettings()}))}renderOtherSettings(t){let n=t.createEl("details",{cls:"one2mp-config-section"});n.createEl("summary",{text:$("publish-config.other-settings")});let i=n.createDiv({cls:"one2mp-config-content"});new Re.Setting(i).setName($("settings.draft-previewer-wechat-id")).setDesc($("settings.draft-only-visible-for-the-wechat-user-o")).addText(o=>o.setValue(this.plugin.settings.previewer_wxname||"").onChange(s=>{this.plugin.settings.previewer_wxname=s,this.plugin.saveSettings()})).addButton(o=>{o.setButtonText($("views.preview-draft")).setIcon("eye").setTooltip($("settings.preview-draft-tooltip")).onClick(()=>{(async()=>{var u;if(!((u=this.plugin.settings.previewer_wxname)!=null&&u.trim())){new Re.Notice($("views.previewer.preview-draft-missing-wxid"));return}let s=await Et.getInstance(this.plugin).getDrafOfActiveNote(),l=s==null?void 0:s.last_draft_id;if(!l){new Re.Notice($("views.previewer.preview-draft-missing-id"));return}await this.plugin.wechatClient.senfForPreview(l)&&new Re.Notice($("views.previewer.preview-draft-sent"))})()})})}onClose(){let{contentEl:t}=this;t.empty()}}});var Ze,dw,fw,hw,qd,Si,Nd=j(()=>{yo();Ze={heading:["\u2728","\u{1F539}","\u{1F538}"],listStyle:"\u25AB\uFE0F",orderedListStyle:["1\uFE0F\u20E3","2\uFE0F\u20E3","3\uFE0F\u20E3","4\uFE0F\u20E3","5\uFE0F\u20E3","6\uFE0F\u20E3","7\uFE0F\u20E3","8\uFE0F\u20E3","9\uFE0F\u20E3","\u{1F51F}"],taskListStyle:["\u{1F532}","\u2705"],hr:"---------------------"},dw=r=>{if(!r.startsWith("---"))return r;let e=r.indexOf(`
---`,3);return e===-1?r:r.slice(e+4)},fw=r=>r.replace(/<[^>]*>/g,""),hw=r=>r.replace(/\n{3,}/g,`

`).trim(),qd=r=>Ze.orderedListStyle[r-1]||`${r}.`,Si=class{buildRenderer(e){let t=o=>{if(o==null)return"";if(typeof o=="string")return o;let s=o;return typeof s.text=="string"?s.text:typeof s.raw=="string"?s.raw:""},n=(o,s)=>{let l=o;return l&&typeof l.depth=="number"?l.depth:l&&typeof l.level=="number"?l.level:typeof s=="number"?s:1},i=(o,s,l=1)=>{let c="",u=l;for(let d of o){let f=d.trim();if(!f)continue;if(s){c+=`${qd(u)} ${f}
`,u+=1;continue}let m=f.startsWith(Ze.taskListStyle[0])||f.startsWith(Ze.taskListStyle[1]);c+=m?`${f}
`:`${Ze.listStyle} ${f}
`}return`
${c}
`};return{heading(o,s){let l=t(o),c=n(o,s);return`${Ze.heading[c-1]||""} ${l}

`},paragraph(o){return`${t(o)}

`},strong(o){return t(o)},em(o){return t(o)},codespan(o){return t(o)},code(o,s){var d;let l=typeof o=="string"?o:(d=o==null?void 0:o.text)!=null?d:"",c=(o&&typeof o.lang=="string"?o.lang:s)||"";return`\u3010\u4EE3\u7801\u5757${c?`\uFF08${c}\uFF09`:""}\u3011
${l}

`},blockquote(o){return`${t(o).split(`
`).filter(c=>c.trim()).map(c=>`    ${c}`).join(`
`)}

`},hr(){return`
${Ze.hr}
`},list(o,s){var u,d;if(typeof o=="string"){let f=o.split(`
`);return i(f,!!s,1)}let l=(d=(u=o==null?void 0:o.ordered)!=null?u:s)!=null?d:!1,c=typeof(o==null?void 0:o.start)=="number"?o.start:1;if(Array.isArray(o==null?void 0:o.items)){let f="",m=c;for(let w of o.items){let C=t(w);if(l){f+=`${qd(m)} ${C}
`,m+=1;continue}if(w!=null&&w.task){let k=w.checked?Ze.taskListStyle[1]:Ze.taskListStyle[0];f+=`${k} ${C}
`;continue}f+=`${Ze.listStyle} ${C}
`}return`
${f}
`}return""},listitem(o,s,l){var f,m,w;if(typeof o=="string")return s?`${l?Ze.taskListStyle[1]:Ze.taskListStyle[0]} ${o}`:o;let c=t(o);return((m=(f=o==null?void 0:o.task)!=null?f:s)!=null?m:!1)?`${((w=o==null?void 0:o.checked)!=null?w:l)?Ze.taskListStyle[1]:Ze.taskListStyle[0]} ${c}`:c},link(o,s,l){var d,f,m;if(typeof o=="string")return o;let c=(d=o==null?void 0:o.href)!=null?d:"",u=(m=(f=o==null?void 0:o.text)!=null?f:l)!=null?m:"";return c?`${u}\uFF08\u94FE\u63A5\uFF1A${c}\uFF09`:u},image(o){var l;let s=(l=o==null?void 0:o.href)!=null?l:typeof o=="string"?o:"";return e.push(s||""),`\u3010\u56FE${e.length}\u3011`},br(){return`
`}}}async parse(e){let t=dw(e),n=[],i=new Ht;i.use({gfm:!0,breaks:!0}),i.use({renderer:this.buildRenderer(n)});let a=await i.parse(t);return{text:hw(fw(String(a))),images:n}}}});var Ve,jd,Io,pw,gw,zd,Hd=j(()=>{Ve=require("obsidian"),jd=r=>r.replace(/[\\/:*?"<>|]/g,"-").trim()||"\u672A\u547D\u540D",Io=async(r,e)=>{r.vault.getAbstractFileByPath(e)||await r.vault.createFolder(e)},pw=(r,e)=>{var u,d,f,m,w,C,k,v;let t=r.vault,n=r.workspace.getActiveFile(),i=t.config,a=(u=i==null?void 0:i.attachmentFolderPath)!=null?u:"",o=e.trim();if(!o)return null;o=o.split("|")[0].split("?")[0].split("#")[0],(o.startsWith("/")||o.startsWith("\\"))&&(o=o.slice(1));let s=t.getAbstractFileByPath(o);if(s instanceof Ve.TFile)return s;let l=r.metadataCache.getFirstLinkpathDest(o,(d=n==null?void 0:n.path)!=null?d:"");if(l instanceof Ve.TFile)return l;if((f=n==null?void 0:n.parent)!=null&&f.path){let g=`${n.parent.path}/${o}`,h=t.getAbstractFileByPath(g);if(h instanceof Ve.TFile)return h}let c=o.split("/").pop()||o;if(a){let g=[];if(a.startsWith("./")){let h=a.slice(2);g.push(`${(w=(m=n==null?void 0:n.parent)==null?void 0:m.path)!=null?w:""}/${h}/${c}`),g.push(`${(k=(C=n==null?void 0:n.parent)==null?void 0:C.path)!=null?k:""}/${h}/${o}`)}else g.push(`${a}/${c}`),g.push(`${a}/${o}`),(v=n==null?void 0:n.parent)!=null&&v.path&&(g.push(`${n.parent.path}/${a}/${c}`),g.push(`${n.parent.path}/${a}/${o}`));for(let h of g){let p=t.getAbstractFileByPath(h);if(p instanceof Ve.TFile)return p}}return null},gw=()=>{let r=new Date,e=t=>String(t).padStart(2,"0");return`${r.getFullYear()}${e(r.getMonth()+1)}${e(r.getDate())}-${e(r.getHours())}${e(r.getMinutes())}${e(r.getSeconds())}`},zd=async(r,e,t)=>{var m;let n=await r.vault.cachedRead(e),i=await t.parse(n),a=((m=e.parent)==null?void 0:m.path)||"",o=jd(e.basename),s=(0,Ve.normalizePath)(`${a}/\u5C0F\u7EA2\u4E66\u5BFC\u51FA/${o}-${gw()}`),l=(0,Ve.normalizePath)(`${s}/\u56FE\u7247`);await Io(r,(0,Ve.normalizePath)(`${a}/\u5C0F\u7EA2\u4E66\u5BFC\u51FA`)),await Io(r,s),await Io(r,l);let c=(0,Ve.normalizePath)(`${s}/\u6587\u6848.txt`);await r.vault.create(c,i.text);let u="",d=0;for(let w=0;w<i.images.length;w+=1){let C=i.images[w],k=w+1,v=pw(r,C);if(!v){u+=`\u56FE${k}: \u672A\u627E\u5230\uFF08${C}\uFF09
`;continue}let g=v.extension||"png",h=`${String(k).padStart(2,"0")}-${jd(v.basename)}.${g}`,p=(0,Ve.normalizePath)(`${l}/${h}`),b=await r.vault.readBinary(v);await r.vault.adapter.writeBinary(p,b),u+=`\u56FE${k}: ${h}\uFF08\u539F\u59CB\uFF1A${C}\uFF09
`,d+=1}let f=(0,Ve.normalizePath)(`${s}/\u4E0A\u4F20\u987A\u5E8F.txt`);return await r.vault.create(f,u.trim()+`
`),new Ve.Notice(`\u5C0F\u7EA2\u4E66\u7D20\u6750\u5DF2\u5BFC\u51FA\uFF1A${s}\uFF08${d}/${i.images.length}\uFF09`),{folder:s,imageCount:i.images.length,successCount:d}}});var Wd={};Ct(Wd,{ThemeSelector:()=>Do});var Ud,Do,Vd=j(()=>{Ud=require("obsidian");$n();Fe();Do=class{constructor(e){this.plugin=e,this._themeManager=an.getInstance(e),this.plugin.messageService.registerListener("custom-theme-folder-changed",()=>{this.updateThemeOptions()})}async dropdown(e){this._themeDropdown=e,await this.updateThemeOptions(),e.onChange(t=>{this.plugin.settings.custom_theme=t,this.plugin.saveSettings(),this.plugin.messageService.sendMessage("custom-theme-changed",t)})}async updateThemeOptions(){let e=await this._themeManager.loadThemes();this._themeDropdown.selectEl.length=0,this._themeDropdown.addOption("--default--",$("views.theme-manager.default-theme")),e.forEach(t=>{this._themeDropdown.addOption(t.path,t.name)}),this.plugin.settings.custom_theme===void 0||!this.plugin.settings.custom_theme?this._themeDropdown.setValue("--default--"):this._themeDropdown.setValue(this.plugin.settings.custom_theme)}onThemeChange(e){e instanceof Ud.TFile&&e.extension==="md"&&e.path.startsWith(this.plugin.settings.css_styles_folder)&&this.updateThemeOptions()}startWatchThemes(){this.plugin.registerEvent(this.plugin.app.vault.on("rename",e=>{this.onThemeChange(e)})),this.plugin.registerEvent(this.plugin.app.vault.on("modify",e=>{this.onThemeChange(e)})),this.plugin.registerEvent(this.plugin.app.vault.on("create",e=>{this.onThemeChange(e)})),this.plugin.registerEvent(this.plugin.app.vault.on("delete",e=>{this.onThemeChange(e)}))}}});var Kd={};Ct(Kd,{PreviewPanel:()=>Lo,VIEW_TYPE_ONE2MP_PREVIEW:()=>Oo});var de,Oo,Lo,Gd=j(()=>{de=require("obsidian");Fe();Zn();qu();lo();To();Ii();Qn();Fd();Bd();ze();Nd();Hd();Oo="one2mp-article-preview",Lo=class extends de.ItemView{constructor(t,n){super(t);this.markdownView=null;this.listeners=[];this.messageUnsubscribes=[];this.themeSelector=null;this.themeManagerModule=null;this.allowRender=!1;this.initialRenderScheduled=!1;this.debouncedRender=(0,de.debounce)(async()=>{this.plugin.settings.realTimeRender&&await this.renderDraft()},1e3);this.debouncedUpdate=(0,de.debounce)(async()=>{this.plugin.settings.realTimeRender&&await this.renderDraft()},1e3);this.debouncedCustomThemeChange=(0,de.debounce)(t=>{this.renderDraft(!0)},2e3);this.activePlatform="wechat";this.platformTabsEl=null;this.wechatPanelEl=null;this.zhihuPanelEl=null;this.redbookPanelEl=null;this.zhihuPreviewEl=null;this.redbookPreviewEl=null;this.redbookParser=new Si;this.redbookResult=null;this.redbookResultPath=null;this.articleProperties=new Map;this.editorView=null;this.isActive=!1;this.wechatHtml=null;this.plugin=n,this.wechatClient=ot.getInstance(this.plugin)}getViewType(){return Oo}getDisplayText(){return $("views.previewer.one2mp-previewer")}getIcon(){return"one2mp-logo"}async onOpen(){var t,n;await this.ensureThemeSelector(),this.buildUI(),this.startListen(),this.isActive=!0,this.markdownView=(t=ft.getInstance(this.plugin).getCurrentMarkdownView())!=null?t:null,this.scheduleInitialRender(),this.messageUnsubscribes.push(this.plugin.messageService.registerListener("draft-title-updated",i=>{this.setPreviewTitle(i)})),(n=this.themeSelector)==null||n.startWatchThemes(),this.messageUnsubscribes.push(this.plugin.messageService.registerListener("custom-theme-changed",i=>{this.debouncedCustomThemeChange(i)})),this.plugin.messageService.sendMessage("active-file-changed",null),await this.loadComponents()}scheduleInitialRender(){if(this.initialRenderScheduled)return;this.initialRenderScheduled=!0;let t=()=>{this.renderDraft(!0)};this.plugin.app.workspace.onLayoutReady(()=>{let n=window.requestIdleCallback;typeof n=="function"?n(t,{timeout:2e3}):setTimeout(t,300)})}async ensureThemeSelector(){if(this.themeSelector)return;let{ThemeSelector:t}=await Promise.resolve().then(()=>(Vd(),Wd));this.themeSelector=new t(this.plugin)}async getThemeManager(){return this.themeManagerModule||(this.themeManagerModule=await Promise.resolve().then(()=>($n(),wr))),this.themeManagerModule.ThemeManager}getArticleProperties(){let t=this.plugin.app.workspace.getActiveFile();if((t==null?void 0:t.extension)==="md"||(t==null?void 0:t.extension)==="markdown"){let n=this.app.metadataCache.getCache(t.path),i=n==null?void 0:n.frontmatter;this.articleProperties.clear(),i!=null&&Object.keys(i).forEach(a=>{this.articleProperties.set(a,i[a])})}return this.articleProperties}async setArticleProperties(){let t=this.getCurrentMarkdownFile();if(t&&this.articleProperties.size>0){let n=this.app.vault.getAbstractFileByPath(t);if(!(n instanceof de.TFile))throw new Error($("views.previewer.file-not-found-path",[t]));await this.app.fileManager.processFrontMatter(n,i=>{this.articleProperties.forEach((a,o)=>{i[o]=a})})}}getCurrentMarkdownFile(){var i,a;let t=this.plugin.app.workspace.getActiveFile(),n=this.plugin.app.workspace.getLeavesOfType("markdown");for(let o of n){let s=o.view;if(((i=s.file)==null?void 0:i.path)===(t==null?void 0:t.path))return(a=s.file)==null?void 0:a.path}return null}buildUI(){let t=this.containerEl.children[1];t.empty(),t.addClass("one2mp-preview-container"),this.buildToolbar(t);let n=t.createDiv({cls:"one2mp-main-scroll-area"});this.platformTabsEl=this.buildPlatformTabs(n);let i=n.createDiv({cls:"one2mp-platform-panels"});this.wechatPanelEl=i.createDiv({cls:"one2mp-platform-panel one2mp-platform-panel-active"}),this.draftHeader=new _i(this.plugin,this.wechatPanelEl),this.previewTitleEl=this.wechatPanelEl.createDiv({cls:"one2mp-preview-title"}),this.setPreviewTitle(),this.renderDiv=this.wechatPanelEl.createDiv({cls:"render-container"}),this.renderDiv.id="render-div",this.renderPreviewer=this.wechatPanelEl.createDiv({cls:"one2mp-render-preview"}),this.containerDiv=this.renderDiv.createDiv({cls:"one2mp-article"}),this.articleDiv=this.containerDiv.createDiv({cls:"article-div"}),this.zhihuPanelEl=i.createDiv({cls:"one2mp-platform-panel"}),this.buildZhihuPanel(this.zhihuPanelEl),this.redbookPanelEl=i.createDiv({cls:"one2mp-platform-panel"}),this.buildRedbookPanel(this.redbookPanelEl)}buildToolbar(t){let n=t.createDiv({cls:"one2mp-preview-toolbar"}),i=n.createDiv({cls:"toolbar-group-left"});this.accountDropdown=new de.DropdownComponent(i),this.updateAccountOptions(),this.accountDropdown.onChange(f=>{this.plugin.settings.selectedMPAccount=f,this.plugin.saveSettings(),this.plugin.messageService.sendMessage("wechat-account-changed",f),new de.Notice(`Switched to: ${f}`)}),n.createDiv({cls:"toolbar-group-center"});let a=n.createDiv({cls:"toolbar-group-right"}),o=a.createDiv({cls:"one2mp-toolbar-actions-group"}),s=new de.DropdownComponent(o);this.themeSelector?this.themeSelector.dropdown(s):(s.addOption("--default--",$("views.theme-manager.default-theme")),s.setDisabled(!0));let l=(f,m,w)=>{let C=o.createEl("button",{cls:"clickable-icon one2mp-toolbar-btn"});return(0,de.setIcon)(C,f),C.setAttribute("aria-label",m),C.onclick=w,C};l("settings",$("views.previewer.publish-config"),()=>{new ki(this.app,this.plugin).open()}),l("refresh-cw",$("views.previewer.render-article"),()=>{this.renderDraft(!0)}),l("clipboard-copy",$("views.previewer.copy-article-to-clipboard"),()=>{var m,w;let f=this.getArticleContent();if((m=navigator.clipboard)!=null&&m.write&&window.ClipboardItem){navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([f],{type:"text/html"})})]).then(()=>{new de.Notice($("views.previewer.article-copied-to-clipboard"))}).catch(C=>{console.warn("\u590D\u5236\u5230\u526A\u8D34\u677F\u5931\u8D25",C)});return}if((w=navigator.clipboard)!=null&&w.writeText){navigator.clipboard.writeText(f).then(()=>{new de.Notice($("views.previewer.article-copied-to-clipboard"))}).catch(C=>{console.warn("\u590D\u5236\u5230\u526A\u8D34\u677F\u5931\u8D25",C)});return}new de.Notice($("settings.clipboard-not-supported"))}),l("send-horizontal",$("views.previewer.send-article-to-draft-box"),()=>{(async()=>await this.checkCoverImage()?this.sendArticleToDraftBox():new de.Notice($("views.previewer.please-set-cover-image")))()});let c=a.createDiv({cls:"one2mp-toolbar-ip"}),u=f=>{if(c.empty(),!f.direct&&!f.proxy){c.setText("IP: ...");return}let m=(w,C)=>{let k=c.createDiv({cls:"one2mp-ip-subrow"});k.createSpan({text:w+": ",cls:"label"});let v=C==="single"?f.direct||f.proxy:C==="direct"?f.direct:f.proxy;k.createSpan({text:v,cls:"value"}),k.title=`\u70B9\u51FB\u5237\u65B0\u5E76\u590D\u5236 ${w} IP`,k.onclick=g=>{g.stopPropagation(),(async()=>{var h;new de.Notice("\u6B63\u5728\u5237\u65B0 IP...");try{let p=await this.plugin.updateIpAddress();u(p);let b=C==="single"?p.direct||p.proxy:C==="direct"?p.direct:p.proxy;b?(h=navigator.clipboard)!=null&&h.writeText?(await navigator.clipboard.writeText(b),new de.Notice(`${w} IP \u5DF2\u5237\u65B0\u5E76\u590D\u5236`)):new de.Notice($("settings.clipboard-not-supported")):new de.Notice("\u65E0\u6CD5\u83B7\u53D6 IP")}catch(p){new de.Notice("\u5237\u65B0 IP \u5931\u8D25"),console.error(p)}})()}};f.direct===f.proxy||!f.proxy||!f.direct?m("IP","single"):(f.direct&&m("\u76F4\u8FDE","direct"),f.proxy&&m("\u4EE3\u7406","proxy"))},d={};try{d=JSON.parse(this.plugin.settings.ipAddress||"{}")}catch(f){console.debug("Failed to parse cached IP address:",f)}u(d),this.plugin.updateIpAddress().then(f=>{u(f)}).catch(f=>{console.debug("Failed to refresh IP address:",f)})}buildPlatformTabs(t){let n=t.createDiv({cls:"one2mp-platform-tabs"});return[{id:"wechat",label:$("views.platform.wechat")},{id:"zhihu",label:$("views.platform.zhihu")},{id:"redbook",label:$("views.platform.redbook")}].forEach(a=>{let o=n.createEl("button",{cls:"one2mp-platform-tab",text:a.label});o.dataset.platform=a.id,a.id===this.activePlatform&&o.addClass("one2mp-platform-tab-active"),o.onclick=()=>{this.setActivePlatform(a.id)}}),n}setActivePlatform(t){var a;this.activePlatform=t;let n=(a=this.platformTabsEl)==null?void 0:a.querySelectorAll(".one2mp-platform-tab");n&&n.forEach(o=>{let s=o.dataset.platform===t;o.classList.toggle("one2mp-platform-tab-active",s)}),[{id:"wechat",el:this.wechatPanelEl},{id:"zhihu",el:this.zhihuPanelEl},{id:"redbook",el:this.redbookPanelEl}].forEach(o=>{o.el&&o.el.classList.toggle("one2mp-platform-panel-active",o.id===t)})}buildZhihuPanel(t){let n=t.createDiv({cls:"one2mp-platform-actions"}),i=(a,o)=>{n.createEl("button",{text:a}).onclick=o};i($("views.zhihu.copy"),()=>{let a=this.getArticleContent();this.copyHtmlToClipboard(a)}),i($("views.zhihu.open"),()=>{this.openUrl("https://zhuanlan.zhihu.com/write")}),i($("views.zhihu.refresh"),()=>{this.refreshZhihuPreview()}),this.zhihuPreviewEl=t.createDiv({cls:"one2mp-platform-preview one2mp-platform-zhihu"})}buildRedbookPanel(t){let n=t.createDiv({cls:"one2mp-platform-actions"}),i=(a,o)=>{n.createEl("button",{text:a}).onclick=o};i($("views.redbook.copy"),()=>{var o,s;let a=(s=(o=this.redbookResult)==null?void 0:o.text)!=null?s:"";this.copyTextToClipboard(a,$("views.redbook.copied"))}),i($("views.redbook.export"),()=>{(async()=>{let a=this.app.workspace.getActiveFile();if(!a||a.extension!=="md"){new de.Notice($("views.redbook.no-active-file"));return}await zd(this.app,a,this.redbookParser)})()}),i($("views.redbook.open"),()=>{this.openUrl("https://creator.xiaohongshu.com/")}),i($("views.redbook.refresh"),()=>{this.refreshRedbookPreview()}),this.redbookPreviewEl=t.createDiv({cls:"one2mp-platform-preview one2mp-platform-redbook"})}async refreshZhihuPreview(){if(!this.zhihuPreviewEl)return;let t=this.getArticleContent();this.zhihuPreviewEl.empty();let n=(0,de.sanitizeHTMLToDom)(t);this.zhihuPreviewEl.appendChild(n);let i=this.zhihuPreviewEl.firstElementChild;if(i){let a=await this.getThemeManager();a&&await a.getInstance(this.plugin).applyTheme(i)}}async refreshRedbookPreview(){if(!this.redbookPreviewEl)return;let t=this.app.workspace.getActiveFile();if(!t||t.extension!=="md"){this.redbookPreviewEl.setText($("views.redbook.no-active-file"));return}let n=await this.app.vault.cachedRead(t),i=await this.redbookParser.parse(n);this.redbookResult=i,this.redbookResultPath=t.path,this.redbookPreviewEl.empty(),this.redbookPreviewEl.createEl("pre",{text:i.text}).addClass("one2mp-redbook-pre")}async copyHtmlToClipboard(t){var n,i;if((n=navigator.clipboard)!=null&&n.write&&window.ClipboardItem)try{await navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([t],{type:"text/html"})})]),new de.Notice($("views.zhihu.copied"));return}catch(a){console.warn("\u590D\u5236\u5230\u526A\u8D34\u677F\u5931\u8D25",a)}if((i=navigator.clipboard)!=null&&i.writeText)try{await navigator.clipboard.writeText(t),new de.Notice($("views.zhihu.copied"));return}catch(a){console.warn("\u590D\u5236\u5230\u526A\u8D34\u677F\u5931\u8D25",a)}new de.Notice($("settings.clipboard-not-supported"))}async copyTextToClipboard(t,n){var i;if(!t){new de.Notice($("views.redbook.empty"));return}if((i=navigator.clipboard)!=null&&i.writeText)try{await navigator.clipboard.writeText(t),new de.Notice(n);return}catch(a){console.warn("\u590D\u5236\u5230\u526A\u8D34\u677F\u5931\u8D25",a)}new de.Notice($("settings.clipboard-not-supported"))}updateAccountOptions(){let t=this.accountDropdown;t.selectEl.empty(),this.plugin.settings.mpAccounts.length===0?t.addOption("",$("modals.publish-config.no-account")):(this.plugin.settings.mpAccounts.forEach(n=>{t.addOption(n.accountName,n.accountName)}),this.plugin.settings.selectedMPAccount&&t.setValue(this.plugin.settings.selectedMPAccount))}setPreviewTitle(t){var a,o;if(!this.previewTitleEl)return;let n=(o=(a=this.app.workspace.getActiveFile())==null?void 0:a.basename)!=null?o:$("views.previewer.article-title"),i=t&&t.trim()?t.trim():n;this.previewTitleEl.setText(i),this.previewTitleEl.setAttr("title",i)}async checkCoverImage(){return this.draftHeader.checkCoverImage()}async sendArticleToDraftBox(){let t=this.articleDiv.firstElementChild;if(t){let i=await this.getThemeManager();i&&await i.getInstance(this.plugin).applyTheme(t)}await Lu(this.articleDiv,this.plugin.wechatClient),await Mu(this.articleDiv,this.plugin.wechatClient),await Ru(this.articleDiv,this.plugin.wechatClient,this.app),await Bu(this.articleDiv,this.plugin.wechatClient);let n=await this.wechatClient.sendArticleToDraftBox(this.draftHeader.getActiveLocalDraft(),this.getArticleContent());if(n){this.draftHeader.updateDraftDraftId(n);let i=await this.wechatClient.getDraftById(this.plugin.settings.selectedMPAccount,n);if(i){this.openUrl(i[0].url);let a={media_id:n,content:{news_item:i},update_time:Date.now()};this.plugin.messageService.sendMessage("draft-item-updated",a)}}}getArticleContent(){let t=this.articleDiv.firstElementChild,n=t==null?void 0:t.querySelector("p"),i=n&&window.getComputedStyle(n).color||t&&window.getComputedStyle(t).color||void 0,a=this.articleDiv.cloneNode(!0);return Fu(a,i),st.getInstance().restoreCard(tt(a))}onClose(){return this.stopListen(),this.messageUnsubscribes.forEach(t=>t()),this.messageUnsubscribes=[],Promise.resolve()}async parseActiveMarkdown(){var s;this.getArticleProperties();let t=ft.getInstance(this.plugin).getCurrentMarkdownView()||this.markdownView;if(!t)return $("views.previewer.not-a-markdown-view");this.articleDiv.empty(),this.elementMap=new Map;let n=(s=t.file)!=null?s:this.app.workspace.getActiveFile();if(!n)return"<h1>No active file</h1>";if(n.extension!=="md")return"<h1>Not a markdown file</h1>";await Ae.getInstance(this.plugin.app).render(n.path,this.renderPreviewer,this);let i=await Kt.getInstance(this.plugin,this).parseNote(n.path);this.wechatHtml=i;let a=createEl("section",{cls:"one2mp-article-content one2mp"}),o=(0,de.sanitizeHTMLToDom)(i);a.appendChild(o),this.articleDiv.empty(),this.articleDiv.appendChild(a);for(let[l,c]of this.elementMap.entries()){let u=this.articleDiv.querySelector("#"+l);if(u)if(typeof c=="string"){let d=ft.getInstance(this.plugin).getFileOfLink(c);if(d){let f=this.plugin.app.vault.getFileByPath(d.path);if(f){let m=await Kt.getInstance(this.plugin,this).parseNote(f.path);u.empty(),u.appendChild((0,de.sanitizeHTMLToDom)(m))}}}else u.appendChild(c)}}async renderDraft(t=!1){if(t&&(this.allowRender=!0),!this.allowRender||!this.isViewActive()||(await this.parseActiveMarkdown(),await this.refreshZhihuPreview(),await this.refreshRedbookPreview(),this.articleDiv===null||this.articleDiv.firstChild===null))return;let n=this.articleDiv.firstChild,i=()=>{n.isConnected&&(async()=>{let o=await this.getThemeManager();o&&await o.getInstance(this.plugin).applyTheme(n)})()},a=window.requestIdleCallback;typeof a=="function"?a(i):setTimeout(i,0)}isViewActive(){return this.isActive&&!this.app.workspace.rightSplit.collapsed}startListen(){this.registerEvent(this.plugin.app.vault.on("rename",i=>{this.draftHeader.onNoteRename(i)})),this.registerEvent(this.app.workspace.on("layout-change",()=>{let i=this.app.workspace.getLeavesOfType(Oo).length>0;this.isActive=i}));let t=this.app.workspace.on("editor-change",()=>{this.onEditorChange()});this.listeners.push(t);let n=this.app.workspace.on("active-leaf-change",i=>{i&&(i.view.getViewType()==="markdown"?(this.markdownView=i.view,this.lastLeaf=i,this.plugin.messageService.sendMessage("active-file-changed",null),this.debouncedUpdate()):this.isActive=i.view===this)});this.listeners.push(n)}stopListen(){this.listeners.forEach(t=>this.app.workspace.offref(t))}onEditorChange(){this.debouncedRender()}updateElementByID(t,n){let i=this.articleDiv.querySelector("#"+t);if(!i)return;let a=(0,de.sanitizeHTMLToDom)(n);i.empty(),i.appendChild(a)}addElementByID(t,n){typeof n=="string"?this.elementMap.set(t,n):this.elementMap.set(t,n.cloneNode(!0))}async loadComponents(){let t=this,n=async(i,a=new Set)=>{var s,l;if(a.has(i))return;a.add(i);let o=i;if((s=o._children)!=null&&s.length)for(let c of o._children)await n(c,a);try{if(((l=i==null?void 0:i.constructor)==null?void 0:l.name)==="SheetElement"){let u=i.onload();u&&typeof u.then=="function"&&await u}}catch(c){console.error("Error calling onload()",c)}};await n(t)}openUrl(t){if(!t)return;if(typeof window!="undefined"&&typeof window.open=="function"){window.open(t);return}let n=this.app;if(n.openWithDefaultApp){n.openWithDefaultApp(t);return}new de.Notice($("views.previewer.open-url-not-supported"))}}});var yw={};Ct(yw,{default:()=>Ei});module.exports=hf(yw);var Ye=require("obsidian");var $i=require("obsidian");async function Ro(){let r=async()=>{try{return(await(0,$i.requestUrl)("https://api.ipify.org?format=json")).json.ip}catch(i){console.warn("Failed to fetch proxy IP",i);return}},e=async()=>{try{return(await(0,$i.requestUrl)("https://myip.ipip.net/json")).json.data.ip}catch(i){console.warn("Failed to fetch direct IP",i);return}},[t,n]=await Promise.all([r(),e()]);return{proxy:t,direct:n}}Ii();Fe();var ns=require("obsidian");Fe();var hr=class extends ns.Modal{constructor(t,n,i){super(t);this.message=n;this.resolve=i}onOpen(){let{contentEl:t}=this;t.createEl("p",{text:this.message});let n=t.createDiv("modal-button-container");n.createEl("button",{text:$("modals.confirm")}).addEventListener("click",()=>{this.resolve(!0),this.close()}),n.createEl("button",{text:$("modals.cancel")}).addEventListener("click",()=>{this.resolve(!1),this.close()})}onClose(){let{contentEl:t}=this;t.empty()}};var re=require("obsidian");Fe();var gr=require("obsidian"),pr=class extends gr.AbstractInputSuggest{constructor(t,n){super(t,n);this.inputEl=n}getSuggestions(t){return this.app.vault.getAllLoadedFiles().filter(i=>i instanceof gr.TFolder).filter(i=>i.path.toLowerCase().includes(t.toLowerCase()))}renderSuggestion(t,n){n.setText(t.path)}selectSuggestion(t){this.inputEl.value=t.path,this.inputEl.trigger("input"),this.close()}};qi();var br=class extends re.PluginSettingTab{constructor(t,n){super(t,n);this.plugin=n}display(){let{containerEl:t}=this;t.empty(),t.addClass("one2mp-settings"),this.createAccountManagement(t),this.createGeneralSettings(t),this.creatCSSStyleSetting(t),this.createBackupRestore(t)}createAccountManagement(t){new re.Setting(t).setName($("settings.wechat-account")).setHeading().addExtraButton(i=>{i.setIcon("plus").setTooltip($("settings.create-new-account")).onClick(()=>{this.createNewAccount()})});let n=t.createDiv({cls:"one2mp-appid-guide"});n.createEl("span",{text:$("settings.appid-secret-guide")+" ",cls:"setting-item-description"}),n.createEl("a",{href:"https://developers.weixin.qq.com/console/",text:$("settings.appid-secret-guide-link")}).setAttr("target","_blank"),this.plugin.settings.mpAccounts.length===0?t.createDiv({cls:"one2mp-no-account"}).createEl("p",{text:$("settings.select-account")}):this.plugin.settings.mpAccounts.forEach((i,a)=>{this.renderAccountItem(t,i,a)})}renderAccountItem(t,n,i){let o=t.createDiv({cls:"one2mp-account-item"}).createEl("details");i===0&&(o.open=!0);let s=o.createEl("summary");s.setText(n.accountName||$("settings.new-account"));let l=o.createDiv({cls:"one2mp-account-details"});new re.Setting(l).setName($("settings.account-name")).setDesc($("settings.account-name-for-your-wechat-official")).setClass("one2mp-setting-wide").addText(u=>u.setValue(n.accountName).onChange(d=>{n.accountName=d,s.setText(d),this.plugin.settings.selectedMPAccount===this.plugin.settings.mpAccounts[i].accountName&&(this.plugin.settings.selectedMPAccount=d),this.plugin.saveSettings()})),new re.Setting(l).setName($("settings.appid")).setDesc($("settings.appid-for-your-wechat-official-account")).setClass("one2mp-setting-wide").addText(u=>u.setValue(n.appId).setPlaceholder("wx...").onChange(d=>{n.appId=d.trim(),this.plugin.saveSettings()})),new re.Setting(l).setName($("settings.app-secret")).setDesc($("settings.app-secret-for-your-wechat-official")).setClass("one2mp-setting-wide").addText(u=>u.setValue(n.appSecret).setPlaceholder("...").onChange(d=>{let f=d.replace(/\s+/g,"");f!==d&&u.setValue(f),n.appSecret=f,this.plugin.saveSettings()}));let c=new re.Setting(l).setName("");c.addButton(u=>{u.setTooltip($("settings.click-to-connect-wechat-server")).setIcon("plug-zap").setButtonText($("settings.test-connection")).onClick(()=>{(async()=>await this.plugin.TestAccessToken(n.accountName)?new re.Notice($("settings.successfully-connected-to-wechat-server")):new re.Notice($("settings.failed-to-connect-to-wechat-server")))()})}),c.addButton(u=>{u.setTooltip($("settings.delete-account")).setIcon("trash-2").setButtonText($("settings.delete-account")).setClass("mod-warning").onClick(()=>{var d;this.plugin.settings.mpAccounts.splice(i,1),this.plugin.settings.selectedMPAccount===n.accountName&&(this.plugin.settings.selectedMPAccount=(d=this.plugin.settings.mpAccounts[0])==null?void 0:d.accountName),this.plugin.saveSettings(),this.display()})})}createNewAccount(){let t=1,n=$("settings.new-account");for(;this.plugin.settings.mpAccounts.some(a=>a.accountName===n);)t++,n=`${$("settings.new-account")} ${t}`;let i={accountName:n,appId:"",appSecret:""};this.plugin.settings.mpAccounts.push(i),this.plugin.settings.selectedMPAccount||(this.plugin.settings.selectedMPAccount=n),this.plugin.saveSettings(),this.display()}createGeneralSettings(t){new re.Setting(t).setName($("settings.general-settings")).setHeading();let n=new re.Setting(t).setName($("settings.public-ip-address")).setDesc($("settings.you-should-add-this-ip-to-ip-whitelist-o")),i=o=>{n.controlEl.empty(),n.controlEl.addClass("one2mp-ip-container");let s=(l,c)=>{if(!c)return;let u=n.controlEl.createDiv({cls:"one2mp-ip-row"});u.createSpan({cls:"one2mp-ip-label",text:l}),u.createSpan({cls:"one2mp-ip-value",text:c}),u.title=$("settings.copy-ip-to-clipboard"),u.onclick=()=>{var d;if(!((d=navigator.clipboard)!=null&&d.writeText)){new re.Notice($("settings.clipboard-not-supported"));return}navigator.clipboard.writeText(c).then(()=>{new re.Notice($("settings.ip-copied-to-clipboard"))}).catch(f=>{console.warn("\u590D\u5236 IP \u5931\u8D25",f)})}};if(!o.direct&&!o.proxy){n.controlEl.createSpan({text:$("settings.no-ip-address"),cls:"text-muted"});return}o.direct===o.proxy||!o.proxy||!o.direct?s("\u516C\u7F51 IP",o.direct||o.proxy):(s("\u76F4\u8FDE",o.direct),s("\u4EE3\u7406",o.proxy))};(()=>{let o={};try{o=JSON.parse(this.plugin.settings.ipAddress||"{}")}catch(s){o={direct:this.plugin.settings.ipAddress}}i(o)})(),this.plugin.updateIpAddress().then(o=>{i(o)}).catch(()=>{}),new re.Setting(t).setName($("settings.real-time-render")).setDesc($("settings.enable-real-time-rendering")).addToggle(o=>{o.setValue(this.plugin.settings.realTimeRender).onChange(s=>{this.plugin.settings.realTimeRender=s,this.plugin.saveSettings()})})}creatCSSStyleSetting(t){new re.Setting(t).setName($("settings.custom-themes")).setHeading(),new re.Setting(t).setName($("settings.custom-themes-folder")).setDesc($("settings.the-folder-where-your-custom-themes")).addSearch(n=>{new pr(this.app,n.inputEl),n.setPlaceholder($("settings.themes-folder-path")).setValue(this.plugin.settings.css_styles_folder).onChange(i=>{this.plugin.settings.css_styles_folder=i,this.plugin.saveThemeFolderDebounce()})}).addExtraButton(n=>{n.setIcon("download").setTooltip($("views.theme-manager.download-predefined-custom-themes")).onClick(()=>{(async()=>{let{ThemeManager:i}=await Promise.resolve().then(()=>($n(),wr));new re.Notice($("views.theme-manager.download-started")),i.getInstance(this.plugin).downloadThemes()})()})}),new re.Setting(t).setName($("settings.theme-download-overwrite")).setDesc($("settings.theme-download-overwrite-desc")).addToggle(n=>{n.setValue(this.plugin.settings.themeDownloadOverwrite).onChange(i=>{this.plugin.settings.themeDownloadOverwrite=i,this.plugin.saveSettings()})})}createBackupRestore(t){new re.Setting(t).setName($("settings.import-export-one2mp-account")).setHeading().setDesc($("settings.import-or-export-your-account-info-for-b")).addExtraButton(n=>{n.setIcon("upload").setTooltip($("settings.import-account-info")).onClick(()=>{this.importSettings()})}).addExtraButton(n=>{n.setIcon("download").setTooltip($("settings.export-account-info")).onClick(()=>{this.exportSettings()})})}async exportSettings(){try{let t=JSON.stringify(this.plugin.settings,null,2);if(!window.showSaveFilePicker||re.Platform.isMobile){let o=new Date().toISOString().slice(0,10),s="one2mp-settings",l=`one2mp-settings-${o}.json`,c=`${s}/${l}`;return this.app.vault.getAbstractFileByPath(s)||await this.app.vault.createFolder(s),await this.app.vault.adapter.write(c,t),new re.Notice($("settings.settings-exported-to-vault",[c])),!0}let n=new Blob([t],{type:"application/json"}),a=await(await window.showSaveFilePicker({suggestedName:`one2mp-settings-${new Date().toISOString().slice(0,10)}.json`,types:[{description:"JSON Files",accept:{"application/json":[".json"]}}]})).createWritable();return await a.write(n),await a.close(),new re.Notice($("settings.settings-exported")),!0}catch(t){if(t instanceof Error&&t.name==="AbortError")return!1;let n=t instanceof Error?t.message:String(t);return new re.Notice(`${$("settings.settings-exporting-failed")}${n}`),console.error(t),!1}}async importSettingsFromVault(){let t=new re.Modal(this.app);t.contentEl.createEl("h3",{text:$("settings.import-settings-title")}),t.contentEl.createEl("p",{text:$("settings.import-settings-hint")});let n=new re.TextComponent(t.contentEl);n.setPlaceholder($("settings.import-settings-placeholder")),new nn(this.app,n.inputEl,["json"]);let i=t.contentEl.createDiv({cls:"modal-button-container"}),a=new re.ButtonComponent(i);a.setButtonText($("settings.cancel")),a.onClick(()=>t.close());let o=new re.ButtonComponent(i);o.setButtonText($("settings.import-settings-confirm")),o.setCta(),o.onClick(async()=>{let s=n.getValue().trim();if(!s){new re.Notice($("settings.import-settings-empty-path"));return}let l=this.app.vault.getAbstractFileByPath(s);if(!(l instanceof re.TFile)){new re.Notice($("settings.import-settings-file-not-found"));return}try{let c=await this.app.vault.read(l);await this.applyImportedSettings(c),t.close()}catch(c){let u=c instanceof Error?c.message:String(c);new re.Notice(`${$("settings.settings-imported-failed")}${u}`),console.error(c)}}),t.open()}async applyImportedSettings(t){let n;try{n=JSON.parse(t)}catch(o){new re.Notice($("settings.invalid-json-file"));return}let{mpAccounts:i,css_styles_folder:a}=n;if(i===void 0||a===void 0){new re.Notice($("settings.invalid-wewerite-settings-file"));return}this.plugin.settings=n,this.plugin.saveSettings(),this.display(),new re.Notice($("settings.settings-imported-successfully"))}importSettings(){try{if(re.Platform.isMobile){this.importSettingsFromVault();return}let t=document.createElement("input");t.type="file",t.accept=".json",t.onchange=n=>{(()=>{var s;let a=(s=n.target.files)==null?void 0:s[0];if(!a)return;let o=new FileReader;o.onload=l=>{(async()=>{var c;try{let u=(c=l.target)==null?void 0:c.result;await this.applyImportedSettings(u)}catch(u){let d=u instanceof Error?u.message:String(u);new re.Notice(`${$("settings.settings-imported-failed")}${d}`),console.error(u)}})()},o.readAsText(a)})()},t.click()}catch(t){let n=t instanceof Error?t.message:String(t);new re.Notice(`${$("settings.settings-imported-error")}${n}`),console.error(t)}}};ze();var Br=null,qc=async()=>{if(Br)return Br;try{let{default:r}=await Promise.resolve().then(()=>(za(),ja));return Br=new r("one2mp-settings"),Br}catch(r){return console.warn("PouchDB \u521D\u59CB\u5316\u5931\u8D25\uFF0C\u8DF3\u8FC7\u65E7\u914D\u7F6E\u8FC1\u79FB",r),null}},Nc=async()=>{await qc()},jc=1,am=async()=>{let r=await qc();if(r)return new Promise(e=>{r.get("one2mp-settings").then(t=>{e(t)}).catch(t=>{console.warn("Error getting One2MpSetting:",t),e(void 0)})})},zc=async r=>{var e;try{let t=await r.loadData();if(t!=null&&t.settings)return t.custom_theme_folder&&!t.settings.css_styles_folder&&(t.settings.css_styles_folder=t.custom_theme_folder),t.settings;let n=await am();if(n){let i={...t,settings:n,custom_theme_folder:(e=n.css_styles_folder)!=null?e:t==null?void 0:t.custom_theme_folder,settings_version:jc};await r.saveData(i)}return n}catch(t){console.error("Error loading One2MpSetting:",t);return}},Hc=async(r,e)=>{var t;try{let n=await r.loadData(),i=n==null?void 0:n.settings;if(i&&on(e,i))return;let a={...n,settings:e,custom_theme_folder:(t=e.css_styles_folder)!=null?t:n==null?void 0:n.custom_theme_folder,settings_version:jc};await r.saveData(a)}catch(n){console.error("Error setting One2MpSetting:",n)}};Jn();var Xr=class{constructor(){this.listeners=new Map}registerListener(e,t){let n=this.listeners.get(e);return n==null||n===null?this.listeners.set(e,[t]):n.push(t),()=>this.unregisterListener(e,t)}unregisterListener(e,t){let n=this.listeners.get(e);if(!n)return;let i=n.filter(a=>a!==t);if(i.length===0){this.listeners.delete(e);return}this.listeners.set(e,i)}sendMessage(e,t){let n=this.listeners.get(e);n==null||n===null||n.forEach(i=>i(t))}};Qn();var ei=class{constructor(e){this.spinnerEl=e,this.spinnerEl.addClass("spinner-container");let t=this.spinnerEl.createDiv({cls:"spinner-dots"});for(let n=0;n<6;n++)t.createDiv({cls:`spinner-dot spinner-dot${n+1}`}).setCssProps({"animation-delay":`${n*.3}s`});this.spinnerText=this.spinnerEl.createDiv({cls:"spinner-text"})}showSpinner(e=""){this.spinnerEl.setCssProps({display:"flex"}),this.spinnerText.setText(e)}isSpinning(){return getComputedStyle(this.spinnerEl).display!=="none"}hideSpinner(){this.spinnerEl.setCssProps({display:"none"})}unload(){this.spinnerEl.remove()}};var ni=require("obsidian");Fe();var ti=class extends ni.Modal{constructor(t,n,i=""){super(t);this.initialContent=i;this.inputEl=null;this.onSubmit=n}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h3",{text:$("modals.mpcard.title")}),t.createEl("p",{text:$("modals.mpcard.hint")}),this.inputEl=t.createEl("textarea",{cls:"one2mp-mpcard-input"}),this.inputEl.placeholder=$("modals.mpcard.placeholder"),this.initialContent&&(this.inputEl.value=this.initialContent),this.inputEl.focus();let n=t.createDiv("modal-button-container");n.createEl("button",{text:$("modals.mpcard.insert")}).addEventListener("click",()=>{var o,s;let i=(s=(o=this.inputEl)==null?void 0:o.value)!=null?s:"",a=this.normalizeMpcard(i);if(!a){new ni.Notice($("modals.mpcard.empty"));return}this.onSubmit(a),this.close()}),n.createEl("button",{text:$("modals.cancel")}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:t}=this;t.empty(),this.inputEl=null}normalizeMpcard(t){let n=t.trim();if(!n)return"";if(n.startsWith("```")){let i=n.split(/\r?\n/);return/```\\s*mpcard/i.test(i[0])||(i[0]="```mpcard"),i.slice(1).some(o=>o.trim()==="```")||i.push("```"),`
${i.join(`
`)}
`}return`
\`\`\`mpcard
${n}
\`\`\`
`}};var Cn="one2mp-article-preview",mw={mpAccounts:[],ipAddress:"",css_styles_folder:"one2mp-css-styles",codeLineNumber:!0,accountDataPath:"one2mp-accounts",useCenterToken:!1,realTimeRender:!0,defaultMpcard:"",defaultMpcardId:"",defaultMpcardHeadimg:"",defaultMpcardNickname:"",defaultMpcardSignature:"",themeDownloadOverwrite:!1},Jd="one2mp-logo",vw=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="100" height="100">
	<path d="M 15.560304092607304 33.94050605385342C 29.693661897802365 -1.1141138324752404 70.30633810219763 -1.1141138324752404 84.43969590739269 33.940506053853426C 51.84603073656342 45.353262378865885 48.15396926343658 45.353262378865885 15.560304092607304 33.94050605385342Z" fill="#84D473" />
	<path d="M 81.12777768298169 28.204095418660252C 104.41929012195195 57.97125226189857 84.1129520197543 93.14286157057666 46.688081775588984 87.85539852748633C 53.1011774563413 53.92207832459788 54.947208192904725 50.72465929653623 81.12777768298169 28.204095418660252Z" fill="#3AB54A" />
	<path d="M 53.31191822441101 87.85539852748633C 15.887047980245676 93.14286157057666 -4.419290121951946 57.971252261898584 18.872222317018313 28.204095418660245Q 45.052791807095275 50.72465929653624 28.163984663890915 52.681125554913244L 38.40889008453118 53.10582854123025L 29.748893224046313 58.59608482676403Q 46.898822543658696 53.92207832459788 53.31191822441101 87.85539852748633Z" fill="#27753D" />
</svg>`,Ei=class extends Ye.Plugin{constructor(){super(...arguments);this.editorChangeListener=null;this.resourceManager=ft.getInstance(this);this.active=!1;this.previewPanelCtor=null;this.saveSettings=(0,Ye.debounce)(async()=>{delete this.settings._id,delete this.settings._rev,this.trimSettings(),await Hc(this,this.settings),await this.saveThemeFolder()},3e3);this.saveThemeFolderDebounce=(0,Ye.debounce)(async()=>{await this.saveThemeFolder()},3e3)}async saveThemeFolder(){this.trimSettings();let t={...this.settings};delete t._id,delete t._rev;let n={custom_theme_folder:this.settings.css_styles_folder},i=await this.loadData();await this.saveData({...i!=null?i:{},...n,settings:t}),this.messageService.sendMessage("custom-theme-folder-changed",null)}async loadThemeFolder(){let t=await this.loadData();t&&t.custom_theme_folder&&(this.settings.css_styles_folder=t.custom_theme_folder)}trimSettings(){var t,n,i,a;this.settings.mpAccounts.forEach(o=>{o.accountName=o.accountName.trim(),o.appId=o.appId.trim(),o.appSecret=o.appSecret.trim()}),this.settings.ipAddress=(t=this.settings.ipAddress)==null?void 0:t.trim(),this.settings.selectedMPAccount=(n=this.settings.selectedMPAccount)==null?void 0:n.trim(),this.settings.accountDataPath=(i=this.settings.accountDataPath)==null?void 0:i.trim(),this.settings.css_styles_folder=(a=this.settings.css_styles_folder)==null?void 0:a.trim()}async writeStartupLog(t,n){let i="o2any-startup.log",a=new Date().toISOString(),o=n?` ${this.formatStartupError(n)}`:"",s=`[${a}] ${t}${o}
`;try{let l=this.app.vault.adapter;await l.exists(i)?await l.append(i,s):await l.write(i,s)}catch(l){console.error("O2Any \u542F\u52A8\u65E5\u5FD7\u5199\u5165\u5931\u8D25",l)}}formatStartupError(t){return t instanceof Error?`${t.name}: ${t.message}${t.stack?`
${t.stack}`:""}`:String(t)}createSpinner(){this.spinner=new ei(this.addStatusBarItem())}showSpinner(t=""){this.spinner.showSpinner(t)}isSpinning(){return this.spinner.isSpinning()}hideSpinner(){this.spinner.hideSpinner()}async loadSettings(){this.settings=Object.assign({},mw,await zc(this)),await this.loadThemeFolder()}async updateIpAddress(){try{let t=await Ro();return this.settings.ipAddress=JSON.stringify(t),this.saveSettings(),t}catch(t){return console.error("Error fetching public IP address:",t),{}}}async activateView(){let{workspace:t}=this.app,n=t.getLeavesOfType(Cn).find(i=>i.view.getViewType()===Cn);n==null&&(n=t.getRightLeaf(!1),await(n==null?void 0:n.setViewState({type:Cn,active:!0}))),n&&t.revealLeaf(n)}getAccessToken(t){let n=this.getMPAccountByName(t);return n===void 0?(new Ye.Notice($("main.no-wechat-mp-account-selected")),!1):n.access_token}async TestAccessToken(t){if(this.settings.useCenterToken)return this.wechatClient.requestToken();{let n=this.getMPAccountByName(t);if(n===void 0)return new Ye.Notice($("main.no-wechat-mp-account-selected")),!1;let i=await this.wechatClient.getAccessToken(n.appId,n.appSecret);if(i)return this.setAccessToken(t,i.access_token,i.expires_in),i.access_token}return!1}async refreshAccessToken(t){if(this.settings.useCenterToken)return this.wechatClient.requestToken();if(t===void 0)return!1;let n=this.getMPAccountByName(t);if(n===void 0)return new Ye.Notice($("main.no-wechat-mp-account-selected")),!1;let{appId:i,appSecret:a}=n;if(i===void 0||a===void 0||!i||!a)return new Ye.Notice($("main.please-check-you-appid-and-appsecret")),!1;let{access_token:o,expires_in:s,lastRefreshTime:l}=n;if(o===void 0||o===""){let c=await this.wechatClient.getAccessToken(i,a);if(c)return this.setAccessToken(t,c.access_token,c.expires_in),c.access_token}else if(l+s*1e3<new Date().getTime()){let c=await this.wechatClient.getAccessToken(i,a);if(c)return this.setAccessToken(t,c.access_token,c.expires_in),c.access_token}else return o;return!1}getMPAccountByName(t){return this.settings.mpAccounts.find(n=>n.accountName===t)}getSelectedMPAccount(){return this.getMPAccountByName(this.settings.selectedMPAccount)}setAccessToken(t,n,i){let a=this.getMPAccountByName(t);a!==void 0&&(a.access_token=n,a.lastRefreshTime=new Date().getTime(),a.expires_in=i,this.saveSettings())}confirm(t){return new Promise(n=>{new hr(this.app,t,n).open()})}initDB(){Nc(),io()}async onload(){await this.writeStartupLog("onload:start");try{this.initDB(),this.messageService=new Xr,await this.loadSettings(),this.wechatClient=ot.getInstance(this),(0,Ye.addIcon)(Jd,vw);let t=await Promise.resolve().then(()=>(Gd(),Kd));this.previewPanelCtor=t.PreviewPanel,this.registerViews(),this.addCommand({id:"open-previewer",name:$("main.open-previewer"),callback:()=>{this.activateView()}}),this.addRibbonIcon(Jd,$("main.open-previewer"),()=>{this.activateView()}),this.addSettingTab(new br(this.app,this)),this.createSpinner(),this.messageService.registerListener("show-spinner",n=>{this.showSpinner(n)}),this.messageService.registerListener("hide-spinner",()=>{this.hideSpinner()}),this.registerEvent(this.app.workspace.on("editor-menu",(n,i)=>{n.addItem(a=>{a.setTitle($("main.insert-mpcard")),a.onClick(()=>{let o=this.settings.defaultMpcard||this.buildDefaultMpcard();new ti(this.app,l=>{i.replaceSelection(l)},o).open()})})}))}catch(t){throw await this.writeStartupLog("onload:error",t),t}await this.writeStartupLog("onload:ready")}buildDefaultMpcard(){var s,l,c,u;let t=[],n=(s=this.settings.defaultMpcardId)==null?void 0:s.trim(),i=(l=this.settings.defaultMpcardHeadimg)==null?void 0:l.trim(),a=(c=this.settings.defaultMpcardNickname)==null?void 0:c.trim(),o=(u=this.settings.defaultMpcardSignature)==null?void 0:u.trim();return n&&t.push(`id: ${n}`),i&&t.push(`headimg: ${i}`),a&&t.push(`nickname: ${a}`),o&&t.push(`signature: ${o}`),t.length===0?"":["```mpcard",...t,"```"].join(`
`)}registerViewOnce(t){if(this.app.workspace.getLeavesOfType(t).length===0&&t===Cn){if(!this.previewPanelCtor){new Ye.Notice("\u9884\u89C8\u5668\u672A\u52A0\u8F7D\uFF0C\u65E0\u6CD5\u6CE8\u518C\u89C6\u56FE");return}this.registerView(t,n=>new this.previewPanelCtor(n,this))}}registerViews(){this.registerViewOnce(Cn)}onunload(){this.editorChangeListener&&this.app.workspace.offref(this.editorChangeListener),this.spinner.unload(),this.app.workspace.getLeavesOfType(Cn).forEach(t=>t.detach()),ot.resetInstance(),(async()=>{let{ThemeManager:t}=await Promise.resolve().then(()=>($n(),wr));t.resetInstance()})(),(async()=>{let{LocalDraftManager:t}=await Promise.resolve().then(()=>(Jn(),$u));t.resetInstance();let{WechatRender:n}=await Promise.resolve().then(()=>(To(),Od));n.resetInstance()})()}};
//![[]]
