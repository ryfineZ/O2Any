/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var xd=Object.create;var un=Object.defineProperty;var _d=Object.getOwnPropertyDescriptor;var kd=Object.getOwnPropertyNames;var Sd=Object.getPrototypeOf,Cd=Object.prototype.hasOwnProperty;var Ed=(r,t,e)=>t in r?un(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var F=(r,t)=>()=>(r&&(t=r(r=0)),t);var uo=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),ht=(r,t)=>{for(var e in t)un(r,e,{get:t[e],enumerable:!0})},fo=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of kd(t))!Cd.call(r,i)&&i!==e&&un(r,i,{get:()=>t[i],enumerable:!(n=_d(t,i))||n.enumerable});return r};var dn=(r,t,e)=>(e=r!=null?xd(Sd(r)):{},fo(t||!r||!r.__esModule?un(e,"default",{value:r,enumerable:!0}):e,r)),Td=r=>fo(un({},"__esModule",{value:!0}),r);var de=(r,t,e)=>(Ed(r,typeof t!="symbol"?t+"":t,e),e);var po,Xe,fi=F(()=>{po=require("obsidian"),Xe=class{constructor(t){this.plugin=t,this.init()}static getInstance(t){return this.instance||(this.instance=new Xe(t)),this.instance}init(){}getCurrentMarkdownView(){var n;let t=this.plugin.app.workspace.getActiveFile(),e=this.plugin.app.workspace.getLeavesOfType("markdown");for(let i of e){let a=i.view;if(((n=a.file)==null?void 0:n.path)===(t==null?void 0:t.path))return a}return null}forceRenderActiveMarkdownView(){let t=this.getCurrentMarkdownView();t&&this.plugin.app.workspace.trigger("render",t)}queryElements(t){let e=this.getCurrentMarkdownView();if(!e)return[];let n=e.getMode()==="preview"?".markdown-preview-view":".markdown-source-view",i=e.containerEl.querySelector(n);return i?i.querySelectorAll(t):[]}getMarkdownViewContainer(){let t=this.getCurrentMarkdownView();return t?t.containerEl:null}getMarkdownRenderedElement(t,e){let n=this.queryElements(e);if(n.length<=t)return null;let i=n[t];return i||null}getFileOfLink(t){return this.plugin.app.metadataCache.getFirstLinkpathDest(t,"")}async getLinkFileContent(t){let e=this.getFileOfLink(t);return e?await this.plugin.app.vault.adapter.read(e.path):null}async saveImageFromUrl(t){var d;let e=this.plugin.app.workspace.getActiveFile();if(!e)return null;let n=e.basename,i=((d=e.parent)==null?void 0:d.path)||"",a=t.split("/"),s=a[a.length-1].split("?")[0].split(".").pop(),l=new Date().toISOString().replace(/[:.]/g,"-").replace("T","_"),c=`${n}_generated_${l}.${s||"jpg"}`,u=i==="/"?`/${c}`:`${i}/${c}`;try{let f=await(0,po.requestUrl)({url:t});if(f.status!==200)throw new Error("Failed to fetch image");let m=f.arrayBuffer;return await this.plugin.app.vault.adapter.writeBinary(u,m),u}catch(f){return console.error("Error saving image:",f),null}}}});var Z,fn,go,Ad,Id,mo,vo,hn,yo,Pd,Gn,$d,Co,Mt,Od,Dd,pi,Md,Ld,Rd,gi,Jn,Fd,Rt,et,Ft,Qn,Eo,wo,Bt,Zn,bo,xo,mi,_o,hi,vi,Bd,Lt,yi,qd,wi,ko,So,Kn,Nd,vt,Ee,Oy,Dy,My,Ly,Ry,Fy,By,qy,Ny,jy,zy,Uy,Hy,Wy,To=F(()=>{Z=r=>typeof r=="string",fn=()=>{let r,t,e=new Promise((n,i)=>{r=n,t=i});return e.resolve=r,e.reject=t,e},go=r=>r==null?"":""+r,Ad=(r,t,e)=>{r.forEach(n=>{t[n]&&(e[n]=t[n])})},Id=/###/g,mo=r=>r&&r.indexOf("###")>-1?r.replace(Id,"."):r,vo=r=>!r||Z(r),hn=(r,t,e)=>{let n=Z(t)?t.split("."):t,i=0;for(;i<n.length-1;){if(vo(r))return{};let a=mo(n[i]);!r[a]&&e&&(r[a]=new e),Object.prototype.hasOwnProperty.call(r,a)?r=r[a]:r={},++i}return vo(r)?{}:{obj:r,k:mo(n[i])}},yo=(r,t,e)=>{let{obj:n,k:i}=hn(r,t,Object);if(n!==void 0||t.length===1){n[i]=e;return}let a=t[t.length-1],o=t.slice(0,t.length-1),s=hn(r,o,Object);for(;s.obj===void 0&&o.length;)a=`${o[o.length-1]}.${a}`,o=o.slice(0,o.length-1),s=hn(r,o,Object),s!=null&&s.obj&&typeof s.obj[`${s.k}.${a}`]!="undefined"&&(s.obj=void 0);s.obj[`${s.k}.${a}`]=e},Pd=(r,t,e,n)=>{let{obj:i,k:a}=hn(r,t,Object);i[a]=i[a]||[],i[a].push(e)},Gn=(r,t)=>{let{obj:e,k:n}=hn(r,t);if(e&&Object.prototype.hasOwnProperty.call(e,n))return e[n]},$d=(r,t,e)=>{let n=Gn(r,e);return n!==void 0?n:Gn(t,e)},Co=(r,t,e)=>{for(let n in t)n!=="__proto__"&&n!=="constructor"&&(n in r?Z(r[n])||r[n]instanceof String||Z(t[n])||t[n]instanceof String?e&&(r[n]=t[n]):Co(r[n],t[n],e):r[n]=t[n]);return r},Mt=r=>r.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),Od={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},Dd=r=>Z(r)?r.replace(/[&<>"'\/]/g,t=>Od[t]):r,pi=class{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){let e=this.regExpMap.get(t);if(e!==void 0)return e;let n=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,n),this.regExpQueue.push(t),n}},Md=[" ",",","?","!",";"],Ld=new pi(20),Rd=(r,t,e)=>{t=t||"",e=e||"";let n=Md.filter(o=>t.indexOf(o)<0&&e.indexOf(o)<0);if(n.length===0)return!0;let i=Ld.getRegExp(`(${n.map(o=>o==="?"?"\\?":o).join("|")})`),a=!i.test(r);if(!a){let o=r.indexOf(e);o>0&&!i.test(r.substring(0,o))&&(a=!0)}return a},gi=function(r,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!r)return;if(r[t])return Object.prototype.hasOwnProperty.call(r,t)?r[t]:void 0;let n=t.split(e),i=r;for(let a=0;a<n.length;){if(!i||typeof i!="object")return;let o,s="";for(let l=a;l<n.length;++l)if(l!==a&&(s+=e),s+=n[l],o=i[s],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&l<n.length-1)continue;a+=l-a+1;break}i=o}return i},Jn=r=>r==null?void 0:r.replace("_","-"),Fd={type:"logger",log(r){this.output("log",r)},warn(r){this.output("warn",r)},error(r){this.output("error",r)},output(r,t){var e,n;(n=(e=console==null?void 0:console[r])==null?void 0:e.apply)==null||n.call(e,console,t)}},Rt=class{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(t,e)}init(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||Fd,this.options=e,this.debug=e.debug}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"log","",!0)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","",!0)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"error","")}deprecate(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(t,e,n,i){return i&&!this.debug?null:(Z(t[0])&&(t[0]=`${n}${this.prefix} ${t[0]}`),this.logger[e](t))}create(t){return new Rt(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new Rt(this.logger,t)}},et=new Rt,Ft=class{constructor(){this.observers={}}on(t,e){return t.split(" ").forEach(n=>{this.observers[n]||(this.observers[n]=new Map);let i=this.observers[n].get(e)||0;this.observers[n].set(e,i+1)}),this}off(t,e){if(this.observers[t]){if(!e){delete this.observers[t];return}this.observers[t].delete(e)}}emit(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.observers[t]&&Array.from(this.observers[t].entries()).forEach(o=>{let[s,l]=o;for(let c=0;c<l;c++)s(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(o=>{let[s,l]=o;for(let c=0;c<l;c++)s.apply(s,[t,...n])})}},Qn=class extends Ft{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=e,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){let e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}getResource(t,e,n){var c,u;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,o=i.ignoreJSONStructure!==void 0?i.ignoreJSONStructure:this.options.ignoreJSONStructure,s;t.indexOf(".")>-1?s=t.split("."):(s=[t,e],n&&(Array.isArray(n)?s.push(...n):Z(n)&&a?s.push(...n.split(a)):s.push(n)));let l=Gn(this.data,s);return!l&&!e&&!n&&t.indexOf(".")>-1&&(t=s[0],e=s[1],n=s.slice(2).join(".")),l||!o||!Z(n)?l:gi((u=(c=this.data)==null?void 0:c[t])==null?void 0:u[e],n,a)}addResource(t,e,n,i){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1},o=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,s=[t,e];n&&(s=s.concat(o?n.split(o):n)),t.indexOf(".")>-1&&(s=t.split("."),i=e,e=s[1]),this.addNamespaces(e),yo(this.data,s,i),a.silent||this.emit("added",t,e,n,i)}addResources(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(let a in n)(Z(n[a])||Array.isArray(n[a]))&&this.addResource(t,e,a,n[a],{silent:!0});i.silent||this.emit("added",t,e,n)}addResourceBundle(t,e,n,i,a){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},s=[t,e];t.indexOf(".")>-1&&(s=t.split("."),i=n,n=e,e=s[1]),this.addNamespaces(e);let l=Gn(this.data,s)||{};o.skipCopy||(n=JSON.parse(JSON.stringify(n))),i?Co(l,n,a):l={...l,...n},yo(this.data,s,l),o.silent||this.emit("added",t,e,n)}removeResourceBundle(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}hasResourceBundle(t,e){return this.getResource(t,e)!==void 0}getResourceBundle(t,e){return e||(e=this.options.defaultNS),this.getResource(t,e)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){let e=this.getDataByLanguage(t);return!!(e&&Object.keys(e)||[]).find(i=>e[i]&&Object.keys(e[i]).length>0)}toJSON(){return this.data}},Eo={processors:{},addPostProcessor(r){this.processors[r.name]=r},handle(r,t,e,n,i){return r.forEach(a=>{var o,s;t=(s=(o=this.processors[a])==null?void 0:o.process(t,e,n,i))!=null?s:t}),t}},wo={},Bt=class extends Ft{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Ad(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=e,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=et.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(t==null)return!1;let n=this.resolve(t,e);return(n==null?void 0:n.res)!==void 0}extractFromKey(t,e){let n=e.nsSeparator!==void 0?e.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");let i=e.keySeparator!==void 0?e.keySeparator:this.options.keySeparator,a=e.ns||this.options.defaultNS||[],o=n&&t.indexOf(n)>-1,s=!this.options.userDefinedKeySeparator&&!e.keySeparator&&!this.options.userDefinedNsSeparator&&!e.nsSeparator&&!Rd(t,n,i);if(o&&!s){let l=t.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:t,namespaces:Z(a)?[a]:a};let c=t.split(n);(n!==i||n===i&&this.options.ns.indexOf(c[0])>-1)&&(a=c.shift()),t=c.join(i)}return{key:t,namespaces:Z(a)?[a]:a}}translate(t,e,n){if(typeof e!="object"&&this.options.overloadTranslationOptionHandler&&(e=this.options.overloadTranslationOptionHandler(arguments)),typeof e=="object"&&(e={...e}),e||(e={}),t==null)return"";Array.isArray(t)||(t=[String(t)]);let i=e.returnDetails!==void 0?e.returnDetails:this.options.returnDetails,a=e.keySeparator!==void 0?e.keySeparator:this.options.keySeparator,{key:o,namespaces:s}=this.extractFromKey(t[t.length-1],e),l=s[s.length-1],c=e.lng||this.language,u=e.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((c==null?void 0:c.toLowerCase())==="cimode"){if(u){let p=e.nsSeparator||this.options.nsSeparator;return i?{res:`${l}${p}${o}`,usedKey:o,exactUsedKey:o,usedLng:c,usedNS:l,usedParams:this.getUsedParamsDetails(e)}:`${l}${p}${o}`}return i?{res:o,usedKey:o,exactUsedKey:o,usedLng:c,usedNS:l,usedParams:this.getUsedParamsDetails(e)}:o}let d=this.resolve(t,e),f=d==null?void 0:d.res,m=(d==null?void 0:d.usedKey)||o,b=(d==null?void 0:d.exactUsedKey)||o,S=Object.prototype.toString.apply(f),k=["[object Number]","[object Function]","[object RegExp]"],y=e.joinArrays!==void 0?e.joinArrays:this.options.joinArrays,g=!this.i18nFormat||this.i18nFormat.handleAsObject,h=!Z(f)&&typeof f!="boolean"&&typeof f!="number";if(g&&f&&h&&k.indexOf(S)<0&&!(Z(y)&&Array.isArray(f))){if(!e.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");let p=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,f,{...e,ns:s}):`key '${o} (${this.language})' returned an object instead of string.`;return i?(d.res=p,d.usedParams=this.getUsedParamsDetails(e),d):p}if(a){let p=Array.isArray(f),w=p?[]:{},_=p?b:m;for(let O in f)if(Object.prototype.hasOwnProperty.call(f,O)){let M=`${_}${a}${O}`;w[O]=this.translate(M,{...e,joinArrays:!1,ns:s}),w[O]===M&&(w[O]=f[O])}f=w}}else if(g&&Z(y)&&Array.isArray(f))f=f.join(y),f&&(f=this.extendTranslation(f,t,e,n));else{let p=!1,w=!1,_=e.count!==void 0&&!Z(e.count),O=Bt.hasDefaultValue(e),M=_?this.pluralResolver.getSuffix(c,e.count,e):"",D=e.ordinal&&_?this.pluralResolver.getSuffix(c,e.count,{ordinal:!1}):"",z=_&&!e.ordinal&&e.count===0,j=z&&e[`defaultValue${this.options.pluralSeparator}zero`]||e[`defaultValue${M}`]||e[`defaultValue${D}`]||e.defaultValue;!this.isValidLookup(f)&&O&&(p=!0,f=j),this.isValidLookup(f)||(w=!0,f=o);let U=(e.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&w?void 0:f,H=O&&j!==f&&this.options.updateMissing;if(w||p||H){if(this.logger.log(H?"updateKey":"missingKey",c,l,o,H?j:f),a){let v=this.resolve(o,{...e,keySeparator:!1});v&&v.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let J=[],Y=this.languageUtils.getFallbackCodes(this.options.fallbackLng,e.lng||this.language);if(this.options.saveMissingTo==="fallback"&&Y&&Y[0])for(let v=0;v<Y.length;v++)J.push(Y[v]);else this.options.saveMissingTo==="all"?J=this.languageUtils.toResolveHierarchy(e.lng||this.language):J.push(e.lng||this.language);let re=(v,x,C)=>{var P;let E=O&&C!==f?C:U;this.options.missingKeyHandler?this.options.missingKeyHandler(v,l,x,E,H,e):(P=this.backendConnector)!=null&&P.saveMissing&&this.backendConnector.saveMissing(v,l,x,E,H,e),this.emit("missingKey",v,l,x,f)};this.options.saveMissing&&(this.options.saveMissingPlurals&&_?J.forEach(v=>{let x=this.pluralResolver.getSuffixes(v,e);z&&e[`defaultValue${this.options.pluralSeparator}zero`]&&x.indexOf(`${this.options.pluralSeparator}zero`)<0&&x.push(`${this.options.pluralSeparator}zero`),x.forEach(C=>{re([v],o+C,e[`defaultValue${C}`]||j)})}):re(J,o,j))}f=this.extendTranslation(f,t,e,d,n),w&&f===o&&this.options.appendNamespaceToMissingKey&&(f=`${l}:${o}`),(w||p)&&this.options.parseMissingKeyHandler&&(f=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${l}:${o}`:o,p?f:void 0))}return i?(d.res=f,d.usedParams=this.getUsedParamsDetails(e),d):f}extendTranslation(t,e,n,i,a){var c,u;var o=this;if((c=this.i18nFormat)!=null&&c.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});let d=Z(t)&&(((u=n==null?void 0:n.interpolation)==null?void 0:u.skipOnVariables)!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables),f;if(d){let b=t.match(this.interpolator.nestingRegexp);f=b&&b.length}let m=n.replace&&!Z(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(m={...this.options.interpolation.defaultVariables,...m}),t=this.interpolator.interpolate(t,m,n.lng||this.language||i.usedLng,n),d){let b=t.match(this.interpolator.nestingRegexp),S=b&&b.length;f<S&&(n.nest=!1)}!n.lng&&i&&i.res&&(n.lng=this.language||i.usedLng),n.nest!==!1&&(t=this.interpolator.nest(t,function(){for(var b=arguments.length,S=new Array(b),k=0;k<b;k++)S[k]=arguments[k];return(a==null?void 0:a[0])===S[0]&&!n.context?(o.logger.warn(`It seems you are nesting recursively key: ${S[0]} in key: ${e[0]}`),null):o.translate(...S,e)},n)),n.interpolation&&this.interpolator.reset()}let s=n.postProcess||this.options.postProcess,l=Z(s)?[s]:s;return t!=null&&(l!=null&&l.length)&&n.applyPostProcessor!==!1&&(t=Eo.handle(l,t,e,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),t}resolve(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n,i,a,o,s;return Z(t)&&(t=[t]),t.forEach(l=>{if(this.isValidLookup(n))return;let c=this.extractFromKey(l,e),u=c.key;i=u;let d=c.namespaces;this.options.fallbackNS&&(d=d.concat(this.options.fallbackNS));let f=e.count!==void 0&&!Z(e.count),m=f&&!e.ordinal&&e.count===0,b=e.context!==void 0&&(Z(e.context)||typeof e.context=="number")&&e.context!=="",S=e.lngs?e.lngs:this.languageUtils.toResolveHierarchy(e.lng||this.language,e.fallbackLng);d.forEach(k=>{var y,g;this.isValidLookup(n)||(s=k,!wo[`${S[0]}-${k}`]&&((y=this.utils)!=null&&y.hasLoadedNamespace)&&!((g=this.utils)!=null&&g.hasLoadedNamespace(s))&&(wo[`${S[0]}-${k}`]=!0,this.logger.warn(`key "${i}" for languages "${S.join(", ")}" won't get resolved as namespace "${s}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),S.forEach(h=>{var _;if(this.isValidLookup(n))return;o=h;let p=[u];if((_=this.i18nFormat)!=null&&_.addLookupKeys)this.i18nFormat.addLookupKeys(p,u,h,k,e);else{let O;f&&(O=this.pluralResolver.getSuffix(h,e.count,e));let M=`${this.options.pluralSeparator}zero`,D=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(f&&(p.push(u+O),e.ordinal&&O.indexOf(D)===0&&p.push(u+O.replace(D,this.options.pluralSeparator)),m&&p.push(u+M)),b){let z=`${u}${this.options.contextSeparator}${e.context}`;p.push(z),f&&(p.push(z+O),e.ordinal&&O.indexOf(D)===0&&p.push(z+O.replace(D,this.options.pluralSeparator)),m&&p.push(z+M))}}let w;for(;w=p.pop();)this.isValidLookup(n)||(a=w,n=this.getResource(h,k,w,e))}))})}),{res:n,usedKey:i,exactUsedKey:a,usedLng:o,usedNS:s}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,e,n){var a;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return(a=this.i18nFormat)!=null&&a.getResource?this.i18nFormat.getResource(t,e,n,i):this.resourceStore.getResource(t,e,n,i)}getUsedParamsDetails(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=t.replace&&!Z(t.replace),i=n?t.replace:t;if(n&&typeof t.count!="undefined"&&(i.count=t.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!n){i={...i};for(let a of e)delete i[a]}return i}static hasDefaultValue(t){let e="defaultValue";for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e===n.substring(0,e.length)&&t[n]!==void 0)return!0;return!1}},Zn=class{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=et.create("languageUtils")}getScriptPartFromCode(t){if(t=Jn(t),!t||t.indexOf("-")<0)return null;let e=t.split("-");return e.length===2||(e.pop(),e[e.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(e.join("-"))}getLanguagePartFromCode(t){if(t=Jn(t),!t||t.indexOf("-")<0)return t;let e=t.split("-");return this.formatLanguageCode(e[0])}formatLanguageCode(t){if(Z(t)&&t.indexOf("-")>-1){let e;try{e=Intl.getCanonicalLocales(t)[0]}catch(n){}return e&&this.options.lowerCaseLng&&(e=e.toLowerCase()),e||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let e;return t.forEach(n=>{if(e)return;let i=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(i))&&(e=i)}),!e&&this.options.supportedLngs&&t.forEach(n=>{if(e)return;let i=this.getLanguagePartFromCode(n);if(this.isSupportedCode(i))return e=i;e=this.options.supportedLngs.find(a=>{if(a===i)return a;if(!(a.indexOf("-")<0&&i.indexOf("-")<0)&&(a.indexOf("-")>0&&i.indexOf("-")<0&&a.substring(0,a.indexOf("-"))===i||a.indexOf(i)===0&&i.length>1))return a})}),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e}getFallbackCodes(t,e){if(!t)return[];if(typeof t=="function"&&(t=t(e)),Z(t)&&(t=[t]),Array.isArray(t))return t;if(!e)return t.default||[];let n=t[e];return n||(n=t[this.getScriptPartFromCode(e)]),n||(n=t[this.formatLanguageCode(e)]),n||(n=t[this.getLanguagePartFromCode(e)]),n||(n=t.default),n||[]}toResolveHierarchy(t,e){let n=this.getFallbackCodes(e||this.options.fallbackLng||[],t),i=[],a=o=>{o&&(this.isSupportedCode(o)?i.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return Z(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&a(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&a(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&a(this.getLanguagePartFromCode(t))):Z(t)&&a(this.formatLanguageCode(t)),n.forEach(o=>{i.indexOf(o)<0&&a(this.formatLanguageCode(o))}),i}},bo={zero:0,one:1,two:2,few:3,many:4,other:5},xo={select:r=>r===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})},mi=class{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=t,this.options=e,this.logger=et.create("pluralResolver"),this.pluralRulesCache={}}addRule(t,e){this.rules[t]=e}clearCache(){this.pluralRulesCache={}}getRule(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=Jn(t==="dev"?"en":t),i=e.ordinal?"ordinal":"cardinal",a=JSON.stringify({cleanedCode:n,type:i});if(a in this.pluralRulesCache)return this.pluralRulesCache[a];let o;try{o=new Intl.PluralRules(n,{type:i})}catch(s){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),xo;if(!t.match(/-|_/))return xo;let l=this.languageUtils.getLanguagePartFromCode(t);o=this.getRule(l,e)}return this.pluralRulesCache[a]=o,o}needsPlural(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=this.getRule(t,e);return n||(n=this.getRule("dev",e)),(n==null?void 0:n.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(t,n).map(i=>`${e}${i}`)}getSuffixes(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=this.getRule(t,e);return n||(n=this.getRule("dev",e)),n?n.resolvedOptions().pluralCategories.sort((i,a)=>bo[i]-bo[a]).map(i=>`${this.options.prepend}${e.ordinal?`ordinal${this.options.prepend}`:""}${i}`):[]}getSuffix(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=this.getRule(t,n);return i?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${i.select(e)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",e,n))}},_o=function(r,t,e){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=$d(r,t,e);return!a&&i&&Z(e)&&(a=gi(r,e,n),a===void 0&&(a=gi(t,e,n))),a},hi=r=>r.replace(/\$/g,"$$$$"),vi=class{constructor(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=et.create("interpolator"),this.options=t,this.format=((e=t==null?void 0:t.interpolation)==null?void 0:e.format)||(n=>n),this.init(t)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});let{escape:e,escapeValue:n,useRawValueToEscape:i,prefix:a,prefixEscaped:o,suffix:s,suffixEscaped:l,formatSeparator:c,unescapeSuffix:u,unescapePrefix:d,nestingPrefix:f,nestingPrefixEscaped:m,nestingSuffix:b,nestingSuffixEscaped:S,nestingOptionsSeparator:k,maxReplaces:y,alwaysFormat:g}=t.interpolation;this.escape=e!==void 0?e:Dd,this.escapeValue=n!==void 0?n:!0,this.useRawValueToEscape=i!==void 0?i:!1,this.prefix=a?Mt(a):o||"{{",this.suffix=s?Mt(s):l||"}}",this.formatSeparator=c||",",this.unescapePrefix=u?"":d||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=f?Mt(f):m||Mt("$t("),this.nestingSuffix=b?Mt(b):S||Mt(")"),this.nestingOptionsSeparator=k||",",this.maxReplaces=y||1e3,this.alwaysFormat=g!==void 0?g:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){let t=(e,n)=>(e==null?void 0:e.source)===n?(e.lastIndex=0,e):new RegExp(n,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(t,e,n,i){var m;let a,o,s,l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},c=b=>{if(b.indexOf(this.formatSeparator)<0){let g=_o(e,l,b,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(g,void 0,n,{...i,...e,interpolationkey:b}):g}let S=b.split(this.formatSeparator),k=S.shift().trim(),y=S.join(this.formatSeparator).trim();return this.format(_o(e,l,k,this.options.keySeparator,this.options.ignoreJSONStructure),y,n,{...i,...e,interpolationkey:k})};this.resetRegExp();let u=(i==null?void 0:i.missingInterpolationHandler)||this.options.missingInterpolationHandler,d=((m=i==null?void 0:i.interpolation)==null?void 0:m.skipOnVariables)!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:b=>hi(b)},{regex:this.regexp,safeValue:b=>this.escapeValue?hi(this.escape(b)):hi(b)}].forEach(b=>{for(s=0;a=b.regex.exec(t);){let S=a[1].trim();if(o=c(S),o===void 0)if(typeof u=="function"){let y=u(t,a,i);o=Z(y)?y:""}else if(i&&Object.prototype.hasOwnProperty.call(i,S))o="";else if(d){o=a[0];continue}else this.logger.warn(`missed to pass in variable ${S} for interpolating ${t}`),o="";else!Z(o)&&!this.useRawValueToEscape&&(o=go(o));let k=b.safeValue(o);if(t=t.replace(a[0],k),d?(b.regex.lastIndex+=o.length,b.regex.lastIndex-=a[0].length):b.regex.lastIndex=0,s++,s>=this.maxReplaces)break}}),t}nest(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,a,o,s=(l,c)=>{var S;let u=this.nestingOptionsSeparator;if(l.indexOf(u)<0)return l;let d=l.split(new RegExp(`${u}[ ]*{`)),f=`{${d[1]}`;l=d[0],f=this.interpolate(f,o);let m=f.match(/'/g),b=f.match(/"/g);(((S=m==null?void 0:m.length)!=null?S:0)%2===0&&!b||b.length%2!==0)&&(f=f.replace(/'/g,'"'));try{o=JSON.parse(f),c&&(o={...c,...o})}catch(k){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,k),`${l}${u}${f}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,l};for(;i=this.nestingRegexp.exec(t);){let l=[];o={...n},o=o.replace&&!Z(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;let c=!1;if(i[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(i[1])){let u=i[1].split(this.formatSeparator).map(d=>d.trim());i[1]=u.shift(),l=u,c=!0}if(a=e(s.call(this,i[1].trim(),o),o),a&&i[0]===t&&!Z(a))return a;Z(a)||(a=go(a)),a||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${t}`),a=""),c&&(a=l.reduce((u,d)=>this.format(u,d,n.lng,{...n,interpolationkey:i[1].trim()}),a.trim())),t=t.replace(i[0],a),this.regexp.lastIndex=0}return t}},Bd=r=>{let t=r.toLowerCase().trim(),e={};if(r.indexOf("(")>-1){let n=r.split("(");t=n[0].toLowerCase().trim();let i=n[1].substring(0,n[1].length-1);t==="currency"&&i.indexOf(":")<0?e.currency||(e.currency=i.trim()):t==="relativetime"&&i.indexOf(":")<0?e.range||(e.range=i.trim()):i.split(";").forEach(o=>{if(o){let[s,...l]=o.split(":"),c=l.join(":").trim().replace(/^'+|'+$/g,""),u=s.trim();e[u]||(e[u]=c),c==="false"&&(e[u]=!1),c==="true"&&(e[u]=!0),isNaN(c)||(e[u]=parseInt(c,10))}})}return{formatName:t,formatOptions:e}},Lt=r=>{let t={};return(e,n,i)=>{let a=i;i&&i.interpolationkey&&i.formatParams&&i.formatParams[i.interpolationkey]&&i[i.interpolationkey]&&(a={...a,[i.interpolationkey]:void 0});let o=n+JSON.stringify(a),s=t[o];return s||(s=r(Jn(n),i),t[o]=s),s(e)}},yi=class{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=et.create("formatter"),this.options=t,this.formats={number:Lt((e,n)=>{let i=new Intl.NumberFormat(e,{...n});return a=>i.format(a)}),currency:Lt((e,n)=>{let i=new Intl.NumberFormat(e,{...n,style:"currency"});return a=>i.format(a)}),datetime:Lt((e,n)=>{let i=new Intl.DateTimeFormat(e,{...n});return a=>i.format(a)}),relativetime:Lt((e,n)=>{let i=new Intl.RelativeTimeFormat(e,{...n});return a=>i.format(a,n.range||"day")}),list:Lt((e,n)=>{let i=new Intl.ListFormat(e,{...n});return a=>i.format(a)})},this.init(t)}init(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=e.interpolation.formatSeparator||","}add(t,e){this.formats[t.toLowerCase().trim()]=e}addCached(t,e){this.formats[t.toLowerCase().trim()]=Lt(e)}format(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=e.split(this.formatSeparator);if(a.length>1&&a[0].indexOf("(")>1&&a[0].indexOf(")")<0&&a.find(s=>s.indexOf(")")>-1)){let s=a.findIndex(l=>l.indexOf(")")>-1);a[0]=[a[0],...a.splice(1,s)].join(this.formatSeparator)}return a.reduce((s,l)=>{var d;let{formatName:c,formatOptions:u}=Bd(l);if(this.formats[c]){let f=s;try{let m=((d=i==null?void 0:i.formatParams)==null?void 0:d[i.interpolationkey])||{},b=m.locale||m.lng||i.locale||i.lng||n;f=this.formats[c](s,b,{...u,...i,...m})}catch(m){this.logger.warn(m)}return f}else this.logger.warn(`there was no format function for ${c}`);return s},t)}},qd=(r,t)=>{r.pending[t]!==void 0&&(delete r.pending[t],r.pendingCount--)},wi=class extends Ft{constructor(t,e,n){var a,o;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=t,this.store=e,this.services=n,this.languageUtils=n.languageUtils,this.options=i,this.logger=et.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],(o=(a=this.backend)==null?void 0:a.init)==null||o.call(a,n,i.backend,i)}queueLoad(t,e,n,i){let a={},o={},s={},l={};return t.forEach(c=>{let u=!0;e.forEach(d=>{let f=`${c}|${d}`;!n.reload&&this.store.hasResourceBundle(c,d)?this.state[f]=2:this.state[f]<0||(this.state[f]===1?o[f]===void 0&&(o[f]=!0):(this.state[f]=1,u=!1,o[f]===void 0&&(o[f]=!0),a[f]===void 0&&(a[f]=!0),l[d]===void 0&&(l[d]=!0)))}),u||(s[c]=!0)}),(Object.keys(a).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(a),pending:Object.keys(o),toLoadLanguages:Object.keys(s),toLoadNamespaces:Object.keys(l)}}loaded(t,e,n){let i=t.split("|"),a=i[0],o=i[1];e&&this.emit("failedLoading",a,o,e),!e&&n&&this.store.addResourceBundle(a,o,n,void 0,void 0,{skipCopy:!0}),this.state[t]=e?-1:2,e&&n&&(this.state[t]=0);let s={};this.queue.forEach(l=>{Pd(l.loaded,[a],o),qd(l,t),e&&l.errors.push(e),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(c=>{s[c]||(s[c]={});let u=l.loaded[c];u.length&&u.forEach(d=>{s[c][d]===void 0&&(s[c][d]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",s),this.queue=this.queue.filter(l=>!l.done)}read(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,o=arguments.length>5?arguments[5]:void 0;if(!t.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:e,fcName:n,tried:i,wait:a,callback:o});return}this.readingCalls++;let s=(c,u)=>{if(this.readingCalls--,this.waitingReads.length>0){let d=this.waitingReads.shift();this.read(d.lng,d.ns,d.fcName,d.tried,d.wait,d.callback)}if(c&&u&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,t,e,n,i+1,a*2,o)},a);return}o(c,u)},l=this.backend[n].bind(this.backend);if(l.length===2){try{let c=l(t,e);c&&typeof c.then=="function"?c.then(u=>s(null,u)).catch(s):s(null,c)}catch(c){s(c)}return}return l(t,e,s)}prepareLoading(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();Z(t)&&(t=this.languageUtils.toResolveHierarchy(t)),Z(e)&&(e=[e]);let a=this.queueLoad(t,e,n,i);if(!a.toLoad.length)return a.pending.length||i(),null;a.toLoad.forEach(o=>{this.loadOne(o)})}load(t,e,n){this.prepareLoading(t,e,{},n)}reload(t,e,n){this.prepareLoading(t,e,{reload:!0},n)}loadOne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=t.split("|"),i=n[0],a=n[1];this.read(i,a,"read",void 0,void 0,(o,s)=>{o&&this.logger.warn(`${e}loading namespace ${a} for language ${i} failed`,o),!o&&s&&this.logger.log(`${e}loaded namespace ${a} for language ${i}`,s),this.loaded(t,o,s)})}saveMissing(t,e,n,i,a){var l,c,u,d,f;let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if((c=(l=this.services)==null?void 0:l.utils)!=null&&c.hasLoadedNamespace&&!((d=(u=this.services)==null?void 0:u.utils)!=null&&d.hasLoadedNamespace(e))){this.logger.warn(`did not save key "${n}" as the namespace "${e}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if((f=this.backend)!=null&&f.create){let m={...o,isUpdate:a},b=this.backend.create.bind(this.backend);if(b.length<6)try{let S;b.length===5?S=b(t,e,n,i,m):S=b(t,e,n,i),S&&typeof S.then=="function"?S.then(k=>s(null,k)).catch(s):s(null,S)}catch(S){s(S)}else b(t,e,n,i,s,m)}!t||!t[0]||this.store.addResource(t[0],e,n,i)}}},ko=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:r=>{let t={};if(typeof r[1]=="object"&&(t=r[1]),Z(r[1])&&(t.defaultValue=r[1]),Z(r[2])&&(t.tDescription=r[2]),typeof r[2]=="object"||typeof r[3]=="object"){let e=r[3]||r[2];Object.keys(e).forEach(n=>{t[n]=e[n]})}return t},interpolation:{escapeValue:!0,format:r=>r,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),So=r=>{var t,e;return Z(r.ns)&&(r.ns=[r.ns]),Z(r.fallbackLng)&&(r.fallbackLng=[r.fallbackLng]),Z(r.fallbackNS)&&(r.fallbackNS=[r.fallbackNS]),((e=(t=r.supportedLngs)==null?void 0:t.indexOf)==null?void 0:e.call(t,"cimode"))<0&&(r.supportedLngs=r.supportedLngs.concat(["cimode"])),typeof r.initImmediate=="boolean"&&(r.initAsync=r.initImmediate),r},Kn=()=>{},Nd=r=>{Object.getOwnPropertyNames(Object.getPrototypeOf(r)).forEach(e=>{typeof r[e]=="function"&&(r[e]=r[e].bind(r))})},vt=class extends Ft{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;if(super(),this.options=So(t),this.services={},this.logger=et,this.modules={external:[]},Nd(this),e&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,e),this;setTimeout(()=>{this.init(t,e)},0)}}init(){var t=this;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof e=="function"&&(n=e,e={}),e.defaultNS==null&&e.ns&&(Z(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));let i=ko();this.options={...i,...this.options,...So(e)},this.options.interpolation={...i.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);let a=u=>u?typeof u=="function"?new u:u:null;if(!this.options.isClone){this.modules.logger?et.init(a(this.modules.logger),this.options):et.init(null,this.options);let u;this.modules.formatter?u=this.modules.formatter:u=yi;let d=new Zn(this.options);this.store=new Qn(this.options.resources,this.options);let f=this.services;f.logger=et,f.resourceStore=this.store,f.languageUtils=d,f.pluralResolver=new mi(d,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),u&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(f.formatter=a(u),f.formatter.init(f,this.options),this.options.interpolation.format=f.formatter.format.bind(f.formatter)),f.interpolator=new vi(this.options),f.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},f.backendConnector=new wi(a(this.modules.backend),f.resourceStore,f,this.options),f.backendConnector.on("*",function(m){for(var b=arguments.length,S=new Array(b>1?b-1:0),k=1;k<b;k++)S[k-1]=arguments[k];t.emit(m,...S)}),this.modules.languageDetector&&(f.languageDetector=a(this.modules.languageDetector),f.languageDetector.init&&f.languageDetector.init(f,this.options.detection,this.options)),this.modules.i18nFormat&&(f.i18nFormat=a(this.modules.i18nFormat),f.i18nFormat.init&&f.i18nFormat.init(this)),this.translator=new Bt(this.services,this.options),this.translator.on("*",function(m){for(var b=arguments.length,S=new Array(b>1?b-1:0),k=1;k<b;k++)S[k-1]=arguments[k];t.emit(m,...S)}),this.modules.external.forEach(m=>{m.init&&m.init(this)})}if(this.format=this.options.interpolation.format,n||(n=Kn),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){let u=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);u.length>0&&u[0]!=="dev"&&(this.options.lng=u[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(u=>{this[u]=function(){return t.store[u](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(u=>{this[u]=function(){return t.store[u](...arguments),t}});let l=fn(),c=()=>{let u=(d,f)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(f),n(d,f)};if(this.languages&&!this.isInitialized)return u(null,this.t.bind(this));this.changeLanguage(this.options.lng,u)};return this.options.resources||!this.options.initAsync?c():setTimeout(c,0),l}loadResources(t){var a,o;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kn,i=Z(t)?t:this.language;if(typeof t=="function"&&(n=t),!this.options.resources||this.options.partialBundledLanguages){if((i==null?void 0:i.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();let s=[],l=c=>{if(!c||c==="cimode")return;this.services.languageUtils.toResolveHierarchy(c).forEach(d=>{d!=="cimode"&&s.indexOf(d)<0&&s.push(d)})};i?l(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(u=>l(u)),(o=(a=this.options.preload)==null?void 0:a.forEach)==null||o.call(a,c=>l(c)),this.services.backendConnector.load(s,this.options.ns,c=>{!c&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(c)})}else n(null)}reloadResources(t,e,n){let i=fn();return typeof t=="function"&&(n=t,t=void 0),typeof e=="function"&&(n=e,e=void 0),t||(t=this.languages),e||(e=this.options.ns),n||(n=Kn),this.services.backendConnector.reload(t,e,a=>{i.resolve(),n(a)}),i}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&Eo.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1))for(let e=0;e<this.languages.length;e++){let n=this.languages[e];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}changeLanguage(t,e){var n=this;this.isLanguageChangingTo=t;let i=fn();this.emit("languageChanging",t);let a=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},o=(l,c)=>{c?(a(c),this.translator.changeLanguage(c),this.isLanguageChangingTo=void 0,this.emit("languageChanged",c),this.logger.log("languageChanged",c)):this.isLanguageChangingTo=void 0,i.resolve(function(){return n.t(...arguments)}),e&&e(l,function(){return n.t(...arguments)})},s=l=>{var u,d;!t&&!l&&this.services.languageDetector&&(l=[]);let c=Z(l)?l:this.services.languageUtils.getBestMatchFromCodes(l);c&&(this.language||a(c),this.translator.language||this.translator.changeLanguage(c),(d=(u=this.services.languageDetector)==null?void 0:u.cacheUserLanguage)==null||d.call(u,c)),this.loadResources(c,f=>{o(f,c)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?s(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(s):this.services.languageDetector.detect(s):s(t),i}getFixedT(t,e,n){var i=this;let a=function(o,s){let l;if(typeof s!="object"){for(var c=arguments.length,u=new Array(c>2?c-2:0),d=2;d<c;d++)u[d-2]=arguments[d];l=i.options.overloadTranslationOptionHandler([o,s].concat(u))}else l={...s};l.lng=l.lng||a.lng,l.lngs=l.lngs||a.lngs,l.ns=l.ns||a.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||n||a.keyPrefix);let f=i.options.keySeparator||".",m;return l.keyPrefix&&Array.isArray(o)?m=o.map(b=>`${l.keyPrefix}${f}${b}`):m=l.keyPrefix?`${l.keyPrefix}${f}${o}`:o,i.t(m,l)};return Z(t)?a.lng=t:a.lngs=t,a.ns=e,a.keyPrefix=n,a}t(){var i;for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return(i=this.translator)==null?void 0:i.translate(...e)}exists(){var i;for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return(i=this.translator)==null?void 0:i.exists(...e)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;let n=e.lng||this.resolvedLanguage||this.languages[0],i=this.options?this.options.fallbackLng:!1,a=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;let o=(s,l)=>{let c=this.services.backendConnector.state[`${s}|${l}`];return c===-1||c===0||c===2};if(e.precheck){let s=e.precheck(this,o);if(s!==void 0)return s}return!!(this.hasResourceBundle(n,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(n,t)&&(!i||o(a,t)))}loadNamespaces(t,e){let n=fn();return this.options.ns?(Z(t)&&(t=[t]),t.forEach(i=>{this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}),this.loadResources(i=>{n.resolve(),e&&e(i)}),n):(e&&e(),Promise.resolve())}loadLanguages(t,e){let n=fn();Z(t)&&(t=[t]);let i=this.options.preload||[],a=t.filter(o=>i.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return a.length?(this.options.preload=i.concat(a),this.loadResources(o=>{n.resolve(),e&&e(o)}),n):(e&&e(),Promise.resolve())}dir(t){var i,a;if(t||(t=this.resolvedLanguage||(((i=this.languages)==null?void 0:i.length)>0?this.languages[0]:this.language)),!t)return"rtl";let e=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=((a=this.services)==null?void 0:a.languageUtils)||new Zn(ko());return e.indexOf(n.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return new vt(t,e)}cloneInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kn,n=t.forkResourceStore;n&&delete t.forkResourceStore;let i={...this.options,...t,isClone:!0},a=new vt(i);if((t.debug!==void 0||t.prefix!==void 0)&&(a.logger=a.logger.clone(t)),["store","services","language"].forEach(s=>{a[s]=this[s]}),a.services={...this.services},a.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},n){let s=Object.keys(this.store.data).reduce((l,c)=>(l[c]={...this.store.data[c]},Object.keys(l[c]).reduce((u,d)=>(u[d]={...l[c][d]},u),{})),{});a.store=new Qn(s,i),a.services.resourceStore=a.store}return a.translator=new Bt(a.services,i),a.translator.on("*",function(s){for(var l=arguments.length,c=new Array(l>1?l-1:0),u=1;u<l;u++)c[u-1]=arguments[u];a.emit(s,...c)}),a.init(i,e),a.translator.options=i,a.translator.backendConnector.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}},Ee=vt.createInstance();Ee.createInstance=vt.createInstance;Oy=Ee.createInstance,Dy=Ee.dir,My=Ee.init,Ly=Ee.loadResources,Ry=Ee.reloadResources,Fy=Ee.use,By=Ee.changeLanguage,qy=Ee.getFixedT,Ny=Ee.t,jy=Ee.exists,zy=Ee.setDefaultNamespace,Uy=Ee.hasLoadedNamespace,Hy=Ee.loadNamespaces,Wy=Ee.loadLanguages});var Io,Ao=F(()=>{Io={assets:{draft:"Draft",image:"Image","invalid-draft":"Invalid draft: missing account name or note path.",news:"News",video:"Video",voice:"Voice"},main:{"no-wechat-mp-account-selected":"No WeChat MP account selected.","please-check-you-appid-and-appsecret":"Please check your AppID and AppSecret.","open-previewer":"Article render previewer","fetch-wechat-profile":"Fetching WeChat profile","insert-mpcard":"Insert official account card","mpcard-not-configured":"No official account card configured. Paste the HTML in publish config first."},modals:{"be-careful":"Caution!",cancel:"Cancel",caution:"Caution!",confirm:"Confirm",delete:{action:"To proceed with deletion, click below.",message:"Are you sure you want to delete this item?",title:"Confirm Delete",warning:"This action is permanent and cannot be undone."},enter:"Enter",escape:"Escape",mpcard:{empty:"Please paste official account card content.",hint:"Copy the official account card code block from WeChat backend and paste it here.",insert:"Insert",placeholder:"Example:\n```mpcard\nid: gh_xxx\nheadimg: https://...\nnickname: Official Account\nsignature: Account description\n```",title:"Insert official account card"},ok:"OK",publish:{failed:"Publication failed",message:"Are you sure you want to publish this article?",success:"Published successfully",title:"Confirm publish",warning:"Publishing outside of WeChat MP may not be as efficient and some features might not work as expected (e.g., tags, pushing to public accounts)."},"publish-config":{"card-tab":"Official account card","options-tab":"Article options","mpcard-desc":"Paste the HTML code copied after inserting an official account card in WeChat editor.","copy-script":"Copy extract script","script-copied":"Script copied to clipboard.","mpcard-input":"Card HTML","mpcard-input-desc":"Paste <mp-common-profile> or a <section> that contains it.","mpcard-empty":"No official account card configured.","save-mpcard":"Parse and save","clear-mpcard":"Clear card","no-account":"No official account selected.","invalid-mpcard":"Invalid card content or missing data-id.","mpcard-saved":"Official account card saved.","no-active-file":"No active Markdown file.",title:"Title",author:"Author",digest:"Digest","source-url":"Source URL","open-comment":"Enable comments","only-fans":"Fans only comments","cover-empty":"Cover image not set."},space:"Space"},render:{"admonition-failed":"<section>Admonition rendering failed</section>","callout-failed":"<span>Callout rendering failed</span>","charts-failed":"<section>Charts rendering failed</section>","excalidraw-failed":"Excalidraw rendering failed","faild-canvas-context":"Failed to get canvas context.","failed-to-convert-canvas-to-blob":"Failed to convert canvas to Blob.","file-not-found":"File not found: {0}","mermaid-failed":"<section>Mermaid rendering failed</section>","pdf-crop-failed":"<span>Pdf cropping failed</span>","render-failed":"Rendering failed.","charts-plugin-not-installed":"Charts plugin not installed.","mpcard-default-name":"Official Account","mpcard-default-signature":"Account description",rendering:"Rendering...","failed-to-parse-custom-css":"Custom CSS parsing failed: {0}"},settings:{"account-info":"Account info","account-name":"Public account name","account-name-for-your-wechat-official":"WeChat official account name","add-ip-address-ipv4-0-to-wechat-mp-ip-wh":"Add IP address [{0}] to WeChat MP IP whitelist.",appid:"AppID","app-secret":"AppSecret","app-secret-for-your-wechat-official":"AppSecret for your WeChat official account","appid-for-your-wechat-official-account":"AppID for your WeChat official account","be-carefull-delete-account":"Caution! This will delete all settings and data for the account.","check-if-your-account-setting-is-correct":"Check if your account settings are correct.","click-to-connect-wechat-server":"Click to connect to WeChat server","successfully-connected-to-wechat-server":"Successfully connected to WeChat server.",fetching:"Fetching...","failed-to-connect-to-wechat-server":"Failed to connect to WeChat server.","copy-ip-address-to-clipboard":"Copy IP address to clipboard","copy-ip-to-clipboard":"Copy IP to clipboard","clipboard-not-supported":"Clipboard is not available on this platform.","create-new-account":"Create new account","custom-themes":"Custom themes","custom-themes-folder":"Custom themes folder","general-settings":"General settings","default-mpcard-biz-id":"Biz ID (data-id)","default-mpcard-biz-id-desc":"Base64 ID from the HTML.","delete-account":"Delete account","draft-previewer-wechat-id":"Draft previewer WeChat ID","draft-only-visible-for-the-wechat-user-o":"Draft visible only to the WeChat user. Requires API permission.","preview-draft-tooltip":"Send preview (API permission required)","enable-real-time-rendering":"Enable real-time rendering of markdown content","real-time-render":"Real-time Render","failed-to-get-wechat-access-token":"Failed to get WeChat access token.","if-your-device-cannot-get-static-pubic-i":"If your device cannot get a static public IP, use our center token server to get tokens. We will not misuse your AppID or AppSecret.","appid-secret-guide":"AppID and AppSecret are now available in WeChat Developer Console \u2192 Official Account \u2192 Basic Info.","appid-secret-guide-link":"Open WeChat Developer Console to get AppID / AppSecret","import-account-info":"Import Account Info","export-account-info":"Export Account Info","import-export-one2mp-account":"Import/Export Account Information","import-or-export-your-account-info-for-b":"Import or export your account info for backup and restore.","import-settings-title":"Import settings from vault","import-settings-hint":"Select a JSON settings file stored in your vault.","import-settings-placeholder":"Type or select a JSON file path","import-settings-confirm":"Import","import-settings-empty-path":"Please choose a settings file.","import-settings-file-not-found":"Settings file not found.","invalid-json-file":"Invalid JSON file.","invalid-wewerite-settings-file":"Invalid One2MP settings file.","ip-copied-to-clipboard":"IP copied to clipboard.","new-account":"New account","no-ip-address":"No IP address","public-ip-address":"Public IP address","select-account":"Select account","select-wechat-mp-account":"Select WeChat MP account","send-article-to-draft-box-successfully":"Article sent to draft box successfully.","settings-exported":"Settings exported successfully.","settings-exporting-failed":"Failed to export settings.","settings-exported-to-vault":"Settings exported to vault: {0}","settings-imported-error":"Error importing settings.","settings-imported-failed":"Failed to import settings.","settings-imported-successfully":"Settings imported successfully.","default-mpcard":"Default official account card","default-mpcard-desc":"Save a default official account card (used for right-click insert).","default-mpcard-placeholder":"Paste the official account card code block","default-mpcard-id":"Account ID","default-mpcard-id-desc":"Official account user_name.","default-mpcard-id-placeholder":"gh_xxx","default-mpcard-headimg":"Avatar URL","default-mpcard-headimg-desc":"Official account avatar link.","default-mpcard-headimg-placeholder":"https://...","default-mpcard-nickname":"Account name","default-mpcard-nickname-desc":"Official account display name.","default-mpcard-nickname-placeholder":"Account name","default-mpcard-signature":"Account description","default-mpcard-signature-desc":"Official account description.","default-mpcard-signature-placeholder":"Account description","default-mpcard-sync":"Sync account info","default-mpcard-sync-success":"Default official account card synced.","default-mpcard-sync-failed":"Failed to sync official account card.","default-mpcard-sync-partial":"Only nickname was synced. Please fill avatar/signature manually.","theme-download-overwrite":"Overwrite themes on download","theme-download-overwrite-desc":"When enabled, download will overwrite existing themes with the same name.","test-connection":"Test connection","choose-the-account-to-modify":"Choose the account to modify","the-folder-where-your-custom-themes":"Folder where your custom themes are stored.","themes-folder-path":"Themes folder path","use-center-token-server":"Use center token server","wechat-account":"WeChat account","you-should-add-this-ip-to-ip-whitelist-o":'Add this IP address to whitelist. Click the image in "account information" below to visit the WeChat MP platform.',"your-wechat-official-account":"Your WeChat official account"},views:{"article-header":{"article-title":"Article title","article-title-placeholder":"Enter article title",author:"Author","author-name":"Author name","comments-description":"Comments are closed by default.","cover-image":"Cover image","cover-image-description":"Cover image is required. Drag from vault or use an online image URL.","cover-file-not-supported":"Local file cover is not supported on mobile. Use a vault image or URL.","cover-image-mobile-button":"Choose/upload cover","cover-image-mobile-title":"Set cover image","cover-image-mobile-vault":"Select from vault","cover-image-mobile-vault-desc":"Choose an image path from the vault.","cover-image-mobile-vault-placeholder":"Type or select an image path","cover-image-mobile-url":"Use an image URL","cover-image-mobile-url-desc":"Enter an image URL.","cover-image-mobile-required":"Provide at least one cover image source.","cover-image-mobile-invalid":"Invalid image path. Please check and try again.","reset-cover-crop":"Reset crop",digest:"Digest","digest-text":"Enter digest text","only-fans-can-comment":"Only fans can comment","only-fans-can-comment-description":"Everyone can comment by default.","open-comments":"Open comments","testing-button":"Testing button",title:"Draft header"},"delete-draft":"Delete draft","delete-image":"Delete image","free-publish":"Free publish","no-title-article":"Article without title.","other-type-has-not-been-implemented":"Other type not implemented.","preview-draft":"Preview draft",previewer:{"article-copied-to-clipboard":"Article copied to clipboard.","open-url-not-supported":"Opening links is not supported on this platform.","article-render-failed":"Failed to render article.","article-title":"Article title","copy-article-to-clipboard":"Copy article to clipboard","publish-config":"Publish config","generate-template":"Generate WeChat template","file-not-found-path":"File not found: {0}","not-a-markdown-view":"Not a markdown view","please-set-cover-image":"Please set a cover image.","preview-draft-missing-id":"Send to draft first before previewing.","preview-draft-missing-wxid":"Set the previewer WeChat ID in Publish config first.","preview-draft-sent":"Preview message sent to WeChat.","render-article":"Render article","send-article-to-draft-box":"Send article to draft box","template-created":"WeChat template created.","template-file-created":"Template file created: one2mp-template.md","testing-button":"Testing button","to-verify-the-images-in-article":"Verify images in the article","one2mp-previewer":"O2Any previewer"},"send-mass-message":"Send mass message","theme-manager":{"default-theme":"Default theme","download-predefined-custom-themes":"Download predefined custom themes","download-started":"Theme download started. Please wait\u2026","download-themes-mobile-not-supported":"Theme download is not supported on mobile.","download-summary":"Theme download finished: {0} success, {1} failed, {2} skipped","error-downloading-theme":"Error downloading theme","error-downloading-themes":"Error downloading themes.","failed-to-fetch-themes-json-themesrespon":"Failed to fetch themes.json: {0}","total-themes-length-themes-downloaded":"Total {0} themes downloaded."}},"wechat-api":{"add-ip-address-ipv4-0-to-wechat-mp-ip-wh":"Add IP address [{0}] to WeChat MP IP whitelist.","failed-to-get-wechat-access-token":"Failed to get WeChat access token.","image-size-exceeds-10m":"Image size exceeds 10MB limit","video-size-exceeds-10m":"Video size exceeds 10MB limit","voice-size-exceeds-2m":"Voice size exceeds 2MB limit","select-an-wechat-mp-account-first":"Select a WeChat MP account first.","send-article-to-draft-box-successfully":"Article sent to draft box successfully.","uploading-material-type":"uploading material {0}"}}});var $o,Po=F(()=>{$o={assets:{draft:"\u8349\u7A3F",image:"\u56FE\u7247","invalid-draft":"\u65E0\u6548\u8349\u7A3F\uFF1A\u7F3A\u5C11\u8D26\u53F7\u540D\u79F0\u6216\u7B14\u8BB0\u8DEF\u5F84\u3002",news:"\u56FE\u6587\u6D88\u606F",video:"\u89C6\u9891",voice:"\u8BED\u97F3"},main:{"no-wechat-mp-account-selected":"\u672A\u9009\u62E9\u5FAE\u4FE1\u516C\u4F17\u53F7\u8D26\u53F7\u3002","please-check-you-appid-and-appsecret":"\u8BF7\u68C0\u67E5\u60A8\u7684AppID\u548CAppSecret\u3002","open-previewer":"\u6587\u7AE0\u6E32\u67D3\u9884\u89C8","fetch-wechat-profile":"\u63D0\u53D6\u516C\u4F17\u53F7\u4FE1\u606F","insert-mpcard":"\u63D2\u5165\u516C\u4F17\u53F7\u540D\u7247","mpcard-not-configured":"\u672A\u914D\u7F6E\u516C\u4F17\u53F7\u540D\u7247\uFF0C\u8BF7\u5148\u5728\u53D1\u5E03\u914D\u7F6E\u4E2D\u7C98\u8D34\u516C\u4F17\u53F7\u540D\u7247HTML\u3002"},modals:{"be-careful":"\u6CE8\u610F\uFF01",cancel:"\u53D6\u6D88",caution:"\u6CE8\u610F\uFF01",confirm:"\u786E\u8BA4",delete:{action:"\u70B9\u51FB\u4E0B\u65B9\u6309\u94AE\u7EE7\u7EED\u5220\u9664\u3002",message:"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u9879\u5417\uFF1F",title:"\u786E\u8BA4\u5220\u9664",warning:"\u6B64\u64CD\u4F5C\u4E0D\u53EF\u64A4\u9500\u3002"},enter:"\u56DE\u8F66",escape:"Esc\u952E",mpcard:{empty:"\u8BF7\u8F93\u5165\u516C\u4F17\u53F7\u540D\u7247\u5185\u5BB9\u3002",hint:"\u8BF7\u5728\u516C\u4F17\u53F7\u540E\u53F0\u590D\u5236\u516C\u4F17\u53F7\u540D\u7247\u7684\u4EE3\u7801\u5757\u5185\u5BB9\uFF0C\u5E76\u7C98\u8D34\u5230\u8FD9\u91CC\u3002",insert:"\u63D2\u5165",placeholder:"\u793A\u4F8B:\n```mpcard\nid: gh_xxx\nheadimg: https://...\nnickname: \u516C\u4F17\u53F7\u540D\u79F0\nsignature: \u516C\u4F17\u53F7\u4ECB\u7ECD\n```",title:"\u63D2\u5165\u516C\u4F17\u53F7\u540D\u7247"},ok:"\u786E\u5B9A",publish:{failed:"\u53D1\u5E03\u5931\u8D25",message:"\u786E\u5B9A\u8981\u53D1\u5E03\u8FD9\u7BC7\u6587\u7AE0\u5417\uFF1F",success:"\u53D1\u5E03\u6210\u529F",title:"\u786E\u8BA4\u53D1\u5E03",warning:"\u5728\u5FAE\u4FE1\u516C\u4F17\u53F7\u5E73\u53F0\u5916\u53D1\u5E03\u53EF\u80FD\u6548\u7387\u8F83\u4F4E\uFF0C\u90E8\u5206\u529F\u80FD\u53EF\u80FD\u65E0\u6CD5\u6B63\u5E38\u4F7F\u7528\uFF08\u5982\u6807\u7B7E\u3001\u63A8\u9001\u5230\u516C\u4F17\u53F7\u7B49\uFF09\u3002"},space:"\u7A7A\u683C"},"publish-config":{title:"\u6587\u7AE0\u53D1\u5E03\u914D\u7F6E","mp-card-settings":"\u516C\u4F17\u53F7\u540D\u7247\u914D\u7F6E","paste-html-guide":"\u8BF7\u4ECE\u6D4F\u89C8\u5668\u63D2\u4EF6\u6216\u516C\u4F17\u53F7\u540E\u53F0\u590D\u5236\u540D\u7247 HTML \u4EE3\u7801 (<mp-common-profile...>) \u5E76\u7C98\u8D34\u5230\u4E0B\u65B9\uFF1A","parse-and-save":"\u89E3\u6790\u5E76\u4FDD\u5B58","card-updated":"\u540D\u7247\u4FE1\u606F\u5DF2\u66F4\u65B0","parse-failed":"\u89E3\u6790\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5 HTML \u4EE3\u7801\u683C\u5F0F","manual-edit":"\u624B\u52A8\u7F16\u8F91 (\u9AD8\u7EA7)","other-settings":"\u5176\u4ED6\u53D1\u5E03\u53C2\u6570","card-tab":"\u516C\u4F17\u53F7\u540D\u7247","options-tab":"\u6587\u7AE0\u53C2\u6570","mpcard-desc":"\u8BF7\u7C98\u8D34\u516C\u4F17\u53F7\u540E\u53F0\u4E2D\u63D2\u5165\u540D\u7247\u540E\u590D\u5236\u5230\u7684 HTML \u4EE3\u7801\u3002","copy-script":"\u590D\u5236\u63D0\u53D6\u811A\u672C","script-copied":"\u811A\u672C\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F\u3002","mpcard-input":"\u540D\u7247 HTML","mpcard-input-desc":"\u7C98\u8D34 <mp-common-profile> \u6216\u5305\u542B\u5B83\u7684 <section> \u4EE3\u7801\u3002","mpcard-empty":"\u5C1A\u672A\u914D\u7F6E\u516C\u4F17\u53F7\u540D\u7247\u3002","save-mpcard":"\u89E3\u6790\u5E76\u4FDD\u5B58","clear-mpcard":"\u6E05\u7A7A\u540D\u7247","no-account":"\u672A\u9009\u62E9\u516C\u4F17\u53F7\u8D26\u53F7\u3002","invalid-mpcard":"\u540D\u7247\u5185\u5BB9\u65E0\u6548\u6216\u7F3A\u5C11 data-id\u3002","mpcard-saved":"\u516C\u4F17\u53F7\u540D\u7247\u5DF2\u4FDD\u5B58\u3002","no-active-file":"\u672A\u627E\u5230\u53EF\u7F16\u8F91\u7684 Markdown \u6587\u4EF6\u3002","field-title":"\u6807\u9898",author:"\u4F5C\u8005",digest:"\u6458\u8981","source-url":"\u539F\u6587\u94FE\u63A5","open-comment":"\u5F00\u542F\u8BC4\u8BBA","only-fans":"\u4EC5\u7C89\u4E1D\u53EF\u8BC4\u8BBA","cover-empty":"\u672A\u8BBE\u7F6E\u5C01\u9762\u56FE\u3002"},render:{"admonition-failed":"<section>Admonition\u6E32\u67D3\u5931\u8D25</section>","callout-failed":"<span>Callout\u6E32\u67D3\u5931\u8D25</span>","charts-failed":"<section>\u56FE\u8868\u6E32\u67D3\u5931\u8D25</section>","excalidraw-failed":"Excalidraw\u6E32\u67D3\u5931\u8D25","faild-canvas-context":"\u83B7\u53D6canvas\u4E0A\u4E0B\u6587\u5931\u8D25\u3002","failed-to-convert-canvas-to-blob":"\u5C06canvas\u8F6C\u6362\u4E3ABlob\u5931\u8D25\u3002","file-not-found":"\u6587\u4EF6\u672A\u627E\u5230\uFF1A{0}","mermaid-failed":"<section>Mermaid\u6E32\u67D3\u5931\u8D25</section>","pdf-crop-failed":"<span>PDF\u88C1\u526A\u5931\u8D25</span>","render-failed":"\u6E32\u67D3\u5931\u8D25\u3002","charts-plugin-not-installed":"\u56FE\u8868\u63D2\u4EF6\u672A\u5B89\u88C5\u3002","mpcard-default-name":"\u516C\u4F17\u53F7\u540D\u79F0","mpcard-default-signature":"\u516C\u4F17\u53F7\u4ECB\u7ECD",rendering:"\u6E32\u67D3\u4E2D...","failed-to-parse-custom-css":"\u5B9A\u5236\u98CE\u683C\u5B58\u5728CSS\u8BED\u6CD5\u9519\u8BEF\uFF1A{0}"},settings:{"account-info":"\u8D26\u53F7\u4FE1\u606F","account-name":"\u516C\u4F17\u53F7\u540D\u79F0","account-name-for-your-wechat-official":"\u5FAE\u4FE1\u516C\u4F17\u53F7\u540D\u79F0","add-ip-address-ipv4-0-to-wechat-mp-ip-wh":"\u5C06IP\u5730\u5740[{0}]\u6DFB\u52A0\u5230\u5FAE\u4FE1\u516C\u4F17\u53F7IP\u767D\u540D\u5355\u3002",appid:"AppID","app-secret":"AppSecret","app-secret-for-your-wechat-official":"\u5FAE\u4FE1\u516C\u4F17\u53F7AppSecret","appid-for-your-wechat-official-account":"\u5FAE\u4FE1\u516C\u4F17\u53F7AppID","be-carefull-delete-account":"\u6CE8\u610F\uFF01\u8FD9\u5C06\u5220\u9664\u8BE5\u8D26\u53F7\u7684\u6240\u6709\u8BBE\u7F6E\u548C\u6570\u636E\u3002","check-if-your-account-setting-is-correct":"\u68C0\u67E5\u8D26\u53F7\u8BBE\u7F6E\u662F\u5426\u6B63\u786E\u3002","click-to-connect-wechat-server":"\u70B9\u51FB\u8FDE\u63A5\u5FAE\u4FE1\u670D\u52A1\u5668","successfully-connected-to-wechat-server":"\u6210\u529F\u8FDE\u63A5\u5230\u5FAE\u4FE1\u670D\u52A1\u5668\u3002",fetching:"\u83B7\u53D6\u4E2D...","failed-to-connect-to-wechat-server":"\u8FDE\u63A5\u5FAE\u4FE1\u670D\u52A1\u5668\u5931\u8D25\u3002","copy-ip-address-to-clipboard":"\u590D\u5236IP\u5730\u5740\u5230\u526A\u8D34\u677F","copy-ip-to-clipboard":"\u590D\u5236IP\u5230\u526A\u8D34\u677F","clipboard-not-supported":"\u5F53\u524D\u5E73\u53F0\u4E0D\u652F\u6301\u526A\u8D34\u677F\u3002","create-new-account":"\u521B\u5EFA\u65B0\u8D26\u53F7","custom-themes":"\u81EA\u5B9A\u4E49\u4E3B\u9898","custom-themes-folder":"\u81EA\u5B9A\u4E49\u4E3B\u9898\u6587\u4EF6\u5939","theme-download-overwrite":"\u4E0B\u8F7D\u4E3B\u9898\u65F6\u8986\u76D6\u540C\u540D\u6587\u4EF6","theme-download-overwrite-desc":"\u5F00\u542F\u5219\u8986\u76D6\u5DF2\u6709\u540C\u540D\u4E3B\u9898\uFF0C\u5173\u95ED\u5219\u8DF3\u8FC7\u3002","general-settings":"\u901A\u7528\u8BBE\u7F6E","default-mpcard-biz-id":"Biz ID\uFF08data-id\uFF09","default-mpcard-biz-id-desc":"HTML \u4E2D\u7684 base64 ID\u3002","delete-account":"\u5220\u9664\u8D26\u53F7","draft-previewer-wechat-id":"\u8349\u7A3F\u9884\u89C8\u8005\u5FAE\u4FE1ID","draft-only-visible-for-the-wechat-user-o":"\u8349\u7A3F\u4EC5\u5BF9\u5FAE\u4FE1\u7528\u6237\u53EF\u89C1\uFF0C\u9700\u516C\u4F17\u53F7\u63A5\u53E3\u6743\u9650\u3002","preview-draft-tooltip":"\u53D1\u9001\u8349\u7A3F\u9884\u89C8\uFF08\u9700\u63A5\u53E3\u6743\u9650\uFF09","enable-real-time-rendering":"\u542F\u7528Markdown\u5185\u5BB9\u7684\u5B9E\u65F6\u6E32\u67D3","real-time-render":"\u5B9E\u65F6\u6E32\u67D3","failed-to-get-wechat-access-token":"\u83B7\u53D6\u5FAE\u4FE1access token\u5931\u8D25\u3002","if-your-device-cannot-get-static-pubic-i":"\u5982\u679C\u60A8\u7684\u8BBE\u5907\u65E0\u6CD5\u83B7\u53D6\u9759\u6001\u516C\u7F51IP\uFF0C\u8BF7\u4F7F\u7528\u6211\u4EEC\u7684\u4E2D\u5FC3\u4EE4\u724C\u670D\u52A1\u5668\u83B7\u53D6\u4EE4\u724C\u3002\u6211\u4EEC\u4E0D\u4F1A\u6EE5\u7528\u60A8\u7684AppID\u6216AppSecret\u3002","appid-secret-guide":"AppID \u4E0E AppSecret \u73B0\u5728\u9700\u8981\u5728\u300C\u5FAE\u4FE1\u5F00\u53D1\u8005\u5E73\u53F0-\u516C\u4F17\u53F7-\u57FA\u7840\u4FE1\u606F\u300D\u4E2D\u83B7\u53D6\u3002","appid-secret-guide-link":"\u6253\u5F00\u5FAE\u4FE1\u5F00\u53D1\u8005\u5E73\u53F0\u83B7\u53D6 AppID / AppSecret","import-account-info":"\u5BFC\u5165\u8D26\u53F7\u4FE1\u606F","export-account-info":"\u5BFC\u51FA\u8D26\u53F7\u4FE1\u606F","import-export-one2mp-account":"\u5BFC\u5165/\u5BFC\u51FA\u8D26\u53F7\u4FE1\u606F","import-or-export-your-account-info-for-b":"\u5BFC\u5165\u6216\u5BFC\u51FA\u60A8\u7684\u8D26\u53F7\u4FE1\u606F\u4EE5\u8FDB\u884C\u5907\u4EFD\u548C\u6062\u590D\u3002","import-settings-title":"\u4ECE\u4ED3\u5E93\u5BFC\u5165\u8BBE\u7F6E","import-settings-hint":"\u8BF7\u9009\u62E9\u4FDD\u5B58\u5728\u4ED3\u5E93\u4E2D\u7684 JSON \u8BBE\u7F6E\u6587\u4EF6\u3002","import-settings-placeholder":"\u8F93\u5165\u6216\u9009\u62E9 JSON \u6587\u4EF6\u8DEF\u5F84","import-settings-confirm":"\u5BFC\u5165","import-settings-empty-path":"\u8BF7\u9009\u62E9\u8BBE\u7F6E\u6587\u4EF6\u3002","import-settings-file-not-found":"\u672A\u627E\u5230\u8BBE\u7F6E\u6587\u4EF6\u3002","invalid-json-file":"\u65E0\u6548\u7684JSON\u6587\u4EF6\u3002","invalid-wewerite-settings-file":"\u65E0\u6548\u7684One2MP\u8BBE\u7F6E\u6587\u4EF6\u3002","ip-copied-to-clipboard":"IP\u5730\u5740\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F\u3002","new-account":"\u65B0\u5EFA\u8D26\u53F7","no-ip-address":"\u65E0IP\u5730\u5740","public-ip-address":"\u516C\u7F51IP\u5730\u5740","select-account":"\u9009\u62E9\u8D26\u53F7","select-wechat-mp-account":"\u9009\u62E9\u5FAE\u4FE1\u516C\u4F17\u53F7\u8D26\u53F7","send-article-to-draft-box-successfully":"\u6587\u7AE0\u6210\u529F\u53D1\u9001\u5230\u8349\u7A3F\u7BB1\u3002","settings-exported":"\u8BBE\u7F6E\u5BFC\u51FA\u6210\u529F\u3002","settings-exporting-failed":"\u8BBE\u7F6E\u5BFC\u51FA\u5931\u8D25\u3002","settings-exported-to-vault":"\u8BBE\u7F6E\u5DF2\u5BFC\u51FA\u5230\u4ED3\u5E93\uFF1A{0}","settings-imported-error":"\u8BBE\u7F6E\u5BFC\u5165\u51FA\u9519\u3002","settings-imported-failed":"\u8BBE\u7F6E\u5BFC\u5165\u5931\u8D25\u3002","settings-imported-successfully":"\u8BBE\u7F6E\u5BFC\u5165\u6210\u529F\u3002","default-mpcard":"\u9ED8\u8BA4\u516C\u4F17\u53F7\u540D\u7247","default-mpcard-desc":"\u4FDD\u5B58\u9ED8\u8BA4\u516C\u4F17\u53F7\u540D\u7247\uFF08\u53EF\u5728\u53F3\u952E\u63D2\u5165\u65F6\u81EA\u52A8\u586B\u5145\uFF09\u3002","default-mpcard-placeholder":"\u7C98\u8D34\u516C\u4F17\u53F7\u540D\u7247\u4EE3\u7801\u5757","default-mpcard-id":"\u8D26\u53F7ID","default-mpcard-id-desc":"\u516C\u4F17\u53F7\u539F\u59CBID\uFF08user_name\uFF09\u3002","default-mpcard-id-placeholder":"gh_xxx","default-mpcard-headimg":"\u5934\u50CFURL","default-mpcard-headimg-desc":"\u516C\u4F17\u53F7\u5934\u50CF\u94FE\u63A5\u3002","default-mpcard-headimg-placeholder":"https://...","default-mpcard-nickname":"\u516C\u4F17\u53F7\u540D\u79F0","default-mpcard-nickname-desc":"\u516C\u4F17\u53F7\u663E\u793A\u540D\u79F0\u3002","default-mpcard-nickname-placeholder":"\u516C\u4F17\u53F7\u540D\u79F0","default-mpcard-signature":"\u516C\u4F17\u53F7\u4ECB\u7ECD","default-mpcard-signature-desc":"\u516C\u4F17\u53F7\u7B80\u4ECB/\u7B7E\u540D\u3002","default-mpcard-signature-placeholder":"\u516C\u4F17\u53F7\u4ECB\u7ECD","default-mpcard-sync":"\u4E00\u952E\u540C\u6B65\u8D26\u53F7\u4FE1\u606F","default-mpcard-sync-success":"\u5DF2\u540C\u6B65\u9ED8\u8BA4\u516C\u4F17\u53F7\u540D\u7247\u3002","default-mpcard-sync-failed":"\u540C\u6B65\u516C\u4F17\u53F7\u540D\u7247\u5931\u8D25\u3002","default-mpcard-sync-partial":"\u4EC5\u540C\u6B65\u5230\u6635\u79F0\u4FE1\u606F\uFF0C\u8BF7\u624B\u52A8\u8865\u5145\u5934\u50CF/\u4ECB\u7ECD\u3002","test-connection":"\u6D4B\u8BD5\u8FDE\u63A5","choose-the-account-to-modify":"\u9009\u62E9\u8981\u4FEE\u6539\u7684\u8D26\u53F7","the-folder-where-your-custom-themes":"\u5B58\u50A8\u81EA\u5B9A\u4E49\u4E3B\u9898\u7684\u6587\u4EF6\u5939\u3002","themes-folder-path":"\u4E3B\u9898\u6587\u4EF6\u5939\u8DEF\u5F84","use-center-token-server":"\u4F7F\u7528\u4E2D\u5FC3\u4EE4\u724C\u670D\u52A1\u5668","wechat-account":"\u5FAE\u4FE1\u516C\u4F17\u53F7\u8D26\u53F7","you-should-add-this-ip-to-ip-whitelist-o":"\u8BF7\u5C06\u6B64IP\u6DFB\u52A0\u5230IP\u767D\u540D\u5355\u4E2D\u3002\u70B9\u51FB\u4E0B\u65B9\u8D26\u53F7\u4FE1\u606F\u4E2D\u7684\u56FE\u7247\u8BBF\u95EE\u201C\u5FAE\u4FE1\u516C\u4F17\u53F7\u5E73\u53F0\u201D\u8FDB\u884C\u8BBE\u7F6E\u3002","your-wechat-official-account":"\u60A8\u7684\u5FAE\u4FE1\u516C\u4F17\u53F7"},views:{"article-header":{"article-title":"\u6587\u7AE0\u6807\u9898","article-title-placeholder":"\u8F93\u5165\u6587\u7AE0\u6807\u9898",author:"\u4F5C\u8005","author-name":"\u4F5C\u8005\u540D\u79F0","comments-description":"\u8BC4\u8BBA\u9ED8\u8BA4\u5173\u95ED\u3002","cover-image":"\u5C01\u9762\u56FE\u7247","cover-image-description":"\u6587\u7AE0\u5FC5\u987B\u5305\u542B\u5C01\u9762\u56FE\u7247\u3002\u53EF\u4ECE\u672C\u5730\u4ED3\u5E93\u62D6\u653E\u56FE\u7247\u6216\u4F7F\u7528\u7F51\u7EDC\u56FE\u7247\u94FE\u63A5\u3002","cover-file-not-supported":"\u79FB\u52A8\u7AEF\u4E0D\u652F\u6301\u672C\u5730\u6587\u4EF6\u5C01\u9762\uFF0C\u8BF7\u4F7F\u7528\u4ED3\u5E93\u56FE\u7247\u6216\u7F51\u7EDC\u94FE\u63A5\u3002","cover-image-mobile-button":"\u9009\u62E9/\u4E0A\u4F20\u5C01\u9762","cover-image-mobile-title":"\u8BBE\u7F6E\u5C01\u9762\u56FE\u7247","cover-image-mobile-vault":"\u4ECE\u4ED3\u5E93\u9009\u62E9\u56FE\u7247","cover-image-mobile-vault-desc":"\u9009\u62E9\u4ED3\u5E93\u4E2D\u7684\u56FE\u7247\u8DEF\u5F84\u3002","cover-image-mobile-vault-placeholder":"\u8F93\u5165\u6216\u9009\u62E9\u56FE\u7247\u8DEF\u5F84","cover-image-mobile-url":"\u4F7F\u7528\u7F51\u7EDC\u56FE\u7247\u94FE\u63A5","cover-image-mobile-url-desc":"\u8F93\u5165\u56FE\u7247\u7684\u7F51\u7EDC\u94FE\u63A5\u3002","cover-image-mobile-required":"\u8BF7\u81F3\u5C11\u63D0\u4F9B\u4E00\u4E2A\u5C01\u9762\u56FE\u7247\u6765\u6E90\u3002","cover-image-mobile-invalid":"\u56FE\u7247\u8DEF\u5F84\u65E0\u6548\uFF0C\u8BF7\u68C0\u67E5\u540E\u518D\u8BD5\u3002","reset-cover-crop":"\u91CD\u7F6E\u88C1\u526A",digest:"\u6458\u8981","digest-text":"\u8F93\u5165\u6458\u8981\u6587\u672C","only-fans-can-comment":"\u4EC5\u7C89\u4E1D\u53EF\u8BC4\u8BBA","only-fans-can-comment-description":"\u9ED8\u8BA4\u6240\u6709\u4EBA\u90FD\u53EF\u8BC4\u8BBA","open-comments":"\u5F00\u542F\u8BC4\u8BBA","testing-button":"\u6D4B\u8BD5\u6309\u94AE",title:"\u6587\u7AE0\u5C5E\u6027"},"delete-draft":"\u5220\u9664\u8349\u7A3F","delete-image":"\u5220\u9664\u56FE\u7247","free-publish":"\u514D\u8D39\u53D1\u5E03","no-title-article":"\u65E0\u6807\u9898\u6587\u7AE0\u3002","other-type-has-not-been-implemented":"\u5176\u4ED6\u7C7B\u578B\u5C1A\u672A\u5B9E\u73B0\u3002","preview-draft":"\u9884\u89C8\u8349\u7A3F",previewer:{"article-copied-to-clipboard":"\u6587\u7AE0\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F\u3002","open-url-not-supported":"\u5F53\u524D\u5E73\u53F0\u4E0D\u652F\u6301\u6253\u5F00\u94FE\u63A5\u3002","article-render-failed":"\u6587\u7AE0\u6E32\u67D3\u5931\u8D25\u3002","article-title":"\u6587\u7AE0\u6807\u9898","copy-article-to-clipboard":"\u590D\u5236\u6587\u7AE0\u5230\u526A\u8D34\u677F","publish-config":"\u53D1\u5E03\u914D\u7F6E","generate-template":"\u751F\u6210\u516C\u4F17\u53F7\u6A21\u677F","file-not-found-path":"\u6587\u4EF6\u672A\u627E\u5230\uFF1A{0}","not-a-markdown-view":"\u4E0D\u662FMarkdown\u89C6\u56FE","please-set-cover-image":"\u8BF7\u8BBE\u7F6E\u5C01\u9762\u56FE\u7247\u3002","preview-draft-missing-id":"\u8BF7\u5148\u53D1\u9001\u5230\u8349\u7A3F\u7BB1\u518D\u9884\u89C8\u3002","preview-draft-missing-wxid":"\u8BF7\u5728\u53D1\u5E03\u914D\u7F6E\u4E2D\u586B\u5199\u8349\u7A3F\u9884\u89C8\u8005\u5FAE\u4FE1ID\u3002","preview-draft-sent":"\u9884\u89C8\u6D88\u606F\u5DF2\u53D1\u9001\u5230\u5FAE\u4FE1\u3002","render-article":"\u6E32\u67D3\u6587\u7AE0","send-article-to-draft-box":"\u53D1\u9001\u6587\u7AE0\u5230\u8349\u7A3F\u7BB1","template-created":"\u516C\u4F17\u53F7\u6A21\u677F\u5DF2\u751F\u6210\u3002","template-file-created":"\u5DF2\u521B\u5EFA\u6A21\u677F\u6587\u4EF6\uFF1Aone2mp-template.md","testing-button":"\u6D4B\u8BD5\u6309\u94AE","to-verify-the-images-in-article":"\u9A8C\u8BC1\u6587\u7AE0\u4E2D\u7684\u56FE\u7247","one2mp-previewer":"O2Any\u9884\u89C8\u5668"},"send-mass-message":"\u7FA4\u53D1\u6D88\u606F","theme-manager":{"default-theme":"\u9ED8\u8BA4\u4E3B\u9898","download-predefined-custom-themes":"\u4E0B\u8F7D\u5B9A\u5236\u4E3B\u9898","download-themes-mobile-not-supported":"\u79FB\u52A8\u7AEF\u6682\u4E0D\u652F\u6301\u4E3B\u9898\u4E0B\u8F7D\u3002","error-downloading-theme":"\u4E0B\u8F7D\u4E3B\u9898\u51FA\u9519","error-downloading-themes":"\u4E0B\u8F7D\u4E3B\u9898\u51FA\u9519\u3002","failed-to-fetch-themes-json-themesrespon":"\u83B7\u53D6themes.json\u5931\u8D25\uFF1A{0}","total-themes-length-themes-downloaded":"\u5171\u4E0B\u8F7D{0}\u4E2A\u4E3B\u9898\u3002","download-started":"\u5F00\u59CB\u4E0B\u8F7D\u4E3B\u9898\uFF0C\u8BF7\u7A0D\u5019\u2026","download-summary":"\u4E3B\u9898\u4E0B\u8F7D\u5B8C\u6210\uFF1A\u6210\u529F {0} \u4E2A\uFF0C\u5931\u8D25 {1} \u4E2A\uFF0C\u8DF3\u8FC7 {2} \u4E2A"}},"wechat-api":{"add-ip-address-ipv4-0-to-wechat-mp-ip-wh":"\u5C06IP\u5730\u5740[{0}]\u6DFB\u52A0\u5230\u5FAE\u4FE1\u516C\u4F17\u53F7IP\u767D\u540D\u5355\u3002","failed-to-get-wechat-access-token":"\u83B7\u53D6\u5FAE\u4FE1access token\u5931\u8D25\u3002","image-size-exceeds-10m":"\u56FE\u7247\u5927\u5C0F\u8D85\u8FC710MB\u9650\u5236","video-size-exceeds-10m":"\u89C6\u9891\u5927\u5C0F\u8D85\u8FC710MB\u9650\u5236","voice-size-exceeds-2m":"\u8BED\u97F3\u5927\u5C0F\u8D85\u8FC72MB\u9650\u5236","select-an-wechat-mp-account-first":"\u8BF7\u5148\u9009\u62E9\u4E00\u4E2A\u5FAE\u4FE1\u516C\u4F17\u53F7\u8D26\u53F7\u3002","send-article-to-draft-box-successfully":"\u6587\u7AE0\u6210\u529F\u53D1\u9001\u5230\u8349\u7A3F\u7BB1\u3002","uploading-material-type":"\u4E0A\u4F20\u7D20\u6750\u7C7B\u578B\uFF1A{0}"}}});function A(r,t){let e=Ee.t(r);if(t!==void 0)for(let n=0;n<t.length;n++)e=e.replace(`{${n}}`,t[n]);return e}var Oo,$e=F(()=>{To();Oo=require("obsidian");Ao();Po();Ee.init({debug:!1,lng:Oo.moment.locale(),fallbackLng:"en",interpolation:{escapeValue:!1},resources:{en:{translation:Io},zh:{translation:$o}}}).catch(r=>{console.error("i18n init failed:",r)});window.$t=A});var tr,qt,bi=F(()=>{tr=require("obsidian"),qt=class extends tr.AbstractInputSuggest{constructor(e,n,i=[]){super(e,n);this.inputEl=n;this.extensions=i}getSuggestions(e){let n=e.toLowerCase();return this.app.vault.getAllLoadedFiles().filter(a=>a instanceof tr.TFile).filter(a=>this.extensions.length&&!this.extensions.includes(a.extension)?!1:a.path.toLowerCase().includes(n))}renderSuggestion(e,n){n.setText(e.path)}selectSuggestion(e){this.inputEl.value=e.path,this.inputEl.trigger("input"),this.close()}}});var Ud,Nt,nr=F(()=>{Ud=r=>{let t=r.trim();return t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")?t.slice(1,-1):t},Nt=r=>{if(!r.startsWith("---"))return{data:{},content:r};let t=r.indexOf(`
---`,3);if(t===-1)return{data:{},content:r};let e=r.slice(3,t).trim(),i=r.slice(t+4).replace(/^\r?\n/,""),a={};if(e)for(let o of e.split(/\r?\n/)){let s=o.match(/^([^:#]+):\s*(.*)$/);if(!s)continue;let l=s[1].trim(),c=Ud(s[2]);l&&(a[l]=c)}return{data:a,content:i}}});var Lo,Mo=F(()=>{Lo=`/* 00_one2mp.css 
	\u5B9A\u4E49one2mp\u7684\u57FA\u672C\u8272\u7CFB

*/
:root {
  /* \u4E3B\u8272\u7CFB */
  --one2mp-primary: #2c3e50;
  --one2mp-secondary: #3498db;
  --one2mp-accent: #e67e22;
  --one2mp-primary-light: #d0e4ff;
  
  /* \u4E2D\u6027\u8272 */
  --one2mp-bg: transparent;
  --one2mp-bg-alt: var(--one2mp-primary);
  --one2mp-text: #333333;
  --one2mp-text-color: var(--one2mp-text);
  --one2mp-text-alt: #ffffff;
  --one2mp-border:#999999;
  
  /* \u72B6\u6001\u8272 */
  --one2mp-success: #27ae60;
  --one2mp-success: #28a745;
  --one2mp-warning: #ff9800;
  --one2mp-error: #e74c3c;
  --one2mp-danger:  #dc3545;
  --one2mp-blue: #1e3a8a;
}	

:root {
	--one2mp-font-size: 16px;
	--one2mp-line-height: 1.8;
	--one2mp-text-indent: 0;
	--one2mp-letter-spacing: 0;
	--one2mp-word-spacing: 0;
	--one2mp-text-align: left;
	--one2mp-text-decoration: none;
	--one2mp-border-width: 1px;
	--one2mp-border-style: solid;
	--one2mp-border-radius: 4px;
	--one2mp-border-radius-sm: 2px;
	--one2mp-border-radius-lg: 6px;
	--one2mp-border-radius-xl: 8px;
}
body{
	font-size: var(--one2mp-font-size);
	line-height: var(--one2mp-line-height);
	text-indent: var(--one2mp-text-indent);
	letter-spacing: var(--one2mp-letter-spacing);
	word-spacing: var(--one2mp-word-spacing);
	text-align: var(--one2mp-text-align);
	text-decoration: var(--one2mp-text-decoration);
	border-width: var(--one2mp-border-width);
	border-style: var(--one2mp-border-style);
	border-radius: var(--one2mp-border-radius);
} 
`});var Fo,Ro=F(()=>{Fo=`/**
* \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u9875\u9762\u7248\u5F0F\u548C\u57FA\u672C\u5B57\u4F53\u98CE\u683C\u7684\u6837\u5F0F
*/

:root {
	/* page  layout */
	--article-max-width: none;
	--article-min-width: 200px;
	--article-padding: 0px;
	--article-margin: 0px;
	--article-background-color: var(--one2mp-bg);
	--article-background-image: none;
	--article-background-repeat: repeat;
	--article-background-size: auto;
	--article-background-position: left top;
	
}

.one2mp {
	max-width: var(--article-max-width);
	min-width: var(--article-min-width);
	padding: var(--article-padding);
	margin: var(--article-margin);
	background-color: var(--article-background-color);
	background-image: var(--article-background-image);
	background-repeat: var(--article-background-repeat);
	background-size: var(--article-background-size);
	background-position: var(--article-background-position);
	
}
`});var qo,Bo=F(()=>{qo=`/**
 * \u5B9A\u4E49icon,image \u7684\u57FA\u672C\u6837\u5F0F
 */
:root {
	/* --icon-pin: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='%23333' viewBox='0 0 24 24'%3E%3Cpath d='M12 0c.6 0 1 .4 1 1v7h1l2.4-4c.3-.6 1-.7 1.4-.4.5.3.7 1 .4 1.5L16 9l5 5v1h-7v7h-1l-5-5-3.9 2.6c-.5.3-1.1.2-1.4-.3-.3-.5-.2-1.1.3-1.4L8 13l-4-5.3c-.3-.5-.2-1.2.3-1.5.5-.3 1.2-.2 1.5.3L10 9V1c0-.6.4-1 1-1z'/%3E%3C/svg%3E"); */

	/* --icon-pencil: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 24 24'%3E%3Cpath d='M17.25 2.08a1.5 1.5 0 0 1 2.12 0l2.55 2.55a1.5 1.5 0 0 1 0 2.12l-2.34 2.34-4.67-4.67L17.25 2.08zM13.89 4.89l4.67 4.67L7.5 20.61H2v-5.5L13.89 4.89z'/%3E%3C/svg%3E"); */
	/* --icon-clip: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 24 24'%3E%3Cpath d='M16.5 3.5a5.002 5.002 0 0 1 3.536 8.536L10.828 21.244a7 7 0 0 1-9.9-9.9L12.121.15a1 1 0 1 1 1.415 1.414L2.343 12.757a5 5 0 1 0 7.07 7.071l9.207-9.207a3 3 0 1 0-4.243-4.243L5.464 16.464a1 1 0 1 1-1.414-1.414L16.5 3.5z'/%3E%3C/svg%3E"); */
	/* --icon-book:   url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='none' viewBox='0 0 24 24'><rect x='3' y='3' width='14' height='18' rx='2' fill='%23F5F5F5' stroke='%23BDBDBD' stroke-width='1.5'/><line x1='6' y1='6' x2='14' y2='6' stroke='%239E9E9E' stroke-width='1'/><line x1='6' y1='9' x2='14' y2='9' stroke='%239E9E9E' stroke-width='1'/><line x1='6' y1='12' x2='14' y2='12' stroke='%239E9E9E' stroke-width='1'/><path d='M17.5 4.5L19.5 6.5L9 17L6 17L6 14L17.5 4.5Z' fill='%23FFEB3B' stroke='%23FBC02D' stroke-width='1'/><path d='M6 17L6.5 18L7.5 18.5L9 17H6Z' fill='%23795548'/><circle cx='18.5' cy='5.5' r='1' fill='%23E91E63'/></svg>"); */
	/* --bg-img-student: linear-gradient(transparent 29px, #ddd 30px), */




	--icon-pin: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 42'%3E%3Cpath fill='%23ff4444' d='M16 1C9 1 3 7 3 14c0 10 11 21 13 21s13-11 13-21c0-7-6-13-13-13zm0 20a7 7 0 1 1 0-14 7 7 0 0 1 0 14z'/%3E%3C/svg%3E");
	
}
`});var jo,No=F(()=>{jo=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u5B57\u4F53\u7248\u5F0F\u6837\u5F0F
 */
:root {

	/* typography */
	--article-font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji;
	--article-font-weight: 400;
	--article-word-break: break-word;
	--article-letter-space: 0px;
	--article-text-font-size: 15px;
	--article-text-color: var(--one2mp-text);
	--article-line-height: var(--one2mp-line-height);
	--article-text-align: left;
	--article-text-indent: 0;
	--article-font-style: normal;
}

.one2mp {
	font-family: var(--article-font-family);
	font-weight: var(--article-font-weight);
	word-break: var(--article-word-break);
	letter-spacing: var(--article-letter-space);
	color: var(--article-text-color);
	font-size: var(--article-text-font-size);
	line-height: var(--article-line-height);
	text-align: var(--article-text-align);
	text-indent: var(--article-text-indent);
	font-style: var(--article-font-style); 
}

`});var Uo,zo=F(()=>{Uo=`/**
* \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u6B63\u6587\u6837\u5F0F
*/

:root {
	--paragraph-font-family: var(--article-font-family);
	--paragraph-font-weight: var(--article-font-weight);
	--paragraph-font-size: var(--article-text-font-size);
	--paragraph-word-break: var(--article-word-break);
	--paragraph-text-color: var(--article-text-color);
	--paragraph-letter-space: var(--article-letter-space);
	--paragraph-line-height: var(--article-line-height);
	--paragraph-text-align: var(--article-text-align);
	--paragraph-text-indent: var(--article-text-indent);
	--paragraph-font-style: var(--article-font-style);
	--paragraph-margin: var(--article-margin);
}

.one2mp > p {
	font-family: var(--paragraph-font-family);
	font-weight: var(--paragraph-font-weight);
	font-size: var(--paragraph-font-size);
	color: var(--paragraph-text-color);
	word-break: var(--paragraph-word-break);
	letter-spacing: var(--paragraph-letter-space);
	line-height: var(--paragraph-line-height);
	text-align: var(--paragraph-text-align);
	text-indent: var(--paragraph-text-indent);
	font-style: var(--paragraph-font-style);
	margin: var(--paragraph-margin);
}
`});var Wo,Ho=F(()=>{Wo=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u4FEE\u9970\u6027\u6587\u5B57\u7684\u98CE\u683C\uFF1A
 - \u7C97\u4F53

 */
:root {
	--strong-font-family: var(--article-font-family);
	--strong-font-weight: 600;
	--strong-font-style: bold;
	--strong-font-size: var(--article-text-font-size);
	--strong-line-height: var(--article-line-height);
	--strong-letter-spacing: var(--article-letter-space);
	--strong-text-align: var(--article-text-align);
	--strong-text-indent: var(--article-text-indent);
	--strong-color: var(--one2mp-primary);
}

.one2mp strong {
	font-family: var(--strong-font-family);
	font-weight: var(--strong-font-weight);
	font-size: var(--strong-font-size);
	line-height: var(--strong-line-height);
	letter-spacing: var(--strong-letter-spacing);
	text-align: var(--strong-text-align);
	text-indent: var(--strong-text-indent);
	color: var(--strong-color);
}
`});var Ko,Vo=F(()=>{Ko=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u4FEE\u9970\u6027\u6587\u5B57\u7684\u98CE\u683C\uFF1A
 - \u659C\u4F53
 - 

 */
:root {
	--em-font-family: var(--article-font-family);
	--em-font-weight: var(--article-font-weight);
	--em-font-size: var(--article-text-font-size);
	--em-line-height: var(--article-line-height);
	--em-letter-spacing: var(--article-letter-space);
	--em-text-align: var(--article-text-align);
	--em-text-indent: var(--article-text-indent);
	--em-color: var(--article-text-color);
	--em-font-style: italic;
	
}

.one2mp em {
	font-family: var(--em-font-family);
	font-weight: var(--em-font-weight);
	font-size: var(--em-font-size);
	line-height: var(--em-line-height);
	letter-spacing: var(--em-letter-spacing);
	text-align: var(--em-text-align);
	text-indent: var(--em-text-indent);
	color: var(--em-color);
	font-style: var(--em-font-style);
}
`});var Jo,Go=F(()=>{Jo=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u4FEE\u9970\u6027\u6587\u5B57\u7684\u98CE\u683C\uFF1A
 - \u659C\u4F53
 - 

 */
:root {
	--u-font-family: var(--article-font-family);
	--u-font-weight: var(--article-font-weight);
	--u-font-size: var(--article-text-font-size);
	--u-line-height: var(--article-line-height);
	--u-letter-spacing: var(--article-letter-space);
	--u-text-align: var(--article-text-align);
	--u-text-indent: var(--article-text-indent);
	--u-color: var(--article-text-color);
	--u-font-style: normal;
	--u-text-decoration: underline;
	--u-text-decoration-thickness: 1px;
	--u-text-decoration-style: solid;
	--u-text-decoration-color: var(--article-text-color);
	--u-underline-offset: 0.2em;
}

.one2mp u {
	font-family: var(--u-font-family);
	font-weight: var(--u-font-weight);
	font-size: var(--u-font-size);
	line-height: var(--u-line-height);
	letter-spacing: var(--u-letter-spacing);
	text-align: var(--u-text-align);
	text-indent: var(--u-text-indent);
	color: var(--u-color);
	font-style: var(--u-font-style);
	text-decoration:  var(--u-text-decoration);
	text-decoration-thickness: var(--u-text-decoration-thickness);
	text-decoration-style: var(--u-text-decoration-style);
	text-decoration-color: var(--u-text-decoration-color);
	text-underline-offset: var(--u-underline-offset)
}
`});var Zo,Qo=F(()=>{Zo=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u4FEE\u9970\u6027\u6587\u5B57\u7684\u98CE\u683C\uFF1A
 - \u659C\u4F53
 - 

 */
:root {
	--del-font-family: var(--article-font-family);
	--del-font-weight: var(--article-font-weight);
	--del-font-size: var(--article-text-font-size);
	--del-line-height: var(--article-line-height);
	--del-letter-spacing: var(--article-letter-space);
	--del-text-align: var(--article-text-align);
	--del-text-indent: var(--article-text-indent);
	--del-color: var(--article-text-color);
	--del-font-style: normal;
	--del-text-decoration: line-through;
	--del-text-decoration-thickness: 1px;
	--del-text-decoration-style: solid;
	--del-text-decoration-color: var(--article-text-color);
}

.one2mp del {
	font-family: var(--del-font-family);
	font-weight: var(--del-font-weight);
	font-size: var(--del-font-size);
	line-height: var(--del-line-height);
	letter-spacing: var(--del-letter-spacing);
	text-align: var(--del-text-align);
	text-indent: var(--del-text-indent);
	color: var(--del-color);
	font-style: var(--del-font-style);
	text-decoration:  var(--del-text-decoration);
	text-decoration-thickness: var(--del-text-decoration-thickness);
	text-decoration-style: var(--del-text-decoration-style);
	text-decoration-color: var(--del-text-decoration-color);
}
`});var xi,Yo=F(()=>{xi=`:root{
	--codespan-color: #e5c07b;
	--codespan-background-color: #282c34;
	--codespan-padding: 2px 4px;
	--codespan-border-radius: 4px;
	--codespan-font-size: 0.9rem;
	--codespan-font-family: "Fira Code", "Fira Mono", "Source Code Pro", "Roboto Mono", monospace;
	--codespan-font-weight: 500;
}

.one2mp .one2mp-codespan {
	color: var(--codespan-color, #e5c07b);
	background-color: var(--codespan-background-color, #282c34);
	padding: var(--codespan-padding, 2px);
	border-radius: var(--codespan-border-radius, 4px);
	font-size: var(--codespan-font-size, 0.9rem);
	font-family: var(--codespan-font-family, "Fira Code", "Fira Mono", "Source Code Pro", "Roboto Mono", monospace);
	font-weight: var(--codespan-font-weight, 500);

}
`});var es,Xo=F(()=>{es=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u6807\u9898\u7684\u57FA\u672C\u6837\u5F0F
 */

:root {
	--heading-font-family: var(--article-font-family);
	--heading-font-weight: 600;
	--heading-color: var(--article-text-color);
	--heading-line-height: 1.5;
	--heading-letter-spacing: var(--article-letter-space);
	--heading-text-align: var(--article-text-align);
	--heading-font-style: normal;
	--heading-margin: 1rem 0;
	--heading-text-decoration-style: none;
	--heading-text-decoration-thickness: 0;
	--heading-text-decoration-color: transparent; 
	--heading-radius: var(--one2mp-radius);
	--heading-border-bottom-width: 0;
	--heading-border-bottom-style: none;
	--heading-border-bottom-color: transparent;
	--heading-padding: 0;
	--heading-display: flex;
	--heading-tail-display: none;
	--heading-tail-content: " ";
	--heading-tail-shadow-color: rgb(239, 235, 233);
	--heading-tail-shadow-height: 0;
	--heading-tail-shadow-width: 0;
	
}

/* \u6807\u9898 */
.one2mp h1,
.one2mp h2,
.one2mp h3,
.one2mp h4,
.one2mp h5,
.one2mp h6 {
	font-family: var(--heading-font-family);
	font-weight: var(--heading-font-weight);
	color: var(--heading-color);
	line-height: var(--heading-line-height);
	letter-spacing: var(--heading-letter-spacing);
	text-align: var(--heading-text-align);
	font-style: var(--heading-font-style);
	margin: var(--heading-margin);
	text-decoration-style: var(--heading-text-decoration-style);
	text-decoration-thickness: var(--heading-text-decoration-thickness);
	text-decoration-color: var(--heading-text-decoration-color);
	display: var(--heading-display);
}

.one2mp .one2mp-heading-prefix {
	display: none;
}
.one2mp .one2mp-heading-outbox {
	display: block;
}
.one2mp .one2mp-heading-leaf {
	display: block;
}
.one2mp .one2mp-heading-tail {
	display: none;
}
`});var ns,ts=F(()=>{ns=`/**
h1  \u6807\u9898
*/

:root {

	--h1-font-family: var(--heading-font-family);
	--h1-font-weight: var(--heading-font-weight);
	--h1-color: var(--heading-color);
	--h1-font-size: 2.2rem;
	--h1-line-height: var(--heading-line-height);
	--h1-letter-spacing: var(--heading-letter-spacing);
	--h1-text-align: var(--heading-text-align);
	--h1-font-style: var(--heading-font-style);
	--h1-text-decoration-style: var(--heading-text-decoration-style);
	--h1-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h1-text-decoration-color: var(--heading-text-decoration-color);
	--h1-margin: var(--heading-margin);
	/* --h1-bg: var(--one2mp-primary); */
	--h1-bg: var(--one2mp-bg);
	--h1-border-bottom-width: var(--heading-border-bottom-width);
	/* --h1-border-bottom-color: var(--h1-bg); */
	--h1-border-bottom-color: var(--heading-border-bottom-color);
	--h1-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h1-prefix-display: none;
	--h1-prefix-color: var(--h1-color);
	--h1-font-style: normal;
	--h1-text-align: var(--h1-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h1-outbox-display: block;
	--h1-outbox-radius: var(--one2mp-border-radius);
	--h1-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h1-leaf-display: block;
	--h1-leaf-padding: var(--heading-padding);
	--h1-leaf-color: var(--h1-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h1-tail-display: inline-block; */
	--h1-tail-display: none;
	--h1-tail-content: " ";
	--h1-tail-vertical-align: bottom;
	--h1-tail-display: var(--heading-tail-display);
	--h1-tail-content: var(--heading-tail-content);
	--h1-tail-shadow-color: var(--heading-tail-shadow-color);
	--h1-tail-shadow-height: var(--heading-tail-shadow-height);
	--h1-tail-shadow-width: var(--heading-tail-shadow-width);
	--h1-display: flex;
}

.one2mp h1 {
	font-family: var(--h1-font-family);
	font-weight: var(--h1-font-weight);
	font-size: var(--h1-font-size);
	line-height: var(--h1-line-height);
	letter-spacing: var(--h1-letter-spacing);
	text-align: var(--h1-text-align);
	color: var(--h1-color);
	font-style: var(--h1-font-style);
	text-decoration-style: var(--h1-text-decoration-style);
	text-decoration-thickness: var(--h1-text-decoration-thickness);
	text-decoration-color: var(--h1-text-decoration-color);
	margin: var(--h1-margin);
	border-bottom-width: var(--h1-border-bottom-width);
	border-bottom-style: var(--h1-border-bottom-style);
	border-bottom-color: var(--h1-border-bottom-color);
	display: var(--h1-display);
}


.one2mp h1 .one2mp-heading-prefix {
	display: var(--h1-prefix-display);
	color: var(--h1-prefix-color);
	font-style: var(--h1-font-style);
	text-align: var(--h1-text-align);

}

.one2mp h1 .one2mp-heading-outbox {
	border-top-right-radius: var(--h1-outbox-radius);
	border-top-left-radius: var(--h1-outbox-radius);
	background-color: var(--h1-bg);
	padding: var(--h1-outbox-padding);
	display: block;
}

.one2mp h1 .one2mp-heading-leaf {
	padding-left: var(--h1-leaf-padding);
	padding-right: var(--h1-leaf-padding);
	font-weight: var(--h1-font-weight);
	display: var(--h1-leaf-display);
	color: var(--h1-leaf-color)
}

.one2mp h1 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h1-tail-display);
	content: var(--h1-tail-content);
	vertical-align: var(--h1-tail-vertical-align);
	border-bottom: var(--h1-tail-shadow-height) solid var(--h1-tail-shadow-color);
	border-right: var(--h1-tail-shadow-width) solid transparent;

}
`});var is,rs=F(()=>{is=`/**
h2  \u6807\u9898
*/

:root {
	--h2-font-family: var(--heading-font-family);
	--h2-font-weight: var(--heading-font-weight);
	--h2-color: var(--heading-color);
	--h2-font-size: 2rem;
	--h2-line-height: var(--heading-line-height);
	--h2-letter-spacing: var(--heading-letter-spacing);
	--h2-text-align: var(--heading-text-align);
	--h2-font-style: var(--heading-font-style);
	--h2-text-decoration-style: var(--heading-text-decoration-style);
	--h2-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h2-text-decoration-color: var(--heading-text-decoration-color);
	--h2-margin: var(--heading-margin);
	/* --h2-bg: var(--one2mp-primary); */
	--h2-bg: var(--one2mp-bg);
	--h2-border-bottom-width: var(--heading-border-bottom-width);
	/* --h2-border-bottom-color: var(--h2-bg); */
	--h2-border-bottom-color: var(--heading-border-bottom-color);
	--h2-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h2-prefix-display: none;
	--h2-prefix-color: var(--h2-color);
	--h2-font-style: normal;
	--h2-text-align: var(--h2-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h2-outbox-display: block;
	--h2-outbox-radius: var(--one2mp-border-radius);
	--h2-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h2-leaf-display: block;
	--h2-leaf-padding: var(--heading-padding);
	--h2-leaf-color: var(--h2-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h2-tail-display: inline-block; */
	--h2-tail-display: none;
	--h2-tail-content: " ";
	--h2-tail-vertical-align: bottom;
	--h2-tail-display: var(--heading-tail-display);
	--h2-tail-content: var(--heading-tail-content);
	--h2-tail-shadow-color: var(--heading-tail-shadow-color);
	--h2-tail-shadow-height: var(--heading-tail-shadow-height);
	--h2-tail-shadow-width: var(--heading-tail-shadow-width);
	--h2-display: flex;
}
.one2mp h2 {
	font-family: var(--h2-font-family);
	font-weight: var(--h2-font-weight);
	font-size: var(--h2-font-size);
	line-height: var(--h2-line-height);
	letter-spacing: var(--h2-letter-spacing);
	text-align: var(--h2-text-align);
	color: var(--h2-color);
	font-style: var(--h2-font-style);
	text-decoration-style: var(--h2-text-decoration-style);
	text-decoration-thickness: var(--h2-text-decoration-thickness);
	text-decoration-color: var(--h2-text-decoration-color);
	margin: var(--h2-margin);
	border-bottom-width: var(--h2-border-bottom-width);
	border-bottom-style: var(--h2-border-bottom-style);
	border-bottom-color: var(--h2-border-bottom-color);
	display: var(--h2-display);
}


.one2mp h2 .one2mp-heading-prefix {
	display: var(--h2-prefix-display);
	color: var(--h2-prefix-color);
	font-style: var(--h2-font-style);
	text-align: var(--h2-text-align);

}
.one2mp h2 .one2mp-heading-outbox {
	border-top-right-radius: var(--h2-outbox-radius);
	border-top-left-radius: var(--h2-outbox-radius);
	background-color: var(--h2-bg);
	padding: var(--h2-outbox-padding);
	display: block;
}
.one2mp h2 .one2mp-heading-leaf {
	padding-left: var(--h2-leaf-padding);
	padding-right: var(--h2-leaf-padding);
	font-weight:  var(--h2-font-weight);
	display: var(--h2-leaf-display);
	color: var(--h2-leaf-color)
}
.one2mp h2 .one2mp-heading-tail {
	box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizelegibility;
    display: var(--h2-tail-display);
    content: var(--h2-tail-content);
    vertical-align: var(--h2-tail-vertical-align);
	border-bottom: var(--h2-tail-shadow-height) solid var(--h2-tail-shadow-color);
	border-right: var(--h2-tail-shadow-width) solid transparent;
}
`});var os,as=F(()=>{os=`/**
h3  \u6807\u9898
*/

:root {
	--h3-font-family: var(--heading-font-family);
	--h3-font-weight: var(--heading-font-weight);
	--h3-color: var(--heading-color);
	--h3-font-size: 1.8rem;
	--h3-line-height: var(--heading-line-height);
	--h3-letter-spacing: var(--heading-letter-spacing);
	--h3-text-align: var(--heading-text-align);
	--h3-font-style: var(--heading-font-style);
	--h3-text-decoration-style: var(--heading-text-decoration-style);
	--h3-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h3-text-decoration-color: var(--heading-text-decoration-color);
	--h3-margin: var(--heading-margin);
	/* --h3-bg: var(--one2mp-primary); */
	--h3-bg: var(--one2mp-bg);
	--h3-border-bottom-width: var(--heading-border-bottom-width);
	/* --h3-border-bottom-color: var(--h3-bg); */
	--h3-border-bottom-color: var(--heading-border-bottom-color);
	--h3-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h3-prefix-display: none;
	--h3-prefix-color: var(--h3-color);
	--h3-font-style: normal;
	--h3-text-align: var(--h3-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h3-outbox-display: block;
	--h3-outbox-radius: var(--one2mp-border-radius);
	--h3-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h3-leaf-display: block;
	--h3-leaf-padding: var(--heading-padding);
	--h3-leaf-color: var(--h3-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h3-tail-display: inline-block; */
	--h3-tail-display: none;
	--h3-tail-content: " ";
	--h3-tail-vertical-align: bottom;
	--h3-tail-display: var(--heading-tail-display);
	--h3-tail-content: var(--heading-tail-content);
	--h3-tail-shadow-color: var(--heading-tail-shadow-color);
	--h3-tail-shadow-height: var(--heading-tail-shadow-height);
	--h3-tail-shadow-width: var(--heading-tail-shadow-width);
	--h3-display: flex;
}

.one2mp h3 {
	font-family: var(--h3-font-family);
	font-weight: var(--h3-font-weight);
	font-size: var(--h3-font-size);
	line-height: var(--h3-line-height);
	letter-spacing: var(--h3-letter-spacing);
	text-align: var(--h3-text-align);
	color: var(--h3-color);
	font-style: var(--h3-font-style);
	text-decoration-style: var(--h3-text-decoration-style);
	text-decoration-thickness: var(--h3-text-decoration-thickness);
	text-decoration-color: var(--h3-text-decoration-color);
	margin: var(--h3-margin);
	border-bottom-width: var(--h3-border-bottom-width);
	border-bottom-style: var(--h3-border-bottom-style);
	border-bottom-color: var(--h3-border-bottom-color);
	display: var(--h3-display);
}


.one2mp h3 .one2mp-heading-prefix {
	display: var(--h3-prefix-display);
	color: var(--h3-prefix-color);
	font-style: var(--h3-font-style);
	text-align: var(--h3-text-align);

}

.one2mp h3 .one2mp-heading-outbox {
	border-top-right-radius: var(--h3-outbox-radius);
	border-top-left-radius: var(--h3-outbox-radius);
	background-color: var(--h3-bg);
	padding: var(--h3-outbox-padding);
	display: block;
}

.one2mp h3 .one2mp-heading-leaf {
	padding-left: var(--h3-leaf-padding);
	padding-right: var(--h3-leaf-padding);
	font-weight: var(--h3-font-weight);
	display: var(--h3-leaf-display);
	color: var(--h3-leaf-color)
}

.one2mp h3 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h3-tail-display);
	content: var(--h3-tail-content);
	vertical-align: var(--h3-tail-vertical-align);
	border-bottom: var(--h3-tail-shadow-height) solid var(--h3-tail-shadow-color);
	border-right: var(--h3-tail-shadow-width) solid transparent;
}
`});var ls,ss=F(()=>{ls=`/**
h4  \u6807\u9898
*/

:root {
	--h4-font-family: var(--heading-font-family);
	--h4-font-weight: var(--heading-font-weight);
	--h4-color: var(--heading-color);
	--h4-font-size: 1.5rem;
	--h4-line-height: var(--heading-line-height);
	--h4-letter-spacing: var(--heading-letter-spacing);
	--h4-text-align: var(--heading-text-align);
	--h4-font-style: var(--heading-font-style);
	--h4-text-decoration-style: var(--heading-text-decoration-style);
	--h4-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h4-text-decoration-color: var(--heading-text-decoration-color);
	--h4-margin: var(--heading-margin);
	/* --h4-bg: var(--one2mp-primary); */
	--h4-bg: var(--one2mp-bg);
	--h4-border-bottom-width: var(--heading-border-bottom-width);
	/* --h4-border-bottom-color: var(--h4-bg); */
	--h4-border-bottom-color: var(--heading-border-bottom-color);
	--h4-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h4-prefix-display: none;
	--h4-prefix-color: var(--h4-color);
	--h4-font-style: normal;
	--h4-text-align: var(--h4-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h4-outbox-display: block;
	--h4-outbox-radius: var(--one2mp-border-radius);
	--h4-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h4-leaf-display: block;
	--h4-leaf-padding: var(--heading-padding);
	--h4-leaf-color: var(--h4-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h4-tail-display: inline-block; */
	--h4-tail-display: none;
	--h4-tail-content: " ";
	--h4-tail-vertical-align: bottom;
	--h4-tail-display: var(--heading-tail-display);
	--h4-tail-content: var(--heading-tail-content);
	--h4-tail-shadow-color: var(--heading-tail-shadow-color);
	--h4-tail-shadow-height: var(--heading-tail-shadow-height);
	--h4-tail-shadow-width: var(--heading-tail-shadow-width);
	--h4-display: flex;
}


.one2mp h4 {
	font-family: var(--h4-font-family);
	font-weight: var(--h4-font-weight);
	font-size: var(--h4-font-size);
	line-height: var(--h4-line-height);
	letter-spacing: var(--h4-letter-spacing);
	text-align: var(--h4-text-align);
	color: var(--h4-color);
	font-style: var(--h4-font-style);
	text-decoration-style: var(--h4-text-decoration-style);
	text-decoration-thickness: var(--h4-text-decoration-thickness);
	text-decoration-color: var(--h4-text-decoration-color);
	margin: var(--h4-margin);
	border-bottom-width: var(--h4-border-bottom-width);
	border-bottom-style: var(--h4-border-bottom-style);
	border-bottom-color: var(--h4-border-bottom-color);
	display: var(--h4-display);
}


.one2mp h4 .one2mp-heading-prefix {
	display: var(--h4-prefix-display);
	color: var(--h4-prefix-color);
	font-style: var(--h4-font-style);
	text-align: var(--h4-text-align);

}

.one2mp h4 .one2mp-heading-outbox {
	border-top-right-radius: var(--h4-outbox-radius);
	border-top-left-radius: var(--h4-outbox-radius);
	background-color: var(--h4-bg);
	padding: var(--h4-outbox-padding);
	display: block;
}

.one2mp h4 .one2mp-heading-leaf {
	padding-left: var(--h4-leaf-padding);
	padding-right: var(--h4-leaf-padding);
	font-weight: var(--h4-font-weight);
	display: var(--h4-leaf-display);
	color: var(--h4-leaf-color)
}

.one2mp h4 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h4-tail-display);
	content: var(--h4-tail-content);
	vertical-align: var(--h4-tail-vertical-align);
	border-bottom: var(--h4-tail-shadow-height) solid var(--h4-tail-shadow-color);
	border-right: var(--h4-tail-shadow-width) solid transparent;
}
`});var us,cs=F(()=>{us=`/**
h5  \u6807\u9898
*/

:root {
	--h5-font-family: var(--heading-font-family);
	--h5-font-weight: var(--heading-font-weight);
	--h5-color: var(--heading-color);
	--h5-font-size: 1.2rem;
	--h5-line-height: var(--heading-line-height);
	--h5-letter-spacing: var(--heading-letter-spacing);
	--h5-text-align: var(--heading-text-align);
	--h5-font-style: var(--heading-font-style);
	--h5-text-decoration-style: var(--heading-text-decoration-style);
	--h5-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h5-text-decoration-color: var(--heading-text-decoration-color);
	--h5-margin: var(--heading-margin);
	/* --h5-bg: var(--one2mp-primary); */
	--h5-bg: var(--one2mp-bg);
	--h5-border-bottom-width: var(--heading-border-bottom-width);
	/* --h5-border-bottom-color: var(--h5-bg); */
	--h5-border-bottom-color: var(--heading-border-bottom-color);
	--h5-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h5-prefix-display: none;
	--h5-prefix-color: var(--h5-color);
	--h5-font-style: normal;
	--h5-text-align: var(--h5-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h5-outbox-display: block;
	--h5-outbox-radius: var(--one2mp-border-radius);
	--h5-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h5-leaf-display: block;
	--h5-leaf-padding: var(--heading-padding);
	--h5-leaf-color: var(--h5-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h5-tail-display: inline-block; */
	--h5-tail-display: none;
	--h5-tail-content: " ";
	--h5-tail-vertical-align: bottom;
	--h5-tail-display: var(--heading-tail-display);
	--h5-tail-content: var(--heading-tail-content);
	--h5-tail-shadow-color: var(--heading-tail-shadow-color);
	--h5-tail-shadow-height: var(--heading-tail-shadow-height);
	--h5-tail-shadow-width: var(--heading-tail-shadow-width);
	--h5-display: flex;
}

.one2mp h5 {
	font-family: var(--h5-font-family);
	font-weight: var(--h5-font-weight);
	font-size: var(--h5-font-size);
	line-height: var(--h5-line-height);
	letter-spacing: var(--h5-letter-spacing);
	text-align: var(--h5-text-align);
	color: var(--h5-color);
	font-style: var(--h5-font-style);
	text-decoration-style: var(--h5-text-decoration-style);
	text-decoration-thickness: var(--h5-text-decoration-thickness);
	text-decoration-color: var(--h5-text-decoration-color);
	margin: var(--h5-margin);
	border-bottom-width: var(--h5-border-bottom-width);
	border-bottom-style: var(--h5-border-bottom-style);
	border-bottom-color: var(--h5-border-bottom-color);
	display: var(--h5-display);
}


.one2mp h5 .one2mp-heading-prefix {
	display: var(--h5-prefix-display);
	color: var(--h5-prefix-color);
	font-style: var(--h5-font-style);
	text-align: var(--h5-text-align);

}

.one2mp h5 .one2mp-heading-outbox {
	border-top-right-radius: var(--h5-outbox-radius);
	border-top-left-radius: var(--h5-outbox-radius);
	background-color: var(--h5-bg);
	padding: var(--h5-outbox-padding);
	display: block;
}

.one2mp h5 .one2mp-heading-leaf {
	padding-left: var(--h5-leaf-padding);
	padding-right: var(--h5-leaf-padding);
	font-weight: var(--h5-font-weight);
	display: var(--h5-leaf-display);
	color: var(--h5-leaf-color)
}

.one2mp h5 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h5-tail-display);
	content: var(--h5-tail-content);
	vertical-align: var(--h5-tail-vertical-align);
	border-bottom: var(--h5-tail-shadow-height) solid var(--h5-tail-shadow-color);
	border-right: var(--h5-tail-shadow-width) solid transparent;
}
`});var fs,ds=F(()=>{fs=`/**
h6  \u6807\u9898
*/

:root {
	--h6-font-family: var(--heading-font-family);
	--h6-font-weight: var(--heading-font-weight);
	--h6-color: var(--heading-color);
	--h6-font-size: 1rem;
	--h6-line-height: var(--heading-line-height);
	--h6-letter-spacing: var(--heading-letter-spacing);
	--h6-text-align: var(--heading-text-align);
	--h6-font-style: var(--heading-font-style);
	--h6-text-decoration-style: var(--heading-text-decoration-style);
	--h6-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h6-text-decoration-color: var(--heading-text-decoration-color);
	--h6-margin: var(--heading-margin);
	/* --h6-bg: var(--one2mp-primary); */
	--h6-bg: var(--one2mp-bg);
	--h6-border-bottom-width: var(--heading-border-bottom-width);
	/* --h6-border-bottom-color: var(--h6-bg); */
	--h6-border-bottom-color: var(--heading-border-bottom-color);
	--h6-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h6-prefix-display: none;
	--h6-prefix-color: var(--h6-color);
	--h6-font-style: normal;
	--h6-text-align: var(--h6-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h6-outbox-display: block;
	--h6-outbox-radius: var(--one2mp-border-radius);
	--h6-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h6-leaf-display: block;
	--h6-leaf-padding: var(--heading-padding);
	--h6-leaf-color: var(--h6-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h6-tail-display: inline-block; */
	--h6-tail-display: none;
	--h6-tail-content: " ";
	--h6-tail-vertical-align: bottom;
	--h6-tail-display: var(--heading-tail-display);
	--h6-tail-content: var(--heading-tail-content);
	--h6-tail-shadow-color: var(--heading-tail-shadow-color);
	--h6-tail-shadow-height: var(--heading-tail-shadow-height);
	--h6-tail-shadow-width: var(--heading-tail-shadow-width);
	--h6-display: flex;
}

.one2mp h6 {
	font-family: var(--h6-font-family);
	font-weight: var(--h6-font-weight);
	font-size: var(--h6-font-size);
	line-height: var(--h6-line-height);
	letter-spacing: var(--h6-letter-spacing);
	text-align: var(--h6-text-align);
	color: var(--h6-color);
	font-style: var(--h6-font-style);
	text-decoration-style: var(--h6-text-decoration-style);
	text-decoration-thickness: var(--h6-text-decoration-thickness);
	text-decoration-color: var(--h6-text-decoration-color);
	margin: var(--h6-margin);
	border-bottom-width: var(--h6-border-bottom-width);
	border-bottom-style: var(--h6-border-bottom-style);
	border-bottom-color: var(--h6-border-bottom-color);
	display: var(--h6-display);
}


.one2mp h6 .one2mp-heading-prefix {
	display: var(--h6-prefix-display);
	color: var(--h6-prefix-color);
	font-style: var(--h6-font-style);
	text-align: var(--h6-text-align);

}

.one2mp h6 .one2mp-heading-outbox {
	border-top-right-radius: var(--h6-outbox-radius);
	border-top-left-radius: var(--h6-outbox-radius);
	background-color: var(--h6-bg);
	padding: var(--h6-outbox-padding);
	display: block;
}

.one2mp h6 .one2mp-heading-leaf {
	padding-left: var(--h6-leaf-padding);
	padding-right: var(--h6-leaf-padding);
	font-weight: var(--h6-font-weight);
	display: var(--h6-leaf-display);
	color: var(--h6-leaf-color)
}

.one2mp h6 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h6-tail-display);
	content: var(--h6-tail-content);
	vertical-align: var(--h6-tail-vertical-align);
	border-bottom: var(--h6-tail-shadow-height) solid var(--h6-tail-shadow-color);
	border-right: var(--h6-tail-shadow-width) solid transparent;
}
`});var ps,hs=F(()=>{ps=`:root {
	--image-border-radius: var(--one2mp-border-radius);
	--image-border-width: 0px;
	--image-border-color: transparent;
	--image-border-style: solid;
	--image-frame-padding: 0px;
	--image-caption-triangle: hidden;
	--image-caption-triangle-width: 0rem;
	--image-caption-margin-top: -1rem;
	--image-caption-text-color: var(--one2mp-text-color);
	--image-cation-font-size: 0.8rem;
	--image-caption-font-weight: normal;
	--image-caption-font-style: normal;
	--image-caption-font-family: var(--article-font-family);
	--image-caption-line-height: 1.5;
	--image-caption-text-align: center;
}

.one2mp img:not(.one2mp-profile-card img) {
	border-radius: var(--image-border-radius);
	border-width: var(--image-border-width); 
	border-style: var(--image-border-style);
	border-color: var(--image-border-color);
	box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
	margin: 0.0 0;
}

.image-with-caption {
	position: relative;
	display: inline-block;
	text-align: center;
	/* \u9ED8\u8BA4\u5C45\u4E2D\uFF0C\u53EF\u901A\u8FC7\u7C7B\u63A7\u5236 */
	font-family: "Arial", sans-serif;
	border-radius: var(--image-border-radius);
	border-width: var(--image-border-width); 
	border-style: var(--image-border-style);
	border-color: var(--image-border-color);
	box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
	padding: var(--image-frame-padding);
	margin: 0;
}

.image-with-caption img {
	max-width: 100%;
	height: auto;
	display: block;
}

/* \u5BF9\u9F50\u65B9\u5F0F\u63A7\u5236 */
.image-with-caption.align-left {
	text-align: left;
}

.image-with-caption.align-center {
	text-align: center;
}

.image-with-caption.align-right {
	text-align: right;
}

/* \u4F2A\u5143\u7D20\u4F5C\u4E3A\u56FE\u7247\u6807\u9898 */
.image-caption {
	font-size: 0.9rem;
	color: gray;
	position: relative;
	margin-right: auto;
}

.image-caption-row {
	display: flex;
	align-items: center;
	gap: 0.5em;
	/* \u4E09\u89D2\u5F62\u548C\u6587\u5B57\u4E4B\u95F4\u7684\u95F4\u8DDD */
	margin-bottom: 0.5em;
	position: relative;
	top: -0.3rem;
}

.image-with-caption .triangle {
	width: 0;
	height: 0;
	border: var(--image-caption-triangle-width, 0.3rem) solid transparent;
	border-bottom-color: var(--image-border-color, #555);
	position: relative;
	top: -0.3rem;
	margin-left: auto;
}

.one2mp .caption {
	font-size: 0.9rem;
	color: var(--image-border-color, #555);
	position: relative;
	width: 100%;
	text-align: center;
	top: var(--image-caption-margin-top, -2rem);
}

.one2mp .one2mp-image-caption {
	font-size: var(--image-cation-font-size);
	color: var(--image-caption-text-color);
	font-weight: var(--image-caption-font-weight);
	font-style: var(--image-caption-font-style);
	font-family: var(--image-caption-font-family);
	line-height: var(--image-caption-line-height);
	text-align: var(--image-caption-text-align);
	position: relative;
	width: 100%;
	text-align: var(--image-caption-text-align);
	top: var(--image-caption-margin-top, -2rem);
}
`});var ms,gs=F(()=>{ms=`/* list */
:root {
	--list-text-color: var(--article-text-color, #333);
	--list-bg-color: var(--article-bg-color, #fff);
	--list-padding-left: 0.5rem;
	--list-line-height: var(--article-line-height, 1.6);
	--list-ul-style: disc;
	--list-ol-style: decimal;
	--list-item-margin-bottom: 3px;
	--list-margin-top: 3px;
	--list-margin-buton: 3px;
	--list-margin-left: 1rem;
	--list-text-indent: 0;
}
.one2mp ol,
.one2mp ul:not(.one2mp .code-section ul) {
	color: var(--list-text-color, #333);
	/* background-color: var(--list-bg-color, #fff); */
	padding-left: var(--list-padding-left);
	margin-left: var(--list-margin-left, 1rem);
	margin-top: var(--list-margin-top, 0);
	margin-bottom: var(--list-margin-bottom, 0);
	line-height: var(--list-line-height, 1.5);
	text-indent: var(--list-text-indent, 0);

}

.one2mp ol {
	list-style-type: var(--list-ol-style, decimal);
}
.one2mp ul:not(.one2mp .code-section ul) {
	list-style-type: var(--list-ul-style, disc);
}


.one2mp ol li,
.one2mp ul li:not(.one2mp .code-section ul li) {
	margin-bottom: var(--list-item-margin-bottom, 3px);
	line-height: var(--list-line-height, 1.6);
	padding-left: var(--list-padding-left);
}

.one2mp ul li ul {
  list-style-type: circle;
  padding-left: var(--list-padding-left);
}
`});var ys,vs=F(()=>{ys=`:root {
  --footnote-color:  #a0a0a0;
  --footnote-hover-color: #666;
  --footnote-font-size: 12px;
  --hr-color: #ccc;
  --hr-height: 1px;
  --hr-margin: 1em 0;
}

.one2mp hr {
	border-bottom: var(--hr-height, 1px) solid var(--hr-color, #eaeaea);
	border-bottom: none;
	border-left: none;
	border-right: none;
	margin-top: 20px;
	margin-bottom: 20px;
}

.one2mp .foot-links hr {
	margin-top: 2rem;
	margin-bottom: 0.5rem;
}

.one2mp .foot-links {
	font-size: var(--footnote-font-size, 12px);
	color: var(--footnote-color, #a0a0a0);
}

/* footnote */
.one2mp .footnote-id {
	color: var(--wechat-footnote-text-color, #999);
	margin-right: 0.5em;

}

.one2mp .footnote {
	font-size: 0.9em;
	font-weight: 300;
	margin-left: 0.5em;
}
`});var bs,ws=F(()=>{bs=`:root {
	--table-border-color: var(--one2mp-border-color, #454545);
	--table-border-width: var(--one2mp-border-width, 1px);
	--table-border-style: var(--one2mp-border-style, solid);
	--table-padding: var(--one2mp-padding, 16px);
	--table-margin: var(--one2mp-margin, 0);
	--table-background-color: var(--one2mp-bg, #fff);
	--table-background-color-alt: #eaeaea;
	--table-background-color-hover: var(--one2mp-bg-alt, #0d5c7e);
	--table-font-size: var(--one2mp-font-size, 16px);
	--table-font-weight: var(--one2mp-font-weight, 400);
	--table-line-height: var(--one2mp-line-height, 1.4);
	--table-text-align: var(--one2mp-text-align, left);
	--table-text-indent: var(--one2mp-text-indent, 0);
	--table-text-color: var(--one2mp-text-color, #333);
	--table-header-color: var(--one2mp-header-color, #333);
	--table-header-background-color: #b9b9b9;
	--table-header-font-weight: var(--one2mp-header-font-weight, 600);
	--table-header-line-height: var(--one2mp-header-line-height, 1.5);
	--table-header-text-align: var(--one2mp-header-text-align, left);
	--table-min-width: var(--one2mp-min-width, 100px);
	--table-container-overflow: auto;
	--tabble-radius: 0;
	--table-width: max-content;
	--tabble-white-space: nowrap;
	--table-layout: fixed;
	--table-collapse: collapse;
	--table-td-max-width: 200px;
	--table-td-min-width: 50px;
	--table-td-text-align: left;
	--table-td-word-break: break-word;
	--table-td-white-space: normal;
}

.one2mp .table-container {
	display: flex;
	width: 100%;
	overflow-x: var(--table-container-overflow);
	padding: 1px;
	box-shadow: 0 4px 8px var(--one2mp-shadow, (0, 0, 0, 0.1));
}

.one2mp table {
	border-collapse: var(--table-collapse);
	width: var(--table-width);
	border-color: var(--table-border-color);
	white-space: var(--tabble-white-space);
	table-layout: var(--table-layout);
}

.one2mp thead tr {
	background-color: var(--table-header-background-color);
	color: var(--table-header-color);
	text-align: var(--table-header-text-align);
	line-height: var(--table-header-line-height);
	font-weight: var(--table-header-font-weight);
}
 
.one2mp thead th {
	background-color: var(--table-header-background-color);
	color: var(--table-header-color);
}

/* table body text */
.one2mp tbody tr{
	line-height: var(--table-line-height, 1.5);
	text-align: var(--table-text-align, left);
	background-color: var(--table-background-color); 
	color: var(--table-text-color);
	font-size: var(--table-font-size);
	font-weight: var(--table-font-weight);
}
/* border */
.one2mp th,
.one2mp tr,
.one2mp td {
	border-color: var(--table-border-color);
	border-width: var(--table-border-width);
	border-style: solid;
	max-width: var(--table-td-max-width);
	min-width: var(--table-td-min-width);
	text-align: var(--table-td-text-align);
	word-break: var(--table-td-word-break);
	white-space: var(--table-td-white-space);
}

.one2mp td {
	background-color: var(--table-background-color);
	color: var(--table-text-color);
}

.one2mp tr:nth-child(even) {
	background-color: var(--table-background-color-alt);
	/* \u5076\u6570\u884C\u80CC\u666F\u8272 */;
}

.one2mp tr:nth-child(even) td {
	background-color: var(--table-background-color-alt);
}

.one2mp thead tr:first-child th:first-child {
	border-top-left-radius: var(--tabble-radius);
}
.one2mp thead tr:first-child th:last-child {
	border-top-right-radius: var(--tabble-radius);
}
.one2mp tbody tr:last-child td:first-child {
	border-bottom-left-radius: var(--tabble-radius);
}
.one2mp tbody tr:last-child td:last-child {
	border-bottom-right-radius: var(--tabble-radius);
}
`});var _s,xs=F(()=>{_s=`/* code section */

:root {
	--code-container-background-color: #282c34;
	/*#1E1E1E;*/
	--code-section-background-color: #282c34;
	--code-color: #abb2bf;
	--code-comment-color: #5c6370;
	--code-keyword-color: #c678dd;
	--code-name-color: #e06c75;
	--code-literal-color: #56b6c2;
	--code-string-color: #98c379;
	--code-variable-color: #d19a66;
	--code-symbol-color: #61aeee;
	--code-class-color: #e6c07b;
	--code-line-height: 1.6;
	--code-line-color: rgb(253, 247, 247);
	--code-font-size: 0.9rem;
	--code-padding: 8px;
	--code-border-radius: 6px;
	--code-banner-display: inline-block;
	--code-border-color: rgb(166, 166, 166);
	--code-border-width: 0.5px;
}

.one2mp code {
	display: inline;
	color: var(--code-color, rgb(153, 153, 153));
	line-height: var(--code-line-height, 1.6);
}

.one2mp .code-container {
	display: flex;
	flex-direction: column;
	border-radius: var(--code-border-radius, 4px);
	background: var(--code-container-background-color, #1E1E1E);
	box-shadow: rgba(0, 0, 0, 0.55) 0px 10px 10px -10px;
	border-width: var(--code-border-width);
	border-style: solid;
	border-color: var(--code-border-color);
}


.one2mp .code-section-banner {
	background-image: url('https://mmbiz.qpic.cn/mmbiz_svg/QAm7hEbaujTQuIH8VVl7W7PicH14grAZxd7oUx579CB2wpytwlLSpiaq2DXBpNUz8R6ckkAuO8tBLr52XjAsvR67mh3oibs2dYK/640?wx_fmt=svg&from=appmsg&tp=webp&wxfrom=15&wx_lazy=1');
	background-position: 10px 10px;
	background-size: 40px auto;
	background-repeat: no-repeat;
	display: var(--code-banner-display, inline-block);
	height: 32px;
	width: 100%;
	border-bottom: solid 0.5px var(--code-color, rgb(153, 153, 153));
}

.one2mp .code-section {
	display: flex;
	flex-grow: 1;
	font-size: var(--code-font-size, 0.9rem);
	line-height: var(--code-line-height, 1.6);
	border-radius: var(--code-border-radius, 4px);
}

.one2mp .code-section pre {
	position: relative;
	padding: 2px;
	margin: 0;
	flex: 1;
	overflow: auto;
	border-bottom-left-radius: var(--code-border-radius, 4px);
	border-bottom-right-radius: var(--code-border-radius, 4px);

}


.one2mp .code-section code {
	display: block;
	padding: 10px 5px !important;
	padding-left: .5em;
	font-family: Consolas, Monaco, Menlo, monospace;
	white-space: pre-wrap !important;
	word-wrap: break-word !important;
	overflow-x: auto;
}

.one2mp .code-section ul {
	padding-top: var(--code-padding, 8px);
	padding-bottom: var(--code-padding, 8px);
	position: relative;
	overflow: hidden;
	background: var(--code-section-background-color, #282c34) !important;
	display: flex;
	flex-direction: column;
	flex-shrink: 0;
	counter-reset: line;
	margin: 0;
	padding: 10px 0 0 0;
	white-space: normal;
	width: fit-content;
	user-select: none;
	border-right: solid 0.5px rgb(166, 166, 166);
	padding-right: 5px;
	color: var(--code-line-color, green);
	border-bottom-left-radius: var(--code-border-radius, 4px);
}

.one2mp .code-section ul>li {
	position: relative;
	margin: 0;
	display: list-item;
	text-align: right;
	text-wrap: nowrap;
	line-height: var(--code-line-height, 1.6);
	font-size: var(--code-font-size, 0.9rem);
	font-family: Menlo-Regular, Menlo, Monaco, Consolas, "Courier New", monospace;
	list-style-type: none;
	color: var(--code-line-color, red);
	padding-left: 1rem;

}

.one2mp .code-section ul>li::marker {
	content: none;
}

.one2mp pre code .hljs {
	display: block;
	overflow-x: auto;
	padding: 1em
}

.one2mp code .hljs {
	padding: 3px 5px
}

/*
  
  Atom One Dark by Daniel Gamage
  Original One Dark Syntax theme from https://github.com/atom/one-dark-syntax
  
  base:    #282c34
  mono-1:  #abb2bf
  mono-2:  #818896
  mono-3:  #5c6370
  hue-1:   #56b6c2
  hue-2:   #61aeee
  hue-3:   #c678dd
  hue-4:   #98c379
  hue-5:   #e06c75
  hue-5-2: #be5046
  hue-6:   #d19a66
  hue-6-2: #e6c07b
  
  */
.one2mp .hljs {
	color: var(--code-color, #abb2bf);
	background: var(--code-section-background-color, #282c34)
}

.one2mp .hljs-comment,
.one2mp .hljs-quote {
	color: var(--code-color, #5c6370);
	font-style: italic
}

.one2mp .hljs-doctag,
.one2mp .hljs-keyword,
.one2mp .hljs-formula {
	color: var(--code-keyword-color, #c678dd)
}

.one2mp .hljs-section,
.one2mp .hljs-name,
.one2mp .hljs-selector-tag,
.one2mp .hljs-deletion,
.one2mp .hljs-subst {
	color: var(--code-name-color, #e06c75)
}

.one2mp .hljs-literal {
	color: var(--code-literal-color, #56b6c2)
}

.one2mp .hljs-string,
.one2mp .hljs-regexp,
.one2mp .hljs-addition,
.one2mp .hljs-attribute,
.one2mp .hljs-meta .one2mp .hljs-string {
	color: var(--code-string-color, #98c379)
}

.one2mp .hljs-attr,
.one2mp .hljs-variable,
.one2mp .hljs-template-variable,
.one2mp .hljs-type,
.one2mp .hljs-selector-class,
.one2mp .hljs-selector-attr,
.one2mp .hljs-selector-pseudo,
.one2mp .hljs-number {
	color: var(--code-variable-color, #d19a66)
}

.one2mp .hljs-symbol,
.one2mp .hljs-bullet,
.one2mp .hljs-link,
.one2mp .hljs-meta,
.one2mp .hljs-selector-id,
.one2mp .hljs-title {
	color: var(--code-symbol-color, #61aeee)
}

.one2mp .hljs-built_in,
.one2mp .hljs-title.class_,
.one2mp .hljs-class .one2mp .hljs-title {
	color: var (--code-class-color, #e6c07b)
}

.one2mp .hljs-emphasis {
	font-style: italic
}

.one2mp .hljs-strong {
	font-weight: bold
}

.one2mp .hljs-link {
	text-decoration: underline
}`});var Ss,ks=F(()=>{Ss=`:root {
	--blockquote-color: rgba(0, 0, 0, 0.5);
	--blockquote-border-color:  var(--blockquote-color);
	--blockquote-border-width: 0px;
	--blockquote-border-style: solid;	
	--blockquote-border-radius: 4px;
	--blockquote-padding: 20px;
	--blockquote-margin: 0px;
	--blockquote-font-size: 1em;
	--blockquote-background-color: rgba(0, 0, 0, 0.05);
	--blockquote-inner-background-color: var(--blockquote-background-color);
	--blockquote-font-family: var(--article-font-family);
	--blockquote-font-style: italic;
}

.one2mp blockquote {
	border-left-width: var(--blockquote-border-width);
	border-left-style: var(--blockquote-border-style);
	border-left-color: var(--blockquote-border-color);
	border-radius: var(--blockquote-border-radius);
	padding: var(--blockquote-padding);
	margin: var(--blockquote-margin);
	color: var(--one2mp-secondary);	
	background-color: var(--blockquote-background-color);
	line-height: var(--one2mp-line-height);
	text-indent: 0;
	color: var(--blockquote-color);
	font-family: var(--blockquote-font-family);
	font-size: var(--blockquote-font-size);
	font-style: var(--blockquote-font-style);
}

.blockquote-inner {
  background: transparent;
  padding: 0px;
  transform: skew(0.0deg, 0.0deg); /* \u62B5\u6D88\u5916\u5C42\u503E\u659C\uFF0C\u8BA9\u5185\u5BB9\u4E0D\u6B6A */
}

/* .icon-pin {
  position: absolute;
  top: -12px;
  right: -12px;
  width: 24px;
  height: 24px;
  background-image: var(--icon-book);
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  pointer-events: none;
  visibility: visible
} */
`});var Es,Cs=F(()=>{Es=`:root{
	--link-color: var(--one2mp-secondary, rgb(0, 102, 204));
	--link-hover-color: var(--one2mp-primary-light, rgb(0, 128, 255));
	--link-active-color: var(--one2mp-primary, rgb(0, 128, 255));
}


.one2mp a {
	font-weight: 500;
	text-decoration: none;
	color: var(--link-color, rgb(0, 102, 204));
}

.one2mp a:hover,
.one2mp a:active {
	border-bottom: 1.5px solid var(--link-color, rgb(0, 102, 204));
	color: var(--link-hover-color, rgb(0, 128, 255));
}

.one2mp a:before {
	content: "\u21F2";
}
`});var As,Ts=F(()=>{As=`/* Callout Styles */

:root {
    --callout-background-color: rgba(8, 109, 221, 0.04);
	--callout-box-shadow: 0 8px 16px rgba(0, 0, 0, 0.16);
    --callout-border-color: rgba(8, 109, 221, 0.18);
	--callout-border-radius: var(--one2mp-border-radius, 4px);
	--callout-border-width: 0px;
    --callout-icon-color: rgba(8, 109, 221, 0.5);
    --callout-icon-size: 1.25em;
    --callout-icon-margin: 0.25em;
    --callout-text-color: var(--article-text-color, #333333);
	--cursor: pointer;
}

.one2mp-callout {
    overflow: hidden;
    border-style: solid;
    border-color: var(--callout-border-color, rgba(8, 109, 221, 0.25));
    border-width: var(--callout-border-width, 0px);
    border-radius: var(--callout-border-radius, 4px);
    margin: 1em 0;
    background-color: var(--callout-background-color, rgba(8, 109, 221, 0.1));
    padding: 12px 12px 12px 24px;
    opacity: 1;
    filter: none;
}

.one2mp-callout:not(.admonition).drop-shadow {
    box-shadow: var(--callout-box-shadow, 0 4px 8px  rgba(0, 0, 0, 0.2));
}

.one2mp-callout:not(.admonition) .no-title {
    display: none;
}


@supports selector(:has(*)) {

    :has(.one2mp-callout .callout-title .callout-title-inner:dir(rtl)),
    .one2mp-callout:has(> .callout-title .callout-title-inner:dir(rtl)) {
        direction: rtl;
    }

    :has(.one2mp-callout .callout-title .callout-title-inner:dir(rtl))>.callout-title,
    .one2mp-callout:has(> .callout-title .callout-title-inner:dir(rtl))>.callout-title {
        direction: rtl;
        --direction: -1;
    }

    :has(.one2mp-callout .callout-title .callout-title-inner:dir(rtl))>.callout-title .callout-icon svg.svg-icon,
    .one2mp-callout:has(> .callout-title .callout-title-inner:dir(rtl))>.callout-title .callout-icon svg.svg-icon {
        transform: scale(-1, 1);
    }
}

.one2mp-callout {
    background-color: var(--callout-background-color, rgba(8, 109, 221, 0.1));
    box-shadow: var(--callout-box-shadow, 0 4px 8px  rgba(0, 0, 0, 0.2));
}


.callout-icon {
    height: 1em;
}

.one2mp-callout[data-callout="summary"] {
    background-color: rgba(0, 191, 188, 0.04);
}
.one2mp-callout[data-callout="abstract"],
.one2mp-callout[data-callout="tldr"] {
    background-color: rgba(0, 176, 255, 0.04);
}

.one2mp-callout[data-callout="info"] {
    background-color: rgba(8, 109, 221, 0.04);
}

.one2mp-callout[data-callout="todo"] {
    background-color: rgba(8, 109, 221, 0.04);
}

.one2mp-callout[data-callout="important"] {
    background-color: rgba(8, 191, 188, 0.04);
}

.one2mp-callout[data-callout="tip"],
.one2mp-callout[data-callout="hint"] {
    background-color: rgba(8, 191, 188, 0.04);
}

.one2mp-callout[data-callout="success"],
.one2mp-callout[data-callout="check"],
.one2mp-callout[data-callout="done"] {
    background-color: rgba(8, 185, 78, 0.04);

}

.one2mp-callout[data-callout="question"],
.one2mp-callout[data-callout="help"],
.one2mp-callout[data-callout="faq"] {
    background-color: rgba(236, 117, 0, 0.04);
}

.one2mp-callout[data-callout="warning"],
.one2mp-callout[data-callout="caution"],
.one2mp-callout[data-callout="attention"] {
    background-color: rgba(236, 117, 0, 0.04);
}

.one2mp-callout[data-callout="failure"],
.one2mp-callout[data-callout="fail"],
.one2mp-callout[data-callout="missing"] {
    background-color: rgba(233, 49, 71, 0.04);
}

.one2mp-callout[data-callout="danger"],
.one2mp-callout[data-callout="error"] {
    background-color: rgba(233, 49, 71, 0.04);
}

.one2mp-callout[data-callout="bug"] {
    background-color: rgba(233, 49, 71, 0.04);
}

.one2mp-callout[data-callout="example"] {
    background-color: rgba(120, 82, 238, 0.04);
}

.one2mp-callout[data-callout="quote"],
.one2mp-callout[data-callout="cite"] {
    background-color: rgba(158, 158, 158, 0.04);
}

/* title start */
.one2mp-callout.is-collapsible  {
    cursor: var(--cursor);
}


.callout-title {
    padding: 0;
    display: flex;
    gap: 4px;
    font-size: inherit;
    line-height: 1.3;
    align-items: flex-start;
    color: rgb(8, 109, 221);
}


.one2mp-callout[data-callout="summary"] .callout-title  {
    color: rgb(0, 191, 188);
}
.one2mp-callout[data-callout="abstract"] .callout-title ,
.one2mp-callout[data-callout="tldr"] .callout-title {
    color: rgb(0, 176, 255);
}

.one2mp-callout[data-callout="info"] .callout-title {
    color: rgb(8, 109, 221);
}

.one2mp-callout[data-callout="todo"] .callout-title {
    color: rgb(8, 109, 221);
}

.one2mp-callout[data-callout="important"] .callout-title {
    color: rgb(8, 191, 188);
}

.one2mp-callout[data-callout="tip"] .callout-title ,
.one2mp-callout[data-callout="hint"] .callout-title {
    color: rgb(8, 191, 188);
}

.one2mp-callout[data-callout="success"] .callout-title ,
.one2mp-callout[data-callout="check"] .callout-title ,
.one2mp-callout[data-callout="done"] .callout-title {
    color: rgb(8, 185, 78);

}

.one2mp-callout[data-callout="question"] .callout-title ,
.one2mp-callout[data-callout="help"] .callout-title ,
.one2mp-callout[data-callout="faq"] .callout-title {
    color: rgb(236, 117, 0);
}

.one2mp-callout[data-callout="warning"] .callout-title ,
.one2mp-callout[data-callout="caution"] .callout-title ,
.one2mp-callout[data-callout="attention"] .callout-title {
    color: rgb(236, 117, 0);
}

.one2mp-callout[data-callout="failure"] .callout-title ,
.one2mp-callout[data-callout="fail"] .callout-title ,
.one2mp-callout[data-callout="missing"] .callout-title {
    color: rgb(233, 49, 71);
}

.one2mp-callout[data-callout="danger"]  .callout-title ,
.one2mp-callout[data-callout="error"] .callout-title {
    color: rgb(233, 49, 71);
}

.one2mp-callout[data-callout="bug"] .callout-title {
    color: rgb(233, 49, 71);
}

.one2mp-callout[data-callout="example"] .callout-title {
    color: rgb(120, 82, 238);
}

.one2mp-callout[data-callout="quote"] .callout-title ,
.one2mp-callout[data-callout="cite"]  .callout-title {
    color: rgb(158, 158, 158);
}

/* title end */
.callout-content {
    overflow-x: auto;
    padding: 0; 
    background-color: transparent;
    opacity: 1;
    filter: none;
}

.one2mp-callout .callout-content p,
.one2mp-callout .callout-content li,
.one2mp-callout .callout-content span,
.one2mp-callout .callout-content strong,
.one2mp-callout .callout-content em,
.one2mp-callout .callout-content a,
.one2mp-callout .callout-content code,
.one2mp-callout .callout-text {
    color: var(--callout-text-color, #333333);
    opacity: 1;
}

.one2mp-callout .callout-text {
    color: var(--article-text-color, #333333) !important;
    opacity: 1 !important;
}

.callout-content .one2mp-callout {
    margin-top: 20px;
}

.callout-icon {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
}



.callout-title-inner {
    font-weight: 600; 
    color: inherit; 
}

.callout-fold {
    display: flex;
    align-items: center;
    padding-inline-end: 8px; 
}


.callout-fold .svg-icon {
    transition: transform 100ms ease-in-out;
}

.callout-fold.is-collapsed .svg-icon {
    transform: rotate(-1 * -1 * 90deg);
}
`});var Ps,Is=F(()=>{Ps=`.admonition {
    margin-top: 1.5em;
    margin-bottom: 1.5em;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.admonition.no-title .admonition-content {
    margin-top: 0;
    margin-bottom: 0;
}

.admonition li.task-list-item.is-checked p {
    text-decoration: line-through;
}

.admonition.no-drop {
    box-shadow: none;
}

.admonition.no-drop>.admonition-title.no-title+.admonition-content,
.admonition.no-drop .admonition .admonition-title.no-title+.admonition-content {
    margin-top: 0;
    margin-bottom: 0;
}

.admonition.no-drop .admonition .admonition-content {
    border-right: .0625em solid rgba(233, 233,123, .2);
    border-bottom: .0625em solid rgba(233, 233,123, .2);
}

.admonition.no-drop .admonition .admonition-title.no-title+.admonition-content {
    border-top: .0625em solid rgba(233, 233,123, .2);
}

:is(.markdown-source-view.mod-cm6) .admonition .math-block>mjx-container,
:is(.markdown-reading-view) .admonition .math-block>mjx-container {
    display: block;
    text-align: center;
    padding: 1em;
}

:is(.markdown-reading-view) .admonition .math-block>mjx-container {
    padding: .0625em;
}

*:not(.is-live-preview) .admonition.no-content {
    display: none;
}

.admonition {
    margin-top: 0px;
    margin-bottom: .75em;
}

.admonition.no-content {
    opacity: .1;
}

.admonition-content p {
    line-height: inherit;
    margin: revert;
}

.admonition-content p br {
    display: initial;
}

.admonition-content p ul>li>ul {
    border-left: 2px;
    border-left-color: #ababab;
    border-left-style: solid;
}

.admonition-content:first-child {
    margin-top: .8em;
}

.admonition-content:last-child {
    margin-bottom: .8em;
}

.admonition-title.no-title {
    display: none;
}

.admonition-title:hover+.admonition-content .admonition-content-copy {
    opacity: .7;
}

.admonition-content,
.callout-content {
    position: relative;
}

.admonition-content-copy {
    color: #ababab;
    cursor: pointer;
    opacity: 0;
    position: absolute;
    margin: .375em;
    right: 0;
    top: 0;
    transition: .3s opacity ease-in;
}

.admonition-content-copy:hover {
    color: inherit;
}

.admonition:hover .admonition-content-copy,
.callout:hover .admonition-content-copy,
.admonition-content-copy:hover {
    opacity: 1;
}


.admonition-content ul,
.admonition-content ol {
    white-space: normal;
}

.admonition-title-icon,
.fa {
    height: 1.2em;
    width: 1.2em;
}
`});var Os,$s=F(()=>{Os=`.one2mp .inline-math{
    display: inline-block;
    padding: 0 0.5rem;
}

.one2mp .block-math {
    display: flex;
    width: 100%;
    overflow: auto;
    padding: 0.5rem;
}

.one2mp .block-math svg {
    width: fit-content;
    margin: auto;
}
`});var Ms,Ds=F(()=>{Ms=`.one2mp .mermaid {
    display: flex;
    flex-direction: column;
    padding: 0;
    border: none;
    border-radius: 0;
    background: transparent;
    box-shadow: none;
}

.one2mp .mermaid image {
    width: 100%;
    margin: auto;
}

.one2mp .mermaid img {
    border: none;
    border-radius: 0;
    box-shadow: none;
    display: block;
}
`});var Rs,Ls=F(()=>{Rs=`.one2mp .charts {
    display: flex;
    flex-direction: column;
    padding: 3px;
    border: solid 1px #ccc;
    border-radius: 3px;
}

.one2mp .charts image
 {
    width: 100%;
    margin: auto;
}
`});var Bs,Fs=F(()=>{Bs=`/* icon */

.obsidian-icon {
	font-size: inherit;
	display: inline-block;
	width: 1.8rem;
	text-align: center;
}

/* p .obsidian-icon {
	width: 1.75em
} */

.obsidian-icon.react-icon>svg {
	vertical-align: middle;
	margin-bottom: 3px;
}

.obsidian-icon.react-icon{
	width: 1.8rem;;
}
`});var Ns,qs=F(()=>{Ns=`/* summary */
.one2mp details {
	border: none;
	outline: none;
	/* border-left: 4px solid #3eaf7c; */
	padding-left: var(--wechat-collapse-padding, 1em);
	margin-left: var(--wechat-collapse-margin, 0);
	background-color: var(--wechat-collapse-bg-color, #f5f5f5);
}

.one2mp details summary {
	cursor: pointer;
	border: none;
	outline: none;
	margin: 0px -17px;
}

.one2mp details summary::-webkit-details-marker {
	color: var(--wechat-collapse-bg-color, #f5f5f5);
}
`});var zs,js=F(()=>{zs=`
    :root{
		--profile-background-color: #fafafa;
		--profile-title-color: #1f1f1f;
		--profile-description-color: #333;
		--profile-meta-color: #666;
		--profile-border-color: #eee;
		--profile-footer-color: #999;
		--profile-footer-bg-color: #fafafa;
		--profile-avatar-size: 64px;
		--profile-width: 600px;
		--profile-radius: 12px;
	}
	.one2mp-profile-card {
      background-color: var(--profile-background-color, #fff);
      border-radius: var(--profile-radius, 12px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
      overflow: hidden;
      width: var(--profile-width, 600px);
    }

    .one2mp-profile-card .card-main {
      display: flex;
      align-items: center;
      padding: 20px;
    }

    .one2mp-profile-card .avatar {
      width: var(--profile-avatar-size, 64px);
      height: var(--profile-avatar-size, 64px);
      border-radius: 50%;
      overflow: hidden;
      margin-right: 16px;
      flex-shrink: 0;
    }

    .one2mp-profile-card .avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .one2mp-profile-card .content {
      flex-grow: 1;
    }

    .one2mp-profile-card .title {
      font-size: 20px;
      font-weight: bold;
      color: var(--profile-title-color, #1f1f1f);
      margin-bottom: 6px;
    }

    .one2mp-profile-card .description {
      font-size: 16px;
      color: var(--profile-description-color, #555);
      margin-bottom: 8px;
    }

    .one2mp-profile-card .meta {
      font-size: 14px;
      color: var(--profile-meta-color, #888);
    }

    .one2mp-profile-card .arrow {
      font-size: 20px;
      color: #999;
      margin-left: 12px;
    }

    .one2mp-profile-card .card-footer {
      background-color: var(--profile-footer-bg-color, #f7f7f7);
      padding: 10px 20px;
      font-size: 14px;
      color: var(--profile-footer-color, #999);
      border-top: 1px solid var(--profile-border-color, #eee);
    }
`});var Hs,Us=F(()=>{Hs=`.one2mp-mpcard-wrapper {
  margin: 20px 20px;
  background-color: rgb(250, 250, 250);
  padding: 10px 20px;
  border-radius: 10px;
}

.one2mp-mpcard-content {
  display: flex;
  align-items: center;
}

.one2mp-mpcard-headimg {
  border: none !important;
  border-radius: 27px !important;
  box-shadow: none !important;
  width: 54px !important;
  height: 54px !important;
  margin: 0 !important;
}

.one2mp-mpcard-info {
  margin-left: 10px;
}

.one2mp-mpcard-nickname {
  font-size: 17px;
  font-weight: 500;
  color: rgba(0, 0, 0, 0.9);
}

.one2mp-mpcard-signature {
  font-size: 14px;
  color: rgba(0, 0, 0, 0.55);
}

.one2mp-mpcard-foot {
  margin-top: 20px;
  padding-top: 10px;
  border-top: 1px solid #ececec;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.3);
}
`});var Ws,Sf,Cf,Ef,rr,Vs=F(()=>{Mo();Ro();Bo();No();zo();Ho();Vo();Go();Qo();Yo();Xo();ts();rs();as();ss();cs();ds();hs();gs();vs();ws();xs();ks();Cs();Ts();Is();$s();Ds();Ls();Fs();qs();js();Us();Ws=require("obsidian");$e();Sf=[Lo,Fo,qo,jo,Uo,Wo,Ko,Jo,Zo,xi,es,ns,is,os,ls,us,fs,ps,ms,ys,bs,_s,Ss,Es,As,Ps,Os,Ms,Rs,Bs,xi,Ns,zs,Hs],Cf=["appmsg_","wx_","wx-","common-webchat","weui-"],Ef=r=>Cf.some(t=>r.startsWith(t)),rr=class{constructor(){this.vars=new Map;this.rules=new Map}async init(t){await this.buildBaseCSS();try{this.mergeCssText(t)}catch(e){new Ws.Notice(A("render.failed-to-parse-custom-css",[e])),console.error(e)}}async buildBaseCSS(){this.vars.clear(),this.rules.clear();for(let t of Sf)this.mergeCssText(t)}resolveCssVars(t,e,n=0){let a=/var\(\s*--([\w-]+)(?:\s*,\s*((?:\((?:[^()]|\([^()]*\))*\)|[^)\s]|[\s\S])*?))?\s*\)/g,o=t,s;do s=!1,o=o.replace(a,(l,c,u)=>{let d=`--${c}`;if(e.has(d)){let f=e.get(d);return s=!0,f}else return u!==void 0?(s=!0,u):(console.warn(`Variable ${d} not found and no fallback provided`),"")}),n++;while(s&&n<10);return o}mergeCssText(t){if(!t||!t.trim())return;let e=this.parseCssText(t);this.mergeVars(e.vars),this.mergeRules(e.rules)}mergeVars(t){for(let[e,n]of t.entries())this.vars.set(e,n)}mergeRules(t){for(let[e,n]of t.entries()){let i=this.rules.get(e);i||(i=new Map,this.rules.set(e,i));for(let[a,o]of n.entries()){let s=i.get(a);(s===void 0||!s.important||o.important)&&i.set(a,o)}}}parseCssText(t){let e=new Map,n=new Map,i=this.parseWithCssSheet(t);return i?(this.collectRulesFromList(i.cssRules,e,n),{vars:e,rules:n}):(this.parseWithFallback(t,e,n),{vars:e,rules:n})}parseWithCssSheet(t){if(typeof CSSStyleSheet=="undefined")return null;let e=new CSSStyleSheet;try{return e.replaceSync(t),e}catch(n){return console.debug("CSSStyleSheet \u89E3\u6790\u5931\u8D25",n),null}}collectRulesFromList(t,e,n){for(let i of Array.from(t))i.type===CSSRule.STYLE_RULE?this.collectStyleRule(i,e,n):"cssRules"in i&&this.collectRulesFromList(i.cssRules,e,n)}collectStyleRule(t,e,n){if(!t.selectorText)return;let i=t.selectorText.split(",").map(a=>a.trim()).filter(Boolean);if(i.length!==0)for(let a of i){if(a===":root"){this.collectVariables(t.style,e);continue}this.collectDeclarations(a,t.style,n)}}collectVariables(t,e){for(let n=0;n<t.length;n++){let i=t.item(n);if(!i||!i.startsWith("--"))continue;let a=t.getPropertyValue(i).trim();a&&e.set(i,a)}}collectDeclarations(t,e,n){let i=n.get(t);i||(i=new Map,n.set(t,i));for(let a=0;a<e.length;a++){let o=e.item(a);if(!o||o.startsWith("--"))continue;let s=e.getPropertyValue(o).trim();s&&i.set(o,{value:s,important:e.getPropertyPriority(o)==="important"})}}parseWithFallback(t,e,n){let i=t.replace(/\/\*[\s\S]*?\*\//g,""),a=/([^{@}]+)\{([^}]*)\}/g,o;for(;(o=a.exec(i))!==null;){let s=o[1].trim();if(!s||s.startsWith("@"))continue;let l=o[2],c=this.parseDeclarations(l),u=s.split(",").map(d=>d.trim()).filter(Boolean);for(let d of u){if(d===":root"){for(let[m,b]of c.entries())m.startsWith("--")&&e.set(m,b.value);continue}let f=n.get(d);f||(f=new Map,n.set(d,f));for(let[m,b]of c.entries())m.startsWith("--")||f.set(m,b)}}}parseDeclarations(t){let e=new Map,n=t.split(";");for(let i of n){let a=i.trim();if(!a)continue;let o=a.indexOf(":");if(o===-1)continue;let s=a.slice(0,o).trim();if(!s)continue;let l=a.slice(o+1).trim(),c=!1;l.endsWith("!important")&&(c=!0,l=l.replace(/!important$/i,"").trim()),l&&e.set(s,{value:l,important:c})}return e}normalizeSelector(t){let e=t.match(/::(before|after)/),n=e?e[1]:null;return{baseSelector:n?t.replace(/::(before|after)/g,""):t,pseudo:n}}ensurePseudoElement(t,e,n){let i=`data-one2mp-pseudo-${e}`,a=t.querySelector(`[${i}]`);return a||(a=document.createElement("span"),a.setAttribute(i,"true"),e==="before"?t.prepend(a):t.append(a)),n&&(a.textContent=n.replace(/(^")|("$)/g,"")),a}applyStyleToElement(t){this.rules.forEach((n,i)=>{let{baseSelector:a,pseudo:o}=this.normalizeSelector(i);try{if(t.matches(a)){let s=t;if(o){let l=n.get("content");s=this.ensurePseudoElement(t,o,l==null?void 0:l.value)}n.forEach((l,c)=>{if(c==="content")return;let u=this.resolveCssVars(l.value,this.vars);s.setCssProps({[c]:l.important?`${u} !important`:u})})}}catch(s){console.debug("error selector=>",i," | Error=>",s.message)}});let e=t.firstElementChild;for(;e;)this.applyStyleToElement(e),e=e.nextElementSibling;return t}removeClassName(t){let e=t.getAttribute("class");if(e){let i=e.split(" ");for(let a of i)Ef(a)||t.classList.remove(a)}t.removeAttribute("class");let n=t.firstElementChild;for(;n;)this.removeClassName(n),n=n.nextElementSibling}}});var ir={};ht(ir,{ThemeManager:()=>jt});var De,_i,jt,pn=F(()=>{De=require("obsidian");$e();nr();Vs();_i=class{constructor(t){this.cssMerger=null;this.cachedCssKey=null;this.themes=[];this.plugin=t}async downloadThemes(){var n;let t=["https://raw.githubusercontent.com/ryfineZ/O2Any/main/themes/","https://fastly.jsdelivr.net/gh/ryfineZ/O2Any@main/themes/","https://ghproxy.com/https://raw.githubusercontent.com/ryfineZ/O2Any/main/themes/","https://gitee.com/ryfineZ/O2Any/raw/main/themes/","https://raw.githubusercontent.com/ryfineZ/O2Any/master/themes/","https://fastly.jsdelivr.net/gh/ryfineZ/O2Any@master/themes/","https://ghproxy.com/https://raw.githubusercontent.com/ryfineZ/O2Any/master/themes/","https://gitee.com/ryfineZ/O2Any/raw/master/themes/"],e=this.normalizeThemeFolder(this.plugin.settings.css_styles_folder);this.plugin.app.vault.getAbstractFileByPath(e)||await this.plugin.app.vault.createFolder(e);try{let i="",a,o=null;for(let m of t)try{if(a=await(0,De.requestUrl)(`${m}themes.json`),a.status===200){i=m;break}o=new Error(a.text)}catch(b){o=b instanceof Error?b:new Error(String(b))}if(!a||a.status!==200||!i)throw new Error(A("views.theme-manager.failed-to-fetch-themes-json-themesrespon",[(n=o==null?void 0:o.message)!=null?n:"unknown"]));let l=a.json.themes,c=0,u=0,d=0,f=this.plugin.settings.themeDownloadOverwrite;for(let m of l)try{let b=encodeURIComponent(m.file),S=await(0,De.requestUrl)(`${i}${b}`);if(S.status!==200){console.warn(`Failed to download ${m.file}: ${S.text}`),u+=1;continue}let k=S.text,y=`${e}/${m.file}`,g=this.plugin.app.vault.getAbstractFileByPath(y);if(g){if(!f){d+=1;continue}if(g instanceof De.TFile){await this.plugin.app.vault.modify(g,k),c+=1;continue}u+=1;continue}await this.plugin.app.vault.create(y,k),c+=1}catch(b){console.error(b),u+=1,new De.Notice(A("views.theme-manager.error-downloading-theme")+b.message);continue}new De.Notice(A("views.theme-manager.download-summary",[String(c),String(u),String(d)]))}catch(i){console.error("Error downloading themes:",i),new De.Notice(A("views.theme-manager.error-downloading-themes"))}}static getInstance(t){return this.instance||(this.instance=new _i(t)),this.instance}static resetInstance(){this.instance=null}async loadThemes(){this.themes=[];let t=this.normalizeThemeFolder(this.plugin.settings.css_styles_folder),e=this.plugin.app.vault.getAbstractFileByPath(t);return e instanceof De.TFolder&&(this.themes=await this.getAllThemesInFolder(e)),this.themes}normalizeThemeFolder(t){let e=(t!=null?t:"").trim();return e||(e="one2mp-css-styles"),e=(0,De.normalizePath)(e),e.startsWith("/")&&(e=e.slice(1)),e}cleanCSS(t){t=t.replace(/```[cC][Ss]{2}\s*|\s*```/g,"").trim();let e=/\/\*[\s\S]*?\*\//g,n=/\/\/.*/g,i=/\s+/g,a=/[\u200B\u00AD\uFEFF\u00A0]/g;return t.replace(e,"").replace(n,"").replace(i," ").replace(a,"").trim()}async extractCSSblocks(t){let e=[],n=this.plugin.app.vault.getFileByPath(t);if(!n)return"";let i=this.plugin.app.metadataCache.getFileCache(n);if(!(i!=null&&i.sections))return"";let a=await this.plugin.app.vault.read(n);for(let o of i.sections)if(o.type==="code"){let s=a.substring(o.position.start.offset,o.position.end.offset);if(!/^```css/i.test(s))continue;let l=s.indexOf(`
`),c=s.lastIndexOf(`
`),u=s.substring(l+1,c).trim();e.push(u)}return e.join(`
`)}async getThemeContent(t){let e=this.plugin.app.vault.getFileByPath(t);if(!e)return"";let n=await this.plugin.app.vault.cachedRead(e),i=/```[cC][Ss]{2}\s*([\s\S]+?)\s*```/gs,a=[],o;for(;(o=i.exec(n))!==null;)a.push(this.cleanCSS(o[1].trim()));return console.debug("cssBlocks=>",a),a.join(`
`)}async getCSS(){let t="";return this.plugin.settings.custom_theme&&(t=await this.extractCSSblocks(this.plugin.settings.custom_theme)),t}getShadowStleSheet(){let t=new CSSStyleSheet;return t.replaceSync(`
  /* \u6EDA\u52A8\u6761\u6837\u5F0F we use shadow dom, make the preview looks better.*/
.table-container::-webkit-scrollbar {
	width: 8px;
	height: 8px;
	background-color: var(--scrollbar-bg);
}

.table-container::-webkit-scrollbar-thumb {
	background-color: var(--scrollbar-thumb-bg);
    -webkit-border-radius: var(--radius-l);
    background-clip: padding-box;
    border: 2px solid transparent;
    border-width: 3px 3px 3px 2px;
    min-height: 45px;
}
.table-container::-webkit-scrollbar-thumb:hover {
	background-color: var(--scrollbar-thumb-hover-bg);
}

.one2mp-article::-webkit-scrollbar-corner{
	background: transparent;
}

.one2mp-article pre::-webkit-scrollbar {
	width: 8px;
	height: 8px;
	background-color: var(--scrollbar-bg);
}

.one2mp-article pre::-webkit-scrollbar-thumb {
	background-color: var(--scrollbar-thumb-bg);
    -webkit-border-radius: var(--radius-l);
    background-clip: padding-box;
    border: 2px solid transparent;
    border-width: 3px 3px 3px 2px;
    min-height: 45px;
}

.one2mp-article pre::-webkit-scrollbar-thumb:hover {
	background-color: var(--scrollbar-thumb-hover-bg);
}

.one2mp-article::-webkit-scrollbar-corner{
	background: transparent;
}
`),t}async getAllThemesInFolder(t){let e=[],n=async i=>{let a=i.children.map(async o=>{if(o instanceof De.TFile&&o.extension==="md"){let s=await this.getThemeProperties(o);s&&e.push(s)}else o instanceof De.TFolder&&await n(o)});await Promise.all(a)};return await n(t),e}async getThemeProperties(t){let e=await this.plugin.app.vault.cachedRead(t),{data:n}=Nt(e),i=(n.theme_name||"").trim();if(i)return{name:i,path:t.path}}async applyTheme(t){var a;let e=await this.getCSS(),n=e;if((!this.cssMerger||this.cachedCssKey!==n)&&(this.cssMerger=new rr,await this.cssMerger.init(e),this.cachedCssKey=n),((a=t.dataset)==null?void 0:a.one2mpThemeKey)===n)return t;let i=this.cssMerger.applyStyleToElement(t);return i.dataset.one2mpThemeKey=n,i}},jt=_i;jt.instance=null});function zt(r,t){if(r===t)return!0;if(typeof r!="object"||r===null||typeof t!="object"||t===null)return!1;let e=Object.keys(r),n=Object.keys(t);if(e.length!==n.length)return!1;for(let i of e){let a=r,o=t;if(!n.includes(i)||!zt(a[i],o[i]))return!1}return!0}async function gn(r,t){if(!r)throw new Error(`Invalid URL: ${r}`);if(r.startsWith("data:"))return Tf(r);if(t&&r.startsWith("app://")){let e=r.slice(6),n=e.indexOf("/"),i=n>=0?e.slice(n+1):e;i=decodeURIComponent(i),i=i.split("?")[0].split("#")[0];let a=i.replace(/^\/+/,""),o=i.startsWith("/")?i:`/${i}`,s=t.vault.adapter;if(s instanceof Je.FileSystemAdapter){let c=s.getBasePath();if(o.startsWith(c)){let u=o.slice(c.length);(u.startsWith("/")||u.startsWith("\\"))&&(u=u.slice(1));let d=Ks(t,u);if(d instanceof Je.TFile){let f=await t.vault.readBinary(d);return new Blob([f])}}}let l=Ks(t,a);if(l instanceof Je.TFile){let c=await t.vault.readBinary(l);return new Blob([c])}throw new Error(`Image not found in vault: ${i}`)}try{let e=await(0,Je.requestUrl)(r);if(!e.arrayBuffer)throw new Error(`Failed to fetch image from ${r}`);return new Blob([e.arrayBuffer])}catch(e){let n=e instanceof Error?e.message:String(e);throw new Error(`Error fetching image from ${r}: ${n}`)}}function Tf(r){let[t,e]=r.split(","),n=t.match(/data:(.*?);base64/),i=n?n[1]:"application/octet-stream",a=atob(e),o=new Uint8Array(a.length);for(let s=0;s<a.length;s+=1)o[s]=a.charCodeAt(s);return new Blob([o],{type:i})}function Gs(r){return r.outerHTML.replaceAll(/<div /g,"<section ").replaceAll(/<\/div>/g,"</section>")}var Je,Ks,Ut=F(()=>{Je=require("obsidian");Ks=(r,t)=>{var u,d,f,m,b,S,k,y;let e=r.vault,n=r.workspace.getActiveFile(),i=e.config,a=(u=i==null?void 0:i.attachmentFolderPath)!=null?u:"",o=t.trim();if(!o)return null;o=o.split("|")[0].split("?")[0].split("#")[0],(o.startsWith("/")||o.startsWith("\\"))&&(o=o.slice(1));let s=e.getAbstractFileByPath(o);if(s instanceof Je.TFile)return s;let l=r.metadataCache.getFirstLinkpathDest(o,(d=n==null?void 0:n.path)!=null?d:"");if(l instanceof Je.TFile)return l;if((f=n==null?void 0:n.parent)!=null&&f.path){let g=`${n.parent.path}/${o}`,h=e.getAbstractFileByPath(g);if(h instanceof Je.TFile)return h}let c=o.split("/").pop()||o;if(a){let g=[];if(a.startsWith("./")){let h=a.slice(2);g.push(`${(b=(m=n==null?void 0:n.parent)==null?void 0:m.path)!=null?b:""}/${h}/${c}`),g.push(`${(k=(S=n==null?void 0:n.parent)==null?void 0:S.path)!=null?k:""}/${h}/${o}`)}else g.push(`${a}/${c}`),g.push(`${a}/${o}`),(y=n==null?void 0:n.parent)!=null&&y.path&&(g.push(`${n.parent.path}/${a}/${c}`),g.push(`${n.parent.path}/${a}/${o}`));for(let h of g){let p=e.getAbstractFileByPath(h);if(p instanceof Je.TFile)return p}}return null}});var ki=uo((Js,Qs)=>{(function(r){if(typeof Js=="object")Qs.exports=r();else if(typeof define=="function"&&define.amd)define(r);else{var t;try{t=window}catch(e){t=self}t.SparkMD5=r()}})(function(r){"use strict";var t=function(y,g){return y+g&4294967295},e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(y,g,h,p,w,_){return g=t(t(g,y),t(p,_)),t(g<<w|g>>>32-w,h)}function i(y,g){var h=y[0],p=y[1],w=y[2],_=y[3];h+=(p&w|~p&_)+g[0]-680876936|0,h=(h<<7|h>>>25)+p|0,_+=(h&p|~h&w)+g[1]-389564586|0,_=(_<<12|_>>>20)+h|0,w+=(_&h|~_&p)+g[2]+606105819|0,w=(w<<17|w>>>15)+_|0,p+=(w&_|~w&h)+g[3]-1044525330|0,p=(p<<22|p>>>10)+w|0,h+=(p&w|~p&_)+g[4]-176418897|0,h=(h<<7|h>>>25)+p|0,_+=(h&p|~h&w)+g[5]+1200080426|0,_=(_<<12|_>>>20)+h|0,w+=(_&h|~_&p)+g[6]-1473231341|0,w=(w<<17|w>>>15)+_|0,p+=(w&_|~w&h)+g[7]-45705983|0,p=(p<<22|p>>>10)+w|0,h+=(p&w|~p&_)+g[8]+1770035416|0,h=(h<<7|h>>>25)+p|0,_+=(h&p|~h&w)+g[9]-1958414417|0,_=(_<<12|_>>>20)+h|0,w+=(_&h|~_&p)+g[10]-42063|0,w=(w<<17|w>>>15)+_|0,p+=(w&_|~w&h)+g[11]-1990404162|0,p=(p<<22|p>>>10)+w|0,h+=(p&w|~p&_)+g[12]+1804603682|0,h=(h<<7|h>>>25)+p|0,_+=(h&p|~h&w)+g[13]-40341101|0,_=(_<<12|_>>>20)+h|0,w+=(_&h|~_&p)+g[14]-1502002290|0,w=(w<<17|w>>>15)+_|0,p+=(w&_|~w&h)+g[15]+1236535329|0,p=(p<<22|p>>>10)+w|0,h+=(p&_|w&~_)+g[1]-165796510|0,h=(h<<5|h>>>27)+p|0,_+=(h&w|p&~w)+g[6]-1069501632|0,_=(_<<9|_>>>23)+h|0,w+=(_&p|h&~p)+g[11]+643717713|0,w=(w<<14|w>>>18)+_|0,p+=(w&h|_&~h)+g[0]-373897302|0,p=(p<<20|p>>>12)+w|0,h+=(p&_|w&~_)+g[5]-701558691|0,h=(h<<5|h>>>27)+p|0,_+=(h&w|p&~w)+g[10]+38016083|0,_=(_<<9|_>>>23)+h|0,w+=(_&p|h&~p)+g[15]-660478335|0,w=(w<<14|w>>>18)+_|0,p+=(w&h|_&~h)+g[4]-405537848|0,p=(p<<20|p>>>12)+w|0,h+=(p&_|w&~_)+g[9]+568446438|0,h=(h<<5|h>>>27)+p|0,_+=(h&w|p&~w)+g[14]-1019803690|0,_=(_<<9|_>>>23)+h|0,w+=(_&p|h&~p)+g[3]-187363961|0,w=(w<<14|w>>>18)+_|0,p+=(w&h|_&~h)+g[8]+1163531501|0,p=(p<<20|p>>>12)+w|0,h+=(p&_|w&~_)+g[13]-1444681467|0,h=(h<<5|h>>>27)+p|0,_+=(h&w|p&~w)+g[2]-51403784|0,_=(_<<9|_>>>23)+h|0,w+=(_&p|h&~p)+g[7]+1735328473|0,w=(w<<14|w>>>18)+_|0,p+=(w&h|_&~h)+g[12]-1926607734|0,p=(p<<20|p>>>12)+w|0,h+=(p^w^_)+g[5]-378558|0,h=(h<<4|h>>>28)+p|0,_+=(h^p^w)+g[8]-2022574463|0,_=(_<<11|_>>>21)+h|0,w+=(_^h^p)+g[11]+1839030562|0,w=(w<<16|w>>>16)+_|0,p+=(w^_^h)+g[14]-35309556|0,p=(p<<23|p>>>9)+w|0,h+=(p^w^_)+g[1]-1530992060|0,h=(h<<4|h>>>28)+p|0,_+=(h^p^w)+g[4]+1272893353|0,_=(_<<11|_>>>21)+h|0,w+=(_^h^p)+g[7]-155497632|0,w=(w<<16|w>>>16)+_|0,p+=(w^_^h)+g[10]-1094730640|0,p=(p<<23|p>>>9)+w|0,h+=(p^w^_)+g[13]+681279174|0,h=(h<<4|h>>>28)+p|0,_+=(h^p^w)+g[0]-358537222|0,_=(_<<11|_>>>21)+h|0,w+=(_^h^p)+g[3]-722521979|0,w=(w<<16|w>>>16)+_|0,p+=(w^_^h)+g[6]+76029189|0,p=(p<<23|p>>>9)+w|0,h+=(p^w^_)+g[9]-640364487|0,h=(h<<4|h>>>28)+p|0,_+=(h^p^w)+g[12]-421815835|0,_=(_<<11|_>>>21)+h|0,w+=(_^h^p)+g[15]+530742520|0,w=(w<<16|w>>>16)+_|0,p+=(w^_^h)+g[2]-995338651|0,p=(p<<23|p>>>9)+w|0,h+=(w^(p|~_))+g[0]-198630844|0,h=(h<<6|h>>>26)+p|0,_+=(p^(h|~w))+g[7]+1126891415|0,_=(_<<10|_>>>22)+h|0,w+=(h^(_|~p))+g[14]-1416354905|0,w=(w<<15|w>>>17)+_|0,p+=(_^(w|~h))+g[5]-57434055|0,p=(p<<21|p>>>11)+w|0,h+=(w^(p|~_))+g[12]+1700485571|0,h=(h<<6|h>>>26)+p|0,_+=(p^(h|~w))+g[3]-1894986606|0,_=(_<<10|_>>>22)+h|0,w+=(h^(_|~p))+g[10]-1051523|0,w=(w<<15|w>>>17)+_|0,p+=(_^(w|~h))+g[1]-2054922799|0,p=(p<<21|p>>>11)+w|0,h+=(w^(p|~_))+g[8]+1873313359|0,h=(h<<6|h>>>26)+p|0,_+=(p^(h|~w))+g[15]-30611744|0,_=(_<<10|_>>>22)+h|0,w+=(h^(_|~p))+g[6]-1560198380|0,w=(w<<15|w>>>17)+_|0,p+=(_^(w|~h))+g[13]+1309151649|0,p=(p<<21|p>>>11)+w|0,h+=(w^(p|~_))+g[4]-145523070|0,h=(h<<6|h>>>26)+p|0,_+=(p^(h|~w))+g[11]-1120210379|0,_=(_<<10|_>>>22)+h|0,w+=(h^(_|~p))+g[2]+718787259|0,w=(w<<15|w>>>17)+_|0,p+=(_^(w|~h))+g[9]-343485551|0,p=(p<<21|p>>>11)+w|0,y[0]=h+y[0]|0,y[1]=p+y[1]|0,y[2]=w+y[2]|0,y[3]=_+y[3]|0}function a(y){var g=[],h;for(h=0;h<64;h+=4)g[h>>2]=y.charCodeAt(h)+(y.charCodeAt(h+1)<<8)+(y.charCodeAt(h+2)<<16)+(y.charCodeAt(h+3)<<24);return g}function o(y){var g=[],h;for(h=0;h<64;h+=4)g[h>>2]=y[h]+(y[h+1]<<8)+(y[h+2]<<16)+(y[h+3]<<24);return g}function s(y){var g=y.length,h=[1732584193,-271733879,-1732584194,271733878],p,w,_,O,M,D;for(p=64;p<=g;p+=64)i(h,a(y.substring(p-64,p)));for(y=y.substring(p-64),w=y.length,_=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=0;p<w;p+=1)_[p>>2]|=y.charCodeAt(p)<<(p%4<<3);if(_[p>>2]|=128<<(p%4<<3),p>55)for(i(h,_),p=0;p<16;p+=1)_[p]=0;return O=g*8,O=O.toString(16).match(/(.*?)(.{0,8})$/),M=parseInt(O[2],16),D=parseInt(O[1],16)||0,_[14]=M,_[15]=D,i(h,_),h}function l(y){var g=y.length,h=[1732584193,-271733879,-1732584194,271733878],p,w,_,O,M,D;for(p=64;p<=g;p+=64)i(h,o(y.subarray(p-64,p)));for(y=p-64<g?y.subarray(p-64):new Uint8Array(0),w=y.length,_=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=0;p<w;p+=1)_[p>>2]|=y[p]<<(p%4<<3);if(_[p>>2]|=128<<(p%4<<3),p>55)for(i(h,_),p=0;p<16;p+=1)_[p]=0;return O=g*8,O=O.toString(16).match(/(.*?)(.{0,8})$/),M=parseInt(O[2],16),D=parseInt(O[1],16)||0,_[14]=M,_[15]=D,i(h,_),h}function c(y){var g="",h;for(h=0;h<4;h+=1)g+=e[y>>h*8+4&15]+e[y>>h*8&15];return g}function u(y){var g;for(g=0;g<y.length;g+=1)y[g]=c(y[g]);return y.join("")}u(s("hello"))!=="5d41402abc4b2a76b9719d911017c592"&&(t=function(y,g){var h=(y&65535)+(g&65535),p=(y>>16)+(g>>16)+(h>>16);return p<<16|h&65535}),typeof ArrayBuffer!="undefined"&&!ArrayBuffer.prototype.slice&&function(){function y(g,h){return g=g|0||0,g<0?Math.max(g+h,0):Math.min(g,h)}ArrayBuffer.prototype.slice=function(g,h){var p=this.byteLength,w=y(g,p),_=p,O,M,D,z;return h!==r&&(_=y(h,p)),w>_?new ArrayBuffer(0):(O=_-w,M=new ArrayBuffer(O),D=new Uint8Array(M),z=new Uint8Array(this,w,O),D.set(z),M)}}();function d(y){return/[\u0080-\uFFFF]/.test(y)&&(y=unescape(encodeURIComponent(y))),y}function f(y,g){var h=y.length,p=new ArrayBuffer(h),w=new Uint8Array(p),_;for(_=0;_<h;_+=1)w[_]=y.charCodeAt(_);return g?w:p}function m(y){return String.fromCharCode.apply(null,new Uint8Array(y))}function b(y,g,h){var p=new Uint8Array(y.byteLength+g.byteLength);return p.set(new Uint8Array(y)),p.set(new Uint8Array(g),y.byteLength),h?p:p.buffer}function S(y){var g=[],h=y.length,p;for(p=0;p<h-1;p+=2)g.push(parseInt(y.substr(p,2),16));return String.fromCharCode.apply(String,g)}function k(){this.reset()}return k.prototype.append=function(y){return this.appendBinary(d(y)),this},k.prototype.appendBinary=function(y){this._buff+=y,this._length+=y.length;var g=this._buff.length,h;for(h=64;h<=g;h+=64)i(this._hash,a(this._buff.substring(h-64,h)));return this._buff=this._buff.substring(h-64),this},k.prototype.end=function(y){var g=this._buff,h=g.length,p,w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_;for(p=0;p<h;p+=1)w[p>>2]|=g.charCodeAt(p)<<(p%4<<3);return this._finish(w,h),_=u(this._hash),y&&(_=S(_)),this.reset(),_},k.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},k.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},k.prototype.setState=function(y){return this._buff=y.buff,this._length=y.length,this._hash=y.hash,this},k.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},k.prototype._finish=function(y,g){var h=g,p,w,_;if(y[h>>2]|=128<<(h%4<<3),h>55)for(i(this._hash,y),h=0;h<16;h+=1)y[h]=0;p=this._length*8,p=p.toString(16).match(/(.*?)(.{0,8})$/),w=parseInt(p[2],16),_=parseInt(p[1],16)||0,y[14]=w,y[15]=_,i(this._hash,y)},k.hash=function(y,g){return k.hashBinary(d(y),g)},k.hashBinary=function(y,g){var h=s(y),p=u(h);return g?S(p):p},k.ArrayBuffer=function(){this.reset()},k.ArrayBuffer.prototype.append=function(y){var g=b(this._buff.buffer,y,!0),h=g.length,p;for(this._length+=y.byteLength,p=64;p<=h;p+=64)i(this._hash,o(g.subarray(p-64,p)));return this._buff=p-64<h?new Uint8Array(g.buffer.slice(p-64)):new Uint8Array(0),this},k.ArrayBuffer.prototype.end=function(y){var g=this._buff,h=g.length,p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],w,_;for(w=0;w<h;w+=1)p[w>>2]|=g[w]<<(w%4<<3);return this._finish(p,h),_=u(this._hash),y&&(_=S(_)),this.reset(),_},k.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},k.ArrayBuffer.prototype.getState=function(){var y=k.prototype.getState.call(this);return y.buff=m(y.buff),y},k.ArrayBuffer.prototype.setState=function(y){return y.buff=f(y.buff,!0),k.prototype.setState.call(this,y)},k.ArrayBuffer.prototype.destroy=k.prototype.destroy,k.ArrayBuffer.prototype._finish=k.prototype._finish,k.ArrayBuffer.hash=function(y,g){var h=l(new Uint8Array(y)),p=u(h);return g?S(p):p},k})});function Si(){if(!or&&(or=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!or))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return or(Af)}var or,Af,Zs=F(()=>{Af=new Uint8Array(16)});var Ys,Xs=F(()=>{Ys=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i});function If(r){return typeof r=="string"&&Ys.test(r)}var el,tl=F(()=>{Xs();el=If});function Pf(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=(Ae[r[t+0]]+Ae[r[t+1]]+Ae[r[t+2]]+Ae[r[t+3]]+"-"+Ae[r[t+4]]+Ae[r[t+5]]+"-"+Ae[r[t+6]]+Ae[r[t+7]]+"-"+Ae[r[t+8]]+Ae[r[t+9]]+"-"+Ae[r[t+10]]+Ae[r[t+11]]+Ae[r[t+12]]+Ae[r[t+13]]+Ae[r[t+14]]+Ae[r[t+15]]).toLowerCase();if(!el(e))throw TypeError("Stringified UUID is invalid");return e}var Ae,sr,nl,rl=F(()=>{tl();Ae=[];for(sr=0;sr<256;++sr)Ae.push((sr+256).toString(16).substr(1));nl=Pf});function $f(r,t,e){r=r||{};var n=r.random||(r.rng||Si)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){e=e||0;for(var i=0;i<16;++i)t[e+i]=n[i];return t}return nl(n)}var mn,il=F(()=>{Zs();rl();mn=$f});var al=F(()=>{il()});var ol=uo(Ci=>{"use strict";Ci.stringify=function(t){var e=[];e.push({obj:t});for(var n="",i,a,o,s,l,c,u,d,f,m,b;i=e.pop();)if(a=i.obj,o=i.prefix||"",s=i.val||"",n+=o,s)n+=s;else if(typeof a!="object")n+=typeof a=="undefined"?null:JSON.stringify(a);else if(a===null)n+="null";else if(Array.isArray(a)){for(e.push({val:"]"}),l=a.length-1;l>=0;l--)c=l===0?"":",",e.push({obj:a[l],prefix:c});e.push({val:"["})}else{u=[];for(d in a)a.hasOwnProperty(d)&&u.push(d);for(e.push({val:"}"}),l=u.length-1;l>=0;l--)f=u[l],m=a[f],b=l>0?",":"",b+=JSON.stringify(f)+":",e.push({obj:m,prefix:b});e.push({val:"{"})}return n};function Ht(r,t,e){var n=e[e.length-1];r===n.element&&(e.pop(),n=e[e.length-1]);var i=n.element,a=n.index;if(Array.isArray(i))i.push(r);else if(a===t.length-2){var o=t.pop();i[o]=r}else t.push(r)}Ci.parse=function(r){for(var t=[],e=[],n=0,i,a,o,s,l,c,u,d,f;;){if(i=r[n++],i==="}"||i==="]"||typeof i=="undefined"){if(t.length===1)return t.pop();Ht(t.pop(),t,e);continue}switch(i){case" ":case"	":case`
`:case":":case",":break;case"n":n+=3,Ht(null,t,e);break;case"t":n+=3,Ht(!0,t,e);break;case"f":n+=4,Ht(!1,t,e);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(a="",n--;;)if(o=r[n++],/[\d\.\-e\+]/.test(o))a+=o;else{n--;break}Ht(parseFloat(a),t,e);break;case'"':for(s="",l=void 0,c=0;u=r[n++],u!=='"'||l==="\\"&&c%2===1;)s+=u,l=u,l==="\\"?c++:c=0;Ht(JSON.parse('"'+s+'"'),t,e);break;case"[":d={element:[],index:t.length},t.push(d.element),e.push(d);break;case"{":f={element:{},index:t.length},t.push(f.element),e.push(f);break;default:throw new Error("unexpectedly reached end of input: "+i)}}}});var _a={};ht(_a,{default:()=>wg});function Of(r){return typeof ArrayBuffer!="undefined"&&r instanceof ArrayBuffer||typeof Blob!="undefined"&&r instanceof Blob}function Df(r){return r instanceof ArrayBuffer?r.slice(0):r.slice(0,r.size,r.type)}function Lf(r){var t=Object.getPrototypeOf(r);if(t===null)return!0;var e=t.constructor;return typeof e=="function"&&e instanceof e&&Ml.call(e)==Mf}function Ce(r){var t,e,n;if(!r||typeof r!="object")return r;if(Array.isArray(r)){for(t=[],e=0,n=r.length;e<n;e++)t[e]=Ce(r[e]);return t}if(r instanceof Date&&isFinite(r))return r.toISOString();if(Of(r))return Df(r);if(!Lf(r))return r;t={};for(e in r)if(Object.prototype.hasOwnProperty.call(r,e)){var i=Ce(r[e]);typeof i!="undefined"&&(t[e]=i)}return t}function Ll(r){var t=!1;return function(...e){if(t)throw new Error("once called more than once");t=!0,r.apply(this,e)}}function Rl(r){return function(...t){t=Ce(t);var e=this,n=typeof t[t.length-1]=="function"?t.pop():!1,i=new Promise(function(a,o){var s;try{var l=Ll(function(c,u){c?o(c):a(u)});t.push(l),s=r.apply(e,t),s&&typeof s.then=="function"&&a(s)}catch(c){o(c)}});return n&&i.then(function(a){n(null,a)},n),i}}function Rf(r,t,e){if(r.constructor.listeners("debug").length){for(var n=["api",r.name,t],i=0;i<e.length-1;i++)n.push(e[i]);r.constructor.emit("debug",n);var a=e[e.length-1];e[e.length-1]=function(o,s){var l=["api",r.name,t];l=l.concat(o?["error",o]:["success",s]),r.constructor.emit("debug",l),a(o,s)}}}function ye(r,t){return Rl(function(...e){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var n=this;return Rf(n,r,e),this.taskqueue.isReady?t.apply(this,e):new Promise(function(i,a){n.taskqueue.addTask(function(o){o?a(o):i(n[r].apply(n,e))})})})}function xn(r,t){for(var e={},n=0,i=t.length;n<i;n++){var a=t[n];a in r&&(e[a]=r[a])}return e}function sl(r){return r}function Bf(r){return[{ok:r}]}function Fl(r,t,e){var n=t.docs,i=new Map;n.forEach(function(S){i.has(S.id)?i.get(S.id).push(S):i.set(S.id,[S])});var a=i.size,o=0,s=new Array(a);function l(){var S=[];s.forEach(function(k){k.docs.forEach(function(y){S.push({id:k.id,docs:[y]})})}),e(null,{results:S})}function c(){++o===a&&l()}function u(S,k,y){s[S]={id:k,docs:y},c()}var d=[];i.forEach(function(S,k){d.push(k)});var f=0;function m(){if(!(f>=d.length)){var S=Math.min(f+Ff,d.length),k=d.slice(f,S);b(k,f),f+=k.length}}function b(S,k){S.forEach(function(y,g){var h=k+g,p=i.get(y),w=xn(p[0],["atts_since","attachments"]);w.open_revs=p.map(function(O){return O.rev}),w.open_revs=w.open_revs.filter(sl);var _=sl;w.open_revs.length===0&&(delete w.open_revs,_=Bf),["revs","attachments","binary","ajax","latest"].forEach(function(O){O in t&&(w[O]=t[O])}),r.get(y,w,function(O,M){var D;O?D=[{error:O}]:D=_(M),u(h,y,D),m()})})}m()}function hr(){return qi}function He(r){if(typeof console!="undefined"&&typeof console[r]=="function"){var t=Array.prototype.slice.call(arguments,1);console[r].apply(console,t)}}function qf(r,t){var e=6e5;r=parseInt(r,10)||0,t=parseInt(t,10),t!==t||t<=r?t=(r||1)<<1:t=t+1,t>e&&(r=e>>1,t=e);var n=Math.random(),i=t-r;return~~(i*n+r)}function Nf(r){var t=0;return r||(t=2e3),qf(r,t)}function ji(r,t){He("info","The above "+r+" is totally normal. "+t)}function ee(r,t){function e(n){for(var i=Object.getOwnPropertyNames(r),a=0,o=i.length;a<o;a++)typeof r[i[a]]!="function"&&(this[i[a]]=r[i[a]]);this.stack===void 0&&(this.stack=new Error().stack),n!==void 0&&(this.reason=n)}return e.prototype=fe.prototype,new e(t)}function Jt(r){if(typeof r!="object"){var t=r;r=la,r.data=t}return"error"in r&&r.error==="conflict"&&(r.name="conflict",r.status=409),"name"in r||(r.name=r.error||"unknown"),"status"in r||(r.status=500),"message"in r||(r.message=r.message||r.reason),"stack"in r||(r.stack=new Error().stack),r}function Vf(r,t,e){try{return!r(t,e)}catch(i){var n="Filter function threw: "+i.toString();return ee(xr,n)}}function ua(r){var t={},e=r.filter&&typeof r.filter=="function";return t.query=r.query_params,function(i){i.doc||(i.doc={});var a=e&&Vf(r.filter,i.doc,t);if(typeof a=="object")return a;if(a)return!1;if(!r.include_docs)delete i.doc;else if(!r.attachments)for(var o in i.doc._attachments)Object.prototype.hasOwnProperty.call(i.doc._attachments,o)&&(i.doc._attachments[o].stub=!0);return!0}}function Nl(r){var t;if(r?typeof r!="string"?t=ee(Bl):/^_/.test(r)&&!/^_(design|local)/.test(r)&&(t=ee(Uf)):t=ee(zf),t)throw t}function rt(r){return typeof r._remote=="boolean"?r._remote:typeof r.type=="function"?(He("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),r.type()==="http"):!1}function Kf(r,t){return"listenerCount"in r?r.listenerCount(t):it.default.listenerCount(r,t)}function zi(r){if(!r)return null;var t=r.split("/");return t.length===2?t:t.length===1?[r,r]:null}function cl(r){var t=zi(r);return t?t.join("/"):null}function jl(r){for(var t=Jf.exec(r),e={},n=14;n--;){var i=ul[n],a=t[n]||"",o=["user","password"].indexOf(i)!==-1;e[i]=o?decodeURIComponent(a):a}return e[dl]={},e[ul[12]].replace(Gf,function(s,l,c){l&&(e[dl][l]=c)}),e}function da(r,t){var e=[],n=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e.push(i),n.push(t[i]));return e.push(r),Function.apply(null,e).apply(null,n)}function pr(r,t,e){return r.get(t).catch(function(n){if(n.status!==404)throw n;return{}}).then(function(n){var i=n._rev,a=e(n);return a?(a._id=t,a._rev=i,Qf(r,a,e)):{updated:!1,rev:i}})}function Qf(r,t,e){return r.put(t).then(function(n){return{updated:!0,rev:n.rev}},function(n){if(n.status!==409)throw n;return pr(r,t._id,e)})}function ha(r,t){r=r||[],t=t||{};try{return new Blob(r,t)}catch(a){if(a.name!=="TypeError")throw a;for(var e=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,n=new e,i=0;i<r.length;i+=1)n.append(r[i]);return n.getBlob(t.type)}}function Zf(r){for(var t=r.length,e=new ArrayBuffer(t),n=new Uint8Array(e),i=0;i<t;i++)n[i]=r.charCodeAt(i);return e}function pa(r,t){return ha([Zf(r)],{type:t})}function ga(r,t){return pa(fa(r),t)}function Yf(r){for(var t="",e=new Uint8Array(r),n=e.byteLength,i=0;i<n;i++)t+=String.fromCharCode(e[i]);return t}function zl(r,t){var e=new FileReader,n=typeof e.readAsBinaryString=="function";e.onloadend=function(i){var a=i.target.result||"";if(n)return t(a);t(Yf(a))},n?e.readAsBinaryString(r):e.readAsArrayBuffer(r)}function Ul(r,t){zl(r,function(e){t(e)})}function ma(r,t){Ul(r,function(e){t(_n(e))})}function Xf(r,t){var e=new FileReader;e.onloadend=function(n){var i=n.target.result||new ArrayBuffer(0);t(i)},e.readAsArrayBuffer(r)}function nh(r){return _n(r)}function rh(r,t,e,n,i){(e>0||n<t.size)&&(t=t.slice(e,n)),Xf(t,function(a){r.append(a),i()})}function ih(r,t,e,n,i){(e>0||n<t.length)&&(t=t.substring(e,n)),r.appendBinary(t),i()}function va(r,t){var e=typeof r=="string",n=e?r.length:r.size,i=Math.min(th,n),a=Math.ceil(n/i),o=0,s=e?new fr.default:new fr.default.ArrayBuffer,l=e?ih:rh;function c(){eh(d)}function u(){var f=s.end(!0),m=nh(f);t(m),s.destroy()}function d(){var f=o*i,m=f+i;o++,o<a?l(s,r,f,m,c):l(s,r,f,m,u)}d()}function Hl(r){return fr.default.hash(r)}function Wl(r,t){if(!t)return mn().replace(/-/g,"").toLowerCase();var e=Object.assign({},r);return delete e._rev_tree,Hl(JSON.stringify(e))}function kt(r){for(var t,e,n,i=r.rev_tree.slice(),a;a=i.pop();){var o=a.ids,s=o[2],l=a.pos;if(s.length){for(var c=0,u=s.length;c<u;c++)i.push({pos:l+1,ids:s[c]});continue}var d=!!o[1].deleted,f=o[0];(!t||(n!==d?n:e!==l?e<l:t<f))&&(t=f,e=l,n=d)}return e+"-"+t}function St(r,t){for(var e=r.slice(),n;n=e.pop();)for(var i=n.pos,a=n.ids,o=a[2],s=t(o.length===0,i,a[0],n.ctx,a[1]),l=0,c=o.length;l<c;l++)e.push({pos:i+1,ids:o[l],ctx:s})}function ah(r,t){return r.pos-t.pos}function ya(r){var t=[];St(r,function(i,a,o,s,l){i&&t.push({rev:a+"-"+o,pos:a,opts:l})}),t.sort(ah).reverse();for(var e=0,n=t.length;e<n;e++)delete t[e].pos;return t}function wa(r){for(var t=kt(r),e=ya(r.rev_tree),n=[],i=0,a=e.length;i<a;i++){var o=e[i];o.rev!==t&&!o.opts.deleted&&n.push(o.rev)}return n}function oh(r){var t=[];return St(r.rev_tree,function(e,n,i,a,o){o.status==="available"&&!e&&(t.push(n+"-"+i),o.status="missing")}),t}function sh(r,t){let e=[],n=r.slice(),i;for(;i=n.pop();){let{pos:a,ids:o}=i,s=`${a}-${o[0]}`,l=o[2];if(e.push(s),s===t){if(l.length!==0)throw new Error("The requested revision is not a leaf");return e.reverse()}(l.length===0||l.length>1)&&(e=[]);for(let c=0,u=l.length;c<u;c++)n.push({pos:a+1,ids:l[c]})}if(e.length===0)throw new Error("The requested revision does not exist");return e.reverse()}function Vl(r){for(var t=[],e=r.slice(),n;n=e.pop();){var i=n.pos,a=n.ids,o=a[0],s=a[1],l=a[2],c=l.length===0,u=n.history?n.history.slice():[];u.push({id:o,opts:s}),c&&t.push({pos:i+1-u.length,ids:u});for(var d=0,f=l.length;d<f;d++)e.push({pos:i+1,ids:l[d],history:u})}return t.reverse()}function lh(r,t){return r.pos-t.pos}function ch(r,t,e){for(var n=0,i=r.length,a;n<i;)a=n+i>>>1,e(r[a],t)<0?n=a+1:i=a;return n}function uh(r,t,e){var n=ch(r,t,e);r.splice(n,0,t)}function fl(r,t){for(var e,n,i=t,a=r.length;i<a;i++){var o=r[i],s=[o.id,o.opts,[]];n?(n[2].push(s),n=s):e=n=s}return e}function dh(r,t){return r[0]<t[0]?-1:1}function hl(r,t){for(var e=[{tree1:r,tree2:t}],n=!1;e.length>0;){var i=e.pop(),a=i.tree1,o=i.tree2;(a[1].status||o[1].status)&&(a[1].status=a[1].status==="available"||o[1].status==="available"?"available":"missing");for(var s=0;s<o[2].length;s++){if(!a[2][0]){n="new_leaf",a[2][0]=o[2][s];continue}for(var l=!1,c=0;c<a[2].length;c++)a[2][c][0]===o[2][s][0]&&(e.push({tree1:a[2][c],tree2:o[2][s]}),l=!0);l||(n="new_branch",uh(a[2],o[2][s],dh))}}return{conflicts:n,tree:r}}function Kl(r,t,e){var n=[],i=!1,a=!1,o;if(!r.length)return{tree:[t],conflicts:"new_leaf"};for(var s=0,l=r.length;s<l;s++){var c=r[s];if(c.pos===t.pos&&c.ids[0]===t.ids[0])o=hl(c.ids,t.ids),n.push({pos:c.pos,ids:o.tree}),i=i||o.conflicts,a=!0;else if(e!==!0){var u=c.pos<t.pos?c:t,d=c.pos<t.pos?t:c,f=d.pos-u.pos,m=[],b=[];for(b.push({ids:u.ids,diff:f,parent:null,parentIdx:null});b.length>0;){var S=b.pop();if(S.diff===0){S.ids[0]===d.ids[0]&&m.push(S);continue}for(var k=S.ids[2],y=0,g=k.length;y<g;y++)b.push({ids:k[y],diff:S.diff-1,parent:S.ids,parentIdx:y})}var h=m[0];h?(o=hl(h.ids,d.ids),h.parent[2][h.parentIdx]=o.tree,n.push({pos:u.pos,ids:u.ids}),i=i||o.conflicts,a=!0):n.push(c)}else n.push(c)}return a||n.push(t),n.sort(lh),{tree:n,conflicts:i||"internal_node"}}function fh(r,t){for(var e=Vl(r),n,i,a=0,o=e.length;a<o;a++){var s=e[a],l=s.ids,c;if(l.length>t){n||(n={});var u=l.length-t;c={pos:s.pos+u,ids:fl(l,u)};for(var d=0;d<u;d++){var f=s.pos+d+"-"+l[d].id;n[f]=!0}}else c={pos:s.pos,ids:fl(l,0)};i?i=Kl(i,c,!0).tree:i=[c]}return n&&St(i,function(m,b,S){delete n[b+"-"+S]}),{tree:i,revs:n?Object.keys(n):[]}}function Gl(r,t,e){var n=Kl(r,t),i=fh(n.tree,e);return{tree:i.tree,stemmedRevs:i.revs,conflicts:n.conflicts}}function hh(r,t){for(var e=r.slice(),n=t.split("-"),i=parseInt(n[0],10),a=n[1],o;o=e.pop();){if(o.pos===i&&o.ids[0]===a)return!0;for(var s=o.ids[2],l=0,c=s.length;l<c;l++)e.push({pos:o.pos+1,ids:s[l]})}return!1}function ph(r){return r.ids}function ct(r,t){t||(t=kt(r));for(var e=t.substring(t.indexOf("-")+1),n=r.rev_tree.map(ph),i;i=n.pop();){if(i[0]===e)return!!i[1].deleted;n=n.concat(i[2])}}function _t(r){return typeof r=="string"&&r.startsWith("_local/")}function gh(r,t){for(var e=t.rev_tree.slice(),n;n=e.pop();){var i=n.pos,a=n.ids,o=a[0],s=a[1],l=a[2],c=l.length===0,u=n.history?n.history.slice():[];if(u.push({id:o,pos:i,opts:s}),c)for(var d=0,f=u.length;d<f;d++){var m=u[d],b=m.pos+"-"+m.id;if(b===r)return i+"-"+o}for(var S=0,k=l.length;S<k;S++)e.push({pos:i+1,ids:l[S],history:u})}throw new Error("Unable to resolve latest revision for id "+t.id+", rev "+r)}function mh(r,t,e,n){try{r.emit("change",t,e,n)}catch(i){He("error",'Error in .on("change", function):',i)}}function vh(r,t,e){var n=[{rev:r._rev}];e.style==="all_docs"&&(n=ya(t.rev_tree).map(function(a){return{rev:a.rev}}));var i={id:t.id,changes:n,doc:r};return ct(t,r._rev)&&(i.deleted=!0),e.conflicts&&(i.doc._conflicts=wa(t),i.doc._conflicts.length||delete i.doc._conflicts),i}function Ti(r,t){return function(e,n){e||n[0]&&n[0].error?(e=e||n[0],e.docId=t,r(e)):r(null,n.length?n[0]:n)}}function yh(r){for(var t=0;t<r.length;t++){var e=r[t];if(e._deleted)delete e._attachments;else if(e._attachments)for(var n=Object.keys(e._attachments),i=0;i<n.length;i++){var a=n[i];e._attachments[a]=xn(e._attachments[a],["data","digest","content_type","length","revpos","stub"])}}}function wh(r,t){if(r._id===t._id){let e=r._revisions?r._revisions.start:0,n=t._revisions?t._revisions.start:0;return e-n}return r._id<t._id?-1:1}function bh(r){var t={},e=[];return St(r,function(n,i,a,o){var s=i+"-"+a;return n&&(t[s]=0),o!==void 0&&e.push({from:o,to:s}),s}),e.reverse(),e.forEach(function(n){t[n.from]===void 0?t[n.from]=1+t[n.to]:t[n.from]=Math.min(t[n.from],1+t[n.to])}),t}function xh(r){var t="limit"in r?r.keys.slice(r.skip,r.limit+r.skip):r.skip>0?r.keys.slice(r.skip):r.keys;r.keys=t,r.skip=0,delete r.limit,r.descending&&(t.reverse(),r.descending=!1)}function Jl(r){var t=r._compactionQueue[0],e=t.opts,n=t.callback;r.get("_local/compaction").catch(function(){return!1}).then(function(i){i&&i.last_seq&&(e.last_seq=i.last_seq),r._compact(e,function(a,o){a?n(a):n(null,o),at(function(){r._compactionQueue.shift(),r._compactionQueue.length&&Jl(r)})})})}function _h(r,t,e){return r.get("_local/purges").then(function(n){let i=n.purgeSeq+1;return n.purges.push({docId:t,rev:e,purgeSeq:i}),n.purges.length>self.purged_infos_limit&&n.purges.splice(0,n.purges.length-self.purged_infos_limit),n.purgeSeq=i,n}).catch(function(n){if(n.status!==404)throw n;return{_id:"_local/purges",purges:[{docId:t,rev:e,purgeSeq:0}],purgeSeq:0}}).then(function(n){return r.put(n)})}function kh(r){return r.charAt(0)==="_"?r+" is not a valid attachment name, attachment names cannot start with '_'":!1}function Ai(r){return r===null||typeof r!="object"||Array.isArray(r)}function Ii(r){return typeof r=="string"&&Sh.test(r)}function Ch(r,t){var e=r.match(/([a-z-]*):\/\/(.*)/);if(e)return{name:/https?/.test(e[1])?e[1]+"://"+e[2]:e[2],adapter:e[1]};var n=ne.adapters,i=ne.preferredAdapters,a=ne.prefix,o=t.adapter;if(!o)for(var s=0;s<i.length;++s){if(o=i[s],o==="idb"&&"websql"in n&&hr()&&localStorage["_pouch__websqldb_"+a+r]){He("log",'PouchDB is downgrading "'+r+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}var l=n[o],c=l&&"use_prefix"in l?l.use_prefix:!0;return{name:c?a+r:r,adapter:o}}function Eh(r,t){r.prototype=Object.create(t.prototype,{constructor:{value:r}})}function Ql(r,t){let e=function(...n){if(!(this instanceof e))return new e(...n);t.apply(this,n)};return Eh(e,r),e}function Th(r){function t(n){r.removeListener("closed",e),n||r.constructor.emit("destroyed",r.name)}function e(){r.removeListener("destroyed",t),r.constructor.emit("unref",r)}r.once("destroyed",t),r.once("closed",e),r.constructor.emit("ref",r)}function Ah(r){Object.keys(it.default.prototype).forEach(function(e){typeof it.default.prototype[e]=="function"&&(r[e]=pl[e].bind(pl))});var t=r._destructionListeners=new Map;r.on("ref",function(n){t.has(n.name)||t.set(n.name,[]),t.get(n.name).push(n)}),r.on("unref",function(n){if(t.has(n.name)){var i=t.get(n.name),a=i.indexOf(n);a<0||(i.splice(a,1),i.length>1?t.set(n.name,i):t.delete(n.name))}}),r.on("destroyed",function(n){if(t.has(n)){var i=t.get(n);t.delete(n),i.forEach(function(a){a.emit("destroyed",!0)})}})}function ba(r,t){for(var e=r,n=0,i=t.length;n<i;n++){var a=t[n];if(e=e[a],!e)break}return e}function Ph(r,t){return r<t?-1:r>t?1:0}function xa(r){for(var t=[],e="",n=0,i=r.length;n<i;n++){var a=r[n];n>0&&r[n-1]==="\\"&&(a==="$"||a===".")?e=e.substring(0,e.length-1)+a:a==="."?(t.push(e),e=""):e+=a}return t.push(e),t}function Yl(r){return $h.indexOf(r)>-1}function Xl(r){return Object.keys(r)[0]}function Oh(r){return r[Xl(r)]}function wn(r){var t={},e={$or:!0,$nor:!0};return r.forEach(function(n){Object.keys(n).forEach(function(i){var a=n[i];if(typeof a!="object"&&(a={$eq:a}),Yl(i))if(a instanceof Array){if(e[i]){e[i]=!1,t[i]=a;return}var o=[];t[i].forEach(function(l){Object.keys(a).forEach(function(c){var u=a[c],d=Math.max(Object.keys(l).length,Object.keys(u).length),f=wn([l,u]);Object.keys(f).length<=d||o.push(f)})}),t[i]=o}else t[i]=wn([a]);else{var s=t[i]=t[i]||{};Object.keys(a).forEach(function(l){var c=a[l];if(l==="$gt"||l==="$gte")return Dh(l,c,s);if(l==="$lt"||l==="$lte")return Mh(l,c,s);if(l==="$ne")return Lh(c,s);if(l==="$eq")return Rh(c,s);if(l==="$regex")return Fh(c,s);s[l]=c})}})}),t}function Dh(r,t,e){typeof e.$eq=="undefined"&&(typeof e.$gte!="undefined"?r==="$gte"?t>e.$gte&&(e.$gte=t):t>=e.$gte&&(delete e.$gte,e.$gt=t):typeof e.$gt!="undefined"?r==="$gte"?t>e.$gt&&(delete e.$gt,e.$gte=t):t>e.$gt&&(e.$gt=t):e[r]=t)}function Mh(r,t,e){typeof e.$eq=="undefined"&&(typeof e.$lte!="undefined"?r==="$lte"?t<e.$lte&&(e.$lte=t):t<=e.$lte&&(delete e.$lte,e.$lt=t):typeof e.$lt!="undefined"?r==="$lte"?t<e.$lt&&(delete e.$lt,e.$lte=t):t<e.$lt&&(e.$lt=t):e[r]=t)}function Lh(r,t){"$ne"in t?t.$ne.push(r):t.$ne=[r]}function Rh(r,t){delete t.$gt,delete t.$gte,delete t.$lt,delete t.$lte,delete t.$ne,t.$eq=r}function Fh(r,t){"$regex"in t?t.$regex.push(r):t.$regex=[r]}function ec(r){for(var t in r){if(Array.isArray(r))for(var e in r)r[e].$and&&(r[e]=wn(r[e].$and));var n=r[t];typeof n=="object"&&ec(n)}return r}function tc(r,t){for(var e in r){e==="$and"&&(t=!0);var n=r[e];typeof n=="object"&&(t=tc(n,t))}return t}function Bh(r){var t=Ce(r);tc(t,!1)&&(t=ec(t),"$and"in t&&(t=wn(t.$and))),["$or","$nor"].forEach(function(o){o in t&&t[o].forEach(function(s){for(var l=Object.keys(s),c=0;c<l.length;c++){var u=l[c],d=s[u];(typeof d!="object"||d===null)&&(s[u]={$eq:d})}})}),"$not"in t&&(t.$not=wn([t.$not]));for(var e=Object.keys(t),n=0;n<e.length;n++){var i=e[n],a=t[i];(typeof a!="object"||a===null)&&(a={$eq:a}),t[i]=a}return Vi(t),t}function Vi(r){Object.keys(r).forEach(function(t){var e=r[t];Array.isArray(e)?e.forEach(function(n){n&&typeof n=="object"&&Vi(n)}):t==="$ne"?r.$ne=[e]:t==="$regex"?r.$regex=[e]:e&&typeof e=="object"&&Vi(e)})}function qh(r,t,e){for(var n="",i=e-r.length;n.length<i;)n+=t;return n}function Nh(r,t,e){var n=qh(r,t,e);return n+r}function we(r,t){if(r===t)return 0;r=Ct(r),t=Ct(t);var e=Ji(r),n=Ji(t);if(e-n!==0)return e-n;switch(typeof r){case"number":return r-t;case"boolean":return r<t?-1:1;case"string":return Vh(r,t)}return Array.isArray(r)?Wh(r,t):Kh(r,t)}function Ct(r){switch(typeof r){case"undefined":return null;case"number":return r===1/0||r===-1/0||isNaN(r)?null:r;case"object":var t=r;if(Array.isArray(r)){var e=r.length;r=new Array(e);for(var n=0;n<e;n++)r[n]=Ct(t[n])}else{if(r instanceof Date)return r.toJSON();if(r!==null){r={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var a=t[i];typeof a!="undefined"&&(r[i]=Ct(a))}}}}return r}function jh(r){if(r!==null)switch(typeof r){case"boolean":return r?1:0;case"number":return Gh(r);case"string":return r.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var t=Array.isArray(r),e=t?r:Object.keys(r),n=-1,i=e.length,a="";if(t)for(;++n<i;)a+=Ze(e[n]);else for(;++n<i;){var o=e[n];a+=Ze(o)+Ze(r[o])}return a}return""}function Ze(r){var t="\0";return r=Ct(r),Ji(r)+Gi+jh(r)+t}function zh(r,t){var e=t,n,i=r[t]==="1";if(i)n=0,t++;else{var a=r[t]==="0";t++;var o="",s=r.substring(t,t+Ki),l=parseInt(s,10)+nc;for(a&&(l=-l),t+=Ki;;){var c=r[t];if(c==="\0")break;o+=c,t++}o=o.split("."),o.length===1?n=parseInt(o,10):n=parseFloat(o[0]+"."+o[1]),a&&(n=n-10),l!==0&&(n=parseFloat(n+"e"+l))}return{num:n,length:t-e}}function Uh(r,t){var e=r.pop();if(t.length){var n=t[t.length-1];e===n.element&&(t.pop(),n=t[t.length-1]);var i=n.element,a=n.index;if(Array.isArray(i))i.push(e);else if(a===r.length-2){var o=r.pop();i[o]=e}else r.push(e)}}function Hh(r){for(var t=[],e=[],n=0;;){var i=r[n++];if(i==="\0"){if(t.length===1)return t.pop();Uh(t,e);continue}switch(i){case"1":t.push(null);break;case"2":t.push(r[n]==="1"),n++;break;case"3":var a=zh(r,n);t.push(a.num),n+=a.length;break;case"4":for(var o="";;){var s=r[n];if(s==="\0")break;o+=s,n++}o=o.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),t.push(o);break;case"5":var l={element:[],index:t.length};t.push(l.element),e.push(l);break;case"6":var c={element:{},index:t.length};t.push(c.element),e.push(c);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+i)}}}function Wh(r,t){for(var e=Math.min(r.length,t.length),n=0;n<e;n++){var i=we(r[n],t[n]);if(i!==0)return i}return r.length===t.length?0:r.length>t.length?1:-1}function Vh(r,t){return r===t?0:r>t?1:-1}function Kh(r,t){for(var e=Object.keys(r),n=Object.keys(t),i=Math.min(e.length,n.length),a=0;a<i;a++){var o=we(e[a],n[a]);if(o!==0||(o=we(r[e[a]],t[n[a]]),o!==0))return o}return e.length===n.length?0:e.length>n.length?1:-1}function Ji(r){var t=["boolean","number","string","object"],e=t.indexOf(typeof r);if(~e)return r===null?1:Array.isArray(r)?5:e<3?e+2:e+3;if(Array.isArray(r))return 5}function Gh(r){if(r===0)return"1";var t=r.toExponential().split(/e\+?/),e=parseInt(t[1],10),n=r<0,i=n?"0":"2",a=(n?-e:e)-nc,o=Nh(a.toString(),"0",Ki);i+=Gi+o;var s=Math.abs(parseFloat(t[0]));n&&(s=10-s);var l=s.toFixed(20);return l=l.replace(/\.?0+$/,""),i+=Gi+l,i}function Jh(r){function t(e){return r.map(function(n){var i=Xl(n),a=xa(i),o=ba(e,a);return o})}return function(e,n){var i=t(e.doc),a=t(n.doc),o=we(i,a);return o!==0?o:Ph(e.doc._id,n.doc._id)}}function Qh(r,t,e){if(r=r.filter(function(o){return Kt(o.doc,t.selector,e)}),t.sort){var n=Jh(t.sort);r=r.sort(n),typeof t.sort[0]!="string"&&Oh(t.sort[0])==="desc"&&(r=r.reverse())}if("limit"in t||"skip"in t){var i=t.skip||0,a=("limit"in t?t.limit:r.length)+i;r=r.slice(i,a)}return r}function Kt(r,t,e){return e.every(function(n){var i=t[n],a=xa(n),o=ba(r,a);return Yl(n)?Zh(n,i,r):vr(i,r,a,o)})}function vr(r,t,e,n){return r?typeof r=="object"?Object.keys(r).every(function(i){var a=r[i];if(i.indexOf("$")===0)return gl(i,t,a,e,n);var o=xa(i);if(n===void 0&&typeof a!="object"&&o.length>0)return!1;var s=ba(n,o);return typeof a=="object"?vr(a,t,e,s):gl("$eq",t,a,o,s)}):r===n:!0}function Zh(r,t,e){return r==="$or"?t.some(function(n){return Kt(e,n,Object.keys(n))}):r==="$not"?!Kt(e,t,Object.keys(t)):!t.find(function(n){return Kt(e,n,Object.keys(n))})}function gl(r,t,e,n,i){if(!vl[r])throw new Error('unknown operator "'+r+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return vl[r](t,e,n,i)}function vn(r){return typeof r!="undefined"&&r!==null}function yt(r){return typeof r!="undefined"}function Yh(r,t){if(typeof r!="number"||parseInt(r,10)!==r)return!1;var e=t[0],n=t[1];return r%e===n}function ml(r,t){return t.some(function(e){return r instanceof Array?r.some(function(n){return we(e,n)===0}):we(e,r)===0})}function Xh(r,t){return t.every(function(e){return r.some(function(n){return we(e,n)===0})})}function ep(r,t){return r.length===t}function tp(r,t){var e=new RegExp(t);return e.test(r)}function np(r,t){switch(t){case"null":return r===null;case"boolean":return typeof r=="boolean";case"number":return typeof r=="number";case"string":return typeof r=="string";case"array":return r instanceof Array;case"object":return{}.toString.call(r)==="[object Object]"}}function rp(r,t){if(typeof t!="object")throw new Error("Selector error: expected a JSON object");t=Bh(t);var e={doc:r},n=Qh([e],{selector:t},Object.keys(t));return n&&n.length===1}function ip(r){return da(`"use strict";
return `+r+";",{})}function ap(r){var t=["return function(doc) {",'  "use strict";',"  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+r+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join(`
`);return da(t,{})}function op(r,t){if(r.selector&&r.filter&&r.filter!=="_selector"){var e=typeof r.filter=="string"?r.filter:"function";return t(new Error('selector invalid for filter "'+e+'"'))}t()}function sp(r){r.view&&!r.filter&&(r.filter="_view"),r.selector&&!r.filter&&(r.filter="_selector"),r.filter&&typeof r.filter=="string"&&(r.filter==="_view"?r.view=cl(r.view):r.filter=cl(r.filter))}function lp(r,t){return t.filter&&typeof t.filter=="string"&&!t.doc_ids&&!rt(r.db)}function cp(r,t){var e=t.complete;if(t.filter==="_view"){if(!t.view||typeof t.view!="string"){var n=ee(xr,"`view` filter parameter not found or invalid.");return e(n)}var i=zi(t.view);r.db.get("_design/"+i[0],function(o,s){if(r.isCancelled)return e(null,{status:"cancelled"});if(o)return e(Jt(o));var l=s&&s.views&&s.views[i[1]]&&s.views[i[1]].map;if(!l)return e(ee(ze,s.views?"missing json key: "+i[1]:"missing json key: views"));t.filter=ap(l),r.doChanges(t)})}else if(t.selector)t.filter=function(o){return rp(o,t.selector)},r.doChanges(t);else{var a=zi(t.filter);r.db.get("_design/"+a[0],function(o,s){if(r.isCancelled)return e(null,{status:"cancelled"});if(o)return e(Jt(o));var l=s&&s.filters&&s.filters[a[1]];if(!l)return e(ee(ze,s&&s.filters?"missing json key: "+a[1]:"missing json key: filters"));t.filter=ip(l),r.doChanges(t)})}}function up(r){r._changesFilterPlugin={validate:op,normalize:sp,shouldFilter:lp,filter:cp}}function dp(r,t,e){return new Promise(function(n){var i=ha([""]);let a;if(typeof e=="function"){let s=e(i);a=r.objectStore(t).put(s)}else{let o=e;a=r.objectStore(t).put(i,o)}a.onsuccess=function(){var o=navigator.userAgent.match(/Chrome\/(\d+)/),s=navigator.userAgent.match(/Edge\//);n(s||!o||parseInt(o[1],10)>=43)},a.onerror=r.onabort=function(o){o.preventDefault(),o.stopPropagation(),n(!1)}}).catch(function(){return!1})}function rc(r){return r.reduce(function(t,e){return t[e]=!0,t},{})}function yl(r){if(!/^\d+-/.test(r))return ee(ur);var t=r.indexOf("-"),e=r.substring(0,t),n=r.substring(t+1);return{prefix:parseInt(e,10),id:n}}function pp(r,t){for(var e=r.start-r.ids.length+1,n=r.ids,i=[n[0],t,[]],a=1,o=n.length;a<o;a++)i=[n[a],{status:"missing"},[i]];return[{pos:e,ids:i}]}function ic(r,t,e){e||(e={deterministic_revs:!0});var n,i,a,o={status:"available"};if(r._deleted&&(o.deleted=!0),t)if(r._id||(r._id=_r()),i=Wl(r,e.deterministic_revs),r._rev){if(a=yl(r._rev),a.error)return a;r._rev_tree=[{pos:a.prefix,ids:[a.id,{status:"missing"},[[i,o,[]]]]}],n=a.prefix+1}else r._rev_tree=[{pos:1,ids:[i,o,[]]}],n=1;else if(r._revisions&&(r._rev_tree=pp(r._revisions,o),n=r._revisions.start,i=r._revisions.ids[0]),!r._rev_tree){if(a=yl(r._rev),a.error)return a;n=a.prefix,i=a.id,r._rev_tree=[{pos:n,ids:[i,o,[]]}]}Nl(r._id),r._rev=n+"-"+i;var s={metadata:{},data:{}};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){var c=l[0]==="_";if(c&&!fp[l]){var u=ee(ll,l);throw u.message=ll.message+": "+l,u}else c&&!hp[l]?s.metadata[l.slice(1)]=r[l]:s.data[l]=r[l]}return s}function gp(r){try{return fa(r)}catch(e){var t=ee(ql,"Attachment is not a valid base64 string");return{error:t}}}function mp(r,t,e){var n=gp(r.data);if(n.error)return e(n.error);r.length=n.length,t==="blob"?r.data=pa(n,r.content_type):t==="base64"?r.data=_n(n):r.data=n,va(n,function(i){r.digest="md5-"+i,e()})}function vp(r,t,e){va(r.data,function(n){r.digest="md5-"+n,r.length=r.data.size||r.data.length||0,t==="binary"?Ul(r.data,function(i){r.data=i,e()}):t==="base64"?ma(r.data,function(i){r.data=i,e()}):e()})}function yp(r,t,e){if(r.stub)return e();typeof r.data=="string"?mp(r,t,e):vp(r,t,e)}function wp(r,t,e){if(!r.length)return e();var n=0,i;r.forEach(function(o){var s=o.data&&o.data._attachments?Object.keys(o.data._attachments):[],l=0;if(!s.length)return a();function c(d){i=d,l++,l===s.length&&a()}for(var u in o.data._attachments)Object.prototype.hasOwnProperty.call(o.data._attachments,u)&&yp(o.data._attachments[u],t,c)});function a(){n++,r.length===n&&(i?e(i):e())}}function bp(r,t,e,n,i,a,o,s){if(hh(t.rev_tree,e.metadata.rev)&&!s)return n[i]=e,a();var l=t.winningRev||kt(t),c="deleted"in t?t.deleted:ct(t,l),u="deleted"in e.metadata?e.metadata.deleted:ct(e.metadata),d=/^1-/.test(e.metadata.rev);if(c&&!u&&s&&d){var f=e.data;f._rev=l,f._id=e.metadata.id,e=ic(f,s)}var m=Gl(t.rev_tree,e.metadata.rev_tree[0],r),b=s&&(c&&u&&m.conflicts!=="new_leaf"||!c&&m.conflicts!=="new_leaf"||c&&!u&&m.conflicts==="new_branch");if(b){var S=ee(Gt);return n[i]=S,a()}var k=e.metadata.rev;e.metadata.rev_tree=m.tree,e.stemmedRevs=m.stemmedRevs||[],t.rev_map&&(e.metadata.rev_map=t.rev_map);var y=kt(e.metadata),g=ct(e.metadata,y),h=c===g?0:c<g?-1:1,p;k===y?p=g:p=ct(e.metadata,k),o(e,y,g,p,!0,h,i,a)}function xp(r){return r.metadata.rev_tree[0].ids[1].status==="missing"}function _p(r,t,e,n,i,a,o,s,l){r=r||1e3;function c(S,k,y){var g=kt(S.metadata),h=ct(S.metadata,g);if("was_delete"in s&&h)return a[k]=ee(ze,"deleted"),y();var p=u&&xp(S);if(p){var w=ee(Gt);return a[k]=w,y()}var _=h?0:1;o(S,g,h,h,!1,_,k,y)}var u=s.new_edits,d=new Map,f=0,m=t.length;function b(){++f===m&&l&&l()}t.forEach(function(S,k){if(S._id&&_t(S._id)){var y=S._deleted?"_removeLocal":"_putLocal";e[y](S,{ctx:i},function(h,p){a[k]=h||p,b()});return}var g=S.metadata.id;d.has(g)?(m--,d.get(g).push([S,k])):d.set(g,[[S,k]])}),d.forEach(function(S,k){var y=0;function g(){++y<S.length?h():b()}function h(){var p=S[y],w=p[0],_=p[1];if(n.has(k))bp(r,n.get(k),w,a,_,g,o,u);else{var O=Gl([],w.metadata.rev_tree[0],r);w.metadata.rev_tree=O.tree,w.stemmedRevs=O.stemmedRevs||[],c(w,_,g)}}h()})}function Sp(r){try{return JSON.parse(r)}catch(t){return sa.default.parse(r)}}function Cp(r){try{return JSON.stringify(r)}catch(t){return sa.default.stringify(r)}}function nt(r){return function(t){var e="unknown_error";t.target&&t.target.error&&(e=t.target.error.name||t.target.error.message),r(ee(ca,e,t.type))}}function Qi(r,t,e){return{data:Cp(r),winningRev:t,deletedOrLocal:e?"1":"0",seq:r.seq,id:r.id}}function xt(r){if(!r)return null;var t=Sp(r.data);return t.winningRev=r.winningRev,t.deleted=r.deletedOrLocal==="1",t.seq=r.seq,t}function yr(r){if(!r)return r;var t=r._doc_id_rev.lastIndexOf(":");return r._id=r._doc_id_rev.substring(0,t-1),r._rev=r._doc_id_rev.substring(t+1),delete r._doc_id_rev,r}function ac(r,t,e,n){e?n(r?typeof r!="string"?r:ga(r,t):ha([""],{type:t})):r?typeof r!="string"?zl(r,function(i){n(_n(i))}):n(r):n("")}function oc(r,t,e,n){var i=Object.keys(r._attachments||{});if(!i.length)return n&&n();var a=0;function o(){++a===i.length&&n&&n()}function s(l,c){var u=l._attachments[c],d=u.digest,f=e.objectStore(Ue).get(d);f.onsuccess=function(m){u.body=m.target.result.body,o()}}i.forEach(function(l){t.attachments&&t.include_docs?s(r,l):(r._attachments[l].stub=!0,o())})}function Zi(r,t){return Promise.all(r.map(function(e){if(e.doc&&e.doc._attachments){var n=Object.keys(e.doc._attachments);return Promise.all(n.map(function(i){var a=e.doc._attachments[i];if("body"in a){var o=a.body,s=a.content_type;return new Promise(function(l){ac(o,s,t,function(c){e.doc._attachments[i]=Object.assign(xn(a,["digest","content_type"]),{data:c}),l()})})}}))}}))}function sc(r,t,e){var n=[],i=e.objectStore(Ie),a=e.objectStore(Ue),o=e.objectStore(bt),s=r.length;function l(){s--,s||c()}function c(){n.length&&n.forEach(function(u){var d=o.index("digestSeq").count(IDBKeyRange.bound(u+"::",u+"::\uFFFF",!1,!1));d.onsuccess=function(f){var m=f.target.result;m||a.delete(u)}})}r.forEach(function(u){var d=i.index("_doc_id_rev"),f=t+"::"+u;d.getKey(f).onsuccess=function(m){var b=m.target.result;if(typeof b!="number")return l();i.delete(b);var S=o.index("seq").openCursor(IDBKeyRange.only(b));S.onsuccess=function(k){var y=k.target.result;if(y){var g=y.value.digestSeq.split("::")[0];n.push(g),o.delete(y.primaryKey),y.continue()}else l()}}})}function Ye(r,t,e){try{return{txn:r.transaction(t,e)}}catch(n){return{error:n}}}function Ep(r,t,e,n,i,a){for(var o=t.docs,s,l,c,u,d,f,m,b,S=0,k=o.length;S<k;S++){var y=o[S];y._id&&_t(y._id)||(y=o[S]=ic(y,e.new_edits,r),y.error&&!m&&(m=y))}if(m)return a(m);var g=!1,h=0,p=new Array(o.length),w=new Map,_=!1,O=n._meta.blobSupport?"blob":"base64";wp(o,O,function(E){if(E)return a(E);M()});function M(){var E=[be,Ie,Ue,tt,bt,Me],P=Ye(i,E,"readwrite");if(P.error)return a(P.error);s=P.txn,s.onabort=nt(a),s.ontimeout=nt(a),s.oncomplete=U,l=s.objectStore(be),c=s.objectStore(Ie),u=s.objectStore(Ue),d=s.objectStore(bt),f=s.objectStore(Me),f.get(Me).onsuccess=function(R){b=R.target.result,j()},J(function(R){if(R)return _=!0,a(R);Q()})}function D(){g=!0,j()}function z(){_p(r.revs_limit,o,n,w,s,p,Y,e,D)}function j(){!b||!g||(b.docCount+=h,f.put(b))}function Q(){if(!o.length)return;var E=0;function P(){++E===o.length&&z()}function R(L){var B=xt(L.target.result);B&&w.set(B.id,B),P()}for(var N=0,$=o.length;N<$;N++){var T=o[N];if(T._id&&_t(T._id)){P();continue}var I=l.get(T.metadata.id);I.onsuccess=R}}function U(){_||(yn.notify(n._meta.name),a(null,p))}function H(E,P){var R=u.get(E);R.onsuccess=function(N){if(N.target.result)P();else{var $=ee(Wf,"unknown stub attachment with digest "+E);$.status=412,P($)}}}function J(E){var P=[];if(o.forEach(function(T){T.data&&T.data._attachments&&Object.keys(T.data._attachments).forEach(function(I){var L=T.data._attachments[I];L.stub&&P.push(L.digest)})}),!P.length)return E();var R=0,N;function $(){++R===P.length&&E(N)}P.forEach(function(T){H(T,function(I){I&&!N&&(N=I),$()})})}function Y(E,P,R,N,$,T,I,L){E.metadata.winningRev=P,E.metadata.deleted=R;var B=E.data;B._id=E.metadata.id,B._rev=E.metadata.rev,N&&(B._deleted=!0);var q=B._attachments&&Object.keys(B._attachments).length;if(q)return v(E,P,R,$,I,L);h+=T,j(),re(E,P,R,$,I,L)}function re(E,P,R,N,$,T){var I=E.data,L=E.metadata;I._doc_id_rev=L.id+"::"+L.rev,delete I._id,delete I._rev;function B(ue){var ke=E.stemmedRevs||[];N&&n.auto_compaction&&(ke=ke.concat(oh(E.metadata))),ke&&ke.length&&sc(ke,E.metadata.id,s),L.seq=ue.target.result;var Oe=Qi(L,P,R),V=l.put(Oe);V.onsuccess=te}function q(ue){ue.preventDefault(),ue.stopPropagation();var ke=c.index("_doc_id_rev"),Oe=ke.getKey(I._doc_id_rev);Oe.onsuccess=function(V){var W=c.put(I,V.target.result);W.onsuccess=B}}function te(){p[$]={ok:!0,id:L.id,rev:L.rev},w.set(E.metadata.id,E.metadata),x(E,L.seq,T)}var ae=c.put(I);ae.onsuccess=B,ae.onerror=q}function v(E,P,R,N,$,T){var I=E.data,L=0,B=Object.keys(I._attachments);function q(){L===B.length&&re(E,P,R,N,$,T)}function te(){L++,q()}B.forEach(function(ae){var ue=E.data._attachments[ae];if(ue.stub)L++,q();else{var ke=ue.data;delete ue.data,ue.revpos=parseInt(P,10);var Oe=ue.digest;C(Oe,ke,te)}})}function x(E,P,R){var N=0,$=Object.keys(E.data._attachments||{});if(!$.length)return R();function T(){++N===$.length&&R()}function I(B){var q=E.data._attachments[B].digest,te=d.put({seq:P,digestSeq:q+"::"+P});te.onsuccess=T,te.onerror=function(ae){ae.preventDefault(),ae.stopPropagation(),T()}}for(var L=0;L<$.length;L++)I($[L])}function C(E,P,R){var N=u.count(E);N.onsuccess=function($){var T=$.target.result;if(T)return R();var I={digest:E,body:P},L=u.put(I);L.onsuccess=R}}}function lc(r,t,e,n,i){n===-1&&(n=1e3);var a=typeof r.getAll=="function"&&typeof r.getAllKeys=="function"&&n>1&&!e,o,s,l;function c(m){s=m.target.result,o&&i(o,s,l)}function u(m){o=m.target.result,s&&i(o,s,l)}function d(){if(!o.length)return i();var m=o[o.length-1],b;if(t&&t.upper)try{b=IDBKeyRange.bound(m,t.upper,!0,t.upperOpen)}catch(S){if(S.name==="DataError"&&S.code===0)return i()}else b=IDBKeyRange.lowerBound(m,!0);t=b,o=null,s=null,r.getAll(t,n).onsuccess=c,r.getAllKeys(t,n).onsuccess=u}function f(m){var b=m.target.result;if(!b)return i();i([b.key],[b.value],b)}a?(l={continue:d},r.getAll(t,n).onsuccess=c,r.getAllKeys(t,n).onsuccess=u):e?r.openCursor(t,"prev").onsuccess=f:r.openCursor(t).onsuccess=f}function Tp(r,t,e){if(typeof r.getAll=="function"){r.getAll(t).onsuccess=e;return}var n=[];function i(a){var o=a.target.result;o?(n.push(o.value),o.continue()):e({target:{result:n}})}r.openCursor(t).onsuccess=i}function Ap(r,t,e){var n=new Array(r.length),i=0;r.forEach(function(a,o){t.get(a).onsuccess=function(s){s.target.result?n[o]=s.target.result:n[o]={key:a,error:"not_found"},i++,i===r.length&&e(r,n,{})}})}function Ip(r,t,e,n,i){try{if(r&&t)return i?IDBKeyRange.bound(t,r,!e,!1):IDBKeyRange.bound(r,t,!1,!e);if(r)return i?IDBKeyRange.upperBound(r):IDBKeyRange.lowerBound(r);if(t)return i?IDBKeyRange.lowerBound(t,!e):IDBKeyRange.upperBound(t,!e);if(n)return IDBKeyRange.only(n)}catch(a){return{error:a}}return null}function Pp(r,t,e){var n="startkey"in r?r.startkey:!1,i="endkey"in r?r.endkey:!1,a="key"in r?r.key:!1,o="keys"in r?r.keys:!1,s=r.skip||0,l=typeof r.limit=="number"?r.limit:-1,c=r.inclusive_end!==!1,u,d;if(!o&&(u=Ip(n,i,c,a,r.descending),d=u&&u.error,d&&!(d.name==="DataError"&&d.code===0)))return e(ee(ca,d.name,d.message));var f=[be,Ie,Me];r.attachments&&f.push(Ue);var m=Ye(t,f,"readonly");if(m.error)return e(m.error);var b=m.txn;b.oncomplete=Q,b.onabort=nt(e);var S=b.objectStore(be),k=b.objectStore(Ie),y=b.objectStore(Me),g=k.index("_doc_id_rev"),h=[],p,w;y.get(Me).onsuccess=function(U){p=U.target.result.docCount},r.update_seq&&(k.openKeyCursor(null,"prev").onsuccess=U=>{var H=U.target.result;H&&H.key&&(w=H.key)});function _(U,H,J){var Y=U.id+"::"+J;g.get(Y).onsuccess=function(v){if(H.doc=yr(v.target.result)||{},r.conflicts){var x=wa(U);x.length&&(H.doc._conflicts=x)}oc(H.doc,r,b)}}function O(U,H){var J={id:H.id,key:H.id,value:{rev:U}},Y=H.deleted;Y?o&&(h.push(J),J.value.deleted=!0,J.doc=null):s--<=0&&(h.push(J),r.include_docs&&_(H,J,U))}function M(U){for(var H=0,J=U.length;H<J&&h.length!==l;H++){var Y=U[H];if(Y.error&&o){h.push(Y);continue}var re=xt(Y),v=re.winningRev;O(v,re)}}function D(U,H,J){J&&(M(H),h.length<l&&J.continue())}function z(U){var H=U.target.result;r.descending&&(H=H.reverse()),M(H)}function j(){var U={total_rows:p,offset:r.skip,rows:h};r.update_seq&&w!==void 0&&(U.update_seq=w),e(null,U)}function Q(){r.attachments?Zi(h,r.binary).then(j):j()}if(!(d||l===0)){if(o)return Ap(o,S,D);if(l===-1)return Tp(S,u,z);lc(S,u,r.descending,l+s,D)}}function $p(r,t){var e=r.objectStore(be).index("deletedOrLocal");e.count(IDBKeyRange.only("0")).onsuccess=function(n){t(n.target.result)}}function Op(r,t,e,n){try{r(t,e)}catch(i){n.emit("error",i)}}function wl(){Yi||!Xi.length||(Yi=!0,Xi.shift()())}function Dp(r,t,e){Xi.push(function(){r(function(a,o){Op(t,a,o,e),Yi=!1,at(function(){wl(e)})})}),wl()}function Mp(r,t,e,n){if(r=Ce(r),r.continuous){var i=e+":"+_r();return yn.addListener(e,i,t,r),yn.notify(e),{cancel:function(){yn.removeListener(e,i)}}}var a=r.doc_ids&&new Set(r.doc_ids);r.since=r.since||0;var o=r.since,s="limit"in r?r.limit:-1;s===0&&(s=1);var l=[],c=0,u=ua(r),d=new Map,f,m,b,S;function k(M,D,z){if(!z||!M.length)return;var j=new Array(M.length),Q=new Array(M.length);function U(Y,re){var v=r.processChange(re,Y,r);o=v.seq=Y.seq;var x=u(v);return typeof x=="object"?Promise.reject(x):x?(c++,r.return_docs&&l.push(v),r.attachments&&r.include_docs?new Promise(function(C){oc(re,r,f,function(){Zi([v],r.binary).then(function(){C(v)})})}):Promise.resolve(v)):Promise.resolve()}function H(){for(var Y=[],re=0,v=j.length;re<v&&c!==s;re++){var x=j[re];if(x){var C=Q[re];Y.push(U(C,x))}}Promise.all(Y).then(function(E){for(var P=0,R=E.length;P<R;P++)E[P]&&r.onChange(E[P])}).catch(r.complete),c!==s&&z.continue()}var J=0;D.forEach(function(Y,re){var v=yr(Y),x=M[re];g(v,x,function(C,E){Q[re]=C,j[re]=E,++J===M.length&&H()})})}function y(M,D,z,j){if(z.seq!==D)return j();if(z.winningRev===M._rev)return j(z,M);var Q=M._id+"::"+z.winningRev,U=S.get(Q);U.onsuccess=function(H){j(z,yr(H.target.result))}}function g(M,D,z){if(a&&!a.has(M._id))return z();var j=d.get(M._id);if(j)return y(M,D,j,z);b.get(M._id).onsuccess=function(Q){j=xt(Q.target.result),d.set(M._id,j),y(M,D,j,z)}}function h(){r.complete(null,{results:l,last_seq:o})}function p(){!r.continuous&&r.attachments?Zi(l).then(h):h()}var w=[be,Ie];r.attachments&&w.push(Ue);var _=Ye(n,w,"readonly");if(_.error)return r.complete(_.error);f=_.txn,f.onabort=nt(r.complete),f.oncomplete=p,m=f.objectStore(Ie),b=f.objectStore(be),S=m.index("_doc_id_rev");var O=r.since&&!r.descending?IDBKeyRange.lowerBound(r.since,!0):null;lc(m,O,r.descending,s,k)}function cc(r,t){var e=this;Dp(function(n){Lp(e,r,n)},t,e.constructor)}function Lp(r,t,e){var n=t.name,i=null,a=null;r._meta=null;function o(k){return function(y,g){y&&y instanceof Error&&!y.reason&&a&&(y.reason=a),k(y,g)}}function s(k){var y=k.createObjectStore(be,{keyPath:"id"});k.createObjectStore(Ie,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),k.createObjectStore(Ue,{keyPath:"digest"}),k.createObjectStore(Me,{keyPath:"id",autoIncrement:!1}),k.createObjectStore(Pi),y.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),k.createObjectStore(tt,{keyPath:"_id"});var g=k.createObjectStore(bt,{autoIncrement:!0});g.createIndex("seq","seq"),g.createIndex("digestSeq","digestSeq",{unique:!0})}function l(k,y){var g=k.objectStore(be);g.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),g.openCursor().onsuccess=function(h){var p=h.target.result;if(p){var w=p.value,_=ct(w);w.deletedOrLocal=_?"1":"0",g.put(w),p.continue()}else y()}}function c(k){k.createObjectStore(tt,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function u(k,y){var g=k.objectStore(tt),h=k.objectStore(be),p=k.objectStore(Ie),w=h.openCursor();w.onsuccess=function(_){var O=_.target.result;if(O){var M=O.value,D=M.id,z=_t(D),j=kt(M);if(z){var Q=D+"::"+j,U=D+"::",H=D+"::~",J=p.index("_doc_id_rev"),Y=IDBKeyRange.bound(U,H,!1,!1),re=J.openCursor(Y);re.onsuccess=function(v){if(re=v.target.result,!re)h.delete(O.primaryKey),O.continue();else{var x=re.value;x._doc_id_rev===Q&&g.put(x),p.delete(re.primaryKey),re.continue()}}}else O.continue()}else y&&y()}}function d(k){var y=k.createObjectStore(bt,{autoIncrement:!0});y.createIndex("seq","seq"),y.createIndex("digestSeq","digestSeq",{unique:!0})}function f(k,y){var g=k.objectStore(Ie),h=k.objectStore(Ue),p=k.objectStore(bt),w=h.count();w.onsuccess=function(_){var O=_.target.result;if(!O)return y();g.openCursor().onsuccess=function(M){var D=M.target.result;if(!D)return y();for(var z=D.value,j=D.primaryKey,Q=Object.keys(z._attachments||{}),U={},H=0;H<Q.length;H++){var J=z._attachments[Q[H]];U[J.digest]=!0}var Y=Object.keys(U);for(H=0;H<Y.length;H++){var re=Y[H];p.put({seq:j,digestSeq:re+"::"+j})}D.continue()}}}function m(k){function y(w){return w.data?xt(w):(w.deleted=w.deletedOrLocal==="1",w)}var g=k.objectStore(Ie),h=k.objectStore(be),p=h.openCursor();p.onsuccess=function(w){var _=w.target.result;if(!_)return;var O=y(_.value);O.winningRev=O.winningRev||kt(O);function M(){var z=O.id+"::",j=O.id+"::\uFFFF",Q=g.index("_doc_id_rev").openCursor(IDBKeyRange.bound(z,j)),U=0;Q.onsuccess=function(H){var J=H.target.result;if(!J)return O.seq=U,D();var Y=J.primaryKey;Y>U&&(U=Y),J.continue()}}function D(){var z=Qi(O,O.winningRev,O.deleted),j=h.put(z);j.onsuccess=function(){_.continue()}}if(O.seq)return D();M()}}r._remote=!1,r.type=function(){return"idb"},r._id=Rl(function(k){k(null,r._meta.instanceId)}),r._bulkDocs=function(y,g,h){Ep(t,y,g,r,i,o(h))},r._get=function(y,g,h){var p,w,_,O=g.ctx;if(!O){var M=Ye(i,[be,Ie,Ue],"readonly");if(M.error)return h(M.error);O=M.txn}function D(){h(_,{doc:p,metadata:w,ctx:O})}O.objectStore(be).get(y).onsuccess=function(z){if(w=xt(z.target.result),!w)return _=ee(ze,"missing"),D();var j;if(g.rev)j=g.latest?gh(g.rev,w):g.rev;else{j=w.winningRev;var Q=ct(w);if(Q)return _=ee(ze,"deleted"),D()}var U=O.objectStore(Ie),H=w.id+"::"+j;U.index("_doc_id_rev").get(H).onsuccess=function(J){if(p=J.target.result,p&&(p=yr(p)),!p)return _=ee(ze,"missing"),D();D()}}},r._getAttachment=function(k,y,g,h,p){var w;if(h.ctx)w=h.ctx;else{var _=Ye(i,[be,Ie,Ue],"readonly");if(_.error)return p(_.error);w=_.txn}var O=g.digest,M=g.content_type;w.objectStore(Ue).get(O).onsuccess=function(D){var z=D.target.result.body;ac(z,M,h.binary,function(j){p(null,j)})}},r._info=function(y){var g,h,p=Ye(i,[Me,Ie],"readonly");if(p.error)return y(p.error);var w=p.txn;w.objectStore(Me).get(Me).onsuccess=function(_){h=_.target.result.docCount},w.objectStore(Ie).openKeyCursor(null,"prev").onsuccess=function(_){var O=_.target.result;g=O?O.key:0},w.oncomplete=function(){y(null,{doc_count:h,update_seq:g,idb_attachment_format:r._meta.blobSupport?"binary":"base64"})}},r._allDocs=function(y,g){Pp(y,i,o(g))},r._changes=function(y){return Mp(y,r,n,i)},r._close=function(k){i.close(),Wt.delete(n),k()},r._getRevisionTree=function(k,y){var g=Ye(i,[be],"readonly");if(g.error)return y(g.error);var h=g.txn,p=h.objectStore(be).get(k);p.onsuccess=function(w){var _=xt(w.target.result);_?y(null,_.rev_tree):y(ee(ze))}},r._doCompaction=function(k,y,g){var h=[be,Ie,Ue,bt],p=Ye(i,h,"readwrite");if(p.error)return g(p.error);var w=p.txn,_=w.objectStore(be);_.get(k).onsuccess=function(O){var M=xt(O.target.result);St(M.rev_tree,function(j,Q,U,H,J){var Y=Q+"-"+U;y.indexOf(Y)!==-1&&(J.status="missing")}),sc(y,k,w);var D=M.winningRev,z=M.deleted;w.objectStore(be).put(Qi(M,D,z))},w.onabort=nt(g),w.oncomplete=function(){g()}},r._getLocal=function(k,y){var g=Ye(i,[tt],"readonly");if(g.error)return y(g.error);var h=g.txn,p=h.objectStore(tt).get(k);p.onerror=nt(y),p.onsuccess=function(w){var _=w.target.result;_?(delete _._doc_id_rev,y(null,_)):y(ee(ze))}},r._putLocal=function(k,y,g){typeof y=="function"&&(g=y,y={}),delete k._revisions;var h=k._rev,p=k._id;h?k._rev="0-"+(parseInt(h.split("-")[1],10)+1):k._rev="0-1";var w=y.ctx,_;if(!w){var O=Ye(i,[tt],"readwrite");if(O.error)return g(O.error);w=O.txn,w.onerror=nt(g),w.oncomplete=function(){_&&g(null,_)}}var M=w.objectStore(tt),D;h?(D=M.get(p),D.onsuccess=function(z){var j=z.target.result;if(!j||j._rev!==h)g(ee(Gt));else{var Q=M.put(k);Q.onsuccess=function(){_={ok:!0,id:k._id,rev:k._rev},y.ctx&&g(null,_)}}}):(D=M.add(k),D.onerror=function(z){g(ee(Gt)),z.preventDefault(),z.stopPropagation()},D.onsuccess=function(){_={ok:!0,id:k._id,rev:k._rev},y.ctx&&g(null,_)})},r._removeLocal=function(k,y,g){typeof y=="function"&&(g=y,y={});var h=y.ctx;if(!h){var p=Ye(i,[tt],"readwrite");if(p.error)return g(p.error);h=p.txn,h.oncomplete=function(){w&&g(null,w)}}var w,_=k._id,O=h.objectStore(tt),M=O.get(_);M.onerror=nt(g),M.onsuccess=function(D){var z=D.target.result;!z||z._rev!==k._rev?g(ee(ze)):(O.delete(_),w={ok:!0,id:_,rev:"0-0"},y.ctx&&g(null,w))}},r._destroy=function(k,y){yn.removeAllListeners(n);var g=Oi.get(n);g&&g.result&&(g.result.close(),Wt.delete(n));var h=indexedDB.deleteDatabase(n);h.onsuccess=function(){Oi.delete(n),hr()&&n in localStorage&&delete localStorage[n],y(null,{ok:!0})},h.onerror=nt(y)};var b=Wt.get(n);if(b)return i=b.idb,r._meta=b.global,at(function(){e(null,r)});var S=indexedDB.open(n,kp);Oi.set(n,S),S.onupgradeneeded=function(k){var y=k.target.result;if(k.oldVersion<1)return s(y);var g=k.currentTarget.transaction;k.oldVersion<3&&c(y),k.oldVersion<4&&d(y);var h=[l,u,f,m],p=k.oldVersion;function w(){var _=h[p-1];p++,_&&_(g,w)}w()},S.onsuccess=function(k){i=k.target.result,i.onversionchange=function(){i.close(),Wt.delete(n)},i.onabort=function(D){He("error","Database has a global failure",D.target.error),a=D.target.error,i.close(),Wt.delete(n)};var y=i.transaction([Me,Pi,be],"readwrite"),g=!1,h,p,w,_;function O(){typeof w=="undefined"||!g||(r._meta={name:n,instanceId:_,blobSupport:w},Wt.set(n,{idb:i,global:r._meta}),e(null,r))}function M(){if(!(typeof p=="undefined"||typeof h=="undefined")){var D=n+"_id";D in h?_=h[D]:h[D]=_=_r(),h.docCount=p,y.objectStore(Me).put(h)}}y.objectStore(Me).get(Me).onsuccess=function(D){h=D.target.result||{id:Me},M()},$p(y,function(D){p=D,M()}),$i||($i=dp(y,Pi,"key")),$i.then(function(D){w=D,O()}),y.oncomplete=function(){g=!0,O()},y.onabort=nt(e)},S.onerror=function(k){var y=k.target.error&&k.target.error.message;y?y.indexOf("stored database is a higher version")!==-1&&(y=new Error('This DB was created with the newer "indexeddb" adapter, but you are trying to open it with the older "idb" adapter')):y="Failed to open indexedDB, are you in private browsing mode?",He("error",y),e(ee(ca,y))}}function Rp(r){r.adapter("idb",cc,!0)}function Fp(r,t){return new Promise(function(e,n){var i=0,a=0,o=0,s=r.length,l;function c(){i++,r[a++]().then(d,f)}function u(){++o===s?l?n(l):e():m()}function d(){i--,u()}function f(b){i--,l=l||b,u()}function m(){for(;i<t&&a<s;)c()}m()})}function Mi(r){let t=r.doc||r.ok,e=t&&t._attachments;e&&Object.keys(e).forEach(function(n){let i=e[n];i.data=ga(i.data,i.content_type)})}function wt(r){return/^_design/.test(r)?"_design/"+encodeURIComponent(r.slice(8)):r.startsWith("_local/")?"_local/"+encodeURIComponent(r.slice(7)):encodeURIComponent(r)}function bl(r){return!r._attachments||!Object.keys(r._attachments)?Promise.resolve():Promise.all(Object.keys(r._attachments).map(function(t){let e=r._attachments[t];if(e.data&&typeof e.data!="string")return new Promise(function(n){ma(e.data,n)}).then(function(n){e.data=n})}))}function jp(r){if(!r.prefix)return!1;let t=jl(r.prefix).protocol;return t==="http"||t==="https"}function zp(r,t){if(jp(t)){let i=t.name.substr(t.prefix.length);r=t.prefix.replace(/\/?$/,"/")+encodeURIComponent(i)}let e=jl(r);(e.user||e.password)&&(e.auth={username:e.user,password:e.password});let n=e.path.replace(/(^\/|\/$)/g,"").split("/");return e.db=n.pop(),e.db.indexOf("%")===-1&&(e.db=encodeURIComponent(e.db)),e.path=n.join("/"),e}function Se(r,t){return dr(r,r.db+"/"+t)}function dr(r,t){let e=r.path?"/":"";return r.protocol+"://"+r.host+(r.port?":"+r.port:"")+"/"+r.path+e+t}function cr(r){let t=Object.keys(r);return t.length===0?"":"?"+t.map(e=>e+"="+encodeURIComponent(r[e])).join("&")}function Up(r){let t=typeof navigator!="undefined"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",e=t.indexOf("msie")!==-1,n=t.indexOf("trident")!==-1,i=t.indexOf("edge")!==-1,a=!("method"in r)||r.method==="GET";return(e||n||i)&&a}function ea(r,t){let e=this,n=zp(r.name,r),i=Se(n,"");r=Ce(r);let a=async function(d,f){if(f=f||{},f.headers=f.headers||new Vt,f.credentials="include",r.auth||n.auth){let S=r.auth||n.auth,k=S.username+":"+S.password,y=_n(unescape(encodeURIComponent(k)));f.headers.set("Authorization","Basic "+y)}let m=r.headers||{};return Object.keys(m).forEach(function(S){f.headers.append(S,m[S])}),Up(f)&&(d+=(d.indexOf("?")===-1?"?":"&")+"_nonce="+Date.now()),await(r.fetch||Zl)(d,f)};function o(d,f){return ye(d,function(...m){c().then(function(){return f.apply(this,m)}).catch(function(b){m.pop()(b)})}).bind(e)}async function s(d,f){let m={};f=f||{},f.headers=f.headers||new Vt,f.headers.get("Content-Type")||f.headers.set("Content-Type","application/json"),f.headers.get("Accept")||f.headers.set("Accept","application/json");let b=await a(d,f);m.ok=b.ok,m.status=b.status;let S=await b.json();if(m.data=S,!m.ok)throw m.data.status=m.status,Jt(m.data);return Array.isArray(m.data)&&(m.data=m.data.map(function(k){return k.error||k.missing?Jt(k):k})),m}let l;async function c(){return r.skip_setup?Promise.resolve():l||(l=s(i).catch(function(d){return d&&d.status&&d.status===404?(ji(404,"PouchDB is just detecting if the remote exists."),s(i,{method:"PUT"})):Promise.reject(d)}).catch(function(d){return d&&d.status&&d.status===412?!0:Promise.reject(d)}),l.catch(function(){l=null}),l)}at(function(){t(null,e)}),e._remote=!0,e.type=function(){return"http"},e.id=o("id",async function(d){let f;try{f=await(await a(dr(n,""))).json()}catch(b){f={}}let m=f&&f.uuid?f.uuid+n.db:Se(n,"");d(null,m)}),e.compact=o("compact",async function(d,f){typeof d=="function"&&(f=d,d={}),d=Ce(d),await s(Se(n,"_compact"),{method:"POST"});function m(){e.info(function(b,S){S&&!S.compact_running?f(null,{ok:!0}):setTimeout(m,d.interval||200)})}m()}),e.bulkGet=ye("bulkGet",function(d,f){let m=this;async function b(g){let h={};d.revs&&(h.revs=!0),d.attachments&&(h.attachments=!0),d.latest&&(h.latest=!0);try{let p=await s(Se(n,"_bulk_get"+cr(h)),{method:"POST",body:JSON.stringify({docs:d.docs})});d.attachments&&d.binary&&p.data.results.forEach(function(w){w.docs.forEach(Mi)}),g(null,p.data)}catch(p){g(p)}}function S(){let g=qp,h=Math.ceil(d.docs.length/g),p=0,w=new Array(h);function _(O){return function(M,D){w[O]=D.results,++p===h&&f(null,{results:w.flat()})}}for(let O=0;O<h;O++){let M=xn(d,["revs","attachments","binary","latest"]);M.docs=d.docs.slice(O*g,Math.min(d.docs.length,(O+1)*g)),Fl(m,M,_(O))}}let k=dr(n,""),y=Di[k];typeof y!="boolean"?b(function(g,h){g?(Di[k]=!1,ji(g.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),S()):(Di[k]=!0,f(null,h))}):y?b(f):S()}),e._info=async function(d){try{await c();let m=await(await a(Se(n,""))).json();m.host=Se(n,""),d(null,m)}catch(f){d(f)}},e.fetch=async function(d,f){await c();let m=d.substring(0,1)==="/"?dr(n,d.substring(1)):Se(n,d);return a(m,f)},e.get=o("get",async function(d,f,m){typeof f=="function"&&(m=f,f={}),f=Ce(f);let b={};f.revs&&(b.revs=!0),f.revs_info&&(b.revs_info=!0),f.latest&&(b.latest=!0),f.open_revs&&(f.open_revs!=="all"&&(f.open_revs=JSON.stringify(f.open_revs)),b.open_revs=f.open_revs),f.rev&&(b.rev=f.rev),f.conflicts&&(b.conflicts=f.conflicts),f.update_seq&&(b.update_seq=f.update_seq),d=wt(d);function S(g){let h=g._attachments,p=h&&Object.keys(h);if(!h||!p.length)return;async function w(O){let M=h[O],D=wt(g._id)+"/"+u(O)+"?rev="+g._rev,z=await a(Se(n,D)),j;"buffer"in z?j=await z.buffer():j=await z.blob();let Q;if(f.binary){let U=Object.getOwnPropertyDescriptor(j.__proto__,"type");(!U||U.set)&&(j.type=M.content_type),Q=j}else Q=await new Promise(function(U){ma(j,U)});delete M.stub,delete M.length,M.data=Q}let _=p.map(function(O){return function(){return w(O)}});return Fp(_,5)}function k(g){return Array.isArray(g)?Promise.all(g.map(function(h){if(h.ok)return S(h.ok)})):S(g)}let y=Se(n,d+cr(b));try{let g=await s(y);f.attachments&&await k(g.data),m(null,g.data)}catch(g){g.docId=d,m(g)}}),e.remove=o("remove",async function(d,f,m,b){let S;typeof f=="string"?(S={_id:d,_rev:f},typeof m=="function"&&(b=m,m={})):(S=d,typeof f=="function"?(b=f,m={}):(b=m,m=f));let k=S._rev||m.rev,y=Se(n,wt(S._id))+"?rev="+k;try{let g=await s(y,{method:"DELETE"});b(null,g.data)}catch(g){b(g)}});function u(d){return d.split("/").map(encodeURIComponent).join("/")}e.getAttachment=o("getAttachment",async function(d,f,m,b){typeof m=="function"&&(b=m,m={});let S=m.rev?"?rev="+m.rev:"",k=Se(n,wt(d))+"/"+u(f)+S,y;try{let g=await a(k,{method:"GET"});if(!g.ok)throw g;y=g.headers.get("content-type");let h;if(typeof process!="undefined"&&!process.browser&&typeof g.buffer=="function"?h=await g.buffer():h=await g.blob(),typeof process!="undefined"&&!process.browser){let p=Object.getOwnPropertyDescriptor(h.__proto__,"type");(!p||p.set)&&(h.type=y)}b(null,h)}catch(g){b(g)}}),e.removeAttachment=o("removeAttachment",async function(d,f,m,b){let S=Se(n,wt(d)+"/"+u(f))+"?rev="+m;try{let k=await s(S,{method:"DELETE"});b(null,k.data)}catch(k){b(k)}}),e.putAttachment=o("putAttachment",async function(d,f,m,b,S,k){typeof S=="function"&&(k=S,S=b,b=m,m=null);let y=wt(d)+"/"+u(f),g=Se(n,y);if(m&&(g+="?rev="+m),typeof b=="string"){let h;try{h=fa(b)}catch(p){return k(ee(ql,"Attachment is not a valid base64 string"))}b=h?pa(h,S):""}try{let h=await s(g,{headers:new Vt({"Content-Type":S}),method:"PUT",body:b});k(null,h.data)}catch(h){k(h)}}),e._bulkDocs=async function(d,f,m){d.new_edits=f.new_edits;try{await c(),await Promise.all(d.docs.map(bl));let b=await s(Se(n,"_bulk_docs"),{method:"POST",body:JSON.stringify(d)});m(null,b.data)}catch(b){m(b)}},e._put=async function(d,f,m){try{await c(),await bl(d);let b=await s(Se(n,wt(d._id)),{method:"PUT",body:JSON.stringify(d)});m(null,b.data)}catch(b){b.docId=d&&d._id,m(b)}},e.allDocs=o("allDocs",async function(d,f){typeof d=="function"&&(f=d,d={}),d=Ce(d);let m={},b,S="GET";d.conflicts&&(m.conflicts=!0),d.update_seq&&(m.update_seq=!0),d.descending&&(m.descending=!0),d.include_docs&&(m.include_docs=!0),d.attachments&&(m.attachments=!0),d.key&&(m.key=JSON.stringify(d.key)),d.start_key&&(d.startkey=d.start_key),d.startkey&&(m.startkey=JSON.stringify(d.startkey)),d.end_key&&(d.endkey=d.end_key),d.endkey&&(m.endkey=JSON.stringify(d.endkey)),typeof d.inclusive_end!="undefined"&&(m.inclusive_end=!!d.inclusive_end),typeof d.limit!="undefined"&&(m.limit=d.limit),typeof d.skip!="undefined"&&(m.skip=d.skip);let k=cr(m);typeof d.keys!="undefined"&&(S="POST",b={keys:d.keys});try{let y=await s(Se(n,"_all_docs"+k),{method:S,body:JSON.stringify(b)});d.include_docs&&d.attachments&&d.binary&&y.data.rows.forEach(Mi),f(null,y.data)}catch(y){f(y)}}),e._changes=function(d){let f="batch_size"in d?d.batch_size:Bp;d=Ce(d),d.continuous&&!("heartbeat"in d)&&(d.heartbeat=Np);let m="timeout"in d?d.timeout:30*1e3;"timeout"in d&&d.timeout&&m-d.timeout<lr&&(m=d.timeout+lr),"heartbeat"in d&&d.heartbeat&&m-d.heartbeat<lr&&(m=d.heartbeat+lr);let b={};"timeout"in d&&d.timeout&&(b.timeout=d.timeout);let S=typeof d.limit!="undefined"?d.limit:!1,k=S;if(d.style&&(b.style=d.style),(d.include_docs||d.filter&&typeof d.filter=="function")&&(b.include_docs=!0),d.attachments&&(b.attachments=!0),d.continuous&&(b.feed="longpoll"),d.seq_interval&&(b.seq_interval=d.seq_interval),d.conflicts&&(b.conflicts=!0),d.descending&&(b.descending=!0),d.update_seq&&(b.update_seq=!0),"heartbeat"in d&&d.heartbeat&&(b.heartbeat=d.heartbeat),d.filter&&typeof d.filter=="string"&&(b.filter=d.filter),d.view&&typeof d.view=="string"&&(b.filter="_view",b.view=d.view),d.query_params&&typeof d.query_params=="object")for(let M in d.query_params)Object.prototype.hasOwnProperty.call(d.query_params,M)&&(b[M]=d.query_params[M]);let y="GET",g;d.doc_ids?(b.filter="_doc_ids",y="POST",g={doc_ids:d.doc_ids}):d.selector&&(b.filter="_selector",y="POST",g={selector:d.selector});let h=new AbortController,p,w=async function(M,D){if(d.aborted)return;b.since=M,typeof b.since=="object"&&(b.since=JSON.stringify(b.since)),d.descending?S&&(b.limit=k):b.limit=!S||k>f?f:k;let z=Se(n,"_changes"+cr(b)),j={signal:h.signal,method:y,body:JSON.stringify(g)};if(p=M,!d.aborted)try{await c();let Q=await s(z,j);D(null,Q.data)}catch(Q){D(Q)}},_={results:[]},O=function(M,D){if(d.aborted)return;let z=0;if(D&&D.results){z=D.results.length,_.last_seq=D.last_seq;let Q=null,U=null;typeof D.pending=="number"&&(Q=D.pending),(typeof _.last_seq=="string"||typeof _.last_seq=="number")&&(U=_.last_seq);let H={};H.query=d.query_params,D.results=D.results.filter(function(J){k--;let Y=ua(d)(J);return Y&&(d.include_docs&&d.attachments&&d.binary&&Mi(J),d.return_docs&&_.results.push(J),d.onChange(J,Q,U)),Y})}else if(M){d.aborted=!0,d.complete(M);return}D&&D.last_seq&&(p=D.last_seq);let j=S&&k<=0||D&&z<f||d.descending;d.continuous&&!(S&&k<=0)||!j?at(function(){w(p,O)}):d.complete(null,_)};return w(d.since||0,O),{cancel:function(){d.aborted=!0,h.abort()}}},e.revsDiff=o("revsDiff",async function(d,f,m){typeof f=="function"&&(m=f,f={});try{let b=await s(Se(n,"_revs_diff"),{method:"POST",body:JSON.stringify(d)});m(null,b.data)}catch(b){m(b)}}),e._close=function(d){d()},e._destroy=async function(d,f){try{let m=await s(Se(n,""),{method:"DELETE"});f(null,m)}catch(m){m.status===404?f(null,{ok:!0}):f(m)}}}function Hp(r){r.adapter("http",ea,!1),r.adapter("https",ea,!1)}function uc(r,t){return t&&r.then(function(e){at(function(){t(null,e)})},function(e){at(function(){t(e)})}),r}function Wp(r){return function(...t){var e=t.pop(),n=r.apply(this,t);return typeof e=="function"&&uc(n,e),n}}function Vp(r,t){return r.then(function(e){return t().then(function(){return e})},function(e){return t().then(function(){throw e})})}function Li(r,t){return function(){var e=arguments,n=this;return r.add(function(){return t.apply(n,e)})}}function xl(r){var t=new Set(r),e=new Array(t.size),n=-1;return t.forEach(function(i){e[++n]=i}),e}function Ri(r){var t=new Array(r.size),e=-1;return r.forEach(function(n,i){t[++e]=i}),t}function _l(r){var t="builtin "+r+" function requires map values to be numbers or number arrays";return new Zt(t)}function ta(r){for(var t=0,e=0,n=r.length;e<n;e++){var i=r[e];if(typeof i!="number")if(Array.isArray(i)){t=typeof t=="number"?[t]:t;for(var a=0,o=i.length;a<o;a++){var s=i[a];if(typeof s!="number")throw _l("_sum");typeof t[a]=="undefined"?t.push(s):t[a]+=s}}else throw _l("_sum");else typeof t=="number"?t+=i:t[0]+=i}return t}function dc(r,t){return da("return ("+r.replace(/;\s*$/,"")+");",{emit:t,sum:ta,log:Kp,isArray:Gp,toJSON:Jp})}function kl(r){if(!r)return"undefined";switch(typeof r){case"function":return r.toString();case"string":return r.toString();default:return JSON.stringify(r)}}function Qp(r,t){return kl(r)+kl(t)+"undefined"}async function Sl(r,t,e,n,i,a){let o=Qp(e,n),s;if(!i&&(s=r._cachedViews=r._cachedViews||{},s[o]))return s[o];let l=r.info().then(async function(c){let u=c.db_name+"-mrview-"+(i?"temp":Hl(o));function d(k){k.views=k.views||{};let y=t;y.indexOf("/")===-1&&(y=t+"/"+t);let g=k.views[y]=k.views[y]||{};if(!g[u])return g[u]=!0,k}await pr(r,"_local/"+a,d);let m=(await r.registerDependentDatabase(u)).db;m.auto_compaction=!0;let b={name:u,db:m,sourceDB:r,adapter:r.adapter,mapFun:e,reduceFun:n},S;try{S=await b.db.get("_local/lastSeq")}catch(k){if(k.status!==404)throw k}return b.seq=S?S.seq:0,s&&b.db.once("destroyed",function(){delete s[o]}),b});return s&&(s[o]=l),l}function Fi(r){return r.indexOf("/")===-1?[r,r]:r.split("/")}function Yp(r){return r.length===1&&/^1-/.test(r[0].rev)}function Tl(r,t,e){try{r.emit("error",t)}catch(n){He("error",`The user's map/reduce function threw an uncaught error.
You can debug this error by doing:
myDatabase.on('error', function (err) { debugger; });
Please double-check your map/reduce function.`),He("error",t,e)}}function Xp(r,t,e,n){function i(v,x,C){try{x(C)}catch(E){Tl(v,E,{fun:x,doc:C})}}function a(v,x,C,E,P){try{return{output:x(C,E,P)}}catch(R){return Tl(v,R,{fun:x,keys:C,values:E,rereduce:P}),{error:R}}}function o(v,x){let C=we(v.key,x.key);return C!==0?C:we(v.value,x.value)}function s(v,x,C){return C=C||0,typeof x=="number"?v.slice(C,x+C):C>0?v.slice(C):v}function l(v){let x=v.value;return x&&typeof x=="object"&&x._id||v.id}function c(v){for(let x of v.rows){let C=x.doc&&x.doc._attachments;if(C)for(let E of Object.keys(C)){let P=C[E];C[E].data=ga(P.data,P.content_type)}}}function u(v){return function(x){return v.include_docs&&v.attachments&&v.binary&&c(x),x}}function d(v,x,C,E){let P=x[v];typeof P!="undefined"&&(E&&(P=encodeURIComponent(JSON.stringify(P))),C.push(v+"="+P))}function f(v){if(typeof v!="undefined"){let x=Number(v);return!isNaN(x)&&x===parseInt(v,10)?x:v}}function m(v){return v.group_level=f(v.group_level),v.limit=f(v.limit),v.skip=f(v.skip),v}function b(v){if(v){if(typeof v!="number")return new lt(`Invalid value for integer: "${v}"`);if(v<0)return new lt(`Invalid value for positive integer: "${v}"`)}}function S(v,x){let C=v.descending?"endkey":"startkey",E=v.descending?"startkey":"endkey";if(typeof v[C]!="undefined"&&typeof v[E]!="undefined"&&we(v[C],v[E])>0)throw new lt("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(x.reduce&&v.reduce!==!1){if(v.include_docs)throw new lt("{include_docs:true} is invalid for reduce");if(v.keys&&v.keys.length>1&&!v.group&&!v.group_level)throw new lt("Multi-key fetches for reduce views must use {group: true}")}for(let P of["group_level","limit","skip"]){let R=b(v[P]);if(R)throw R}}async function k(v,x,C){let E=[],P,R="GET",N;if(d("reduce",C,E),d("include_docs",C,E),d("attachments",C,E),d("limit",C,E),d("descending",C,E),d("group",C,E),d("group_level",C,E),d("skip",C,E),d("stale",C,E),d("conflicts",C,E),d("startkey",C,E,!0),d("start_key",C,E,!0),d("endkey",C,E,!0),d("end_key",C,E,!0),d("inclusive_end",C,E),d("key",C,E,!0),d("update_seq",C,E),E=E.join("&"),E=E===""?"":"?"+E,typeof C.keys!="undefined"){let L=`keys=${encodeURIComponent(JSON.stringify(C.keys))}`;L.length+E.length+1<=2e3?E+=(E[0]==="?"?"&":"?")+L:(R="POST",typeof x=="string"?P={keys:C.keys}:x.keys=C.keys)}if(typeof x=="string"){let I=Fi(x),L=await v.fetch("_design/"+I[0]+"/_view/"+I[1]+E,{headers:new Vt({"Content-Type":"application/json"}),method:R,body:JSON.stringify(P)});N=L.ok;let B=await L.json();if(!N)throw B.status=L.status,Jt(B);for(let q of B.rows)if(q.value&&q.value.error&&q.value.error==="builtin_reduce_error")throw new Error(q.reason);return new Promise(function(q){q(B)}).then(u(C))}P=P||{};for(let I of Object.keys(x))Array.isArray(x[I])?P[I]=x[I]:P[I]=x[I].toString();let $=await v.fetch("_temp_view"+E,{headers:new Vt({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(P)});N=$.ok;let T=await $.json();if(!N)throw T.status=$.status,Jt(T);return new Promise(function(I){I(T)}).then(u(C))}function y(v,x,C){return new Promise(function(E,P){v._query(x,C,function(R,N){if(R)return P(R);E(N)})})}function g(v){return new Promise(function(x,C){v._viewCleanup(function(E,P){if(E)return C(E);x(P)})})}function h(v){return function(x){if(x.status===404)return v;throw x}}async function p(v,x,C){let E="_local/doc_"+v,P={_id:E,keys:[]},R=C.get(v),N=R[0],$=R[1];function T(){return Yp($)?Promise.resolve(P):x.db.get(E).catch(h(P))}function I(te){return te.keys.length?x.db.allDocs({keys:te.keys,include_docs:!0}):Promise.resolve({rows:[]})}function L(te,ae){let ue=[],ke=new Set;for(let V of ae.rows){let W=V.doc;if(W&&(ue.push(W),ke.add(W._id),W._deleted=!N.has(W._id),!W._deleted)){let K=N.get(W._id);"value"in K&&(W.value=K.value)}}let Oe=Ri(N);for(let V of Oe)if(!ke.has(V)){let W={_id:V},K=N.get(V);"value"in K&&(W.value=K.value),ue.push(W)}return te.keys=xl(Oe.concat(te.keys)),ue.push(te),ue}let B=await T(),q=await I(B);return L(B,q)}function w(v){return v.sourceDB.get("_local/purges").then(function(x){let C=x.purgeSeq;return v.db.get("_local/purgeSeq").then(function(E){return E._rev}).catch(h(void 0)).then(function(E){return v.db.put({_id:"_local/purgeSeq",_rev:E,purgeSeq:C})})}).catch(function(x){if(x.status!==404)throw x})}function _(v,x,C){var E="_local/lastSeq";return v.db.get(E).catch(h({_id:E,seq:0})).then(function(P){var R=Ri(x);return Promise.all(R.map(function(N){return p(N,v,x)})).then(function(N){var $=N.flat();return P.seq=C,$.push(P),v.db.bulkDocs({docs:$})}).then(()=>w(v))})}function O(v){let x=typeof v=="string"?v:v.name,C=Cl[x];return C||(C=Cl[x]=new bn),C}async function M(v,x){return Li(O(v),function(){return D(v,x)})()}async function D(v,x){let C,E,P;function R(V,W){let K={id:E._id,key:Ct(V)};typeof W!="undefined"&&W!==null&&(K.value=Ct(W)),C.push(K)}let N=t(v.mapFun,R),$=v.seq||0;function T(){return v.sourceDB.info().then(function(V){P=v.sourceDB.activeTasks.add({name:"view_indexing",total_items:V.update_seq-$})})}function I(V,W){return function(){return _(v,V,W)}}let L=0,B={view:v.name,indexed_docs:L};v.sourceDB.emit("indexing",B);let q=new bn;async function te(){let V=await v.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:$,limit:x.changes_batch_size}),W=await ae();return ue(V,W)}function ae(){return v.db.get("_local/purgeSeq").then(function(V){return V.purgeSeq}).catch(h(-1)).then(function(V){return v.sourceDB.get("_local/purges").then(function(W){let K=W.purges.filter(function(ge,ie){return ie>V}).map(ge=>ge.docId),me=K.filter(function(ge,ie){return K.indexOf(ge)===ie});return Promise.all(me.map(function(ge){return v.sourceDB.get(ge).then(function(ie){return{docId:ge,doc:ie}}).catch(h({docId:ge}))}))}).catch(h([]))})}function ue(V,W){let K=V.results;if(!K.length&&!W.length)return;for(let ie of W)if(K.findIndex(function(Ge){return Ge.id===ie.docId})<0){let Ge={_id:ie.docId,doc:{_id:ie.docId,_deleted:1},changes:[]};ie.doc&&(Ge.doc=ie.doc,Ge.changes.push({rev:ie.doc._rev})),K.push(Ge)}let me=ke(K);q.add(I(me,$)),L=L+K.length;let ge={view:v.name,last_seq:V.last_seq,results_count:K.length,indexed_docs:L};if(v.sourceDB.emit("indexing",ge),v.sourceDB.activeTasks.update(P,{completed_items:L}),!(K.length<x.changes_batch_size))return te()}function ke(V){let W=new Map;for(let K of V){if(K.doc._id[0]!=="_"){C=[],E=K.doc,E._deleted||i(v.sourceDB,N,E),C.sort(o);let me=Oe(C);W.set(K.doc._id,[me,K.changes])}$=K.seq}return W}function Oe(V){let W=new Map,K;for(let me=0,ge=V.length;me<ge;me++){let ie=V[me],mt=[ie.key,ie.id];me>0&&we(ie.key,K)===0&&mt.push(me),W.set(Ze(mt),ie),K=ie.key}return W}try{await T(),await te(),await q.finish(),v.seq=$,v.sourceDB.activeTasks.remove(P)}catch(V){v.sourceDB.activeTasks.remove(P,V)}}function z(v,x,C){C.group_level===0&&delete C.group_level;let E=C.group||C.group_level,P=e(v.reduceFun),R=[],N=isNaN(C.group_level)?Number.POSITIVE_INFINITY:C.group_level;for(let $ of x){let T=R[R.length-1],I=E?$.key:null;if(E&&Array.isArray(I)&&(I=I.slice(0,N)),T&&we(T.groupKey,I)===0){T.keys.push([$.key,$.id]),T.values.push($.value);continue}R.push({keys:[[$.key,$.id]],values:[$.value],groupKey:I})}x=[];for(let $ of R){let T=a(v.sourceDB,P,$.keys,$.values,!1);if(T.error&&T.error instanceof Zt)throw T.error;x.push({value:T.error?null:T.output,key:$.groupKey})}return{rows:s(x,C.limit,C.skip)}}function j(v,x){return Li(O(v),function(){return Q(v,x)})()}async function Q(v,x){let C,E=v.reduceFun&&x.reduce!==!1,P=x.skip||0;typeof x.keys!="undefined"&&!x.keys.length&&(x.limit=0,delete x.keys);async function R($){$.include_docs=!0;let T=await v.db.allDocs($);return C=T.total_rows,T.rows.map(function(I){if("value"in I.doc&&typeof I.doc.value=="object"&&I.doc.value!==null){let B=Object.keys(I.doc.value).sort(),q=["id","key","value"];if(!(B<q||B>q))return I.doc.value}let L=Hh(I.doc._id);return{key:L[0],id:L[1],value:"value"in I.doc?I.doc.value:null}})}async function N($){let T;if(E?T=z(v,$,x):typeof x.keys=="undefined"?T={total_rows:C,offset:P,rows:$}:T={total_rows:C,offset:P,rows:s($,x.limit,x.skip)},x.update_seq&&(T.update_seq=v.seq),x.include_docs){let I=xl($.map(l)),L=await v.sourceDB.allDocs({keys:I,include_docs:!0,conflicts:x.conflicts,attachments:x.attachments,binary:x.binary}),B=new Map;for(let q of L.rows)B.set(q.id,q.doc);for(let q of $){let te=l(q),ae=B.get(te);ae&&(q.doc=ae)}}return T}if(typeof x.keys!="undefined"){let T=x.keys.map(function(B){let q={startkey:Ze([B]),endkey:Ze([B,{}])};return x.update_seq&&(q.update_seq=!0),R(q)}),L=(await Promise.all(T)).flat();return N(L)}else{let $={descending:x.descending};x.update_seq&&($.update_seq=!0);let T,I;if("start_key"in x&&(T=x.start_key),"startkey"in x&&(T=x.startkey),"end_key"in x&&(I=x.end_key),"endkey"in x&&(I=x.endkey),typeof T!="undefined"&&($.startkey=x.descending?Ze([T,{}]):Ze([T])),typeof I!="undefined"){let B=x.inclusive_end!==!1;x.descending&&(B=!B),$.endkey=Ze(B?[I,{}]:[I])}if(typeof x.key!="undefined"){let B=Ze([x.key]),q=Ze([x.key,{}]);$.descending?($.endkey=B,$.startkey=q):($.startkey=B,$.endkey=q)}E||(typeof x.limit=="number"&&($.limit=x.limit),$.skip=P);let L=await R($);return N(L)}}async function U(v){return(await v.fetch("_view_cleanup",{headers:new Vt({"Content-Type":"application/json"}),method:"POST"})).json()}async function H(v){try{let x=await v.get("_local/"+r),C=new Map;for(let T of Object.keys(x.views)){let I=Fi(T),L="_design/"+I[0],B=I[1],q=C.get(L);q||(q=new Set,C.set(L,q)),q.add(B)}let E={keys:Ri(C),include_docs:!0},P=await v.allDocs(E),R={};for(let T of P.rows){let I=T.key.substring(8);for(let L of C.get(T.key)){let B=I+"/"+L;x.views[B]||(B=L);let q=Object.keys(x.views[B]),te=T.doc&&T.doc.views&&T.doc.views[L];for(let ae of q)R[ae]=R[ae]||te}}let $=Object.keys(R).filter(function(T){return!R[T]}).map(function(T){return Li(O(T),function(){return new v.constructor(T,v.__opts).destroy()})()});return Promise.all($).then(function(){return{ok:!0}})}catch(x){if(x.status===404)return{ok:!0};throw x}}async function J(v,x,C){if(typeof v._query=="function")return y(v,x,C);if(rt(v))return k(v,x,C);let E={changes_batch_size:v.__opts.view_update_changes_batch_size||Zp};if(typeof x!="string")return S(C,x),El.add(async function(){let P=await Sl(v,"temp_view/temp_view",x.map,x.reduce,!0,r);return Vp(M(P,E).then(function(){return j(P,C)}),function(){return P.db.destroy()})}),El.finish();{let P=x,R=Fi(P),N=R[0],$=R[1],T=await v.get("_design/"+N);if(x=T.views&&T.views[$],!x)throw new Qt(`ddoc ${T._id} has no view named ${$}`);n(T,$),S(C,x);let I=await Sl(v,P,x.map,x.reduce,!1,r);return C.stale==="ok"||C.stale==="update_after"?(C.stale==="update_after"&&at(function(){M(I,E)}),j(I,C)):(await M(I,E),j(I,C))}}function Y(v,x,C){let E=this;typeof x=="function"&&(C=x,x={}),x=x?m(x):{},typeof v=="function"&&(v={map:v});let P=Promise.resolve().then(function(){return J(E,v,x)});return uc(P,C),P}let re=Wp(function(){let v=this;return typeof v._viewCleanup=="function"?g(v):rt(v)?U(v):H(v)});return{query:Y,viewCleanup:re}}function eg(r){if(/^_sum/.test(r))return Bi._sum;if(/^_count/.test(r))return Bi._count;if(/^_stats/.test(r))return Bi._stats;if(/^_/.test(r))throw new Error(r+" is not a supported reduce function.")}function tg(r,t){if(typeof r=="function"&&r.length===2){var e=r;return function(n){return e(n,t)}}else return dc(r.toString(),t)}function ng(r){var t=r.toString(),e=eg(t);return e||dc(t)}function rg(r,t){var e=r.views&&r.views[t];if(typeof e.map!="string")throw new Qt("ddoc "+r._id+" has no string view named "+t+", instead found object of type: "+typeof e.map)}function ag(r,t,e){return fc.query.call(this,r,t,e)}function og(r){return fc.viewCleanup.call(this,r)}function lg(r,t,e){return!r._attachments||!r._attachments[e]||r._attachments[e].digest!==t._attachments[e].digest}function Al(r,t){var e=Object.keys(t._attachments);return Promise.all(e.map(function(n){return r.getAttachment(t._id,n,{rev:t._rev})}))}function cg(r,t,e){var n=rt(t)&&!rt(r),i=Object.keys(e._attachments);return n?r.get(e._id).then(function(a){return Promise.all(i.map(function(o){return lg(a,e,o)?t.getAttachment(e._id,o):r.getAttachment(a._id,o)}))}).catch(function(a){if(a.status!==404)throw a;return Al(t,e)}):Al(t,e)}function ug(r){var t=[];return Object.keys(r).forEach(function(e){var n=r[e].missing;n.forEach(function(i){t.push({id:e,rev:i})})}),{docs:t,revs:!0,latest:!0}}function dg(r,t,e,n){e=Ce(e);var i=[],a=!0;function o(){var l=ug(e);if(l.docs.length)return r.bulkGet(l).then(function(c){if(n.cancelled)throw new Error("cancelled");return Promise.all(c.results.map(function(u){return Promise.all(u.docs.map(function(d){var f=d.ok;return d.error&&(a=!1),!f||!f._attachments?f:cg(t,r,f).then(m=>{var b=Object.keys(f._attachments);return m.forEach(function(S,k){var y=f._attachments[b[k]];delete y.stub,delete y.length,y.data=S}),f})}))})).then(function(u){i=i.concat(u.flat().filter(Boolean))})})}function s(){return{ok:a,docs:i}}return Promise.resolve().then(o).then(s)}function na(r,t,e,n,i){return r.get(t).catch(function(a){if(a.status===404)return(r.adapter==="http"||r.adapter==="https")&&ji(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:n,_id:t,history:[],replicator:Pl,version:Il};throw a}).then(function(a){if(!i.cancelled&&a.last_seq!==e)return a.history=(a.history||[]).filter(function(o){return o.session_id!==n}),a.history.unshift({last_seq:e,session_id:n}),a.history=a.history.slice(0,fg),a.version=Il,a.replicator=Pl,a.session_id=n,a.last_seq=e,r.put(a).catch(function(o){if(o.status===409)return na(r,t,e,n,i);throw o})})}function hg(r,t){return r.session_id===t.session_id?{last_seq:r.last_seq,history:r.history}:hc(r.history,t.history)}function hc(r,t){var e=r[0],n=r.slice(1),i=t[0],a=t.slice(1);if(!e||t.length===0)return{last_seq:Qe,history:[]};var o=e.session_id;if(ra(o,t))return{last_seq:e.last_seq,history:r};var s=i.session_id;return ra(s,n)?{last_seq:i.last_seq,history:a}:hc(n,a)}function ra(r,t){var e=t[0],n=t.slice(1);return!r||t.length===0?!1:r===e.session_id?!0:ra(r,n)}function Ol(r){return typeof r.status=="number"&&Math.floor(r.status/100)===4}function pc(r,t,e,n,i){return this instanceof wr?pc:new wr(r,t,e,n,i)}function pg(r,t,e,n){if(r.retry===!1){t.emit("error",e),t.removeAllListeners();return}if(typeof r.back_off_function!="function"&&(r.back_off_function=Nf),t.emit("requestError",e),t.state==="active"||t.state==="pending"){t.emit("paused",e),t.state="stopped";var i=function(){r.current_back_off=Dl},a=function(){t.removeListener("active",i)};t.once("paused",a),t.once("active",i)}r.current_back_off=r.current_back_off||Dl,r.current_back_off=r.back_off_function(r.current_back_off),setTimeout(n,r.current_back_off)}function gg(r){return Object.keys(r).sort(we).reduce(function(t,e){return t[e]=r[e],t},{})}function mg(r,t,e){var n=e.doc_ids?e.doc_ids.sort(we):"",i=e.filter?e.filter.toString():"",a="",o="",s="";return e.selector&&(s=JSON.stringify(e.selector)),e.filter&&e.query_params&&(a=JSON.stringify(gg(e.query_params))),e.filter&&e.filter==="_view"&&(o=e.view.toString()),Promise.all([r.id(),t.id()]).then(function(l){var c=l[0]+l[1]+i+o+a+n+s;return new Promise(function(u){va(c,u)})}).then(function(l){return l=l.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+l})}function gc(r,t,e,n,i){var a=[],o,s={seq:0,changes:[],docs:[]},l=!1,c=!1,u=!1,d=0,f=0,m=e.continuous||e.live||!1,b=e.batch_size||100,S=e.batches_limit||10,k=e.style||"all_docs",y=!1,g=e.doc_ids,h=e.selector,p,w,_=[],O=_r(),M;i=i||{ok:!0,start_time:new Date().toISOString(),docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var D={};n.ready(r,t);function z(){return w?Promise.resolve():mg(r,t,e).then(function(T){p=T;var I={};e.checkpoint===!1?I={writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:e.checkpoint==="source"?I={writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:e.checkpoint==="target"?I={writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:I={writeSourceCheckpoint:!0,writeTargetCheckpoint:!0},w=new pc(r,t,p,n,I)})}function j(){if(_=[],o.docs.length!==0){var T=o.docs,I={timeout:e.timeout};return t.bulkDocs({docs:T,new_edits:!1},I).then(function(L){if(n.cancelled)throw v(),new Error("cancelled");var B=Object.create(null);L.forEach(function(te){te.error&&(B[te.id]=te)});var q=Object.keys(B).length;i.doc_write_failures+=q,i.docs_written+=T.length-q,T.forEach(function(te){var ae=B[te._id];if(ae){i.errors.push(ae);var ue=(ae.name||"").toLowerCase();if(ue==="unauthorized"||ue==="forbidden")n.emit("denied",Ce(ae));else throw ae}else _.push(te)})},function(L){throw i.doc_write_failures+=T.length,L})}}function Q(){if(o.error)throw new Error("There was a problem getting docs.");i.last_seq=f=o.seq;var T=Ce(i);return _.length&&(T.docs=_,typeof o.pending=="number"&&(T.pending=o.pending,delete o.pending),n.emit("change",T)),l=!0,r.info().then(function(I){var L=r.activeTasks.get(M);if(!(!o||!L)){var B=L.completed_items||0,q=parseInt(I.update_seq,10)-parseInt(d,10);r.activeTasks.update(M,{completed_items:B+o.changes.length,total_items:q})}}),w.writeCheckpoint(o.seq,O).then(function(){if(n.emit("checkpoint",{checkpoint:o.seq}),l=!1,n.cancelled)throw v(),new Error("cancelled");o=void 0,P()}).catch(function(I){throw $(I),I})}function U(){var T={};return o.changes.forEach(function(I){n.emit("checkpoint",{revs_diff:I}),I.id!=="_user/"&&(T[I.id]=I.changes.map(function(L){return L.rev}))}),t.revsDiff(T).then(function(I){if(n.cancelled)throw v(),new Error("cancelled");o.diffs=I})}function H(){return dg(r,t,o.diffs,n).then(function(T){o.error=!T.ok,T.docs.forEach(function(I){delete o.diffs[I._id],i.docs_read++,o.docs.push(I)})})}function J(){if(!(n.cancelled||o)){if(a.length===0){Y(!0);return}o=a.shift(),n.emit("checkpoint",{start_next_batch:o.seq}),U().then(H).then(j).then(Q).then(J).catch(function(T){re("batch processing terminated with error",T)})}}function Y(T){if(s.changes.length===0){a.length===0&&!o&&((m&&D.live||c)&&(n.state="pending",n.emit("paused")),c&&v());return}(T||c||s.changes.length>=b)&&(a.push(s),s={seq:0,changes:[],docs:[]},(n.state==="pending"||n.state==="stopped")&&(n.state="active",n.emit("active")),J())}function re(T,I){u||(I.message||(I.message=T),i.ok=!1,i.status="aborting",a=[],s={seq:0,changes:[],docs:[]},v(I))}function v(T){if(!u&&!(n.cancelled&&(i.status="cancelled",l)))if(i.status=i.status||"complete",i.end_time=new Date().toISOString(),i.last_seq=f,u=!0,r.activeTasks.remove(M,T),T){T=ee(T),T.result=i;var I=(T.name||"").toLowerCase();I==="unauthorized"||I==="forbidden"?(n.emit("error",T),n.removeAllListeners()):pg(e,n,T,function(){gc(r,t,e,n)})}else n.emit("complete",i),n.removeAllListeners()}function x(T,I,L){if(n.cancelled)return v();typeof I=="number"&&(s.pending=I);var B=ua(e)(T);if(!B){var q=r.activeTasks.get(M);if(q){var te=q.completed_items||0;r.activeTasks.update(M,{completed_items:++te})}return}s.seq=T.seq||L,s.changes.push(T),n.emit("checkpoint",{pending_batch:s.seq}),at(function(){Y(a.length===0&&D.live)})}function C(T){if(y=!1,n.cancelled)return v();if(T.results.length>0)D.since=T.results[T.results.length-1].seq,P(),Y(!0);else{var I=function(){m?(D.live=!0,P()):c=!0,Y(!0)};!o&&T.results.length===0?(l=!0,w.writeCheckpoint(T.last_seq,O).then(function(){if(l=!1,i.last_seq=f=T.last_seq,n.cancelled)throw v(),new Error("cancelled");I()}).catch($)):I()}}function E(T){if(y=!1,n.cancelled)return v();re("changes rejected",T)}function P(){if(!(!y&&!c&&a.length<S))return;y=!0;function T(){L.cancel()}function I(){n.removeListener("cancel",T)}n._changes&&(n.removeListener("cancel",n._abortChanges),n._changes.cancel()),n.once("cancel",T);var L=r.changes(D).on("change",x);L.then(I,I),L.then(C).catch(E),e.retry&&(n._changes=L,n._abortChanges=T)}function R(T){return r.info().then(function(I){var L=typeof e.since=="undefined"?parseInt(I.update_seq,10)-parseInt(T,10):parseInt(I.update_seq,10);return M=r.activeTasks.add({name:`${m?"continuous ":""}replication from ${I.db_name}`,total_items:L}),T})}function N(){z().then(function(){if(n.cancelled){v();return}return w.getCheckpoint().then(R).then(function(T){f=T,d=T,D={since:f,limit:b,batch_size:b,style:k,doc_ids:g,selector:h,return_docs:!0},e.filter&&(typeof e.filter!="string"?D.include_docs=!0:D.filter=e.filter),"heartbeat"in e&&(D.heartbeat=e.heartbeat),"timeout"in e&&(D.timeout=e.timeout),e.query_params&&(D.query_params=e.query_params),e.view&&(D.view=e.view),P()})}).catch(function(T){re("getCheckpoint rejected with ",T)})}function $(T){l=!1,re("writeCheckpoint completed with error",T)}if(n.cancelled){v();return}n._addedListeners||(n.once("cancel",v),typeof e.complete=="function"&&(n.once("error",e.complete),n.once("complete",function(T){e.complete(null,T)})),n._addedListeners=!0),typeof e.since=="undefined"?N():z().then(function(){return l=!0,w.writeCheckpoint(e.since,O)}).then(function(){if(l=!1,n.cancelled){v();return}f=e.since,N()}).catch($)}function br(r,t){var e=t.PouchConstructor;return typeof r=="string"?new e(r,t):r}function aa(r,t,e,n){if(typeof e=="function"&&(n=e,e={}),typeof e=="undefined"&&(e={}),e.doc_ids&&!Array.isArray(e.doc_ids))throw ee(xr,"`doc_ids` filter parameter is not a list.");e.complete=n,e=Ce(e),e.continuous=e.continuous||e.live,e.retry="retry"in e?e.retry:!1,e.PouchConstructor=e.PouchConstructor||this;var i=new ia(e),a=br(r,e),o=br(t,e);return gc(a,o,e,i),i}function vg(r,t,e,n){return typeof e=="function"&&(n=e,e={}),typeof e=="undefined"&&(e={}),e=Ce(e),e.PouchConstructor=e.PouchConstructor||this,r=br(r,e),t=br(t,e),new oa(r,t,e,n)}function yg(r){r.replicate=aa,r.sync=vg,Object.defineProperty(r.prototype,"replicate",{get:function(){var t=this;return typeof this.replicateMethods=="undefined"&&(this.replicateMethods={from:function(e,n,i){return t.constructor.replicate(e,t,n,i)},to:function(e,n,i){return t.constructor.replicate(t,e,n,i)}}),this.replicateMethods}}),r.prototype.sync=function(t,e,n){return this.constructor.sync(this,t,e,n)}}var fr,sa,it,Ml,Mf,Ff,qi,at,Ni,fe,Kb,jf,ze,Gt,Bl,zf,Uf,Gb,la,ql,Jb,Hf,ll,xr,Ei,Qb,ca,Zb,Yb,Xb,ur,e0,Wf,t0,ul,dl,Gf,Jf,fa,_n,eh,th,_r,Ui,Sh,gr,Hi,mr,ne,Zl,Vt,Wi,pl,Ih,$h,nc,Ki,Gi,vl,fp,hp,kp,be,Ie,Ue,bt,Me,tt,Pi,yn,Yi,Xi,Wt,$i,Oi,Bp,qp,lr,Np,Di,lt,Qt,Zt,Kp,Gp,Jp,bn,Cl,El,Zp,Bi,ig,fc,sg,Il,Pl,fg,Qe,wr,$l,Dl,ia,oa,wg,ka=F(()=>{fr=dn(ki());al();sa=dn(ol()),it=dn(require("events"));Ml=Function.prototype.toString,Mf=Ml.call(Object);Ff=6;try{localStorage.setItem("_pouch_check_localstorage",1),qi=!!localStorage.getItem("_pouch_check_localstorage")}catch(r){qi=!1}at=typeof queueMicrotask=="function"?queueMicrotask:function(t){Promise.resolve().then(t)},Ni=class extends it.default{constructor(){super(),this._listeners={},hr()&&addEventListener("storage",t=>{this.emit(t.key)})}addListener(t,e,n,i){if(this._listeners[e])return;var a=!1,o=this;function s(){if(!o._listeners[e])return;if(a){a="waiting";return}a=!0;var l=xn(i,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);function c(){a=!1}n.changes(l).on("change",function(u){u.seq>i.since&&!i.cancelled&&(i.since=u.seq,i.onChange(u))}).on("complete",function(){a==="waiting"&&at(s),a=!1}).on("error",c)}this._listeners[e]=s,this.on(t,s)}removeListener(t,e){e in this._listeners&&(super.removeListener(t,this._listeners[e]),delete this._listeners[e])}notifyLocalWindows(t){hr()&&(localStorage[t]=localStorage[t]==="a"?"b":"a")}notify(t){this.emit(t),this.notifyLocalWindows(t)}};fe=class extends Error{constructor(t,e,n){super(),this.status=t,this.name=e,this.message=n,this.error=!0}toString(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})}},Kb=new fe(401,"unauthorized","Name or password is incorrect."),jf=new fe(400,"bad_request","Missing JSON list of 'docs'"),ze=new fe(404,"not_found","missing"),Gt=new fe(409,"conflict","Document update conflict"),Bl=new fe(400,"bad_request","_id field must contain a string"),zf=new fe(412,"missing_id","_id is required for puts"),Uf=new fe(400,"bad_request","Only reserved document ids may start with underscore."),Gb=new fe(412,"precondition_failed","Database not open"),la=new fe(500,"unknown_error","Database encountered an unknown error"),ql=new fe(500,"badarg","Some query argument is invalid"),Jb=new fe(400,"invalid_request","Request was invalid"),Hf=new fe(400,"query_parse_error","Some query parameter is invalid"),ll=new fe(500,"doc_validation","Bad special document member"),xr=new fe(400,"bad_request","Something wrong with the request"),Ei=new fe(400,"bad_request","Document must be a JSON object"),Qb=new fe(404,"not_found","Database not found"),ca=new fe(500,"indexed_db_went_bad","unknown"),Zb=new fe(500,"web_sql_went_bad","unknown"),Yb=new fe(500,"levelDB_went_went_bad","unknown"),Xb=new fe(403,"forbidden","Forbidden by design doc validate_doc_update function"),ur=new fe(400,"bad_request","Invalid rev format"),e0=new fe(412,"file_exists","The database could not be created, the file already exists."),Wf=new fe(412,"missing_stub","A pre-existing attachment stub wasn't found"),t0=new fe(413,"invalid_url","Provided URL is invalid");ul=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],dl="queryKey",Gf=/(?:^|&)([^&=]*)=?([^&]*)/g,Jf=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;fa=function(r){return atob(r)},_n=function(r){return btoa(r)};eh=self.setImmediate||self.setTimeout,th=32768;_r=mn;Ui=class extends it.default{constructor(t,e,n){super(),this.db=t,e=e?Ce(e):{};var i=e.complete=Ll((s,l)=>{s?Kf(this,"error")>0&&this.emit("error",s):this.emit("complete",l),this.removeAllListeners(),t.removeListener("destroyed",a)});n&&(this.on("complete",function(s){n(null,s)}),this.on("error",n));let a=()=>{this.cancel()};t.once("destroyed",a),e.onChange=(s,l,c)=>{this.isCancelled||mh(this,s,l,c)};var o=new Promise(function(s,l){e.complete=function(c,u){c?l(c):s(u)}});this.once("cancel",function(){t.removeListener("destroyed",a),e.complete(null,{status:"cancelled"})}),this.then=o.then.bind(o),this.catch=o.catch.bind(o),this.then(function(s){i(null,s)},i),t.taskqueue.isReady?this.validateChanges(e):t.taskqueue.addTask(s=>{s?e.complete(s):this.isCancelled?this.emit("cancel"):this.validateChanges(e)})}cancel(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")}validateChanges(t){var e=t.complete;ne._changesFilterPlugin?ne._changesFilterPlugin.validate(t,n=>{if(n)return e(n);this.doChanges(t)}):this.doChanges(t)}doChanges(t){var e=t.complete;if(t=Ce(t),"live"in t&&!("continuous"in t)&&(t.continuous=t.live),t.processChange=vh,t.since==="latest"&&(t.since="now"),t.since||(t.since=0),t.since==="now"){this.db.info().then(i=>{if(this.isCancelled){e(null,{status:"cancelled"});return}t.since=i.update_seq,this.doChanges(t)},e);return}if(ne._changesFilterPlugin){if(ne._changesFilterPlugin.normalize(t),ne._changesFilterPlugin.shouldFilter(this,t))return ne._changesFilterPlugin.filter(this,t)}else["doc_ids","filter","selector","view"].forEach(function(i){i in t&&He("warn",'The "'+i+'" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.')});"descending"in t||(t.descending=!1),t.limit=t.limit===0?1:t.limit,t.complete=e;var n=this.db._changes(t);if(n&&typeof n.cancel=="function"){let i=this.cancel;this.cancel=(...a)=>{n.cancel(),i.apply(this,a)}}}};Sh=/^\d+-[^-]*$/;gr=class extends it.default{_setup(){this.post=ye("post",function(t,e,n){if(typeof e=="function"&&(n=e,e={}),Ai(t))return n(ee(Ei));this.bulkDocs({docs:[t]},e,Ti(n,t._id))}).bind(this),this.put=ye("put",function(t,e,n){if(typeof e=="function"&&(n=e,e={}),Ai(t))return n(ee(Ei));if(Nl(t._id),"_rev"in t&&!Ii(t._rev))return n(ee(ur));if(_t(t._id)&&typeof this._putLocal=="function")return t._deleted?this._removeLocal(t,n):this._putLocal(t,n);let i=o=>{typeof this._put=="function"&&e.new_edits!==!1?this._put(t,e,o):this.bulkDocs({docs:[t]},e,Ti(o,t._id))};e.force&&t._rev?(a(),i(function(o){var s=o?null:{ok:!0,id:t._id,rev:t._rev};n(o,s)})):i(n);function a(){var o=t._rev.split("-"),s=o[1],l=parseInt(o[0],10),c=l+1,u=Wl();t._revisions={start:c,ids:[u,s]},t._rev=c+"-"+u,e.new_edits=!1}}).bind(this),this.putAttachment=ye("putAttachment",function(t,e,n,i,a){var o=this;typeof a=="function"&&(a=i,i=n,n=null),typeof a=="undefined"&&(a=i,i=n,n=null),a||He("warn","Attachment",e,"on document",t,"is missing content_type");function s(l){var c="_rev"in l?parseInt(l._rev,10):0;return l._attachments=l._attachments||{},l._attachments[e]={content_type:a,data:i,revpos:++c},o.put(l)}return o.get(t).then(function(l){if(l._rev!==n)throw ee(Gt);return s(l)},function(l){if(l.reason===ze.message)return s({_id:t});throw l})}).bind(this),this.removeAttachment=ye("removeAttachment",function(t,e,n,i){this.get(t,(a,o)=>{if(a){i(a);return}if(o._rev!==n){i(ee(Gt));return}if(!o._attachments)return i();delete o._attachments[e],Object.keys(o._attachments).length===0&&delete o._attachments,this.put(o,i)})}).bind(this),this.remove=ye("remove",function(t,e,n,i){var a;typeof e=="string"?(a={_id:t,_rev:e},typeof n=="function"&&(i=n,n={})):(a=t,typeof e=="function"?(i=e,n={}):(i=n,n=e)),n=n||{},n.was_delete=!0;var o={_id:a._id,_rev:a._rev||n.rev};if(o._deleted=!0,_t(o._id)&&typeof this._removeLocal=="function")return this._removeLocal(a,i);this.bulkDocs({docs:[o]},n,Ti(i,o._id))}).bind(this),this.revsDiff=ye("revsDiff",function(t,e,n){typeof e=="function"&&(n=e,e={});var i=Object.keys(t);if(!i.length)return n(null,{});var a=0,o=new Map;function s(c,u){o.has(c)||o.set(c,{missing:[]}),o.get(c).missing.push(u)}function l(c,u){var d=t[c].slice(0);St(u,function(f,m,b,S,k){var y=m+"-"+b,g=d.indexOf(y);g!==-1&&(d.splice(g,1),k.status!=="available"&&s(c,y))}),d.forEach(function(f){s(c,f)})}i.forEach(function(c){this._getRevisionTree(c,function(u,d){if(u&&u.status===404&&u.message==="missing")o.set(c,{missing:t[c]});else{if(u)return n(u);l(c,d)}if(++a===i.length){var f={};return o.forEach(function(m,b){f[b]=m}),n(null,f)}})},this)}).bind(this),this.bulkGet=ye("bulkGet",function(t,e){Fl(this,t,e)}).bind(this),this.compactDocument=ye("compactDocument",function(t,e,n){this._getRevisionTree(t,(i,a)=>{if(i)return n(i);var o=bh(a),s=[],l=[];Object.keys(o).forEach(function(c){o[c]>e&&s.push(c)}),St(a,function(c,u,d,f,m){var b=u+"-"+d;m.status==="available"&&s.indexOf(b)!==-1&&l.push(b)}),this._doCompaction(t,l,n)})}).bind(this),this.compact=ye("compact",function(t,e){typeof t=="function"&&(e=t,t={}),t=t||{},this._compactionQueue=this._compactionQueue||[],this._compactionQueue.push({opts:t,callback:e}),this._compactionQueue.length===1&&Jl(this)}).bind(this),this.get=ye("get",function(t,e,n){if(typeof e=="function"&&(n=e,e={}),e=e||{},typeof t!="string")return n(ee(Bl));if(_t(t)&&typeof this._getLocal=="function")return this._getLocal(t,n);var i=[];let a=()=>{var l=[],c=i.length;if(!c)return n(null,l);i.forEach(u=>{this.get(t,{rev:u,revs:e.revs,latest:e.latest,attachments:e.attachments,binary:e.binary},function(d,f){if(d)l.push({missing:u});else{for(var m,b=0,S=l.length;b<S;b++)if(l[b].ok&&l[b].ok._rev===f._rev){m=!0;break}m||l.push({ok:f})}c--,c||n(null,l)})})};if(e.open_revs){if(e.open_revs==="all")this._getRevisionTree(t,function(l,c){if(l)return n(l);i=ya(c).map(function(u){return u.rev}),a()});else if(Array.isArray(e.open_revs)){i=e.open_revs;for(var o=0;o<i.length;o++){var s=i[o];if(!Ii(s))return n(ee(ur))}a()}else return n(ee(la,"function_clause"));return}return this._get(t,e,(l,c)=>{if(l)return l.docId=t,n(l);var u=c.doc,d=c.metadata,f=c.ctx;if(e.conflicts){var m=wa(d);m.length&&(u._conflicts=m)}if(ct(d,u._rev)&&(u._deleted=!0),e.revs||e.revs_info){for(var b=u._rev.split("-"),S=parseInt(b[0],10),k=b[1],y=Vl(d.rev_tree),g=null,h=0;h<y.length;h++){var p=y[h];let U=p.ids.findIndex(H=>H.id===k);var w=U===S-1;(w||!g&&U!==-1)&&(g=p)}if(!g)return l=new Error("invalid rev tree"),l.docId=t,n(l);let j=u._rev.split("-")[1],Q=g.ids.findIndex(U=>U.id===j)+1;var _=g.ids.length-Q;if(g.ids.splice(Q,_),g.ids.reverse(),e.revs&&(u._revisions={start:g.pos+g.ids.length-1,ids:g.ids.map(function(U){return U.id})}),e.revs_info){var O=g.pos+g.ids.length;u._revs_info=g.ids.map(function(U){return O--,{rev:O+"-"+U.id,status:U.opts.status}})}}if(e.attachments&&u._attachments){var M=u._attachments,D=Object.keys(M).length;if(D===0)return n(null,u);Object.keys(M).forEach(j=>{this._getAttachment(u._id,j,M[j],{binary:e.binary,metadata:d,ctx:f},function(Q,U){var H=u._attachments[j];H.data=U,delete H.stub,delete H.length,--D||n(null,u)})})}else{if(u._attachments)for(var z in u._attachments)Object.prototype.hasOwnProperty.call(u._attachments,z)&&(u._attachments[z].stub=!0);n(null,u)}})}).bind(this),this.getAttachment=ye("getAttachment",function(t,e,n,i){n instanceof Function&&(i=n,n={}),this._get(t,n,(a,o)=>{if(a)return i(a);if(o.doc._attachments&&o.doc._attachments[e])n.ctx=o.ctx,n.binary=!0,n.metadata=o.metadata,this._getAttachment(t,e,o.doc._attachments[e],n,i);else return i(ee(ze))})}).bind(this),this.allDocs=ye("allDocs",function(t,e){if(typeof t=="function"&&(e=t,t={}),t.skip=typeof t.skip!="undefined"?t.skip:0,t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),"keys"in t){if(!Array.isArray(t.keys))return e(new TypeError("options.keys must be an array"));var n=["startkey","endkey","key"].filter(function(i){return i in t})[0];if(n){e(ee(Hf,"Query parameter `"+n+"` is not compatible with multi-get"));return}if(!rt(this)&&(xh(t),t.keys.length===0))return this._allDocs({limit:0},e)}return this._allDocs(t,e)}).bind(this),this.close=ye("close",function(t){return this._closed=!0,this.emit("closed"),this._close(t)}).bind(this),this.info=ye("info",function(t){this._info((e,n)=>{if(e)return t(e);n.db_name=n.db_name||this.name,n.auto_compaction=!!(this.auto_compaction&&!rt(this)),n.adapter=this.adapter,t(null,n)})}).bind(this),this.id=ye("id",function(t){return this._id(t)}).bind(this),this.bulkDocs=ye("bulkDocs",function(t,e,n){if(typeof e=="function"&&(n=e,e={}),e=e||{},Array.isArray(t)&&(t={docs:t}),!t||!t.docs||!Array.isArray(t.docs))return n(ee(jf));for(var i=0;i<t.docs.length;++i){let l=t.docs[i];if(Ai(l))return n(ee(Ei));if("_rev"in l&&!Ii(l._rev))return n(ee(ur))}var a;if(t.docs.forEach(function(l){l._attachments&&Object.keys(l._attachments).forEach(function(c){a=a||kh(c),l._attachments[c].content_type||He("warn","Attachment",c,"on document",l._id,"is missing content_type")})}),a)return n(ee(xr,a));"new_edits"in e||("new_edits"in t?e.new_edits=t.new_edits:e.new_edits=!0);var o=this;!e.new_edits&&!rt(o)&&t.docs.sort(wh),yh(t.docs);var s=t.docs.map(function(l){return l._id});this._bulkDocs(t,e,function(l,c){if(l)return n(l);if(e.new_edits||(c=c.filter(function(f){return f.error})),!rt(o))for(var u=0,d=c.length;u<d;u++)c[u].id=c[u].id||s[u];n(null,c)})}).bind(this),this.registerDependentDatabase=ye("registerDependentDatabase",function(t,e){var n=Ce(this.__opts);this.__opts.view_adapter&&(n.adapter=this.__opts.view_adapter);var i=new this.constructor(t,n);function a(o){return o.dependentDbs=o.dependentDbs||{},o.dependentDbs[t]?!1:(o.dependentDbs[t]=!0,o)}pr(this,"_local/_pouch_dependentDbs",a).then(function(){e(null,{db:i})}).catch(e)}).bind(this),this.destroy=ye("destroy",function(t,e){typeof t=="function"&&(e=t,t={});var n="use_prefix"in this?this.use_prefix:!0;let i=()=>{this._destroy(t,(a,o)=>{if(a)return e(a);this._destroyed=!0,this.emit("destroyed"),e(null,o||{ok:!0})})};if(rt(this))return i();this.get("_local/_pouch_dependentDbs",(a,o)=>{if(a)return a.status!==404?e(a):i();var s=o.dependentDbs,l=this.constructor,c=Object.keys(s).map(u=>{var d=n?u.replace(new RegExp("^"+l.prefix),""):u;return new l(d,this.__opts).destroy()});Promise.all(c).then(i,e)})}).bind(this)}_compact(t,e){var n={return_docs:!1,last_seq:t.last_seq||0,since:t.last_seq||0},i=[],a,o=0;let s=u=>{this.activeTasks.update(a,{completed_items:++o}),i.push(this.compactDocument(u.id,0))},l=u=>{this.activeTasks.remove(a,u),e(u)},c=u=>{var d=u.last_seq;Promise.all(i).then(()=>pr(this,"_local/compaction",f=>!f.last_seq||f.last_seq<d?(f.last_seq=d,f):!1)).then(()=>{this.activeTasks.remove(a),e(null,{ok:!0})}).catch(l)};this.info().then(u=>{a=this.activeTasks.add({name:"database_compaction",total_items:u.update_seq-n.last_seq}),this.changes(n).on("change",s).on("complete",c).on("error",l)})}changes(t,e){return typeof t=="function"&&(e=t,t={}),t=t||{},t.return_docs="return_docs"in t?t.return_docs:!t.live,new Ui(this,t,e)}type(){return typeof this._type=="function"?this._type():this.adapter}};gr.prototype.purge=ye("_purge",function(r,t,e){if(typeof this._purge=="undefined")return e(ee(la,"Purge is not implemented in the "+this.adapter+" adapter."));var n=this;n._getRevisionTree(r,(i,a)=>{if(i)return e(i);if(!a)return e(ee(ze));let o;try{o=sh(a,t)}catch(s){return e(s.message||s)}n._purge(r,o,(s,l)=>{if(s)return e(s);_h(n,r,t).then(function(){return e(null,l)})})})});Hi=class{constructor(){this.isReady=!1,this.failed=!1,this.queue=[]}execute(){var t;if(this.failed)for(;t=this.queue.shift();)t(this.failed);else for(;t=this.queue.shift();)t()}fail(t){this.failed=t,this.execute()}ready(t){this.isReady=!0,this.db=t,this.execute()}addTask(t){this.queue.push(t),this.failed&&this.execute()}};mr=class extends gr{constructor(t,e){super(),this._setup(t,e)}_setup(t,e){if(super._setup(),e=e||{},t&&typeof t=="object"&&(e=t,t=e.name,delete e.name),e.deterministic_revs===void 0&&(e.deterministic_revs=!0),this.__opts=e=Ce(e),this.auto_compaction=e.auto_compaction,this.purged_infos_limit=e.purged_infos_limit||1e3,this.prefix=ne.prefix,typeof t!="string")throw new Error("Missing/invalid DB name");var n=(e.prefix||"")+t,i=Ch(n,e);if(e.name=i.name,e.adapter=e.adapter||i.adapter,this.name=t,this._adapter=e.adapter,ne.emit("debug",["adapter","Picked adapter: ",e.adapter]),!ne.adapters[e.adapter]||!ne.adapters[e.adapter].valid())throw new Error("Invalid Adapter: "+e.adapter);if(e.view_adapter&&(!ne.adapters[e.view_adapter]||!ne.adapters[e.view_adapter].valid()))throw new Error("Invalid View Adapter: "+e.view_adapter);this.taskqueue=new Hi,this.adapter=e.adapter,ne.adapters[e.adapter].call(this,e,a=>{if(a)return this.taskqueue.fail(a);Th(this),this.emit("created",this),ne.emit("created",this.name),this.taskqueue.ready(this)})}},ne=Ql(mr,function(r,t){mr.prototype._setup.call(this,r,t)}),Zl=fetch,Vt=Headers,Wi=class{constructor(){this.tasks={}}list(){return Object.values(this.tasks)}add(t){let e=mn();return this.tasks[e]={id:e,name:t.name,total_items:t.total_items,created_at:new Date().toJSON()},e}get(t){return this.tasks[t]}remove(t,e){return delete this.tasks[t],this.tasks}update(t,e){let n=this.tasks[t];if(typeof n!="undefined"){let i={id:n.id,name:n.name,created_at:n.created_at,total_items:e.total_items||n.total_items,completed_items:e.completed_items||n.completed_items,updated_at:new Date().toJSON()};this.tasks[t]=i}return this.tasks}};ne.adapters={};ne.preferredAdapters=[];ne.prefix="_pouch_";pl=new it.default;Ah(ne);ne.adapter=function(r,t,e){t.valid()&&(ne.adapters[r]=t,e&&ne.preferredAdapters.push(r))};ne.plugin=function(r){if(typeof r=="function")r(ne);else{if(typeof r!="object"||Object.keys(r).length===0)throw new Error('Invalid plugin: got "'+r+'", expected an object or a function');Object.keys(r).forEach(function(t){ne.prototype[t]=r[t]})}return this.__defaults&&(ne.__defaults=Object.assign({},this.__defaults)),ne};ne.defaults=function(r){let t=Ql(ne,function(e,n){n=n||{},e&&typeof e=="object"&&(n=e,e=n.name,delete n.name),n=Object.assign({},t.__defaults,n),ne.call(this,e,n)});return t.preferredAdapters=ne.preferredAdapters.slice(),Object.keys(ne).forEach(function(e){e in t||(t[e]=ne[e])}),t.__defaults=Object.assign({},this.__defaults,r),t};ne.fetch=function(r,t){return Zl(r,t)};ne.prototype.activeTasks=ne.activeTasks=new Wi;Ih="9.0.0";$h=["$or","$nor","$not"];nc=-324,Ki=3,Gi="";vl={$elemMatch:function(r,t,e,n){return!Array.isArray(n)||n.length===0?!1:typeof n[0]=="object"&&n[0]!==null?n.some(function(i){return Kt(i,t,Object.keys(t))}):n.some(function(i){return vr(t,r,e,i)})},$allMatch:function(r,t,e,n){return!Array.isArray(n)||n.length===0?!1:typeof n[0]=="object"&&n[0]!==null?n.every(function(i){return Kt(i,t,Object.keys(t))}):n.every(function(i){return vr(t,r,e,i)})},$eq:function(r,t,e,n){return yt(n)&&we(n,t)===0},$gte:function(r,t,e,n){return yt(n)&&we(n,t)>=0},$gt:function(r,t,e,n){return yt(n)&&we(n,t)>0},$lte:function(r,t,e,n){return yt(n)&&we(n,t)<=0},$lt:function(r,t,e,n){return yt(n)&&we(n,t)<0},$exists:function(r,t,e,n){return t?yt(n):!yt(n)},$mod:function(r,t,e,n){return vn(n)&&Yh(n,t)},$ne:function(r,t,e,n){return t.every(function(i){return we(n,i)!==0})},$in:function(r,t,e,n){return vn(n)&&ml(n,t)},$nin:function(r,t,e,n){return vn(n)&&!ml(n,t)},$size:function(r,t,e,n){return vn(n)&&Array.isArray(n)&&ep(n,t)},$all:function(r,t,e,n){return Array.isArray(n)&&Xh(n,t)},$regex:function(r,t,e,n){return vn(n)&&typeof n=="string"&&t.every(function(i){return tp(n,i)})},$type:function(r,t,e,n){return np(n,t)}};ne.plugin(up);ne.version=Ih;fp=rc(["_id","_rev","_access","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),hp=rc(["_access","_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);kp=5,be="document-store",Ie="by-sequence",Ue="attach-store",bt="attach-seq-store",Me="meta-store",tt="local-store",Pi="detect-blob-support";yn=new Ni;Yi=!1,Xi=[];Wt=new Map,Oi=new Map;cc.valid=function(){try{return typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(r){return!1}};Bp=25,qp=50,lr=5e3,Np=1e4,Di={};ea.valid=function(){return!0};lt=class extends Error{constructor(t){super(),this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,lt)}catch(e){}}},Qt=class extends Error{constructor(t){super(),this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,Qt)}catch(e){}}},Zt=class extends Error{constructor(t){super(),this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,Zt)}catch(e){}}};Kp=He.bind(null,"log"),Gp=Array.isArray,Jp=JSON.parse;bn=class{constructor(){this.promise=Promise.resolve()}add(t){return this.promise=this.promise.catch(()=>{}).then(()=>t()),this.promise}finish(){return this.promise}};Cl={},El=new bn,Zp=50;Bi={_sum:function(r,t){return ta(t)},_count:function(r,t){return t.length},_stats:function(r,t){function e(n){for(var i=0,a=0,o=n.length;a<o;a++){var s=n[a];i+=s*s}return i}return{sum:ta(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:e(t)}}};ig="mrviews",fc=Xp(ig,tg,ng,rg);sg={query:ag,viewCleanup:og};Il=1,Pl="pouchdb",fg=5,Qe=0;wr=class{constructor(t,e,n,i,a={writeSourceCheckpoint:!0,writeTargetCheckpoint:!0}){this.src=t,this.target=e,this.id=n,this.returnValue=i,this.opts=a,typeof a.writeSourceCheckpoint=="undefined"&&(a.writeSourceCheckpoint=!0),typeof a.writeTargetCheckpoint=="undefined"&&(a.writeTargetCheckpoint=!0)}writeCheckpoint(t,e){var n=this;return this.updateTarget(t,e).then(function(){return n.updateSource(t,e)})}updateTarget(t,e){return this.opts.writeTargetCheckpoint?na(this.target,this.id,t,e,this.returnValue):Promise.resolve(!0)}updateSource(t,e){if(this.opts.writeSourceCheckpoint){var n=this;return na(this.src,this.id,t,e,this.returnValue).catch(function(i){if(Ol(i))return n.opts.writeSourceCheckpoint=!1,!0;throw i})}else return Promise.resolve(!0)}getCheckpoint(){var t=this;return!t.opts.writeSourceCheckpoint&&!t.opts.writeTargetCheckpoint?Promise.resolve(Qe):t.opts&&t.opts.writeSourceCheckpoint&&!t.opts.writeTargetCheckpoint?t.src.get(t.id).then(function(e){return e.last_seq||Qe}).catch(function(e){if(e.status!==404)throw e;return Qe}):t.target.get(t.id).then(function(e){return t.opts&&t.opts.writeTargetCheckpoint&&!t.opts.writeSourceCheckpoint?e.last_seq||Qe:t.src.get(t.id).then(function(n){if(e.version!==n.version)return Qe;var i;return e.version?i=e.version.toString():i="undefined",i in $l?$l[i](e,n):Qe},function(n){if(n.status===404&&e.last_seq)return t.src.put({_id:t.id,last_seq:Qe}).then(function(){return Qe},function(i){return Ol(i)?(t.opts.writeSourceCheckpoint=!1,e.last_seq):Qe});throw n})}).catch(function(e){if(e.status!==404)throw e;return Qe})}},$l={undefined:function(r,t){return we(r.last_seq,t.last_seq)===0?t.last_seq:0},1:function(r,t){return hg(t,r).last_seq}};Dl=0;ia=class extends it.default{constructor(){super(),this.cancelled=!1,this.state="pending";let t=new Promise((e,n)=>{this.once("complete",e),this.once("error",n)});this.then=function(e,n){return t.then(e,n)},this.catch=function(e){return t.catch(e)},this.catch(function(){})}cancel(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")}ready(t,e){if(this._readyCalled)return;this._readyCalled=!0;let n=()=>{this.cancel()};t.once("destroyed",n),e.once("destroyed",n);function i(){t.removeListener("destroyed",n),e.removeListener("destroyed",n)}this.once("complete",i),this.once("error",i)}};oa=class extends it.default{constructor(t,e,n,i){super(),this.canceled=!1;let a=n.push?Object.assign({},n,n.push):n,o=n.pull?Object.assign({},n,n.pull):n;this.push=aa(t,e,a),this.pull=aa(e,t,o),this.pushPaused=!0,this.pullPaused=!0;let s=h=>{this.emit("change",{direction:"pull",change:h})},l=h=>{this.emit("change",{direction:"push",change:h})},c=h=>{this.emit("denied",{direction:"push",doc:h})},u=h=>{this.emit("denied",{direction:"pull",doc:h})},d=()=>{this.pushPaused=!0,this.pullPaused&&this.emit("paused")},f=()=>{this.pullPaused=!0,this.pushPaused&&this.emit("paused")},m=()=>{this.pushPaused=!1,this.pullPaused&&this.emit("active",{direction:"push"})},b=()=>{this.pullPaused=!1,this.pushPaused&&this.emit("active",{direction:"pull"})},S={},k=h=>(p,w)=>{(p==="change"&&(w===s||w===l)||p==="denied"&&(w===u||w===c)||p==="paused"&&(w===f||w===d)||p==="active"&&(w===b||w===m))&&(p in S||(S[p]={}),S[p][h]=!0,Object.keys(S[p]).length===2&&this.removeAllListeners(p))};n.live&&(this.push.on("complete",this.pull.cancel.bind(this.pull)),this.pull.on("complete",this.push.cancel.bind(this.push)));function y(h,p,w){h.listeners(p).indexOf(w)==-1&&h.on(p,w)}this.on("newListener",function(h){h==="change"?(y(this.pull,"change",s),y(this.push,"change",l)):h==="denied"?(y(this.pull,"denied",u),y(this.push,"denied",c)):h==="active"?(y(this.pull,"active",b),y(this.push,"active",m)):h==="paused"&&(y(this.pull,"paused",f),y(this.push,"paused",d))}),this.on("removeListener",function(h){h==="change"?(this.pull.removeListener("change",s),this.push.removeListener("change",l)):h==="denied"?(this.pull.removeListener("denied",u),this.push.removeListener("denied",c)):h==="active"?(this.pull.removeListener("active",b),this.push.removeListener("active",m)):h==="paused"&&(this.pull.removeListener("paused",f),this.push.removeListener("paused",d))}),this.pull.on("removeListener",k("pull")),this.push.on("removeListener",k("push"));let g=Promise.all([this.push,this.pull]).then(h=>{let p={push:h[0],pull:h[1]};return this.emit("complete",p),i&&i(null,p),this.removeAllListeners(),p},h=>{if(this.cancel(),i?i(h):this.emit("error",h),this.removeAllListeners(),i)throw h});this.then=function(h,p){return g.then(h,p)},this.catch=function(h){return g.catch(h)}}cancel(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())}};ne.plugin(Rp).plugin(Hp).plugin(sg).plugin(yg);wg=ne});function Sa(r,t){function e(n){for(var i=Object.getOwnPropertyNames(r),a=0,o=i.length;a<o;a++)typeof r[i[a]]!="function"&&(this[i[a]]=r[i[a]]);this.stack===void 0&&(this.stack=new Error().stack),n!==void 0&&(this.reason=n)}return e.prototype=he.prototype,new e(t)}function kn(r){if(typeof r!="object"){var t=r;r=Sg,r.data=t}return"error"in r&&r.error==="conflict"&&(r.name="conflict",r.status=409),"name"in r||(r.name=r.error||"unknown"),"status"in r||(r.status=500),"message"in r||(r.message=r.message||r.reason),"stack"in r||(r.stack=new Error().stack),r}var he,i0,a0,o0,s0,xg,_g,kg,l0,Sg,c0,u0,d0,f0,Cg,h0,p0,g0,m0,v0,y0,w0,b0,x0,_0,Sr=F(()=>{he=class extends Error{constructor(t,e,n){super(),this.status=t,this.name=e,this.message=n,this.error=!0}toString(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})}},i0=new he(401,"unauthorized","Name or password is incorrect."),a0=new he(400,"bad_request","Missing JSON list of 'docs'"),o0=new he(404,"not_found","missing"),s0=new he(409,"conflict","Document update conflict"),xg=new he(400,"bad_request","_id field must contain a string"),_g=new he(412,"missing_id","_id is required for puts"),kg=new he(400,"bad_request","Only reserved document ids may start with underscore."),l0=new he(412,"precondition_failed","Database not open"),Sg=new he(500,"unknown_error","Database encountered an unknown error"),c0=new he(500,"badarg","Some query argument is invalid"),u0=new he(400,"invalid_request","Request was invalid"),d0=new he(400,"query_parse_error","Some query parameter is invalid"),f0=new he(500,"doc_validation","Bad special document member"),Cg=new he(400,"bad_request","Something wrong with the request"),h0=new he(400,"bad_request","Document must be a JSON object"),p0=new he(404,"not_found","Database not found"),g0=new he(500,"indexed_db_went_bad","unknown"),m0=new he(500,"web_sql_went_bad","unknown"),v0=new he(500,"levelDB_went_went_bad","unknown"),y0=new he(403,"forbidden","Forbidden by design doc validate_doc_update function"),w0=new he(400,"bad_request","Invalid rev format"),b0=new he(412,"file_exists","The database could not be created, the file already exists."),x0=new he(412,"missing_stub","A pre-existing attachment stub wasn't found"),_0=new he(413,"invalid_url","Provided URL is invalid")});var Yt,Ca=F(()=>{Yt=Headers});function Tg(r,t){r=r||[],t=t||{};try{return new Blob(r,t)}catch(a){if(a.name!=="TypeError")throw a;for(var e=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,n=new e,i=0;i<r.length;i+=1)n.append(r[i]);return n.getBlob(t.type)}}function Ag(r){for(var t=r.length,e=new ArrayBuffer(t),n=new Uint8Array(e),i=0;i<t;i++)n[i]=r.charCodeAt(i);return e}function Ig(r,t){return Tg([Ag(r)],{type:t})}function xc(r,t){return Ig(Eg(r),t)}var Eg,Ea=F(()=>{Eg=function(r){return atob(r)}});function Pg(r,t,e){for(var n="",i=e-r.length;n.length<i;)n+=t;return n}function $g(r,t,e){var n=Pg(r,t,e);return n+r}function ve(r,t){if(r===t)return 0;r=pt(r),t=pt(t);var e=Ia(r),n=Ia(t);if(e-n!==0)return e-n;switch(typeof r){case"number":return r-t;case"boolean":return r<t?-1:1;case"string":return Rg(r,t)}return Array.isArray(r)?Lg(r,t):Fg(r,t)}function pt(r){switch(typeof r){case"undefined":return null;case"number":return r===1/0||r===-1/0||isNaN(r)?null:r;case"object":var t=r;if(Array.isArray(r)){var e=r.length;r=new Array(e);for(var n=0;n<e;n++)r[n]=pt(t[n])}else{if(r instanceof Date)return r.toJSON();if(r!==null){r={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var a=t[i];typeof a!="undefined"&&(r[i]=pt(a))}}}}return r}function Og(r){if(r!==null)switch(typeof r){case"boolean":return r?1:0;case"number":return Bg(r);case"string":return r.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var t=Array.isArray(r),e=t?r:Object.keys(r),n=-1,i=e.length,a="";if(t)for(;++n<i;)a+=We(e[n]);else for(;++n<i;){var o=e[n];a+=We(o)+We(r[o])}return a}return""}function We(r){var t="\0";return r=pt(r),Ia(r)+Aa+Og(r)+t}function Dg(r,t){var e=t,n,i=r[t]==="1";if(i)n=0,t++;else{var a=r[t]==="0";t++;var o="",s=r.substring(t,t+Ta),l=parseInt(s,10)+_c;for(a&&(l=-l),t+=Ta;;){var c=r[t];if(c==="\0")break;o+=c,t++}o=o.split("."),o.length===1?n=parseInt(o,10):n=parseFloat(o[0]+"."+o[1]),a&&(n=n-10),l!==0&&(n=parseFloat(n+"e"+l))}return{num:n,length:t-e}}function Mg(r,t){var e=r.pop();if(t.length){var n=t[t.length-1];e===n.element&&(t.pop(),n=t[t.length-1]);var i=n.element,a=n.index;if(Array.isArray(i))i.push(e);else if(a===r.length-2){var o=r.pop();i[o]=e}else r.push(e)}}function kc(r){for(var t=[],e=[],n=0;;){var i=r[n++];if(i==="\0"){if(t.length===1)return t.pop();Mg(t,e);continue}switch(i){case"1":t.push(null);break;case"2":t.push(r[n]==="1"),n++;break;case"3":var a=Dg(r,n);t.push(a.num),n+=a.length;break;case"4":for(var o="";;){var s=r[n];if(s==="\0")break;o+=s,n++}o=o.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),t.push(o);break;case"5":var l={element:[],index:t.length};t.push(l.element),e.push(l);break;case"6":var c={element:{},index:t.length};t.push(c.element),e.push(c);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+i)}}}function Lg(r,t){for(var e=Math.min(r.length,t.length),n=0;n<e;n++){var i=ve(r[n],t[n]);if(i!==0)return i}return r.length===t.length?0:r.length>t.length?1:-1}function Rg(r,t){return r===t?0:r>t?1:-1}function Fg(r,t){for(var e=Object.keys(r),n=Object.keys(t),i=Math.min(e.length,n.length),a=0;a<i;a++){var o=ve(e[a],n[a]);if(o!==0||(o=ve(r[e[a]],t[n[a]]),o!==0))return o}return e.length===n.length?0:e.length>n.length?1:-1}function Ia(r){var t=["boolean","number","string","object"],e=t.indexOf(typeof r);if(~e)return r===null?1:Array.isArray(r)?5:e<3?e+2:e+3;if(Array.isArray(r))return 5}function Bg(r){if(r===0)return"1";var t=r.toExponential().split(/e\+?/),e=parseInt(t[1],10),n=r<0,i=n?"0":"2",a=(n?-e:e)-_c,o=$g(a.toString(),"0",Ta);i+=Aa+o;var s=Math.abs(parseFloat(t[0]));n&&(s=10-s);var l=s.toFixed(20);return l=l.replace(/\.?0+$/,""),i+=Aa+l,i}var _c,Ta,Aa,Cr=F(()=>{_c=-324,Ta=3,Aa=""});function Sn(r){return Sc.default.hash(r)}var Sc,P0,Er=F(()=>{Ea();Sc=dn(ki()),P0=self.setImmediate||self.setTimeout});function Ng(r){return typeof ArrayBuffer!="undefined"&&r instanceof ArrayBuffer||typeof Blob!="undefined"&&r instanceof Blob}function jg(r){return r instanceof ArrayBuffer?r.slice(0):r.slice(0,r.size,r.type)}function Ug(r){var t=Object.getPrototypeOf(r);if(t===null)return!0;var e=t.constructor;return typeof e=="function"&&e instanceof e&&Tc.call(e)==zg}function ut(r){var t,e,n;if(!r||typeof r!="object")return r;if(Array.isArray(r)){for(t=[],e=0,n=r.length;e<n;e++)t[e]=ut(r[e]);return t}if(r instanceof Date&&isFinite(r))return r.toISOString();if(Ng(r))return jg(r);if(!Ug(r))return r;t={};for(e in r)if(Object.prototype.hasOwnProperty.call(r,e)){var i=ut(r[e]);typeof i!="undefined"&&(t[e]=i)}return t}function Tr(r){if(typeof console!="undefined"&&typeof console[r]=="function"){var t=Array.prototype.slice.call(arguments,1);console[r].apply(console,t)}}function Hg(){}function dt(r){return typeof r._remote=="boolean"?r._remote:typeof r.type=="function"?(Tr("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),r.type()==="http"):!1}function Xt(r,t,e){return r.get(t).catch(function(n){if(n.status!==404)throw n;return{}}).then(function(n){var i=n._rev,a=e(n);return a?(a._id=t,a._rev=i,Vg(r,a,e)):{updated:!1,rev:i}})}function Vg(r,t,e){return r.put(t).then(function(n){return{updated:!0,rev:n.rev}},function(n){if(n.status!==409)throw n;return Xt(r,t._id,e)})}var qg,Tc,zg,Cc,Cn,Wg,Ec,En=F(()=>{Sr();qg=dn(require("events"));Er();Tc=Function.prototype.toString,zg=Tc.call(Object);try{localStorage.setItem("_pouch_check_localstorage",1),Cc=!!localStorage.getItem("_pouch_check_localstorage")}catch(r){Cc=!1}Cn=typeof queueMicrotask=="function"?queueMicrotask:function(t){Promise.resolve().then(t)};Wg=Hg.name;Wg?Ec=function(r){return r.name}:Ec=function(r){var t=r.toString().match(/^\s*function\s*(?:(\S+)\s*)?\(/);return t&&t[1]?t[1]:""}});function Pa(r,t){return t&&r.then(function(e){Cn(function(){t(null,e)})},function(e){Cn(function(){t(e)})}),r}function Ac(r){return function(...t){var e=t.pop(),n=r.apply(this,t);return typeof e=="function"&&Pa(n,e),n}}function Ic(r,t){return r.then(function(e){return t().then(function(){return e})},function(e){return t().then(function(){throw e})})}function Ar(r,t){return function(){var e=arguments,n=this;return r.add(function(){return t.apply(n,e)})}}function $a(r){var t=new Set(r),e=new Array(t.size),n=-1;return t.forEach(function(i){e[++n]=i}),e}function Ir(r){var t=new Array(r.size),e=-1;return r.forEach(function(n,i){t[++e]=i}),t}var ot,en,tn,Pc=F(()=>{En();ot=class extends Error{constructor(t){super(),this.status=400,this.name="query_parse_error",this.message=t,this.error=!0;try{Error.captureStackTrace(this,ot)}catch(e){}}},en=class extends Error{constructor(t){super(),this.status=404,this.name="not_found",this.message=t,this.error=!0;try{Error.captureStackTrace(this,en)}catch(e){}}},tn=class extends Error{constructor(t){super(),this.status=500,this.name="invalid_value",this.message=t,this.error=!0;try{Error.captureStackTrace(this,tn)}catch(e){}}}});function $c(r){if(!r)return"undefined";switch(typeof r){case"function":return r.toString();case"string":return r.toString();default:return JSON.stringify(r)}}function Kg(r,t){return $c(r)+$c(t)+"undefined"}async function Oc(r,t,e,n,i,a){let o=Kg(e,n),s;if(!i&&(s=r._cachedViews=r._cachedViews||{},s[o]))return s[o];let l=r.info().then(async function(c){let u=c.db_name+"-mrview-"+(i?"temp":Sn(o));function d(k){k.views=k.views||{};let y=t;y.indexOf("/")===-1&&(y=t+"/"+t);let g=k.views[y]=k.views[y]||{};if(!g[u])return g[u]=!0,k}await Xt(r,"_local/"+a,d);let m=(await r.registerDependentDatabase(u)).db;m.auto_compaction=!0;let b={name:u,db:m,sourceDB:r,adapter:r.adapter,mapFun:e,reduceFun:n},S;try{S=await b.db.get("_local/lastSeq")}catch(k){if(k.status!==404)throw k}return b.seq=S?S.seq:0,s&&b.db.once("destroyed",function(){delete s[o]}),b});return s&&(s[o]=l),l}function Oa(r){return r.indexOf("/")===-1?[r,r]:r.split("/")}function Jg(r){return r.length===1&&/^1-/.test(r[0].rev)}function Lc(r,t,e){try{r.emit("error",t)}catch(n){Tr("error",`The user's map/reduce function threw an uncaught error.
You can debug this error by doing:
myDatabase.on('error', function (err) { debugger; });
Please double-check your map/reduce function.`),Tr("error",t,e)}}function Qg(r,t,e,n){function i(v,x,C){try{x(C)}catch(E){Lc(v,E,{fun:x,doc:C})}}function a(v,x,C,E,P){try{return{output:x(C,E,P)}}catch(R){return Lc(v,R,{fun:x,keys:C,values:E,rereduce:P}),{error:R}}}function o(v,x){let C=ve(v.key,x.key);return C!==0?C:ve(v.value,x.value)}function s(v,x,C){return C=C||0,typeof x=="number"?v.slice(C,x+C):C>0?v.slice(C):v}function l(v){let x=v.value;return x&&typeof x=="object"&&x._id||v.id}function c(v){for(let x of v.rows){let C=x.doc&&x.doc._attachments;if(C)for(let E of Object.keys(C)){let P=C[E];C[E].data=xc(P.data,P.content_type)}}}function u(v){return function(x){return v.include_docs&&v.attachments&&v.binary&&c(x),x}}function d(v,x,C,E){let P=x[v];typeof P!="undefined"&&(E&&(P=encodeURIComponent(JSON.stringify(P))),C.push(v+"="+P))}function f(v){if(typeof v!="undefined"){let x=Number(v);return!isNaN(x)&&x===parseInt(v,10)?x:v}}function m(v){return v.group_level=f(v.group_level),v.limit=f(v.limit),v.skip=f(v.skip),v}function b(v){if(v){if(typeof v!="number")return new ot(`Invalid value for integer: "${v}"`);if(v<0)return new ot(`Invalid value for positive integer: "${v}"`)}}function S(v,x){let C=v.descending?"endkey":"startkey",E=v.descending?"startkey":"endkey";if(typeof v[C]!="undefined"&&typeof v[E]!="undefined"&&ve(v[C],v[E])>0)throw new ot("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(x.reduce&&v.reduce!==!1){if(v.include_docs)throw new ot("{include_docs:true} is invalid for reduce");if(v.keys&&v.keys.length>1&&!v.group&&!v.group_level)throw new ot("Multi-key fetches for reduce views must use {group: true}")}for(let P of["group_level","limit","skip"]){let R=b(v[P]);if(R)throw R}}async function k(v,x,C){let E=[],P,R="GET",N;if(d("reduce",C,E),d("include_docs",C,E),d("attachments",C,E),d("limit",C,E),d("descending",C,E),d("group",C,E),d("group_level",C,E),d("skip",C,E),d("stale",C,E),d("conflicts",C,E),d("startkey",C,E,!0),d("start_key",C,E,!0),d("endkey",C,E,!0),d("end_key",C,E,!0),d("inclusive_end",C,E),d("key",C,E,!0),d("update_seq",C,E),E=E.join("&"),E=E===""?"":"?"+E,typeof C.keys!="undefined"){let L=`keys=${encodeURIComponent(JSON.stringify(C.keys))}`;L.length+E.length+1<=2e3?E+=(E[0]==="?"?"&":"?")+L:(R="POST",typeof x=="string"?P={keys:C.keys}:x.keys=C.keys)}if(typeof x=="string"){let I=Oa(x),L=await v.fetch("_design/"+I[0]+"/_view/"+I[1]+E,{headers:new Yt({"Content-Type":"application/json"}),method:R,body:JSON.stringify(P)});N=L.ok;let B=await L.json();if(!N)throw B.status=L.status,kn(B);for(let q of B.rows)if(q.value&&q.value.error&&q.value.error==="builtin_reduce_error")throw new Error(q.reason);return new Promise(function(q){q(B)}).then(u(C))}P=P||{};for(let I of Object.keys(x))Array.isArray(x[I])?P[I]=x[I]:P[I]=x[I].toString();let $=await v.fetch("_temp_view"+E,{headers:new Yt({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(P)});N=$.ok;let T=await $.json();if(!N)throw T.status=$.status,kn(T);return new Promise(function(I){I(T)}).then(u(C))}function y(v,x,C){return new Promise(function(E,P){v._query(x,C,function(R,N){if(R)return P(R);E(N)})})}function g(v){return new Promise(function(x,C){v._viewCleanup(function(E,P){if(E)return C(E);x(P)})})}function h(v){return function(x){if(x.status===404)return v;throw x}}async function p(v,x,C){let E="_local/doc_"+v,P={_id:E,keys:[]},R=C.get(v),N=R[0],$=R[1];function T(){return Jg($)?Promise.resolve(P):x.db.get(E).catch(h(P))}function I(te){return te.keys.length?x.db.allDocs({keys:te.keys,include_docs:!0}):Promise.resolve({rows:[]})}function L(te,ae){let ue=[],ke=new Set;for(let V of ae.rows){let W=V.doc;if(W&&(ue.push(W),ke.add(W._id),W._deleted=!N.has(W._id),!W._deleted)){let K=N.get(W._id);"value"in K&&(W.value=K.value)}}let Oe=Ir(N);for(let V of Oe)if(!ke.has(V)){let W={_id:V},K=N.get(V);"value"in K&&(W.value=K.value),ue.push(W)}return te.keys=$a(Oe.concat(te.keys)),ue.push(te),ue}let B=await T(),q=await I(B);return L(B,q)}function w(v){return v.sourceDB.get("_local/purges").then(function(x){let C=x.purgeSeq;return v.db.get("_local/purgeSeq").then(function(E){return E._rev}).catch(h(void 0)).then(function(E){return v.db.put({_id:"_local/purgeSeq",_rev:E,purgeSeq:C})})}).catch(function(x){if(x.status!==404)throw x})}function _(v,x,C){var E="_local/lastSeq";return v.db.get(E).catch(h({_id:E,seq:0})).then(function(P){var R=Ir(x);return Promise.all(R.map(function(N){return p(N,v,x)})).then(function(N){var $=N.flat();return P.seq=C,$.push(P),v.db.bulkDocs({docs:$})}).then(()=>w(v))})}function O(v){let x=typeof v=="string"?v:v.name,C=Dc[x];return C||(C=Dc[x]=new Tn),C}async function M(v,x){return Ar(O(v),function(){return D(v,x)})()}async function D(v,x){let C,E,P;function R(V,W){let K={id:E._id,key:pt(V)};typeof W!="undefined"&&W!==null&&(K.value=pt(W)),C.push(K)}let N=t(v.mapFun,R),$=v.seq||0;function T(){return v.sourceDB.info().then(function(V){P=v.sourceDB.activeTasks.add({name:"view_indexing",total_items:V.update_seq-$})})}function I(V,W){return function(){return _(v,V,W)}}let L=0,B={view:v.name,indexed_docs:L};v.sourceDB.emit("indexing",B);let q=new Tn;async function te(){let V=await v.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:$,limit:x.changes_batch_size}),W=await ae();return ue(V,W)}function ae(){return v.db.get("_local/purgeSeq").then(function(V){return V.purgeSeq}).catch(h(-1)).then(function(V){return v.sourceDB.get("_local/purges").then(function(W){let K=W.purges.filter(function(ge,ie){return ie>V}).map(ge=>ge.docId),me=K.filter(function(ge,ie){return K.indexOf(ge)===ie});return Promise.all(me.map(function(ge){return v.sourceDB.get(ge).then(function(ie){return{docId:ge,doc:ie}}).catch(h({docId:ge}))}))}).catch(h([]))})}function ue(V,W){let K=V.results;if(!K.length&&!W.length)return;for(let ie of W)if(K.findIndex(function(Ge){return Ge.id===ie.docId})<0){let Ge={_id:ie.docId,doc:{_id:ie.docId,_deleted:1},changes:[]};ie.doc&&(Ge.doc=ie.doc,Ge.changes.push({rev:ie.doc._rev})),K.push(Ge)}let me=ke(K);q.add(I(me,$)),L=L+K.length;let ge={view:v.name,last_seq:V.last_seq,results_count:K.length,indexed_docs:L};if(v.sourceDB.emit("indexing",ge),v.sourceDB.activeTasks.update(P,{completed_items:L}),!(K.length<x.changes_batch_size))return te()}function ke(V){let W=new Map;for(let K of V){if(K.doc._id[0]!=="_"){C=[],E=K.doc,E._deleted||i(v.sourceDB,N,E),C.sort(o);let me=Oe(C);W.set(K.doc._id,[me,K.changes])}$=K.seq}return W}function Oe(V){let W=new Map,K;for(let me=0,ge=V.length;me<ge;me++){let ie=V[me],mt=[ie.key,ie.id];me>0&&ve(ie.key,K)===0&&mt.push(me),W.set(We(mt),ie),K=ie.key}return W}try{await T(),await te(),await q.finish(),v.seq=$,v.sourceDB.activeTasks.remove(P)}catch(V){v.sourceDB.activeTasks.remove(P,V)}}function z(v,x,C){C.group_level===0&&delete C.group_level;let E=C.group||C.group_level,P=e(v.reduceFun),R=[],N=isNaN(C.group_level)?Number.POSITIVE_INFINITY:C.group_level;for(let $ of x){let T=R[R.length-1],I=E?$.key:null;if(E&&Array.isArray(I)&&(I=I.slice(0,N)),T&&ve(T.groupKey,I)===0){T.keys.push([$.key,$.id]),T.values.push($.value);continue}R.push({keys:[[$.key,$.id]],values:[$.value],groupKey:I})}x=[];for(let $ of R){let T=a(v.sourceDB,P,$.keys,$.values,!1);if(T.error&&T.error instanceof tn)throw T.error;x.push({value:T.error?null:T.output,key:$.groupKey})}return{rows:s(x,C.limit,C.skip)}}function j(v,x){return Ar(O(v),function(){return Q(v,x)})()}async function Q(v,x){let C,E=v.reduceFun&&x.reduce!==!1,P=x.skip||0;typeof x.keys!="undefined"&&!x.keys.length&&(x.limit=0,delete x.keys);async function R($){$.include_docs=!0;let T=await v.db.allDocs($);return C=T.total_rows,T.rows.map(function(I){if("value"in I.doc&&typeof I.doc.value=="object"&&I.doc.value!==null){let B=Object.keys(I.doc.value).sort(),q=["id","key","value"];if(!(B<q||B>q))return I.doc.value}let L=kc(I.doc._id);return{key:L[0],id:L[1],value:"value"in I.doc?I.doc.value:null}})}async function N($){let T;if(E?T=z(v,$,x):typeof x.keys=="undefined"?T={total_rows:C,offset:P,rows:$}:T={total_rows:C,offset:P,rows:s($,x.limit,x.skip)},x.update_seq&&(T.update_seq=v.seq),x.include_docs){let I=$a($.map(l)),L=await v.sourceDB.allDocs({keys:I,include_docs:!0,conflicts:x.conflicts,attachments:x.attachments,binary:x.binary}),B=new Map;for(let q of L.rows)B.set(q.id,q.doc);for(let q of $){let te=l(q),ae=B.get(te);ae&&(q.doc=ae)}}return T}if(typeof x.keys!="undefined"){let T=x.keys.map(function(B){let q={startkey:We([B]),endkey:We([B,{}])};return x.update_seq&&(q.update_seq=!0),R(q)}),L=(await Promise.all(T)).flat();return N(L)}else{let $={descending:x.descending};x.update_seq&&($.update_seq=!0);let T,I;if("start_key"in x&&(T=x.start_key),"startkey"in x&&(T=x.startkey),"end_key"in x&&(I=x.end_key),"endkey"in x&&(I=x.endkey),typeof T!="undefined"&&($.startkey=x.descending?We([T,{}]):We([T])),typeof I!="undefined"){let B=x.inclusive_end!==!1;x.descending&&(B=!B),$.endkey=We(B?[I,{}]:[I])}if(typeof x.key!="undefined"){let B=We([x.key]),q=We([x.key,{}]);$.descending?($.endkey=B,$.startkey=q):($.startkey=B,$.endkey=q)}E||(typeof x.limit=="number"&&($.limit=x.limit),$.skip=P);let L=await R($);return N(L)}}async function U(v){return(await v.fetch("_view_cleanup",{headers:new Yt({"Content-Type":"application/json"}),method:"POST"})).json()}async function H(v){try{let x=await v.get("_local/"+r),C=new Map;for(let T of Object.keys(x.views)){let I=Oa(T),L="_design/"+I[0],B=I[1],q=C.get(L);q||(q=new Set,C.set(L,q)),q.add(B)}let E={keys:Ir(C),include_docs:!0},P=await v.allDocs(E),R={};for(let T of P.rows){let I=T.key.substring(8);for(let L of C.get(T.key)){let B=I+"/"+L;x.views[B]||(B=L);let q=Object.keys(x.views[B]),te=T.doc&&T.doc.views&&T.doc.views[L];for(let ae of q)R[ae]=R[ae]||te}}let $=Object.keys(R).filter(function(T){return!R[T]}).map(function(T){return Ar(O(T),function(){return new v.constructor(T,v.__opts).destroy()})()});return Promise.all($).then(function(){return{ok:!0}})}catch(x){if(x.status===404)return{ok:!0};throw x}}async function J(v,x,C){if(typeof v._query=="function")return y(v,x,C);if(dt(v))return k(v,x,C);let E={changes_batch_size:v.__opts.view_update_changes_batch_size||Gg};if(typeof x!="string")return S(C,x),Mc.add(async function(){let P=await Oc(v,"temp_view/temp_view",x.map,x.reduce,!0,r);return Ic(M(P,E).then(function(){return j(P,C)}),function(){return P.db.destroy()})}),Mc.finish();{let P=x,R=Oa(P),N=R[0],$=R[1],T=await v.get("_design/"+N);if(x=T.views&&T.views[$],!x)throw new en(`ddoc ${T._id} has no view named ${$}`);n(T,$),S(C,x);let I=await Oc(v,P,x.map,x.reduce,!1,r);return C.stale==="ok"||C.stale==="update_after"?(C.stale==="update_after"&&Cn(function(){M(I,E)}),j(I,C)):(await M(I,E),j(I,C))}}function Y(v,x,C){let E=this;typeof x=="function"&&(C=x,x={}),x=x?m(x):{},typeof v=="function"&&(v={map:v});let P=Promise.resolve().then(function(){return J(E,v,x)});return Pa(P,C),P}let re=Ac(function(){let v=this;return typeof v._viewCleanup=="function"?g(v):dt(v)?U(v):H(v)});return{query:Y,viewCleanup:re}}var Tn,Dc,Mc,Gg,Rc,Fc=F(()=>{Ea();Cr();Sr();Ca();En();Er();Pc();Tn=class{constructor(){this.promise=Promise.resolve()}add(t){return this.promise=this.promise.catch(()=>{}).then(()=>t()),this.promise}finish(){return this.promise}};Dc={},Mc=new Tn,Gg=50;Rc=Qg});function rn(r,t){for(var e=r,n=0,i=t.length;n<i;n++){var a=t[n];if(e=e[a],!e)break}return e}function jc(r,t,e){for(var n=0,i=t.length;n<i-1;n++){var a=t[n];r=r[a]=r[a]||{}}r[t[i-1]]=e}function $r(r,t){return r<t?-1:r>t?1:0}function gt(r){for(var t=[],e="",n=0,i=r.length;n<i;n++){var a=r[n];n>0&&r[n-1]==="\\"&&(a==="$"||a===".")?e=e.substring(0,e.length-1)+a:a==="."?(t.push(e),e=""):e+=a}return t.push(e),t}function zc(r){return Zg.indexOf(r)>-1}function Re(r){return Object.keys(r)[0]}function Or(r){return r[Re(r)]}function In(r){var t={},e={$or:!0,$nor:!0};return r.forEach(function(n){Object.keys(n).forEach(function(i){var a=n[i];if(typeof a!="object"&&(a={$eq:a}),zc(i))if(a instanceof Array){if(e[i]){e[i]=!1,t[i]=a;return}var o=[];t[i].forEach(function(l){Object.keys(a).forEach(function(c){var u=a[c],d=Math.max(Object.keys(l).length,Object.keys(u).length),f=In([l,u]);Object.keys(f).length<=d||o.push(f)})}),t[i]=o}else t[i]=In([a]);else{var s=t[i]=t[i]||{};Object.keys(a).forEach(function(l){var c=a[l];if(l==="$gt"||l==="$gte")return Yg(l,c,s);if(l==="$lt"||l==="$lte")return Xg(l,c,s);if(l==="$ne")return em(c,s);if(l==="$eq")return tm(c,s);if(l==="$regex")return nm(c,s);s[l]=c})}})}),t}function Yg(r,t,e){typeof e.$eq=="undefined"&&(typeof e.$gte!="undefined"?r==="$gte"?t>e.$gte&&(e.$gte=t):t>=e.$gte&&(delete e.$gte,e.$gt=t):typeof e.$gt!="undefined"?r==="$gte"?t>e.$gt&&(delete e.$gt,e.$gte=t):t>e.$gt&&(e.$gt=t):e[r]=t)}function Xg(r,t,e){typeof e.$eq=="undefined"&&(typeof e.$lte!="undefined"?r==="$lte"?t<e.$lte&&(e.$lte=t):t<=e.$lte&&(delete e.$lte,e.$lt=t):typeof e.$lt!="undefined"?r==="$lte"?t<e.$lt&&(delete e.$lt,e.$lte=t):t<e.$lt&&(e.$lt=t):e[r]=t)}function em(r,t){"$ne"in t?t.$ne.push(r):t.$ne=[r]}function tm(r,t){delete t.$gt,delete t.$gte,delete t.$lt,delete t.$lte,delete t.$ne,t.$eq=r}function nm(r,t){"$regex"in t?t.$regex.push(r):t.$regex=[r]}function Uc(r){for(var t in r){if(Array.isArray(r))for(var e in r)r[e].$and&&(r[e]=In(r[e].$and));var n=r[t];typeof n=="object"&&Uc(n)}return r}function Hc(r,t){for(var e in r){e==="$and"&&(t=!0);var n=r[e];typeof n=="object"&&(t=Hc(n,t))}return t}function Dr(r){var t=ut(r);Hc(t,!1)&&(t=Uc(t),"$and"in t&&(t=In(t.$and))),["$or","$nor"].forEach(function(o){o in t&&t[o].forEach(function(s){for(var l=Object.keys(s),c=0;c<l.length;c++){var u=l[c],d=s[u];(typeof d!="object"||d===null)&&(s[u]={$eq:d})}})}),"$not"in t&&(t.$not=In([t.$not]));for(var e=Object.keys(t),n=0;n<e.length;n++){var i=e[n],a=t[i];(typeof a!="object"||a===null)&&(a={$eq:a}),t[i]=a}return Da(t),t}function Da(r){Object.keys(r).forEach(function(t){var e=r[t];Array.isArray(e)?e.forEach(function(n){n&&typeof n=="object"&&Da(n)}):t==="$ne"?r.$ne=[e]:t==="$regex"?r.$regex=[e]:e&&typeof e=="object"&&Da(e)})}function rm(r){function t(e){return r.map(function(n){var i=Re(n),a=gt(i),o=rn(e,a);return o})}return function(e,n){var i=t(e.doc),a=t(n.doc),o=ve(i,a);return o!==0?o:$r(e.doc._id,n.doc._id)}}function Ma(r,t,e){if(r=r.filter(function(o){return nn(o.doc,t.selector,e)}),t.sort){var n=rm(t.sort);r=r.sort(n),typeof t.sort[0]!="string"&&Or(t.sort[0])==="desc"&&(r=r.reverse())}if("limit"in t||"skip"in t){var i=t.skip||0,a=("limit"in t?t.limit:r.length)+i;r=r.slice(i,a)}return r}function nn(r,t,e){return e.every(function(n){var i=t[n],a=gt(n),o=rn(r,a);return zc(n)?im(n,i,r):Pr(i,r,a,o)})}function Pr(r,t,e,n){return r?typeof r=="object"?Object.keys(r).every(function(i){var a=r[i];if(i.indexOf("$")===0)return Bc(i,t,a,e,n);var o=gt(i);if(n===void 0&&typeof a!="object"&&o.length>0)return!1;var s=rn(n,o);return typeof a=="object"?Pr(a,t,e,s):Bc("$eq",t,a,o,s)}):r===n:!0}function im(r,t,e){return r==="$or"?t.some(function(n){return nn(e,n,Object.keys(n))}):r==="$not"?!nn(e,t,Object.keys(t)):!t.find(function(n){return nn(e,n,Object.keys(n))})}function Bc(r,t,e,n,i){if(!Nc[r])throw new Error('unknown operator "'+r+'" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all');return Nc[r](t,e,n,i)}function An(r){return typeof r!="undefined"&&r!==null}function Et(r){return typeof r!="undefined"}function am(r,t){if(typeof r!="number"||parseInt(r,10)!==r)return!1;var e=t[0],n=t[1];return r%e===n}function qc(r,t){return t.some(function(e){return r instanceof Array?r.some(function(n){return ve(e,n)===0}):ve(e,r)===0})}function om(r,t){return t.every(function(e){return r.some(function(n){return ve(e,n)===0})})}function sm(r,t){return r.length===t}function lm(r,t){var e=new RegExp(t);return e.test(r)}function cm(r,t){switch(t){case"null":return r===null;case"boolean":return typeof r=="boolean";case"number":return typeof r=="number";case"string":return typeof r=="string";case"array":return r instanceof Array;case"object":return{}.toString.call(r)==="[object Object]"}}function Pn(r,t){if(typeof t!="object")throw new Error("Selector error: expected a JSON object");t=Dr(t);var e={doc:r},n=Ma([e],{selector:t},Object.keys(t));return n&&n.length===1}var Zg,Nc,Wc=F(()=>{En();Cr();Zg=["$or","$nor","$not"];Nc={$elemMatch:function(r,t,e,n){return!Array.isArray(n)||n.length===0?!1:typeof n[0]=="object"&&n[0]!==null?n.some(function(i){return nn(i,t,Object.keys(t))}):n.some(function(i){return Pr(t,r,e,i)})},$allMatch:function(r,t,e,n){return!Array.isArray(n)||n.length===0?!1:typeof n[0]=="object"&&n[0]!==null?n.every(function(i){return nn(i,t,Object.keys(t))}):n.every(function(i){return Pr(t,r,e,i)})},$eq:function(r,t,e,n){return Et(n)&&ve(n,t)===0},$gte:function(r,t,e,n){return Et(n)&&ve(n,t)>=0},$gt:function(r,t,e,n){return Et(n)&&ve(n,t)>0},$lte:function(r,t,e,n){return Et(n)&&ve(n,t)<=0},$lt:function(r,t,e,n){return Et(n)&&ve(n,t)<0},$exists:function(r,t,e,n){return t?Et(n):!Et(n)},$mod:function(r,t,e,n){return An(n)&&am(n,t)},$ne:function(r,t,e,n){return t.every(function(i){return ve(n,i)!==0})},$in:function(r,t,e,n){return An(n)&&qc(n,t)},$nin:function(r,t,e,n){return An(n)&&!qc(n,t)},$size:function(r,t,e,n){return An(n)&&Array.isArray(n)&&sm(n,t)},$all:function(r,t,e,n){return Array.isArray(n)&&om(n,t)},$regex:function(r,t,e,n){return An(n)&&typeof n=="string"&&t.every(function(i){return lm(n,i)})},$type:function(r,t,e,n){return cm(n,t)}}});var ru={};ht(ru,{default:()=>vv});function Fa(r){let t={};for(let e of r)Object.assign(t,e);return t}function dm(r,t){let e={};for(let n of t){let i=gt(n),a=rn(r,i);typeof a!="undefined"&&jc(e,i,a)}return e}function Jc(r,t){for(let e=0,n=Math.min(r.length,t.length);e<n;e++)if(r[e]!==t[e])return!1;return!0}function fm(r,t){return r.length>t.length?!1:Jc(r,t)}function hm(r,t){r=r.slice();for(let e of t){if(!r.length)break;let n=r.indexOf(e);if(n===-1)return!1;r.splice(n,1)}return!0}function pm(r){let t={};for(let e of r)t[e]=!0;return t}function gm(r,t){let e=null,n=-1;for(let i of r){let a=t(i);a>n&&(n=a,e=i)}return e}function Vc(r,t){if(r.length!==t.length)return!1;for(let e=0,n=r.length;e<n;e++)if(r[e]!==t[e])return!1;return!0}function mm(r){return Array.from(new Set(r))}function $n(r){return function(...t){let e=t[t.length-1];if(typeof e=="function"){let n=e.bind(null,null),i=e.bind(null);r.apply(this,t.slice(0,-1)).then(n,i)}else return r.apply(this,t)}}function Qc(r){r=ut(r),r.index||(r.index={});for(let t of["type","name","ddoc"])r.index[t]&&(r[t]=r.index[t],delete r.index[t]);return r.fields&&(r.index.fields=r.fields,delete r.fields),r.type||(r.type="json"),r}function Mr(r){return typeof r=="object"&&r!==null}function vm(r,t,e){let n="",i=t,a=!0;if(["$in","$nin","$or","$and","$mod","$nor","$all"].indexOf(r)!==-1&&(Array.isArray(t)||(n="Query operator "+r+" must be an array.")),["$not","$elemMatch","$allMatch"].indexOf(r)!==-1&&(!Array.isArray(t)&&Mr(t)||(n="Query operator "+r+" must be an object.")),r==="$mod"&&Array.isArray(t))if(t.length!==2)n="Query operator $mod must be in the format [divisor, remainder], where divisor and remainder are both integers.";else{let o=t[0],s=t[1];o===0&&(n="Query operator $mod's divisor cannot be 0, cannot divide by zero.",a=!1),(typeof o!="number"||parseInt(o,10)!==o)&&(n="Query operator $mod's divisor is not an integer.",i=o),parseInt(s,10)!==s&&(n="Query operator $mod's remainder is not an integer.",i=s)}if(r==="$exists"&&typeof t!="boolean"&&(n="Query operator $exists must be a boolean."),r==="$type"){let o=["null","boolean","number","string","array","object"],s='"'+o.slice(0,o.length-1).join('", "')+'", or "'+o[o.length-1]+'"';(typeof t!="string"||o.indexOf(t)==-1)&&(n="Query operator $type must be a string. Supported values: "+s+".")}if(r==="$size"&&parseInt(t,10)!==t&&(n="Query operator $size must be a integer."),r==="$regex"&&typeof t!="string"&&(e?n="Query operator $regex must be a string.":t instanceof RegExp||(n="Query operator $regex must be a string or an instance of a javascript regular expression.")),n){if(a){let o=i===null?" ":Array.isArray(i)?" array":" "+typeof i,s=Mr(i)?JSON.stringify(i,null,"	"):i;n+=" Received"+o+": "+s}throw new Error(n)}}function Lr(r,t){if(Array.isArray(r))for(let e of r)Mr(e)&&Lr(e,t);else for(let[e,n]of Object.entries(r))ym.indexOf(e)!==-1&&vm(e,n,t),bm.indexOf(e)===-1&&wm.indexOf(e)===-1&&Mr(n)&&Lr(n,t)}async function On(r,t,e){e.body&&(e.body=JSON.stringify(e.body),e.headers=new Yt({"Content-type":"application/json"}));let n=await r.fetch(t,e),i=await n.json();if(!n.ok){i.status=n.status;let a=Sa(i);throw kn(a)}return i}async function xm(r,t){return await On(r,"_index",{method:"POST",body:Qc(t)})}async function _m(r,t){return Lr(t.selector,!0),await On(r,"_find",{method:"POST",body:t})}async function km(r,t){return await On(r,"_explain",{method:"POST",body:t})}async function Sm(r){return await On(r,"_index",{method:"GET"})}async function Cm(r,t){let e=t.ddoc,n=t.type||"json",i=t.name;if(!e)throw new Error("you must provide an index's ddoc");if(!i)throw new Error("you must provide an index's name");let a="_index/"+[e,n,i].map(encodeURIComponent).join("/");return await On(r,a,{method:"DELETE"})}function Zc(r,t){for(let e of t)if(r=r[e],r===void 0)return;return r}function Em(r,t,e){return function(n){if(e&&!Pn(n,e))return;let i=[];for(let a of r){let o=Zc(n,gt(a));if(o===void 0)return;i.push(o)}t(i)}}function Tm(r,t,e){let n=gt(r);return function(i){if(e&&!Pn(i,e))return;let a=Zc(i,n);a!==void 0&&t(a)}}function Am(r,t,e){return function(n){e&&!Pn(n,e)||t(n[r])}}function Im(r,t,e){return function(n){if(e&&!Pn(n,e))return;let i=r.map(a=>n[a]);t(i)}}function Pm(r){return r.every(t=>t.indexOf(".")===-1)}function $m(r,t,e){let n=Pm(r),i=r.length===1;return n?i?Am(r[0],t,e):Im(r,t,e):i?Tm(r[0],t,e):Em(r,t,e)}function Om(r,t){let e=Object.keys(r.fields),n=r.partial_filter_selector;return $m(e,t,n)}function Dm(){throw new Error("reduce not supported")}function Mm(r,t){let e=r.views[t];if(!e.map||!e.map.fields)throw new Error("ddoc "+r._id+" with view "+t+" doesn't have map.fields defined. maybe it wasn't created by this plugin?")}function Ba(r){return r._customFindAbstractMapper?{query:function(e,n){let i=La.query.bind(this);return r._customFindAbstractMapper.query.call(this,e,n,i)},viewCleanup:function(){let e=La.viewCleanup.bind(this);return r._customFindAbstractMapper.viewCleanup.call(this,e)}}:La}function Lm(r){if(!Array.isArray(r))throw new Error("invalid sort json - should be an array");return r.map(function(t){if(typeof t=="string"){let e={};return e[t]="asc",e}else return t})}function Fm(r){let t=[];return typeof r=="string"?t.push(r):t=r,t.map(function(e){return e.replace(Rm,"")})}function Yc(r){return r.fields=r.fields.map(function(t){if(typeof t=="string"){let e={};return e[t]="asc",e}return t}),r.partial_filter_selector&&(r.partial_filter_selector=Dr(r.partial_filter_selector)),r}function Bm(r,t){return t.def.fields.map(e=>{let n=Re(e);return rn(r,gt(n))})}function qm(r,t,e){let n=e.def.fields,i=0;for(let a of r){let o=Bm(a.doc,e);if(n.length===1)o=o[0];else for(;o.length>t.length;)o.pop();if(Math.abs(ve(o,t))>0)break;++i}return i>0?r.slice(i):r}function Nm(r){let t=ut(r);return delete t.startkey,delete t.endkey,delete t.inclusive_start,delete t.inclusive_end,"endkey"in r&&(t.startkey=r.endkey),"startkey"in r&&(t.endkey=r.startkey),"inclusive_start"in r&&(t.inclusive_end=r.inclusive_start),"inclusive_end"in r&&(t.inclusive_start=r.inclusive_end),t}function jm(r){let t=r.fields.filter(function(e){return Or(e)==="asc"});if(t.length!==0&&t.length!==r.fields.length)throw new Error("unsupported mixed sorting")}function zm(r,t){if(t.defaultUsed&&r.sort){let e=r.sort.filter(function(n){return Object.keys(n)[0]!=="_id"}).map(function(n){return Object.keys(n)[0]});if(e.length>0)throw new Error('Cannot sort on field(s) "'+e.join(",")+'" when using the default index')}t.defaultUsed}function Um(r){if(typeof r.selector!="object")throw new Error("you must provide a selector when you find()")}function Hm(r,t){let e=Object.keys(r),n=t?t.map(Re):[],i;return e.length>=n.length?i=e:i=n,n.length===0?{fields:i}:(i=i.sort(function(a,o){let s=n.indexOf(a);s===-1&&(s=Number.MAX_VALUE);let l=n.indexOf(o);return l===-1&&(l=Number.MAX_VALUE),s<l?-1:s>l?1:0}),{fields:i,sortOrder:t.map(Re)})}async function Wm(r,t){t=Qc(t);let e=ut(t.index);t.index=Yc(t.index),jm(t.index);let n;function i(){return n||(n=Sn(JSON.stringify(t)))}let a=t.name||"idx-"+i(),o=t.ddoc||"idx-"+i(),s="_design/"+o,l=!1,c=!1;function u(f){return f._rev&&f.language!=="query"&&(l=!0),f.language="query",f.views=f.views||{},c=!!f.views[a],c?!1:(f.views[a]={map:{fields:Fa(t.index.fields),partial_filter_selector:t.index.partial_filter_selector},reduce:"_count",options:{def:e}},f)}if(r.constructor.emit("debug",["find","creating index",s]),await Xt(r,s,u),l)throw new Error('invalid language for ddoc with id "'+s+'" (should be "query")');let d=o+"/"+a;return await Ba(r).query.call(r,d,{limit:0,reduce:!1}),{id:s,name:a,result:c?"exists":"created"}}async function Xc(r){let t=await r.allDocs({startkey:"_design/",endkey:"_design/\uFFFF",include_docs:!0}),e={indexes:[{ddoc:null,name:"_all_docs",type:"special",def:{fields:[{_id:"asc"}]}}]};return e.indexes=Gc(e.indexes,t.rows.filter(function(n){return n.doc.language==="query"}).map(function(n){return(n.doc.views!==void 0?Object.keys(n.doc.views):[]).map(function(a){let o=n.doc.views[a];return{ddoc:n.id,name:a,type:"json",def:Yc(o.options.def)}})})),e.indexes.sort(function(n,i){return $r(n.name,i.name)}),e.total_rows=e.indexes.length,e}function Km(r,t){return r.def.fields.some(e=>Re(e)===t)}function Gm(r,t){let e=r[t];return Re(e)!=="$eq"}function eu(r,t){let e=t.def.fields.map(Re);return r.slice().sort(function(n,i){let a=e.indexOf(n),o=e.indexOf(i);return a===-1&&(a=Number.MAX_VALUE),o===-1&&(o=Number.MAX_VALUE),$r(a,o)})}function Jm(r,t,e){e=eu(e,r);let n=!1;for(let i=0,a=e.length;i<a;i++){let o=e[i];if(n||!Km(r,o))return e.slice(i);i<a-1&&Gm(t,o)&&(n=!0)}return[]}function Qm(r){let t=[];for(let[e,n]of Object.entries(r))for(let i of Object.keys(n))i==="$ne"&&t.push(e);return t}function Zm(r,t,e,n){let i=Gc(r,Jm(t,e,n),Qm(e));return eu(mm(i),t)}function Ym(r,t,e){if(t){let n=fm(t,r),i=Jc(e,r);return n&&i}return hm(e,r)}function tu(r){return Xm.indexOf(r)===-1}function ev(r,t){let e=r[0],n=t[e];return typeof n=="undefined"?!0:!(Object.keys(n).length===1&&Re(n)==="$ne")}function tv(r,t,e,n){let i=r.def.fields.map(Re);return Ym(i,t,e)?ev(i,n):!1}function nv(r,t,e,n){return n.filter(function(i){return tv(i,e,t,r)})}function rv(r,t,e,n,i){let a=nv(r,t,e,n);if(a.length===0){if(i)throw{error:"no_usable_index",message:"There is no index available for this selector."};let l=n[0];return l.defaultUsed=!0,l}if(a.length===1&&!i)return a[0];let o=pm(t);function s(l){let c=l.def.fields.map(Re),u=0;for(let d of c)o[d]&&u++;return u}if(i){let l="_design/"+i[0],c=i.length===2?i[1]:!1,u=a.find(function(d){return!!(c&&d.ddoc===l&&c===d.name||d.ddoc===l)});if(!u)throw{error:"unknown_error",message:"Could not find that index or could not use that index for the query"};return u}return gm(a,s)}function iv(r,t){switch(r){case"$eq":return{key:t};case"$lte":return{endkey:t};case"$gte":return{startkey:t};case"$lt":return{endkey:t,inclusive_end:!1};case"$gt":return{startkey:t,inclusive_start:!1}}return{startkey:Rr}}function av(r,t){let e=Re(t.def.fields[0]),n=r[e]||{},i=[],a=Object.keys(n),o;for(let s of a){tu(s)&&i.push(e);let l=n[s],c=iv(s,l);o?o=Fa([o,c]):o=c}return{queryOpts:o,inMemoryFields:i}}function ov(r,t){switch(r){case"$eq":return{startkey:t,endkey:t};case"$lte":return{endkey:t};case"$gte":return{startkey:t};case"$lt":return{endkey:t,inclusive_end:!1};case"$gt":return{startkey:t,inclusive_start:!1}}}function sv(r,t){let e=t.def.fields.map(Re),n=[],i=[],a=[],o,s;function l(u){o!==!1&&i.push(Rr),s!==!1&&a.push(Ra),n=e.slice(u)}for(let u=0,d=e.length;u<d;u++){let f=e[u],m=r[f];if(!m||!Object.keys(m).length){l(u);break}else if(Object.keys(m).some(tu)){l(u);break}else if(u>0){let k="$gt"in m||"$gte"in m||"$lt"in m||"$lte"in m,y=Object.keys(r[e[u-1]]),g=Vc(y,["$eq"]),h=Vc(y,Object.keys(m));if(k&&!g&&!h){l(u);break}}let b=Object.keys(m),S=null;for(let k of b){let y=m[k],g=ov(k,y);S?S=Fa([S,g]):S=g}i.push("startkey"in S?S.startkey:Rr),a.push("endkey"in S?S.endkey:Ra),"inclusive_start"in S&&(o=S.inclusive_start),"inclusive_end"in S&&(s=S.inclusive_end)}let c={startkey:i,endkey:a};return typeof o!="undefined"&&(c.inclusive_start=o),typeof s!="undefined"&&(c.inclusive_end=s),{queryOpts:c,inMemoryFields:n}}function lv(r){return Object.keys(r).map(function(e){return r[e]}).some(function(e){return typeof e=="object"&&Object.keys(e).length===0})}function cv(r){return{queryOpts:{startkey:null},inMemoryFields:[Object.keys(r)]}}function uv(r,t){return t.defaultUsed?cv(r,t):t.def.fields.length===1?av(r,t):sv(r,t)}function dv(r,t){let e=r.selector,n=r.sort;if(lv(e))return Object.assign({},Vm,{index:t[0]});let i=Hm(e,n),a=i.fields,o=i.sortOrder,s=rv(e,a,o,t,r.use_index),l=uv(e,s),c=l.queryOpts,u=l.inMemoryFields,d=Zm(u,s,e,a);return{queryOpts:c,index:s,inMemoryFields:d}}function fv(r){return r.ddoc.substring(8)+"/"+r.name}async function hv(r,t){let e=ut(t);e.descending?("endkey"in e&&typeof e.endkey!="string"&&(e.endkey=""),"startkey"in e&&typeof e.startkey!="string"&&(e.limit=0)):("startkey"in e&&typeof e.startkey!="string"&&(e.startkey=""),"endkey"in e&&typeof e.endkey!="string"&&(e.limit=0)),"key"in e&&typeof e.key!="string"&&(e.limit=0),e.limit>0&&e.indexes_count&&(e.original_limit=e.limit,e.limit+=e.indexes_count);let n=await r.allDocs(e);return n.rows=n.rows.filter(function(i){return!/^_design\//.test(i.id)}),e.original_limit&&(e.limit=e.original_limit),n.rows=n.rows.slice(0,e.limit),n}async function pv(r,t,e){return e.name==="_all_docs"?hv(r,t):Ba(r).query.call(r,fv(e),t)}async function nu(r,t,e){t.selector&&(Lr(t.selector,!1),t.selector=Dr(t.selector)),t.sort&&(t.sort=Lm(t.sort)),t.use_index&&(t.use_index=Fm(t.use_index)),"limit"in t||(t.limit=25),Um(t);let n=await Xc(r);r.constructor.emit("debug",["find","planning query",t]);let i=dv(t,n.indexes);r.constructor.emit("debug",["find","query plan",i]);let a=i.index;zm(t,a);let o=Object.assign({include_docs:!0,reduce:!1,indexes_count:n.total_rows},i.queryOpts);if("startkey"in o&&"endkey"in o&&ve(o.startkey,o.endkey)>0)return{docs:[]};if(t.sort&&typeof t.sort[0]!="string"&&Or(t.sort[0])==="desc"&&(o.descending=!0,o=Nm(o)),i.inMemoryFields.length||(o.limit=t.limit,"skip"in t&&(o.skip=t.skip)),e)return Promise.resolve(i,o);let l=await pv(r,o,a);o.inclusive_start===!1&&(l.rows=qm(l.rows,o.startkey,a)),i.inMemoryFields.length&&(l.rows=Ma(l.rows,t,i.inMemoryFields));let c={docs:l.rows.map(function(u){let d=u.doc;return t.fields?dm(d,t.fields):d})};return a.defaultUsed&&(c.warning="No matching index found, create an index to optimize query time."),c}async function gv(r,t){let e=await nu(r,t,!0);return{dbname:r.name,index:e.index,selector:t.selector,range:{start_key:e.queryOpts.startkey,end_key:e.queryOpts.endkey},opts:{use_index:t.use_index||[],bookmark:"nil",limit:t.limit,skip:t.skip,sort:t.sort||{},fields:t.fields,conflicts:!1,r:[49]},limit:t.limit,skip:t.skip||0,fields:t.fields}}async function mv(r,t){if(!t.ddoc)throw new Error("you must supply an index.ddoc when deleting");if(!t.name)throw new Error("you must supply an index.name when deleting");let e=t.ddoc,n=t.name;function i(a){return Object.keys(a.views).length===1&&a.views[n]?{_id:e,_deleted:!0}:(delete a.views[n],a)}return await Xt(r,e,i),await Ba(r).viewCleanup.apply(r),{ok:!0}}var um,Kc,Gc,ym,wm,bm,La,Rm,Rr,Ra,Vm,Xm,an,vv,iu=F(()=>{Sr();Ca();Fc();Er();Cr();Wc();En();um=(...r)=>r.flat(1/0),Kc=(...r)=>{let t=[];for(let e of r)Array.isArray(e)?t=t.concat(Kc(...e)):t.push(e);return t},Gc=typeof Array.prototype.flat=="function"?um:Kc;ym=["$all","$allMatch","$and","$elemMatch","$exists","$in","$mod","$nin","$nor","$not","$or","$regex","$size","$type"],wm=["$in","$nin","$mod","$all"],bm=["$eq","$gt","$gte","$lt","$lte"];La=Rc("indexes",Om,Dm,Mm);Rm=/^_design\//;Rr=null,Ra={"\uFFFF":{}},Vm={queryOpts:{limit:0,startkey:Ra,endkey:Rr},inMemoryFields:[]};Xm=["$eq","$gt","$gte","$lt","$lte"];an={};an.createIndex=$n(async function(r){if(typeof r!="object")throw new Error("you must provide an index to create");return(dt(this)?xm:Wm)(this,r)});an.find=$n(async function(r){if(typeof r!="object")throw new Error("you must provide search parameters to find()");return(dt(this)?_m:nu)(this,r)});an.explain=$n(async function(r){if(typeof r!="object")throw new Error("you must provide search parameters to explain()");return(dt(this)?km:gv)(this,r)});an.getIndexes=$n(async function(){return(dt(this)?Sm:Xc)(this)});an.deleteIndex=$n(async function(r){if(typeof r!="object")throw new Error("you must provide an index to delete");return(dt(this)?Cm:mv)(this,r)});vv=an});var su={};ht(su,{LocalDraftManager:()=>ft,initDraftDB:()=>qa});var au,Fr,ou,qa,Tt,ft,Dn=F(()=>{au=require("obsidian");Ut();$e();Fr=null,ou=async()=>{if(Fr)return Fr;try{let{default:r}=await Promise.resolve().then(()=>(ka(),_a)),{default:t}=await Promise.resolve().then(()=>(iu(),ru));return r.plugin(t),Fr=new r("one2mp-local-drafts"),Fr}catch(r){return console.warn("PouchDB \u521D\u59CB\u5316\u5931\u8D25\uFF0C\u6539\u7528\u5185\u5B58\u8349\u7A3F\u5B58\u50A8",r),null}},qa=async()=>{await ou()},Tt=class{constructor(t){this.db=null;this.fallbackDrafts={};this.fallbackLoaded=!1;this.plugin=t}static getInstance(t){return Tt.instance||(Tt.instance=new Tt(t)),Tt.instance}static resetInstance(){Tt.instance=null}async ensureFallbackLoaded(){if(!this.fallbackLoaded)try{let t=await this.plugin.loadData(),e=t==null?void 0:t.local_drafts;e&&typeof e=="object"&&(this.fallbackDrafts=e)}catch(t){console.warn("\u52A0\u8F7D\u672C\u5730\u8349\u7A3F\u7F13\u5B58\u5931\u8D25",t)}finally{this.fallbackLoaded=!0}}async saveFallbackDrafts(){try{let t=await this.plugin.loadData();await this.plugin.saveData({...t!=null?t:{},local_drafts:this.fallbackDrafts})}catch(t){console.warn("\u4FDD\u5B58\u672C\u5730\u8349\u7A3F\u7F13\u5B58\u5931\u8D25",t)}}async getDb(){return this.db!==null?this.db:au.Platform.isMobile?null:(this.db=await ou(),this.db)}async getDrafOfActiveNote(){let t,e=this.plugin.settings.selectedMPAccount;if(e!==void 0&&e){let n=this.plugin.app.workspace.getActiveFile();n&&(t=await this.getDraft(e,n.path),t===void 0&&(t={accountName:e,notePath:n.path,title:n.basename,_id:e+n.path},await this.setDraft(t)),t.title.trim()===""&&(t.title=n.basename,await this.setDraft(t)))}return t}isActiveNoteDraft(t){let e=this.plugin.app.workspace.getActiveFile();return t===void 0&&e===null?!0:t!==void 0&&e?t.notePath===e.path:!1}async getDraft(t,e){let n=await this.getDb();return n?new Promise(i=>{n.get(t+e).then(a=>{i(a)}).catch(()=>{i(void 0)})}):(await this.ensureFallbackLoaded(),this.fallbackDrafts[t+e])}async setDraft(t){let e=i=>i instanceof Error?i:new Error(String(i)),n=await this.getDb();if(!n){if(await this.ensureFallbackLoaded(),!t.accountName||!t.notePath)throw new Error(A("assets.invalid-draft"));t._id||(t._id=t.accountName+t.notePath);let i=this.fallbackDrafts[t._id];return i&&zt(t,i)||(this.fallbackDrafts[t._id]={...t},await this.saveFallbackDrafts()),!0}return new Promise((i,a)=>{if(!t.accountName||!t.notePath)return a(new Error(A("assets.invalid-draft")));t._id||(t._id=t.accountName+t.notePath),n.get(t._id).then(o=>{if(zt(t,o)){i(!0);return}else return t._rev=o._rev,n.put(t).then(()=>i(!0)).catch(()=>{i(!1)});i(!1)}).catch(o=>{if(o.status===404)return n.put(t).then(()=>i(!0)).catch(s=>{console.error("Error creating new draft:",s),a(e(s))});console.error("Error checking existing draft:",o),a(e(o))})})}},ft=Tt;ft.instance=null});function qe(r){return yv.get(r)||"unknow error."}var yv,lu=F(()=>{yv=new Map([[-1,"\u7CFB\u7EDF\u7E41\u5FD9\uFF0C\u6B64\u65F6\u8BF7\u5F00\u53D1\u8005\u7A0D\u5019\u518D\u8BD5"],[0,"\u8BF7\u6C42\u6210\u529F"],[40001,"\u83B7\u53D6 access_token \u65F6 AppSecret \u9519\u8BEF\uFF0C\u6216\u8005 access_token \u65E0\u6548\u3002\u8BF7\u5F00\u53D1\u8005\u8BA4\u771F\u6BD4\u5BF9 AppSecret \u7684\u6B63\u786E\u6027\uFF0C\u6216\u67E5\u770B\u662F\u5426\u6B63\u5728\u4E3A\u6070\u5F53\u7684\u516C\u4F17\u53F7\u8C03\u7528\u63A5\u53E3"],[40002,"\u4E0D\u5408\u6CD5\u7684\u51ED\u8BC1\u7C7B\u578B"],[40003,"\u4E0D\u5408\u6CD5\u7684 OpenID \uFF0C\u8BF7\u5F00\u53D1\u8005\u786E\u8BA4 OpenID \uFF08\u8BE5\u7528\u6237\uFF09\u662F\u5426\u5DF2\u5173\u6CE8\u516C\u4F17\u53F7\uFF0C\u6216\u662F\u5426\u662F\u5176\u4ED6\u516C\u4F17\u53F7\u7684 OpenID"],[40004,"\u4E0D\u5408\u6CD5\u7684\u5A92\u4F53\u6587\u4EF6\u7C7B\u578B"],[40005,"\u4E0D\u5408\u6CD5\u7684\u6587\u4EF6\u7C7B\u578B"],[40006,"\u4E0D\u5408\u6CD5\u7684\u6587\u4EF6\u5927\u5C0F"],[40007,"\u4E0D\u5408\u6CD5\u7684\u5A92\u4F53\u6587\u4EF6 id"],[40008,"\u4E0D\u5408\u6CD5\u7684\u6D88\u606F\u7C7B\u578B"],[40009,"\u4E0D\u5408\u6CD5\u7684\u56FE\u7247\u6587\u4EF6\u5927\u5C0F"],[40010,"\u4E0D\u5408\u6CD5\u7684\u8BED\u97F3\u6587\u4EF6\u5927\u5C0F"],[40011,"\u4E0D\u5408\u6CD5\u7684\u89C6\u9891\u6587\u4EF6\u5927\u5C0F"],[40012,"\u4E0D\u5408\u6CD5\u7684\u7F29\u7565\u56FE\u6587\u4EF6\u5927\u5C0F"],[40013,"\u4E0D\u5408\u6CD5\u7684 AppID \uFF0C\u8BF7\u5F00\u53D1\u8005\u68C0\u67E5 AppID \u7684\u6B63\u786E\u6027\uFF0C\u907F\u514D\u5F02\u5E38\u5B57\u7B26\uFF0C\u6CE8\u610F\u5927\u5C0F\u5199"],[40014,"\u4E0D\u5408\u6CD5\u7684 access_token \uFF0C\u8BF7\u5F00\u53D1\u8005\u8BA4\u771F\u6BD4\u5BF9 access_token \u7684\u6709\u6548\u6027\uFF08\u5982\u662F\u5426\u8FC7\u671F\uFF09\uFF0C\u6216\u67E5\u770B\u662F\u5426\u6B63\u5728\u4E3A\u6070\u5F53\u7684\u516C\u4F17\u53F7\u8C03\u7528\u63A5\u53E3"],[40015,"\u4E0D\u5408\u6CD5\u7684\u83DC\u5355\u7C7B\u578B"],[40016,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE\u4E2A\u6570"],[40017,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE\u7C7B\u578B"],[40018,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE\u540D\u5B57\u957F\u5EA6"],[40019,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE KEY \u957F\u5EA6"],[40020,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE URL \u957F\u5EA6"],[40021,"\u4E0D\u5408\u6CD5\u7684\u83DC\u5355\u7248\u672C\u53F7"],[40022,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u7EA7\u6570"],[40023,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE\u4E2A\u6570"],[40024,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE\u7C7B\u578B"],[40025,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE\u540D\u5B57\u957F\u5EA6"],[40026,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE KEY \u957F\u5EA6"],[40027,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE URL \u957F\u5EA6"],[40028,"\u4E0D\u5408\u6CD5\u7684\u81EA\u5B9A\u4E49\u83DC\u5355\u4F7F\u7528\u7528\u6237"],[40029,"\u65E0\u6548\u7684 oauth_code"],[40030,"\u4E0D\u5408\u6CD5\u7684 refresh_token"],[40031,"\u4E0D\u5408\u6CD5\u7684 openid \u5217\u8868"],[40032,"\u4E0D\u5408\u6CD5\u7684 openid \u5217\u8868\u957F\u5EA6"],[40033,"\u4E0D\u5408\u6CD5\u7684\u8BF7\u6C42\u5B57\u7B26\uFF0C\u4E0D\u80FD\u5305\u542B \\uxxxx \u683C\u5F0F\u7684\u5B57\u7B26"],[40035,"\u4E0D\u5408\u6CD5\u7684\u53C2\u6570"],[40038,"\u4E0D\u5408\u6CD5\u7684\u8BF7\u6C42\u683C\u5F0F"],[40039,"\u4E0D\u5408\u6CD5\u7684 URL \u957F\u5EA6"],[40048,"\u65E0\u6548\u7684url"],[40050,"\u4E0D\u5408\u6CD5\u7684\u5206\u7EC4 id"],[40051,"\u5206\u7EC4\u540D\u5B57\u4E0D\u5408\u6CD5"],[40060,"\u5220\u9664\u5355\u7BC7\u56FE\u6587\u65F6\uFF0C\u6307\u5B9A\u7684 article_idx \u4E0D\u5408\u6CD5"],[40117,"\u5206\u7EC4\u540D\u5B57\u4E0D\u5408\u6CD5"],[40118,"media_id \u5927\u5C0F\u4E0D\u5408\u6CD5"],[40119,"button \u7C7B\u578B\u9519\u8BEF"],[40120,"\u5B50 button \u7C7B\u578B\u9519\u8BEF"],[40121,"\u4E0D\u5408\u6CD5\u7684 media_id \u7C7B\u578B"],[40125,"\u65E0\u6548\u7684appsecret"],[40132,"\u5FAE\u4FE1\u53F7\u4E0D\u5408\u6CD5"],[40137,"\u4E0D\u652F\u6301\u7684\u56FE\u7247\u683C\u5F0F"],[40155,"\u8BF7\u52FF\u6DFB\u52A0\u5176\u4ED6\u516C\u4F17\u53F7\u7684\u4E3B\u9875\u94FE\u63A5"],[40163,"oauth_code\u5DF2\u4F7F\u7528"],[40164,"IP\u5730\u5740\u4E0D\u5728\u767D\u540D\u5355\u4E0A\uFF0C\u5C06ip\u6DFB\u52A0\u5230ip\u767D\u540D\u5355\u5217\u8868\u5373\u53EF"],[40227,"\u6807\u9898\u4E3A\u7A7A"],[40243,"AppSecret\u5DF2\u88AB\u51BB\u7ED3\uFF0C\u8BF7\u767B\u5F55MP\u89E3\u51BB\u540E\u518D\u6B21\u8C03\u7528"],[40249,"\u4E0D\u652F\u6301\u4E0B\u53D1\u8425\u9500/\u63A8\u5E7F\u7C7B\u7684\u6D88\u606F\u5185\u5BB9"],[40250,"\u4E0B\u53D1\u6D88\u606F\u5185\u5BB9\u4E0D\u89C4\u8303\uFF08\u5305\u542B\u7A7A\u503C\u7B49\uFF09\uFF0C\u5EFA\u8BAE\u68C0\u67E5\u5185\u5BB9\u89C4\u8303\u6027\u540E\u518D\u4E0B\u53D1"],[40251,"\u56E0\u5386\u53F2\u8FDD\u89C4\u5BFC\u81F4\u5E73\u53F0\u9650\u5236\u8D26\u53F7\u8C03\u7528\u4E0A\u9650\uFF0C\u5F53\u524D\u5DF2\u5230\u8FBE\u4E0B\u53D1\u4E0A\u9650"],[40252,"\u6B63\u5728\u8C03\u7528\u7684\u6A21\u677F\u4E0B\u53D1\u7684\u90E8\u5206\u5185\u5BB9\u5DF2\u8FDB\u5165\u5E73\u53F0\u5BA1\u6838\u6D41\u7A0B\uFF0C\u5728\u5BA1\u6838\u5B8C\u6210\u524D\uFF0C\u76F8\u5173\u5185\u5BB9\u6682\u65F6\u65E0\u6CD5\u4E0B\u53D1"],[41001,"\u7F3A\u5C11 access_token \u53C2\u6570"],[41002,"\u7F3A\u5C11 appid \u53C2\u6570"],[41003,"\u7F3A\u5C11 refresh_token \u53C2\u6570"],[41004,"\u7F3A\u5C11 secret \u53C2\u6570"],[41005,"\u7F3A\u5C11\u591A\u5A92\u4F53\u6587\u4EF6\u6570\u636E"],[41006,"\u7F3A\u5C11 media_id \u53C2\u6570"],[41007,"\u7F3A\u5C11\u5B50\u83DC\u5355\u6570\u636E"],[41008,"\u7F3A\u5C11 oauth code"],[41009,"\u7F3A\u5C11 openid"],[42001,"access_token \u8D85\u65F6\uFF0C\u8BF7\u68C0\u67E5 access_token \u7684\u6709\u6548\u671F\uFF0C\u8BF7\u53C2\u8003\u57FA\u7840\u652F\u6301 - \u83B7\u53D6 access_token \u4E2D\uFF0C\u5BF9 access_token \u7684\u8BE6\u7EC6\u673A\u5236\u8BF4\u660E"],[42002,"refresh_token \u8D85\u65F6"],[42003,"oauth_code \u8D85\u65F6"],[42007,"\u7528\u6237\u4FEE\u6539\u5FAE\u4FE1\u5BC6\u7801\uFF0C accesstoken \u548C refreshtoken \u5931\u6548\uFF0C\u9700\u8981\u91CD\u65B0\u6388\u6743"],[42010,"\u76F8\u540C media_id \u7FA4\u53D1\u8FC7\u5FEB\uFF0C\u8BF7\u91CD\u8BD5"],[43001,"\u9700\u8981 GET \u8BF7\u6C42"],[43002,"\u9700\u8981 POST \u8BF7\u6C42"],[43003,"\u9700\u8981 HTTPS \u8BF7\u6C42"],[43004,"\u9700\u8981\u63A5\u6536\u8005\u5173\u6CE8"],[43005,"\u9700\u8981\u597D\u53CB\u5173\u7CFB"],[43019,"\u9700\u8981\u5C06\u63A5\u6536\u8005\u4ECE\u9ED1\u540D\u5355\u4E2D\u79FB\u9664"],[43116,"\u8BE5\u6A21\u677F\u56E0\u6EE5\u7528\u88AB\u6EE5\u7528\u8FC7\u591A\uFF0C\u5DF2\u88AB\u9650\u5236\u4E0B\u53D1"],[44001,"\u591A\u5A92\u4F53\u6587\u4EF6\u4E3A\u7A7A"],[44002,"POST \u7684\u6570\u636E\u5305\u4E3A\u7A7A"],[44003,"\u56FE\u6587\u6D88\u606F\u5185\u5BB9\u4E3A\u7A7A"],[44004,"\u6587\u672C\u6D88\u606F\u5185\u5BB9\u4E3A\u7A7A"],[44008,"\u97F3\u9891\u5185\u5BB9\u5BA1\u6838\u5931\u8D25"],[44009,"\u56FE\u6587\u4E2D\u7684\u97F3\u9891\u5185\u5BB9\u5BA1\u6838\u5931\u8D25"],[45001,"\u591A\u5A92\u4F53\u6587\u4EF6\u5927\u5C0F\u8D85\u8FC7\u9650\u5236"],[45002,"\u6D88\u606F\u5185\u5BB9\u8D85\u8FC7\u9650\u5236"],[45003,"\u6807\u9898\u5B57\u6BB5\u8D85\u8FC7\u9650\u5236"],[45004,"\u63CF\u8FF0\u5B57\u6BB5\u8D85\u8FC7\u9650\u5236"],[45005,"\u94FE\u63A5\u5B57\u6BB5\u8D85\u8FC7\u9650\u5236"],[45006,"\u56FE\u7247\u94FE\u63A5\u5B57\u6BB5\u8D85\u8FC7\u9650\u5236"],[45007,"\u8BED\u97F3\u64AD\u653E\u65F6\u95F4\u8D85\u8FC7\u9650\u5236"],[45008,"\u56FE\u6587\u6D88\u606F\u8D85\u8FC7\u9650\u5236"],[45009,"\u63A5\u53E3\u8C03\u7528\u8D85\u8FC7\u9650\u5236"],[45010,"\u521B\u5EFA\u83DC\u5355\u4E2A\u6570\u8D85\u8FC7\u9650\u5236"],[45011,"API \u8C03\u7528\u592A\u9891\u7E41\uFF0C\u8BF7\u7A0D\u5019\u518D\u8BD5"],[45015,"\u56DE\u590D\u65F6\u95F4\u8D85\u8FC7\u9650\u5236"],[45016,"\u7CFB\u7EDF\u5206\u7EC4\uFF0C\u4E0D\u5141\u8BB8\u4FEE\u6539"],[45017,"\u5206\u7EC4\u540D\u5B57\u8FC7\u957F"],[45018,"\u5206\u7EC4\u6570\u91CF\u8D85\u8FC7\u4E0A\u9650"],[45047,"\u5BA2\u670D\u63A5\u53E3\u4E0B\u884C\u6761\u6570\u8D85\u8FC7\u4E0A\u9650"],[45064,"\u521B\u5EFA\u83DC\u5355\u5305\u542B\u672A\u5173\u8054\u7684\u5C0F\u7A0B\u5E8F"],[45065,"\u76F8\u540C clientmsgid \u5DF2\u5B58\u5728\u7FA4\u53D1\u8BB0\u5F55\uFF0C\u8FD4\u56DE\u6570\u636E\u4E2D\u5E26\u6709\u5DF2\u5B58\u5728\u7684\u7FA4\u53D1\u4EFB\u52A1\u7684 msgid"],[45066,"\u76F8\u540C clientmsgid \u91CD\u8BD5\u901F\u5EA6\u8FC7\u5FEB\uFF0C\u8BF7\u95F4\u96941\u5206\u949F\u91CD\u8BD5"],[45067,"clientmsgid \u957F\u5EA6\u8D85\u8FC7\u9650\u5236"],[45110,"\u4F5C\u8005\u5B57\u6570\u8D85\u51FA\u9650\u5236"],[46001,"\u4E0D\u5B58\u5728\u5A92\u4F53\u6570\u636E"],[46002,"\u4E0D\u5B58\u5728\u7684\u83DC\u5355\u7248\u672C"],[46003,"\u4E0D\u5B58\u5728\u7684\u83DC\u5355\u6570\u636E"],[46004,"\u4E0D\u5B58\u5728\u7684\u7528\u6237"],[47001,"\u89E3\u6790 JSON/XML \u5185\u5BB9\u9519\u8BEF"],[47003,"\u53C2\u6570\u503C\u4E0D\u7B26\u5408\u9650\u5236\u8981\u6C42\uFF0C\u8BE6\u60C5\u53EF\u53C2\u8003\u53C2\u6570\u503C\u5185\u5BB9\u9650\u5236\u8BF4\u660E"],[48001,"api \u529F\u80FD\u672A\u6388\u6743\uFF0C\u8BF7\u786E\u8BA4\u516C\u4F17\u53F7\u5DF2\u83B7\u5F97\u8BE5\u63A5\u53E3\uFF0C\u53EF\u4EE5\u5728\u516C\u4F17\u5E73\u53F0\u5B98\u7F51 - \u5F00\u53D1\u8005\u4E2D\u5FC3\u9875\u4E2D\u67E5\u770B\u63A5\u53E3\u6743\u9650"],[48002,"\u7C89\u4E1D\u62D2\u6536\u6D88\u606F\uFF08\u7C89\u4E1D\u5728\u516C\u4F17\u53F7\u9009\u9879\u4E2D\uFF0C\u5173\u95ED\u4E86 \u201C \u63A5\u6536\u6D88\u606F \u201D \uFF09"],[48004,"api \u63A5\u53E3\u88AB\u5C01\u7981\uFF0C\u8BF7\u767B\u5F55 mp.weixin.qq.com \u67E5\u770B\u8BE6\u60C5"],[48005,"api \u7981\u6B62\u5220\u9664\u88AB\u81EA\u52A8\u56DE\u590D\u548C\u81EA\u5B9A\u4E49\u83DC\u5355\u5F15\u7528\u7684\u7D20\u6750"],[48006,"api \u7981\u6B62\u6E05\u96F6\u8C03\u7528\u6B21\u6570\uFF0C\u56E0\u4E3A\u6E05\u96F6\u6B21\u6570\u8FBE\u5230\u4E0A\u9650"],[48008,"\u6CA1\u6709\u8BE5\u7C7B\u578B\u6D88\u606F\u7684\u53D1\u9001\u6743\u9650"],[48021,"\u81EA\u52A8\u4FDD\u5B58\u7684\u8349\u7A3F\u65E0\u6CD5\u9884\u89C8/\u53D1\u9001\uFF0C\u8BF7\u5148\u624B\u52A8\u4FDD\u5B58\u8349\u7A3F"],[50001,"\u7528\u6237\u672A\u6388\u6743\u8BE5 api"],[50002,"\u7528\u6237\u53D7\u9650\uFF0C\u53EF\u80FD\u662F\u8FDD\u89C4\u540E\u63A5\u53E3\u88AB\u5C01\u7981"],[50005,"\u7528\u6237\u672A\u5173\u6CE8\u516C\u4F17\u53F7"],[53500,"\u53D1\u5E03\u529F\u80FD\u88AB\u5C01\u7981"],[53501,"\u9891\u7E41\u8BF7\u6C42\u53D1\u5E03"],[53502,"Publish ID \u65E0\u6548"],[53600,"Article ID \u65E0\u6548"],[61451,"\u53C2\u6570\u9519\u8BEF (invalid parameter)"],[61452,"\u65E0\u6548\u5BA2\u670D\u8D26\u53F7 (invalid kf_account)"],[61453,"\u5BA2\u670D\u8D26\u53F7\u5DF2\u5B58\u5728 (kf_account exsited)"],[61454,"\u5BA2\u670D\u8D26\u53F7\u540D\u957F\u5EA6\u8D85\u8FC7\u9650\u5236 ( \u4EC5\u5141\u8BB8 10 \u4E2A\u82F1\u6587\u5B57\u7B26\uFF0C\u4E0D\u5305\u62EC @ \u53CA @ \u540E\u7684\u516C\u4F17\u53F7\u7684\u5FAE\u4FE1\u53F7 )(invalid   kf_acount length)"],[61455,"\u5BA2\u670D\u8D26\u53F7\u540D\u5305\u542B\u975E\u6CD5\u5B57\u7B26 ( \u4EC5\u5141\u8BB8\u82F1\u6587 + \u6570\u5B57 )(illegal character in     kf_account)"],[61456,"\u5BA2\u670D\u8D26\u53F7\u4E2A\u6570\u8D85\u8FC7\u9650\u5236 (10 \u4E2A\u5BA2\u670D\u8D26\u53F7 )(kf_account count exceeded)"],[61457,"\u65E0\u6548\u5934\u50CF\u6587\u4EF6\u7C7B\u578B (invalid   file type)"],[61450,"\u7CFB\u7EDF\u9519\u8BEF (system error)"],[61500,"\u65E5\u671F\u683C\u5F0F\u9519\u8BEF"],[63001,"\u90E8\u5206\u53C2\u6570\u4E3A\u7A7A"],[63002,"\u65E0\u6548\u7684\u7B7E\u540D"],[65301,"\u4E0D\u5B58\u5728\u6B64 menuid \u5BF9\u5E94\u7684\u4E2A\u6027\u5316\u83DC\u5355"],[65302,"\u6CA1\u6709\u76F8\u5E94\u7684\u7528\u6237"],[65303,"\u6CA1\u6709\u9ED8\u8BA4\u83DC\u5355\uFF0C\u4E0D\u80FD\u521B\u5EFA\u4E2A\u6027\u5316\u83DC\u5355"],[65304,"MatchRule \u4FE1\u606F\u4E3A\u7A7A"],[65305,"\u4E2A\u6027\u5316\u83DC\u5355\u6570\u91CF\u53D7\u9650"],[65306,"\u4E0D\u652F\u6301\u4E2A\u6027\u5316\u83DC\u5355\u7684\u8D26\u53F7"],[65307,"\u4E2A\u6027\u5316\u83DC\u5355\u4FE1\u606F\u4E3A\u7A7A"],[65308,"\u5305\u542B\u6CA1\u6709\u54CD\u5E94\u7C7B\u578B\u7684 button"],[65309,"\u4E2A\u6027\u5316\u83DC\u5355\u5F00\u5173\u5904\u4E8E\u5173\u95ED\u72B6\u6001"],[65310,"\u586B\u5199\u4E86\u7701\u4EFD\u6216\u57CE\u5E02\u4FE1\u606F\uFF0C\u56FD\u5BB6\u4FE1\u606F\u4E0D\u80FD\u4E3A\u7A7A"],[65311,"\u586B\u5199\u4E86\u57CE\u5E02\u4FE1\u606F\uFF0C\u7701\u4EFD\u4FE1\u606F\u4E0D\u80FD\u4E3A\u7A7A"],[65312,"\u4E0D\u5408\u6CD5\u7684\u56FD\u5BB6\u4FE1\u606F"],[65313,"\u4E0D\u5408\u6CD5\u7684\u7701\u4EFD\u4FE1\u606F"],[65314,"\u4E0D\u5408\u6CD5\u7684\u57CE\u5E02\u4FE1\u606F"],[65316,"\u8BE5\u516C\u4F17\u53F7\u7684\u83DC\u5355\u8BBE\u7F6E\u4E86\u8FC7\u591A\u7684\u57DF\u540D\u5916\u8DF3\uFF08\u6700\u591A\u8DF3\u8F6C\u5230 3 \u4E2A\u57DF\u540D\u7684\u94FE\u63A5\uFF09"],[65317,"\u4E0D\u5408\u6CD5\u7684 URL"],[87009,"\u65E0\u6548\u7684\u7B7E\u540D"],[89503,"\u6B64\u6B21\u8C03\u7528\u9700\u8981\u7BA1\u7406\u5458\u786E\u8BA4\uFF0C\u8BF7\u8010\u5FC3\u7B49\u5019"],[89506,"\u8BE5IP\u8C03\u7528\u6C42\u8BF7\u6C42\u5DF2\u88AB\u516C\u4F17\u53F7\u7BA1\u7406\u5458\u62D2\u7EDD\uFF0C\u8BF724\u5C0F\u65F6\u540E\u518D\u8BD5\uFF0C\u5EFA\u8BAE\u8C03\u7528\u524D\u4E0E\u7BA1\u7406\u5458\u6C9F\u901A\u786E\u8BA4"],[89507,"\u8BE5IP\u8C03\u7528\u6C42\u8BF7\u6C42\u5DF2\u88AB\u516C\u4F17\u53F7\u7BA1\u7406\u5458\u62D2\u7EDD\uFF0C\u8BF71\u5C0F\u65F6\u540E\u518D\u8BD5\uFF0C\u5EFA\u8BAE\u8C03\u7528\u524D\u4E0E\u7BA1\u7406\u5458\u6C9F\u901A\u786E\u8BA4"],[900100,"	POST \u6570\u636E\u53C2\u6570\u4E0D\u5408\u6CD5"],[900100,"	\u8FDC\u7AEF\u670D\u52A1\u4E0D\u53EF\u7528"],[900100,"	Ticket \u4E0D\u5408\u6CD5"],[900100,"	\u83B7\u53D6\u6447\u5468\u8FB9\u7528\u6237\u4FE1\u606F\u5931\u8D25"],[900100,"	\u83B7\u53D6\u5546\u6237\u4FE1\u606F\u5931\u8D25"],[900100,"	\u83B7\u53D6 OpenID \u5931\u8D25"],[900100,"	\u4E0A\u4F20\u6587\u4EF6\u7F3A\u5931"],[900100,"	\u4E0A\u4F20\u7D20\u6750\u7684\u6587\u4EF6\u7C7B\u578B\u4E0D\u5408\u6CD5"],[900100,"	\u4E0A\u4F20\u7D20\u6750\u7684\u6587\u4EF6\u5C3A\u5BF8\u4E0D\u5408\u6CD5"],[900101,"	\u4E0A\u4F20\u5931\u8D25"],[900102,"	\u8D26\u53F7\u4E0D\u5408\u6CD5"],[900102,"	\u5DF2\u6709\u8BBE\u5907\u6FC0\u6D3B\u7387\u4F4E\u4E8E 50% \uFF0C\u4E0D\u80FD\u65B0\u589E\u8BBE\u5907"],[900102,"	\u8BBE\u5907\u7533\u8BF7\u6570\u4E0D\u5408\u6CD5\uFF0C\u5FC5\u987B\u4E3A\u5927\u4E8E 0 \u7684\u6570\u5B57"],[900102,"	\u5DF2\u5B58\u5728\u5BA1\u6838\u4E2D\u7684\u8BBE\u5907 ID \u7533\u8BF7"],[900102,"	\u4E00\u6B21\u67E5\u8BE2\u8BBE\u5907 ID \u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7 50"],[900102,"	\u8BBE\u5907 ID \u4E0D\u5408\u6CD5"],[900102,"	\u9875\u9762 ID \u4E0D\u5408\u6CD5"],[900102,"	\u9875\u9762\u53C2\u6570\u4E0D\u5408\u6CD5"],[900102,"	\u4E00\u6B21\u5220\u9664\u9875\u9762 ID \u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7 10"],[900102,"	\u9875\u9762\u5DF2\u5E94\u7528\u5728\u8BBE\u5907\u4E2D\uFF0C\u8BF7\u5148\u89E3\u9664\u5E94\u7528\u5173\u7CFB\u518D\u5220\u9664"],[900103,"	\u4E00\u6B21\u67E5\u8BE2\u9875\u9762 ID \u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7 50"],[900103,"	\u65F6\u95F4\u533A\u95F4\u4E0D\u5408\u6CD5"],[900103,"	\u4FDD\u5B58\u8BBE\u5907\u4E0E\u9875\u9762\u7684\u7ED1\u5B9A\u5173\u7CFB\u53C2\u6570\u9519\u8BEF"],[900103,"	\u95E8\u5E97 ID \u4E0D\u5408\u6CD5"],[900103,"	\u8BBE\u5907\u5907\u6CE8\u4FE1\u606F\u8FC7\u957F"],[900103,"	\u8BBE\u5907\u7533\u8BF7\u53C2\u6570\u4E0D\u5408\u6CD5"],[900103,"	\u67E5\u8BE2\u8D77\u59CB\u503C begin \u4E0D\u5408\u6CD5"],[40114,"invalid index value"],[41039,"invalid content_source_url"],[45166,"invalid content"],[88e3,"without comment privilege"]])});function wv(r){let t=/\b(?:\d{1,3}\.){3}\d{1,3}\b/g,e=/(?:::ffff:)?([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::(?:ffff:)?(?:\d{1,3}\.){3}\d{1,3}/g,n=r.match(t)||[],i=r.match(e)||[];return{ipv4:n,ipv6:i}}var G,At,Ve,Mn=F(()=>{G=require("obsidian");lu();$e();At=class{constructor(t){this.baseUrl="https://api.weixin.qq.com/cgi-bin";this.plugin=t}static getInstance(t){return At.instance||(At.instance=new At(t)),At.instance}static resetInstance(){At.instance=null}async requestToken(){let t="https://wewrite.3thinking.cn/mp_token",e=this.plugin.getSelectedMPAccount();if(e===void 0)return new G.Notice(A("wechat-api.select-an-wechat-mp-account-first")),null;let{appId:n,appSecret:i,doc_id:a}=e,o;a===void 0||!a?o={app_id:n,secret:i}:o={doc_id:a};try{let s=await(0,G.requestUrl)({method:"POST",url:t,headers:{"Content-Type":"application/json"},throw:!1,body:JSON.stringify(o)});if(s.status!==200)return new G.Notice(s.text,0),null;let{code:l,data:c}=s.json;if(l!==0){if(l==-2)return e.doc_id=void 0,this.plugin.saveSettings(),await this.requestToken();if(l==-10&&c.errcode===40164){let{ipv4:u}=wv(c.errmsg);u[0]!==void 0&&u[0]&&new G.Notice(A("wechat-api.add-ip-address-ipv4-0-to-wechat-mp-ip-wh",[u[0]]))}return null}return c.last_token===void 0?(new G.Notice(A("wechat-api.failed-to-get-wechat-access-token"),0),null):(e.access_token=c.last_token,e.doc_id=c.doc_id,e.expires_in=c.expiretime,e.lastRefreshTime=new Date().getTime(),this.plugin.saveSettings(),c.last_token)}catch(s){return console.error("Get wechat access token error:",s),new G.Notice(A("wechat-api.failed-to-get-wechat-access-token"),0),null}}getHeaders(){return{"Accept-Encoding":"gzip, deflate, br","Accept-Language":"zh-CN,zh;q=0.9,en;q=0.8"}}async getAccessToken(t,e){let i={url:`${this.baseUrl}/token?grant_type=client_credential&appid=${t}&secret=${e}`,method:"GET",headers:this.getHeaders()},a=await(0,G.requestUrl)(i),{access_token:o,errcode:s,expires_in:l}=a.json;return o===void 0?(new G.Notice(qe(s),0),!1):{access_token:o,expires_in:l}}async getAccountBasicInfo(t){let e=t!=null?t:this.plugin.settings.selectedMPAccount;if(!e)return new G.Notice(A("wechat-api.select-an-wechat-mp-account-first")),null;let n=await this.plugin.refreshAccessToken(e);if(!n)return null;let i=`${this.baseUrl}/account/getaccountbasicinfo?access_token=${n}`,a=await(0,G.requestUrl)({method:"GET",url:i,throw:!1}),{errcode:o}=a.json;return o!==void 0&&o!==0?(new G.Notice(qe(o),0),null):a.json}async getBatchMaterial(t,e,n=0,i=10){let a=await this.plugin.refreshAccessToken(t);if(!a)return!1;let o="https://api.weixin.qq.com/cgi-bin/material/batchget_material?access_token="+a;return await(await(0,G.requestUrl)({method:"POST",url:o,throw:!1,body:JSON.stringify({type:e,offset:n,count:i})})).json}async sendArticleToDraftBox(t,e){let n=await this.plugin.refreshAccessToken(this.plugin.settings.selectedMPAccount);if(!n)return!1;let i="https://api.weixin.qq.com/cgi-bin/draft/add?access_token="+n,a={articles:[{title:t.title,content:e,digest:t.digest,thumb_media_id:t.thumb_media_id,...t.content_source_url&&{content_source_url:t.content_source_url},...t.need_open_comment!==void 0&&{need_open_comment:t.need_open_comment},...t.only_fans_can_comment!==void 0&&{only_fans_can_comment:t.only_fans_can_comment},...t.pic_crop_235_1&&{pic_crop_235_1:t.pic_crop_235_1},...t.pic_crop_1_1&&{pic_crop_1_1:t.pic_crop_1_1},...t.author&&{author:t.author}}]},o=await(0,G.requestUrl)({method:"POST",url:i,throw:!1,body:JSON.stringify(a)}),{errcode:s,media_id:l}=o.json;return s!==void 0&&s!==0?(new G.Notice(qe(s),0),!1):(new G.Notice(A("wechat-api.send-article-to-draft-box-successfully")),l)}async uploadXMaterial(t,e,n){if(n==="video"){if(t.size>1024*1024*10)return new G.Notice(A("wechat-api.video-size-exceeds-10m")),!1}else if(n==="voice"){if(t.size>1024*1024*2)return new G.Notice(A("wechat-api.voice-size-exceeds-2m")),!1}else if(t.size>1024*1024*10)return new G.Notice(A("wechat-api.image-size-exceeds-10m")),!1;let i=await this.plugin.refreshAccessToken(this.plugin.settings.selectedMPAccount);if(!i)return!1;let a=`https://api.weixin.qq.com/cgi-bin/media/uploadimg?access_token=${i}`;n===void 0&&t.size>=1024*1024&&(n="image"),n!==void 0&&(a=`https://api.weixin.qq.com/cgi-bin/material/add_material?access_token=${i}&type=${n}`);let o=16,s="one2mpBoundary"+Array(o+1).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,o),l=[],c=JSON.stringify({title:"title of video",content:"content of video"});l.push(`--${s}\r
Content-Disposition: form-data; name="media"; filename="${e}"\r
Content-Type: "application/octet-stream"\r
\r
`);let u=await(0,G.getBlobArrayBuffer)(t);l.push(u),l.push(`\r
`),n==="video"&&l.push(`--${s}\r
Content-Disposition: form-data; name="description"\r
Content-Type: application/json\r
\r
`+c+`\r
`),l.push(`--${s}--\r
`);let d=new TextEncoder,f=l.map(y=>typeof y=="string"?d.encode(y):y),m=await new Blob(f).arrayBuffer(),b={method:"POST",url:a,contentType:`multipart/form-data; boundary=${s}`,body:m},k=await(await(0,G.requestUrl)(b)).json;return(k.errcode===void 0||k.errcode==0)&&this.plugin.messageService.sendMessage(n+"-item-updated",k),{url:k.url||"",media_id:k.media_id||"",errcode:k.errcode||0,errmsg:k.errmsg||""}}async uploadMaterial(t,e,n){if(n==="video"){if(t.size>1024*1024*10)return new G.Notice(A("wechat-api.video-size-exceeds-10m")),!1}else if(n==="voice"){if(t.size>1024*1024*2)return new G.Notice(A("wechat-api.voice-size-exceeds-2m")),!1}else if(t.size>1024*1024*10)return new G.Notice(A("wechat-api.image-size-exceeds-10m")),!1;let i=await this.plugin.refreshAccessToken(this.plugin.settings.selectedMPAccount);if(!i)return!1;let a=`https://api.weixin.qq.com/cgi-bin/media/uploadimg?access_token=${i}`;n===void 0&&t.size>=1024*1024&&(n="image"),n!==void 0&&(a=`https://api.weixin.qq.com/cgi-bin/material/add_material?access_token=${i}&type=${n}`);let o={title:"title of video",introduction:"content of video"},s=await(0,G.getBlobArrayBuffer)(t),l=e,c="----WebKitFormBoundary"+Math.random().toString(36).substring(2),u=[];u.push(`--${c}\r
Content-Disposition: form-data; name="media"; filename="${l}"\r
Content-Type: application/octet-stream\r
\r
`),u.push(new Uint8Array(s)),u.push(`\r
`),n==="video"&&o&&u.push(`--${c}\r
Content-Disposition: form-data; name="description"\r
Content-Type: application/json\r
\r
`+JSON.stringify(o)+`\r
`),u.push(`--${c}--\r
`);let d=new TextEncoder,f=u.map(m=>typeof m=="string"?d.encode(m):m).reduce((m,b)=>{let S=new Uint8Array(m.length+b.length);return S.set(m),S.set(b,m.length),S},new Uint8Array(0));try{this.plugin.showSpinner(A("wechat-api.uploading-material-type",[n||"unknown"]));let m=await(0,G.requestUrl)({url:a,method:"POST",headers:{"Content-Type":`multipart/form-data; boundary=${c}`},body:f.buffer});this.plugin.hideSpinner();let b=await m.json;return b.errcode!==void 0&&b.errcode!==0?(console.error("\u4E0A\u4F20\u7D20\u6750\u5931\u8D25:",b),new G.Notice(qe(b.errcode)||b.errmsg||"\u4E0A\u4F20\u7D20\u6750\u5931\u8D25",0),null):(this.plugin.messageService.sendMessage(n+"-item-updated",b),{url:b.url||"",media_id:b.media_id||"",errcode:b.errcode||0,errmsg:b.errmsg||""})}catch(m){throw this.plugin.hideSpinner(),console.error("\u4E0A\u4F20\u7D20\u6750\u65F6\u51FA\u9519:",m),m}}async getMaterialList(t,e,n=0,i=20){let a=await this.plugin.refreshAccessToken(t);if(!a)return!1;let o=`${this.baseUrl}/material/batchget_material?access_token=${a}`,s={type:e,offset:n,count:i},l={url:o,method:"POST",headers:this.getHeaders(),body:JSON.stringify(s)};return(await(0,G.requestUrl)(l)).json}async getMaterialById(t,e){if(!t)return!1;e===void 0&&(e=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(e);if(!n)return!1;let i=`${this.baseUrl}/material/get_material?access_token=${n}`,a={media_id:t},o={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)};return(await(0,G.requestUrl)(o)).json}async getBatchDraftList(t,e=0,n=20){let i=await this.plugin.refreshAccessToken(t);if(!i)return!1;let a=`${this.baseUrl}/draft/batchget?access_token=${i}`,o={offset:e,count:n,no_content:!1},s={url:a,method:"POST",headers:this.getHeaders(),body:JSON.stringify(o)};return(await(0,G.requestUrl)(s)).json}async getMaterialCounts(t){let e=await this.plugin.refreshAccessToken(t);if(!e)return!1;let i={url:`${this.baseUrl}/material/get_materialcount?access_token=${e}`,method:"GET",headers:this.getHeaders()},a=await(0,G.requestUrl)(i),{errcode:o}=a.json;return o!==void 0&&o!==0?(new G.Notice(qe(o),0),!1):a.json}async getDraftCount(t){let e=await this.plugin.refreshAccessToken(t);if(!e)return!1;let i={url:`${this.baseUrl}/draft/count?access_token=${e}`,method:"GET",headers:this.getHeaders()},a=await(0,G.requestUrl)(i),{errcode:o,total_count:s}=a.json;return o!==void 0&&o!==0?(new G.Notice(qe(o),0),!1):s}async getDraftById(t,e){let n=await this.plugin.refreshAccessToken(t);if(!n)return!1;let i=`${this.baseUrl}/draft/get?access_token=${n}`,a={media_id:e},o={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)},s=await(0,G.requestUrl)(o),{errcode:l,news_item:c}=s.json;return l!==void 0&&l!==0?(new G.Notice(qe(l),0),!1):c}async publishDraft(t,e=""){e||(e=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(e);if(!n)return!1;let i=`${this.baseUrl}/freepublish/submit?access_token=${n}`,a={media_id:t},o={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)},s=await(0,G.requestUrl)(o),{errcode:l,publish_id:c}=s.json;return l!==void 0&&l!==0?(new G.Notice(qe(l),0),!1):c}async deleteMedia(t,e=""){e||(e=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(e);if(!n)return!1;let i=`${this.baseUrl}/material/del_material?access_token=${n}`,a={media_id:t},o={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)},s=await(0,G.requestUrl)(o),{errcode:l}=s.json;return l!==void 0&&l!==0?(new G.Notice(qe(l),0),!1):!0}async deleteDraft(t,e=""){e||(e=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(e);if(!n)return!1;let i=`${this.baseUrl}/draft/delete?access_token=${n}`,a={media_id:t},o={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)},s=await(0,G.requestUrl)(o),{errcode:l}=s.json;return l!==void 0&&l!==0?(new G.Notice(qe(l),0),!1):!0}async massSendAll(t,e=""){e||(e=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(e);if(!n)return!1;let i=`${this.baseUrl}/message/mass/sendall?access_token=${n}`,a={filter:{is_to_all:!0},mpnews:{media_id:t},msgtype:"mpnews"},o={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)},s=await(0,G.requestUrl)(o),{errcode:l}=s.json;return l!==void 0&&l!==0?(new G.Notice(qe(l),0),!1):!0}async senfForPreview(t,e="",n=""){n||(n=this.plugin.settings.selectedMPAccount),e||(e=this.plugin.settings.previewer_wxname);let i=await this.plugin.refreshAccessToken(n);if(!i)return!1;let a=`${this.baseUrl}/message/mass/preview?access_token=${i}`,o={towxname:e,mpnews:{media_id:t},msgtype:"mpnews"},s={url:a,method:"POST",headers:this.getHeaders(),body:JSON.stringify(o)},l=await(0,G.requestUrl)(s),{errcode:c}=l.json;return c!==void 0&&c!==0?(new G.Notice(qe(c),0),!1):!0}},Ve=At;Ve.instance=null});var zr,xe,Ln=F(()=>{zr=require("obsidian"),xe=class{constructor(t){this.app=t;this.rendering=!1;this.app=t}static getInstance(t){return xe.instance||(xe.instance=new xe(t)),xe.instance}async render(t,e,n){if(t===void 0||!t||!t.toLowerCase().endsWith(".md")||!e||!n)return;this.container=e,this.container.addClass("one2mp-markdown-render-container"),this.view=n,this.container.empty(),this.container.show(),this.rendering=!0,this.mdv&&this.mdv.unload(),this.previewEl=createDiv(),this.markdownBody=this.previewEl.createDiv(),this.mdv=new zr.MarkdownRenderChild(this.markdownBody),this.view.addChild(this.mdv),this.container.appendChild(this.previewEl);let i=await this.app.vault.adapter.read(t);await zr.MarkdownRenderer.render(this.app,i,this.markdownBody,t,this.mdv);try{let a=[];/^\s*>+\s*\[!/m.test(i)&&a.push(this.waitForSelector(this.previewEl,".callout",1e3)),/```\s*mermaid/i.test(i)&&a.push(this.waitForSelector(this.previewEl,".mermaid svg",5e3)),a.length&&await Promise.all(a)}catch(a){console.warn("\u90E8\u5206\u63D2\u4EF6\u6E32\u67D3\u8D85\u65F6\uFF08\u975E\u81F4\u547D\uFF09",a)}this.rendering=!1}queryElement(t,e){if(this.previewEl===void 0||!this.previewEl||this.rendering||this.previewEl===void 0||!this.previewEl)return null;let n=this.previewEl.querySelectorAll(e);return t<0||t>=n.length?null:n[t]}svgToDataUrl(t,e,n){var f;let i=t.cloneNode(!0);i.getAttribute("xmlns")||i.setAttribute("xmlns","http://www.w3.org/2000/svg"),e&&i.setAttribute("width",String(e)),n&&i.setAttribute("height",String(n));let a=e,o=n;if(!a||!o){let m=t.getBoundingClientRect();a=a||Math.round(m.width),o=o||Math.round(m.height)}if(!a||!o){let m=(f=t.viewBox)==null?void 0:f.baseVal;m&&m.width&&m.height&&(a=a||Math.round(m.width),o=o||Math.round(m.height))}a&&!i.getAttribute("width")&&i.setAttribute("width",String(a)),o&&!i.getAttribute("height")&&i.setAttribute("height",String(o));let s=new XMLSerializer().serializeToString(i),c=new TextEncoder().encode(s),u="";for(let m of c)u+=String.fromCharCode(m);return`data:image/svg+xml;base64,${btoa(u)}`}elementToDataUrl(t,e={}){if(t instanceof HTMLCanvasElement)return t.toDataURL("image/png");if(t instanceof HTMLImageElement&&t.src)return t.src;let n=t.querySelector("canvas");if(n instanceof HTMLCanvasElement)return n.toDataURL("image/png");let i=t.querySelector("img");if(i instanceof HTMLImageElement&&i.src)return i.src;let a=t instanceof SVGElement?t:t.querySelector("svg");if(a instanceof SVGElement){let o=typeof e.width=="number"?e.width:void 0,s=typeof e.height=="number"?e.height:void 0;return this.svgToDataUrl(a,o,s)}return null}async domToImage(t,e={}){let n=this.elementToDataUrl(t,e);if(await Promise.resolve(),!n)throw new Error("\u65E0\u6CD5\u751F\u6210\u5143\u7D20\u622A\u56FE\u6570\u636E");return n}waitForSelector(t,e,n=1e3){return new Promise(i=>{if(t.querySelector(e))return i();let a=new MutationObserver(()=>{t.querySelector(e)&&(a.disconnect(),i())});a.observe(t,{childList:!0,subtree:!0}),setTimeout(()=>{a.disconnect(),i()},n)})}}});function Ur(r,t){let e="";return r&&r.includes("/")&&(e=r.split("/")[1]||""),e||(e=t||"png"),`image-${new Date().getTime()}.${e}`}function bv(r){if(!r)return;let e=r.split("?")[0].split("#")[0].match(/\.([a-zA-Z0-9]+)$/);return e?e[1].toLowerCase():void 0}function Hr(r,t){t.forEach(e=>{e.status==="rejected"&&console.error(`${r}\u4E0A\u4F20\u5931\u8D25:`,e.reason)})}function xv(r){return new Promise((t,e)=>{let n=new Image;n.onload=()=>{let s=document.createElement("canvas"),l=window.devicePixelRatio||1;s.width=n.width*l,s.height=n.height*l;let c=s.getContext("2d");if(!c){e(new Error(A("render.faild-canvas-context")));return}c.drawImage(n,0,0),s.toBlob(u=>{u?t(u):e(new Error(A("render.failed-to-convert-canvas-to-blob")))},"image/png")},n.onerror=s=>{let l=s instanceof Error?s.message:typeof s=="string"?s:JSON.stringify(s);e(new Error(l))};let a=new TextEncoder().encode(r),o=String.fromCharCode.apply(null,a);n.src=`data:image/svg+xml;base64,${btoa(o)}`})}function Na(r){let t=r.split(";base64,");console.debug("parts:",t);let e=t[0].split(":")[1];console.debug("contentType",e);let n=window.atob(t[1]);console.debug("raw:",n);let i=n.length,a=new Uint8Array(i);for(let o=0;o<i;++o)a[o]=n.charCodeAt(o);return console.debug("uInt8Array byteLength:",a.byteLength),new Blob([a],{type:e})}function _v(r){let t=r.toDataURL("image/png");return Na(t)}async function cu(r,t){let e=[];r.querySelectorAll("svg").forEach(a=>{e.push(a)});let n=e.map(async a=>{let o=a.outerHTML;o.length<1e4||await xv(o).then(async s=>{let l=await t.uploadMaterial(s,Ur(s.type,"png"));if(l&&l.url){let c=document.createElement("img");c.src=l.url,a.replaceWith(c)}else console.error("upload svg failed.")})}),i=await Promise.allSettled(n);Hr("SVG",i)}async function uu(r,t){let e=[];r.querySelectorAll("canvas").forEach(a=>{e.push(a)});let n=e.map(async a=>{let o=_v(a),s=await t.uploadMaterial(o,Ur(o.type,"png"));if(s&&s.url){let l=document.createElement("img");l.src=s.url,a.replaceWith(l)}else console.error("upload canvas failed.")}),i=await Promise.allSettled(n);Hr("Canvas",i)}async function du(r,t,e){let n=[];r.querySelectorAll("img").forEach(o=>{n.push(o)});let i=n.map(async o=>{let s,l=bv(o.src);if(!o.src.includes("://mmbiz.qpic.cn/")){if(o.src.startsWith("data:image/"))s=Na(o.src);else try{s=await gn(o.src,e)}catch(c){console.error(`Error fetching image from ${o.src}:`,c);return}s!==void 0&&await t.uploadMaterial(s,Ur(s.type,l)).then(c=>{c&&c.url?o.src=c.url:console.error("upload image failed.")})}}),a=await Promise.allSettled(i);Hr("\u56FE\u7247",a)}function fu(r,t){var o;let e=r.classList.contains("one2mp")?r:(o=r.querySelector(".one2mp"))!=null?o:r,n=e.querySelector("p"),i=t||n&&window.getComputedStyle(n).color||window.getComputedStyle(e).color||"#333333",a=s=>{s.setCssProps({color:i,opacity:"1",filter:"none"})};r.querySelectorAll(".one2mp-callout .callout-text").forEach(a),r.querySelectorAll(".one2mp-callout .callout-content p, .one2mp-callout .callout-content li").forEach(a)}async function hu(r,t){let e=[];r.querySelectorAll("video").forEach(a=>{e.push(a)});let n=e.map(async a=>{let o;a.src.includes("://mmbiz.qpic.cn/")||(a.src.startsWith("data:image/")?o=Na(a.src):o=await gn(a.src),o!==void 0&&await t.uploadMaterial(o,Ur(o.type),"video").then(async s=>{if(s){let l=await t.getMaterialById(s.media_id);a.src=l.url}else console.error("upload video failed.")}))}),i=await Promise.allSettled(n);Hr("\u89C6\u9891",i)}var pu=F(()=>{$e();Ut()});var Ke,ja=F(()=>{Ke=class{constructor(){this.cardData=new Map}static getInstance(){return Ke.instance||(Ke.instance=new Ke),Ke.instance}setCardData(t,e){this.cardData.set(t,e)}cleanup(){this.cardData.clear()}restoreCard(t){for(let[e,n]of this.cardData.entries()){let a=`<section[^>]*\\sdata-id="${e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}"[^>]*>(.*?)<\\/section>`,o=new RegExp(a,"gs");if(!o.test(t)){console.warn("\u6CA1\u6709\u516C\u4F17\u53F7\u4FE1\u606F\uFF1A",e);continue}t=t.replace(o,n)}return t}}});function Ua(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}function bu(r){$t=r}function oe(r,t=""){let e=typeof r=="string"?r:r.source,n={replace:(i,a)=>{let o=typeof a=="string"?a:a.source;return o=o.replace(Le.caret,"$1"),e=e.replace(i,o),n},getRegex:()=>new RegExp(e,t)};return n}function st(r,t){if(t){if(Le.escapeTest.test(r))return r.replace(Le.escapeReplace,mu)}else if(Le.escapeTestNoEncode.test(r))return r.replace(Le.escapeReplaceNoEncode,mu);return r}function vu(r){try{r=encodeURI(r).replace(Le.percentDecode,"%")}catch(t){return null}return r}function yu(r,t){var a;let e=r.replace(Le.findPipe,(o,s,l)=>{let c=!1,u=s;for(;--u>=0&&l[u]==="\\";)c=!c;return c?"|":" |"}),n=e.split(Le.splitPipe),i=0;if(n[0].trim()||n.shift(),n.length>0&&!((a=n.at(-1))!=null&&a.trim())&&n.pop(),t)if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(Le.slashPipe,"|");return n}function Fn(r,t,e){let n=r.length;if(n===0)return"";let i=0;for(;i<n&&r.charAt(n-i-1)===t;)i++;return r.slice(0,n-i)}function ty(r,t){if(r.indexOf(t[1])===-1)return-1;let e=0;for(let n=0;n<r.length;n++)if(r[n]==="\\")n++;else if(r[n]===t[0])e++;else if(r[n]===t[1]&&(e--,e<0))return n;return-1}function wu(r,t,e,n,i){let a=t.href,o=t.title||null,s=r[1].replace(i.other.outputLinkReplace,"$1");if(r[0].charAt(0)!=="!"){n.state.inLink=!0;let l={type:"link",raw:e,href:a,title:o,text:s,tokens:n.inlineTokens(s)};return n.state.inLink=!1,l}return{type:"image",raw:e,href:a,title:o,text:s}}function ny(r,t,e){let n=r.match(e.other.indentCodeCompensation);if(n===null)return t;let i=n[1];return t.split(`
`).map(a=>{let o=a.match(e.other.beginningSpace);if(o===null)return a;let[s]=o;return s.length>=i.length?a.slice(i.length):a}).join(`
`)}function le(r,t){return Pt.parse(r,t)}var $t,Bn,Le,kv,Sv,Cv,jn,Ev,xu,_u,Ha,Tv,Wa,Av,Iv,Kr,Va,Pv,ku,$v,Ka,gu,Ov,Dv,Mv,Lv,Su,Rv,Gr,Ga,Cu,Fv,Eu,Bv,qv,Nv,Tu,jv,zv,Au,Uv,Hv,Wv,Vv,Kv,Gv,Jv,Vr,Qv,Iu,Pu,Zv,Ja,Yv,za,Xv,Wr,Rn,ey,mu,on,Fe,sn,qn,Be,It,Nn,Pt,bx,xx,_x,kx,Sx,Cx,Ex,$u=F(()=>{$t=Ua();Bn={exec:()=>null};Le={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:r=>new RegExp(`^( {0,3}${r})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}#`),htmlBeginRegex:r=>new RegExp(`^ {0,${Math.min(3,r-1)}}<(?:[a-z].*>|!--)`,"i")},kv=/^(?:[ \t]*(?:\n|$))+/,Sv=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Cv=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,jn=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Ev=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,xu=/(?:[*+-]|\d{1,9}[.)])/,_u=oe(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,xu).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),Ha=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Tv=/^[^\n]+/,Wa=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Av=oe(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Wa).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Iv=oe(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,xu).getRegex(),Kr="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Va=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Pv=oe("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Va).replace("tag",Kr).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ku=oe(Ha).replace("hr",jn).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Kr).getRegex(),$v=oe(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",ku).getRegex(),Ka={blockquote:$v,code:Sv,def:Av,fences:Cv,heading:Ev,hr:jn,html:Pv,lheading:_u,list:Iv,newline:kv,paragraph:ku,table:Bn,text:Tv},gu=oe("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",jn).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Kr).getRegex(),Ov={...Ka,table:gu,paragraph:oe(Ha).replace("hr",jn).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",gu).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Kr).getRegex()},Dv={...Ka,html:oe(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Va).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Bn,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:oe(Ha).replace("hr",jn).replace("heading",` *#{1,6} *[^
]`).replace("lheading",_u).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Mv=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Lv=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Su=/^( {2,}|\\)\n(?!\s*$)/,Rv=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,Gr=/[\p{P}\p{S}]/u,Ga=/[\s\p{P}\p{S}]/u,Cu=/[^\s\p{P}\p{S}]/u,Fv=oe(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Ga).getRegex(),Eu=/(?!~)[\p{P}\p{S}]/u,Bv=/(?!~)[\s\p{P}\p{S}]/u,qv=/(?:[^\s\p{P}\p{S}]|~)/u,Nv=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,Tu=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,jv=oe(Tu,"u").replace(/punct/g,Gr).getRegex(),zv=oe(Tu,"u").replace(/punct/g,Eu).getRegex(),Au="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Uv=oe(Au,"gu").replace(/notPunctSpace/g,Cu).replace(/punctSpace/g,Ga).replace(/punct/g,Gr).getRegex(),Hv=oe(Au,"gu").replace(/notPunctSpace/g,qv).replace(/punctSpace/g,Bv).replace(/punct/g,Eu).getRegex(),Wv=oe("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Cu).replace(/punctSpace/g,Ga).replace(/punct/g,Gr).getRegex(),Vv=oe(/\\(punct)/,"gu").replace(/punct/g,Gr).getRegex(),Kv=oe(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Gv=oe(Va).replace("(?:-->|$)","-->").getRegex(),Jv=oe("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Gv).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Vr=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Qv=oe(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Vr).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Iu=oe(/^!?\[(label)\]\[(ref)\]/).replace("label",Vr).replace("ref",Wa).getRegex(),Pu=oe(/^!?\[(ref)\](?:\[\])?/).replace("ref",Wa).getRegex(),Zv=oe("reflink|nolink(?!\\()","g").replace("reflink",Iu).replace("nolink",Pu).getRegex(),Ja={_backpedal:Bn,anyPunctuation:Vv,autolink:Kv,blockSkip:Nv,br:Su,code:Lv,del:Bn,emStrongLDelim:jv,emStrongRDelimAst:Uv,emStrongRDelimUnd:Wv,escape:Mv,link:Qv,nolink:Pu,punctuation:Fv,reflink:Iu,reflinkSearch:Zv,tag:Jv,text:Rv,url:Bn},Yv={...Ja,link:oe(/^!?\[(label)\]\((.*?)\)/).replace("label",Vr).getRegex(),reflink:oe(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Vr).getRegex()},za={...Ja,emStrongRDelimAst:Hv,emStrongLDelim:zv,url:oe(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Xv={...za,br:oe(Su).replace("{2,}","*").getRegex(),text:oe(za.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Wr={normal:Ka,gfm:Ov,pedantic:Dv},Rn={normal:Ja,gfm:za,breaks:Xv,pedantic:Yv},ey={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},mu=r=>ey[r];on=class{constructor(t){de(this,"options");de(this,"rules");de(this,"lexer");this.options=t||$t}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let n=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Fn(n,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let n=e[0],i=ny(n,e[3]||"",this.rules);return{type:"code",raw:n,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:i}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let n=e[2].trim();if(this.rules.other.endingHash.test(n)){let i=Fn(n,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(n=i.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Fn(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let n=Fn(e[0],`
`).split(`
`),i="",a="",o=[];for(;n.length>0;){let s=!1,l=[],c;for(c=0;c<n.length;c++)if(this.rules.other.blockquoteStart.test(n[c]))l.push(n[c]),s=!0;else if(!s)l.push(n[c]);else break;n=n.slice(c);let u=l.join(`
`),d=u.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${u}`:u,a=a?`${a}
${d}`:d;let f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(d,o,!0),this.lexer.state.top=f,n.length===0)break;let m=o.at(-1);if((m==null?void 0:m.type)==="code")break;if((m==null?void 0:m.type)==="blockquote"){let b=m,S=b.raw+`
`+n.join(`
`),k=this.blockquote(S);o[o.length-1]=k,i=i.substring(0,i.length-b.raw.length)+k.raw,a=a.substring(0,a.length-b.text.length)+k.text;break}else if((m==null?void 0:m.type)==="list"){let b=m,S=b.raw+`
`+n.join(`
`),k=this.list(S);o[o.length-1]=k,i=i.substring(0,i.length-m.raw.length)+k.raw,a=a.substring(0,a.length-b.raw.length)+k.raw,n=S.substring(o.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:o,text:a}}}list(t){let e=this.rules.block.list.exec(t);if(e){let n=e[1].trim(),i=n.length>1,a={type:"list",raw:"",ordered:i,start:i?+n.slice(0,-1):"",loose:!1,items:[]};n=i?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=i?n:"[*+-]");let o=this.rules.other.listItemRegex(n),s=!1;for(;t;){let c=!1,u="",d="";if(!(e=o.exec(t))||this.rules.block.hr.test(t))break;u=e[0],t=t.substring(u.length);let f=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,g=>" ".repeat(3*g.length)),m=t.split(`
`,1)[0],b=!f.trim(),S=0;if(this.options.pedantic?(S=2,d=f.trimStart()):b?S=e[1].length+1:(S=e[2].search(this.rules.other.nonSpaceChar),S=S>4?1:S,d=f.slice(S),S+=e[1].length),b&&this.rules.other.blankLine.test(m)&&(u+=m+`
`,t=t.substring(m.length+1),c=!0),!c){let g=this.rules.other.nextBulletRegex(S),h=this.rules.other.hrRegex(S),p=this.rules.other.fencesBeginRegex(S),w=this.rules.other.headingBeginRegex(S),_=this.rules.other.htmlBeginRegex(S);for(;t;){let O=t.split(`
`,1)[0],M;if(m=O,this.options.pedantic?(m=m.replace(this.rules.other.listReplaceNesting,"  "),M=m):M=m.replace(this.rules.other.tabCharGlobal,"    "),p.test(m)||w.test(m)||_.test(m)||g.test(m)||h.test(m))break;if(M.search(this.rules.other.nonSpaceChar)>=S||!m.trim())d+=`
`+M.slice(S);else{if(b||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||p.test(f)||w.test(f)||h.test(f))break;d+=`
`+m}!b&&!m.trim()&&(b=!0),u+=O+`
`,t=t.substring(O.length+1),f=M.slice(S)}}a.loose||(s?a.loose=!0:this.rules.other.doubleBlankLine.test(u)&&(s=!0));let k=null,y;this.options.gfm&&(k=this.rules.other.listIsTask.exec(d),k&&(y=k[0]!=="[ ] ",d=d.replace(this.rules.other.listReplaceTask,""))),a.items.push({type:"list_item",raw:u,task:!!k,checked:y,loose:!1,text:d,tokens:[]}),a.raw+=u}let l=a.items.at(-1);if(l)l.raw=l.raw.trimEnd(),l.text=l.text.trimEnd();else return;a.raw=a.raw.trimEnd();for(let c=0;c<a.items.length;c++)if(this.lexer.state.top=!1,a.items[c].tokens=this.lexer.blockTokens(a.items[c].text,[]),!a.loose){let u=a.items[c].tokens.filter(f=>f.type==="space"),d=u.length>0&&u.some(f=>this.rules.other.anyLine.test(f.raw));a.loose=d}if(a.loose)for(let c=0;c<a.items.length;c++)a.items[c].loose=!0;return a}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let n=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",a=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:n,raw:e[0],href:i,title:a}}}table(t){var s;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let n=yu(e[1]),i=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),a=(s=e[3])!=null&&s.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],o={type:"table",raw:e[0],header:[],align:[],rows:[]};if(n.length===i.length){for(let l of i)this.rules.other.tableAlignRight.test(l)?o.align.push("right"):this.rules.other.tableAlignCenter.test(l)?o.align.push("center"):this.rules.other.tableAlignLeft.test(l)?o.align.push("left"):o.align.push(null);for(let l=0;l<n.length;l++)o.header.push({text:n[l],tokens:this.lexer.inline(n[l]),header:!0,align:o.align[l]});for(let l of a)o.rows.push(yu(l,o.header.length).map((c,u)=>({text:c,tokens:this.lexer.inline(c),header:!1,align:o.align[u]})));return o}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let n=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:n,tokens:this.lexer.inline(n)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let n=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let o=Fn(n.slice(0,-1),"\\");if((n.length-o.length)%2===0)return}else{let o=ty(e[2],"()");if(o>-1){let l=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,l).trim(),e[3]=""}}let i=e[2],a="";if(this.options.pedantic){let o=this.rules.other.pedanticHrefTitle.exec(i);o&&(i=o[1],a=o[3])}else a=e[3]?e[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?i=i.slice(1):i=i.slice(1,-1)),wu(e,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:a&&a.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){let i=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),a=e[i.toLowerCase()];if(!a){let o=n[0].charAt(0);return{type:"text",raw:o,text:o}}return wu(n,a,n[0],this.lexer,this.rules)}}emStrong(t,e,n=""){let i=this.rules.inline.emStrongLDelim.exec(t);if(!i||i[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(i[1]||i[2]||"")||!n||this.rules.inline.punctuation.exec(n)){let o=[...i[0]].length-1,s,l,c=o,u=0,d=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,e=e.slice(-1*t.length+o);(i=d.exec(e))!=null;){if(s=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!s)continue;if(l=[...s].length,i[3]||i[4]){c+=l;continue}else if((i[5]||i[6])&&o%3&&!((o+l)%3)){u+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+u);let f=[...i[0]][0].length,m=t.slice(0,o+i.index+f+l);if(Math.min(o,l)%2){let S=m.slice(1,-1);return{type:"em",raw:m,text:S,tokens:this.lexer.inlineTokens(S)}}let b=m.slice(2,-2);return{type:"strong",raw:m,text:b,tokens:this.lexer.inlineTokens(b)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let n=e[2].replace(this.rules.other.newLineCharGlobal," "),i=this.rules.other.nonSpaceChar.test(n),a=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return i&&a&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:e[0],text:n}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){let e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let n,i;return e[2]==="@"?(n=e[1],i="mailto:"+n):(n=e[1],i=n),{type:"link",raw:e[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}url(t){var n,i;let e;if(e=this.rules.inline.url.exec(t)){let a,o;if(e[2]==="@")a=e[0],o="mailto:"+a;else{let s;do s=e[0],e[0]=(i=(n=this.rules.inline._backpedal.exec(e[0]))==null?void 0:n[0])!=null?i:"";while(s!==e[0]);a=e[0],e[1]==="www."?o="http://"+e[0]:o=e[0]}return{type:"link",raw:e[0],text:a,href:o,tokens:[{type:"text",raw:a,text:a}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let n=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:n}}}},Fe=class{constructor(t){de(this,"tokens");de(this,"options");de(this,"state");de(this,"tokenizer");de(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||$t,this.options.tokenizer=this.options.tokenizer||new on,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let e={other:Le,block:Wr.normal,inline:Rn.normal};this.options.pedantic?(e.block=Wr.pedantic,e.inline=Rn.pedantic):this.options.gfm&&(e.block=Wr.gfm,this.options.breaks?e.inline=Rn.breaks:e.inline=Rn.gfm),this.tokenizer.rules=e}static get rules(){return{block:Wr,inline:Rn}}static lex(t,e){return new Fe(e).lex(t)}static lexInline(t,e){return new Fe(e).inlineTokens(t)}lex(t){t=t.replace(Le.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){let n=this.inlineQueue[e];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,e=[],n=!1){var i,a,o;for(this.options.pedantic&&(t=t.replace(Le.tabCharGlobal,"    ").replace(Le.spaceLine,""));t;){let s;if((a=(i=this.options.extensions)==null?void 0:i.block)!=null&&a.some(c=>(s=c.call({lexer:this},t,e))?(t=t.substring(s.raw.length),e.push(s),!0):!1))continue;if(s=this.tokenizer.space(t)){t=t.substring(s.raw.length);let c=e.at(-1);s.raw.length===1&&c!==void 0?c.raw+=`
`:e.push(s);continue}if(s=this.tokenizer.code(t)){t=t.substring(s.raw.length);let c=e.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+s.raw,c.text+=`
`+s.text,this.inlineQueue.at(-1).src=c.text):e.push(s);continue}if(s=this.tokenizer.fences(t)){t=t.substring(s.raw.length),e.push(s);continue}if(s=this.tokenizer.heading(t)){t=t.substring(s.raw.length),e.push(s);continue}if(s=this.tokenizer.hr(t)){t=t.substring(s.raw.length),e.push(s);continue}if(s=this.tokenizer.blockquote(t)){t=t.substring(s.raw.length),e.push(s);continue}if(s=this.tokenizer.list(t)){t=t.substring(s.raw.length),e.push(s);continue}if(s=this.tokenizer.html(t)){t=t.substring(s.raw.length),e.push(s);continue}if(s=this.tokenizer.def(t)){t=t.substring(s.raw.length);let c=e.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+s.raw,c.text+=`
`+s.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[s.tag]||(this.tokens.links[s.tag]={href:s.href,title:s.title});continue}if(s=this.tokenizer.table(t)){t=t.substring(s.raw.length),e.push(s);continue}if(s=this.tokenizer.lheading(t)){t=t.substring(s.raw.length),e.push(s);continue}let l=t;if((o=this.options.extensions)!=null&&o.startBlock){let c=1/0,u=t.slice(1),d;this.options.extensions.startBlock.forEach(f=>{d=f.call({lexer:this},u),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(l=t.substring(0,c+1))}if(this.state.top&&(s=this.tokenizer.paragraph(l))){let c=e.at(-1);n&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=`
`+s.raw,c.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):e.push(s),n=l.length!==t.length,t=t.substring(s.raw.length);continue}if(s=this.tokenizer.text(t)){t=t.substring(s.raw.length);let c=e.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=`
`+s.raw,c.text+=`
`+s.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):e.push(s);continue}if(t){let c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,e}inline(t,e=[]){return this.inlineQueue.push({src:t,tokens:e}),e}inlineTokens(t,e=[]){var s,l,c;let n=t,i=null;if(this.tokens.links){let u=Object.keys(this.tokens.links);if(u.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(n))!=null;)u.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.blockSkip.exec(n))!=null;)n=n.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(n))!=null;)n=n.slice(0,i.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let a=!1,o="";for(;t;){a||(o=""),a=!1;let u;if((l=(s=this.options.extensions)==null?void 0:s.inline)!=null&&l.some(f=>(u=f.call({lexer:this},t,e))?(t=t.substring(u.raw.length),e.push(u),!0):!1))continue;if(u=this.tokenizer.escape(t)){t=t.substring(u.raw.length),e.push(u);continue}if(u=this.tokenizer.tag(t)){t=t.substring(u.raw.length),e.push(u);continue}if(u=this.tokenizer.link(t)){t=t.substring(u.raw.length),e.push(u);continue}if(u=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(u.raw.length);let f=e.at(-1);u.type==="text"&&(f==null?void 0:f.type)==="text"?(f.raw+=u.raw,f.text+=u.text):e.push(u);continue}if(u=this.tokenizer.emStrong(t,n,o)){t=t.substring(u.raw.length),e.push(u);continue}if(u=this.tokenizer.codespan(t)){t=t.substring(u.raw.length),e.push(u);continue}if(u=this.tokenizer.br(t)){t=t.substring(u.raw.length),e.push(u);continue}if(u=this.tokenizer.del(t)){t=t.substring(u.raw.length),e.push(u);continue}if(u=this.tokenizer.autolink(t)){t=t.substring(u.raw.length),e.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(t))){t=t.substring(u.raw.length),e.push(u);continue}let d=t;if((c=this.options.extensions)!=null&&c.startInline){let f=1/0,m=t.slice(1),b;this.options.extensions.startInline.forEach(S=>{b=S.call({lexer:this},m),typeof b=="number"&&b>=0&&(f=Math.min(f,b))}),f<1/0&&f>=0&&(d=t.substring(0,f+1))}if(u=this.tokenizer.inlineText(d)){t=t.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(o=u.raw.slice(-1)),a=!0;let f=e.at(-1);(f==null?void 0:f.type)==="text"?(f.raw+=u.raw,f.text+=u.text):e.push(u);continue}if(t){let f="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(f);break}else throw new Error(f)}}return e}},sn=class{constructor(t){de(this,"options");de(this,"parser");this.options=t||$t}space(t){return""}code({text:t,lang:e,escaped:n}){var o;let i=(o=(e||"").match(Le.notSpaceStart))==null?void 0:o[0],a=t.replace(Le.endingNewline,"")+`
`;return i?'<pre><code class="language-'+st(i)+'">'+(n?a:st(a,!0))+`</code></pre>
`:"<pre><code>"+(n?a:st(a,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,n=t.start,i="";for(let s=0;s<t.items.length;s++){let l=t.items[s];i+=this.listitem(l)}let a=e?"ol":"ul",o=e&&n!==1?' start="'+n+'"':"";return"<"+a+o+`>
`+i+"</"+a+`>
`}listitem(t){var n;let e="";if(t.task){let i=this.checkbox({checked:!!t.checked});t.loose?((n=t.tokens[0])==null?void 0:n.type)==="paragraph"?(t.tokens[0].text=i+" "+t.tokens[0].text,t.tokens[0].tokens&&t.tokens[0].tokens.length>0&&t.tokens[0].tokens[0].type==="text"&&(t.tokens[0].tokens[0].text=i+" "+st(t.tokens[0].tokens[0].text),t.tokens[0].tokens[0].escaped=!0)):t.tokens.unshift({type:"text",raw:i+" ",text:i+" ",escaped:!0}):e+=i+" "}return e+=this.parser.parse(t.tokens,!!t.loose),`<li>${e}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",n="";for(let a=0;a<t.header.length;a++)n+=this.tablecell(t.header[a]);e+=this.tablerow({text:n});let i="";for(let a=0;a<t.rows.length;a++){let o=t.rows[a];n="";for(let s=0;s<o.length;s++)n+=this.tablecell(o[s]);i+=this.tablerow({text:n})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+i+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${st(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:n}){let i=this.parser.parseInline(n),a=vu(t);if(a===null)return i;t=a;let o='<a href="'+t+'"';return e&&(o+=' title="'+st(e)+'"'),o+=">"+i+"</a>",o}image({href:t,title:e,text:n}){let i=vu(t);if(i===null)return st(n);t=i;let a=`<img src="${t}" alt="${n}"`;return e&&(a+=` title="${st(e)}"`),a+=">",a}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:st(t.text)}},qn=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}},Be=class{constructor(t){de(this,"options");de(this,"renderer");de(this,"textRenderer");this.options=t||$t,this.options.renderer=this.options.renderer||new sn,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new qn}static parse(t,e){return new Be(e).parse(t)}static parseInline(t,e){return new Be(e).parseInline(t)}parse(t,e=!0){var i,a;let n="";for(let o=0;o<t.length;o++){let s=t[o];if((a=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&a[s.type]){let c=s,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){n+=u||"";continue}}let l=s;switch(l.type){case"space":{n+=this.renderer.space(l);continue}case"hr":{n+=this.renderer.hr(l);continue}case"heading":{n+=this.renderer.heading(l);continue}case"code":{n+=this.renderer.code(l);continue}case"table":{n+=this.renderer.table(l);continue}case"blockquote":{n+=this.renderer.blockquote(l);continue}case"list":{n+=this.renderer.list(l);continue}case"html":{n+=this.renderer.html(l);continue}case"paragraph":{n+=this.renderer.paragraph(l);continue}case"text":{let c=l,u=this.renderer.text(c);for(;o+1<t.length&&t[o+1].type==="text";)c=t[++o],u+=`
`+this.renderer.text(c);e?n+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):n+=u;continue}default:{let c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return n}parseInline(t,e=this.renderer){var i,a;let n="";for(let o=0;o<t.length;o++){let s=t[o];if((a=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&a[s.type]){let c=this.options.extensions.renderers[s.type].call({parser:this},s);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){n+=c||"";continue}}let l=s;switch(l.type){case"escape":{n+=e.text(l);break}case"html":{n+=e.html(l);break}case"link":{n+=e.link(l);break}case"image":{n+=e.image(l);break}case"strong":{n+=e.strong(l);break}case"em":{n+=e.em(l);break}case"codespan":{n+=e.codespan(l);break}case"br":{n+=e.br(l);break}case"del":{n+=e.del(l);break}case"text":{n+=e.text(l);break}default:{let c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return n}},It=class{constructor(t){de(this,"options");de(this,"block");this.options=t||$t}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}provideLexer(){return this.block?Fe.lex:Fe.lexInline}provideParser(){return this.block?Be.parse:Be.parseInline}};de(It,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));Nn=class{constructor(...t){de(this,"defaults",Ua());de(this,"options",this.setOptions);de(this,"parse",this.parseMarkdown(!0));de(this,"parseInline",this.parseMarkdown(!1));de(this,"Parser",Be);de(this,"Renderer",sn);de(this,"TextRenderer",qn);de(this,"Lexer",Fe);de(this,"Tokenizer",on);de(this,"Hooks",It);this.use(...t)}walkTokens(t,e){var i,a;let n=[];for(let o of t)switch(n=n.concat(e.call(this,o)),o.type){case"table":{let s=o;for(let l of s.header)n=n.concat(this.walkTokens(l.tokens,e));for(let l of s.rows)for(let c of l)n=n.concat(this.walkTokens(c.tokens,e));break}case"list":{let s=o;n=n.concat(this.walkTokens(s.items,e));break}default:{let s=o;(a=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&a[s.type]?this.defaults.extensions.childTokens[s.type].forEach(l=>{let c=s[l].flat(1/0);n=n.concat(this.walkTokens(c,e))}):s.tokens&&(n=n.concat(this.walkTokens(s.tokens,e)))}}return n}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(n=>{let i={...n};if(i.async=this.defaults.async||i.async||!1,n.extensions&&(n.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if("renderer"in a){let o=e.renderers[a.name];o?e.renderers[a.name]=function(...s){let l=a.renderer.apply(this,s);return l===!1&&(l=o.apply(this,s)),l}:e.renderers[a.name]=a.renderer}if("tokenizer"in a){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let o=e[a.level];o?o.unshift(a.tokenizer):e[a.level]=[a.tokenizer],a.start&&(a.level==="block"?e.startBlock?e.startBlock.push(a.start):e.startBlock=[a.start]:a.level==="inline"&&(e.startInline?e.startInline.push(a.start):e.startInline=[a.start]))}"childTokens"in a&&a.childTokens&&(e.childTokens[a.name]=a.childTokens)}),i.extensions=e),n.renderer){let a=this.defaults.renderer||new sn(this.defaults);for(let o in n.renderer){if(!(o in a))throw new Error(`renderer '${o}' does not exist`);if(["options","parser"].includes(o))continue;let s=o,l=n.renderer[s],c=a[s];a[s]=(...u)=>{let d=l.apply(a,u);return d===!1&&(d=c.apply(a,u)),d||""}}i.renderer=a}if(n.tokenizer){let a=this.defaults.tokenizer||new on(this.defaults);for(let o in n.tokenizer){if(!(o in a))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;let s=o,l=n.tokenizer[s],c=a[s];a[s]=(...u)=>{let d=l.apply(a,u);return d===!1&&(d=c.apply(a,u)),d}}i.tokenizer=a}if(n.hooks){let a=this.defaults.hooks||new It;for(let o in n.hooks){if(!(o in a))throw new Error(`hook '${o}' does not exist`);if(["options","block"].includes(o))continue;let s=o,l=n.hooks[s],c=a[s];It.passThroughHooks.has(o)?a[s]=u=>{if(this.defaults.async)return Promise.resolve(l.call(a,u)).then(f=>c.call(a,f));let d=l.call(a,u);return c.call(a,d)}:a[s]=(...u)=>{let d=l.apply(a,u);return d===!1&&(d=c.apply(a,u)),d}}i.hooks=a}if(n.walkTokens){let a=this.defaults.walkTokens,o=n.walkTokens;i.walkTokens=function(s){let l=[];return l.push(o.call(this,s)),a&&(l=l.concat(a.call(this,s))),l}}this.defaults={...this.defaults,...i}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return Fe.lex(t,e!=null?e:this.defaults)}parser(t,e){return Be.parse(t,e!=null?e:this.defaults)}parseMarkdown(t){return(n,i)=>{let a={...i},o={...this.defaults,...a},s=this.onError(!!o.silent,!!o.async);if(this.defaults.async===!0&&a.async===!1)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n=="undefined"||n===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));o.hooks&&(o.hooks.options=o,o.hooks.block=t);let l=o.hooks?o.hooks.provideLexer():t?Fe.lex:Fe.lexInline,c=o.hooks?o.hooks.provideParser():t?Be.parse:Be.parseInline;if(o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(n):n).then(u=>l(u,o)).then(u=>o.hooks?o.hooks.processAllTokens(u):u).then(u=>o.walkTokens?Promise.all(this.walkTokens(u,o.walkTokens)).then(()=>u):u).then(u=>c(u,o)).then(u=>o.hooks?o.hooks.postprocess(u):u).catch(s);try{o.hooks&&(n=o.hooks.preprocess(n));let u=l(n,o);o.hooks&&(u=o.hooks.processAllTokens(u)),o.walkTokens&&this.walkTokens(u,o.walkTokens);let d=c(u,o);return o.hooks&&(d=o.hooks.postprocess(d)),d}catch(u){return s(u)}}}onError(t,e){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let i="<p>An error occurred:</p><pre>"+st(n.message+"",!0)+"</pre>";return e?Promise.resolve(i):i}if(e)return Promise.reject(n);throw n}}},Pt=new Nn;le.options=le.setOptions=function(r){return Pt.setOptions(r),le.defaults=Pt.defaults,bu(le.defaults),le};le.getDefaults=Ua;le.defaults=$t;le.use=function(...r){return Pt.use(...r),le.defaults=Pt.defaults,bu(le.defaults),le};le.walkTokens=function(r,t){return Pt.walkTokens(r,t)};le.parseInline=Pt.parseInline;le.Parser=Be;le.parser=Be.parse;le.Renderer=sn;le.TextRenderer=qn;le.Lexer=Fe;le.lexer=Fe.lex;le.Tokenizer=on;le.Hooks=It;le.parse=le;bx=le.options,xx=le.setOptions,_x=le.use,kx=le.walkTokens,Sx=le.parseInline,Cx=Be.parse,Ex=Fe.lex});var pe,Ne=F(()=>{pe=class{constructor(t,e,n){this.plugin=t,this.previewRender=e,this.marked=n}prepare(){return Promise.resolve()}postprocess(t){return Promise.resolve(t)}beforePublish(){return Promise.resolve()}cleanup(){return Promise.resolve()}isPluginInstlled(t){let e=this.plugin.app.plugins.plugins;return Object.prototype.hasOwnProperty.call(e,t)}}});function Lu(r){if(!r)return"";let t=/\[!(.*?)\]/,e=r.match(t);return e?e[1].trim():""}function no(r){return r?r.split(/\r?\n/).map(t=>t.replace(/^>\s?/,"")).join(`
`).trim():""}function ly(r,t){let e=r.charAt(0).toUpperCase()+r.slice(1).toLowerCase(),n=t.indexOf("]")+1;(t.indexOf("]-")>0||t.indexOf("]+")>0)&&(n=n+1);let i=t.indexOf(`
`);if(i===-1&&(i=t.length),n>=i)return e;let a=t.slice(n,i).trim();return a!==""&&(e=a),e}function cy(r){return r&&r.replace(/<p([^>]*)>([\s\S]*?)<\/p>/g,'<p$1><span class="callout-text">$2</span></p>')}var ry,Qa,iy,ay,Za,Ya,Xa,eo,to,Ou,oy,sy,Du,Mu,Jr,Ru=F(()=>{Ne();ry='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-pencil"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"></path><path d="m15 5 4 4"></path></svg>',Qa='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-clipboard-list"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><path d="M12 11h4"></path><path d="M12 16h4"></path><path d="M8 11h.01"></path><path d="M8 16h.01"></path></svg>',iy='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg>',ay='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check-circle-2"><circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path></svg>',Za='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>',Ya='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg>',Xa='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-help-circle"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><path d="M12 17h.01"></path></svg>',eo='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg>',to='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>',Ou='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-zap"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>',oy='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-bug"><path d="m8 2 1.88 1.88"></path><path d="M14.12 3.88 16 2"></path><path d="M9 7.13v-1a3.003 3.003 0 1 1 6 0v1"></path><path d="M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6"></path><path d="M12 20v-9"></path><path d="M6.53 9C4.6 8.8 3 7.1 3 5"></path><path d="M6 13H2"></path><path d="M3 21c0-2.1 1.7-3.9 3.8-4"></path><path d="M20.97 5c0 2.1-1.6 3.8-3.5 4"></path><path d="M22 13h-4"></path><path d="M17.2 17c2.1.1 3.8 1.9 3.8 4"></path></svg>',sy='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>',Du='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-quote"><path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z"></path><path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z"></path></svg>',Mu=new Map(Object.entries({note:{icon:ry},abstract:{icon:Qa},summary:{icon:Qa},tldr:{icon:Qa},info:{icon:iy},todo:{icon:ay},tip:{icon:Za},hint:{icon:Za},important:{icon:Za},success:{icon:Ya},check:{icon:Ya},done:{icon:Ya},question:{icon:Xa},help:{icon:Xa},faq:{icon:Xa},warning:{icon:eo},caution:{icon:eo},attention:{icon:eo},failure:{icon:to},fail:{icon:to},missing:{icon:to},danger:{icon:Ou},error:{icon:Ou},bug:{icon:oy},example:{icon:sy},quote:{icon:Du},cite:{icon:Du}}));Jr=class extends pe{prepare(){return this.marked||console.error("marked is not ready"),Promise.resolve()}async rendererBlockquote(t){let e=t.text||no(t.raw||"");return`<blockquote dir="auto"><span class="icon-pin"></span><div class="blockquote-inner">${(await this.marked.parseInline(e)).replace(/\n/gm,"<br>").trim()}</div></blockquote>`}async rendererCallout(t){let e=t.text||no(t.raw||""),n=Lu(e);if(!n)return this.rendererBlockquote(t);let i=n.toLowerCase(),a=ly(n,e),o=e.indexOf(`
`),s="";if(o>0){let u=e.slice(o+1).trim();u&&(s=await this.marked.parse(u)),!s&&u&&(s=(await this.marked.parseInline(u)).replace(/\n/gm,"<br>")),s=cy(s)}let l=Mu.get(i)||Mu.get("note"),c=l?l.icon:"";return`<section class="one2mp-callout" data-callout="${i}"><div class="callout-title"><div class="callout-icon">${c}</div><div class="callout-title-inner">${a}</div></div><div class="callout-content">${s}</div></section>`}markedExtension(){return{async:!0,walkTokens:async t=>{if(t.type!=="blockquote")return;let e=t,n=e.raw||"",i=no(n);!e.text&&i&&(e.text=i),Lu(i||e.text)?t.html=await this.rendererCallout(e):t.html=await this.rendererBlockquote(e)},extensions:[{name:"blockquote",level:"block",renderer:t=>t.html}]}}}});var uy,Qr,dy,zn,fy,hy,Fu,Bu,qu=F(()=>{uy=r=>r&&r.replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"),Qr=r=>r.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),dy=r=>{let t=r.match(/```mpcard\s*([\s\S]*?)```/i);return t?t[1].trim():r.trim()},zn=(r,t)=>{var i,a;let e=new RegExp(`\\b${t}=("([^"]*)"|'([^']*)')`,"i"),n=r.match(e);return n?uy(((a=(i=n[2])!=null?i:n[3])!=null?a:"").trim()):""},fy=r=>{let t=r.split(/\r?\n/).map(i=>i.trim()).filter(i=>i.length>0),e={},n=/^(\w+):\s*"?(.*?)"?$/;for(let i of t){let a=i.match(n);if(a){let o=a[1].trim().toLowerCase(),s=a[2].trim();e[o]=s}}return{id:e.id||"",headimg:e.headimg||e.avatar||"",nickname:e.nickname||e.name||"",signature:e.signature||e.desc||e.description||"",alias:e.alias||""}},hy=r=>{let t=dy(r);if(!t)return null;if(/<mp-common-profile/i.test(t)||/\bdata-id=/.test(t))return{id:zn(t,"data-id"),headimg:zn(t,"data-headimg"),nickname:zn(t,"data-nickname"),signature:zn(t,"data-signature"),alias:zn(t,"data-alias"),rawHtml:t};let e=fy(t);return{id:e.id||"",headimg:e.headimg||"",nickname:e.nickname||"",signature:e.signature||"",alias:e.alias,rawHtml:""}},Fu=r=>{let t=hy(r);if(!t||!t.id||!t.rawHtml)return null;let e=t.rawHtml.trim();return/<mp-common-profile/i.test(e)?(/^\s*<section/i.test(e)||(e=`<section class="mp_profile_iframe_wrp" nodeleaf="">${e}</section>`),{info:t,html:e}):null},Bu=r=>{let t=Qr(r.headimg||""),e=Qr(r.nickname||""),n=Qr(r.signature||"");return`<section${r.id?` data-id="${Qr(r.id)}"`:""} class="one2mp-mpcard-wrapper"><div class="one2mp-mpcard-content"><img class="one2mp-mpcard-headimg" width="54" height="54" src="${t}"></img><div class="one2mp-mpcard-info"><div class="one2mp-mpcard-nickname">${e}</div><div class="one2mp-mpcard-signature">${n}</div></div></div><div class="one2mp-mpcard-foot">\u516C\u4F17\u53F7</div></section>`}});var Nu,Zr,ju=F(()=>{$e();Ut();Ln();Ne();Nu=require("obsidian");ja();qu();Zr=class extends pe{constructor(){super(...arguments);this.mermaidIndex=0;this.admonitionIndex=0;this.chartsIndex=0}prepare(){return this.mermaidIndex=0,this.admonitionIndex=0,this.chartsIndex=0,Ke.getInstance().cleanup(),Promise.resolve()}static srcToBlob(e){let n=e.split(",")[1],i=atob(n),a=new Array(i.length);for(let s=0;s<i.length;s++)a[s]=i.charCodeAt(s);let o=new Uint8Array(a);return new Blob([o],{type:"image/png"})}getHighlightProfile(e){if(!e)return null;let n=e.toLowerCase(),i=new Set(["const","let","var","function","return","if","else","for","while","switch","case","break","continue","class","new","this","try","catch","finally","throw","import","export","from","extends","super","await","async","typeof","instanceof","in","of","interface","type","enum","public","private","protected","readonly","implements","constructor","static","get","set"]),a=new Set(["def","class","import","from","return","if","elif","else","for","while","try","except","finally","with","as","pass","break","continue","lambda","yield","True","False","None"]),o=new Set(["true","false","null"]),s=new Set(["if","then","fi","for","do","done","case","esac","function","in","while","until","return","export","local","readonly"]);return{js:{keywords:i,lineComment:"//",blockComment:{start:"/*",end:"*/"},allowBacktick:!0},javascript:{keywords:i,lineComment:"//",blockComment:{start:"/*",end:"*/"},allowBacktick:!0},ts:{keywords:i,lineComment:"//",blockComment:{start:"/*",end:"*/"},allowBacktick:!0},typescript:{keywords:i,lineComment:"//",blockComment:{start:"/*",end:"*/"},allowBacktick:!0},json:{keywords:o},py:{keywords:a,lineComment:"#"},python:{keywords:a,lineComment:"#"},sh:{keywords:s,lineComment:"#"},bash:{keywords:s,lineComment:"#"},shell:{keywords:s,lineComment:"#"},zsh:{keywords:s,lineComment:"#"}}[n]||null}escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}preserveSpaces(e){return e.replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/ /g,"&nbsp;")}isIdentifierStart(e){let n=e.charCodeAt(0);return n>=65&&n<=90||n>=97&&n<=122||e==="_"||e==="$"}isIdentifierPart(e){let n=e.charCodeAt(0);return n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||e==="_"||e==="$"}highlightLine(e,n,i){let a=[],o=0,s=(c,u)=>{u&&a.push({type:c,text:u})};for(;o<e.length;){let c=e[o];if(n.inBlockComment&&i.blockComment){let d=e.indexOf(i.blockComment.end,o);if(d>=0){s("comment",e.slice(o,d+i.blockComment.end.length)),o=d+i.blockComment.end.length,n.inBlockComment=!1;continue}s("comment",e.slice(o)),o=e.length;continue}if(n.inString){let d="";for(;o<e.length;){let f=e[o];if(d+=f,f==="\\"&&o+1<e.length){d+=e[o+1],o+=2;continue}if(o+=1,f===n.stringChar){n.inString=!1;break}}s("string",d);continue}if(i.lineComment&&e.startsWith(i.lineComment,o)){s("comment",e.slice(o));break}if(i.blockComment&&e.startsWith(i.blockComment.start,o)){n.inBlockComment=!0;continue}if(c==="'"||c==='"'||c==="`"&&i.allowBacktick){n.inString=!0,n.stringChar=c;continue}if(c===" "||c==="	"){let d=o;for(;o<e.length&&(e[o]===" "||e[o]==="	");)o+=1;s("plain",e.slice(d,o));continue}let u=c.charCodeAt(0);if(u>=48&&u<=57||c==="."&&o+1<e.length&&e[o+1]>="0"&&e[o+1]<="9"){let d=o;for(o+=1;o<e.length;){let f=e[o];if(f>="0"&&f<="9"||f==="."||f==="_"||f==="x"||f==="X"||f>="a"&&f<="f"||f>="A"&&f<="F"){o+=1;continue}break}s("number",e.slice(d,o));continue}if(this.isIdentifierStart(c)){let d=o;for(o+=1;o<e.length&&this.isIdentifierPart(e[o]);)o+=1;let f=e.slice(d,o);i.keywords.has(f)?s("keyword",f):s("plain",f);continue}s("plain",c),o+=1}return{html:a.map(c=>{let u=this.preserveSpaces(this.escapeHtml(c.text));return c.type==="plain"?u:`<span class="o2any-token-${c.type}">${u}</span>`}).join(""),state:n}}codeRenderer(e,n){var f;let i=(f=(n||"").match(/^\S*/))==null?void 0:f[0],a=e.replace(/\n$/,""),o=this.getHighlightProfile(i||""),s=a.split(/\r?\n/),l="",c={inBlockComment:!1,inString:!1,stringChar:""};for(let m of s){let b=m;if(o){let S=this.highlightLine(m,c,o);b=S.html,c.inBlockComment=S.state.inBlockComment,c.inString=S.state.inString,c.stringChar=S.state.stringChar}else b=this.preserveSpaces(this.escapeHtml(m));b.length===0&&(b="<br>"),l+="<code>"+b+"</code>"}let u='<section class="code-section code-snippet__fix">',d="";return i?d=u+`<pre style="max-width:1000% !important;" class="hljs o2any-codeblock language-${i}">${l}</pre></section>`:d=u+`<pre class="hljs o2any-codeblock">${l}</pre></section>`,d}static getMathType(e){if(!e)return null;let n=e.toLowerCase();return n=n.trim(),n==="am"||n==="asciimath"?"asciimath":n==="latex"||n==="tex"?"latex":null}renderAdmonition(e,n){let i=xe.getInstance(this.plugin.app).queryElement(this.admonitionIndex,".callout.admonition");if(!i)return A("render.admonition-failed");this.admonitionIndex++;let a=i.querySelector(".edit-block-button");a&&a.parentNode.removeChild(a);let o=i.querySelector(".callout-fold");if(o)try{o.parentNode.removeChild(o)}catch(s){console.error(s)}return i.outerHTML}renderAdmonitionAsync(e,n){let a=xe.getInstance(this.plugin.app).queryElement(this.admonitionIndex,".callout.admonition");if(!a)return A("render.admonition-failed");this.admonitionIndex++;let o=a.querySelector(".edit-block-button");o&&o.parentNode.removeChild(o);let s=a.querySelector(".callout-fold");if(s)try{s.parentNode.removeChild(s)}catch(l){console.error(l)}return Gs(a)}async renderMermaidAsync(e){var u;e.html=A("render.mermaid-failed");let n=this.mermaidIndex;this.mermaidIndex++;let i=xe.getInstance(this.plugin.app),a=i.queryElement(n,".mermaid");if(!a)return;await i.waitForSelector(a,"svg",5e3);let o=a.querySelector("svg");if(!o)return;let s=a.closest(".one2mp-render-preview"),l=(u=s==null?void 0:s.classList.contains("one2mp-render-preview-visible"))!=null?u:!1,c=a.classList.contains("one2mp-mermaid-visible");try{s==null||s.classList.add("one2mp-render-preview-visible"),a.classList.add("one2mp-mermaid-visible");let{width:d,height:f}=this.getMermaidSize(o),m=await i.domToImage(o,{width:d,height:f});e.html=`<section id="one2mp-mermaid-${n}" class="mermaid"><img src="${m}" class="mermaid-image" style="width:${d}px;height:auto;"></section>`}catch(d){console.error(d)}finally{s&&!l&&s.classList.remove("one2mp-render-preview-visible"),c||a.classList.remove("one2mp-mermaid-visible")}}getMermaidSize(e){var o;let n=e.getBoundingClientRect(),i=Math.round(n.width),a=Math.round(n.height);if(!i||!a){let s=(o=e.viewBox)==null?void 0:o.baseVal;s&&s.width&&s.height&&(i=Math.round(s.width),a=Math.round(s.height))}if(!i||!a){let s=e.getAttribute("width"),l=e.getAttribute("height"),c=s?parseFloat(s):0,u=l?parseFloat(l):0;c&&(i=Math.round(c)),u&&(a=Math.round(u))}return i||(i=800),a||(a=400),{width:i,height:a}}renderCharts(e){if(!this.isPluginInstlled("obsidian-charts"))return console.debug("charts plugin not installed."),new Nu.Notice(A("rnder.charts-plugin-not-installed")),!1;let n=this.plugin.resourceManager.getMarkdownRenderedElement(this.chartsIndex,".block-language-chart");if(!n)return A("render.charts-failed");let i=`charts-img-${this.chartsIndex}`;this.chartsIndex++;let a=n.querySelector("canvas");if(a){let o="image/png",s=a.toDataURL(o);return`<section id="${i}" class="charts" >
			<img src="${s}" class="charts-image" />
			</section>`}return A("render.charts-failed")}renderWewriteProfile(e){let n=e.text.split(/\r?\n/).filter(s=>s.trim()!==""),i={},a=/^(\w+):\s*"?(.*?)"?$/;return n.forEach(s=>{let l=s.match(a);if(l){let c=l[1].trim().toLocaleLowerCase(),u=l[2].trim();i[c]=u}}),`<div class="one2mp-profile-card">
		<a class="one2mp-profile-card-link" href="${i.url}">
			<div class="card-main">
				<div class="avatar">
					<img src="${i.avatar}" alt="${i.nickname}" avatar class="one2mp-avatar-image" >
				</div>
			<div class="content">
				<div class="title">${i.nickname}</div>
				<div class="description">${i.description}</div>
				<div class="meta">${i.tips}</div>
			</div>
			<div class="arrow"><i class="weui-icon-arrow"></i></div>
			</div>
			<div class="card-footer">${i.footer}</div>
		</a>
  	</div>`}renderMpcard(e){let n=Fu(e.text);if(!n)return"<span>\u516C\u4F17\u53F7\u540D\u7247\u6570\u636E\u9519\u8BEF\uFF0C\u7F3A\u5C11id</span>";let{info:i,html:a}=n;return!i.headimg&&!i.nickname&&!i.signature?"<span>\u516C\u4F17\u53F7\u540D\u7247\u6570\u636E\u4E3A\u7A7A</span>":(Ke.getInstance().setCardData(i.id,a),Bu({...i,nickname:i.nickname||A("render.mpcard-default-name"),signature:i.signature||A("render.mpcard-default-signature")}))}markedExtension(){return{extensions:[{name:"code",level:"block",renderer:e=>e.lang&&e.lang.trim().toLocaleLowerCase()=="mermaid"?e.html:e.lang&&e.lang.trim().toLocaleLowerCase()=="chart"?this.renderCharts(e):e.lang&&e.lang.trim().toLocaleLowerCase()=="one2mp-profile"?this.renderWewriteProfile(e):e.lang&&e.lang.trim().toLocaleLowerCase()=="mpcard"?this.renderMpcard(e):e.lang&&e.lang.trim().toLocaleLowerCase().startsWith("ad-")?e.html:this.codeRenderer(e.text,e.lang)}],async:!0,walkTokens:async e=>{if(e.lang&&e.lang.trim().toLocaleLowerCase()=="mermaid"&&await this.renderMermaidAsync(e),e.lang&&e.lang.trim().toLocaleLowerCase().startsWith("ad-")){let n=e.lang.trim().toLocaleLowerCase().replace("ad-","");n===""&&(n="note"),e.html=this.renderAdmonitionAsync(e,n)}}}}}});var Yr,zu=F(()=>{Ne();Yr=class extends pe{constructor(){super(...arguments);this.mermaidIndex=0;this.admonitionIndex=0;this.chartsIndex=0}extractOne2MpCaptions(e){let n=/^wwcap:\s*(.*)$/gim,i=[],a;for(;(a=n.exec(e))!==null;)i.push(a[1].trim());return i}codespanRenderer(e){e=e.trim();let n=this.extractOne2MpCaptions(e);return n.length>0?`<div class="one2mp-image-caption">${n[0]}</div>`:`<span class="one2mp-codespan">${e}</span>`}markedExtension(){return{extensions:[{name:"codespan",level:"inline",renderer:e=>e.html}],walkTokens:e=>{e.type==="codespan"&&(e.html=this.codespanRenderer(e.text))}}}}});function Uu(r){let t=/^pdf#page=(\d+)(&rect=.*?)$/,e=r.lastIndexOf("|");e>0&&(r=r.substring(0,e));let n=r.lastIndexOf(".");if(n==-1)return"note";let i=r.substring(n+1);if(t.test(i))return"pdf-crop";if(r.startsWith("https://mmbiz.qpic.cn/")||r.startsWith("http://mmbiz.qpic.cn/"))return"image";switch(i.toLocaleLowerCase()){case"md":return"note";case"png":case"jpg":case"jpeg":case"gif":case"bmp":return"image";case"webp":return"webp";case"svg":return"svg";case"pdf":return"pdf";case"mp4":return"video";case"mp3":case"wma":case"wav":case"amr":return"voice";case"excalidraw":return"excalidraw";default:return"file"}}var Hu,py,Hn,Un,Wu=F(()=>{Hu=require("obsidian");Ln();Ne();$e();nr();py=/^!\[\[(.*?)\]\]/;Hn=class extends pe{constructor(){super(...arguments);this.index=0;this.videoIndex=0;this.voiceIndex=0;this.pdfCropIndex=0;this.embedMarkdownIndex=0;this.excalidrawIndex=0;this.markdownEmbedIndex=0}generateId(){return this.index+=1,`fid-${this.index}`}prepare(){return this.videoIndex=0,this.voiceIndex=0,this.pdfCropIndex=0,this.index=0,this.embedMarkdownIndex=0,this.excalidrawIndex=0,this.markdownEmbedIndex=0,Promise.resolve()}searchFile(e){let n=this.resolvePath(e),i=this.plugin.app.vault,a=i.config.attachmentFolderPath||"",o=n,s=null;if(s=i.getFileByPath(n),s||(s=i.getFileByPath(e),s)||a!=""&&(o=a+"/"+e,s=i.getFileByPath(o),s||(o=a+"/"+n,s=i.getFileByPath(o),s)))return s;let l=i.getAllLoadedFiles();for(let c of l)if(c.path.includes(e))return c;return null}resolvePath(e){let n=this.getActiveFileDir();if(!e.includes("/"))return e;let i=n.split("/"),a=e.split("/");i.pop();for(let o of a)o!=="."&&(o===".."?i.pop():i.push(o));return i.join("/")}getActiveFileDir(){let e=this.plugin.app.workspace.getActiveFile();if(e==null)return"";let n=e.path.split("/");return n.pop(),n.length==0?"":n.join("/")}getImagePath(e){if(e.startsWith("http"))return e;let n=this.searchFile(e);return n==null?(console.error("File not found"+e),""):n instanceof Hu.TFile?this.plugin.app.vault.getResourcePath(n):""}isImage(e){return e=e.toLowerCase(),e.endsWith(".png")||e.endsWith(".jpg")||e.endsWith(".jpeg")||e.endsWith(".gif")||e.endsWith(".bmp")||e.endsWith(".webp")}parseImageLink(e){if(e.includes("|")){let n=e.split("|"),i=n[0];if(!this.isImage(i))return null;let a=null,o=null;if(n.length==2){let s=n[1].toLowerCase().split("x");a=parseInt(s[0]),s.length==2&&s[1]!=""&&(o=parseInt(s[1]))}return{path:i,width:a,height:o}}return{path:e,width:null,height:null}}getHeaderLevel(e){let n=e.trimStart().match(/^#{1,6}/);return n?n[0].length:0}async getFileContent(e,n,i){let a=await this.plugin.app.vault.adapter.read(e.path);if(n==null&&i==null)return a;let o="",s=a.split(`
`);if(n){let l=0,c=!1;for(let u of s){if(c){if(l==this.getHeaderLevel(u))break;o+=u+`
`;continue}if(!u.trim().startsWith("#"))continue;let d=u.trim().split(" ");d.length==2&&n.trim()==d[1].trim()&&this.getHeaderLevel(u)&&(o+=u+`
`,l=this.getHeaderLevel(u),c=!0)}}if(i)for(let l=0;l<s.length;l++){let c=s[l];if(c.indexOf(i)>=0){if(o=c.replace(i,""),o.trim()=="")for(let u=l-1;u>=0;u--){let d=s[u];if(d.trim()!=""){o=d;break}}break}}return o}parseFileLink(e){let i=e.split("|")[0].split("#"),a=i[0],o=null,s=null;return i.length==2&&(i[1].startsWith("^")?s=i[1]:o=i[1]),{path:a,head:o,block:s}}async renderFile(e){let{path:n,head:i,block:a}=this.parseFileLink(e),o=null;if(n===""?o=this.plugin.app.workspace.getActiveFile():(n.endsWith(".md")||(n=n+".md"),o=this.searchFile(n)),o==null){let u="File not found:"+n;console.error(u);return}let s=await this.getFileContent(o,i,a),{content:l}=Nt(s);return await this.marked.parse(l)}parseLinkStyle(e){let n="",i='style="width:100%;height:100%"',a="left",o=["left","center","right"];if(e.includes("|")){let s=e.split("|");n=s[0];let l="";if(s.length==2?o.includes(s[1])?a=s[1]:l=s[1]:s.length==3&&(l=s[1],o.includes(s[1])?(l=s[2],a=s[1]):(l=s[1],a=s[2])),l!=""){let c=l.split("x");c.length==2?i=`style="width:${c[0]}px;height:${c[1]}px;"`:i=`style="width:${c[0]}px;"`}}else n=e;return{filename:n,style:i,postion:a}}parseSVGLink(e){let n="note-embed-svg-left",i=new Map([["left","note-embed-svg-left"],["center","note-embed-svg-center"],["right","note-embed-svg-right"]]),{filename:a,style:o,postion:s}=this.parseLinkStyle(e);return n=i.get(s)||n,{filename:a,style:o,classname:n}}async renderSVGFile(e,n){let i=this.searchFile(e);if(i==null){let o=A("render.file-not-found")+i;console.error(o),this.previewRender.updateElementByID(n,o);return}let a=await this.getFileContent(i,null,null);Hn.fileCache.set(e,a),this.previewRender.updateElementByID(n,a)}markedExtension(){return{extensions:[{name:"Embed",level:"inline",start:e=>e.indexOf("![["),tokenizer:e=>{let n=e.match(py);return n==null?void 0:{type:"Embed",raw:n[0],href:n[1],text:n[1]}},renderer:e=>{let n=Uu(e.href);if(console.debug("render embed type:",e,n),n=="image"||n=="webp"){let i=this.parseImageLink(e.href);if(i){let a=this.getImagePath(i.path),o=i.width?`width="${i.width}"`:"",s=i.height?`height="${i.height}"`:"";return`<img src="${a}" alt="${e.text}" ${o} ${s} />`}}else if(n=="svg"){let i=this.parseSVGLink(e.href),a=this.generateId(),o=A("render.rendering");return Hn.fileCache.has(i.filename)?o=Hn.fileCache.get(i.filename)||A("render.render-failed"):this.renderSVGFile(i.filename,a),`<span class="${i.classname}"><span class="note-embed-svg" id="${a}" ${i.style}>${o}</span></span>`}else{if(n=="excalidraw")return e.html;if(n=="pdf-crop")return this.renderPdfCrop(e.href);if(n=="note")return e.html;if(n=="video")return this.renderVideo(e.href);if(n=="voice")return this.renderVoice(e.href)}}}],async:!0,walkTokens:async e=>{if(e.type!=="Embed")return;let n=Uu(e.href);n==="excalidraw"?await this.renderExcalidrawAsync(e):n==="note"&&await this.renderMarkdownEmbedAsync(e)}}}async renderExcalidrawAsync(e){if(!this.isPluginInstlled("obsidian-excalidraw-plugin"))return!1;e.html=A("render.excalidraw-failed");let n=this.excalidrawIndex;this.excalidrawIndex++;let i=xe.getInstance(this.plugin.app),a=i.queryElement(n,"div.excalidraw-svg");if(!a){console.error("renderExcalidrawAsync error:","root is null");return}a.removeAttribute("style");try{let o=a.querySelector("img");o&&(o.setAttr("width","100%"),o.setAttr("height","100%"),o.setAttr("style","width:100%;height:100%"));let s=await i.domToImage(a);e.html=`<section class="excalidraw" ><img src="${s}" class="exclaidraw-image" ></section>`}catch(o){console.error("renderExcalidrawAsync error:",o)}}async renderMarkdownEmbedAsync(e){let n=e.href,i=await this.renderFile(n);e.html=`<div class="markdown-embed inline-embed is-loaded">${i}</div>`}renderPdfCrop(e){if(!this.isPluginInstlled("pdf-plus"))return!1;let n=xe.getInstance(this.plugin.app).queryElement(this.pdfCropIndex,".pdf-cropped-embed");return n?(this.pdfCropIndex++,`<section class="pdf-crop">${n.outerHTML}</section>`):A("render.pdf-crop-failed")}renderVideo(e){let n=xe.getInstance(this.plugin.app).queryElement(this.videoIndex,"video");return n?(this.videoIndex++,`<section class="video">${n.outerHTML}</section>`):"render video failed"}renderVoice(e){let n=xe.getInstance(this.plugin.app).queryElement(this.voiceIndex,"audio");return n?(this.voiceIndex++,`<section class="audio">${n.outerHTML}</section>`):"render voice failed"}},Un=Hn;Un.fileCache=new Map});var Vu,Xr,Ku=F(()=>{Ne();Vu=require("obsidian"),Xr=class extends pe{postprocess(t){let e=(0,Vu.sanitizeHTMLToDom)(t),n=createEl("div");n.appendChild(e);let i=n.querySelectorAll("h1, h2, h3, h4, h5, h6");for(let a of i){let o=a.textContent;a.empty(),a.createSpan({text:" ",cls:"one2mp-heading-prefix"}),a.createSpan({cls:"one2mp-heading-outbox"}).createSpan({text:o||"",cls:"one2mp-heading-leaf"}),a.createSpan({cls:"one2mp-heading-tail"})}return Promise.resolve(n.innerHTML)}markedExtension(){return{extensions:[]}}}});function my(){let r=globalThis.MathJax;return r!=null?r:null}function Gu(r,t=!1){var n;let e=my();if(e!=null&&e.tex2svg){let i=e.tex2svg(r,{display:t}),a=(n=i.querySelector("svg"))!=null?n:i;return new XMLSerializer().serializeToString(a)}return gy(r)}var gy,Ju=F(()=>{gy=r=>r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")});var Qu,vy,ei,Zu=F(()=>{Ju();Ne();Qu=/^(\${1,2})(?!\$)((?:\\.|[^\\\n])*?(?:\\.|[^\\\n$]))\1/,vy=/^(\${1,2})\n((?:\\[^]|[^\\])+?)\n\1(?:\n|$)/,ei=class extends pe{renderer(t,e,n=""){n===""&&(n="InlineMath");let i=Gu(t.text,!e);return e?`<span  class="inline-math">${i}</span>`:`<section  class="block-math">${i}</section>`}markedExtension(){return{extensions:[this.inlineMath(),this.blockMath()]}}inlineMath(){return{name:"InlineMath",level:"inline",start(t){let e,n=t;for(;n;){if(e=n.indexOf("$"),e===-1)return;if(n.substring(e).match(Qu))return e;n=n.substring(e+1).replace(/^\$+/,"")}},tokenizer(t){let e=t.match(Qu);if(e)return{type:"InlineMath",raw:e[0],text:e[2].trim(),displayMode:e[1].length===2}},renderer:t=>this.renderer(t,!0)}}blockMath(){return{name:"BlockMath",level:"block",tokenizer(t){let e=t.match(vy);if(e)return{type:"BlockMath",raw:e[0],text:e[2].trim(),displayMode:e[1].length===2}},renderer:t=>this.renderer(t,!1)}}}});var yy,wy,ti,Yu=F(()=>{Ln();Ne();yy=/`(ris|fas):([a-z0-9-]+)`/i,wy=/^`(ris|fas):([a-z0-9-]+)`/i,ti=class extends pe{constructor(){super(...arguments);this.remixIndex=0}prepare(){return this.remixIndex=0,Promise.resolve()}render(){let e=xe.getInstance(this.plugin.app).queryElement(this.remixIndex,".obsidian-icon.react-icon");return e?(this.remixIndex++,e.outerHTML):"<span>remix icon not found </span>"}markedExtension(){return{extensions:[{name:"remixIcon",level:"inline",start:e=>{let n=e.match(yy);if(n)return n.index},tokenizer:e=>{let n=e.match(wy);if(n)return{type:"remixIcon",raw:n[0],text:n[0].trim(),lang:n[1]}},renderer:()=>this.render()}]}}}});var ni,Xu=F(()=>{Ne();ni=class extends pe{markedExtension(){return{extensions:[{name:"table",level:"block",renderer:t=>{let e=(a,o)=>{var u;let s=a.align,l=s?` style="text-align:${s};"`:"",c=(u=a.tokens)!=null&&u.length?this.marked.Parser.parseInline(a.tokens):a.text;return`<${o}${l}>${c}</${o}>`},n=t.header.map(a=>e(a,"th")),i=t.rows.map(a=>`<tr>${a.map(s=>e(s,"td")).join("")}</tr>`);return`<section class="table-container"><table><thead><tr>${n.join("")}</tr></thead><tbody>${i.join("")}</tbody></table></section>`}}]}}}});var ri,ed=F(()=>{Ne();ri=class extends pe{markedExtension(){return{extensions:[{name:"footnote",level:"block",start:t=>{var e;return(e=t.match(/\[\^(\w+)\]:/))==null?void 0:e.index},tokenizer:t=>{let n=/^\[\^(\w+)\]:\s*(.*)/.exec(t);if(n)return{type:"footnote",raw:n[0],id:n[1],text:n[2],tokens:[]}},renderer:t=>{if(t.type==="footnote")return`<div id="footnote-${t.id}" class="footnote"><span class="footnote-id">\u3010${t.id}\u3011 </span>${t.text}</div>`}},{name:"footnoteMark",level:"inline",start:t=>{var e;return(e=t.match(/\[\^(\w+)\]/))==null?void 0:e.index},tokenizer:t=>{let n=/^\[\^(\w+)\]/.exec(t);if(n)return{type:"footnoteMark",raw:n[0],id:n[1],tokens:[]}},renderer:t=>{if(t.type==="footnoteMark")return`<a>${t.text}<sup>\u3010${t.id}\u3011</sup></a>`}}]}}}});var ii,td=F(()=>{Ne();ii=class extends pe{constructor(){super(...arguments);this.allLinks=[]}prepare(){return this.allLinks=[],Promise.resolve()}postprocess(e){var o,s;if(!this.allLinks.length)return Promise.resolve(e);let n=[],i=new Map;for(let l of this.allLinks){let c=i.get(l.href);if(!c){let m={href:l.href,text:l.text};i.set(l.href,m),n.push(m);continue}let u=((o=c.text)==null?void 0:o.trim())||"",d=((s=l.text)==null?void 0:s.trim())||"";d&&d!==l.href&&(u===l.href||d.length>u.length)&&(c.text=d)}let a=n.map(l=>{var d;let c=(d=l.text)==null?void 0:d.trim();return`<li>${c&&c!==l.href?c:"\u5916\u94FE"}\uFF1A<a data-linktype="2" data-link="${l.href}" href="${l.href}">${l.href}</a>&nbsp;\u21A9</li>`});return Promise.resolve(`${e}<section class="foot-links"><hr class="foot-links-separator"><ol>${a.join("")}</ol></section>`)}markedExtension(){return{extensions:[{name:"link",level:"inline",renderer:e=>{let n=i=>i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;");if(e.href.startsWith("http")){let i=(e.text||"").trim(),a=n(e.href);return!i||i===e.href?`<strong>(${a})</strong>`:`${n(i)}<strong>(${a})</strong>`}else return`<a href="${e.href}">${e.text}</a>`}}]}}}});function by(r){return/^h[1-6]$/i.test(r.tagName)}function nd(r){return by(r)?parseInt(r.tagName.charAt(1),10):null}function xy(r,t){let e=nd(t),n=nd(r);return n===null?!0:e===null||e>n}var rd,ai,id=F(()=>{rd=require("obsidian");Ne();ai=class extends pe{processHeading(t,e){var o;let n=["h1","h2","h3","h4","h5","h6"],i=e.trim().toLowerCase();if(!n.includes(i))return t;let a=t.querySelectorAll(e.trim());for(let s=0;s<a.length;s++){let l=a[s];if(l){let c=createEl("details");c.createEl("summary",{text:(o=l.textContent)!=null?o:""});let u=l.nextSibling;for(;u&&xy(l,u);){let d=u.nextSibling;c.appendChild(u),u=d}l.replaceWith(c)}}return t}postprocess(t){let e=this.previewRender.articleProperties.get("folded-headings");if(e===void 0||!e)return Promise.resolve(t);let n=(0,rd.sanitizeHTMLToDom)(t),i=createEl("div");i.appendChild(n);let a=e.split(",");for(let o of a)this.processHeading(i,o);return Promise.resolve(i.innerHTML)}markedExtension(){return{extensions:[]}}}});var Wn,oi,ad=F(()=>{Wn=require("obsidian");Ne();oi=class extends pe{isImageFile(t){if(!(t instanceof Wn.TFile))return!1;let e=t.extension.toLowerCase();return["png","jpg","jpeg","gif","bmp","webp","svg"].includes(e)}findImageFile(t){var m,b,S,k,y;let e=this.plugin.app.vault,n=this.plugin.app.workspace.getActiveFile(),i=(b=(m=n==null?void 0:n.parent)==null?void 0:m.path)!=null?b:"",a="app://obsidian.md/",o=t.trim();if(o.startsWith(a)&&(o=decodeURIComponent(o.slice(a.length))),o=o.split("|")[0].split("?")[0].split("#")[0],!o)return null;let s=this.plugin.app.metadataCache.getFirstLinkpathDest(o,(S=n==null?void 0:n.path)!=null?S:"");if(this.isImageFile(s))return s;if(o.includes("/")){let g=o.split("/").pop()||o;if(s=this.plugin.app.metadataCache.getFirstLinkpathDest(g,(k=n==null?void 0:n.path)!=null?k:""),this.isImageFile(s))return s}let l=e.config,c=(y=l==null?void 0:l.attachmentFolderPath)!=null?y:"",u=o.split("/").pop()||o,d=[];if(!c||c===".")i?(d.push(`${i}/${o}`),d.push(`${i}/${u}`)):d.push(o,u);else if(c.startsWith("./")){let g=c.slice(2),h=i?`${i}/${g}`:g;d.push(`${h}/${o}`),d.push(`${h}/${u}`)}else d.push(`${c}/${o}`),d.push(`${c}/${u}`);for(let g of d)if(s=e.getAbstractFileByPath(g),this.isImageFile(s))return s;let f=e.getAllLoadedFiles();for(let g of f)if(g instanceof Wn.TFile&&g.basename===u&&this.isImageFile(g))return g;return null}resolveImageSrc(t){let e=t.trim();if(!e||/^(https?:|data:)/i.test(e))return e;let n=this.findImageFile(e);return n?this.plugin.app.vault.getResourcePath(n):t}processImage(t){var n,i,a;let e=t.querySelectorAll("img");for(let o=0;o<e.length;o++){let s=e[o],l=(n=s.getAttribute("class"))==null?void 0:n.split(" ");if(l!=null&&l.includes("one2mp-avatar-image"))continue;let c=s.getAttribute("src");c&&s.setAttribute("src",this.resolveImageSrc(c));let d=((i=s.getAttribute("title"))==null?void 0:i.trim())||"",f=createEl("figure",{cls:"image-with-caption"});if((a=s.parentNode)==null||a.insertBefore(f,s),f.appendChild(s),d){let m=f.createEl("div",{cls:"image-caption-row"});m.createEl("div",{cls:"triangle"}),m.createEl("figcaption",{cls:"image-caption",text:d})}}return t}postprocess(t){let e=(0,Wn.sanitizeHTMLToDom)(t),n=createEl("div");return n.appendChild(e),this.processImage(n),Promise.resolve(n.innerHTML)}markedExtension(){return{renderer:{image:t=>{let e=this.resolveImageSrc(t.href||""),n=t.text?`alt="${t.text}"`:'alt=""',i=t.title?` title="${t.title}"`:"";return`<img src="${e}" ${n}${i} />`}},extensions:[]}}}});var si,_y,od,sd=F(()=>{si={header:{start:["%%hh%%","%%hh%"],end:["%%/hh%%","%%/hh%"]},footer:{start:["%%tt%%","%%tt%"],end:["%%/tt%%","%%/tt%"]}},_y=r=>r.trim().toLowerCase(),od=r=>r&&r.split(/\r?\n/).filter(n=>{let i=_y(n);return![...si.header.start,...si.header.end,...si.footer.start,...si.footer.end].includes(i)}).join(`
`)});var cd={};ht(cd,{WechatRender:()=>Dt});var ld,ky,Sy,Ot,Dt,ro=F(()=>{$u();ld=require("obsidian");Mn();Ru();ju();zu();Wu();Ku();Zu();Yu();Xu();ed();td();id();ad();sd();nr();ky={gfm:!0,breaks:!0},Sy=r=>{let t=r.split(/\r?\n/),e=a=>/^[\t ]*([-*_])\1\1+[\t ]*$/.test(a),n=a=>{let o=a.trim();return o?/^!\[\[.+\]\]$/.test(o)?!0:/^!\[[^\]]*]\([^)]+\)$/.test(o):!1},i=[];for(let a=0;a<t.length;a+=1){let o=t[a];e(o)&&a>0&&n(t[a-1])&&i.length&&i[i.length-1].trim()!==""&&i.push(""),i.push(o)}return i.join(`
`)},Ot=class{constructor(t,e){this.extensions=[];this.delayParse=t=>new Promise((e,n)=>{setTimeout(()=>{this.plugin.app.vault.adapter.read(t).then(i=>this.parse(i)).then(i=>this.postprocess(i)).then(e).catch(i=>{let a=i instanceof Error?i:new Error(String(i));n(a)})},100)});this.plugin=t,this.previewRender=e,this.client=Ve.getInstance(t),this.marked=new Nn,this.marked.use(ky),this.marked.use({renderer:{list(n){let i="";if(n.items)for(let s of n.items)i+=this.listitem(s);let a=n.ordered?"ol":"ul",o=n.ordered&&n.start!==1?' start="'+n.start+'"':"";return"<"+a+o+' class="list-paddingleft-1">'+i+"</"+a+">"},listitem(n){return`<li><section>${n.tokens?this.parser.parse(n.tokens):n.text||""}</section></li>`}}}),this.useExtensions()}static getInstance(t,e){return Ot.instance||(Ot.instance=new Ot(t,e)),Ot.instance}static resetInstance(){Ot.instance=null}addExtension(t){this.extensions.push(t),this.marked.use(t.markedExtension())}useExtensions(){this.addExtension(new ri(this.plugin,this.previewRender,this.marked)),this.addExtension(new Xr(this.plugin,this.previewRender,this.marked)),this.addExtension(new Un(this.plugin,this.previewRender,this.marked)),this.addExtension(new Zr(this.plugin,this.previewRender,this.marked)),this.addExtension(new Yr(this.plugin,this.previewRender,this.marked)),this.addExtension(new ei(this.plugin,this.previewRender,this.marked)),this.addExtension(new ti(this.plugin,this.previewRender,this.marked)),this.addExtension(new Jr(this.plugin,this.previewRender,this.marked)),this.addExtension(new ni(this.plugin,this.previewRender,this.marked)),this.addExtension(new ii(this.plugin,this.previewRender,this.marked)),this.addExtension(new ai(this.plugin,this.previewRender,this.marked)),this.addExtension(new oi(this.plugin,this.previewRender,this.marked))}async parse(t){let{content:e}=Nt(t),n=od(e),i=Sy(n);for(let a of this.extensions)await a.prepare();return await this.marked.parse(i)}async postprocess(t){let e=t;for(let n of this.extensions)e=await n.postprocess(e);return e=this.removeEmptyListItems(e),e}removeEmptyListItems(t){let e=document.createElement("div");return e.appendChild((0,ld.sanitizeHTMLToDom)(t)),e.querySelectorAll("ol li, ul li").forEach(n=>{let i=n.querySelector("img, video, figure"),a=n.innerHTML.replace(/<br\s*\/?>/gi,"").replace(/&nbsp;/gi,"").replace(/\u00A0/g,"").replace(/<span[^>]*>\s*<\/span>/gi,"").replace(/<section[^>]*>\s*<\/section>/gi,"").replace(/<div[^>]*>\s*<\/div>/gi,"").replace(/[\s\u200B-\u200D]+/g,"").trim();!i&&a===""&&n.remove()}),e.innerHTML}async parseNote(t){let e=await this.plugin.app.vault.adapter.read(t),n=await this.parse(e);return n=await this.postprocess(n),n}},Dt=Ot;Dt.instance=null});var io,ln,ud=F(()=>{io=require("obsidian"),ln=class{constructor(t){this.app=t}parseObsidianUrl(t){let e=/obsidian:\/\/open\?vault=(.*?)&file=([^,]*),?(.*)$/,n=t.match(e);return n&&n[2]?decodeURIComponent(n[2]):null}getFileFromPath(t){let e=this.app.vault.getAbstractFileByPath(t);return e instanceof io.TFile?e:null}getDisplayUrl(t){if(t)try{return this.app.vault.getResourcePath(t)}catch(e){console.error("Error reading file:",e)}return null}getInternalLinkDisplayUrl(t){let e=this.parseObsidianUrl(t);if(e){let n=this.getFileFromPath(e);if(n)return this.getDisplayUrl(n)}return null}}});var Te,_e,Vn,ao,dd,fd=F(()=>{Te={title:"\u6807\u9898",author:"\u4F5C\u8005",digest:"\u6458\u8981",sourceUrl:"\u539F\u6587\u94FE\u63A5",cover:"\u5C01\u9762\u56FE",openComment:"\u5F00\u542F\u8BC4\u8BBA",onlyFans:"\u4EC5\u7C89\u4E1D\u53EF\u8BC4\u8BBA"},_e={title:[Te.title,"title"],author:[Te.author,"author"],digest:[Te.digest,"digest","description","summary"],sourceUrl:[Te.sourceUrl,"content_source_url","source_url"],cover:[Te.cover,"cover","thumbnail","one2mp_cover"],openComment:[Te.openComment,"need_open_comment","open_comment"],onlyFans:[Te.onlyFans,"only_fans_can_comment"]},Vn=(r,t)=>{if(r)for(let e of t){let n=r[e];if(typeof n=="string"&&n.trim()!=="")return n.trim()}},ao=(r,t)=>{if(!r)return;let e=new Set(["1","true","yes","y","on","\u662F","\u5F00\u542F","\u5F00"]),n=new Set(["0","false","no","n","off","\u5426","\u5173\u95ED","\u5173"]);for(let i of t){let a=r[i];if(typeof a=="boolean")return a?1:0;if(typeof a=="number")return a>0?1:0;if(typeof a=="string"){let o=a.trim().toLowerCase();if(e.has(o))return 1;if(n.has(o))return 0}}},dd=r=>{if(!r)return null;for(let t of _e.cover){let e=r[t];if(typeof e=="string"&&e.trim()!=="")return e.trim()}return null}});var ce,li,oo,hd=F(()=>{ce=require("obsidian");Dn();ud();Ut();Mn();$e();bi();fd();li=class{constructor(t,e){this.coverImageRef=null;this.coverImageWrap=null;this.coverImageEl=null;this.coverNaturalWidth=0;this.coverNaturalHeight=0;this.coverTransform={scale:1,offsetX:0,offsetY:0};this.coverResizeObserver=null;this.coverFrontmatterKey=Te.cover;this.coverVaultPrefix="vault:";this.coverImageExtensions=["png","jpg","jpeg","gif","webp","bmp","svg","tiff"];this.plugin=t,this.localDraftmanager=ft.getInstance(t),this.BuildUI(e),this.coverResizeDebounced=(0,ce.debounce)(()=>this.handleCoverFrameResize(),80),typeof ResizeObserver!="undefined"&&(this.coverResizeObserver=new ResizeObserver(()=>{this.coverResizeDebounced()}),this.coverResizeObserver.observe(this.coverFrame)),this.plugin.messageService.registerListener("wechat-account-changed",()=>{this.updateLocalDraft()}),this.plugin.messageService.registerListener("active-file-changed",()=>{this.updateLocalDraft()}),this.plugin.messageService.registerListener("set-draft-cover-image",n=>{this.coverImageRef=n,this.cover_image=this.resolveCoverUrl(n),this.resetCoverCropState(this.coverImageRef),this.setCoverImage(this.cover_image),this.saveCoverToFrontmatter(this.coverImageRef),this.activeLocalDraft&&(this.activeLocalDraft.thumb_media_id=void 0,this.localDraftmanager.setDraft(this.activeLocalDraft))}),this.plugin.messageService.registerListener("set-image-as-cover",n=>{this.coverImageRef=n.url,this.cover_image=this.resolveCoverUrl(n.url),this.resetCoverCropState(this.coverImageRef),this.setCoverImage(this.cover_image),this.saveCoverToFrontmatter(this.coverImageRef),this.activeLocalDraft&&(this.activeLocalDraft.thumb_media_id=n.media_id,this.localDraftmanager.setDraft(this.activeLocalDraft))}),this.updateLocalDraft()}updateDraftDraftId(t){this.activeLocalDraft!==void 0&&(this.activeLocalDraft.last_draft_id=t)}resetCoverTransform(){this.coverTransform={scale:1,offsetX:0,offsetY:0}}async resetCoverCropState(t){this.activeLocalDraft&&(delete this.activeLocalDraft.cover_crop_scale,delete this.activeLocalDraft.cover_crop_offset_x,delete this.activeLocalDraft.cover_crop_offset_y,delete this.activeLocalDraft.pic_crop_235_1,delete this.activeLocalDraft.pic_crop_1_1,t!==void 0?this.activeLocalDraft.cover_crop_ref=t||void 0:delete this.activeLocalDraft.cover_crop_ref,await this.localDraftmanager.setDraft(this.activeLocalDraft))}restoreCoverTransform(){this.resetCoverTransform()}applyCoverTransform(t=!1){!this.coverImageEl||!this.coverImageWrap||(this.coverImageWrap.setCssProps({left:"0",top:"0",width:"100%",height:"100%",transform:"none"}),this.coverImageEl.setCssProps({width:"100%",height:"100%","object-fit":"cover"}))}handleCoverFrameResize(){this.coverImageEl&&this.applyCoverTransform(!1)}onNoteRename(t){let e=this.plugin.app.workspace.getActiveFile();e===void 0||t!==e||this.activeLocalDraft!==void 0&&(this.activeLocalDraft.notePath=t.path,ft.getInstance(this.plugin).setDraft(this.activeLocalDraft))}getActiveLocalDraft(){return this.activeLocalDraft}getRootEl(){return this.rootEl}BuildUI(t){this.rootEl=t.createDiv({cls:"one2mp-meta-card"});let e=this.rootEl.createDiv({cls:"one2mp-cover-container"});e.createDiv({cls:"one2mp-cover-hint",text:A("views.article-header.cover-image-description")}),this.coverFrame=this.createCoverFrame(e),ce.Platform.isMobile&&e.createDiv({cls:"one2mp-cover-mobile-action"}).createEl("button",{cls:"one2mp-cover-mobile-button",text:A("views.article-header.cover-image-mobile-button")}).addEventListener("click",()=>{this.openMobileCoverModal()});let n=this.rootEl.createDiv({cls:"one2mp-digest-container"});this.digestInput=new ce.TextAreaComponent(n),this.digestInput.setPlaceholder(A("views.article-header.digest-text")),this.digestInput.inputEl.rows=4,this.digestInput.inputEl.addClass("one2mp-digest-input"),this.digestInput.onChange(i=>{let a=this.activeLocalDraft;a&&(a.digest=i,(async()=>(await this.localDraftmanager.setDraft(a),await this.saveDigestToFrontmatter(i)))())})}async saveDigestToFrontmatter(t){let e=this.getActiveMarkdownFile();e&&await this.plugin.app.fileManager.processFrontMatter(e,n=>{n[Te.digest]=t,n[_e.digest[0]]&&_e.digest[0]!==Te.digest&&delete n[_e.digest[0]]})}getActiveMarkdownFile(){let t=this.plugin.app.workspace.getActiveFile();return!t||t.extension!=="md"&&t.extension!=="markdown"?null:t}getCoverFromFrontmatter(){var n,i;let t=this.getActiveMarkdownFile();if(!t)return null;let e=(i=(n=this.plugin.app.metadataCache.getFileCache(t))==null?void 0:n.frontmatter)!=null?i:null;return dd(e)}getVaultRelativePathFromAbsolute(t){let e=this.plugin.app.vault.adapter;if(!(e instanceof ce.FileSystemAdapter))return null;let n=e.getBasePath();if(!t.startsWith(n))return null;let i=t.slice(n.length);return(i.startsWith("/")||i.startsWith("\\"))&&(i=i.slice(1)),i.replace(/\\/g,"/")}getActiveRootFolder(){let t=this.getActiveMarkdownFile();if(!t)return null;let e=t.path.split("/");return e.length<=1?null:e[0]||null}getVaultPathCandidates(t){let e=t.replace(/^\/+/,""),n=[e],i=this.getActiveRootFolder();return i&&!e.startsWith(`${i}/`)&&n.push(`${i}/${e}`),n}resolveCoverUrl(t){if(!t||!t.trim())return null;let e=t.trim();if(e.startsWith(this.coverVaultPrefix)){let i=e.slice(this.coverVaultPrefix.length);for(let a of this.getVaultPathCandidates(i)){let o=this.plugin.app.vault.getAbstractFileByPath(a);if(o instanceof ce.TFile)return this.plugin.app.vault.getResourcePath(o)}return null}if(e.startsWith("obsidian://")){let a=new ln(this.plugin.app).parseObsidianUrl(e);if(a){let o=this.plugin.app.vault.getAbstractFileByPath(a);if(o instanceof ce.TFile)return this.plugin.app.vault.getResourcePath(o)}}let n=this.plugin.app.vault.getAbstractFileByPath(e);return n instanceof ce.TFile?this.plugin.app.vault.getResourcePath(n):e}getCoverFileFromRef(t){if(!t||!t.trim())return null;let e=t.trim();if(e.startsWith(this.coverVaultPrefix)){let i=e.slice(this.coverVaultPrefix.length);for(let a of this.getVaultPathCandidates(i)){let o=this.plugin.app.vault.getAbstractFileByPath(a);if(o instanceof ce.TFile)return o}return null}if(e.startsWith("obsidian://")){let a=new ln(this.plugin.app).parseObsidianUrl(e);if(a){let o=this.plugin.app.vault.getAbstractFileByPath(a);return o instanceof ce.TFile?o:null}}let n=this.plugin.app.vault.getAbstractFileByPath(e);return n instanceof ce.TFile?n:null}async saveCoverToFrontmatter(t){let e=this.getActiveMarkdownFile();e&&await this.plugin.app.fileManager.processFrontMatter(e,n=>{if(t&&t.trim()!==""){n[this.coverFrontmatterKey]=t;for(let i of _e.cover)i!==this.coverFrontmatterKey&&delete n[i]}else for(let i of _e.cover)delete n[i]})}createCoverFrame(t){let e=t.createDiv({cls:"cover-frame",attr:{droppable:!0}});return e.ondragenter=n=>{n.preventDefault(),e.addClass("image-on-dragover")},e.ondragleave=n=>{n.preventDefault(),e.removeClass("image-on-dragover")},e.ondragover=n=>{n.preventDefault()},e.addEventListener("drop",n=>{this.handleCoverDrop(n,e)}),e}async handleCoverDrop(t,e){var a,o,s,l,c;t.preventDefault();let n=t.dataTransfer,i=(o=(a=n==null?void 0:n.getData("text/uri-list"))==null?void 0:a.trim())!=null?o:"";if(i||(i=(l=(s=n==null?void 0:n.getData("text/plain"))==null?void 0:s.trim())!=null?l:""),i.includes(`
`)&&(i=(c=i.split(/\r?\n/).map(d=>d.trim()).filter(d=>d&&!d.startsWith("#"))[0])!=null?c:""),this.activeLocalDraft||await this.updateLocalDraft(),i){let u=null,d=null;if(i.startsWith("obsidian://")){let m=new ln(this.plugin.app).parseObsidianUrl(i);m&&(u=`${this.coverVaultPrefix}${m}`,d=this.resolveCoverUrl(u))}else if(i.startsWith("http")||i.startsWith("https")){if(u=i,d=i,this.activeLocalDraft){let f=await this.getCoverImageMediaId(i);f?(e.setAttr("data-media_id",f),this.activeLocalDraft.thumb_media_id=f):(e.removeAttribute("data-media_id"),this.activeLocalDraft.thumb_media_id=void 0)}}else if(i.startsWith("file://")){let f=decodeURIComponent(i.replace("file://","")),m=this.getVaultRelativePathFromAbsolute(f);m?(u=`${this.coverVaultPrefix}${m}`,d=this.resolveCoverUrl(u)):ce.Platform.isMobile?(new ce.Notice(A("views.article-header.cover-file-not-supported")),u=null,d=""):(u=i,d=i)}else this.plugin.app.vault.getAbstractFileByPath(i)instanceof ce.TFile?(u=`${this.coverVaultPrefix}${i}`,d=this.resolveCoverUrl(u)):(u=null,d="",this.setCoverImageXY());this.activeLocalDraft!==void 0&&(this.activeLocalDraft.cover_image_url=u||"",await this.localDraftmanager.setDraft(this.activeLocalDraft)),this.coverImageRef=u,this.cover_image=d,await this.resetCoverCropState(u),await this.saveCoverToFrontmatter(this.coverImageRef),this.setCoverImage(this.cover_image||"")}e.removeClass("image-on-dragover")}openMobileCoverModal(){new oo(this.plugin,this.coverImageExtensions,async t=>{let{filePath:e,url:n}=t,i=null;e?i=`${this.coverVaultPrefix}${e}`:n&&(i=n),await this.applyCoverRef(i)}).open()}async applyCoverRef(t){let e=t?this.resolveCoverUrl(t):"";this.activeLocalDraft&&(this.activeLocalDraft.cover_image_url=t||"",this.activeLocalDraft.thumb_media_id=void 0,await this.localDraftmanager.setDraft(this.activeLocalDraft)),this.coverImageRef=t,this.cover_image=e,await this.resetCoverCropState(t),await this.saveCoverToFrontmatter(this.coverImageRef),this.setCoverImage(this.cover_image||"")}setCoverImage(t){var o,s;for(;this.coverFrame.firstChild;)this.coverFrame.firstChild.remove();if(this.coverImageEl=null,this.coverImageWrap=null,this.coverNaturalWidth=0,this.coverNaturalHeight=0,!t){(o=this.coverFrame.parentElement)==null||o.removeClass("has-image");return}(s=this.coverFrame.parentElement)==null||s.addClass("has-image");let e=new Image;e.decoding="async",e.loading="lazy";let n=document.createElement("div");n.className="one2mp-cover-image-wrap",e.className="one2mp-cover-image",n.appendChild(e),this.coverFrame.appendChild(n),this.coverImageWrap=n,this.coverImageEl=e;let i=!1,a=()=>{i||(i=!0,this.coverNaturalWidth=e.naturalWidth||e.width,this.coverNaturalHeight=e.naturalHeight||e.height,this.resetCoverTransform(),this.restoreCoverTransform(),this.applyCoverTransform(!1))};e.onload=a,e.src=t,e.complete&&e.naturalWidth&&a()}resetImage(){this.setCoverImageXY(0,0)}async checkCoverImage(){if(await this.syncDraftFromFrontmatter(),this.activeLocalDraft!==void 0)if(this.activeLocalDraft.thumb_media_id===void 0||!this.activeLocalDraft.thumb_media_id){let t=this.coverImageRef||this.cover_image;if(t){let e=await this.getCoverImageMediaId(t,!0);return this.activeLocalDraft.thumb_media_id=e,!0}}else return!0;return!1}async getCoverImageMediaId(t,e=!1){let n;if(e){let i,a=this.getCoverFileFromRef(t);if(a){let s=await this.plugin.app.vault.readBinary(a);i=new Blob([s])}else{let s=this.resolveCoverUrl(t);i=await gn(s||t,this.plugin.app)}if(i===void 0||!i)return;let o=await Ve.getInstance(this.plugin).uploadMaterial(i,"banner-cover.png","image");if(o){let{errcode:s,media_id:l}=o;if(s!==0){new ce.Notice(A("views.article-header.upload-cover-image-error"));return}else n=l}}return n}setCoverImageXY(t=0,e=0){if(!this.coverImageEl){this.setCoverImage(this.cover_image);return}this.applyCoverTransform(!1)}getFrontmatter(){var e,n;let t=this.getActiveMarkdownFile();return t&&(n=(e=this.plugin.app.metadataCache.getFileCache(t))==null?void 0:e.frontmatter)!=null?n:null}async migrateFrontmatterKeys(){let t=this.getActiveMarkdownFile();if(!t)return;let e=this.getFrontmatter();if(!e)return;let n=[{canonical:Te.title,aliases:_e.title},{canonical:Te.author,aliases:_e.author},{canonical:Te.digest,aliases:_e.digest},{canonical:Te.sourceUrl,aliases:_e.sourceUrl},{canonical:Te.cover,aliases:_e.cover},{canonical:Te.openComment,aliases:_e.openComment},{canonical:Te.onlyFans,aliases:_e.onlyFans}];n.some(a=>a.aliases.some(o=>o!==a.canonical&&e[o]!==void 0))&&await this.plugin.app.fileManager.processFrontMatter(t,a=>{for(let o of n)if(a[o.canonical]===void 0){for(let s of o.aliases)if(s!==o.canonical&&a[s]!==void 0){a[o.canonical]=a[s],delete a[s];break}}else for(let s of o.aliases)s!==o.canonical&&a[s]!==void 0&&delete a[s]})}async syncDraftFromFrontmatter(){if(!this.activeLocalDraft)return;let t=this.getFrontmatter(),e=this.getActiveMarkdownFile(),n=Vn(t,_e.title)||(e==null?void 0:e.basename)||this.activeLocalDraft.title||"",i=Vn(t,_e.author),a=Vn(t,_e.digest),o=Vn(t,_e.sourceUrl),s=ao(t,_e.openComment),l=ao(t,_e.onlyFans);this.activeLocalDraft.title=n,this.activeLocalDraft.author=i,this.activeLocalDraft.digest=a,this.digestInput&&this.digestInput.setValue(a||""),this.activeLocalDraft.content_source_url=o,s!==void 0?this.activeLocalDraft.need_open_comment=s:this.activeLocalDraft.need_open_comment===void 0&&(this.activeLocalDraft.need_open_comment=1),l!==void 0?this.activeLocalDraft.only_fans_can_comment=l:this.activeLocalDraft.only_fans_can_comment===void 0&&(this.activeLocalDraft.only_fans_can_comment=0),await this.localDraftmanager.setDraft(this.activeLocalDraft),this.plugin.messageService.sendMessage("draft-title-updated",n)}async updateLocalDraft(){return this.activeLocalDraft=await this.localDraftmanager.getDrafOfActiveNote(),await this.updateHeaderProporties(),!0}async updateHeaderProporties(){await this.migrateFrontmatterKeys();let e=this.getCoverFromFrontmatter();this.activeLocalDraft!==void 0&&(await this.syncDraftFromFrontmatter(),!e&&this.activeLocalDraft.cover_image_url&&(e=this.activeLocalDraft.cover_image_url),this.activeLocalDraft.cover_image_url=e||"",this.activeLocalDraft.cover_crop_ref!==(e||"")&&await this.resetCoverCropState(e||void 0),await this.localDraftmanager.setDraft(this.activeLocalDraft));let n=e||"",i=this.coverImageRef||"",a=n!==i;this.coverImageRef=n,this.cover_image=this.resolveCoverUrl(this.coverImageRef),a||!this.coverImageEl?this.setCoverImage(this.cover_image):this.setCoverImageXY()}},oo=class extends ce.Modal{constructor(e,n,i){super(e.app);this.plugin=e;this.imageExtensions=n;this.onSubmit=i}onOpen(){let{contentEl:e}=this;e.empty(),e.createEl("h3",{text:A("views.article-header.cover-image-mobile-title")}),new ce.Setting(e).setName(A("views.article-header.cover-image-mobile-vault")).setDesc(A("views.article-header.cover-image-mobile-vault-desc")).addText(o=>{this.fileInput=o,this.fileInput.setPlaceholder(A("views.article-header.cover-image-mobile-vault-placeholder")),new qt(this.plugin.app,this.fileInput.inputEl,this.imageExtensions)}),new ce.Setting(e).setName(A("views.article-header.cover-image-mobile-url")).setDesc(A("views.article-header.cover-image-mobile-url-desc")).addText(o=>{this.urlInput=o,this.urlInput.setPlaceholder("https://")});let a=e.createDiv("modal-button-container");a.createEl("button",{text:A("modals.confirm")}).addEventListener("click",()=>{var c,u;let o=(c=this.fileInput)==null?void 0:c.getValue().trim(),s=(u=this.urlInput)==null?void 0:u.getValue().trim();if(!o&&!s){new ce.Notice(A("views.article-header.cover-image-mobile-required"));return}let l=null;if(o){let d=this.plugin.app.vault.getAbstractFileByPath(o);if(!(d instanceof ce.TFile)){new ce.Notice(A("views.article-header.cover-image-mobile-invalid"));return}l=d.path}this.onSubmit({filePath:l,url:s||null}),this.close()}),a.createEl("button",{text:A("modals.cancel")}).addEventListener("click",()=>{this.close()})}onClose(){this.contentEl.empty()}}});var Pe,ci,pd=F(()=>{Pe=require("obsidian");$e();Dn();ci=class extends Pe.Modal{constructor(e,n){super(e);this.plugin=n,this.updateCurrentAccount()}updateCurrentAccount(){let e=this.plugin.settings.selectedMPAccount;e&&(this.account=this.plugin.getMPAccountByName(e))}onOpen(){let{contentEl:e}=this;if(e.empty(),e.addClass("one2mp-publish-modal"),e.createEl("h2",{text:A("publish-config.title")}),!this.account){new Pe.Notice(A("wechat-api.select-an-wechat-mp-account-first")),this.close();return}this.renderMPCardSection(e),this.renderOtherSettings(e)}renderMPCardSection(e){let n=e.createEl("details",{cls:"one2mp-config-section"});n.open=!0,n.createEl("summary",{text:A("publish-config.mp-card-settings")});let i=n.createDiv({cls:"one2mp-config-content"}),a=i.createDiv({cls:"one2mp-card-preview"});this.renderCardPreview(a);let o=i.createDiv({cls:"one2mp-card-parser"});o.createEl("p",{text:A("publish-config.paste-html-guide"),cls:"setting-item-description"});let s=new Pe.TextAreaComponent(o);s.setPlaceholder("<mp-common-profile ... >"),s.inputEl.rows=3,s.inputEl.setCssProps({width:"100%"});let c=o.createDiv({cls:"one2mp-parser-actions"}).createEl("button",{text:A("publish-config.parse-and-save")});c.onclick=()=>{let f=s.getValue();this.parseAndSaveCard(f)?(s.setValue(""),this.renderCardPreview(a),new Pe.Notice(A("publish-config.card-updated"))):new Pe.Notice(A("publish-config.parse-failed"))};let u=i.createEl("details",{cls:"one2mp-manual-edit"});u.createEl("summary",{text:A("publish-config.manual-edit")});let d=u.createDiv();this.renderManualFields(d,a)}renderCardPreview(e){e.empty();let n=this.plugin.settings.defaultMpcard;if(n&&n.includes("```mpcard")){let i=n.replace(/```mpcard|```/g,"").trim().split(`
`),a={};i.forEach(c=>{let[u,...d]=c.split(":");u&&d&&(a[u.trim()]=d.join(":").trim())});let o=e.createDiv({cls:"one2mp-mpcard-wrapper"});o.setCssProps({"max-width":"100%"});let s=o.createDiv({cls:"one2mp-mpcard-content"});if(a.headimg){let c=s.createEl("img",{cls:"one2mp-mpcard-headimg"});c.src=a.headimg}let l=s.createDiv({cls:"one2mp-mpcard-info"});l.createDiv({cls:"one2mp-mpcard-nickname",text:a.nickname||"No Nickname"}),l.createDiv({cls:"one2mp-mpcard-signature",text:a.signature||"No Signature"})}else e.createDiv({text:A("publish-config.mpcard-empty"),cls:"setting-item-description"})}parseAndSaveCard(e){let n=e.match(/data-nickname="([^"]*)"/),i=e.match(/data-headimg="([^"]*)"/),a=e.match(/data-signature="([^"]*)"/),o=e.match(/data-id="([^"]*)"/);return!n&&!i?!1:(n&&(this.plugin.settings.defaultMpcardNickname=n[1]),i&&(this.plugin.settings.defaultMpcardHeadimg=i[1]),a&&(this.plugin.settings.defaultMpcardSignature=a[1]),o&&(this.plugin.settings.defaultMpcardId=o[1]),this.saveSettings(),!0)}saveSettings(){var s,l,c,u;let e=[],n=(s=this.plugin.settings.defaultMpcardId)==null?void 0:s.trim(),i=(l=this.plugin.settings.defaultMpcardHeadimg)==null?void 0:l.trim(),a=(c=this.plugin.settings.defaultMpcardNickname)==null?void 0:c.trim(),o=(u=this.plugin.settings.defaultMpcardSignature)==null?void 0:u.trim();n&&e.push(`id: ${n}`),i&&e.push(`headimg: ${i}`),a&&e.push(`nickname: ${a}`),o&&e.push(`signature: ${o}`),e.length>0?this.plugin.settings.defaultMpcard=["```mpcard",...e,"```"].join(`
`):this.plugin.settings.defaultMpcard="",this.plugin.saveSettings()}renderManualFields(e,n){new Pe.Setting(e).setName(A("settings.default-mpcard-nickname")).setClass("one2mp-setting-wide").addText(i=>i.setValue(this.plugin.settings.defaultMpcardNickname||"").onChange(a=>{this.plugin.settings.defaultMpcardNickname=a,this.saveSettings(),this.renderCardPreview(n)})),new Pe.Setting(e).setName(A("settings.default-mpcard-headimg")).setClass("one2mp-setting-wide").addText(i=>i.setValue(this.plugin.settings.defaultMpcardHeadimg||"").onChange(a=>{this.plugin.settings.defaultMpcardHeadimg=a,this.saveSettings(),this.renderCardPreview(n)})),new Pe.Setting(e).setName(A("settings.default-mpcard-signature")).setClass("one2mp-setting-wide").addTextArea(i=>i.setValue(this.plugin.settings.defaultMpcardSignature||"").setPlaceholder("...").onChange(a=>{this.plugin.settings.defaultMpcardSignature=a,this.saveSettings(),this.renderCardPreview(n)})),e.findAll("textarea").forEach(i=>i.rows=4),new Pe.Setting(e).setName(A("settings.default-mpcard-biz-id")).setDesc(A("settings.default-mpcard-biz-id-desc")).setClass("one2mp-setting-wide").addText(i=>i.setValue(this.plugin.settings.defaultMpcardId||"").onChange(a=>{this.plugin.settings.defaultMpcardId=a,this.saveSettings()}))}renderOtherSettings(e){let n=e.createEl("details",{cls:"one2mp-config-section"});n.createEl("summary",{text:A("publish-config.other-settings")});let i=n.createDiv({cls:"one2mp-config-content"});new Pe.Setting(i).setName(A("settings.draft-previewer-wechat-id")).setDesc(A("settings.draft-only-visible-for-the-wechat-user-o")).addText(o=>o.setValue(this.plugin.settings.previewer_wxname||"").onChange(s=>{this.plugin.settings.previewer_wxname=s,this.plugin.saveSettings()})).addButton(o=>{o.setButtonText(A("views.preview-draft")).setIcon("eye").setTooltip(A("settings.preview-draft-tooltip")).onClick(()=>{(async()=>{var u;if(!((u=this.plugin.settings.previewer_wxname)!=null&&u.trim())){new Pe.Notice(A("views.previewer.preview-draft-missing-wxid"));return}let s=await ft.getInstance(this.plugin).getDrafOfActiveNote(),l=s==null?void 0:s.last_draft_id;if(!l){new Pe.Notice(A("views.previewer.preview-draft-missing-id"));return}await this.plugin.wechatClient.senfForPreview(l)&&new Pe.Notice(A("views.previewer.preview-draft-sent"))})()})})}onClose(){let{contentEl:e}=this;e.empty()}}});var md={};ht(md,{ThemeSelector:()=>so});var gd,so,vd=F(()=>{gd=require("obsidian");pn();$e();so=class{constructor(t){this.plugin=t,this._themeManager=jt.getInstance(t),this.plugin.messageService.registerListener("custom-theme-folder-changed",()=>{this.updateThemeOptions()})}async dropdown(t){this._themeDropdown=t,await this.updateThemeOptions(),t.onChange(e=>{this.plugin.settings.custom_theme=e,this.plugin.saveSettings(),this.plugin.messageService.sendMessage("custom-theme-changed",e)})}async updateThemeOptions(){let t=await this._themeManager.loadThemes();this._themeDropdown.selectEl.length=0,this._themeDropdown.addOption("--default--",A("views.theme-manager.default-theme")),t.forEach(e=>{this._themeDropdown.addOption(e.path,e.name)}),this.plugin.settings.custom_theme===void 0||!this.plugin.settings.custom_theme?this._themeDropdown.setValue("--default--"):this._themeDropdown.setValue(this.plugin.settings.custom_theme)}onThemeChange(t){t instanceof gd.TFile&&t.extension==="md"&&t.path.startsWith(this.plugin.settings.css_styles_folder)&&this.updateThemeOptions()}startWatchThemes(){this.plugin.registerEvent(this.plugin.app.vault.on("rename",t=>{this.onThemeChange(t)})),this.plugin.registerEvent(this.plugin.app.vault.on("modify",t=>{this.onThemeChange(t)})),this.plugin.registerEvent(this.plugin.app.vault.on("create",t=>{this.onThemeChange(t)})),this.plugin.registerEvent(this.plugin.app.vault.on("delete",t=>{this.onThemeChange(t)}))}}});var yd={};ht(yd,{PreviewPanel:()=>co,VIEW_TYPE_ONE2MP_PREVIEW:()=>lo});var se,lo,co,wd=F(()=>{se=require("obsidian");$e();Ln();pu();ja();ro();fi();Mn();hd();pd();lo="one2mp-article-preview",co=class extends se.ItemView{constructor(e,n){super(e);this.markdownView=null;this.listeners=[];this.messageUnsubscribes=[];this.themeSelector=null;this.themeManagerModule=null;this.allowRender=!1;this.initialRenderScheduled=!1;this.debouncedRender=(0,se.debounce)(async()=>{this.plugin.settings.realTimeRender&&await this.renderDraft()},1e3);this.debouncedUpdate=(0,se.debounce)(async()=>{this.plugin.settings.realTimeRender&&await this.renderDraft()},1e3);this.debouncedCustomThemeChange=(0,se.debounce)(e=>{this.renderDraft(!0)},2e3);this.articleProperties=new Map;this.editorView=null;this.isActive=!1;this.plugin=n,this.wechatClient=Ve.getInstance(this.plugin)}getViewType(){return lo}getDisplayText(){return A("views.previewer.one2mp-previewer")}getIcon(){return"one2mp-logo"}async onOpen(){var e,n;await this.ensureThemeSelector(),this.buildUI(),this.startListen(),this.isActive=!0,this.markdownView=(e=Xe.getInstance(this.plugin).getCurrentMarkdownView())!=null?e:null,this.scheduleInitialRender(),this.messageUnsubscribes.push(this.plugin.messageService.registerListener("draft-title-updated",i=>{this.setPreviewTitle(i)})),(n=this.themeSelector)==null||n.startWatchThemes(),this.messageUnsubscribes.push(this.plugin.messageService.registerListener("custom-theme-changed",i=>{this.debouncedCustomThemeChange(i)})),this.plugin.messageService.sendMessage("active-file-changed",null),await this.loadComponents()}scheduleInitialRender(){if(this.initialRenderScheduled)return;this.initialRenderScheduled=!0;let e=()=>{this.renderDraft(!0)};this.plugin.app.workspace.onLayoutReady(()=>{let n=window.requestIdleCallback;typeof n=="function"?n(e,{timeout:2e3}):setTimeout(e,300)})}async ensureThemeSelector(){if(this.themeSelector)return;let{ThemeSelector:e}=await Promise.resolve().then(()=>(vd(),md));this.themeSelector=new e(this.plugin)}async getThemeManager(){return this.themeManagerModule||(this.themeManagerModule=await Promise.resolve().then(()=>(pn(),ir))),this.themeManagerModule.ThemeManager}getArticleProperties(){let e=this.plugin.app.workspace.getActiveFile();if((e==null?void 0:e.extension)==="md"||(e==null?void 0:e.extension)==="markdown"){let n=this.app.metadataCache.getCache(e.path),i=n==null?void 0:n.frontmatter;this.articleProperties.clear(),i!=null&&Object.keys(i).forEach(a=>{this.articleProperties.set(a,i[a])})}return this.articleProperties}async setArticleProperties(){let e=this.getCurrentMarkdownFile();if(e&&this.articleProperties.size>0){let n=this.app.vault.getAbstractFileByPath(e);if(!(n instanceof se.TFile))throw new Error(A("views.previewer.file-not-found-path",[e]));await this.app.fileManager.processFrontMatter(n,i=>{this.articleProperties.forEach((a,o)=>{i[o]=a})})}}getCurrentMarkdownFile(){var i,a;let e=this.plugin.app.workspace.getActiveFile(),n=this.plugin.app.workspace.getLeavesOfType("markdown");for(let o of n){let s=o.view;if(((i=s.file)==null?void 0:i.path)===(e==null?void 0:e.path))return(a=s.file)==null?void 0:a.path}return null}buildUI(){let e=this.containerEl.children[1];e.empty(),e.addClass("one2mp-preview-container"),this.buildToolbar(e);let n=e.createDiv({cls:"one2mp-main-scroll-area"});this.draftHeader=new li(this.plugin,n),this.previewTitleEl=n.createDiv({cls:"one2mp-preview-title"}),this.setPreviewTitle(),this.renderDiv=n.createDiv({cls:"render-container"}),this.renderDiv.id="render-div",this.renderPreviewer=n.createDiv({cls:"one2mp-render-preview"}),this.containerDiv=this.renderDiv.createDiv({cls:"one2mp-article"}),this.articleDiv=this.containerDiv.createDiv({cls:"article-div"})}buildToolbar(e){let n=e.createDiv({cls:"one2mp-preview-toolbar"}),i=n.createDiv({cls:"toolbar-group-left"});this.accountDropdown=new se.DropdownComponent(i),this.updateAccountOptions(),this.accountDropdown.onChange(f=>{this.plugin.settings.selectedMPAccount=f,this.plugin.saveSettings(),this.plugin.messageService.sendMessage("wechat-account-changed",f),new se.Notice(`Switched to: ${f}`)}),n.createDiv({cls:"toolbar-group-center"});let a=n.createDiv({cls:"toolbar-group-right"}),o=a.createDiv({cls:"one2mp-toolbar-actions-group"}),s=new se.DropdownComponent(o);this.themeSelector?this.themeSelector.dropdown(s):(s.addOption("--default--",A("views.theme-manager.default-theme")),s.setDisabled(!0));let l=(f,m,b)=>{let S=o.createEl("button",{cls:"clickable-icon one2mp-toolbar-btn"});return(0,se.setIcon)(S,f),S.setAttribute("aria-label",m),S.onclick=b,S};l("settings",A("views.previewer.publish-config"),()=>{new ci(this.app,this.plugin).open()}),l("refresh-cw",A("views.previewer.render-article"),()=>{this.renderDraft(!0)}),l("clipboard-copy",A("views.previewer.copy-article-to-clipboard"),()=>{var m,b;let f=this.getArticleContent();if((m=navigator.clipboard)!=null&&m.write&&window.ClipboardItem){navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([f],{type:"text/html"})})]).then(()=>{new se.Notice(A("views.previewer.article-copied-to-clipboard"))}).catch(S=>{console.warn("\u590D\u5236\u5230\u526A\u8D34\u677F\u5931\u8D25",S)});return}if((b=navigator.clipboard)!=null&&b.writeText){navigator.clipboard.writeText(f).then(()=>{new se.Notice(A("views.previewer.article-copied-to-clipboard"))}).catch(S=>{console.warn("\u590D\u5236\u5230\u526A\u8D34\u677F\u5931\u8D25",S)});return}new se.Notice(A("settings.clipboard-not-supported"))}),l("send-horizontal",A("views.previewer.send-article-to-draft-box"),()=>{(async()=>await this.checkCoverImage()?this.sendArticleToDraftBox():new se.Notice(A("views.previewer.please-set-cover-image")))()});let c=a.createDiv({cls:"one2mp-toolbar-ip"}),u=f=>{if(c.empty(),!f.direct&&!f.proxy){c.setText("IP: ...");return}let m=(b,S)=>{let k=c.createDiv({cls:"one2mp-ip-subrow"});k.createSpan({text:b+": ",cls:"label"});let y=S==="single"?f.direct||f.proxy:S==="direct"?f.direct:f.proxy;k.createSpan({text:y,cls:"value"}),k.title=`\u70B9\u51FB\u5237\u65B0\u5E76\u590D\u5236 ${b} IP`,k.onclick=g=>{g.stopPropagation(),(async()=>{var h;new se.Notice("\u6B63\u5728\u5237\u65B0 IP...");try{let p=await this.plugin.updateIpAddress();u(p);let w=S==="single"?p.direct||p.proxy:S==="direct"?p.direct:p.proxy;w?(h=navigator.clipboard)!=null&&h.writeText?(await navigator.clipboard.writeText(w),new se.Notice(`${b} IP \u5DF2\u5237\u65B0\u5E76\u590D\u5236`)):new se.Notice(A("settings.clipboard-not-supported")):new se.Notice("\u65E0\u6CD5\u83B7\u53D6 IP")}catch(p){new se.Notice("\u5237\u65B0 IP \u5931\u8D25"),console.error(p)}})()}};f.direct===f.proxy||!f.proxy||!f.direct?m("IP","single"):(f.direct&&m("\u76F4\u8FDE","direct"),f.proxy&&m("\u4EE3\u7406","proxy"))},d={};try{d=JSON.parse(this.plugin.settings.ipAddress||"{}")}catch(f){console.debug("Failed to parse cached IP address:",f)}u(d),this.plugin.updateIpAddress().then(f=>{u(f)}).catch(f=>{console.debug("Failed to refresh IP address:",f)})}updateAccountOptions(){let e=this.accountDropdown;e.selectEl.empty(),this.plugin.settings.mpAccounts.length===0?e.addOption("",A("modals.publish-config.no-account")):(this.plugin.settings.mpAccounts.forEach(n=>{e.addOption(n.accountName,n.accountName)}),this.plugin.settings.selectedMPAccount&&e.setValue(this.plugin.settings.selectedMPAccount))}setPreviewTitle(e){var a,o;if(!this.previewTitleEl)return;let n=(o=(a=this.app.workspace.getActiveFile())==null?void 0:a.basename)!=null?o:A("views.previewer.article-title"),i=e&&e.trim()?e.trim():n;this.previewTitleEl.setText(i),this.previewTitleEl.setAttr("title",i)}async checkCoverImage(){return this.draftHeader.checkCoverImage()}async sendArticleToDraftBox(){let e=this.articleDiv.firstElementChild;if(e){let i=await this.getThemeManager();i&&await i.getInstance(this.plugin).applyTheme(e)}await cu(this.articleDiv,this.plugin.wechatClient),await uu(this.articleDiv,this.plugin.wechatClient),await du(this.articleDiv,this.plugin.wechatClient,this.app),await hu(this.articleDiv,this.plugin.wechatClient);let n=await this.wechatClient.sendArticleToDraftBox(this.draftHeader.getActiveLocalDraft(),this.getArticleContent());if(n){this.draftHeader.updateDraftDraftId(n);let i=await this.wechatClient.getDraftById(this.plugin.settings.selectedMPAccount,n);if(i){this.openUrl(i[0].url);let a={media_id:n,content:{news_item:i},update_time:Date.now()};this.plugin.messageService.sendMessage("draft-item-updated",a)}}}getArticleContent(){let e=this.articleDiv.firstElementChild,n=e==null?void 0:e.querySelector("p"),i=n&&window.getComputedStyle(n).color||e&&window.getComputedStyle(e).color||void 0,a=this.articleDiv.cloneNode(!0);return fu(a,i),Ke.getInstance().restoreCard(a.innerHTML)}onClose(){return this.stopListen(),this.messageUnsubscribes.forEach(e=>e()),this.messageUnsubscribes=[],Promise.resolve()}async parseActiveMarkdown(){var s;this.getArticleProperties();let e=Xe.getInstance(this.plugin).getCurrentMarkdownView()||this.markdownView;if(!e)return A("views.previewer.not-a-markdown-view");this.articleDiv.empty(),this.elementMap=new Map;let n=(s=e.file)!=null?s:this.app.workspace.getActiveFile();if(!n)return"<h1>No active file</h1>";if(n.extension!=="md")return"<h1>Not a markdown file</h1>";await xe.getInstance(this.plugin.app).render(n.path,this.renderPreviewer,this);let i=await Dt.getInstance(this.plugin,this).parseNote(n.path),a=createEl("section",{cls:"one2mp-article-content one2mp"}),o=(0,se.sanitizeHTMLToDom)(i);a.appendChild(o),this.articleDiv.empty(),this.articleDiv.appendChild(a);for(let[l,c]of this.elementMap.entries()){let u=this.articleDiv.querySelector("#"+l);if(u)if(typeof c=="string"){let d=Xe.getInstance(this.plugin).getFileOfLink(c);if(d){let f=this.plugin.app.vault.getFileByPath(d.path);if(f){let m=await Dt.getInstance(this.plugin,this).parseNote(f.path);u.empty(),u.appendChild((0,se.sanitizeHTMLToDom)(m))}}}else u.appendChild(c)}}async renderDraft(e=!1){if(e&&(this.allowRender=!0),!this.allowRender||!this.isViewActive()||(await this.parseActiveMarkdown(),this.articleDiv===null||this.articleDiv.firstChild===null))return;let n=this.articleDiv.firstChild,i=()=>{n.isConnected&&(async()=>{let o=await this.getThemeManager();o&&await o.getInstance(this.plugin).applyTheme(n)})()},a=window.requestIdleCallback;typeof a=="function"?a(i):setTimeout(i,0)}isViewActive(){return this.isActive&&!this.app.workspace.rightSplit.collapsed}startListen(){this.registerEvent(this.plugin.app.vault.on("rename",i=>{this.draftHeader.onNoteRename(i)})),this.registerEvent(this.app.workspace.on("layout-change",()=>{let i=this.app.workspace.getLeavesOfType(lo).length>0;this.isActive=i}));let e=this.app.workspace.on("editor-change",()=>{this.onEditorChange()});this.listeners.push(e);let n=this.app.workspace.on("active-leaf-change",i=>{i&&(i.view.getViewType()==="markdown"?(this.markdownView=i.view,this.lastLeaf=i,this.plugin.messageService.sendMessage("active-file-changed",null),this.debouncedUpdate()):this.isActive=i.view===this)});this.listeners.push(n)}stopListen(){this.listeners.forEach(e=>this.app.workspace.offref(e))}onEditorChange(){this.debouncedRender()}updateElementByID(e,n){let i=this.articleDiv.querySelector("#"+e);if(!i)return;let a=(0,se.sanitizeHTMLToDom)(n);i.empty(),i.appendChild(a)}addElementByID(e,n){typeof n=="string"?this.elementMap.set(e,n):this.elementMap.set(e,n.cloneNode(!0))}async loadComponents(){let e=this,n=async(i,a=new Set)=>{var s,l;if(a.has(i))return;a.add(i);let o=i;if((s=o._children)!=null&&s.length)for(let c of o._children)await n(c,a);try{if(((l=i==null?void 0:i.constructor)==null?void 0:l.name)==="SheetElement"){let u=i.onload();u&&typeof u.then=="function"&&await u}}catch(c){console.error("Error calling onload()",c)}};await n(e)}openUrl(e){if(!e)return;if(typeof window!="undefined"&&typeof window.open=="function"){window.open(e);return}let n=this.app;if(n.openWithDefaultApp){n.openWithDefaultApp(e);return}new se.Notice(A("views.previewer.open-url-not-supported"))}}});var Ty={};ht(Ty,{default:()=>ui});module.exports=Td(Ty);var je=require("obsidian");var di=require("obsidian");async function ho(){let r=async()=>{try{return(await(0,di.requestUrl)("https://api.ipify.org?format=json")).json.ip}catch(i){console.warn("Failed to fetch proxy IP",i);return}},t=async()=>{try{return(await(0,di.requestUrl)("https://myip.ipip.net/json")).json.data.ip}catch(i){console.warn("Failed to fetch direct IP",i);return}},[e,n]=await Promise.all([r(),t()]);return{proxy:e,direct:n}}fi();$e();var Do=require("obsidian");$e();var Yn=class extends Do.Modal{constructor(e,n,i){super(e);this.message=n;this.resolve=i}onOpen(){let{contentEl:e}=this;e.createEl("p",{text:this.message});let n=e.createDiv("modal-button-container");n.createEl("button",{text:A("modals.confirm")}).addEventListener("click",()=>{this.resolve(!0),this.close()}),n.createEl("button",{text:A("modals.cancel")}).addEventListener("click",()=>{this.resolve(!1),this.close()})}onClose(){let{contentEl:e}=this;e.empty()}};var X=require("obsidian");$e();var er=require("obsidian"),Xn=class extends er.AbstractInputSuggest{constructor(e,n){super(e,n);this.inputEl=n}getSuggestions(e){return this.app.vault.getAllLoadedFiles().filter(i=>i instanceof er.TFolder).filter(i=>i.path.toLowerCase().includes(e.toLowerCase()))}renderSuggestion(e,n){n.setText(e.path)}selectSuggestion(e){this.inputEl.value=e.path,this.inputEl.trigger("input"),this.close()}};bi();var ar=class extends X.PluginSettingTab{constructor(e,n){super(e,n);this.plugin=n}display(){let{containerEl:e}=this;e.empty(),e.addClass("one2mp-settings"),this.createAccountManagement(e),this.createGeneralSettings(e),this.creatCSSStyleSetting(e),this.createBackupRestore(e)}createAccountManagement(e){new X.Setting(e).setName(A("settings.wechat-account")).setHeading().addExtraButton(i=>{i.setIcon("plus").setTooltip(A("settings.create-new-account")).onClick(()=>{this.createNewAccount()})});let n=e.createDiv({cls:"one2mp-appid-guide"});n.createEl("span",{text:A("settings.appid-secret-guide")+" ",cls:"setting-item-description"}),n.createEl("a",{href:"https://developers.weixin.qq.com/console/",text:A("settings.appid-secret-guide-link")}).setAttr("target","_blank"),this.plugin.settings.mpAccounts.length===0?e.createDiv({cls:"one2mp-no-account"}).createEl("p",{text:A("settings.select-account")}):this.plugin.settings.mpAccounts.forEach((i,a)=>{this.renderAccountItem(e,i,a)})}renderAccountItem(e,n,i){let o=e.createDiv({cls:"one2mp-account-item"}).createEl("details");i===0&&(o.open=!0);let s=o.createEl("summary");s.setText(n.accountName||A("settings.new-account"));let l=o.createDiv({cls:"one2mp-account-details"});new X.Setting(l).setName(A("settings.account-name")).setDesc(A("settings.account-name-for-your-wechat-official")).setClass("one2mp-setting-wide").addText(u=>u.setValue(n.accountName).onChange(d=>{n.accountName=d,s.setText(d),this.plugin.settings.selectedMPAccount===this.plugin.settings.mpAccounts[i].accountName&&(this.plugin.settings.selectedMPAccount=d),this.plugin.saveSettings()})),new X.Setting(l).setName(A("settings.appid")).setDesc(A("settings.appid-for-your-wechat-official-account")).setClass("one2mp-setting-wide").addText(u=>u.setValue(n.appId).setPlaceholder("wx...").onChange(d=>{n.appId=d.trim(),this.plugin.saveSettings()})),new X.Setting(l).setName(A("settings.app-secret")).setDesc(A("settings.app-secret-for-your-wechat-official")).setClass("one2mp-setting-wide").addText(u=>u.setValue(n.appSecret).setPlaceholder("...").onChange(d=>{let f=d.replace(/\s+/g,"");f!==d&&u.setValue(f),n.appSecret=f,this.plugin.saveSettings()}));let c=new X.Setting(l).setName("");c.addButton(u=>{u.setTooltip(A("settings.click-to-connect-wechat-server")).setIcon("plug-zap").setButtonText(A("settings.test-connection")).onClick(()=>{(async()=>await this.plugin.TestAccessToken(n.accountName)?new X.Notice(A("settings.successfully-connected-to-wechat-server")):new X.Notice(A("settings.failed-to-connect-to-wechat-server")))()})}),c.addButton(u=>{u.setTooltip(A("settings.delete-account")).setIcon("trash-2").setButtonText(A("settings.delete-account")).setClass("mod-warning").onClick(()=>{var d;this.plugin.settings.mpAccounts.splice(i,1),this.plugin.settings.selectedMPAccount===n.accountName&&(this.plugin.settings.selectedMPAccount=(d=this.plugin.settings.mpAccounts[0])==null?void 0:d.accountName),this.plugin.saveSettings(),this.display()})})}createNewAccount(){let e=1,n=A("settings.new-account");for(;this.plugin.settings.mpAccounts.some(a=>a.accountName===n);)e++,n=`${A("settings.new-account")} ${e}`;let i={accountName:n,appId:"",appSecret:""};this.plugin.settings.mpAccounts.push(i),this.plugin.settings.selectedMPAccount||(this.plugin.settings.selectedMPAccount=n),this.plugin.saveSettings(),this.display()}createGeneralSettings(e){new X.Setting(e).setName(A("settings.general-settings")).setHeading();let n=new X.Setting(e).setName(A("settings.public-ip-address")).setDesc(A("settings.you-should-add-this-ip-to-ip-whitelist-o")),i=o=>{n.controlEl.empty(),n.controlEl.addClass("one2mp-ip-container");let s=(l,c)=>{if(!c)return;let u=n.controlEl.createDiv({cls:"one2mp-ip-row"});u.createSpan({cls:"one2mp-ip-label",text:l}),u.createSpan({cls:"one2mp-ip-value",text:c}),u.title=A("settings.copy-ip-to-clipboard"),u.onclick=()=>{var d;if(!((d=navigator.clipboard)!=null&&d.writeText)){new X.Notice(A("settings.clipboard-not-supported"));return}navigator.clipboard.writeText(c).then(()=>{new X.Notice(A("settings.ip-copied-to-clipboard"))}).catch(f=>{console.warn("\u590D\u5236 IP \u5931\u8D25",f)})}};if(!o.direct&&!o.proxy){n.controlEl.createSpan({text:A("settings.no-ip-address"),cls:"text-muted"});return}o.direct===o.proxy||!o.proxy||!o.direct?s("\u516C\u7F51 IP",o.direct||o.proxy):(s("\u76F4\u8FDE",o.direct),s("\u4EE3\u7406",o.proxy))};(()=>{let o={};try{o=JSON.parse(this.plugin.settings.ipAddress||"{}")}catch(s){o={direct:this.plugin.settings.ipAddress}}i(o)})(),this.plugin.updateIpAddress().then(o=>{i(o)}).catch(()=>{}),new X.Setting(e).setName(A("settings.real-time-render")).setDesc(A("settings.enable-real-time-rendering")).addToggle(o=>{o.setValue(this.plugin.settings.realTimeRender).onChange(s=>{this.plugin.settings.realTimeRender=s,this.plugin.saveSettings()})})}creatCSSStyleSetting(e){new X.Setting(e).setName(A("settings.custom-themes")).setHeading(),new X.Setting(e).setName(A("settings.custom-themes-folder")).setDesc(A("settings.the-folder-where-your-custom-themes")).addSearch(n=>{new Xn(this.app,n.inputEl),n.setPlaceholder(A("settings.themes-folder-path")).setValue(this.plugin.settings.css_styles_folder).onChange(i=>{this.plugin.settings.css_styles_folder=i,this.plugin.saveThemeFolderDebounce()})}).addExtraButton(n=>{n.setIcon("download").setTooltip(A("views.theme-manager.download-predefined-custom-themes")).onClick(()=>{(async()=>{let{ThemeManager:i}=await Promise.resolve().then(()=>(pn(),ir));new X.Notice(A("views.theme-manager.download-started")),i.getInstance(this.plugin).downloadThemes()})()})}),new X.Setting(e).setName(A("settings.theme-download-overwrite")).setDesc(A("settings.theme-download-overwrite-desc")).addToggle(n=>{n.setValue(this.plugin.settings.themeDownloadOverwrite).onChange(i=>{this.plugin.settings.themeDownloadOverwrite=i,this.plugin.saveSettings()})})}createBackupRestore(e){new X.Setting(e).setName(A("settings.import-export-one2mp-account")).setHeading().setDesc(A("settings.import-or-export-your-account-info-for-b")).addExtraButton(n=>{n.setIcon("upload").setTooltip(A("settings.import-account-info")).onClick(()=>{this.importSettings()})}).addExtraButton(n=>{n.setIcon("download").setTooltip(A("settings.export-account-info")).onClick(()=>{this.exportSettings()})})}async exportSettings(){try{let e=JSON.stringify(this.plugin.settings,null,2);if(!window.showSaveFilePicker||X.Platform.isMobile){let o=new Date().toISOString().slice(0,10),s="one2mp-settings",l=`one2mp-settings-${o}.json`,c=`${s}/${l}`;return this.app.vault.getAbstractFileByPath(s)||await this.app.vault.createFolder(s),await this.app.vault.adapter.write(c,e),new X.Notice(A("settings.settings-exported-to-vault",[c])),!0}let n=new Blob([e],{type:"application/json"}),a=await(await window.showSaveFilePicker({suggestedName:`one2mp-settings-${new Date().toISOString().slice(0,10)}.json`,types:[{description:"JSON Files",accept:{"application/json":[".json"]}}]})).createWritable();return await a.write(n),await a.close(),new X.Notice(A("settings.settings-exported")),!0}catch(e){if(e instanceof Error&&e.name==="AbortError")return!1;let n=e instanceof Error?e.message:String(e);return new X.Notice(`${A("settings.settings-exporting-failed")}${n}`),console.error(e),!1}}async importSettingsFromVault(){let e=new X.Modal(this.app);e.contentEl.createEl("h3",{text:A("settings.import-settings-title")}),e.contentEl.createEl("p",{text:A("settings.import-settings-hint")});let n=new X.TextComponent(e.contentEl);n.setPlaceholder(A("settings.import-settings-placeholder")),new qt(this.app,n.inputEl,["json"]);let i=e.contentEl.createDiv({cls:"modal-button-container"}),a=new X.ButtonComponent(i);a.setButtonText(A("settings.cancel")),a.onClick(()=>e.close());let o=new X.ButtonComponent(i);o.setButtonText(A("settings.import-settings-confirm")),o.setCta(),o.onClick(async()=>{let s=n.getValue().trim();if(!s){new X.Notice(A("settings.import-settings-empty-path"));return}let l=this.app.vault.getAbstractFileByPath(s);if(!(l instanceof X.TFile)){new X.Notice(A("settings.import-settings-file-not-found"));return}try{let c=await this.app.vault.read(l);this.applyImportedSettings(c),e.close()}catch(c){let u=c instanceof Error?c.message:String(c);new X.Notice(`${A("settings.settings-imported-failed")}${u}`),console.error(c)}}),e.open()}applyImportedSettings(e){let n;try{n=JSON.parse(e)}catch(o){new X.Notice(A("settings.invalid-json-file"));return}let{mpAccounts:i,css_styles_folder:a}=n;if(i===void 0||a===void 0){new X.Notice(A("settings.invalid-wewerite-settings-file"));return}this.plugin.settings=n,this.plugin.saveSettings(),this.display(),new X.Notice(A("settings.settings-imported-successfully"))}importSettings(){try{if(X.Platform.isMobile){this.importSettingsFromVault();return}let e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=n=>{(()=>{var s;let a=(s=n.target.files)==null?void 0:s[0];if(!a)return;let o=new FileReader;o.onload=l=>{(async()=>{var c;try{let u=(c=l.target)==null?void 0:c.result;this.applyImportedSettings(u)}catch(u){let d=u instanceof Error?u.message:String(u);new X.Notice(`${A("settings.settings-imported-failed")}${d}`),console.error(u)}})()},o.readAsText(a)})()},e.click()}catch(e){let n=e instanceof Error?e.message:String(e);new X.Notice(`${A("settings.settings-imported-error")}${n}`),console.error(e)}}};Ut();var kr=null,mc=async()=>{if(kr)return kr;try{let{default:r}=await Promise.resolve().then(()=>(ka(),_a));return kr=new r("one2mp-settings"),kr}catch(r){return console.warn("PouchDB \u521D\u59CB\u5316\u5931\u8D25\uFF0C\u8DF3\u8FC7\u65E7\u914D\u7F6E\u8FC1\u79FB",r),null}},vc=async()=>{await mc()},yc=1,bg=async()=>{let r=await mc();if(r)return new Promise(t=>{r.get("one2mp-settings").then(e=>{t(e)}).catch(e=>{console.warn("Error getting One2MpSetting:",e),t(void 0)})})},wc=async r=>{var t;try{let e=await r.loadData();if(e!=null&&e.settings)return e.custom_theme_folder&&!e.settings.css_styles_folder&&(e.settings.css_styles_folder=e.custom_theme_folder),e.settings;let n=await bg();if(n){let i={...e,settings:n,custom_theme_folder:(t=n.css_styles_folder)!=null?t:e==null?void 0:e.custom_theme_folder,settings_version:yc};await r.saveData(i)}return n}catch(e){console.error("Error loading One2MpSetting:",e);return}},bc=async(r,t)=>{var e;try{let n=await r.loadData(),i=n==null?void 0:n.settings;if(i&&zt(t,i))return;let a={...n,settings:t,custom_theme_folder:(e=t.css_styles_folder)!=null?e:n==null?void 0:n.custom_theme_folder,settings_version:yc};await r.saveData(a)}catch(n){console.error("Error setting One2MpSetting:",n)}};Dn();var Br=class{constructor(){this.listeners=new Map}registerListener(t,e){let n=this.listeners.get(t);return n==null||n===null?this.listeners.set(t,[e]):n.push(e),()=>this.unregisterListener(t,e)}unregisterListener(t,e){let n=this.listeners.get(t);if(!n)return;let i=n.filter(a=>a!==e);if(i.length===0){this.listeners.delete(t);return}this.listeners.set(t,i)}sendMessage(t,e){let n=this.listeners.get(t);n==null||n===null||n.forEach(i=>i(e))}};Mn();var qr=class{constructor(t){this.spinnerEl=t,this.spinnerEl.addClass("spinner-container");let e=this.spinnerEl.createDiv({cls:"spinner-dots"});for(let n=0;n<6;n++)e.createDiv({cls:`spinner-dot spinner-dot${n+1}`}).setCssProps({"animation-delay":`${n*.3}s`});this.spinnerText=this.spinnerEl.createDiv({cls:"spinner-text"})}showSpinner(t=""){this.spinnerEl.setCssProps({display:"flex"}),this.spinnerText.setText(t)}isSpinning(){return getComputedStyle(this.spinnerEl).display!=="none"}hideSpinner(){this.spinnerEl.setCssProps({display:"none"})}unload(){this.spinnerEl.remove()}};var jr=require("obsidian");$e();var Nr=class extends jr.Modal{constructor(e,n,i=""){super(e);this.initialContent=i;this.inputEl=null;this.onSubmit=n}onOpen(){let{contentEl:e}=this;e.empty(),e.createEl("h3",{text:A("modals.mpcard.title")}),e.createEl("p",{text:A("modals.mpcard.hint")}),this.inputEl=e.createEl("textarea",{cls:"one2mp-mpcard-input"}),this.inputEl.placeholder=A("modals.mpcard.placeholder"),this.initialContent&&(this.inputEl.value=this.initialContent),this.inputEl.focus();let n=e.createDiv("modal-button-container");n.createEl("button",{text:A("modals.mpcard.insert")}).addEventListener("click",()=>{var o,s;let i=(s=(o=this.inputEl)==null?void 0:o.value)!=null?s:"",a=this.normalizeMpcard(i);if(!a){new jr.Notice(A("modals.mpcard.empty"));return}this.onSubmit(a),this.close()}),n.createEl("button",{text:A("modals.cancel")}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:e}=this;e.empty(),this.inputEl=null}normalizeMpcard(e){let n=e.trim();if(!n)return"";if(n.startsWith("```")){let i=n.split(/\r?\n/);return/```\\s*mpcard/i.test(i[0])||(i[0]="```mpcard"),i.slice(1).some(o=>o.trim()==="```")||i.push("```"),`
${i.join(`
`)}
`}return`
\`\`\`mpcard
${n}
\`\`\`
`}};var cn="one2mp-article-preview",Cy={mpAccounts:[],ipAddress:"",css_styles_folder:"one2mp-css-styles",codeLineNumber:!0,accountDataPath:"one2mp-accounts",useCenterToken:!1,realTimeRender:!0,defaultMpcard:"",defaultMpcardId:"",defaultMpcardHeadimg:"",defaultMpcardNickname:"",defaultMpcardSignature:"",themeDownloadOverwrite:!1},bd="one2mp-logo",Ey=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="100" height="100">
	<path d="M 15.560304092607304 33.94050605385342C 29.693661897802365 -1.1141138324752404 70.30633810219763 -1.1141138324752404 84.43969590739269 33.940506053853426C 51.84603073656342 45.353262378865885 48.15396926343658 45.353262378865885 15.560304092607304 33.94050605385342Z" fill="#84D473" />
	<path d="M 81.12777768298169 28.204095418660252C 104.41929012195195 57.97125226189857 84.1129520197543 93.14286157057666 46.688081775588984 87.85539852748633C 53.1011774563413 53.92207832459788 54.947208192904725 50.72465929653623 81.12777768298169 28.204095418660252Z" fill="#3AB54A" />
	<path d="M 53.31191822441101 87.85539852748633C 15.887047980245676 93.14286157057666 -4.419290121951946 57.971252261898584 18.872222317018313 28.204095418660245Q 45.052791807095275 50.72465929653624 28.163984663890915 52.681125554913244L 38.40889008453118 53.10582854123025L 29.748893224046313 58.59608482676403Q 46.898822543658696 53.92207832459788 53.31191822441101 87.85539852748633Z" fill="#27753D" />
</svg>`,ui=class extends je.Plugin{constructor(){super(...arguments);this.editorChangeListener=null;this.resourceManager=Xe.getInstance(this);this.active=!1;this.previewPanelCtor=null;this.saveSettings=(0,je.debounce)(async()=>{delete this.settings._id,delete this.settings._rev,this.trimSettings(),await bc(this,this.settings),await this.saveThemeFolder()},3e3);this.saveThemeFolderDebounce=(0,je.debounce)(async()=>{await this.saveThemeFolder()},3e3)}async saveThemeFolder(){this.trimSettings();let e={...this.settings};delete e._id,delete e._rev;let n={custom_theme_folder:this.settings.css_styles_folder},i=await this.loadData();await this.saveData({...i!=null?i:{},...n,settings:e}),this.messageService.sendMessage("custom-theme-folder-changed",null)}async loadThemeFolder(){let e=await this.loadData();e&&e.custom_theme_folder&&(this.settings.css_styles_folder=e.custom_theme_folder)}trimSettings(){var e,n,i,a;this.settings.mpAccounts.forEach(o=>{o.accountName=o.accountName.trim(),o.appId=o.appId.trim(),o.appSecret=o.appSecret.trim()}),this.settings.ipAddress=(e=this.settings.ipAddress)==null?void 0:e.trim(),this.settings.selectedMPAccount=(n=this.settings.selectedMPAccount)==null?void 0:n.trim(),this.settings.accountDataPath=(i=this.settings.accountDataPath)==null?void 0:i.trim(),this.settings.css_styles_folder=(a=this.settings.css_styles_folder)==null?void 0:a.trim()}async writeStartupLog(e,n){let i="o2any-startup.log",a=new Date().toISOString(),o=n?` ${this.formatStartupError(n)}`:"",s=`[${a}] ${e}${o}
`;try{let l=this.app.vault.adapter;await l.exists(i)?await l.append(i,s):await l.write(i,s)}catch(l){console.error("O2Any \u542F\u52A8\u65E5\u5FD7\u5199\u5165\u5931\u8D25",l)}}formatStartupError(e){return e instanceof Error?`${e.name}: ${e.message}${e.stack?`
${e.stack}`:""}`:String(e)}createSpinner(){this.spinner=new qr(this.addStatusBarItem())}showSpinner(e=""){this.spinner.showSpinner(e)}isSpinning(){return this.spinner.isSpinning()}hideSpinner(){this.spinner.hideSpinner()}async loadSettings(){this.settings=Object.assign({},Cy,await wc(this)),await this.loadThemeFolder()}async updateIpAddress(){try{let e=await ho();return this.settings.ipAddress=JSON.stringify(e),this.saveSettings(),e}catch(e){return console.error("Error fetching public IP address:",e),{}}}async activateView(){let{workspace:e}=this.app,n=e.getLeavesOfType(cn).find(i=>i.view.getViewType()===cn);n==null&&(n=e.getRightLeaf(!1),await(n==null?void 0:n.setViewState({type:cn,active:!0}))),n&&e.revealLeaf(n)}getAccessToken(e){let n=this.getMPAccountByName(e);return n===void 0?(new je.Notice(A("main.no-wechat-mp-account-selected")),!1):n.access_token}async TestAccessToken(e){if(this.settings.useCenterToken)return this.wechatClient.requestToken();{let n=this.getMPAccountByName(e);if(n===void 0)return new je.Notice(A("main.no-wechat-mp-account-selected")),!1;let i=await this.wechatClient.getAccessToken(n.appId,n.appSecret);if(i)return this.setAccessToken(e,i.access_token,i.expires_in),i.access_token}return!1}async refreshAccessToken(e){if(this.settings.useCenterToken)return this.wechatClient.requestToken();if(e===void 0)return!1;let n=this.getMPAccountByName(e);if(n===void 0)return new je.Notice(A("main.no-wechat-mp-account-selected")),!1;let{appId:i,appSecret:a}=n;if(i===void 0||a===void 0||!i||!a)return new je.Notice(A("main.please-check-you-appid-and-appsecret")),!1;let{access_token:o,expires_in:s,lastRefreshTime:l}=n;if(o===void 0||o===""){let c=await this.wechatClient.getAccessToken(i,a);if(c)return this.setAccessToken(e,c.access_token,c.expires_in),c.access_token}else if(l+s*1e3<new Date().getTime()){let c=await this.wechatClient.getAccessToken(i,a);if(c)return this.setAccessToken(e,c.access_token,c.expires_in),c.access_token}else return o;return!1}getMPAccountByName(e){return this.settings.mpAccounts.find(n=>n.accountName===e)}getSelectedMPAccount(){return this.getMPAccountByName(this.settings.selectedMPAccount)}setAccessToken(e,n,i){let a=this.getMPAccountByName(e);a!==void 0&&(a.access_token=n,a.lastRefreshTime=new Date().getTime(),a.expires_in=i,this.saveSettings())}confirm(e){return new Promise(n=>{new Yn(this.app,e,n).open()})}initDB(){vc(),qa()}async onload(){await this.writeStartupLog("onload:start");try{this.initDB(),this.messageService=new Br,await this.loadSettings(),this.wechatClient=Ve.getInstance(this),(0,je.addIcon)(bd,Ey);let e=await Promise.resolve().then(()=>(wd(),yd));this.previewPanelCtor=e.PreviewPanel,this.registerViews(),this.addCommand({id:"open-previewer",name:A("main.open-previewer"),callback:()=>{this.activateView()}}),this.addRibbonIcon(bd,A("main.open-previewer"),()=>{this.activateView()}),this.addSettingTab(new ar(this.app,this)),this.createSpinner(),this.messageService.registerListener("show-spinner",n=>{this.showSpinner(n)}),this.messageService.registerListener("hide-spinner",()=>{this.hideSpinner()}),this.registerEvent(this.app.workspace.on("editor-menu",(n,i)=>{n.addItem(a=>{a.setTitle(A("main.insert-mpcard")),a.onClick(()=>{let o=this.settings.defaultMpcard||this.buildDefaultMpcard();new Nr(this.app,l=>{i.replaceSelection(l)},o).open()})})}))}catch(e){throw await this.writeStartupLog("onload:error",e),e}await this.writeStartupLog("onload:ready")}buildDefaultMpcard(){var s,l,c,u;let e=[],n=(s=this.settings.defaultMpcardId)==null?void 0:s.trim(),i=(l=this.settings.defaultMpcardHeadimg)==null?void 0:l.trim(),a=(c=this.settings.defaultMpcardNickname)==null?void 0:c.trim(),o=(u=this.settings.defaultMpcardSignature)==null?void 0:u.trim();return n&&e.push(`id: ${n}`),i&&e.push(`headimg: ${i}`),a&&e.push(`nickname: ${a}`),o&&e.push(`signature: ${o}`),e.length===0?"":["```mpcard",...e,"```"].join(`
`)}registerViewOnce(e){if(this.app.workspace.getLeavesOfType(e).length===0&&e===cn){if(!this.previewPanelCtor){new je.Notice("\u9884\u89C8\u5668\u672A\u52A0\u8F7D\uFF0C\u65E0\u6CD5\u6CE8\u518C\u89C6\u56FE");return}this.registerView(e,n=>new this.previewPanelCtor(n,this))}}registerViews(){this.registerViewOnce(cn)}onunload(){this.editorChangeListener&&this.app.workspace.offref(this.editorChangeListener),this.spinner.unload(),this.app.workspace.getLeavesOfType(cn).forEach(e=>e.detach()),Ve.resetInstance(),(async()=>{let{ThemeManager:e}=await Promise.resolve().then(()=>(pn(),ir));e.resetInstance()})(),(async()=>{let{LocalDraftManager:e}=await Promise.resolve().then(()=>(Dn(),su));e.resetInstance();let{WechatRender:n}=await Promise.resolve().then(()=>(ro(),cd));n.resetInstance()})()}};
//![[]]
