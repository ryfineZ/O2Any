/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var jo=Object.create;var wt=Object.defineProperty;var Vo=Object.getOwnPropertyDescriptor;var Uo=Object.getOwnPropertyNames;var Wo=Object.getPrototypeOf,qo=Object.prototype.hasOwnProperty;var Go=(d,t,e)=>t in d?wt(d,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):d[t]=e;var y=(d,t)=>()=>(d&&(t=d(d=0)),t);var Ko=(d,t)=>()=>(t||d((t={exports:{}}).exports,t),t.exports),at=(d,t)=>{for(var e in t)wt(d,e,{get:t[e],enumerable:!0})},Si=(d,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Uo(t))!qo.call(d,i)&&i!==e&&wt(d,i,{get:()=>t[i],enumerable:!(n=Vo(t,i))||n.enumerable});return d};var Jo=(d,t,e)=>(e=d!=null?jo(Wo(d)):{},Si(t||!d||!d.__esModule?wt(e,"default",{value:d,enumerable:!0}):e,d)),Zo=d=>Si(wt({},"__esModule",{value:!0}),d);var Z=(d,t,e)=>(Go(d,typeof t!="symbol"?t+"":t,e),e);var Pi,Fe,_n=y(()=>{Pi=require("obsidian"),Fe=class{constructor(t){this.plugin=t,this.init()}static getInstance(t){return this.instance||(this.instance=new Fe(t)),this.instance}init(){}getCurrentMarkdownView(){var n;let t=this.plugin.app.workspace.getActiveFile(),e=this.plugin.app.workspace.getLeavesOfType("markdown");for(let i of e){let r=i.view;if(((n=r.file)==null?void 0:n.path)===(t==null?void 0:t.path))return r}return null}forceRenderActiveMarkdownView(){let t=this.getCurrentMarkdownView();t&&this.plugin.app.workspace.trigger("render",t)}queryElements(t){let e=this.getCurrentMarkdownView();if(!e)return[];let n=e.getMode()==="preview"?".markdown-preview-view":".markdown-source-view",i=e.containerEl.querySelector(n);return i?i.querySelectorAll(t):[]}getMarkdownViewContainer(){let t=this.getCurrentMarkdownView();return t?t.containerEl:null}getMarkdownRenderedElement(t,e){let n=this.queryElements(e);if(n.length<=t)return null;let i=n[t];return i||null}getFileOfLink(t){return this.plugin.app.metadataCache.getFirstLinkpathDest(t,"")}async getLinkFileContent(t){let e=this.getFileOfLink(t);return e?await this.plugin.app.vault.adapter.read(e.path):null}async saveImageFromUrl(t){var p;let e=this.plugin.app.workspace.getActiveFile();if(!e)return null;let n=e.basename,i=((p=e.parent)==null?void 0:p.path)||"",r=t.split("/"),o=r[r.length-1].split("?")[0].split(".").pop(),s=new Date().toISOString().replace(/[:.]/g,"-").replace("T","_"),l=`${n}_generated_${s}.${o||"jpg"}`,c=i==="/"?`/${l}`:`${i}/${l}`;try{let h=await(0,Pi.requestUrl)({url:t});if(h.status!==200)throw new Error("Failed to fetch image");let g=h.arrayBuffer;return await this.plugin.app.vault.adapter.writeBinary(c,g),c}catch(h){return console.error("Error saving image:",h),null}}}});var R,xt,Ti,Yo,Xo,Ei,Mi,yt,Ai,Qo,Bt,es,Oi,ot,ts,ns,Nn,is,rs,as,zn,jt,os,lt,Oe,ct,Vt,_i,Li,dt,Ut,$i,Ii,Bn,Di,Hn,jn,ss,st,Vn,ls,Un,Ri,Fi,zt,cs,qe,ce,Pc,Tc,Ec,Mc,Ac,Lc,$c,Ic,Dc,Rc,Fc,Oc,_c,Hc,Hi=y(()=>{R=d=>typeof d=="string",xt=()=>{let d,t,e=new Promise((n,i)=>{d=n,t=i});return e.resolve=d,e.reject=t,e},Ti=d=>d==null?"":""+d,Yo=(d,t,e)=>{d.forEach(n=>{t[n]&&(e[n]=t[n])})},Xo=/###/g,Ei=d=>d&&d.indexOf("###")>-1?d.replace(Xo,"."):d,Mi=d=>!d||R(d),yt=(d,t,e)=>{let n=R(t)?t.split("."):t,i=0;for(;i<n.length-1;){if(Mi(d))return{};let r=Ei(n[i]);!d[r]&&e&&(d[r]=new e),Object.prototype.hasOwnProperty.call(d,r)?d=d[r]:d={},++i}return Mi(d)?{}:{obj:d,k:Ei(n[i])}},Ai=(d,t,e)=>{let{obj:n,k:i}=yt(d,t,Object);if(n!==void 0||t.length===1){n[i]=e;return}let r=t[t.length-1],a=t.slice(0,t.length-1),o=yt(d,a,Object);for(;o.obj===void 0&&a.length;)r=`${a[a.length-1]}.${r}`,a=a.slice(0,a.length-1),o=yt(d,a,Object),o!=null&&o.obj&&typeof o.obj[`${o.k}.${r}`]!="undefined"&&(o.obj=void 0);o.obj[`${o.k}.${r}`]=e},Qo=(d,t,e,n)=>{let{obj:i,k:r}=yt(d,t,Object);i[r]=i[r]||[],i[r].push(e)},Bt=(d,t)=>{let{obj:e,k:n}=yt(d,t);if(e&&Object.prototype.hasOwnProperty.call(e,n))return e[n]},es=(d,t,e)=>{let n=Bt(d,e);return n!==void 0?n:Bt(t,e)},Oi=(d,t,e)=>{for(let n in t)n!=="__proto__"&&n!=="constructor"&&(n in d?R(d[n])||d[n]instanceof String||R(t[n])||t[n]instanceof String?e&&(d[n]=t[n]):Oi(d[n],t[n],e):d[n]=t[n]);return d},ot=d=>d.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),ts={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},ns=d=>R(d)?d.replace(/[&<>"'\/]/g,t=>ts[t]):d,Nn=class{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){let e=this.regExpMap.get(t);if(e!==void 0)return e;let n=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,n),this.regExpQueue.push(t),n}},is=[" ",",","?","!",";"],rs=new Nn(20),as=(d,t,e)=>{t=t||"",e=e||"";let n=is.filter(a=>t.indexOf(a)<0&&e.indexOf(a)<0);if(n.length===0)return!0;let i=rs.getRegExp(`(${n.map(a=>a==="?"?"\\?":a).join("|")})`),r=!i.test(d);if(!r){let a=d.indexOf(e);a>0&&!i.test(d.substring(0,a))&&(r=!0)}return r},zn=function(d,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!d)return;if(d[t])return Object.prototype.hasOwnProperty.call(d,t)?d[t]:void 0;let n=t.split(e),i=d;for(let r=0;r<n.length;){if(!i||typeof i!="object")return;let a,o="";for(let s=r;s<n.length;++s)if(s!==r&&(o+=e),o+=n[s],a=i[o],a!==void 0){if(["string","number","boolean"].indexOf(typeof a)>-1&&s<n.length-1)continue;r+=s-r+1;break}i=a}return i},jt=d=>d==null?void 0:d.replace("_","-"),os={type:"logger",log(d){this.output("log",d)},warn(d){this.output("warn",d)},error(d){this.output("error",d)},output(d,t){var e,n;(n=(e=console==null?void 0:console[d])==null?void 0:e.apply)==null||n.call(e,console,t)}},lt=class{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(t,e)}init(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||os,this.options=e,this.debug=e.debug}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"log","",!0)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","",!0)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"error","")}deprecate(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(t,e,n,i){return i&&!this.debug?null:(R(t[0])&&(t[0]=`${n}${this.prefix} ${t[0]}`),this.logger[e](t))}create(t){return new lt(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new lt(this.logger,t)}},Oe=new lt,ct=class{constructor(){this.observers={}}on(t,e){return t.split(" ").forEach(n=>{this.observers[n]||(this.observers[n]=new Map);let i=this.observers[n].get(e)||0;this.observers[n].set(e,i+1)}),this}off(t,e){if(this.observers[t]){if(!e){delete this.observers[t];return}this.observers[t].delete(e)}}emit(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.observers[t]&&Array.from(this.observers[t].entries()).forEach(a=>{let[o,s]=a;for(let l=0;l<s;l++)o(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(a=>{let[o,s]=a;for(let l=0;l<s;l++)o.apply(o,[t,...n])})}},Vt=class extends ct{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=e,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){let e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}getResource(t,e,n){var l,c;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},r=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,a=i.ignoreJSONStructure!==void 0?i.ignoreJSONStructure:this.options.ignoreJSONStructure,o;t.indexOf(".")>-1?o=t.split("."):(o=[t,e],n&&(Array.isArray(n)?o.push(...n):R(n)&&r?o.push(...n.split(r)):o.push(n)));let s=Bt(this.data,o);return!s&&!e&&!n&&t.indexOf(".")>-1&&(t=o[0],e=o[1],n=o.slice(2).join(".")),s||!a||!R(n)?s:zn((c=(l=this.data)==null?void 0:l[t])==null?void 0:c[e],n,r)}addResource(t,e,n,i){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1},a=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,o=[t,e];n&&(o=o.concat(a?n.split(a):n)),t.indexOf(".")>-1&&(o=t.split("."),i=e,e=o[1]),this.addNamespaces(e),Ai(this.data,o,i),r.silent||this.emit("added",t,e,n,i)}addResources(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(let r in n)(R(n[r])||Array.isArray(n[r]))&&this.addResource(t,e,r,n[r],{silent:!0});i.silent||this.emit("added",t,e,n)}addResourceBundle(t,e,n,i,r){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},o=[t,e];t.indexOf(".")>-1&&(o=t.split("."),i=n,n=e,e=o[1]),this.addNamespaces(e);let s=Bt(this.data,o)||{};a.skipCopy||(n=JSON.parse(JSON.stringify(n))),i?Oi(s,n,r):s={...s,...n},Ai(this.data,o,s),a.silent||this.emit("added",t,e,n)}removeResourceBundle(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}hasResourceBundle(t,e){return this.getResource(t,e)!==void 0}getResourceBundle(t,e){return e||(e=this.options.defaultNS),this.getResource(t,e)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){let e=this.getDataByLanguage(t);return!!(e&&Object.keys(e)||[]).find(i=>e[i]&&Object.keys(e[i]).length>0)}toJSON(){return this.data}},_i={processors:{},addPostProcessor(d){this.processors[d.name]=d},handle(d,t,e,n,i){return d.forEach(r=>{var a,o;t=(o=(a=this.processors[r])==null?void 0:a.process(t,e,n,i))!=null?o:t}),t}},Li={},dt=class extends ct{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Yo(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=e,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Oe.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(t==null)return!1;let n=this.resolve(t,e);return(n==null?void 0:n.res)!==void 0}extractFromKey(t,e){let n=e.nsSeparator!==void 0?e.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");let i=e.keySeparator!==void 0?e.keySeparator:this.options.keySeparator,r=e.ns||this.options.defaultNS||[],a=n&&t.indexOf(n)>-1,o=!this.options.userDefinedKeySeparator&&!e.keySeparator&&!this.options.userDefinedNsSeparator&&!e.nsSeparator&&!as(t,n,i);if(a&&!o){let s=t.match(this.interpolator.nestingRegexp);if(s&&s.length>0)return{key:t,namespaces:R(r)?[r]:r};let l=t.split(n);(n!==i||n===i&&this.options.ns.indexOf(l[0])>-1)&&(r=l.shift()),t=l.join(i)}return{key:t,namespaces:R(r)?[r]:r}}translate(t,e,n){if(typeof e!="object"&&this.options.overloadTranslationOptionHandler&&(e=this.options.overloadTranslationOptionHandler(arguments)),typeof e=="object"&&(e={...e}),e||(e={}),t==null)return"";Array.isArray(t)||(t=[String(t)]);let i=e.returnDetails!==void 0?e.returnDetails:this.options.returnDetails,r=e.keySeparator!==void 0?e.keySeparator:this.options.keySeparator,{key:a,namespaces:o}=this.extractFromKey(t[t.length-1],e),s=o[o.length-1],l=e.lng||this.language,c=e.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((l==null?void 0:l.toLowerCase())==="cimode"){if(c){let P=e.nsSeparator||this.options.nsSeparator;return i?{res:`${s}${P}${a}`,usedKey:a,exactUsedKey:a,usedLng:l,usedNS:s,usedParams:this.getUsedParamsDetails(e)}:`${s}${P}${a}`}return i?{res:a,usedKey:a,exactUsedKey:a,usedLng:l,usedNS:s,usedParams:this.getUsedParamsDetails(e)}:a}let p=this.resolve(t,e),h=p==null?void 0:p.res,g=(p==null?void 0:p.usedKey)||a,m=(p==null?void 0:p.exactUsedKey)||a,f=Object.prototype.toString.apply(h),v=["[object Number]","[object Function]","[object RegExp]"],A=e.joinArrays!==void 0?e.joinArrays:this.options.joinArrays,k=!this.i18nFormat||this.i18nFormat.handleAsObject,C=!R(h)&&typeof h!="boolean"&&typeof h!="number";if(k&&h&&C&&v.indexOf(f)<0&&!(R(A)&&Array.isArray(h))){if(!e.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");let P=this.options.returnedObjectHandler?this.options.returnedObjectHandler(g,h,{...e,ns:o}):`key '${a} (${this.language})' returned an object instead of string.`;return i?(p.res=P,p.usedParams=this.getUsedParamsDetails(e),p):P}if(r){let P=Array.isArray(h),K=P?[]:{},le=P?m:g;for(let U in h)if(Object.prototype.hasOwnProperty.call(h,U)){let ne=`${le}${r}${U}`;K[U]=this.translate(ne,{...e,joinArrays:!1,ns:o}),K[U]===ne&&(K[U]=h[U])}h=K}}else if(k&&R(A)&&Array.isArray(h))h=h.join(A),h&&(h=this.extendTranslation(h,t,e,n));else{let P=!1,K=!1,le=e.count!==void 0&&!R(e.count),U=dt.hasDefaultValue(e),ne=le?this.pluralResolver.getSuffix(l,e.count,e):"",Ve=e.ordinal&&le?this.pluralResolver.getSuffix(l,e.count,{ordinal:!1}):"",Ne=le&&!e.ordinal&&e.count===0,Ie=Ne&&e[`defaultValue${this.options.pluralSeparator}zero`]||e[`defaultValue${ne}`]||e[`defaultValue${Ve}`]||e.defaultValue;!this.isValidLookup(h)&&U&&(P=!0,h=Ie),this.isValidLookup(h)||(K=!0,h=a);let In=(e.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&K?void 0:h,De=U&&Ie!==h&&this.options.updateMissing;if(K||P||De){if(this.logger.log(De?"updateKey":"missingKey",l,s,a,De?Ie:h),r){let me=this.resolve(a,{...e,keySeparator:!1});me&&me.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let Re=[],tt=this.languageUtils.getFallbackCodes(this.options.fallbackLng,e.lng||this.language);if(this.options.saveMissingTo==="fallback"&&tt&&tt[0])for(let me=0;me<tt.length;me++)Re.push(tt[me]);else this.options.saveMissingTo==="all"?Re=this.languageUtils.toResolveHierarchy(e.lng||this.language):Re.push(e.lng||this.language);let Ht=(me,ze,x)=>{var E;let w=U&&x!==h?x:In;this.options.missingKeyHandler?this.options.missingKeyHandler(me,s,ze,w,De,e):(E=this.backendConnector)!=null&&E.saveMissing&&this.backendConnector.saveMissing(me,s,ze,w,De,e),this.emit("missingKey",me,s,ze,h)};this.options.saveMissing&&(this.options.saveMissingPlurals&&le?Re.forEach(me=>{let ze=this.pluralResolver.getSuffixes(me,e);Ne&&e[`defaultValue${this.options.pluralSeparator}zero`]&&ze.indexOf(`${this.options.pluralSeparator}zero`)<0&&ze.push(`${this.options.pluralSeparator}zero`),ze.forEach(x=>{Ht([me],a+x,e[`defaultValue${x}`]||Ie)})}):Ht(Re,a,Ie))}h=this.extendTranslation(h,t,e,p,n),K&&h===a&&this.options.appendNamespaceToMissingKey&&(h=`${s}:${a}`),(K||P)&&this.options.parseMissingKeyHandler&&(h=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${s}:${a}`:a,P?h:void 0))}return i?(p.res=h,p.usedParams=this.getUsedParamsDetails(e),p):h}extendTranslation(t,e,n,i,r){var l,c;var a=this;if((l=this.i18nFormat)!=null&&l.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});let p=R(t)&&(((c=n==null?void 0:n.interpolation)==null?void 0:c.skipOnVariables)!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables),h;if(p){let m=t.match(this.interpolator.nestingRegexp);h=m&&m.length}let g=n.replace&&!R(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(g={...this.options.interpolation.defaultVariables,...g}),t=this.interpolator.interpolate(t,g,n.lng||this.language||i.usedLng,n),p){let m=t.match(this.interpolator.nestingRegexp),f=m&&m.length;h<f&&(n.nest=!1)}!n.lng&&i&&i.res&&(n.lng=this.language||i.usedLng),n.nest!==!1&&(t=this.interpolator.nest(t,function(){for(var m=arguments.length,f=new Array(m),v=0;v<m;v++)f[v]=arguments[v];return(r==null?void 0:r[0])===f[0]&&!n.context?(a.logger.warn(`It seems you are nesting recursively key: ${f[0]} in key: ${e[0]}`),null):a.translate(...f,e)},n)),n.interpolation&&this.interpolator.reset()}let o=n.postProcess||this.options.postProcess,s=R(o)?[o]:o;return t!=null&&(s!=null&&s.length)&&n.applyPostProcessor!==!1&&(t=_i.handle(s,t,e,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),t}resolve(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n,i,r,a,o;return R(t)&&(t=[t]),t.forEach(s=>{if(this.isValidLookup(n))return;let l=this.extractFromKey(s,e),c=l.key;i=c;let p=l.namespaces;this.options.fallbackNS&&(p=p.concat(this.options.fallbackNS));let h=e.count!==void 0&&!R(e.count),g=h&&!e.ordinal&&e.count===0,m=e.context!==void 0&&(R(e.context)||typeof e.context=="number")&&e.context!=="",f=e.lngs?e.lngs:this.languageUtils.toResolveHierarchy(e.lng||this.language,e.fallbackLng);p.forEach(v=>{var A,k;this.isValidLookup(n)||(o=v,!Li[`${f[0]}-${v}`]&&((A=this.utils)!=null&&A.hasLoadedNamespace)&&!((k=this.utils)!=null&&k.hasLoadedNamespace(o))&&(Li[`${f[0]}-${v}`]=!0,this.logger.warn(`key "${i}" for languages "${f.join(", ")}" won't get resolved as namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),f.forEach(C=>{var le;if(this.isValidLookup(n))return;a=C;let P=[c];if((le=this.i18nFormat)!=null&&le.addLookupKeys)this.i18nFormat.addLookupKeys(P,c,C,v,e);else{let U;h&&(U=this.pluralResolver.getSuffix(C,e.count,e));let ne=`${this.options.pluralSeparator}zero`,Ve=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(h&&(P.push(c+U),e.ordinal&&U.indexOf(Ve)===0&&P.push(c+U.replace(Ve,this.options.pluralSeparator)),g&&P.push(c+ne)),m){let Ne=`${c}${this.options.contextSeparator}${e.context}`;P.push(Ne),h&&(P.push(Ne+U),e.ordinal&&U.indexOf(Ve)===0&&P.push(Ne+U.replace(Ve,this.options.pluralSeparator)),g&&P.push(Ne+ne))}}let K;for(;K=P.pop();)this.isValidLookup(n)||(r=K,n=this.getResource(C,v,K,e))}))})}),{res:n,usedKey:i,exactUsedKey:r,usedLng:a,usedNS:o}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,e,n){var r;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return(r=this.i18nFormat)!=null&&r.getResource?this.i18nFormat.getResource(t,e,n,i):this.resourceStore.getResource(t,e,n,i)}getUsedParamsDetails(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=t.replace&&!R(t.replace),i=n?t.replace:t;if(n&&typeof t.count!="undefined"&&(i.count=t.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!n){i={...i};for(let r of e)delete i[r]}return i}static hasDefaultValue(t){let e="defaultValue";for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e===n.substring(0,e.length)&&t[n]!==void 0)return!0;return!1}},Ut=class{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Oe.create("languageUtils")}getScriptPartFromCode(t){if(t=jt(t),!t||t.indexOf("-")<0)return null;let e=t.split("-");return e.length===2||(e.pop(),e[e.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(e.join("-"))}getLanguagePartFromCode(t){if(t=jt(t),!t||t.indexOf("-")<0)return t;let e=t.split("-");return this.formatLanguageCode(e[0])}formatLanguageCode(t){if(R(t)&&t.indexOf("-")>-1){let e;try{e=Intl.getCanonicalLocales(t)[0]}catch(n){}return e&&this.options.lowerCaseLng&&(e=e.toLowerCase()),e||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let e;return t.forEach(n=>{if(e)return;let i=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(i))&&(e=i)}),!e&&this.options.supportedLngs&&t.forEach(n=>{if(e)return;let i=this.getLanguagePartFromCode(n);if(this.isSupportedCode(i))return e=i;e=this.options.supportedLngs.find(r=>{if(r===i)return r;if(!(r.indexOf("-")<0&&i.indexOf("-")<0)&&(r.indexOf("-")>0&&i.indexOf("-")<0&&r.substring(0,r.indexOf("-"))===i||r.indexOf(i)===0&&i.length>1))return r})}),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e}getFallbackCodes(t,e){if(!t)return[];if(typeof t=="function"&&(t=t(e)),R(t)&&(t=[t]),Array.isArray(t))return t;if(!e)return t.default||[];let n=t[e];return n||(n=t[this.getScriptPartFromCode(e)]),n||(n=t[this.formatLanguageCode(e)]),n||(n=t[this.getLanguagePartFromCode(e)]),n||(n=t.default),n||[]}toResolveHierarchy(t,e){let n=this.getFallbackCodes(e||this.options.fallbackLng||[],t),i=[],r=a=>{a&&(this.isSupportedCode(a)?i.push(a):this.logger.warn(`rejecting language code not found in supportedLngs: ${a}`))};return R(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&r(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&r(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&r(this.getLanguagePartFromCode(t))):R(t)&&r(this.formatLanguageCode(t)),n.forEach(a=>{i.indexOf(a)<0&&r(this.formatLanguageCode(a))}),i}},$i={zero:0,one:1,two:2,few:3,many:4,other:5},Ii={select:d=>d===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})},Bn=class{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=t,this.options=e,this.logger=Oe.create("pluralResolver"),this.pluralRulesCache={}}addRule(t,e){this.rules[t]=e}clearCache(){this.pluralRulesCache={}}getRule(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=jt(t==="dev"?"en":t),i=e.ordinal?"ordinal":"cardinal",r=JSON.stringify({cleanedCode:n,type:i});if(r in this.pluralRulesCache)return this.pluralRulesCache[r];let a;try{a=new Intl.PluralRules(n,{type:i})}catch(o){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),Ii;if(!t.match(/-|_/))return Ii;let s=this.languageUtils.getLanguagePartFromCode(t);a=this.getRule(s,e)}return this.pluralRulesCache[r]=a,a}needsPlural(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=this.getRule(t,e);return n||(n=this.getRule("dev",e)),(n==null?void 0:n.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(t,n).map(i=>`${e}${i}`)}getSuffixes(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=this.getRule(t,e);return n||(n=this.getRule("dev",e)),n?n.resolvedOptions().pluralCategories.sort((i,r)=>$i[i]-$i[r]).map(i=>`${this.options.prepend}${e.ordinal?`ordinal${this.options.prepend}`:""}${i}`):[]}getSuffix(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=this.getRule(t,n);return i?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${i.select(e)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",e,n))}},Di=function(d,t,e){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,r=es(d,t,e);return!r&&i&&R(e)&&(r=zn(d,e,n),r===void 0&&(r=zn(t,e,n))),r},Hn=d=>d.replace(/\$/g,"$$$$"),jn=class{constructor(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Oe.create("interpolator"),this.options=t,this.format=((e=t==null?void 0:t.interpolation)==null?void 0:e.format)||(n=>n),this.init(t)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});let{escape:e,escapeValue:n,useRawValueToEscape:i,prefix:r,prefixEscaped:a,suffix:o,suffixEscaped:s,formatSeparator:l,unescapeSuffix:c,unescapePrefix:p,nestingPrefix:h,nestingPrefixEscaped:g,nestingSuffix:m,nestingSuffixEscaped:f,nestingOptionsSeparator:v,maxReplaces:A,alwaysFormat:k}=t.interpolation;this.escape=e!==void 0?e:ns,this.escapeValue=n!==void 0?n:!0,this.useRawValueToEscape=i!==void 0?i:!1,this.prefix=r?ot(r):a||"{{",this.suffix=o?ot(o):s||"}}",this.formatSeparator=l||",",this.unescapePrefix=c?"":p||"-",this.unescapeSuffix=this.unescapePrefix?"":c||"",this.nestingPrefix=h?ot(h):g||ot("$t("),this.nestingSuffix=m?ot(m):f||ot(")"),this.nestingOptionsSeparator=v||",",this.maxReplaces=A||1e3,this.alwaysFormat=k!==void 0?k:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){let t=(e,n)=>(e==null?void 0:e.source)===n?(e.lastIndex=0,e):new RegExp(n,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(t,e,n,i){var g;let r,a,o,s=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},l=m=>{if(m.indexOf(this.formatSeparator)<0){let k=Di(e,s,m,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(k,void 0,n,{...i,...e,interpolationkey:m}):k}let f=m.split(this.formatSeparator),v=f.shift().trim(),A=f.join(this.formatSeparator).trim();return this.format(Di(e,s,v,this.options.keySeparator,this.options.ignoreJSONStructure),A,n,{...i,...e,interpolationkey:v})};this.resetRegExp();let c=(i==null?void 0:i.missingInterpolationHandler)||this.options.missingInterpolationHandler,p=((g=i==null?void 0:i.interpolation)==null?void 0:g.skipOnVariables)!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:m=>Hn(m)},{regex:this.regexp,safeValue:m=>this.escapeValue?Hn(this.escape(m)):Hn(m)}].forEach(m=>{for(o=0;r=m.regex.exec(t);){let f=r[1].trim();if(a=l(f),a===void 0)if(typeof c=="function"){let A=c(t,r,i);a=R(A)?A:""}else if(i&&Object.prototype.hasOwnProperty.call(i,f))a="";else if(p){a=r[0];continue}else this.logger.warn(`missed to pass in variable ${f} for interpolating ${t}`),a="";else!R(a)&&!this.useRawValueToEscape&&(a=Ti(a));let v=m.safeValue(a);if(t=t.replace(r[0],v),p?(m.regex.lastIndex+=a.length,m.regex.lastIndex-=r[0].length):m.regex.lastIndex=0,o++,o>=this.maxReplaces)break}}),t}nest(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,r,a,o=(s,l)=>{var f;let c=this.nestingOptionsSeparator;if(s.indexOf(c)<0)return s;let p=s.split(new RegExp(`${c}[ ]*{`)),h=`{${p[1]}`;s=p[0],h=this.interpolate(h,a);let g=h.match(/'/g),m=h.match(/"/g);(((f=g==null?void 0:g.length)!=null?f:0)%2===0&&!m||m.length%2!==0)&&(h=h.replace(/'/g,'"'));try{a=JSON.parse(h),l&&(a={...l,...a})}catch(v){return this.logger.warn(`failed parsing options string in nesting for key ${s}`,v),`${s}${c}${h}`}return a.defaultValue&&a.defaultValue.indexOf(this.prefix)>-1&&delete a.defaultValue,s};for(;i=this.nestingRegexp.exec(t);){let s=[];a={...n},a=a.replace&&!R(a.replace)?a.replace:a,a.applyPostProcessor=!1,delete a.defaultValue;let l=!1;if(i[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(i[1])){let c=i[1].split(this.formatSeparator).map(p=>p.trim());i[1]=c.shift(),s=c,l=!0}if(r=e(o.call(this,i[1].trim(),a),a),r&&i[0]===t&&!R(r))return r;R(r)||(r=Ti(r)),r||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${t}`),r=""),l&&(r=s.reduce((c,p)=>this.format(c,p,n.lng,{...n,interpolationkey:i[1].trim()}),r.trim())),t=t.replace(i[0],r),this.regexp.lastIndex=0}return t}},ss=d=>{let t=d.toLowerCase().trim(),e={};if(d.indexOf("(")>-1){let n=d.split("(");t=n[0].toLowerCase().trim();let i=n[1].substring(0,n[1].length-1);t==="currency"&&i.indexOf(":")<0?e.currency||(e.currency=i.trim()):t==="relativetime"&&i.indexOf(":")<0?e.range||(e.range=i.trim()):i.split(";").forEach(a=>{if(a){let[o,...s]=a.split(":"),l=s.join(":").trim().replace(/^'+|'+$/g,""),c=o.trim();e[c]||(e[c]=l),l==="false"&&(e[c]=!1),l==="true"&&(e[c]=!0),isNaN(l)||(e[c]=parseInt(l,10))}})}return{formatName:t,formatOptions:e}},st=d=>{let t={};return(e,n,i)=>{let r=i;i&&i.interpolationkey&&i.formatParams&&i.formatParams[i.interpolationkey]&&i[i.interpolationkey]&&(r={...r,[i.interpolationkey]:void 0});let a=n+JSON.stringify(r),o=t[a];return o||(o=d(jt(n),i),t[a]=o),o(e)}},Vn=class{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Oe.create("formatter"),this.options=t,this.formats={number:st((e,n)=>{let i=new Intl.NumberFormat(e,{...n});return r=>i.format(r)}),currency:st((e,n)=>{let i=new Intl.NumberFormat(e,{...n,style:"currency"});return r=>i.format(r)}),datetime:st((e,n)=>{let i=new Intl.DateTimeFormat(e,{...n});return r=>i.format(r)}),relativetime:st((e,n)=>{let i=new Intl.RelativeTimeFormat(e,{...n});return r=>i.format(r,n.range||"day")}),list:st((e,n)=>{let i=new Intl.ListFormat(e,{...n});return r=>i.format(r)})},this.init(t)}init(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=e.interpolation.formatSeparator||","}add(t,e){this.formats[t.toLowerCase().trim()]=e}addCached(t,e){this.formats[t.toLowerCase().trim()]=st(e)}format(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},r=e.split(this.formatSeparator);if(r.length>1&&r[0].indexOf("(")>1&&r[0].indexOf(")")<0&&r.find(o=>o.indexOf(")")>-1)){let o=r.findIndex(s=>s.indexOf(")")>-1);r[0]=[r[0],...r.splice(1,o)].join(this.formatSeparator)}return r.reduce((o,s)=>{var p;let{formatName:l,formatOptions:c}=ss(s);if(this.formats[l]){let h=o;try{let g=((p=i==null?void 0:i.formatParams)==null?void 0:p[i.interpolationkey])||{},m=g.locale||g.lng||i.locale||i.lng||n;h=this.formats[l](o,m,{...c,...i,...g})}catch(g){this.logger.warn(g)}return h}else this.logger.warn(`there was no format function for ${l}`);return o},t)}},ls=(d,t)=>{d.pending[t]!==void 0&&(delete d.pending[t],d.pendingCount--)},Un=class extends ct{constructor(t,e,n){var r,a;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=t,this.store=e,this.services=n,this.languageUtils=n.languageUtils,this.options=i,this.logger=Oe.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],(a=(r=this.backend)==null?void 0:r.init)==null||a.call(r,n,i.backend,i)}queueLoad(t,e,n,i){let r={},a={},o={},s={};return t.forEach(l=>{let c=!0;e.forEach(p=>{let h=`${l}|${p}`;!n.reload&&this.store.hasResourceBundle(l,p)?this.state[h]=2:this.state[h]<0||(this.state[h]===1?a[h]===void 0&&(a[h]=!0):(this.state[h]=1,c=!1,a[h]===void 0&&(a[h]=!0),r[h]===void 0&&(r[h]=!0),s[p]===void 0&&(s[p]=!0)))}),c||(o[l]=!0)}),(Object.keys(r).length||Object.keys(a).length)&&this.queue.push({pending:a,pendingCount:Object.keys(a).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(r),pending:Object.keys(a),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(s)}}loaded(t,e,n){let i=t.split("|"),r=i[0],a=i[1];e&&this.emit("failedLoading",r,a,e),!e&&n&&this.store.addResourceBundle(r,a,n,void 0,void 0,{skipCopy:!0}),this.state[t]=e?-1:2,e&&n&&(this.state[t]=0);let o={};this.queue.forEach(s=>{Qo(s.loaded,[r],a),ls(s,t),e&&s.errors.push(e),s.pendingCount===0&&!s.done&&(Object.keys(s.loaded).forEach(l=>{o[l]||(o[l]={});let c=s.loaded[l];c.length&&c.forEach(p=>{o[l][p]===void 0&&(o[l][p]=!0)})}),s.done=!0,s.errors.length?s.callback(s.errors):s.callback())}),this.emit("loaded",o),this.queue=this.queue.filter(s=>!s.done)}read(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,a=arguments.length>5?arguments[5]:void 0;if(!t.length)return a(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:e,fcName:n,tried:i,wait:r,callback:a});return}this.readingCalls++;let o=(l,c)=>{if(this.readingCalls--,this.waitingReads.length>0){let p=this.waitingReads.shift();this.read(p.lng,p.ns,p.fcName,p.tried,p.wait,p.callback)}if(l&&c&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,t,e,n,i+1,r*2,a)},r);return}a(l,c)},s=this.backend[n].bind(this.backend);if(s.length===2){try{let l=s(t,e);l&&typeof l.then=="function"?l.then(c=>o(null,c)).catch(o):o(null,l)}catch(l){o(l)}return}return s(t,e,o)}prepareLoading(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();R(t)&&(t=this.languageUtils.toResolveHierarchy(t)),R(e)&&(e=[e]);let r=this.queueLoad(t,e,n,i);if(!r.toLoad.length)return r.pending.length||i(),null;r.toLoad.forEach(a=>{this.loadOne(a)})}load(t,e,n){this.prepareLoading(t,e,{},n)}reload(t,e,n){this.prepareLoading(t,e,{reload:!0},n)}loadOne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=t.split("|"),i=n[0],r=n[1];this.read(i,r,"read",void 0,void 0,(a,o)=>{a&&this.logger.warn(`${e}loading namespace ${r} for language ${i} failed`,a),!a&&o&&this.logger.log(`${e}loaded namespace ${r} for language ${i}`,o),this.loaded(t,a,o)})}saveMissing(t,e,n,i,r){var s,l,c,p,h;let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if((l=(s=this.services)==null?void 0:s.utils)!=null&&l.hasLoadedNamespace&&!((p=(c=this.services)==null?void 0:c.utils)!=null&&p.hasLoadedNamespace(e))){this.logger.warn(`did not save key "${n}" as the namespace "${e}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if((h=this.backend)!=null&&h.create){let g={...a,isUpdate:r},m=this.backend.create.bind(this.backend);if(m.length<6)try{let f;m.length===5?f=m(t,e,n,i,g):f=m(t,e,n,i),f&&typeof f.then=="function"?f.then(v=>o(null,v)).catch(o):o(null,f)}catch(f){o(f)}else m(t,e,n,i,o,g)}!t||!t[0]||this.store.addResource(t[0],e,n,i)}}},Ri=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:d=>{let t={};if(typeof d[1]=="object"&&(t=d[1]),R(d[1])&&(t.defaultValue=d[1]),R(d[2])&&(t.tDescription=d[2]),typeof d[2]=="object"||typeof d[3]=="object"){let e=d[3]||d[2];Object.keys(e).forEach(n=>{t[n]=e[n]})}return t},interpolation:{escapeValue:!0,format:d=>d,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),Fi=d=>{var t,e;return R(d.ns)&&(d.ns=[d.ns]),R(d.fallbackLng)&&(d.fallbackLng=[d.fallbackLng]),R(d.fallbackNS)&&(d.fallbackNS=[d.fallbackNS]),((e=(t=d.supportedLngs)==null?void 0:t.indexOf)==null?void 0:e.call(t,"cimode"))<0&&(d.supportedLngs=d.supportedLngs.concat(["cimode"])),typeof d.initImmediate=="boolean"&&(d.initAsync=d.initImmediate),d},zt=()=>{},cs=d=>{Object.getOwnPropertyNames(Object.getPrototypeOf(d)).forEach(e=>{typeof d[e]=="function"&&(d[e]=d[e].bind(d))})},qe=class extends ct{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;if(super(),this.options=Fi(t),this.services={},this.logger=Oe,this.modules={external:[]},cs(this),e&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,e),this;setTimeout(()=>{this.init(t,e)},0)}}init(){var t=this;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof e=="function"&&(n=e,e={}),e.defaultNS==null&&e.ns&&(R(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));let i=Ri();this.options={...i,...this.options,...Fi(e)},this.options.interpolation={...i.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);let r=c=>c?typeof c=="function"?new c:c:null;if(!this.options.isClone){this.modules.logger?Oe.init(r(this.modules.logger),this.options):Oe.init(null,this.options);let c;this.modules.formatter?c=this.modules.formatter:c=Vn;let p=new Ut(this.options);this.store=new Vt(this.options.resources,this.options);let h=this.services;h.logger=Oe,h.resourceStore=this.store,h.languageUtils=p,h.pluralResolver=new Bn(p,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),c&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(h.formatter=r(c),h.formatter.init(h,this.options),this.options.interpolation.format=h.formatter.format.bind(h.formatter)),h.interpolator=new jn(this.options),h.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},h.backendConnector=new Un(r(this.modules.backend),h.resourceStore,h,this.options),h.backendConnector.on("*",function(g){for(var m=arguments.length,f=new Array(m>1?m-1:0),v=1;v<m;v++)f[v-1]=arguments[v];t.emit(g,...f)}),this.modules.languageDetector&&(h.languageDetector=r(this.modules.languageDetector),h.languageDetector.init&&h.languageDetector.init(h,this.options.detection,this.options)),this.modules.i18nFormat&&(h.i18nFormat=r(this.modules.i18nFormat),h.i18nFormat.init&&h.i18nFormat.init(this)),this.translator=new dt(this.services,this.options),this.translator.on("*",function(g){for(var m=arguments.length,f=new Array(m>1?m-1:0),v=1;v<m;v++)f[v-1]=arguments[v];t.emit(g,...f)}),this.modules.external.forEach(g=>{g.init&&g.init(this)})}if(this.format=this.options.interpolation.format,n||(n=zt),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){let c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&c[0]!=="dev"&&(this.options.lng=c[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(c=>{this[c]=function(){return t.store[c](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(c=>{this[c]=function(){return t.store[c](...arguments),t}});let s=xt(),l=()=>{let c=(p,h)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),s.resolve(h),n(p,h)};if(this.languages&&!this.isInitialized)return c(null,this.t.bind(this));this.changeLanguage(this.options.lng,c)};return this.options.resources||!this.options.initAsync?l():setTimeout(l,0),s}loadResources(t){var r,a;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:zt,i=R(t)?t:this.language;if(typeof t=="function"&&(n=t),!this.options.resources||this.options.partialBundledLanguages){if((i==null?void 0:i.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();let o=[],s=l=>{if(!l||l==="cimode")return;this.services.languageUtils.toResolveHierarchy(l).forEach(p=>{p!=="cimode"&&o.indexOf(p)<0&&o.push(p)})};i?s(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(c=>s(c)),(a=(r=this.options.preload)==null?void 0:r.forEach)==null||a.call(r,l=>s(l)),this.services.backendConnector.load(o,this.options.ns,l=>{!l&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(l)})}else n(null)}reloadResources(t,e,n){let i=xt();return typeof t=="function"&&(n=t,t=void 0),typeof e=="function"&&(n=e,e=void 0),t||(t=this.languages),e||(e=this.options.ns),n||(n=zt),this.services.backendConnector.reload(t,e,r=>{i.resolve(),n(r)}),i}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&_i.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1))for(let e=0;e<this.languages.length;e++){let n=this.languages[e];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}changeLanguage(t,e){var n=this;this.isLanguageChangingTo=t;let i=xt();this.emit("languageChanging",t);let r=s=>{this.language=s,this.languages=this.services.languageUtils.toResolveHierarchy(s),this.resolvedLanguage=void 0,this.setResolvedLanguage(s)},a=(s,l)=>{l?(r(l),this.translator.changeLanguage(l),this.isLanguageChangingTo=void 0,this.emit("languageChanged",l),this.logger.log("languageChanged",l)):this.isLanguageChangingTo=void 0,i.resolve(function(){return n.t(...arguments)}),e&&e(s,function(){return n.t(...arguments)})},o=s=>{var c,p;!t&&!s&&this.services.languageDetector&&(s=[]);let l=R(s)?s:this.services.languageUtils.getBestMatchFromCodes(s);l&&(this.language||r(l),this.translator.language||this.translator.changeLanguage(l),(p=(c=this.services.languageDetector)==null?void 0:c.cacheUserLanguage)==null||p.call(c,l)),this.loadResources(l,h=>{a(h,l)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(t),i}getFixedT(t,e,n){var i=this;let r=function(a,o){let s;if(typeof o!="object"){for(var l=arguments.length,c=new Array(l>2?l-2:0),p=2;p<l;p++)c[p-2]=arguments[p];s=i.options.overloadTranslationOptionHandler([a,o].concat(c))}else s={...o};s.lng=s.lng||r.lng,s.lngs=s.lngs||r.lngs,s.ns=s.ns||r.ns,s.keyPrefix!==""&&(s.keyPrefix=s.keyPrefix||n||r.keyPrefix);let h=i.options.keySeparator||".",g;return s.keyPrefix&&Array.isArray(a)?g=a.map(m=>`${s.keyPrefix}${h}${m}`):g=s.keyPrefix?`${s.keyPrefix}${h}${a}`:a,i.t(g,s)};return R(t)?r.lng=t:r.lngs=t,r.ns=e,r.keyPrefix=n,r}t(){var i;for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return(i=this.translator)==null?void 0:i.translate(...e)}exists(){var i;for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return(i=this.translator)==null?void 0:i.exists(...e)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;let n=e.lng||this.resolvedLanguage||this.languages[0],i=this.options?this.options.fallbackLng:!1,r=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;let a=(o,s)=>{let l=this.services.backendConnector.state[`${o}|${s}`];return l===-1||l===0||l===2};if(e.precheck){let o=e.precheck(this,a);if(o!==void 0)return o}return!!(this.hasResourceBundle(n,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||a(n,t)&&(!i||a(r,t)))}loadNamespaces(t,e){let n=xt();return this.options.ns?(R(t)&&(t=[t]),t.forEach(i=>{this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}),this.loadResources(i=>{n.resolve(),e&&e(i)}),n):(e&&e(),Promise.resolve())}loadLanguages(t,e){let n=xt();R(t)&&(t=[t]);let i=this.options.preload||[],r=t.filter(a=>i.indexOf(a)<0&&this.services.languageUtils.isSupportedCode(a));return r.length?(this.options.preload=i.concat(r),this.loadResources(a=>{n.resolve(),e&&e(a)}),n):(e&&e(),Promise.resolve())}dir(t){var i,r;if(t||(t=this.resolvedLanguage||(((i=this.languages)==null?void 0:i.length)>0?this.languages[0]:this.language)),!t)return"rtl";let e=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=((r=this.services)==null?void 0:r.languageUtils)||new Ut(Ri());return e.indexOf(n.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return new qe(t,e)}cloneInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:zt,n=t.forkResourceStore;n&&delete t.forkResourceStore;let i={...this.options,...t,isClone:!0},r=new qe(i);if((t.debug!==void 0||t.prefix!==void 0)&&(r.logger=r.logger.clone(t)),["store","services","language"].forEach(o=>{r[o]=this[o]}),r.services={...this.services},r.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},n){let o=Object.keys(this.store.data).reduce((s,l)=>(s[l]={...this.store.data[l]},Object.keys(s[l]).reduce((c,p)=>(c[p]={...s[l][p]},c),{})),{});r.store=new Vt(o,i),r.services.resourceStore=r.store}return r.translator=new dt(r.services,i),r.translator.on("*",function(o){for(var s=arguments.length,l=new Array(s>1?s-1:0),c=1;c<s;c++)l[c-1]=arguments[c];r.emit(o,...l)}),r.init(i,e),r.translator.options=i,r.translator.backendConnector.services.utils={hasLoadedNamespace:r.hasLoadedNamespace.bind(r)},r}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}},ce=qe.createInstance();ce.createInstance=qe.createInstance;Pc=ce.createInstance,Tc=ce.dir,Ec=ce.init,Mc=ce.loadResources,Ac=ce.reloadResources,Lc=ce.use,$c=ce.changeLanguage,Ic=ce.getFixedT,Dc=ce.t,Rc=ce.exists,Fc=ce.setDefaultNamespace,Oc=ce.hasLoadedNamespace,_c=ce.loadNamespaces,Hc=ce.loadLanguages});var zi,Ni=y(()=>{zi={assets:{draft:"Draft",image:"Image","invalid-draft":"Invalid draft: missing account name or note path.",news:"News",video:"Video",voice:"Voice"},main:{"no-wechat-mp-account-selected":"No WeChat MP account selected.","please-check-you-appid-and-appsecret":"Please check your AppID and AppSecret.","open-previewer":"Article render previewer","fetch-wechat-profile":"Fetching WeChat profile","insert-mpcard":"Insert official account card","mpcard-not-configured":"No official account card configured. Paste the HTML in publish config first."},modals:{"be-careful":"Caution!",cancel:"Cancel",caution:"Caution!",confirm:"Confirm",delete:{action:"To proceed with deletion, click below.",message:"Are you sure you want to delete this item?",title:"Confirm Delete",warning:"This action is permanent and cannot be undone."},enter:"Enter",escape:"Escape",mpcard:{empty:"Please paste official account card content.",hint:"Copy the official account card code block from WeChat backend and paste it here.",insert:"Insert",placeholder:"Example:\n```mpcard\nid: gh_xxx\nheadimg: https://...\nnickname: Official Account\nsignature: Account description\n```",title:"Insert official account card"},ok:"OK",publish:{failed:"Publication failed",message:"Are you sure you want to publish this article?",success:"Published successfully",title:"Confirm publish",warning:"Publishing outside of WeChat MP may not be as efficient and some features might not work as expected (e.g., tags, pushing to public accounts)."},"publish-config":{"card-tab":"Official account card","options-tab":"Article options","mpcard-desc":"Paste the HTML code copied after inserting an official account card in WeChat editor.","copy-script":"Copy extract script","script-copied":"Script copied to clipboard.","mpcard-input":"Card HTML","mpcard-input-desc":"Paste <mp-common-profile> or a <section> that contains it.","mpcard-empty":"No official account card configured.","save-mpcard":"Parse and save","clear-mpcard":"Clear card","no-account":"No official account selected.","invalid-mpcard":"Invalid card content or missing data-id.","mpcard-saved":"Official account card saved.","no-active-file":"No active Markdown file.",title:"Title",author:"Author",digest:"Digest","source-url":"Source URL","open-comment":"Enable comments","only-fans":"Fans only comments","cover-empty":"Cover image not set."},space:"Space"},render:{"admonition-failed":"<section>Admonition rendering failed</section>","callout-failed":"<span>Callout rendering failed</span>","charts-failed":"<section>Charts rendering failed</section>","excalidraw-failed":"Excalidraw rendering failed","faild-canvas-context":"Failed to get canvas context.","failed-to-convert-canvas-to-blob":"Failed to convert canvas to Blob.","file-not-found":"File not found: {0}","mermaid-failed":"<section>Mermaid rendering failed</section>","pdf-crop-failed":"<span>Pdf cropping failed</span>","render-failed":"Rendering failed.","charts-plugin-not-installed":"Charts plugin not installed.","mpcard-default-name":"Official Account","mpcard-default-signature":"Account description",rendering:"Rendering...","failed-to-parse-custom-css":"Custom CSS parsing failed: {0}"},settings:{"account-info":"Account info","account-name":"Public account name","account-name-for-your-wechat-official":"WeChat official account name","add-ip-address-ipv4-0-to-wechat-mp-ip-wh":"Add IP address [{0}] to WeChat MP IP whitelist.",appid:"AppID","app-secret":"AppSecret","app-secret-for-your-wechat-official":"AppSecret for your WeChat official account","appid-for-your-wechat-official-account":"AppID for your WeChat official account","be-carefull-delete-account":"Caution! This will delete all settings and data for the account.","check-if-your-account-setting-is-correct":"Check if your account settings are correct.","click-to-connect-wechat-server":"Click to connect to WeChat server","successfully-connected-to-wechat-server":"Successfully connected to WeChat server.",fetching:"Fetching...","failed-to-connect-to-wechat-server":"Failed to connect to WeChat server.","copy-ip-address-to-clipboard":"Copy IP address to clipboard","copy-ip-to-clipboard":"Copy IP to clipboard","clipboard-not-supported":"Clipboard is not available on this platform.","create-new-account":"Create new account","custom-themes":"Custom themes","custom-themes-folder":"Custom themes folder","general-settings":"General settings","default-mpcard-biz-id":"Biz ID (data-id)","default-mpcard-biz-id-desc":"Base64 ID from the HTML.","delete-account":"Delete account","draft-previewer-wechat-id":"Draft previewer WeChat ID","draft-only-visible-for-the-wechat-user-o":"Draft visible only to the WeChat user. Requires API permission.","preview-draft-tooltip":"Send preview (API permission required)","enable-real-time-rendering":"Enable real-time rendering of markdown content","real-time-render":"Real-time Render","failed-to-get-wechat-access-token":"Failed to get WeChat access token.","if-your-device-cannot-get-static-pubic-i":"If your device cannot get a static public IP, use our center token server to get tokens. We will not misuse your AppID or AppSecret.","appid-secret-guide":"AppID and AppSecret are now available in WeChat Developer Console \u2192 Official Account \u2192 Basic Info.","appid-secret-guide-link":"Open WeChat Developer Console to get AppID / AppSecret","import-account-info":"Import Account Info","export-account-info":"Export Account Info","import-export-one2mp-account":"Import/Export Account Information","import-or-export-your-account-info-for-b":"Import or export your account info for backup and restore.","import-settings-title":"Import settings from vault","import-settings-hint":"Select a JSON settings file stored in your vault.","import-settings-placeholder":"Type or select a JSON file path","import-settings-confirm":"Import","import-settings-empty-path":"Please choose a settings file.","import-settings-file-not-found":"Settings file not found.","invalid-json-file":"Invalid JSON file.","invalid-wewerite-settings-file":"Invalid One2MP settings file.","ip-copied-to-clipboard":"IP copied to clipboard.","new-account":"New account","no-ip-address":"No IP address","public-ip-address":"Public IP address","select-account":"Select account","select-wechat-mp-account":"Select WeChat MP account","send-article-to-draft-box-successfully":"Article sent to draft box successfully.","settings-exported":"Settings exported successfully.","settings-exporting-failed":"Failed to export settings.","settings-exported-to-vault":"Settings exported to vault: {0}","settings-imported-error":"Error importing settings.","settings-imported-failed":"Failed to import settings.","settings-imported-successfully":"Settings imported successfully.","default-mpcard":"Default official account card","default-mpcard-desc":"Save a default official account card (used for right-click insert).","default-mpcard-placeholder":"Paste the official account card code block","default-mpcard-id":"Account ID","default-mpcard-id-desc":"Official account user_name.","default-mpcard-id-placeholder":"gh_xxx","default-mpcard-headimg":"Avatar URL","default-mpcard-headimg-desc":"Official account avatar link.","default-mpcard-headimg-placeholder":"https://...","default-mpcard-nickname":"Account name","default-mpcard-nickname-desc":"Official account display name.","default-mpcard-nickname-placeholder":"Account name","default-mpcard-signature":"Account description","default-mpcard-signature-desc":"Official account description.","default-mpcard-signature-placeholder":"Account description","default-mpcard-sync":"Sync account info","default-mpcard-sync-success":"Default official account card synced.","default-mpcard-sync-failed":"Failed to sync official account card.","default-mpcard-sync-partial":"Only nickname was synced. Please fill avatar/signature manually.","theme-download-overwrite":"Overwrite themes on download","theme-download-overwrite-desc":"When enabled, download will overwrite existing themes with the same name.","section-wechat":"WeChat accounts","section-halo":"Halo accounts","halo-settings":"Halo settings","halo-settings-desc":"Configure Halo site URL and access token.","halo-add-site":"Add site","halo-no-site":"No Halo site configured.","halo-new-site":"New site","halo-site-name":"Site name","halo-site-name-desc":"Display name for the Halo site.","halo-site-url":"Site URL","halo-site-url-desc":"Halo site URL, e.g. https://your-halo.site.","halo-site-url-placeholder":"https://your-halo.site","halo-site-token":"Personal access token","halo-site-token-desc":"Token with post management permissions.","halo-site-token-placeholder":"pat_...","halo-default-site":"Default site","halo-default-site-desc":"Halo site used for publishing.","halo-publish-default":"Publish by default","halo-publish-default-desc":"Publish automatically unless frontmatter overrides.","halo-delete-site":"Delete site","halo-test":"Test connection","halo-test-desc":"Verify the site URL and token permissions.","halo-test-button":"Run test","halo-test-success":"Halo connection succeeded.","halo-test-missing":"Select a site and fill in URL and token first.","halo-test-auth":"Token has no permission or is invalid.","halo-test-not-found":"Site URL is invalid or API unavailable.","halo-test-failed":"Connection failed. Check network or site settings.","test-connection":"Test connection","choose-the-account-to-modify":"Choose the account to modify","the-folder-where-your-custom-themes":"Folder where your custom themes are stored.","themes-folder-path":"Themes folder path","use-center-token-server":"Use center token server","wechat-account":"WeChat account","you-should-add-this-ip-to-ip-whitelist-o":'Add this IP address to whitelist. Click the image in "account information" below to visit the WeChat MP platform.',"your-wechat-official-account":"Your WeChat official account"},views:{"article-header":{"article-title":"Article title","article-title-placeholder":"Enter article title",author:"Author","author-name":"Author name","comments-description":"Comments are closed by default.","cover-image":"Cover image","cover-image-description":"Cover image is required. Drag from vault or use an online image URL.","cover-file-not-supported":"Local file cover is not supported on mobile. Use a vault image or URL.","cover-image-mobile-button":"Choose/upload cover","cover-image-mobile-title":"Set cover image","cover-image-mobile-vault":"Select from vault","cover-image-mobile-vault-desc":"Choose an image path from the vault.","cover-image-mobile-vault-placeholder":"Type or select an image path","cover-image-mobile-url":"Use an image URL","cover-image-mobile-url-desc":"Enter an image URL.","cover-image-mobile-required":"Provide at least one cover image source.","cover-image-mobile-invalid":"Invalid image path. Please check and try again.","reset-cover-crop":"Reset crop",digest:"Digest","digest-text":"Enter digest text","only-fans-can-comment":"Only fans can comment","only-fans-can-comment-description":"Everyone can comment by default.","open-comments":"Open comments","testing-button":"Testing button",title:"Draft header"},"delete-draft":"Delete draft","delete-image":"Delete image","free-publish":"Free publish","no-title-article":"Article without title.","other-type-has-not-been-implemented":"Other type not implemented.","preview-draft":"Preview draft",previewer:{"article-copied-to-clipboard":"Article copied to clipboard.","open-url-not-supported":"Opening links is not supported on this platform.","article-render-failed":"Failed to render article.","article-title":"Article title","copy-article-to-clipboard":"Copy article to clipboard","publish-config":"Publish config","generate-template":"Generate WeChat template","file-not-found-path":"File not found: {0}","not-a-markdown-view":"Not a markdown view","please-set-cover-image":"Please set a cover image.","preview-draft-missing-id":"Send to draft first before previewing.","preview-draft-missing-wxid":"Set the previewer WeChat ID in Publish config first.","preview-draft-sent":"Preview message sent to WeChat.","render-article":"Render article","send-article-to-draft-box":"Send article to draft box","template-created":"WeChat template created.","template-file-created":"Template file created: one2mp-template.md","testing-button":"Testing button","to-verify-the-images-in-article":"Verify images in the article","one2mp-previewer":"O2Any previewer"},"send-mass-message":"Send mass message","theme-manager":{"default-theme":"Default theme","download-predefined-custom-themes":"Download predefined custom themes","download-started":"Theme download started. Please wait\u2026","download-themes-mobile-not-supported":"Theme download is not supported on mobile.","download-summary":"Theme download finished: {0} success, {1} failed, {2} skipped","error-downloading-theme":"Error downloading theme","error-downloading-themes":"Error downloading themes.","failed-to-fetch-themes-json-themesrespon":"Failed to fetch themes.json: {0}","total-themes-length-themes-downloaded":"Total {0} themes downloaded."},platform:{wechat:"WeChat",zhihu:"Zhihu",redbook:"Xiaohongshu",halo:"Halo"},zhihu:{copy:"Copy",open:"Open Zhihu",refresh:"Refresh",copied:"Copied to clipboard."},halo:{publish:"Publish to Halo","open-site":"Open Halo",hint:"Uploading local images to Halo and replacing them with remote URLs.","missing-site":"Configure a Halo site in settings first.","no-active-file":"No active markdown file.",publishing:"Publishing to Halo...","publish-success":"Published to Halo successfully.","publish-failed":"Failed to publish to Halo.","attachment-not-configured":"Attachment storage is not configured in Halo.","attachment-permission":"Halo token has no attachment permission.","attachment-failed":"Halo attachment upload failed.","site-mismatch":"Halo site in frontmatter does not match the selected site.",ready:"Ready to publish to {0}","current-site":"Current site: {0}"},redbook:{"cover-title":"Xiaohongshu cover","cover-hint":"Drag an image here to set cover. It will be placed first when exporting.","cover-empty":"Cover not set.",copy:"Copy Text",export:"Export Package",open:"Open Xiaohongshu",refresh:"Refresh",copied:"Text copied.",empty:"No text to copy.","no-active-file":"No active Markdown file."}},"wechat-api":{"add-ip-address-ipv4-0-to-wechat-mp-ip-wh":"Add IP address [{0}] to WeChat MP IP whitelist.","failed-to-get-wechat-access-token":"Failed to get WeChat access token.","image-size-exceeds-10m":"Image size exceeds 10MB limit","video-size-exceeds-10m":"Video size exceeds 10MB limit","voice-size-exceeds-2m":"Voice size exceeds 2MB limit","select-an-wechat-mp-account-first":"Select a WeChat MP account first.","send-article-to-draft-box-successfully":"Article sent to draft box successfully.","uploading-material-type":"uploading material {0}"}}});var ji,Bi=y(()=>{ji={assets:{draft:"\u8349\u7A3F",image:"\u56FE\u7247","invalid-draft":"\u65E0\u6548\u8349\u7A3F\uFF1A\u7F3A\u5C11\u8D26\u53F7\u540D\u79F0\u6216\u7B14\u8BB0\u8DEF\u5F84\u3002",news:"\u56FE\u6587\u6D88\u606F",video:"\u89C6\u9891",voice:"\u8BED\u97F3"},main:{"no-wechat-mp-account-selected":"\u672A\u9009\u62E9\u5FAE\u4FE1\u516C\u4F17\u53F7\u8D26\u53F7\u3002","please-check-you-appid-and-appsecret":"\u8BF7\u68C0\u67E5\u60A8\u7684AppID\u548CAppSecret\u3002","open-previewer":"\u6587\u7AE0\u6E32\u67D3\u9884\u89C8","fetch-wechat-profile":"\u63D0\u53D6\u516C\u4F17\u53F7\u4FE1\u606F","insert-mpcard":"\u63D2\u5165\u516C\u4F17\u53F7\u540D\u7247","mpcard-not-configured":"\u672A\u914D\u7F6E\u516C\u4F17\u53F7\u540D\u7247\uFF0C\u8BF7\u5148\u5728\u53D1\u5E03\u914D\u7F6E\u4E2D\u7C98\u8D34\u516C\u4F17\u53F7\u540D\u7247HTML\u3002"},modals:{"be-careful":"\u6CE8\u610F\uFF01",cancel:"\u53D6\u6D88",caution:"\u6CE8\u610F\uFF01",confirm:"\u786E\u8BA4",delete:{action:"\u70B9\u51FB\u4E0B\u65B9\u6309\u94AE\u7EE7\u7EED\u5220\u9664\u3002",message:"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u9879\u5417\uFF1F",title:"\u786E\u8BA4\u5220\u9664",warning:"\u6B64\u64CD\u4F5C\u4E0D\u53EF\u64A4\u9500\u3002"},enter:"\u56DE\u8F66",escape:"Esc\u952E",mpcard:{empty:"\u8BF7\u8F93\u5165\u516C\u4F17\u53F7\u540D\u7247\u5185\u5BB9\u3002",hint:"\u8BF7\u5728\u516C\u4F17\u53F7\u540E\u53F0\u590D\u5236\u516C\u4F17\u53F7\u540D\u7247\u7684\u4EE3\u7801\u5757\u5185\u5BB9\uFF0C\u5E76\u7C98\u8D34\u5230\u8FD9\u91CC\u3002",insert:"\u63D2\u5165",placeholder:"\u793A\u4F8B:\n```mpcard\nid: gh_xxx\nheadimg: https://...\nnickname: \u516C\u4F17\u53F7\u540D\u79F0\nsignature: \u516C\u4F17\u53F7\u4ECB\u7ECD\n```",title:"\u63D2\u5165\u516C\u4F17\u53F7\u540D\u7247"},ok:"\u786E\u5B9A",publish:{failed:"\u53D1\u5E03\u5931\u8D25",message:"\u786E\u5B9A\u8981\u53D1\u5E03\u8FD9\u7BC7\u6587\u7AE0\u5417\uFF1F",success:"\u53D1\u5E03\u6210\u529F",title:"\u786E\u8BA4\u53D1\u5E03",warning:"\u5728\u5FAE\u4FE1\u516C\u4F17\u53F7\u5E73\u53F0\u5916\u53D1\u5E03\u53EF\u80FD\u6548\u7387\u8F83\u4F4E\uFF0C\u90E8\u5206\u529F\u80FD\u53EF\u80FD\u65E0\u6CD5\u6B63\u5E38\u4F7F\u7528\uFF08\u5982\u6807\u7B7E\u3001\u63A8\u9001\u5230\u516C\u4F17\u53F7\u7B49\uFF09\u3002"},space:"\u7A7A\u683C"},"publish-config":{title:"\u6587\u7AE0\u53D1\u5E03\u914D\u7F6E","mp-card-settings":"\u516C\u4F17\u53F7\u540D\u7247\u914D\u7F6E","paste-html-guide":"\u8BF7\u4ECE\u6D4F\u89C8\u5668\u63D2\u4EF6\u6216\u516C\u4F17\u53F7\u540E\u53F0\u590D\u5236\u540D\u7247 HTML \u4EE3\u7801 (<mp-common-profile...>) \u5E76\u7C98\u8D34\u5230\u4E0B\u65B9\uFF1A","parse-and-save":"\u89E3\u6790\u5E76\u4FDD\u5B58","card-updated":"\u540D\u7247\u4FE1\u606F\u5DF2\u66F4\u65B0","parse-failed":"\u89E3\u6790\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5 HTML \u4EE3\u7801\u683C\u5F0F","manual-edit":"\u624B\u52A8\u7F16\u8F91 (\u9AD8\u7EA7)","other-settings":"\u5176\u4ED6\u53D1\u5E03\u53C2\u6570","card-tab":"\u516C\u4F17\u53F7\u540D\u7247","options-tab":"\u6587\u7AE0\u53C2\u6570","mpcard-desc":"\u8BF7\u7C98\u8D34\u516C\u4F17\u53F7\u540E\u53F0\u4E2D\u63D2\u5165\u540D\u7247\u540E\u590D\u5236\u5230\u7684 HTML \u4EE3\u7801\u3002","copy-script":"\u590D\u5236\u63D0\u53D6\u811A\u672C","script-copied":"\u811A\u672C\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F\u3002","mpcard-input":"\u540D\u7247 HTML","mpcard-input-desc":"\u7C98\u8D34 <mp-common-profile> \u6216\u5305\u542B\u5B83\u7684 <section> \u4EE3\u7801\u3002","mpcard-empty":"\u5C1A\u672A\u914D\u7F6E\u516C\u4F17\u53F7\u540D\u7247\u3002","save-mpcard":"\u89E3\u6790\u5E76\u4FDD\u5B58","clear-mpcard":"\u6E05\u7A7A\u540D\u7247","no-account":"\u672A\u9009\u62E9\u516C\u4F17\u53F7\u8D26\u53F7\u3002","invalid-mpcard":"\u540D\u7247\u5185\u5BB9\u65E0\u6548\u6216\u7F3A\u5C11 data-id\u3002","mpcard-saved":"\u516C\u4F17\u53F7\u540D\u7247\u5DF2\u4FDD\u5B58\u3002","no-active-file":"\u672A\u627E\u5230\u53EF\u7F16\u8F91\u7684 Markdown \u6587\u4EF6\u3002","field-title":"\u6807\u9898",author:"\u4F5C\u8005",digest:"\u6458\u8981","source-url":"\u539F\u6587\u94FE\u63A5","open-comment":"\u5F00\u542F\u8BC4\u8BBA","only-fans":"\u4EC5\u7C89\u4E1D\u53EF\u8BC4\u8BBA","cover-empty":"\u672A\u8BBE\u7F6E\u5C01\u9762\u56FE\u3002"},render:{"admonition-failed":"<section>Admonition\u6E32\u67D3\u5931\u8D25</section>","callout-failed":"<span>Callout\u6E32\u67D3\u5931\u8D25</span>","charts-failed":"<section>\u56FE\u8868\u6E32\u67D3\u5931\u8D25</section>","excalidraw-failed":"Excalidraw\u6E32\u67D3\u5931\u8D25","faild-canvas-context":"\u83B7\u53D6canvas\u4E0A\u4E0B\u6587\u5931\u8D25\u3002","failed-to-convert-canvas-to-blob":"\u5C06canvas\u8F6C\u6362\u4E3ABlob\u5931\u8D25\u3002","file-not-found":"\u6587\u4EF6\u672A\u627E\u5230\uFF1A{0}","mermaid-failed":"<section>Mermaid\u6E32\u67D3\u5931\u8D25</section>","pdf-crop-failed":"<span>PDF\u88C1\u526A\u5931\u8D25</span>","render-failed":"\u6E32\u67D3\u5931\u8D25\u3002","charts-plugin-not-installed":"\u56FE\u8868\u63D2\u4EF6\u672A\u5B89\u88C5\u3002","mpcard-default-name":"\u516C\u4F17\u53F7\u540D\u79F0","mpcard-default-signature":"\u516C\u4F17\u53F7\u4ECB\u7ECD",rendering:"\u6E32\u67D3\u4E2D...","failed-to-parse-custom-css":"\u5B9A\u5236\u98CE\u683C\u5B58\u5728CSS\u8BED\u6CD5\u9519\u8BEF\uFF1A{0}"},settings:{"account-info":"\u8D26\u53F7\u4FE1\u606F","account-name":"\u516C\u4F17\u53F7\u540D\u79F0","account-name-for-your-wechat-official":"\u5FAE\u4FE1\u516C\u4F17\u53F7\u540D\u79F0","add-ip-address-ipv4-0-to-wechat-mp-ip-wh":"\u5C06IP\u5730\u5740[{0}]\u6DFB\u52A0\u5230\u5FAE\u4FE1\u516C\u4F17\u53F7IP\u767D\u540D\u5355\u3002",appid:"AppID","app-secret":"AppSecret","app-secret-for-your-wechat-official":"\u5FAE\u4FE1\u516C\u4F17\u53F7AppSecret","appid-for-your-wechat-official-account":"\u5FAE\u4FE1\u516C\u4F17\u53F7AppID","be-carefull-delete-account":"\u6CE8\u610F\uFF01\u8FD9\u5C06\u5220\u9664\u8BE5\u8D26\u53F7\u7684\u6240\u6709\u8BBE\u7F6E\u548C\u6570\u636E\u3002","check-if-your-account-setting-is-correct":"\u68C0\u67E5\u8D26\u53F7\u8BBE\u7F6E\u662F\u5426\u6B63\u786E\u3002","click-to-connect-wechat-server":"\u70B9\u51FB\u8FDE\u63A5\u5FAE\u4FE1\u670D\u52A1\u5668","successfully-connected-to-wechat-server":"\u6210\u529F\u8FDE\u63A5\u5230\u5FAE\u4FE1\u670D\u52A1\u5668\u3002",fetching:"\u83B7\u53D6\u4E2D...","failed-to-connect-to-wechat-server":"\u8FDE\u63A5\u5FAE\u4FE1\u670D\u52A1\u5668\u5931\u8D25\u3002","copy-ip-address-to-clipboard":"\u590D\u5236IP\u5730\u5740\u5230\u526A\u8D34\u677F","copy-ip-to-clipboard":"\u590D\u5236IP\u5230\u526A\u8D34\u677F","clipboard-not-supported":"\u5F53\u524D\u5E73\u53F0\u4E0D\u652F\u6301\u526A\u8D34\u677F\u3002","create-new-account":"\u521B\u5EFA\u65B0\u8D26\u53F7","custom-themes":"\u81EA\u5B9A\u4E49\u4E3B\u9898","custom-themes-folder":"\u81EA\u5B9A\u4E49\u4E3B\u9898\u6587\u4EF6\u5939","theme-download-overwrite":"\u4E0B\u8F7D\u4E3B\u9898\u65F6\u8986\u76D6\u540C\u540D\u6587\u4EF6","theme-download-overwrite-desc":"\u5F00\u542F\u5219\u8986\u76D6\u5DF2\u6709\u540C\u540D\u4E3B\u9898\uFF0C\u5173\u95ED\u5219\u8DF3\u8FC7\u3002","section-wechat":"\u516C\u4F17\u53F7\u8D26\u53F7\u8BBE\u7F6E","section-halo":"Halo \u8D26\u53F7\u8BBE\u7F6E","halo-settings":"Halo \u53D1\u5E03\u914D\u7F6E","halo-settings-desc":"\u914D\u7F6E Halo \u7AD9\u70B9\u5730\u5740\u4E0E\u8BBF\u95EE\u4EE4\u724C\u3002","halo-test":"\u6D4B\u8BD5\u8FDE\u63A5","halo-test-desc":"\u9A8C\u8BC1\u7AD9\u70B9\u5730\u5740\u4E0E\u4EE4\u724C\u6743\u9650\u662F\u5426\u6B63\u786E\u3002","halo-test-button":"\u5F00\u59CB\u6D4B\u8BD5","halo-test-success":"Halo \u8FDE\u63A5\u6210\u529F\u3002","halo-test-missing":"\u8BF7\u5148\u9009\u62E9\u7AD9\u70B9\u5E76\u586B\u5199\u5730\u5740\u4E0E\u4EE4\u724C\u3002","halo-test-auth":"\u4EE4\u724C\u65E0\u6743\u9650\u6216\u5DF2\u5931\u6548\u3002","halo-test-not-found":"\u7AD9\u70B9\u5730\u5740\u4E0D\u6B63\u786E\u6216\u63A5\u53E3\u4E0D\u53EF\u7528\u3002","halo-test-failed":"\u8FDE\u63A5\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u6216\u7AD9\u70B9\u8BBE\u7F6E\u3002","halo-add-site":"\u65B0\u589E\u7AD9\u70B9","halo-no-site":"\u8FD8\u6CA1\u6709\u914D\u7F6E Halo \u7AD9\u70B9\u3002","halo-new-site":"\u65B0\u5EFA\u7AD9\u70B9","halo-site-name":"\u7AD9\u70B9\u540D\u79F0","halo-site-name-desc":"Halo \u7AD9\u70B9\u663E\u793A\u540D\u79F0\u3002","halo-site-url":"\u7AD9\u70B9\u5730\u5740","halo-site-url-desc":"Halo \u7AD9\u70B9\u5730\u5740\uFF0C\u5982 https://your-halo.site\u3002","halo-site-url-placeholder":"https://your-halo.site","halo-site-token":"\u4E2A\u4EBA\u8BBF\u95EE\u4EE4\u724C","halo-site-token-desc":"\u9700\u8981\u5177\u5907\u6587\u7AE0\u7BA1\u7406\u6743\u9650\u7684\u4E2A\u4EBA\u4EE4\u724C\u3002","halo-site-token-placeholder":"pat_...","halo-default-site":"\u9ED8\u8BA4\u7AD9\u70B9","halo-default-site-desc":"\u53D1\u5E03\u65F6\u4F7F\u7528\u7684 Halo \u7AD9\u70B9\u3002","halo-publish-default":"\u9ED8\u8BA4\u53D1\u5E03","halo-publish-default-desc":"\u672A\u5728 frontmatter \u6307\u5B9A\u65F6\uFF0C\u53D1\u5E03\u540E\u81EA\u52A8\u516C\u5F00\u3002","halo-delete-site":"\u5220\u9664\u7AD9\u70B9","general-settings":"\u901A\u7528\u8BBE\u7F6E","default-mpcard-biz-id":"Biz ID\uFF08data-id\uFF09","default-mpcard-biz-id-desc":"HTML \u4E2D\u7684 base64 ID\u3002","delete-account":"\u5220\u9664\u8D26\u53F7","draft-previewer-wechat-id":"\u8349\u7A3F\u9884\u89C8\u8005\u5FAE\u4FE1ID","draft-only-visible-for-the-wechat-user-o":"\u8349\u7A3F\u4EC5\u5BF9\u5FAE\u4FE1\u7528\u6237\u53EF\u89C1\uFF0C\u9700\u516C\u4F17\u53F7\u63A5\u53E3\u6743\u9650\u3002","preview-draft-tooltip":"\u53D1\u9001\u8349\u7A3F\u9884\u89C8\uFF08\u9700\u63A5\u53E3\u6743\u9650\uFF09","enable-real-time-rendering":"\u542F\u7528Markdown\u5185\u5BB9\u7684\u5B9E\u65F6\u6E32\u67D3","real-time-render":"\u5B9E\u65F6\u6E32\u67D3","failed-to-get-wechat-access-token":"\u83B7\u53D6\u5FAE\u4FE1access token\u5931\u8D25\u3002","if-your-device-cannot-get-static-pubic-i":"\u5982\u679C\u60A8\u7684\u8BBE\u5907\u65E0\u6CD5\u83B7\u53D6\u9759\u6001\u516C\u7F51IP\uFF0C\u8BF7\u4F7F\u7528\u6211\u4EEC\u7684\u4E2D\u5FC3\u4EE4\u724C\u670D\u52A1\u5668\u83B7\u53D6\u4EE4\u724C\u3002\u6211\u4EEC\u4E0D\u4F1A\u6EE5\u7528\u60A8\u7684AppID\u6216AppSecret\u3002","appid-secret-guide":"AppID \u4E0E AppSecret \u73B0\u5728\u9700\u8981\u5728\u300C\u5FAE\u4FE1\u5F00\u53D1\u8005\u5E73\u53F0-\u516C\u4F17\u53F7-\u57FA\u7840\u4FE1\u606F\u300D\u4E2D\u83B7\u53D6\u3002","appid-secret-guide-link":"\u6253\u5F00\u5FAE\u4FE1\u5F00\u53D1\u8005\u5E73\u53F0\u83B7\u53D6 AppID / AppSecret","import-account-info":"\u5BFC\u5165\u8D26\u53F7\u4FE1\u606F","export-account-info":"\u5BFC\u51FA\u8D26\u53F7\u4FE1\u606F","import-export-one2mp-account":"\u5BFC\u5165/\u5BFC\u51FA\u8D26\u53F7\u4FE1\u606F","import-or-export-your-account-info-for-b":"\u5BFC\u5165\u6216\u5BFC\u51FA\u60A8\u7684\u8D26\u53F7\u4FE1\u606F\u4EE5\u8FDB\u884C\u5907\u4EFD\u548C\u6062\u590D\u3002","import-settings-title":"\u4ECE\u4ED3\u5E93\u5BFC\u5165\u8BBE\u7F6E","import-settings-hint":"\u8BF7\u9009\u62E9\u4FDD\u5B58\u5728\u4ED3\u5E93\u4E2D\u7684 JSON \u8BBE\u7F6E\u6587\u4EF6\u3002","import-settings-placeholder":"\u8F93\u5165\u6216\u9009\u62E9 JSON \u6587\u4EF6\u8DEF\u5F84","import-settings-confirm":"\u5BFC\u5165","import-settings-empty-path":"\u8BF7\u9009\u62E9\u8BBE\u7F6E\u6587\u4EF6\u3002","import-settings-file-not-found":"\u672A\u627E\u5230\u8BBE\u7F6E\u6587\u4EF6\u3002","invalid-json-file":"\u65E0\u6548\u7684JSON\u6587\u4EF6\u3002","invalid-wewerite-settings-file":"\u65E0\u6548\u7684One2MP\u8BBE\u7F6E\u6587\u4EF6\u3002","ip-copied-to-clipboard":"IP\u5730\u5740\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F\u3002","new-account":"\u65B0\u5EFA\u8D26\u53F7","no-ip-address":"\u65E0IP\u5730\u5740","public-ip-address":"\u516C\u7F51IP\u5730\u5740","select-account":"\u9009\u62E9\u8D26\u53F7","select-wechat-mp-account":"\u9009\u62E9\u5FAE\u4FE1\u516C\u4F17\u53F7\u8D26\u53F7","send-article-to-draft-box-successfully":"\u6587\u7AE0\u6210\u529F\u53D1\u9001\u5230\u8349\u7A3F\u7BB1\u3002","settings-exported":"\u8BBE\u7F6E\u5BFC\u51FA\u6210\u529F\u3002","settings-exporting-failed":"\u8BBE\u7F6E\u5BFC\u51FA\u5931\u8D25\u3002","settings-exported-to-vault":"\u8BBE\u7F6E\u5DF2\u5BFC\u51FA\u5230\u4ED3\u5E93\uFF1A{0}","settings-imported-error":"\u8BBE\u7F6E\u5BFC\u5165\u51FA\u9519\u3002","settings-imported-failed":"\u8BBE\u7F6E\u5BFC\u5165\u5931\u8D25\u3002","settings-imported-successfully":"\u8BBE\u7F6E\u5BFC\u5165\u6210\u529F\u3002","default-mpcard":"\u9ED8\u8BA4\u516C\u4F17\u53F7\u540D\u7247","default-mpcard-desc":"\u4FDD\u5B58\u9ED8\u8BA4\u516C\u4F17\u53F7\u540D\u7247\uFF08\u53EF\u5728\u53F3\u952E\u63D2\u5165\u65F6\u81EA\u52A8\u586B\u5145\uFF09\u3002","default-mpcard-placeholder":"\u7C98\u8D34\u516C\u4F17\u53F7\u540D\u7247\u4EE3\u7801\u5757","default-mpcard-id":"\u8D26\u53F7ID","default-mpcard-id-desc":"\u516C\u4F17\u53F7\u539F\u59CBID\uFF08user_name\uFF09\u3002","default-mpcard-id-placeholder":"gh_xxx","default-mpcard-headimg":"\u5934\u50CFURL","default-mpcard-headimg-desc":"\u516C\u4F17\u53F7\u5934\u50CF\u94FE\u63A5\u3002","default-mpcard-headimg-placeholder":"https://...","default-mpcard-nickname":"\u516C\u4F17\u53F7\u540D\u79F0","default-mpcard-nickname-desc":"\u516C\u4F17\u53F7\u663E\u793A\u540D\u79F0\u3002","default-mpcard-nickname-placeholder":"\u516C\u4F17\u53F7\u540D\u79F0","default-mpcard-signature":"\u516C\u4F17\u53F7\u4ECB\u7ECD","default-mpcard-signature-desc":"\u516C\u4F17\u53F7\u7B80\u4ECB/\u7B7E\u540D\u3002","default-mpcard-signature-placeholder":"\u516C\u4F17\u53F7\u4ECB\u7ECD","default-mpcard-sync":"\u4E00\u952E\u540C\u6B65\u8D26\u53F7\u4FE1\u606F","default-mpcard-sync-success":"\u5DF2\u540C\u6B65\u9ED8\u8BA4\u516C\u4F17\u53F7\u540D\u7247\u3002","default-mpcard-sync-failed":"\u540C\u6B65\u516C\u4F17\u53F7\u540D\u7247\u5931\u8D25\u3002","default-mpcard-sync-partial":"\u4EC5\u540C\u6B65\u5230\u6635\u79F0\u4FE1\u606F\uFF0C\u8BF7\u624B\u52A8\u8865\u5145\u5934\u50CF/\u4ECB\u7ECD\u3002","test-connection":"\u6D4B\u8BD5\u8FDE\u63A5","choose-the-account-to-modify":"\u9009\u62E9\u8981\u4FEE\u6539\u7684\u8D26\u53F7","the-folder-where-your-custom-themes":"\u5B58\u50A8\u81EA\u5B9A\u4E49\u4E3B\u9898\u7684\u6587\u4EF6\u5939\u3002","themes-folder-path":"\u4E3B\u9898\u6587\u4EF6\u5939\u8DEF\u5F84","use-center-token-server":"\u4F7F\u7528\u4E2D\u5FC3\u4EE4\u724C\u670D\u52A1\u5668","wechat-account":"\u5FAE\u4FE1\u516C\u4F17\u53F7\u8D26\u53F7","you-should-add-this-ip-to-ip-whitelist-o":"\u8BF7\u5C06\u6B64IP\u6DFB\u52A0\u5230IP\u767D\u540D\u5355\u4E2D\u3002\u70B9\u51FB\u4E0B\u65B9\u8D26\u53F7\u4FE1\u606F\u4E2D\u7684\u56FE\u7247\u8BBF\u95EE\u201C\u5FAE\u4FE1\u516C\u4F17\u53F7\u5E73\u53F0\u201D\u8FDB\u884C\u8BBE\u7F6E\u3002","your-wechat-official-account":"\u60A8\u7684\u5FAE\u4FE1\u516C\u4F17\u53F7"},views:{"article-header":{"article-title":"\u6587\u7AE0\u6807\u9898","article-title-placeholder":"\u8F93\u5165\u6587\u7AE0\u6807\u9898",author:"\u4F5C\u8005","author-name":"\u4F5C\u8005\u540D\u79F0","comments-description":"\u8BC4\u8BBA\u9ED8\u8BA4\u5173\u95ED\u3002","cover-image":"\u5C01\u9762\u56FE\u7247","cover-image-description":"\u6587\u7AE0\u5FC5\u987B\u5305\u542B\u5C01\u9762\u56FE\u7247\u3002\u53EF\u4ECE\u672C\u5730\u4ED3\u5E93\u62D6\u653E\u56FE\u7247\u6216\u4F7F\u7528\u7F51\u7EDC\u56FE\u7247\u94FE\u63A5\u3002","cover-file-not-supported":"\u79FB\u52A8\u7AEF\u4E0D\u652F\u6301\u672C\u5730\u6587\u4EF6\u5C01\u9762\uFF0C\u8BF7\u4F7F\u7528\u4ED3\u5E93\u56FE\u7247\u6216\u7F51\u7EDC\u94FE\u63A5\u3002","cover-image-mobile-button":"\u9009\u62E9/\u4E0A\u4F20\u5C01\u9762","cover-image-mobile-title":"\u8BBE\u7F6E\u5C01\u9762\u56FE\u7247","cover-image-mobile-vault":"\u4ECE\u4ED3\u5E93\u9009\u62E9\u56FE\u7247","cover-image-mobile-vault-desc":"\u9009\u62E9\u4ED3\u5E93\u4E2D\u7684\u56FE\u7247\u8DEF\u5F84\u3002","cover-image-mobile-vault-placeholder":"\u8F93\u5165\u6216\u9009\u62E9\u56FE\u7247\u8DEF\u5F84","cover-image-mobile-url":"\u4F7F\u7528\u7F51\u7EDC\u56FE\u7247\u94FE\u63A5","cover-image-mobile-url-desc":"\u8F93\u5165\u56FE\u7247\u7684\u7F51\u7EDC\u94FE\u63A5\u3002","cover-image-mobile-required":"\u8BF7\u81F3\u5C11\u63D0\u4F9B\u4E00\u4E2A\u5C01\u9762\u56FE\u7247\u6765\u6E90\u3002","cover-image-mobile-invalid":"\u56FE\u7247\u8DEF\u5F84\u65E0\u6548\uFF0C\u8BF7\u68C0\u67E5\u540E\u518D\u8BD5\u3002","reset-cover-crop":"\u91CD\u7F6E\u88C1\u526A",digest:"\u6458\u8981","digest-text":"\u8F93\u5165\u6458\u8981\u6587\u672C","only-fans-can-comment":"\u4EC5\u7C89\u4E1D\u53EF\u8BC4\u8BBA","only-fans-can-comment-description":"\u9ED8\u8BA4\u6240\u6709\u4EBA\u90FD\u53EF\u8BC4\u8BBA","open-comments":"\u5F00\u542F\u8BC4\u8BBA","testing-button":"\u6D4B\u8BD5\u6309\u94AE",title:"\u6587\u7AE0\u5C5E\u6027"},"delete-draft":"\u5220\u9664\u8349\u7A3F","delete-image":"\u5220\u9664\u56FE\u7247","free-publish":"\u514D\u8D39\u53D1\u5E03","no-title-article":"\u65E0\u6807\u9898\u6587\u7AE0\u3002","other-type-has-not-been-implemented":"\u5176\u4ED6\u7C7B\u578B\u5C1A\u672A\u5B9E\u73B0\u3002","preview-draft":"\u9884\u89C8\u8349\u7A3F",previewer:{"article-copied-to-clipboard":"\u6587\u7AE0\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F\u3002","open-url-not-supported":"\u5F53\u524D\u5E73\u53F0\u4E0D\u652F\u6301\u6253\u5F00\u94FE\u63A5\u3002","article-render-failed":"\u6587\u7AE0\u6E32\u67D3\u5931\u8D25\u3002","article-title":"\u6587\u7AE0\u6807\u9898","copy-article-to-clipboard":"\u590D\u5236\u6587\u7AE0\u5230\u526A\u8D34\u677F","publish-config":"\u53D1\u5E03\u914D\u7F6E","generate-template":"\u751F\u6210\u516C\u4F17\u53F7\u6A21\u677F","file-not-found-path":"\u6587\u4EF6\u672A\u627E\u5230\uFF1A{0}","not-a-markdown-view":"\u4E0D\u662FMarkdown\u89C6\u56FE","please-set-cover-image":"\u8BF7\u8BBE\u7F6E\u5C01\u9762\u56FE\u7247\u3002","preview-draft-missing-id":"\u8BF7\u5148\u53D1\u9001\u5230\u8349\u7A3F\u7BB1\u518D\u9884\u89C8\u3002","preview-draft-missing-wxid":"\u8BF7\u5728\u53D1\u5E03\u914D\u7F6E\u4E2D\u586B\u5199\u8349\u7A3F\u9884\u89C8\u8005\u5FAE\u4FE1ID\u3002","preview-draft-sent":"\u9884\u89C8\u6D88\u606F\u5DF2\u53D1\u9001\u5230\u5FAE\u4FE1\u3002","render-article":"\u6E32\u67D3\u6587\u7AE0","send-article-to-draft-box":"\u53D1\u9001\u6587\u7AE0\u5230\u8349\u7A3F\u7BB1","template-created":"\u516C\u4F17\u53F7\u6A21\u677F\u5DF2\u751F\u6210\u3002","template-file-created":"\u5DF2\u521B\u5EFA\u6A21\u677F\u6587\u4EF6\uFF1Aone2mp-template.md","testing-button":"\u6D4B\u8BD5\u6309\u94AE","to-verify-the-images-in-article":"\u9A8C\u8BC1\u6587\u7AE0\u4E2D\u7684\u56FE\u7247","one2mp-previewer":"O2Any\u9884\u89C8\u5668"},"send-mass-message":"\u7FA4\u53D1\u6D88\u606F","theme-manager":{"default-theme":"\u9ED8\u8BA4\u4E3B\u9898","download-predefined-custom-themes":"\u4E0B\u8F7D\u5B9A\u5236\u4E3B\u9898","download-themes-mobile-not-supported":"\u79FB\u52A8\u7AEF\u6682\u4E0D\u652F\u6301\u4E3B\u9898\u4E0B\u8F7D\u3002","error-downloading-theme":"\u4E0B\u8F7D\u4E3B\u9898\u51FA\u9519","error-downloading-themes":"\u4E0B\u8F7D\u4E3B\u9898\u51FA\u9519\u3002","failed-to-fetch-themes-json-themesrespon":"\u83B7\u53D6themes.json\u5931\u8D25\uFF1A{0}","total-themes-length-themes-downloaded":"\u5171\u4E0B\u8F7D{0}\u4E2A\u4E3B\u9898\u3002","download-started":"\u5F00\u59CB\u4E0B\u8F7D\u4E3B\u9898\uFF0C\u8BF7\u7A0D\u5019\u2026","download-summary":"\u4E3B\u9898\u4E0B\u8F7D\u5B8C\u6210\uFF1A\u6210\u529F {0} \u4E2A\uFF0C\u5931\u8D25 {1} \u4E2A\uFF0C\u8DF3\u8FC7 {2} \u4E2A"},platform:{wechat:"\u516C\u4F17\u53F7",zhihu:"\u77E5\u4E4E",redbook:"\u5C0F\u7EA2\u4E66",halo:"Halo"},zhihu:{copy:"\u590D\u5236",open:"\u6253\u5F00\u77E5\u4E4E",refresh:"\u5237\u65B0",copied:"\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F\u3002"},halo:{publish:"\u53D1\u5E03\u5230 Halo","open-site":"\u6253\u5F00 Halo",hint:"\u53D1\u5E03\u4F1A\u5C06\u672C\u5730\u56FE\u7247\u4E0A\u4F20\u5230 Halo\uFF0C\u5E76\u66FF\u6362\u4E3A\u8FDC\u7A0B\u94FE\u63A5\u3002","missing-site":"\u8BF7\u5148\u5728\u8BBE\u7F6E\u4E2D\u914D\u7F6E Halo \u7AD9\u70B9\u3002","no-active-file":"\u672A\u627E\u5230\u53EF\u7F16\u8F91\u7684 Markdown \u6587\u4EF6\u3002",publishing:"\u6B63\u5728\u53D1\u5E03\u5230 Halo\u2026","publish-success":"Halo \u53D1\u5E03\u6210\u529F\u3002","publish-failed":"Halo \u53D1\u5E03\u5931\u8D25\u3002","attachment-not-configured":"Halo \u672A\u914D\u7F6E\u9644\u4EF6\u5B58\u50A8\u7B56\u7565\uFF0C\u8BF7\u5728\u540E\u53F0\u8BBE\u7F6E\u3002","attachment-permission":"Halo \u4EE4\u724C\u6743\u9650\u4E0D\u8DB3\uFF0C\u8BF7\u68C0\u67E5\u4E2A\u4EBA\u4EE4\u724C\u6743\u9650\u3002","attachment-failed":"Halo \u4E0A\u4F20\u9644\u4EF6\u5931\u8D25\u3002","site-mismatch":"\u5F53\u524D\u6587\u6863\u7ED1\u5B9A\u7684 Halo \u7AD9\u70B9\u4E0E\u6240\u9009\u7AD9\u70B9\u4E0D\u4E00\u81F4\u3002",ready:"\u51C6\u5907\u53D1\u5E03\u5230 {0}","current-site":"\u5F53\u524D\u7AD9\u70B9\uFF1A{0}"},redbook:{"cover-title":"\u5C0F\u7EA2\u4E66\u5C01\u9762\u56FE","cover-hint":"\u62D6\u62FD\u56FE\u7247\u5230\u8FD9\u91CC\u8BBE\u7F6E\u5C01\u9762\uFF0C\u5BFC\u51FA\u65F6\u4F1A\u653E\u5728\u7B2C\u4E00\u5F20\u3002","cover-empty":"\u672A\u8BBE\u7F6E\u5C0F\u7EA2\u4E66\u5C01\u9762\u3002",copy:"\u590D\u5236\u6587\u6848",export:"\u5BFC\u51FA\u7D20\u6750\u5305",open:"\u6253\u5F00\u5C0F\u7EA2\u4E66",refresh:"\u5237\u65B0",copied:"\u5C0F\u7EA2\u4E66\u6587\u6848\u5DF2\u590D\u5236\u3002",empty:"\u6CA1\u6709\u53EF\u590D\u5236\u7684\u6587\u6848\u3002","no-active-file":"\u672A\u627E\u5230\u53EF\u7F16\u8F91\u7684 Markdown \u6587\u4EF6\u3002"}},"wechat-api":{"add-ip-address-ipv4-0-to-wechat-mp-ip-wh":"\u5C06IP\u5730\u5740[{0}]\u6DFB\u52A0\u5230\u5FAE\u4FE1\u516C\u4F17\u53F7IP\u767D\u540D\u5355\u3002","failed-to-get-wechat-access-token":"\u83B7\u53D6\u5FAE\u4FE1access token\u5931\u8D25\u3002","image-size-exceeds-10m":"\u56FE\u7247\u5927\u5C0F\u8D85\u8FC710MB\u9650\u5236","video-size-exceeds-10m":"\u89C6\u9891\u5927\u5C0F\u8D85\u8FC710MB\u9650\u5236","voice-size-exceeds-2m":"\u8BED\u97F3\u5927\u5C0F\u8D85\u8FC72MB\u9650\u5236","select-an-wechat-mp-account-first":"\u8BF7\u5148\u9009\u62E9\u4E00\u4E2A\u5FAE\u4FE1\u516C\u4F17\u53F7\u8D26\u53F7\u3002","send-article-to-draft-box-successfully":"\u6587\u7AE0\u6210\u529F\u53D1\u9001\u5230\u8349\u7A3F\u7BB1\u3002","uploading-material-type":"\u4E0A\u4F20\u7D20\u6750\u7C7B\u578B\uFF1A{0}"}}});function u(d,t){let e=ce.t(d);if(t!==void 0)for(let n=0;n<t.length;n++)e=e.replace(`{${n}}`,t[n]);return e}var Vi,de=y(()=>{Hi();Vi=require("obsidian");Ni();Bi();ce.init({debug:!1,lng:Vi.moment.locale(),fallbackLng:"en",interpolation:{escapeValue:!1},resources:{en:{translation:zi},zh:{translation:ji}}}).catch(d=>{console.error("i18n init failed:",d)});window.$t=u});var Kt,pt,Wn=y(()=>{Kt=require("obsidian"),pt=class extends Kt.AbstractInputSuggest{constructor(e,n,i=[]){super(e,n);this.inputEl=n;this.extensions=i}getSuggestions(e){let n=e.toLowerCase();return this.app.vault.getAllLoadedFiles().filter(r=>r instanceof Kt.TFile).filter(r=>this.extensions.length&&!this.extensions.includes(r.extension)?!1:r.path.toLowerCase().includes(n))}renderSuggestion(e,n){n.setText(e.path)}selectSuggestion(e){this.inputEl.value=e.path,this.inputEl.trigger("input"),this.close()}}});var hs,Be,kt=y(()=>{hs=d=>{let t=d.trim();return t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")?t.slice(1,-1):t},Be=d=>{if(!d.startsWith("---"))return{data:{},content:d};let t=d.indexOf(`
---`,3);if(t===-1)return{data:{},content:d};let e=d.slice(3,t).trim(),i=d.slice(t+4).replace(/^\r?\n/,""),r={};if(e)for(let a of e.split(/\r?\n/)){let o=a.match(/^([^:#]+):\s*(.*)$/);if(!o)continue;let s=o[1].trim(),l=hs(o[2]);s&&(r[s]=l)}return{data:r,content:i}}});var qi,Wi=y(()=>{qi=`/* 00_one2mp.css 
	\u5B9A\u4E49one2mp\u7684\u57FA\u672C\u8272\u7CFB

*/
:root {
  /* \u4E3B\u8272\u7CFB */
  --one2mp-primary: #2c3e50;
  --one2mp-secondary: #3498db;
  --one2mp-accent: #e67e22;
  --one2mp-primary-light: #d0e4ff;
  
  /* \u4E2D\u6027\u8272 */
  --one2mp-bg: transparent;
  --one2mp-bg-alt: var(--one2mp-primary);
  --one2mp-text: #333333;
  --one2mp-text-color: var(--one2mp-text);
  --one2mp-text-alt: #ffffff;
  --one2mp-border:#999999;
  
  /* \u72B6\u6001\u8272 */
  --one2mp-success: #27ae60;
  --one2mp-success: #28a745;
  --one2mp-warning: #ff9800;
  --one2mp-error: #e74c3c;
  --one2mp-danger:  #dc3545;
  --one2mp-blue: #1e3a8a;
}	

:root {
	--one2mp-font-size: 16px;
	--one2mp-line-height: 1.8;
	--one2mp-text-indent: 0;
	--one2mp-letter-spacing: 0;
	--one2mp-word-spacing: 0;
	--one2mp-text-align: left;
	--one2mp-text-decoration: none;
	--one2mp-border-width: 1px;
	--one2mp-border-style: solid;
	--one2mp-border-radius: 4px;
	--one2mp-border-radius-sm: 2px;
	--one2mp-border-radius-lg: 6px;
	--one2mp-border-radius-xl: 8px;
}
body{
	font-size: var(--one2mp-font-size);
	line-height: var(--one2mp-line-height);
	text-indent: var(--one2mp-text-indent);
	letter-spacing: var(--one2mp-letter-spacing);
	word-spacing: var(--one2mp-word-spacing);
	text-align: var(--one2mp-text-align);
	text-decoration: var(--one2mp-text-decoration);
	border-width: var(--one2mp-border-width);
	border-style: var(--one2mp-border-style);
	border-radius: var(--one2mp-border-radius);
} 
`});var Ki,Gi=y(()=>{Ki=`/**
* \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u9875\u9762\u7248\u5F0F\u548C\u57FA\u672C\u5B57\u4F53\u98CE\u683C\u7684\u6837\u5F0F
*/

:root {
	/* page  layout */
	--article-max-width: none;
	--article-min-width: 200px;
	--article-padding: 0px;
	--article-margin: 0px;
	--article-background-color: var(--one2mp-bg);
	--article-background-image: none;
	--article-background-repeat: repeat;
	--article-background-size: auto;
	--article-background-position: left top;
	
}

.one2mp {
	max-width: var(--article-max-width);
	min-width: var(--article-min-width);
	padding: var(--article-padding);
	margin: var(--article-margin);
	background-color: var(--article-background-color);
	background-image: var(--article-background-image);
	background-repeat: var(--article-background-repeat);
	background-size: var(--article-background-size);
	background-position: var(--article-background-position);
	
}
`});var Zi,Ji=y(()=>{Zi=`/**
 * \u5B9A\u4E49icon,image \u7684\u57FA\u672C\u6837\u5F0F
 */
:root {
	/* --icon-pin: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='%23333' viewBox='0 0 24 24'%3E%3Cpath d='M12 0c.6 0 1 .4 1 1v7h1l2.4-4c.3-.6 1-.7 1.4-.4.5.3.7 1 .4 1.5L16 9l5 5v1h-7v7h-1l-5-5-3.9 2.6c-.5.3-1.1.2-1.4-.3-.3-.5-.2-1.1.3-1.4L8 13l-4-5.3c-.3-.5-.2-1.2.3-1.5.5-.3 1.2-.2 1.5.3L10 9V1c0-.6.4-1 1-1z'/%3E%3C/svg%3E"); */

	/* --icon-pencil: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 24 24'%3E%3Cpath d='M17.25 2.08a1.5 1.5 0 0 1 2.12 0l2.55 2.55a1.5 1.5 0 0 1 0 2.12l-2.34 2.34-4.67-4.67L17.25 2.08zM13.89 4.89l4.67 4.67L7.5 20.61H2v-5.5L13.89 4.89z'/%3E%3C/svg%3E"); */
	/* --icon-clip: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23333' viewBox='0 0 24 24'%3E%3Cpath d='M16.5 3.5a5.002 5.002 0 0 1 3.536 8.536L10.828 21.244a7 7 0 0 1-9.9-9.9L12.121.15a1 1 0 1 1 1.415 1.414L2.343 12.757a5 5 0 1 0 7.07 7.071l9.207-9.207a3 3 0 1 0-4.243-4.243L5.464 16.464a1 1 0 1 1-1.414-1.414L16.5 3.5z'/%3E%3C/svg%3E"); */
	/* --icon-book:   url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='none' viewBox='0 0 24 24'><rect x='3' y='3' width='14' height='18' rx='2' fill='%23F5F5F5' stroke='%23BDBDBD' stroke-width='1.5'/><line x1='6' y1='6' x2='14' y2='6' stroke='%239E9E9E' stroke-width='1'/><line x1='6' y1='9' x2='14' y2='9' stroke='%239E9E9E' stroke-width='1'/><line x1='6' y1='12' x2='14' y2='12' stroke='%239E9E9E' stroke-width='1'/><path d='M17.5 4.5L19.5 6.5L9 17L6 17L6 14L17.5 4.5Z' fill='%23FFEB3B' stroke='%23FBC02D' stroke-width='1'/><path d='M6 17L6.5 18L7.5 18.5L9 17H6Z' fill='%23795548'/><circle cx='18.5' cy='5.5' r='1' fill='%23E91E63'/></svg>"); */
	/* --bg-img-student: linear-gradient(transparent 29px, #ddd 30px), */




	--icon-pin: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 42'%3E%3Cpath fill='%23ff4444' d='M16 1C9 1 3 7 3 14c0 10 11 21 13 21s13-11 13-21c0-7-6-13-13-13zm0 20a7 7 0 1 1 0-14 7 7 0 0 1 0 14z'/%3E%3C/svg%3E");
	
}
`});var Xi,Yi=y(()=>{Xi=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u5B57\u4F53\u7248\u5F0F\u6837\u5F0F
 */
:root {

	/* typography */
	--article-font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji;
	--article-font-weight: 400;
	--article-word-break: break-word;
	--article-letter-space: 0px;
	--article-text-font-size: 15px;
	--article-text-color: var(--one2mp-text);
	--article-line-height: var(--one2mp-line-height);
	--article-text-align: left;
	--article-text-indent: 0;
	--article-font-style: normal;
}

.one2mp {
	font-family: var(--article-font-family);
	font-weight: var(--article-font-weight);
	word-break: var(--article-word-break);
	letter-spacing: var(--article-letter-space);
	color: var(--article-text-color);
	font-size: var(--article-text-font-size);
	line-height: var(--article-line-height);
	text-align: var(--article-text-align);
	text-indent: var(--article-text-indent);
	font-style: var(--article-font-style); 
}

`});var er,Qi=y(()=>{er=`/**
* \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u6B63\u6587\u6837\u5F0F
*/

:root {
	--paragraph-font-family: var(--article-font-family);
	--paragraph-font-weight: var(--article-font-weight);
	--paragraph-font-size: var(--article-text-font-size);
	--paragraph-word-break: var(--article-word-break);
	--paragraph-text-color: var(--article-text-color);
	--paragraph-letter-space: var(--article-letter-space);
	--paragraph-line-height: var(--article-line-height);
	--paragraph-text-align: var(--article-text-align);
	--paragraph-text-indent: var(--article-text-indent);
	--paragraph-font-style: var(--article-font-style);
	--paragraph-margin: var(--article-margin);
}

.one2mp > p {
	font-family: var(--paragraph-font-family);
	font-weight: var(--paragraph-font-weight);
	font-size: var(--paragraph-font-size);
	color: var(--paragraph-text-color);
	word-break: var(--paragraph-word-break);
	letter-spacing: var(--paragraph-letter-space);
	line-height: var(--paragraph-line-height);
	text-align: var(--paragraph-text-align);
	text-indent: var(--paragraph-text-indent);
	font-style: var(--paragraph-font-style);
	margin: var(--paragraph-margin);
}
`});var nr,tr=y(()=>{nr=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u4FEE\u9970\u6027\u6587\u5B57\u7684\u98CE\u683C\uFF1A
 - \u7C97\u4F53

 */
:root {
	--strong-font-family: var(--article-font-family);
	--strong-font-weight: 600;
	--strong-font-style: bold;
	--strong-font-size: var(--article-text-font-size);
	--strong-line-height: var(--article-line-height);
	--strong-letter-spacing: var(--article-letter-space);
	--strong-text-align: var(--article-text-align);
	--strong-text-indent: var(--article-text-indent);
	--strong-color: var(--one2mp-primary);
}

.one2mp strong {
	font-family: var(--strong-font-family);
	font-weight: var(--strong-font-weight);
	font-size: var(--strong-font-size);
	line-height: var(--strong-line-height);
	letter-spacing: var(--strong-letter-spacing);
	text-align: var(--strong-text-align);
	text-indent: var(--strong-text-indent);
	color: var(--strong-color);
}
`});var rr,ir=y(()=>{rr=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u4FEE\u9970\u6027\u6587\u5B57\u7684\u98CE\u683C\uFF1A
 - \u659C\u4F53
 - 

 */
:root {
	--em-font-family: var(--article-font-family);
	--em-font-weight: var(--article-font-weight);
	--em-font-size: var(--article-text-font-size);
	--em-line-height: var(--article-line-height);
	--em-letter-spacing: var(--article-letter-space);
	--em-text-align: var(--article-text-align);
	--em-text-indent: var(--article-text-indent);
	--em-color: var(--article-text-color);
	--em-font-style: italic;
	
}

.one2mp em {
	font-family: var(--em-font-family);
	font-weight: var(--em-font-weight);
	font-size: var(--em-font-size);
	line-height: var(--em-line-height);
	letter-spacing: var(--em-letter-spacing);
	text-align: var(--em-text-align);
	text-indent: var(--em-text-indent);
	color: var(--em-color);
	font-style: var(--em-font-style);
}
`});var or,ar=y(()=>{or=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u4FEE\u9970\u6027\u6587\u5B57\u7684\u98CE\u683C\uFF1A
 - \u659C\u4F53
 - 

 */
:root {
	--u-font-family: var(--article-font-family);
	--u-font-weight: var(--article-font-weight);
	--u-font-size: var(--article-text-font-size);
	--u-line-height: var(--article-line-height);
	--u-letter-spacing: var(--article-letter-space);
	--u-text-align: var(--article-text-align);
	--u-text-indent: var(--article-text-indent);
	--u-color: var(--article-text-color);
	--u-font-style: normal;
	--u-text-decoration: underline;
	--u-text-decoration-thickness: 1px;
	--u-text-decoration-style: solid;
	--u-text-decoration-color: var(--article-text-color);
	--u-underline-offset: 0.2em;
}

.one2mp u {
	font-family: var(--u-font-family);
	font-weight: var(--u-font-weight);
	font-size: var(--u-font-size);
	line-height: var(--u-line-height);
	letter-spacing: var(--u-letter-spacing);
	text-align: var(--u-text-align);
	text-indent: var(--u-text-indent);
	color: var(--u-color);
	font-style: var(--u-font-style);
	text-decoration:  var(--u-text-decoration);
	text-decoration-thickness: var(--u-text-decoration-thickness);
	text-decoration-style: var(--u-text-decoration-style);
	text-decoration-color: var(--u-text-decoration-color);
	text-underline-offset: var(--u-underline-offset)
}
`});var lr,sr=y(()=>{lr=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u7684\u4FEE\u9970\u6027\u6587\u5B57\u7684\u98CE\u683C\uFF1A
 - \u659C\u4F53
 - 

 */
:root {
	--del-font-family: var(--article-font-family);
	--del-font-weight: var(--article-font-weight);
	--del-font-size: var(--article-text-font-size);
	--del-line-height: var(--article-line-height);
	--del-letter-spacing: var(--article-letter-space);
	--del-text-align: var(--article-text-align);
	--del-text-indent: var(--article-text-indent);
	--del-color: var(--article-text-color);
	--del-font-style: normal;
	--del-text-decoration: line-through;
	--del-text-decoration-thickness: 1px;
	--del-text-decoration-style: solid;
	--del-text-decoration-color: var(--article-text-color);
}

.one2mp del {
	font-family: var(--del-font-family);
	font-weight: var(--del-font-weight);
	font-size: var(--del-font-size);
	line-height: var(--del-line-height);
	letter-spacing: var(--del-letter-spacing);
	text-align: var(--del-text-align);
	text-indent: var(--del-text-indent);
	color: var(--del-color);
	font-style: var(--del-font-style);
	text-decoration:  var(--del-text-decoration);
	text-decoration-thickness: var(--del-text-decoration-thickness);
	text-decoration-style: var(--del-text-decoration-style);
	text-decoration-color: var(--del-text-decoration-color);
}
`});var qn,cr=y(()=>{qn=`:root{
	--codespan-color: #e5c07b;
	--codespan-background-color: #282c34;
	--codespan-padding: 2px 4px;
	--codespan-border-radius: 4px;
	--codespan-font-size: 0.9rem;
	--codespan-font-family: "Fira Code", "Fira Mono", "Source Code Pro", "Roboto Mono", monospace;
	--codespan-font-weight: 500;
}

.one2mp .one2mp-codespan {
	color: var(--codespan-color, #e5c07b);
	background-color: var(--codespan-background-color, #282c34);
	padding: var(--codespan-padding, 2px);
	border-radius: var(--codespan-border-radius, 4px);
	font-size: var(--codespan-font-size, 0.9rem);
	font-family: var(--codespan-font-family, "Fira Code", "Fira Mono", "Source Code Pro", "Roboto Mono", monospace);
	font-weight: var(--codespan-font-weight, 500);

}
`});var pr,dr=y(()=>{pr=`/**
 * \u5B9A\u4E49\u5FAE\u4FE1\u6587\u7AE0\u6807\u9898\u7684\u57FA\u672C\u6837\u5F0F
 */

:root {
	--heading-font-family: var(--article-font-family);
	--heading-font-weight: 600;
	--heading-color: var(--article-text-color);
	--heading-line-height: 1.5;
	--heading-letter-spacing: var(--article-letter-space);
	--heading-text-align: var(--article-text-align);
	--heading-font-style: normal;
	--heading-margin: 1rem 0;
	--heading-text-decoration-style: none;
	--heading-text-decoration-thickness: 0;
	--heading-text-decoration-color: transparent; 
	--heading-radius: var(--one2mp-radius);
	--heading-border-bottom-width: 0;
	--heading-border-bottom-style: none;
	--heading-border-bottom-color: transparent;
	--heading-padding: 0;
	--heading-display: flex;
	--heading-tail-display: none;
	--heading-tail-content: " ";
	--heading-tail-shadow-color: rgb(239, 235, 233);
	--heading-tail-shadow-height: 0;
	--heading-tail-shadow-width: 0;
	
}

/* \u6807\u9898 */
.one2mp h1,
.one2mp h2,
.one2mp h3,
.one2mp h4,
.one2mp h5,
.one2mp h6 {
	font-family: var(--heading-font-family);
	font-weight: var(--heading-font-weight);
	color: var(--heading-color);
	line-height: var(--heading-line-height);
	letter-spacing: var(--heading-letter-spacing);
	text-align: var(--heading-text-align);
	font-style: var(--heading-font-style);
	margin: var(--heading-margin);
	text-decoration-style: var(--heading-text-decoration-style);
	text-decoration-thickness: var(--heading-text-decoration-thickness);
	text-decoration-color: var(--heading-text-decoration-color);
	display: var(--heading-display);
}

.one2mp .one2mp-heading-prefix {
	display: none;
}
.one2mp .one2mp-heading-outbox {
	display: block;
}
.one2mp .one2mp-heading-leaf {
	display: block;
}
.one2mp .one2mp-heading-tail {
	display: none;
}
`});var ur,hr=y(()=>{ur=`/**
h1  \u6807\u9898
*/

:root {

	--h1-font-family: var(--heading-font-family);
	--h1-font-weight: var(--heading-font-weight);
	--h1-color: var(--heading-color);
	--h1-font-size: 2.2rem;
	--h1-line-height: var(--heading-line-height);
	--h1-letter-spacing: var(--heading-letter-spacing);
	--h1-text-align: var(--heading-text-align);
	--h1-font-style: var(--heading-font-style);
	--h1-text-decoration-style: var(--heading-text-decoration-style);
	--h1-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h1-text-decoration-color: var(--heading-text-decoration-color);
	--h1-margin: var(--heading-margin);
	/* --h1-bg: var(--one2mp-primary); */
	--h1-bg: var(--one2mp-bg);
	--h1-border-bottom-width: var(--heading-border-bottom-width);
	/* --h1-border-bottom-color: var(--h1-bg); */
	--h1-border-bottom-color: var(--heading-border-bottom-color);
	--h1-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h1-prefix-display: none;
	--h1-prefix-color: var(--h1-color);
	--h1-font-style: normal;
	--h1-text-align: var(--h1-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h1-outbox-display: block;
	--h1-outbox-radius: var(--one2mp-border-radius);
	--h1-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h1-leaf-display: block;
	--h1-leaf-padding: var(--heading-padding);
	--h1-leaf-color: var(--h1-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h1-tail-display: inline-block; */
	--h1-tail-display: none;
	--h1-tail-content: " ";
	--h1-tail-vertical-align: bottom;
	--h1-tail-display: var(--heading-tail-display);
	--h1-tail-content: var(--heading-tail-content);
	--h1-tail-shadow-color: var(--heading-tail-shadow-color);
	--h1-tail-shadow-height: var(--heading-tail-shadow-height);
	--h1-tail-shadow-width: var(--heading-tail-shadow-width);
	--h1-display: flex;
}

.one2mp h1 {
	font-family: var(--h1-font-family);
	font-weight: var(--h1-font-weight);
	font-size: var(--h1-font-size);
	line-height: var(--h1-line-height);
	letter-spacing: var(--h1-letter-spacing);
	text-align: var(--h1-text-align);
	color: var(--h1-color);
	font-style: var(--h1-font-style);
	text-decoration-style: var(--h1-text-decoration-style);
	text-decoration-thickness: var(--h1-text-decoration-thickness);
	text-decoration-color: var(--h1-text-decoration-color);
	margin: var(--h1-margin);
	border-bottom-width: var(--h1-border-bottom-width);
	border-bottom-style: var(--h1-border-bottom-style);
	border-bottom-color: var(--h1-border-bottom-color);
	display: var(--h1-display);
}


.one2mp h1 .one2mp-heading-prefix {
	display: var(--h1-prefix-display);
	color: var(--h1-prefix-color);
	font-style: var(--h1-font-style);
	text-align: var(--h1-text-align);

}

.one2mp h1 .one2mp-heading-outbox {
	border-top-right-radius: var(--h1-outbox-radius);
	border-top-left-radius: var(--h1-outbox-radius);
	background-color: var(--h1-bg);
	padding: var(--h1-outbox-padding);
	display: block;
}

.one2mp h1 .one2mp-heading-leaf {
	padding-left: var(--h1-leaf-padding);
	padding-right: var(--h1-leaf-padding);
	font-weight: var(--h1-font-weight);
	display: var(--h1-leaf-display);
	color: var(--h1-leaf-color)
}

.one2mp h1 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h1-tail-display);
	content: var(--h1-tail-content);
	vertical-align: var(--h1-tail-vertical-align);
	border-bottom: var(--h1-tail-shadow-height) solid var(--h1-tail-shadow-color);
	border-right: var(--h1-tail-shadow-width) solid transparent;

}
`});var mr,gr=y(()=>{mr=`/**
h2  \u6807\u9898
*/

:root {
	--h2-font-family: var(--heading-font-family);
	--h2-font-weight: var(--heading-font-weight);
	--h2-color: var(--heading-color);
	--h2-font-size: 2rem;
	--h2-line-height: var(--heading-line-height);
	--h2-letter-spacing: var(--heading-letter-spacing);
	--h2-text-align: var(--heading-text-align);
	--h2-font-style: var(--heading-font-style);
	--h2-text-decoration-style: var(--heading-text-decoration-style);
	--h2-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h2-text-decoration-color: var(--heading-text-decoration-color);
	--h2-margin: var(--heading-margin);
	/* --h2-bg: var(--one2mp-primary); */
	--h2-bg: var(--one2mp-bg);
	--h2-border-bottom-width: var(--heading-border-bottom-width);
	/* --h2-border-bottom-color: var(--h2-bg); */
	--h2-border-bottom-color: var(--heading-border-bottom-color);
	--h2-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h2-prefix-display: none;
	--h2-prefix-color: var(--h2-color);
	--h2-font-style: normal;
	--h2-text-align: var(--h2-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h2-outbox-display: block;
	--h2-outbox-radius: var(--one2mp-border-radius);
	--h2-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h2-leaf-display: block;
	--h2-leaf-padding: var(--heading-padding);
	--h2-leaf-color: var(--h2-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h2-tail-display: inline-block; */
	--h2-tail-display: none;
	--h2-tail-content: " ";
	--h2-tail-vertical-align: bottom;
	--h2-tail-display: var(--heading-tail-display);
	--h2-tail-content: var(--heading-tail-content);
	--h2-tail-shadow-color: var(--heading-tail-shadow-color);
	--h2-tail-shadow-height: var(--heading-tail-shadow-height);
	--h2-tail-shadow-width: var(--heading-tail-shadow-width);
	--h2-display: flex;
}
.one2mp h2 {
	font-family: var(--h2-font-family);
	font-weight: var(--h2-font-weight);
	font-size: var(--h2-font-size);
	line-height: var(--h2-line-height);
	letter-spacing: var(--h2-letter-spacing);
	text-align: var(--h2-text-align);
	color: var(--h2-color);
	font-style: var(--h2-font-style);
	text-decoration-style: var(--h2-text-decoration-style);
	text-decoration-thickness: var(--h2-text-decoration-thickness);
	text-decoration-color: var(--h2-text-decoration-color);
	margin: var(--h2-margin);
	border-bottom-width: var(--h2-border-bottom-width);
	border-bottom-style: var(--h2-border-bottom-style);
	border-bottom-color: var(--h2-border-bottom-color);
	display: var(--h2-display);
}


.one2mp h2 .one2mp-heading-prefix {
	display: var(--h2-prefix-display);
	color: var(--h2-prefix-color);
	font-style: var(--h2-font-style);
	text-align: var(--h2-text-align);

}
.one2mp h2 .one2mp-heading-outbox {
	border-top-right-radius: var(--h2-outbox-radius);
	border-top-left-radius: var(--h2-outbox-radius);
	background-color: var(--h2-bg);
	padding: var(--h2-outbox-padding);
	display: block;
}
.one2mp h2 .one2mp-heading-leaf {
	padding-left: var(--h2-leaf-padding);
	padding-right: var(--h2-leaf-padding);
	font-weight:  var(--h2-font-weight);
	display: var(--h2-leaf-display);
	color: var(--h2-leaf-color)
}
.one2mp h2 .one2mp-heading-tail {
	box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
    text-rendering: optimizelegibility;
    display: var(--h2-tail-display);
    content: var(--h2-tail-content);
    vertical-align: var(--h2-tail-vertical-align);
	border-bottom: var(--h2-tail-shadow-height) solid var(--h2-tail-shadow-color);
	border-right: var(--h2-tail-shadow-width) solid transparent;
}
`});var vr,fr=y(()=>{vr=`/**
h3  \u6807\u9898
*/

:root {
	--h3-font-family: var(--heading-font-family);
	--h3-font-weight: var(--heading-font-weight);
	--h3-color: var(--heading-color);
	--h3-font-size: 1.8rem;
	--h3-line-height: var(--heading-line-height);
	--h3-letter-spacing: var(--heading-letter-spacing);
	--h3-text-align: var(--heading-text-align);
	--h3-font-style: var(--heading-font-style);
	--h3-text-decoration-style: var(--heading-text-decoration-style);
	--h3-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h3-text-decoration-color: var(--heading-text-decoration-color);
	--h3-margin: var(--heading-margin);
	/* --h3-bg: var(--one2mp-primary); */
	--h3-bg: var(--one2mp-bg);
	--h3-border-bottom-width: var(--heading-border-bottom-width);
	/* --h3-border-bottom-color: var(--h3-bg); */
	--h3-border-bottom-color: var(--heading-border-bottom-color);
	--h3-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h3-prefix-display: none;
	--h3-prefix-color: var(--h3-color);
	--h3-font-style: normal;
	--h3-text-align: var(--h3-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h3-outbox-display: block;
	--h3-outbox-radius: var(--one2mp-border-radius);
	--h3-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h3-leaf-display: block;
	--h3-leaf-padding: var(--heading-padding);
	--h3-leaf-color: var(--h3-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h3-tail-display: inline-block; */
	--h3-tail-display: none;
	--h3-tail-content: " ";
	--h3-tail-vertical-align: bottom;
	--h3-tail-display: var(--heading-tail-display);
	--h3-tail-content: var(--heading-tail-content);
	--h3-tail-shadow-color: var(--heading-tail-shadow-color);
	--h3-tail-shadow-height: var(--heading-tail-shadow-height);
	--h3-tail-shadow-width: var(--heading-tail-shadow-width);
	--h3-display: flex;
}

.one2mp h3 {
	font-family: var(--h3-font-family);
	font-weight: var(--h3-font-weight);
	font-size: var(--h3-font-size);
	line-height: var(--h3-line-height);
	letter-spacing: var(--h3-letter-spacing);
	text-align: var(--h3-text-align);
	color: var(--h3-color);
	font-style: var(--h3-font-style);
	text-decoration-style: var(--h3-text-decoration-style);
	text-decoration-thickness: var(--h3-text-decoration-thickness);
	text-decoration-color: var(--h3-text-decoration-color);
	margin: var(--h3-margin);
	border-bottom-width: var(--h3-border-bottom-width);
	border-bottom-style: var(--h3-border-bottom-style);
	border-bottom-color: var(--h3-border-bottom-color);
	display: var(--h3-display);
}


.one2mp h3 .one2mp-heading-prefix {
	display: var(--h3-prefix-display);
	color: var(--h3-prefix-color);
	font-style: var(--h3-font-style);
	text-align: var(--h3-text-align);

}

.one2mp h3 .one2mp-heading-outbox {
	border-top-right-radius: var(--h3-outbox-radius);
	border-top-left-radius: var(--h3-outbox-radius);
	background-color: var(--h3-bg);
	padding: var(--h3-outbox-padding);
	display: block;
}

.one2mp h3 .one2mp-heading-leaf {
	padding-left: var(--h3-leaf-padding);
	padding-right: var(--h3-leaf-padding);
	font-weight: var(--h3-font-weight);
	display: var(--h3-leaf-display);
	color: var(--h3-leaf-color)
}

.one2mp h3 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h3-tail-display);
	content: var(--h3-tail-content);
	vertical-align: var(--h3-tail-vertical-align);
	border-bottom: var(--h3-tail-shadow-height) solid var(--h3-tail-shadow-color);
	border-right: var(--h3-tail-shadow-width) solid transparent;
}
`});var wr,br=y(()=>{wr=`/**
h4  \u6807\u9898
*/

:root {
	--h4-font-family: var(--heading-font-family);
	--h4-font-weight: var(--heading-font-weight);
	--h4-color: var(--heading-color);
	--h4-font-size: 1.5rem;
	--h4-line-height: var(--heading-line-height);
	--h4-letter-spacing: var(--heading-letter-spacing);
	--h4-text-align: var(--heading-text-align);
	--h4-font-style: var(--heading-font-style);
	--h4-text-decoration-style: var(--heading-text-decoration-style);
	--h4-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h4-text-decoration-color: var(--heading-text-decoration-color);
	--h4-margin: var(--heading-margin);
	/* --h4-bg: var(--one2mp-primary); */
	--h4-bg: var(--one2mp-bg);
	--h4-border-bottom-width: var(--heading-border-bottom-width);
	/* --h4-border-bottom-color: var(--h4-bg); */
	--h4-border-bottom-color: var(--heading-border-bottom-color);
	--h4-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h4-prefix-display: none;
	--h4-prefix-color: var(--h4-color);
	--h4-font-style: normal;
	--h4-text-align: var(--h4-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h4-outbox-display: block;
	--h4-outbox-radius: var(--one2mp-border-radius);
	--h4-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h4-leaf-display: block;
	--h4-leaf-padding: var(--heading-padding);
	--h4-leaf-color: var(--h4-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h4-tail-display: inline-block; */
	--h4-tail-display: none;
	--h4-tail-content: " ";
	--h4-tail-vertical-align: bottom;
	--h4-tail-display: var(--heading-tail-display);
	--h4-tail-content: var(--heading-tail-content);
	--h4-tail-shadow-color: var(--heading-tail-shadow-color);
	--h4-tail-shadow-height: var(--heading-tail-shadow-height);
	--h4-tail-shadow-width: var(--heading-tail-shadow-width);
	--h4-display: flex;
}


.one2mp h4 {
	font-family: var(--h4-font-family);
	font-weight: var(--h4-font-weight);
	font-size: var(--h4-font-size);
	line-height: var(--h4-line-height);
	letter-spacing: var(--h4-letter-spacing);
	text-align: var(--h4-text-align);
	color: var(--h4-color);
	font-style: var(--h4-font-style);
	text-decoration-style: var(--h4-text-decoration-style);
	text-decoration-thickness: var(--h4-text-decoration-thickness);
	text-decoration-color: var(--h4-text-decoration-color);
	margin: var(--h4-margin);
	border-bottom-width: var(--h4-border-bottom-width);
	border-bottom-style: var(--h4-border-bottom-style);
	border-bottom-color: var(--h4-border-bottom-color);
	display: var(--h4-display);
}


.one2mp h4 .one2mp-heading-prefix {
	display: var(--h4-prefix-display);
	color: var(--h4-prefix-color);
	font-style: var(--h4-font-style);
	text-align: var(--h4-text-align);

}

.one2mp h4 .one2mp-heading-outbox {
	border-top-right-radius: var(--h4-outbox-radius);
	border-top-left-radius: var(--h4-outbox-radius);
	background-color: var(--h4-bg);
	padding: var(--h4-outbox-padding);
	display: block;
}

.one2mp h4 .one2mp-heading-leaf {
	padding-left: var(--h4-leaf-padding);
	padding-right: var(--h4-leaf-padding);
	font-weight: var(--h4-font-weight);
	display: var(--h4-leaf-display);
	color: var(--h4-leaf-color)
}

.one2mp h4 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h4-tail-display);
	content: var(--h4-tail-content);
	vertical-align: var(--h4-tail-vertical-align);
	border-bottom: var(--h4-tail-shadow-height) solid var(--h4-tail-shadow-color);
	border-right: var(--h4-tail-shadow-width) solid transparent;
}
`});var yr,xr=y(()=>{yr=`/**
h5  \u6807\u9898
*/

:root {
	--h5-font-family: var(--heading-font-family);
	--h5-font-weight: var(--heading-font-weight);
	--h5-color: var(--heading-color);
	--h5-font-size: 1.2rem;
	--h5-line-height: var(--heading-line-height);
	--h5-letter-spacing: var(--heading-letter-spacing);
	--h5-text-align: var(--heading-text-align);
	--h5-font-style: var(--heading-font-style);
	--h5-text-decoration-style: var(--heading-text-decoration-style);
	--h5-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h5-text-decoration-color: var(--heading-text-decoration-color);
	--h5-margin: var(--heading-margin);
	/* --h5-bg: var(--one2mp-primary); */
	--h5-bg: var(--one2mp-bg);
	--h5-border-bottom-width: var(--heading-border-bottom-width);
	/* --h5-border-bottom-color: var(--h5-bg); */
	--h5-border-bottom-color: var(--heading-border-bottom-color);
	--h5-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h5-prefix-display: none;
	--h5-prefix-color: var(--h5-color);
	--h5-font-style: normal;
	--h5-text-align: var(--h5-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h5-outbox-display: block;
	--h5-outbox-radius: var(--one2mp-border-radius);
	--h5-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h5-leaf-display: block;
	--h5-leaf-padding: var(--heading-padding);
	--h5-leaf-color: var(--h5-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h5-tail-display: inline-block; */
	--h5-tail-display: none;
	--h5-tail-content: " ";
	--h5-tail-vertical-align: bottom;
	--h5-tail-display: var(--heading-tail-display);
	--h5-tail-content: var(--heading-tail-content);
	--h5-tail-shadow-color: var(--heading-tail-shadow-color);
	--h5-tail-shadow-height: var(--heading-tail-shadow-height);
	--h5-tail-shadow-width: var(--heading-tail-shadow-width);
	--h5-display: flex;
}

.one2mp h5 {
	font-family: var(--h5-font-family);
	font-weight: var(--h5-font-weight);
	font-size: var(--h5-font-size);
	line-height: var(--h5-line-height);
	letter-spacing: var(--h5-letter-spacing);
	text-align: var(--h5-text-align);
	color: var(--h5-color);
	font-style: var(--h5-font-style);
	text-decoration-style: var(--h5-text-decoration-style);
	text-decoration-thickness: var(--h5-text-decoration-thickness);
	text-decoration-color: var(--h5-text-decoration-color);
	margin: var(--h5-margin);
	border-bottom-width: var(--h5-border-bottom-width);
	border-bottom-style: var(--h5-border-bottom-style);
	border-bottom-color: var(--h5-border-bottom-color);
	display: var(--h5-display);
}


.one2mp h5 .one2mp-heading-prefix {
	display: var(--h5-prefix-display);
	color: var(--h5-prefix-color);
	font-style: var(--h5-font-style);
	text-align: var(--h5-text-align);

}

.one2mp h5 .one2mp-heading-outbox {
	border-top-right-radius: var(--h5-outbox-radius);
	border-top-left-radius: var(--h5-outbox-radius);
	background-color: var(--h5-bg);
	padding: var(--h5-outbox-padding);
	display: block;
}

.one2mp h5 .one2mp-heading-leaf {
	padding-left: var(--h5-leaf-padding);
	padding-right: var(--h5-leaf-padding);
	font-weight: var(--h5-font-weight);
	display: var(--h5-leaf-display);
	color: var(--h5-leaf-color)
}

.one2mp h5 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h5-tail-display);
	content: var(--h5-tail-content);
	vertical-align: var(--h5-tail-vertical-align);
	border-bottom: var(--h5-tail-shadow-height) solid var(--h5-tail-shadow-color);
	border-right: var(--h5-tail-shadow-width) solid transparent;
}
`});var Sr,kr=y(()=>{Sr=`/**
h6  \u6807\u9898
*/

:root {
	--h6-font-family: var(--heading-font-family);
	--h6-font-weight: var(--heading-font-weight);
	--h6-color: var(--heading-color);
	--h6-font-size: 1rem;
	--h6-line-height: var(--heading-line-height);
	--h6-letter-spacing: var(--heading-letter-spacing);
	--h6-text-align: var(--heading-text-align);
	--h6-font-style: var(--heading-font-style);
	--h6-text-decoration-style: var(--heading-text-decoration-style);
	--h6-text-decoration-thickness: var(--heading-text-decoration-thickness);
	--h6-text-decoration-color: var(--heading-text-decoration-color);
	--h6-margin: var(--heading-margin);
	/* --h6-bg: var(--one2mp-primary); */
	--h6-bg: var(--one2mp-bg);
	--h6-border-bottom-width: var(--heading-border-bottom-width);
	/* --h6-border-bottom-color: var(--h6-bg); */
	--h6-border-bottom-color: var(--heading-border-bottom-color);
	--h6-border-bottom-style: var(--heading-border-bottom-style);
	/*  \u6807\u9898\u524D\u7F00 */
	--h6-prefix-display: none;
	--h6-prefix-color: var(--h6-color);
	--h6-font-style: normal;
	--h6-text-align: var(--h6-text-align);
	/*  \u6807\u9898\u4E3B\u4F53 */
	--h6-outbox-display: block;
	--h6-outbox-radius: var(--one2mp-border-radius);
	--h6-outbox-padding: var(--heading-padding);
	/*  \u6807\u9898\u53F6\u5B50 */
	--h6-leaf-display: block;
	--h6-leaf-padding: var(--heading-padding);
	--h6-leaf-color: var(--h6-color);
	/*  \u6807\u9898\u540E\u7F00 */
	/* --h6-tail-display: inline-block; */
	--h6-tail-display: none;
	--h6-tail-content: " ";
	--h6-tail-vertical-align: bottom;
	--h6-tail-display: var(--heading-tail-display);
	--h6-tail-content: var(--heading-tail-content);
	--h6-tail-shadow-color: var(--heading-tail-shadow-color);
	--h6-tail-shadow-height: var(--heading-tail-shadow-height);
	--h6-tail-shadow-width: var(--heading-tail-shadow-width);
	--h6-display: flex;
}

.one2mp h6 {
	font-family: var(--h6-font-family);
	font-weight: var(--h6-font-weight);
	font-size: var(--h6-font-size);
	line-height: var(--h6-line-height);
	letter-spacing: var(--h6-letter-spacing);
	text-align: var(--h6-text-align);
	color: var(--h6-color);
	font-style: var(--h6-font-style);
	text-decoration-style: var(--h6-text-decoration-style);
	text-decoration-thickness: var(--h6-text-decoration-thickness);
	text-decoration-color: var(--h6-text-decoration-color);
	margin: var(--h6-margin);
	border-bottom-width: var(--h6-border-bottom-width);
	border-bottom-style: var(--h6-border-bottom-style);
	border-bottom-color: var(--h6-border-bottom-color);
	display: var(--h6-display);
}


.one2mp h6 .one2mp-heading-prefix {
	display: var(--h6-prefix-display);
	color: var(--h6-prefix-color);
	font-style: var(--h6-font-style);
	text-align: var(--h6-text-align);

}

.one2mp h6 .one2mp-heading-outbox {
	border-top-right-radius: var(--h6-outbox-radius);
	border-top-left-radius: var(--h6-outbox-radius);
	background-color: var(--h6-bg);
	padding: var(--h6-outbox-padding);
	display: block;
}

.one2mp h6 .one2mp-heading-leaf {
	padding-left: var(--h6-leaf-padding);
	padding-right: var(--h6-leaf-padding);
	font-weight: var(--h6-font-weight);
	display: var(--h6-leaf-display);
	color: var(--h6-leaf-color)
}

.one2mp h6 .one2mp-heading-tail {
	box-sizing: border-box;
	-webkit-font-smoothing: antialiased;
	text-rendering: optimizelegibility;
	display: var(--h6-tail-display);
	content: var(--h6-tail-content);
	vertical-align: var(--h6-tail-vertical-align);
	border-bottom: var(--h6-tail-shadow-height) solid var(--h6-tail-shadow-color);
	border-right: var(--h6-tail-shadow-width) solid transparent;
}
`});var Pr,Cr=y(()=>{Pr=`:root {
	--image-border-radius: var(--one2mp-border-radius);
	--image-border-width: 0px;
	--image-border-color: transparent;
	--image-border-style: solid;
	--image-frame-padding: 0px;
	--image-caption-triangle: hidden;
	--image-caption-triangle-width: 0rem;
	--image-caption-margin-top: -1rem;
	--image-caption-text-color: var(--one2mp-text-color);
	--image-cation-font-size: 0.8rem;
	--image-caption-font-weight: normal;
	--image-caption-font-style: normal;
	--image-caption-font-family: var(--article-font-family);
	--image-caption-line-height: 1.5;
	--image-caption-text-align: center;
}

.one2mp img:not(.one2mp-profile-card img) {
	border-radius: var(--image-border-radius);
	border-width: var(--image-border-width); 
	border-style: var(--image-border-style);
	border-color: var(--image-border-color);
	box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
	margin: 0.0 0;
}

.image-with-caption {
	position: relative;
	display: inline-block;
	text-align: center;
	/* \u9ED8\u8BA4\u5C45\u4E2D\uFF0C\u53EF\u901A\u8FC7\u7C7B\u63A7\u5236 */
	font-family: "Arial", sans-serif;
	border-radius: var(--image-border-radius);
	border-width: var(--image-border-width); 
	border-style: var(--image-border-style);
	border-color: var(--image-border-color);
	box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
	padding: var(--image-frame-padding);
	margin: 0;
}

.image-with-caption img {
	max-width: 100%;
	height: auto;
	display: block;
}

/* \u5BF9\u9F50\u65B9\u5F0F\u63A7\u5236 */
.image-with-caption.align-left {
	text-align: left;
}

.image-with-caption.align-center {
	text-align: center;
}

.image-with-caption.align-right {
	text-align: right;
}

/* \u4F2A\u5143\u7D20\u4F5C\u4E3A\u56FE\u7247\u6807\u9898 */
.image-caption {
	font-size: 0.9rem;
	color: gray;
	position: relative;
	margin-right: auto;
}

.image-caption-row {
	display: flex;
	align-items: center;
	gap: 0.5em;
	/* \u4E09\u89D2\u5F62\u548C\u6587\u5B57\u4E4B\u95F4\u7684\u95F4\u8DDD */
	margin-bottom: 0.5em;
	position: relative;
	top: -0.3rem;
}

.image-with-caption .triangle {
	width: 0;
	height: 0;
	border: var(--image-caption-triangle-width, 0.3rem) solid transparent;
	border-bottom-color: var(--image-border-color, #555);
	position: relative;
	top: -0.3rem;
	margin-left: auto;
}

.one2mp .caption {
	font-size: 0.9rem;
	color: var(--image-border-color, #555);
	position: relative;
	width: 100%;
	text-align: center;
	top: var(--image-caption-margin-top, -2rem);
}

.one2mp .one2mp-image-caption {
	font-size: var(--image-cation-font-size);
	color: var(--image-caption-text-color);
	font-weight: var(--image-caption-font-weight);
	font-style: var(--image-caption-font-style);
	font-family: var(--image-caption-font-family);
	line-height: var(--image-caption-line-height);
	text-align: var(--image-caption-text-align);
	position: relative;
	width: 100%;
	text-align: var(--image-caption-text-align);
	top: var(--image-caption-margin-top, -2rem);
}
`});var Er,Tr=y(()=>{Er=`/* list */
:root {
	--list-text-color: var(--article-text-color, #333);
	--list-bg-color: var(--article-bg-color, #fff);
	--list-padding-left: 0.5rem;
	--list-line-height: var(--article-line-height, 1.6);
	--list-ul-style: disc;
	--list-ol-style: decimal;
	--list-item-margin-bottom: 3px;
	--list-margin-top: 3px;
	--list-margin-buton: 3px;
	--list-margin-left: 1rem;
	--list-text-indent: 0;
}
.one2mp ol,
.one2mp ul:not(.one2mp .code-section ul) {
	color: var(--list-text-color, #333);
	/* background-color: var(--list-bg-color, #fff); */
	padding-left: var(--list-padding-left);
	margin-left: var(--list-margin-left, 1rem);
	margin-top: var(--list-margin-top, 0);
	margin-bottom: var(--list-margin-bottom, 0);
	line-height: var(--list-line-height, 1.5);
	text-indent: var(--list-text-indent, 0);

}

.one2mp ol {
	list-style-type: var(--list-ol-style, decimal);
}
.one2mp ul:not(.one2mp .code-section ul) {
	list-style-type: var(--list-ul-style, disc);
}


.one2mp ol li,
.one2mp ul li:not(.one2mp .code-section ul li) {
	margin-bottom: var(--list-item-margin-bottom, 3px);
	line-height: var(--list-line-height, 1.6);
	padding-left: var(--list-padding-left);
}

.one2mp ul li ul {
  list-style-type: circle;
  padding-left: var(--list-padding-left);
}
`});var Ar,Mr=y(()=>{Ar=`:root {
  --footnote-color:  #a0a0a0;
  --footnote-hover-color: #666;
  --footnote-font-size: 12px;
  --hr-color: #ccc;
  --hr-height: 1px;
  --hr-margin: 1em 0;
}

.one2mp hr {
	border-bottom: var(--hr-height, 1px) solid var(--hr-color, #eaeaea);
	border-bottom: none;
	border-left: none;
	border-right: none;
	margin-top: 20px;
	margin-bottom: 20px;
}

.one2mp .foot-links hr {
	margin-top: 2rem;
	margin-bottom: 0.5rem;
}

.one2mp .foot-links {
	font-size: var(--footnote-font-size, 12px);
	color: var(--footnote-color, #a0a0a0);
}

/* footnote */
.one2mp .footnote-id {
	color: var(--wechat-footnote-text-color, #999);
	margin-right: 0.5em;

}

.one2mp .footnote {
	font-size: 0.9em;
	font-weight: 300;
	margin-left: 0.5em;
}
`});var $r,Lr=y(()=>{$r=`:root {
	--table-border-color: var(--one2mp-border-color, #454545);
	--table-border-width: var(--one2mp-border-width, 1px);
	--table-border-style: var(--one2mp-border-style, solid);
	--table-padding: var(--one2mp-padding, 16px);
	--table-margin: var(--one2mp-margin, 0);
	--table-background-color: var(--one2mp-bg, #fff);
	--table-background-color-alt: #eaeaea;
	--table-background-color-hover: var(--one2mp-bg-alt, #0d5c7e);
	--table-font-size: var(--one2mp-font-size, 16px);
	--table-font-weight: var(--one2mp-font-weight, 400);
	--table-line-height: var(--one2mp-line-height, 1.4);
	--table-text-align: var(--one2mp-text-align, left);
	--table-text-indent: var(--one2mp-text-indent, 0);
	--table-text-color: var(--one2mp-text-color, #333);
	--table-header-color: var(--one2mp-header-color, #333);
	--table-header-background-color: #b9b9b9;
	--table-header-font-weight: var(--one2mp-header-font-weight, 600);
	--table-header-line-height: var(--one2mp-header-line-height, 1.5);
	--table-header-text-align: var(--one2mp-header-text-align, left);
	--table-min-width: var(--one2mp-min-width, 100px);
	--table-container-overflow: auto;
	--tabble-radius: 0;
	--table-width: max-content;
	--tabble-white-space: nowrap;
	--table-layout: fixed;
	--table-collapse: collapse;
	--table-td-max-width: 200px;
	--table-td-min-width: 50px;
	--table-td-text-align: left;
	--table-td-word-break: break-word;
	--table-td-white-space: normal;
}

.one2mp .table-container {
	display: flex;
	width: 100%;
	overflow-x: var(--table-container-overflow);
	padding: 1px;
	box-shadow: 0 4px 8px var(--one2mp-shadow, (0, 0, 0, 0.1));
}

.one2mp table {
	border-collapse: var(--table-collapse);
	width: var(--table-width);
	border-color: var(--table-border-color);
	white-space: var(--tabble-white-space);
	table-layout: var(--table-layout);
}

.one2mp thead tr {
	background-color: var(--table-header-background-color);
	color: var(--table-header-color);
	text-align: var(--table-header-text-align);
	line-height: var(--table-header-line-height);
	font-weight: var(--table-header-font-weight);
}
 
.one2mp thead th {
	background-color: var(--table-header-background-color);
	color: var(--table-header-color);
}

/* table body text */
.one2mp tbody tr{
	line-height: var(--table-line-height, 1.5);
	text-align: var(--table-text-align, left);
	background-color: var(--table-background-color); 
	color: var(--table-text-color);
	font-size: var(--table-font-size);
	font-weight: var(--table-font-weight);
}
/* border */
.one2mp th,
.one2mp tr,
.one2mp td {
	border-color: var(--table-border-color);
	border-width: var(--table-border-width);
	border-style: solid;
	max-width: var(--table-td-max-width);
	min-width: var(--table-td-min-width);
	text-align: var(--table-td-text-align);
	word-break: var(--table-td-word-break);
	white-space: var(--table-td-white-space);
}

.one2mp td {
	background-color: var(--table-background-color);
	color: var(--table-text-color);
}

.one2mp tr:nth-child(even) {
	background-color: var(--table-background-color-alt);
	/* \u5076\u6570\u884C\u80CC\u666F\u8272 */;
}

.one2mp tr:nth-child(even) td {
	background-color: var(--table-background-color-alt);
}

.one2mp thead tr:first-child th:first-child {
	border-top-left-radius: var(--tabble-radius);
}
.one2mp thead tr:first-child th:last-child {
	border-top-right-radius: var(--tabble-radius);
}
.one2mp tbody tr:last-child td:first-child {
	border-bottom-left-radius: var(--tabble-radius);
}
.one2mp tbody tr:last-child td:last-child {
	border-bottom-right-radius: var(--tabble-radius);
}
`});var Dr,Ir=y(()=>{Dr=`/* code section */

:root {
	--code-container-background-color: #282c34;
	/*#1E1E1E;*/
	--code-section-background-color: #282c34;
	--code-color: #abb2bf;
	--code-comment-color: #5c6370;
	--code-keyword-color: #c678dd;
	--code-name-color: #e06c75;
	--code-literal-color: #56b6c2;
	--code-string-color: #98c379;
	--code-variable-color: #d19a66;
	--code-symbol-color: #61aeee;
	--code-class-color: #e6c07b;
	--code-line-height: 1.6;
	--code-line-color: rgb(253, 247, 247);
	--code-font-size: 0.9rem;
	--code-padding: 8px;
	--code-border-radius: 6px;
	--code-banner-display: inline-block;
	--code-border-color: rgb(166, 166, 166);
	--code-border-width: 0.5px;
}

.one2mp code {
	display: inline;
	color: var(--code-color, rgb(153, 153, 153));
	line-height: var(--code-line-height, 1.6);
}

.one2mp .code-container {
	display: flex;
	flex-direction: column;
	border-radius: var(--code-border-radius, 4px);
	background: var(--code-container-background-color, #1E1E1E);
	box-shadow: rgba(0, 0, 0, 0.55) 0px 10px 10px -10px;
	border-width: var(--code-border-width);
	border-style: solid;
	border-color: var(--code-border-color);
}


.one2mp .code-section-banner {
	background-image: url('https://mmbiz.qpic.cn/mmbiz_svg/QAm7hEbaujTQuIH8VVl7W7PicH14grAZxd7oUx579CB2wpytwlLSpiaq2DXBpNUz8R6ckkAuO8tBLr52XjAsvR67mh3oibs2dYK/640?wx_fmt=svg&from=appmsg&tp=webp&wxfrom=15&wx_lazy=1');
	background-position: 10px 10px;
	background-size: 40px auto;
	background-repeat: no-repeat;
	display: var(--code-banner-display, inline-block);
	height: 32px;
	width: 100%;
	border-bottom: solid 0.5px var(--code-color, rgb(153, 153, 153));
}

.one2mp .code-section {
	display: flex;
	flex-grow: 1;
	font-size: var(--code-font-size, 0.9rem);
	line-height: var(--code-line-height, 1.6);
	border-radius: var(--code-border-radius, 4px);
}

.one2mp .code-section pre {
	position: relative;
	padding: 2px;
	margin: 0;
	flex: 1;
	overflow: auto;
	border-bottom-left-radius: var(--code-border-radius, 4px);
	border-bottom-right-radius: var(--code-border-radius, 4px);

}


.one2mp .code-section code {
	display: block;
	padding: 10px 5px !important;
	padding-left: .5em;
	font-family: Consolas, Monaco, Menlo, monospace;
	white-space: pre-wrap !important;
	word-wrap: break-word !important;
	overflow-x: auto;
}

.one2mp .code-section ul {
	padding-top: var(--code-padding, 8px);
	padding-bottom: var(--code-padding, 8px);
	position: relative;
	overflow: hidden;
	background: var(--code-section-background-color, #282c34) !important;
	display: flex;
	flex-direction: column;
	flex-shrink: 0;
	counter-reset: line;
	margin: 0;
	padding: 10px 0 0 0;
	white-space: normal;
	width: fit-content;
	user-select: none;
	border-right: solid 0.5px rgb(166, 166, 166);
	padding-right: 5px;
	color: var(--code-line-color, green);
	border-bottom-left-radius: var(--code-border-radius, 4px);
}

.one2mp .code-section ul>li {
	position: relative;
	margin: 0;
	display: list-item;
	text-align: right;
	text-wrap: nowrap;
	line-height: var(--code-line-height, 1.6);
	font-size: var(--code-font-size, 0.9rem);
	font-family: Menlo-Regular, Menlo, Monaco, Consolas, "Courier New", monospace;
	list-style-type: none;
	color: var(--code-line-color, red);
	padding-left: 1rem;

}

.one2mp .code-section ul>li::marker {
	content: none;
}

.one2mp pre code .hljs {
	display: block;
	overflow-x: auto;
	padding: 1em
}

.one2mp code .hljs {
	padding: 3px 5px
}

/*
  
  Atom One Dark by Daniel Gamage
  Original One Dark Syntax theme from https://github.com/atom/one-dark-syntax
  
  base:    #282c34
  mono-1:  #abb2bf
  mono-2:  #818896
  mono-3:  #5c6370
  hue-1:   #56b6c2
  hue-2:   #61aeee
  hue-3:   #c678dd
  hue-4:   #98c379
  hue-5:   #e06c75
  hue-5-2: #be5046
  hue-6:   #d19a66
  hue-6-2: #e6c07b
  
  */
.one2mp .hljs {
	color: var(--code-color, #abb2bf);
	background: var(--code-section-background-color, #282c34)
}

.one2mp .hljs-comment,
.one2mp .hljs-quote {
	color: var(--code-color, #5c6370);
	font-style: italic
}

.one2mp .hljs-doctag,
.one2mp .hljs-keyword,
.one2mp .hljs-formula {
	color: var(--code-keyword-color, #c678dd)
}

.one2mp .hljs-section,
.one2mp .hljs-name,
.one2mp .hljs-selector-tag,
.one2mp .hljs-deletion,
.one2mp .hljs-subst {
	color: var(--code-name-color, #e06c75)
}

.one2mp .hljs-literal {
	color: var(--code-literal-color, #56b6c2)
}

.one2mp .hljs-string,
.one2mp .hljs-regexp,
.one2mp .hljs-addition,
.one2mp .hljs-attribute,
.one2mp .hljs-meta .one2mp .hljs-string {
	color: var(--code-string-color, #98c379)
}

.one2mp .hljs-attr,
.one2mp .hljs-variable,
.one2mp .hljs-template-variable,
.one2mp .hljs-type,
.one2mp .hljs-selector-class,
.one2mp .hljs-selector-attr,
.one2mp .hljs-selector-pseudo,
.one2mp .hljs-number {
	color: var(--code-variable-color, #d19a66)
}

.one2mp .hljs-symbol,
.one2mp .hljs-bullet,
.one2mp .hljs-link,
.one2mp .hljs-meta,
.one2mp .hljs-selector-id,
.one2mp .hljs-title {
	color: var(--code-symbol-color, #61aeee)
}

.one2mp .hljs-built_in,
.one2mp .hljs-title.class_,
.one2mp .hljs-class .one2mp .hljs-title {
	color: var (--code-class-color, #e6c07b)
}

.one2mp .hljs-emphasis {
	font-style: italic
}

.one2mp .hljs-strong {
	font-weight: bold
}

.one2mp .hljs-link {
	text-decoration: underline
}`});var Fr,Rr=y(()=>{Fr=`:root {
	--blockquote-color: rgba(0, 0, 0, 0.5);
	--blockquote-border-color:  var(--blockquote-color);
	--blockquote-border-width: 0px;
	--blockquote-border-style: solid;	
	--blockquote-border-radius: 4px;
	--blockquote-padding: 20px;
	--blockquote-margin: 0px;
	--blockquote-font-size: 1em;
	--blockquote-background-color: rgba(0, 0, 0, 0.05);
	--blockquote-inner-background-color: var(--blockquote-background-color);
	--blockquote-font-family: var(--article-font-family);
	--blockquote-font-style: italic;
}

.one2mp blockquote {
	border-left-width: var(--blockquote-border-width);
	border-left-style: var(--blockquote-border-style);
	border-left-color: var(--blockquote-border-color);
	border-radius: var(--blockquote-border-radius);
	padding: var(--blockquote-padding);
	margin: var(--blockquote-margin);
	color: var(--one2mp-secondary);	
	background-color: var(--blockquote-background-color);
	line-height: var(--one2mp-line-height);
	text-indent: 0;
	color: var(--blockquote-color);
	font-family: var(--blockquote-font-family);
	font-size: var(--blockquote-font-size);
	font-style: var(--blockquote-font-style);
}

.blockquote-inner {
  background: transparent;
  padding: 0px;
  transform: skew(0.0deg, 0.0deg); /* \u62B5\u6D88\u5916\u5C42\u503E\u659C\uFF0C\u8BA9\u5185\u5BB9\u4E0D\u6B6A */
}

/* .icon-pin {
  position: absolute;
  top: -12px;
  right: -12px;
  width: 24px;
  height: 24px;
  background-image: var(--icon-book);
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  pointer-events: none;
  visibility: visible
} */
`});var _r,Or=y(()=>{_r=`:root{
	--link-color: var(--one2mp-secondary, rgb(0, 102, 204));
	--link-hover-color: var(--one2mp-primary-light, rgb(0, 128, 255));
	--link-active-color: var(--one2mp-primary, rgb(0, 128, 255));
}


.one2mp a {
	font-weight: 500;
	text-decoration: none;
	color: var(--link-color, rgb(0, 102, 204));
}

.one2mp a:hover,
.one2mp a:active {
	border-bottom: 1.5px solid var(--link-color, rgb(0, 102, 204));
	color: var(--link-hover-color, rgb(0, 128, 255));
}

.one2mp a:before {
	content: "\u21F2";
}
`});var Nr,Hr=y(()=>{Nr=`/* Callout Styles */

:root {
    --callout-background-color: rgba(8, 109, 221, 0.04);
	--callout-box-shadow: 0 8px 16px rgba(0, 0, 0, 0.16);
    --callout-border-color: rgba(8, 109, 221, 0.18);
	--callout-border-radius: var(--one2mp-border-radius, 4px);
	--callout-border-width: 0px;
    --callout-icon-color: rgba(8, 109, 221, 0.5);
    --callout-icon-size: 1.25em;
    --callout-icon-margin: 0.25em;
    --callout-text-color: var(--article-text-color, #333333);
	--cursor: pointer;
}

.one2mp-callout {
    overflow: hidden;
    border-style: solid;
    border-color: var(--callout-border-color, rgba(8, 109, 221, 0.25));
    border-width: var(--callout-border-width, 0px);
    border-radius: var(--callout-border-radius, 4px);
    margin: 1em 0;
    background-color: var(--callout-background-color, rgba(8, 109, 221, 0.1));
    padding: 12px 12px 12px 24px;
    opacity: 1;
    filter: none;
}

.one2mp-callout:not(.admonition).drop-shadow {
    box-shadow: var(--callout-box-shadow, 0 4px 8px  rgba(0, 0, 0, 0.2));
}

.one2mp-callout:not(.admonition) .no-title {
    display: none;
}


@supports selector(:has(*)) {

    :has(.one2mp-callout .callout-title .callout-title-inner:dir(rtl)),
    .one2mp-callout:has(> .callout-title .callout-title-inner:dir(rtl)) {
        direction: rtl;
    }

    :has(.one2mp-callout .callout-title .callout-title-inner:dir(rtl))>.callout-title,
    .one2mp-callout:has(> .callout-title .callout-title-inner:dir(rtl))>.callout-title {
        direction: rtl;
        --direction: -1;
    }

    :has(.one2mp-callout .callout-title .callout-title-inner:dir(rtl))>.callout-title .callout-icon svg.svg-icon,
    .one2mp-callout:has(> .callout-title .callout-title-inner:dir(rtl))>.callout-title .callout-icon svg.svg-icon {
        transform: scale(-1, 1);
    }
}

.one2mp-callout {
    background-color: var(--callout-background-color, rgba(8, 109, 221, 0.1));
    box-shadow: var(--callout-box-shadow, 0 4px 8px  rgba(0, 0, 0, 0.2));
}


.callout-icon {
    height: 1em;
}

.one2mp-callout[data-callout="summary"] {
    background-color: rgba(0, 191, 188, 0.04);
}
.one2mp-callout[data-callout="abstract"],
.one2mp-callout[data-callout="tldr"] {
    background-color: rgba(0, 176, 255, 0.04);
}

.one2mp-callout[data-callout="info"] {
    background-color: rgba(8, 109, 221, 0.04);
}

.one2mp-callout[data-callout="todo"] {
    background-color: rgba(8, 109, 221, 0.04);
}

.one2mp-callout[data-callout="important"] {
    background-color: rgba(8, 191, 188, 0.04);
}

.one2mp-callout[data-callout="tip"],
.one2mp-callout[data-callout="hint"] {
    background-color: rgba(8, 191, 188, 0.04);
}

.one2mp-callout[data-callout="success"],
.one2mp-callout[data-callout="check"],
.one2mp-callout[data-callout="done"] {
    background-color: rgba(8, 185, 78, 0.04);

}

.one2mp-callout[data-callout="question"],
.one2mp-callout[data-callout="help"],
.one2mp-callout[data-callout="faq"] {
    background-color: rgba(236, 117, 0, 0.04);
}

.one2mp-callout[data-callout="warning"],
.one2mp-callout[data-callout="caution"],
.one2mp-callout[data-callout="attention"] {
    background-color: rgba(236, 117, 0, 0.04);
}

.one2mp-callout[data-callout="failure"],
.one2mp-callout[data-callout="fail"],
.one2mp-callout[data-callout="missing"] {
    background-color: rgba(233, 49, 71, 0.04);
}

.one2mp-callout[data-callout="danger"],
.one2mp-callout[data-callout="error"] {
    background-color: rgba(233, 49, 71, 0.04);
}

.one2mp-callout[data-callout="bug"] {
    background-color: rgba(233, 49, 71, 0.04);
}

.one2mp-callout[data-callout="example"] {
    background-color: rgba(120, 82, 238, 0.04);
}

.one2mp-callout[data-callout="quote"],
.one2mp-callout[data-callout="cite"] {
    background-color: rgba(158, 158, 158, 0.04);
}

/* title start */
.one2mp-callout.is-collapsible  {
    cursor: var(--cursor);
}


.callout-title {
    padding: 0;
    display: flex;
    gap: 4px;
    font-size: inherit;
    line-height: 1.3;
    align-items: flex-start;
    color: rgb(8, 109, 221);
}


.one2mp-callout[data-callout="summary"] .callout-title  {
    color: rgb(0, 191, 188);
}
.one2mp-callout[data-callout="abstract"] .callout-title ,
.one2mp-callout[data-callout="tldr"] .callout-title {
    color: rgb(0, 176, 255);
}

.one2mp-callout[data-callout="info"] .callout-title {
    color: rgb(8, 109, 221);
}

.one2mp-callout[data-callout="todo"] .callout-title {
    color: rgb(8, 109, 221);
}

.one2mp-callout[data-callout="important"] .callout-title {
    color: rgb(8, 191, 188);
}

.one2mp-callout[data-callout="tip"] .callout-title ,
.one2mp-callout[data-callout="hint"] .callout-title {
    color: rgb(8, 191, 188);
}

.one2mp-callout[data-callout="success"] .callout-title ,
.one2mp-callout[data-callout="check"] .callout-title ,
.one2mp-callout[data-callout="done"] .callout-title {
    color: rgb(8, 185, 78);

}

.one2mp-callout[data-callout="question"] .callout-title ,
.one2mp-callout[data-callout="help"] .callout-title ,
.one2mp-callout[data-callout="faq"] .callout-title {
    color: rgb(236, 117, 0);
}

.one2mp-callout[data-callout="warning"] .callout-title ,
.one2mp-callout[data-callout="caution"] .callout-title ,
.one2mp-callout[data-callout="attention"] .callout-title {
    color: rgb(236, 117, 0);
}

.one2mp-callout[data-callout="failure"] .callout-title ,
.one2mp-callout[data-callout="fail"] .callout-title ,
.one2mp-callout[data-callout="missing"] .callout-title {
    color: rgb(233, 49, 71);
}

.one2mp-callout[data-callout="danger"]  .callout-title ,
.one2mp-callout[data-callout="error"] .callout-title {
    color: rgb(233, 49, 71);
}

.one2mp-callout[data-callout="bug"] .callout-title {
    color: rgb(233, 49, 71);
}

.one2mp-callout[data-callout="example"] .callout-title {
    color: rgb(120, 82, 238);
}

.one2mp-callout[data-callout="quote"] .callout-title ,
.one2mp-callout[data-callout="cite"]  .callout-title {
    color: rgb(158, 158, 158);
}

/* title end */
.callout-content {
    overflow-x: auto;
    padding: 0; 
    background-color: transparent;
    opacity: 1;
    filter: none;
}

.one2mp-callout .callout-content p,
.one2mp-callout .callout-content li,
.one2mp-callout .callout-content span,
.one2mp-callout .callout-content strong,
.one2mp-callout .callout-content em,
.one2mp-callout .callout-content a,
.one2mp-callout .callout-content code,
.one2mp-callout .callout-text {
    color: var(--callout-text-color, #333333);
    opacity: 1;
}

.one2mp-callout .callout-text {
    color: var(--article-text-color, #333333) !important;
    opacity: 1 !important;
}

.callout-content .one2mp-callout {
    margin-top: 20px;
}

.callout-icon {
    flex: 0 0 auto;
    display: flex;
    align-items: center;
}



.callout-title-inner {
    font-weight: 600; 
    color: inherit; 
}

.callout-fold {
    display: flex;
    align-items: center;
    padding-inline-end: 8px; 
}


.callout-fold .svg-icon {
    transition: transform 100ms ease-in-out;
}

.callout-fold.is-collapsed .svg-icon {
    transform: rotate(-1 * -1 * 90deg);
}
`});var Br,zr=y(()=>{Br=`.admonition {
    margin-top: 1.5em;
    margin-bottom: 1.5em;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.admonition.no-title .admonition-content {
    margin-top: 0;
    margin-bottom: 0;
}

.admonition li.task-list-item.is-checked p {
    text-decoration: line-through;
}

.admonition.no-drop {
    box-shadow: none;
}

.admonition.no-drop>.admonition-title.no-title+.admonition-content,
.admonition.no-drop .admonition .admonition-title.no-title+.admonition-content {
    margin-top: 0;
    margin-bottom: 0;
}

.admonition.no-drop .admonition .admonition-content {
    border-right: .0625em solid rgba(233, 233,123, .2);
    border-bottom: .0625em solid rgba(233, 233,123, .2);
}

.admonition.no-drop .admonition .admonition-title.no-title+.admonition-content {
    border-top: .0625em solid rgba(233, 233,123, .2);
}

:is(.markdown-source-view.mod-cm6) .admonition .math-block>mjx-container,
:is(.markdown-reading-view) .admonition .math-block>mjx-container {
    display: block;
    text-align: center;
    padding: 1em;
}

:is(.markdown-reading-view) .admonition .math-block>mjx-container {
    padding: .0625em;
}

*:not(.is-live-preview) .admonition.no-content {
    display: none;
}

.admonition {
    margin-top: 0px;
    margin-bottom: .75em;
}

.admonition.no-content {
    opacity: .1;
}

.admonition-content p {
    line-height: inherit;
    margin: revert;
}

.admonition-content p br {
    display: initial;
}

.admonition-content p ul>li>ul {
    border-left: 2px;
    border-left-color: #ababab;
    border-left-style: solid;
}

.admonition-content:first-child {
    margin-top: .8em;
}

.admonition-content:last-child {
    margin-bottom: .8em;
}

.admonition-title.no-title {
    display: none;
}

.admonition-title:hover+.admonition-content .admonition-content-copy {
    opacity: .7;
}

.admonition-content,
.callout-content {
    position: relative;
}

.admonition-content-copy {
    color: #ababab;
    cursor: pointer;
    opacity: 0;
    position: absolute;
    margin: .375em;
    right: 0;
    top: 0;
    transition: .3s opacity ease-in;
}

.admonition-content-copy:hover {
    color: inherit;
}

.admonition:hover .admonition-content-copy,
.callout:hover .admonition-content-copy,
.admonition-content-copy:hover {
    opacity: 1;
}


.admonition-content ul,
.admonition-content ol {
    white-space: normal;
}

.admonition-title-icon,
.fa {
    height: 1.2em;
    width: 1.2em;
}
`});var Vr,jr=y(()=>{Vr=`.one2mp .inline-math{
    display: inline-block;
    padding: 0 0.5rem;
}

.one2mp .block-math {
    display: flex;
    width: 100%;
    overflow: auto;
    padding: 0.5rem;
}

.one2mp .block-math svg {
    width: fit-content;
    margin: auto;
}
`});var Wr,Ur=y(()=>{Wr=`.one2mp .mermaid {
    display: flex;
    flex-direction: column;
    padding: 0;
    border: none;
    border-radius: 0;
    background: transparent;
    box-shadow: none;
}

.one2mp .mermaid image {
    width: 100%;
    margin: auto;
}

.one2mp .mermaid img {
    border: none;
    border-radius: 0;
    box-shadow: none;
    display: block;
}
`});var Gr,qr=y(()=>{Gr=`.one2mp .charts {
    display: flex;
    flex-direction: column;
    padding: 3px;
    border: solid 1px #ccc;
    border-radius: 3px;
}

.one2mp .charts image
 {
    width: 100%;
    margin: auto;
}
`});var Jr,Kr=y(()=>{Jr=`/* icon */

.obsidian-icon {
	font-size: inherit;
	display: inline-block;
	width: 1.8rem;
	text-align: center;
}

/* p .obsidian-icon {
	width: 1.75em
} */

.obsidian-icon.react-icon>svg {
	vertical-align: middle;
	margin-bottom: 3px;
}

.obsidian-icon.react-icon{
	width: 1.8rem;;
}
`});var Yr,Zr=y(()=>{Yr=`/* summary */
.one2mp details {
	border: none;
	outline: none;
	/* border-left: 4px solid #3eaf7c; */
	padding-left: var(--wechat-collapse-padding, 1em);
	margin-left: var(--wechat-collapse-margin, 0);
	background-color: var(--wechat-collapse-bg-color, #f5f5f5);
}

.one2mp details summary {
	cursor: pointer;
	border: none;
	outline: none;
	margin: 0px -17px;
}

.one2mp details summary::-webkit-details-marker {
	color: var(--wechat-collapse-bg-color, #f5f5f5);
}
`});var Qr,Xr=y(()=>{Qr=`
    :root{
		--profile-background-color: #fafafa;
		--profile-title-color: #1f1f1f;
		--profile-description-color: #333;
		--profile-meta-color: #666;
		--profile-border-color: #eee;
		--profile-footer-color: #999;
		--profile-footer-bg-color: #fafafa;
		--profile-avatar-size: 64px;
		--profile-width: 600px;
		--profile-radius: 12px;
	}
	.one2mp-profile-card {
      background-color: var(--profile-background-color, #fff);
      border-radius: var(--profile-radius, 12px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
      overflow: hidden;
      width: var(--profile-width, 600px);
    }

    .one2mp-profile-card .card-main {
      display: flex;
      align-items: center;
      padding: 20px;
    }

    .one2mp-profile-card .avatar {
      width: var(--profile-avatar-size, 64px);
      height: var(--profile-avatar-size, 64px);
      border-radius: 50%;
      overflow: hidden;
      margin-right: 16px;
      flex-shrink: 0;
    }

    .one2mp-profile-card .avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .one2mp-profile-card .content {
      flex-grow: 1;
    }

    .one2mp-profile-card .title {
      font-size: 20px;
      font-weight: bold;
      color: var(--profile-title-color, #1f1f1f);
      margin-bottom: 6px;
    }

    .one2mp-profile-card .description {
      font-size: 16px;
      color: var(--profile-description-color, #555);
      margin-bottom: 8px;
    }

    .one2mp-profile-card .meta {
      font-size: 14px;
      color: var(--profile-meta-color, #888);
    }

    .one2mp-profile-card .arrow {
      font-size: 20px;
      color: #999;
      margin-left: 12px;
    }

    .one2mp-profile-card .card-footer {
      background-color: var(--profile-footer-bg-color, #f7f7f7);
      padding: 10px 20px;
      font-size: 14px;
      color: var(--profile-footer-color, #999);
      border-top: 1px solid var(--profile-border-color, #eee);
    }
`});var ta,ea=y(()=>{ta=`.one2mp-mpcard-wrapper {
  margin: 20px 20px;
  background-color: rgb(250, 250, 250);
  padding: 10px 20px;
  border-radius: 10px;
}

.one2mp-mpcard-content {
  display: flex;
  align-items: center;
}

.one2mp-mpcard-headimg {
  border: none !important;
  border-radius: 27px !important;
  box-shadow: none !important;
  width: 54px !important;
  height: 54px !important;
  margin: 0 !important;
}

.one2mp-mpcard-info {
  margin-left: 10px;
}

.one2mp-mpcard-nickname {
  font-size: 17px;
  font-weight: 500;
  color: rgba(0, 0, 0, 0.9);
}

.one2mp-mpcard-signature {
  font-size: 14px;
  color: rgba(0, 0, 0, 0.55);
}

.one2mp-mpcard-foot {
  margin-top: 20px;
  padding-top: 10px;
  border-top: 1px solid #ececec;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.3);
}
`});var na,qs,Gs,Ks,Jt,ia=y(()=>{Wi();Gi();Ji();Yi();Qi();tr();ir();ar();sr();cr();dr();hr();gr();fr();br();xr();kr();Cr();Tr();Mr();Lr();Ir();Rr();Or();Hr();zr();jr();Ur();qr();Kr();Zr();Xr();ea();na=require("obsidian");de();qs=[qi,Ki,Zi,Xi,er,nr,rr,or,lr,qn,pr,ur,mr,vr,wr,yr,Sr,Pr,Er,Ar,$r,Dr,Fr,_r,Nr,Br,Vr,Wr,Gr,Jr,qn,Yr,Qr,ta],Gs=["appmsg_","wx_","wx-","common-webchat","weui-"],Ks=d=>Gs.some(t=>d.startsWith(t)),Jt=class{constructor(){this.vars=new Map;this.rules=new Map}async init(t){await this.buildBaseCSS();try{this.mergeCssText(t)}catch(e){new na.Notice(u("render.failed-to-parse-custom-css",[e])),console.error(e)}}async buildBaseCSS(){this.vars.clear(),this.rules.clear();for(let t of qs)this.mergeCssText(t)}resolveCssVars(t,e,n=0){let r=/var\(\s*--([\w-]+)(?:\s*,\s*((?:\((?:[^()]|\([^()]*\))*\)|[^)\s]|[\s\S])*?))?\s*\)/g,a=t,o;do o=!1,a=a.replace(r,(s,l,c)=>{let p=`--${l}`;if(e.has(p)){let h=e.get(p);return o=!0,h}else return c!==void 0?(o=!0,c):(console.warn(`Variable ${p} not found and no fallback provided`),"")}),n++;while(o&&n<10);return a}mergeCssText(t){if(!t||!t.trim())return;let e=this.parseCssText(t);this.mergeVars(e.vars),this.mergeRules(e.rules)}mergeVars(t){for(let[e,n]of t.entries())this.vars.set(e,n)}mergeRules(t){for(let[e,n]of t.entries()){let i=this.rules.get(e);i||(i=new Map,this.rules.set(e,i));for(let[r,a]of n.entries()){let o=i.get(r);(o===void 0||!o.important||a.important)&&i.set(r,a)}}}parseCssText(t){let e=new Map,n=new Map,i=this.parseWithCssSheet(t);return i?(this.collectRulesFromList(i.cssRules,e,n),{vars:e,rules:n}):(this.parseWithFallback(t,e,n),{vars:e,rules:n})}parseWithCssSheet(t){if(typeof CSSStyleSheet=="undefined")return null;let e=new CSSStyleSheet;try{return e.replaceSync(t),e}catch(n){return console.debug("CSSStyleSheet \u89E3\u6790\u5931\u8D25",n),null}}collectRulesFromList(t,e,n){for(let i of Array.from(t))i.type===CSSRule.STYLE_RULE?this.collectStyleRule(i,e,n):"cssRules"in i&&this.collectRulesFromList(i.cssRules,e,n)}collectStyleRule(t,e,n){if(!t.selectorText)return;let i=t.selectorText.split(",").map(r=>r.trim()).filter(Boolean);if(i.length!==0)for(let r of i){if(r===":root"){this.collectVariables(t.style,e);continue}this.collectDeclarations(r,t.style,n)}}collectVariables(t,e){for(let n=0;n<t.length;n++){let i=t.item(n);if(!i||!i.startsWith("--"))continue;let r=t.getPropertyValue(i).trim();r&&e.set(i,r)}}collectDeclarations(t,e,n){let i=n.get(t);i||(i=new Map,n.set(t,i));for(let r=0;r<e.length;r++){let a=e.item(r);if(!a||a.startsWith("--"))continue;let o=e.getPropertyValue(a).trim();o&&i.set(a,{value:o,important:e.getPropertyPriority(a)==="important"})}}parseWithFallback(t,e,n){let i=t.replace(/\/\*[\s\S]*?\*\//g,""),r=/([^{@}]+)\{([^}]*)\}/g,a;for(;(a=r.exec(i))!==null;){let o=a[1].trim();if(!o||o.startsWith("@"))continue;let s=a[2],l=this.parseDeclarations(s),c=o.split(",").map(p=>p.trim()).filter(Boolean);for(let p of c){if(p===":root"){for(let[g,m]of l.entries())g.startsWith("--")&&e.set(g,m.value);continue}let h=n.get(p);h||(h=new Map,n.set(p,h));for(let[g,m]of l.entries())g.startsWith("--")||h.set(g,m)}}}parseDeclarations(t){let e=new Map,n=t.split(";");for(let i of n){let r=i.trim();if(!r)continue;let a=r.indexOf(":");if(a===-1)continue;let o=r.slice(0,a).trim();if(!o)continue;let s=r.slice(a+1).trim(),l=!1;s.endsWith("!important")&&(l=!0,s=s.replace(/!important$/i,"").trim()),s&&e.set(o,{value:s,important:l})}return e}normalizeSelector(t){let e=t.match(/::(before|after)/),n=e?e[1]:null;return{baseSelector:n?t.replace(/::(before|after)/g,""):t,pseudo:n}}ensurePseudoElement(t,e,n){let i=`data-one2mp-pseudo-${e}`,r=t.querySelector(`[${i}]`);return r||(r=document.createElement("span"),r.setAttribute(i,"true"),e==="before"?t.prepend(r):t.append(r)),n&&(r.textContent=n.replace(/(^")|("$)/g,"")),r}applyStyleToElement(t){this.rules.forEach((n,i)=>{let{baseSelector:r,pseudo:a}=this.normalizeSelector(i);try{if(t.matches(r)){let o=t;if(a){let s=n.get("content");o=this.ensurePseudoElement(t,a,s==null?void 0:s.value)}n.forEach((s,l)=>{if(l==="content")return;let c=this.resolveCssVars(s.value,this.vars);o.setCssProps({[l]:s.important?`${c} !important`:c})})}}catch(o){console.debug("error selector=>",i," | Error=>",o.message)}});let e=t.firstElementChild;for(;e;)this.applyStyleToElement(e),e=e.nextElementSibling;return t}removeClassName(t){let e=t.getAttribute("class");if(e){let i=e.split(" ");for(let r of i)Ks(r)||t.classList.remove(r)}t.removeAttribute("class");let n=t.firstElementChild;for(;n;)this.removeClassName(n),n=n.nextElementSibling}}});var Zt={};at(Zt,{ThemeManager:()=>ht});var fe,Gn,ht,St=y(()=>{fe=require("obsidian");de();kt();ia();Gn=class{constructor(t){this.cssMerger=null;this.cachedCssKey=null;this.themes=[];this.plugin=t}async downloadThemes(){var n;let t=["https://raw.githubusercontent.com/ryfineZ/O2Any/main/themes/","https://fastly.jsdelivr.net/gh/ryfineZ/O2Any@main/themes/","https://ghproxy.com/https://raw.githubusercontent.com/ryfineZ/O2Any/main/themes/","https://gitee.com/ryfineZ/O2Any/raw/main/themes/","https://raw.githubusercontent.com/ryfineZ/O2Any/master/themes/","https://fastly.jsdelivr.net/gh/ryfineZ/O2Any@master/themes/","https://ghproxy.com/https://raw.githubusercontent.com/ryfineZ/O2Any/master/themes/","https://gitee.com/ryfineZ/O2Any/raw/master/themes/"],e=this.normalizeThemeFolder(this.plugin.settings.css_styles_folder);this.plugin.app.vault.getAbstractFileByPath(e)||await this.plugin.app.vault.createFolder(e);try{let i="",r,a=null;for(let g of t)try{if(r=await(0,fe.requestUrl)(`${g}themes.json`),r.status===200){i=g;break}a=new Error(r.text)}catch(m){a=m instanceof Error?m:new Error(String(m))}if(!r||r.status!==200||!i)throw new Error(u("views.theme-manager.failed-to-fetch-themes-json-themesrespon",[(n=a==null?void 0:a.message)!=null?n:"unknown"]));let s=r.json.themes,l=0,c=0,p=0,h=this.plugin.settings.themeDownloadOverwrite;for(let g of s)try{let m=`${e}/${g.file}`,f=this.plugin.app.vault.getAbstractFileByPath(m);if(f&&!h){p+=1;continue}let v=encodeURIComponent(g.file),A=await(0,fe.requestUrl)(`${i}${v}`);if(A.status!==200){console.warn(`Failed to download ${g.file}: ${A.text}`),c+=1;continue}let k=A.text;if(f){if(f instanceof fe.TFile){await this.plugin.app.vault.modify(f,k),l+=1;continue}c+=1;continue}await this.plugin.app.vault.create(m,k),l+=1}catch(m){console.error(m),c+=1,new fe.Notice(u("views.theme-manager.error-downloading-theme")+m.message);continue}new fe.Notice(u("views.theme-manager.download-summary",[String(l),String(c),String(p)]))}catch(i){console.error("Error downloading themes:",i),new fe.Notice(u("views.theme-manager.error-downloading-themes"))}}static getInstance(t){return this.instance||(this.instance=new Gn(t)),this.instance}static resetInstance(){this.instance=null}async loadThemes(){this.themes=[];let t=this.normalizeThemeFolder(this.plugin.settings.css_styles_folder),e=this.plugin.app.vault.getAbstractFileByPath(t);return e instanceof fe.TFolder&&(this.themes=await this.getAllThemesInFolder(e)),this.themes}normalizeThemeFolder(t){let e=(t!=null?t:"").trim();return e||(e="one2mp-css-styles"),e=(0,fe.normalizePath)(e),e.startsWith("/")&&(e=e.slice(1)),e}cleanCSS(t){t=t.replace(/```[cC][Ss]{2}\s*|\s*```/g,"").trim();let e=/\/\*[\s\S]*?\*\//g,n=/\/\/.*/g,i=/\s+/g,r=/[\u200B\u00AD\uFEFF\u00A0]/g;return t.replace(e,"").replace(n,"").replace(i," ").replace(r,"").trim()}async extractCSSblocks(t){let e=[],n=this.plugin.app.vault.getFileByPath(t);if(!n)return"";let i=this.plugin.app.metadataCache.getFileCache(n);if(!(i!=null&&i.sections))return"";let r=await this.plugin.app.vault.read(n);for(let a of i.sections)if(a.type==="code"){let o=r.substring(a.position.start.offset,a.position.end.offset);if(!/^```css/i.test(o))continue;let s=o.indexOf(`
`),l=o.lastIndexOf(`
`),c=o.substring(s+1,l).trim();e.push(c)}return e.join(`
`)}async getThemeContent(t){let e=this.plugin.app.vault.getFileByPath(t);if(!e)return"";let n=await this.plugin.app.vault.cachedRead(e),i=/```[cC][Ss]{2}\s*([\s\S]+?)\s*```/gs,r=[],a;for(;(a=i.exec(n))!==null;)r.push(this.cleanCSS(a[1].trim()));return console.debug("cssBlocks=>",r),r.join(`
`)}async getCSS(){let t="";return this.plugin.settings.custom_theme&&(t=await this.extractCSSblocks(this.plugin.settings.custom_theme)),t}getShadowStleSheet(){let t=new CSSStyleSheet;return t.replaceSync(`
  /* \u6EDA\u52A8\u6761\u6837\u5F0F we use shadow dom, make the preview looks better.*/
.table-container::-webkit-scrollbar {
	width: 8px;
	height: 8px;
	background-color: var(--scrollbar-bg);
}

.table-container::-webkit-scrollbar-thumb {
	background-color: var(--scrollbar-thumb-bg);
    -webkit-border-radius: var(--radius-l);
    background-clip: padding-box;
    border: 2px solid transparent;
    border-width: 3px 3px 3px 2px;
    min-height: 45px;
}
.table-container::-webkit-scrollbar-thumb:hover {
	background-color: var(--scrollbar-thumb-hover-bg);
}

.one2mp-article::-webkit-scrollbar-corner{
	background: transparent;
}

.one2mp-article pre::-webkit-scrollbar {
	width: 8px;
	height: 8px;
	background-color: var(--scrollbar-bg);
}

.one2mp-article pre::-webkit-scrollbar-thumb {
	background-color: var(--scrollbar-thumb-bg);
    -webkit-border-radius: var(--radius-l);
    background-clip: padding-box;
    border: 2px solid transparent;
    border-width: 3px 3px 3px 2px;
    min-height: 45px;
}

.one2mp-article pre::-webkit-scrollbar-thumb:hover {
	background-color: var(--scrollbar-thumb-hover-bg);
}

.one2mp-article::-webkit-scrollbar-corner{
	background: transparent;
}
`),t}async getAllThemesInFolder(t){let e=[],n=async i=>{let r=i.children.map(async a=>{if(a instanceof fe.TFile&&a.extension==="md"){let o=await this.getThemeProperties(a);o&&e.push(o)}else a instanceof fe.TFolder&&await n(a)});await Promise.all(r)};return await n(t),e}async getThemeProperties(t){let e=await this.plugin.app.vault.cachedRead(t),{data:n}=Be(e),i=(n.theme_name||"").trim();if(i)return{name:i,path:t.path}}async applyTheme(t){var r;let e=await this.getCSS(),n=e;if((!this.cssMerger||this.cachedCssKey!==n)&&(this.cssMerger=new Jt,await this.cssMerger.init(e),this.cachedCssKey=n),((r=t.dataset)==null?void 0:r.one2mpThemeKey)===n)return t;let i=this.cssMerger.applyStyleToElement(t);return i.dataset.one2mpThemeKey=n,i}},ht=Gn;ht.instance=null});function Pe(d){return new XMLSerializer().serializeToString(d)}function Te(d){let t=new XMLSerializer,e="";return d.childNodes.forEach(n=>{e+=t.serializeToString(n)}),e}var Ee=y(()=>{});function Xt(d,t){if(d===t)return!0;if(typeof d!="object"||d===null||typeof t!="object"||t===null)return!1;let e=Object.keys(d),n=Object.keys(t);if(e.length!==n.length)return!1;for(let i of e){let r=d,a=t;if(!n.includes(i)||!Xt(r[i],a[i]))return!1}return!0}async function Ct(d,t){if(!d)throw new Error(`Invalid URL: ${d}`);if(d.startsWith("data:"))return Zs(d);if(t&&d.startsWith("app://")){let e=d.slice(6),n=e.indexOf("/"),i=n>=0?e.slice(n+1):e;i=decodeURIComponent(i),i=i.split("?")[0].split("#")[0];let r=i.replace(/^\/+/,""),a=i.startsWith("/")?i:`/${i}`,o=t.vault.adapter;if(o instanceof Le.FileSystemAdapter){let l=o.getBasePath();if(a.startsWith(l)){let c=a.slice(l.length);(c.startsWith("/")||c.startsWith("\\"))&&(c=c.slice(1));let p=sa(t,c);if(p instanceof Le.TFile){let h=await t.vault.readBinary(p);return new Blob([h])}}}let s=sa(t,r);if(s instanceof Le.TFile){let l=await t.vault.readBinary(s);return new Blob([l])}throw new Error(`Image not found in vault: ${i}`)}try{let e=await(0,Le.requestUrl)(d);if(!e.arrayBuffer)throw new Error(`Failed to fetch image from ${d}`);return new Blob([e.arrayBuffer])}catch(e){let n=e instanceof Error?e.message:String(e);throw new Error(`Error fetching image from ${d}: ${n}`)}}function Zs(d){let[t,e]=d.split(","),n=t.match(/data:(.*?);base64/),i=n?n[1]:"application/octet-stream",r=atob(e),a=new Uint8Array(r.length);for(let o=0;o<r.length;o+=1)a[o]=r.charCodeAt(o);return new Blob([a],{type:i})}function la(d){return Pe(d).replaceAll(/<div /g,"<section ").replaceAll(/<\/div>/g,"</section>")}var Le,sa,Pt=y(()=>{Le=require("obsidian");Ee();sa=(d,t)=>{var c,p,h,g,m,f,v,A;let e=d.vault,n=d.workspace.getActiveFile(),i=e.config,r=(c=i==null?void 0:i.attachmentFolderPath)!=null?c:"",a=t.trim();if(!a)return null;a=a.split("|")[0].split("?")[0].split("#")[0],(a.startsWith("/")||a.startsWith("\\"))&&(a=a.slice(1));let o=e.getAbstractFileByPath(a);if(o instanceof Le.TFile)return o;let s=d.metadataCache.getFirstLinkpathDest(a,(p=n==null?void 0:n.path)!=null?p:"");if(s instanceof Le.TFile)return s;if((h=n==null?void 0:n.parent)!=null&&h.path){let k=`${n.parent.path}/${a}`,C=e.getAbstractFileByPath(k);if(C instanceof Le.TFile)return C}let l=a.split("/").pop()||a;if(r){let k=[];if(r.startsWith("./")){let C=r.slice(2);k.push(`${(m=(g=n==null?void 0:n.parent)==null?void 0:g.path)!=null?m:""}/${C}/${l}`),k.push(`${(v=(f=n==null?void 0:n.parent)==null?void 0:f.path)!=null?v:""}/${C}/${a}`)}else k.push(`${r}/${l}`),k.push(`${r}/${a}`),(A=n==null?void 0:n.parent)!=null&&A.path&&(k.push(`${n.parent.path}/${r}/${l}`),k.push(`${n.parent.path}/${r}/${a}`));for(let C of k){let P=e.getAbstractFileByPath(C);if(P instanceof Le.TFile)return P}}return null}});var pa={};at(pa,{LocalDraftManager:()=>$e,initDraftDB:()=>Kn});var da,ca,Ys,Kn,Ge,$e,ut=y(()=>{da=require("obsidian");Pt();de();ca=null,Ys=async()=>ca||null,Kn=async()=>{},Ge=class{constructor(t){this.db=null;this.fallbackDrafts={};this.fallbackLoaded=!1;this.plugin=t}static getInstance(t){return Ge.instance||(Ge.instance=new Ge(t)),Ge.instance}static resetInstance(){Ge.instance=null}async ensureFallbackLoaded(){if(!this.fallbackLoaded)try{let t=await this.plugin.loadData(),e=t==null?void 0:t.local_drafts;e&&typeof e=="object"&&(this.fallbackDrafts=e)}catch(t){console.warn("\u52A0\u8F7D\u672C\u5730\u8349\u7A3F\u7F13\u5B58\u5931\u8D25",t)}finally{this.fallbackLoaded=!0}}async saveFallbackDrafts(){try{let t=await this.plugin.loadData();await this.plugin.saveData({...t!=null?t:{},local_drafts:this.fallbackDrafts})}catch(t){console.warn("\u4FDD\u5B58\u672C\u5730\u8349\u7A3F\u7F13\u5B58\u5931\u8D25",t)}}async getDb(){return this.db!==null?this.db:da.Platform.isMobile?null:(this.db=await Ys(),this.db)}async getDrafOfActiveNote(){let t,e=this.plugin.settings.selectedMPAccount;if(e!==void 0&&e){let n=this.plugin.app.workspace.getActiveFile();n&&(t=await this.getDraft(e,n.path),t===void 0&&(t={accountName:e,notePath:n.path,title:n.basename,_id:e+n.path},await this.setDraft(t)),t.title.trim()===""&&(t.title=n.basename,await this.setDraft(t)))}return t}isActiveNoteDraft(t){let e=this.plugin.app.workspace.getActiveFile();return t===void 0&&e===null?!0:t!==void 0&&e?t.notePath===e.path:!1}async getDraft(t,e){let n=await this.getDb();return n?new Promise(i=>{n.get(t+e).then(r=>{i(r)}).catch(()=>{i(void 0)})}):(await this.ensureFallbackLoaded(),this.fallbackDrafts[t+e])}async setDraft(t){let e=i=>i instanceof Error?i:new Error(String(i)),n=await this.getDb();if(!n){if(await this.ensureFallbackLoaded(),!t.accountName||!t.notePath)throw new Error(u("assets.invalid-draft"));t._id||(t._id=t.accountName+t.notePath);let i=this.fallbackDrafts[t._id];return i&&Xt(t,i)||(this.fallbackDrafts[t._id]={...t},await this.saveFallbackDrafts()),!0}return new Promise((i,r)=>{if(!t.accountName||!t.notePath)return r(new Error(u("assets.invalid-draft")));t._id||(t._id=t.accountName+t.notePath),n.get(t._id).then(a=>{if(Xt(t,a)){i(!0);return}else return t._rev=a._rev,n.put(t).then(()=>i(!0)).catch(()=>{i(!1)});i(!1)}).catch(a=>{if(a.status===404)return n.put(t).then(()=>i(!0)).catch(o=>{console.error("Error creating new draft:",o),r(e(o))});console.error("Error checking existing draft:",a),r(e(a))})})}},$e=Ge;$e.instance=null});function ye(d){return Xs.get(d)||"unknow error."}var Xs,ha=y(()=>{Xs=new Map([[-1,"\u7CFB\u7EDF\u7E41\u5FD9\uFF0C\u6B64\u65F6\u8BF7\u5F00\u53D1\u8005\u7A0D\u5019\u518D\u8BD5"],[0,"\u8BF7\u6C42\u6210\u529F"],[40001,"\u83B7\u53D6 access_token \u65F6 AppSecret \u9519\u8BEF\uFF0C\u6216\u8005 access_token \u65E0\u6548\u3002\u8BF7\u5F00\u53D1\u8005\u8BA4\u771F\u6BD4\u5BF9 AppSecret \u7684\u6B63\u786E\u6027\uFF0C\u6216\u67E5\u770B\u662F\u5426\u6B63\u5728\u4E3A\u6070\u5F53\u7684\u516C\u4F17\u53F7\u8C03\u7528\u63A5\u53E3"],[40002,"\u4E0D\u5408\u6CD5\u7684\u51ED\u8BC1\u7C7B\u578B"],[40003,"\u4E0D\u5408\u6CD5\u7684 OpenID \uFF0C\u8BF7\u5F00\u53D1\u8005\u786E\u8BA4 OpenID \uFF08\u8BE5\u7528\u6237\uFF09\u662F\u5426\u5DF2\u5173\u6CE8\u516C\u4F17\u53F7\uFF0C\u6216\u662F\u5426\u662F\u5176\u4ED6\u516C\u4F17\u53F7\u7684 OpenID"],[40004,"\u4E0D\u5408\u6CD5\u7684\u5A92\u4F53\u6587\u4EF6\u7C7B\u578B"],[40005,"\u4E0D\u5408\u6CD5\u7684\u6587\u4EF6\u7C7B\u578B"],[40006,"\u4E0D\u5408\u6CD5\u7684\u6587\u4EF6\u5927\u5C0F"],[40007,"\u4E0D\u5408\u6CD5\u7684\u5A92\u4F53\u6587\u4EF6 id"],[40008,"\u4E0D\u5408\u6CD5\u7684\u6D88\u606F\u7C7B\u578B"],[40009,"\u4E0D\u5408\u6CD5\u7684\u56FE\u7247\u6587\u4EF6\u5927\u5C0F"],[40010,"\u4E0D\u5408\u6CD5\u7684\u8BED\u97F3\u6587\u4EF6\u5927\u5C0F"],[40011,"\u4E0D\u5408\u6CD5\u7684\u89C6\u9891\u6587\u4EF6\u5927\u5C0F"],[40012,"\u4E0D\u5408\u6CD5\u7684\u7F29\u7565\u56FE\u6587\u4EF6\u5927\u5C0F"],[40013,"\u4E0D\u5408\u6CD5\u7684 AppID \uFF0C\u8BF7\u5F00\u53D1\u8005\u68C0\u67E5 AppID \u7684\u6B63\u786E\u6027\uFF0C\u907F\u514D\u5F02\u5E38\u5B57\u7B26\uFF0C\u6CE8\u610F\u5927\u5C0F\u5199"],[40014,"\u4E0D\u5408\u6CD5\u7684 access_token \uFF0C\u8BF7\u5F00\u53D1\u8005\u8BA4\u771F\u6BD4\u5BF9 access_token \u7684\u6709\u6548\u6027\uFF08\u5982\u662F\u5426\u8FC7\u671F\uFF09\uFF0C\u6216\u67E5\u770B\u662F\u5426\u6B63\u5728\u4E3A\u6070\u5F53\u7684\u516C\u4F17\u53F7\u8C03\u7528\u63A5\u53E3"],[40015,"\u4E0D\u5408\u6CD5\u7684\u83DC\u5355\u7C7B\u578B"],[40016,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE\u4E2A\u6570"],[40017,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE\u7C7B\u578B"],[40018,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE\u540D\u5B57\u957F\u5EA6"],[40019,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE KEY \u957F\u5EA6"],[40020,"\u4E0D\u5408\u6CD5\u7684\u6309\u94AE URL \u957F\u5EA6"],[40021,"\u4E0D\u5408\u6CD5\u7684\u83DC\u5355\u7248\u672C\u53F7"],[40022,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u7EA7\u6570"],[40023,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE\u4E2A\u6570"],[40024,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE\u7C7B\u578B"],[40025,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE\u540D\u5B57\u957F\u5EA6"],[40026,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE KEY \u957F\u5EA6"],[40027,"\u4E0D\u5408\u6CD5\u7684\u5B50\u83DC\u5355\u6309\u94AE URL \u957F\u5EA6"],[40028,"\u4E0D\u5408\u6CD5\u7684\u81EA\u5B9A\u4E49\u83DC\u5355\u4F7F\u7528\u7528\u6237"],[40029,"\u65E0\u6548\u7684 oauth_code"],[40030,"\u4E0D\u5408\u6CD5\u7684 refresh_token"],[40031,"\u4E0D\u5408\u6CD5\u7684 openid \u5217\u8868"],[40032,"\u4E0D\u5408\u6CD5\u7684 openid \u5217\u8868\u957F\u5EA6"],[40033,"\u4E0D\u5408\u6CD5\u7684\u8BF7\u6C42\u5B57\u7B26\uFF0C\u4E0D\u80FD\u5305\u542B \\uxxxx \u683C\u5F0F\u7684\u5B57\u7B26"],[40035,"\u4E0D\u5408\u6CD5\u7684\u53C2\u6570"],[40038,"\u4E0D\u5408\u6CD5\u7684\u8BF7\u6C42\u683C\u5F0F"],[40039,"\u4E0D\u5408\u6CD5\u7684 URL \u957F\u5EA6"],[40048,"\u65E0\u6548\u7684url"],[40050,"\u4E0D\u5408\u6CD5\u7684\u5206\u7EC4 id"],[40051,"\u5206\u7EC4\u540D\u5B57\u4E0D\u5408\u6CD5"],[40060,"\u5220\u9664\u5355\u7BC7\u56FE\u6587\u65F6\uFF0C\u6307\u5B9A\u7684 article_idx \u4E0D\u5408\u6CD5"],[40117,"\u5206\u7EC4\u540D\u5B57\u4E0D\u5408\u6CD5"],[40118,"media_id \u5927\u5C0F\u4E0D\u5408\u6CD5"],[40119,"button \u7C7B\u578B\u9519\u8BEF"],[40120,"\u5B50 button \u7C7B\u578B\u9519\u8BEF"],[40121,"\u4E0D\u5408\u6CD5\u7684 media_id \u7C7B\u578B"],[40125,"\u65E0\u6548\u7684appsecret"],[40132,"\u5FAE\u4FE1\u53F7\u4E0D\u5408\u6CD5"],[40137,"\u4E0D\u652F\u6301\u7684\u56FE\u7247\u683C\u5F0F"],[40155,"\u8BF7\u52FF\u6DFB\u52A0\u5176\u4ED6\u516C\u4F17\u53F7\u7684\u4E3B\u9875\u94FE\u63A5"],[40163,"oauth_code\u5DF2\u4F7F\u7528"],[40164,"IP\u5730\u5740\u4E0D\u5728\u767D\u540D\u5355\u4E0A\uFF0C\u5C06ip\u6DFB\u52A0\u5230ip\u767D\u540D\u5355\u5217\u8868\u5373\u53EF"],[40227,"\u6807\u9898\u4E3A\u7A7A"],[40243,"AppSecret\u5DF2\u88AB\u51BB\u7ED3\uFF0C\u8BF7\u767B\u5F55MP\u89E3\u51BB\u540E\u518D\u6B21\u8C03\u7528"],[40249,"\u4E0D\u652F\u6301\u4E0B\u53D1\u8425\u9500/\u63A8\u5E7F\u7C7B\u7684\u6D88\u606F\u5185\u5BB9"],[40250,"\u4E0B\u53D1\u6D88\u606F\u5185\u5BB9\u4E0D\u89C4\u8303\uFF08\u5305\u542B\u7A7A\u503C\u7B49\uFF09\uFF0C\u5EFA\u8BAE\u68C0\u67E5\u5185\u5BB9\u89C4\u8303\u6027\u540E\u518D\u4E0B\u53D1"],[40251,"\u56E0\u5386\u53F2\u8FDD\u89C4\u5BFC\u81F4\u5E73\u53F0\u9650\u5236\u8D26\u53F7\u8C03\u7528\u4E0A\u9650\uFF0C\u5F53\u524D\u5DF2\u5230\u8FBE\u4E0B\u53D1\u4E0A\u9650"],[40252,"\u6B63\u5728\u8C03\u7528\u7684\u6A21\u677F\u4E0B\u53D1\u7684\u90E8\u5206\u5185\u5BB9\u5DF2\u8FDB\u5165\u5E73\u53F0\u5BA1\u6838\u6D41\u7A0B\uFF0C\u5728\u5BA1\u6838\u5B8C\u6210\u524D\uFF0C\u76F8\u5173\u5185\u5BB9\u6682\u65F6\u65E0\u6CD5\u4E0B\u53D1"],[41001,"\u7F3A\u5C11 access_token \u53C2\u6570"],[41002,"\u7F3A\u5C11 appid \u53C2\u6570"],[41003,"\u7F3A\u5C11 refresh_token \u53C2\u6570"],[41004,"\u7F3A\u5C11 secret \u53C2\u6570"],[41005,"\u7F3A\u5C11\u591A\u5A92\u4F53\u6587\u4EF6\u6570\u636E"],[41006,"\u7F3A\u5C11 media_id \u53C2\u6570"],[41007,"\u7F3A\u5C11\u5B50\u83DC\u5355\u6570\u636E"],[41008,"\u7F3A\u5C11 oauth code"],[41009,"\u7F3A\u5C11 openid"],[42001,"access_token \u8D85\u65F6\uFF0C\u8BF7\u68C0\u67E5 access_token \u7684\u6709\u6548\u671F\uFF0C\u8BF7\u53C2\u8003\u57FA\u7840\u652F\u6301 - \u83B7\u53D6 access_token \u4E2D\uFF0C\u5BF9 access_token \u7684\u8BE6\u7EC6\u673A\u5236\u8BF4\u660E"],[42002,"refresh_token \u8D85\u65F6"],[42003,"oauth_code \u8D85\u65F6"],[42007,"\u7528\u6237\u4FEE\u6539\u5FAE\u4FE1\u5BC6\u7801\uFF0C accesstoken \u548C refreshtoken \u5931\u6548\uFF0C\u9700\u8981\u91CD\u65B0\u6388\u6743"],[42010,"\u76F8\u540C media_id \u7FA4\u53D1\u8FC7\u5FEB\uFF0C\u8BF7\u91CD\u8BD5"],[43001,"\u9700\u8981 GET \u8BF7\u6C42"],[43002,"\u9700\u8981 POST \u8BF7\u6C42"],[43003,"\u9700\u8981 HTTPS \u8BF7\u6C42"],[43004,"\u9700\u8981\u63A5\u6536\u8005\u5173\u6CE8"],[43005,"\u9700\u8981\u597D\u53CB\u5173\u7CFB"],[43019,"\u9700\u8981\u5C06\u63A5\u6536\u8005\u4ECE\u9ED1\u540D\u5355\u4E2D\u79FB\u9664"],[43116,"\u8BE5\u6A21\u677F\u56E0\u6EE5\u7528\u88AB\u6EE5\u7528\u8FC7\u591A\uFF0C\u5DF2\u88AB\u9650\u5236\u4E0B\u53D1"],[44001,"\u591A\u5A92\u4F53\u6587\u4EF6\u4E3A\u7A7A"],[44002,"POST \u7684\u6570\u636E\u5305\u4E3A\u7A7A"],[44003,"\u56FE\u6587\u6D88\u606F\u5185\u5BB9\u4E3A\u7A7A"],[44004,"\u6587\u672C\u6D88\u606F\u5185\u5BB9\u4E3A\u7A7A"],[44008,"\u97F3\u9891\u5185\u5BB9\u5BA1\u6838\u5931\u8D25"],[44009,"\u56FE\u6587\u4E2D\u7684\u97F3\u9891\u5185\u5BB9\u5BA1\u6838\u5931\u8D25"],[45001,"\u591A\u5A92\u4F53\u6587\u4EF6\u5927\u5C0F\u8D85\u8FC7\u9650\u5236"],[45002,"\u6D88\u606F\u5185\u5BB9\u8D85\u8FC7\u9650\u5236"],[45003,"\u6807\u9898\u5B57\u6BB5\u8D85\u8FC7\u9650\u5236"],[45004,"\u63CF\u8FF0\u5B57\u6BB5\u8D85\u8FC7\u9650\u5236"],[45005,"\u94FE\u63A5\u5B57\u6BB5\u8D85\u8FC7\u9650\u5236"],[45006,"\u56FE\u7247\u94FE\u63A5\u5B57\u6BB5\u8D85\u8FC7\u9650\u5236"],[45007,"\u8BED\u97F3\u64AD\u653E\u65F6\u95F4\u8D85\u8FC7\u9650\u5236"],[45008,"\u56FE\u6587\u6D88\u606F\u8D85\u8FC7\u9650\u5236"],[45009,"\u63A5\u53E3\u8C03\u7528\u8D85\u8FC7\u9650\u5236"],[45010,"\u521B\u5EFA\u83DC\u5355\u4E2A\u6570\u8D85\u8FC7\u9650\u5236"],[45011,"API \u8C03\u7528\u592A\u9891\u7E41\uFF0C\u8BF7\u7A0D\u5019\u518D\u8BD5"],[45015,"\u56DE\u590D\u65F6\u95F4\u8D85\u8FC7\u9650\u5236"],[45016,"\u7CFB\u7EDF\u5206\u7EC4\uFF0C\u4E0D\u5141\u8BB8\u4FEE\u6539"],[45017,"\u5206\u7EC4\u540D\u5B57\u8FC7\u957F"],[45018,"\u5206\u7EC4\u6570\u91CF\u8D85\u8FC7\u4E0A\u9650"],[45047,"\u5BA2\u670D\u63A5\u53E3\u4E0B\u884C\u6761\u6570\u8D85\u8FC7\u4E0A\u9650"],[45064,"\u521B\u5EFA\u83DC\u5355\u5305\u542B\u672A\u5173\u8054\u7684\u5C0F\u7A0B\u5E8F"],[45065,"\u76F8\u540C clientmsgid \u5DF2\u5B58\u5728\u7FA4\u53D1\u8BB0\u5F55\uFF0C\u8FD4\u56DE\u6570\u636E\u4E2D\u5E26\u6709\u5DF2\u5B58\u5728\u7684\u7FA4\u53D1\u4EFB\u52A1\u7684 msgid"],[45066,"\u76F8\u540C clientmsgid \u91CD\u8BD5\u901F\u5EA6\u8FC7\u5FEB\uFF0C\u8BF7\u95F4\u96941\u5206\u949F\u91CD\u8BD5"],[45067,"clientmsgid \u957F\u5EA6\u8D85\u8FC7\u9650\u5236"],[45110,"\u4F5C\u8005\u5B57\u6570\u8D85\u51FA\u9650\u5236"],[46001,"\u4E0D\u5B58\u5728\u5A92\u4F53\u6570\u636E"],[46002,"\u4E0D\u5B58\u5728\u7684\u83DC\u5355\u7248\u672C"],[46003,"\u4E0D\u5B58\u5728\u7684\u83DC\u5355\u6570\u636E"],[46004,"\u4E0D\u5B58\u5728\u7684\u7528\u6237"],[47001,"\u89E3\u6790 JSON/XML \u5185\u5BB9\u9519\u8BEF"],[47003,"\u53C2\u6570\u503C\u4E0D\u7B26\u5408\u9650\u5236\u8981\u6C42\uFF0C\u8BE6\u60C5\u53EF\u53C2\u8003\u53C2\u6570\u503C\u5185\u5BB9\u9650\u5236\u8BF4\u660E"],[48001,"api \u529F\u80FD\u672A\u6388\u6743\uFF0C\u8BF7\u786E\u8BA4\u516C\u4F17\u53F7\u5DF2\u83B7\u5F97\u8BE5\u63A5\u53E3\uFF0C\u53EF\u4EE5\u5728\u516C\u4F17\u5E73\u53F0\u5B98\u7F51 - \u5F00\u53D1\u8005\u4E2D\u5FC3\u9875\u4E2D\u67E5\u770B\u63A5\u53E3\u6743\u9650"],[48002,"\u7C89\u4E1D\u62D2\u6536\u6D88\u606F\uFF08\u7C89\u4E1D\u5728\u516C\u4F17\u53F7\u9009\u9879\u4E2D\uFF0C\u5173\u95ED\u4E86 \u201C \u63A5\u6536\u6D88\u606F \u201D \uFF09"],[48004,"api \u63A5\u53E3\u88AB\u5C01\u7981\uFF0C\u8BF7\u767B\u5F55 mp.weixin.qq.com \u67E5\u770B\u8BE6\u60C5"],[48005,"api \u7981\u6B62\u5220\u9664\u88AB\u81EA\u52A8\u56DE\u590D\u548C\u81EA\u5B9A\u4E49\u83DC\u5355\u5F15\u7528\u7684\u7D20\u6750"],[48006,"api \u7981\u6B62\u6E05\u96F6\u8C03\u7528\u6B21\u6570\uFF0C\u56E0\u4E3A\u6E05\u96F6\u6B21\u6570\u8FBE\u5230\u4E0A\u9650"],[48008,"\u6CA1\u6709\u8BE5\u7C7B\u578B\u6D88\u606F\u7684\u53D1\u9001\u6743\u9650"],[48021,"\u81EA\u52A8\u4FDD\u5B58\u7684\u8349\u7A3F\u65E0\u6CD5\u9884\u89C8/\u53D1\u9001\uFF0C\u8BF7\u5148\u624B\u52A8\u4FDD\u5B58\u8349\u7A3F"],[50001,"\u7528\u6237\u672A\u6388\u6743\u8BE5 api"],[50002,"\u7528\u6237\u53D7\u9650\uFF0C\u53EF\u80FD\u662F\u8FDD\u89C4\u540E\u63A5\u53E3\u88AB\u5C01\u7981"],[50005,"\u7528\u6237\u672A\u5173\u6CE8\u516C\u4F17\u53F7"],[53500,"\u53D1\u5E03\u529F\u80FD\u88AB\u5C01\u7981"],[53501,"\u9891\u7E41\u8BF7\u6C42\u53D1\u5E03"],[53502,"Publish ID \u65E0\u6548"],[53600,"Article ID \u65E0\u6548"],[61451,"\u53C2\u6570\u9519\u8BEF (invalid parameter)"],[61452,"\u65E0\u6548\u5BA2\u670D\u8D26\u53F7 (invalid kf_account)"],[61453,"\u5BA2\u670D\u8D26\u53F7\u5DF2\u5B58\u5728 (kf_account exsited)"],[61454,"\u5BA2\u670D\u8D26\u53F7\u540D\u957F\u5EA6\u8D85\u8FC7\u9650\u5236 ( \u4EC5\u5141\u8BB8 10 \u4E2A\u82F1\u6587\u5B57\u7B26\uFF0C\u4E0D\u5305\u62EC @ \u53CA @ \u540E\u7684\u516C\u4F17\u53F7\u7684\u5FAE\u4FE1\u53F7 )(invalid   kf_acount length)"],[61455,"\u5BA2\u670D\u8D26\u53F7\u540D\u5305\u542B\u975E\u6CD5\u5B57\u7B26 ( \u4EC5\u5141\u8BB8\u82F1\u6587 + \u6570\u5B57 )(illegal character in     kf_account)"],[61456,"\u5BA2\u670D\u8D26\u53F7\u4E2A\u6570\u8D85\u8FC7\u9650\u5236 (10 \u4E2A\u5BA2\u670D\u8D26\u53F7 )(kf_account count exceeded)"],[61457,"\u65E0\u6548\u5934\u50CF\u6587\u4EF6\u7C7B\u578B (invalid   file type)"],[61450,"\u7CFB\u7EDF\u9519\u8BEF (system error)"],[61500,"\u65E5\u671F\u683C\u5F0F\u9519\u8BEF"],[63001,"\u90E8\u5206\u53C2\u6570\u4E3A\u7A7A"],[63002,"\u65E0\u6548\u7684\u7B7E\u540D"],[65301,"\u4E0D\u5B58\u5728\u6B64 menuid \u5BF9\u5E94\u7684\u4E2A\u6027\u5316\u83DC\u5355"],[65302,"\u6CA1\u6709\u76F8\u5E94\u7684\u7528\u6237"],[65303,"\u6CA1\u6709\u9ED8\u8BA4\u83DC\u5355\uFF0C\u4E0D\u80FD\u521B\u5EFA\u4E2A\u6027\u5316\u83DC\u5355"],[65304,"MatchRule \u4FE1\u606F\u4E3A\u7A7A"],[65305,"\u4E2A\u6027\u5316\u83DC\u5355\u6570\u91CF\u53D7\u9650"],[65306,"\u4E0D\u652F\u6301\u4E2A\u6027\u5316\u83DC\u5355\u7684\u8D26\u53F7"],[65307,"\u4E2A\u6027\u5316\u83DC\u5355\u4FE1\u606F\u4E3A\u7A7A"],[65308,"\u5305\u542B\u6CA1\u6709\u54CD\u5E94\u7C7B\u578B\u7684 button"],[65309,"\u4E2A\u6027\u5316\u83DC\u5355\u5F00\u5173\u5904\u4E8E\u5173\u95ED\u72B6\u6001"],[65310,"\u586B\u5199\u4E86\u7701\u4EFD\u6216\u57CE\u5E02\u4FE1\u606F\uFF0C\u56FD\u5BB6\u4FE1\u606F\u4E0D\u80FD\u4E3A\u7A7A"],[65311,"\u586B\u5199\u4E86\u57CE\u5E02\u4FE1\u606F\uFF0C\u7701\u4EFD\u4FE1\u606F\u4E0D\u80FD\u4E3A\u7A7A"],[65312,"\u4E0D\u5408\u6CD5\u7684\u56FD\u5BB6\u4FE1\u606F"],[65313,"\u4E0D\u5408\u6CD5\u7684\u7701\u4EFD\u4FE1\u606F"],[65314,"\u4E0D\u5408\u6CD5\u7684\u57CE\u5E02\u4FE1\u606F"],[65316,"\u8BE5\u516C\u4F17\u53F7\u7684\u83DC\u5355\u8BBE\u7F6E\u4E86\u8FC7\u591A\u7684\u57DF\u540D\u5916\u8DF3\uFF08\u6700\u591A\u8DF3\u8F6C\u5230 3 \u4E2A\u57DF\u540D\u7684\u94FE\u63A5\uFF09"],[65317,"\u4E0D\u5408\u6CD5\u7684 URL"],[87009,"\u65E0\u6548\u7684\u7B7E\u540D"],[89503,"\u6B64\u6B21\u8C03\u7528\u9700\u8981\u7BA1\u7406\u5458\u786E\u8BA4\uFF0C\u8BF7\u8010\u5FC3\u7B49\u5019"],[89506,"\u8BE5IP\u8C03\u7528\u6C42\u8BF7\u6C42\u5DF2\u88AB\u516C\u4F17\u53F7\u7BA1\u7406\u5458\u62D2\u7EDD\uFF0C\u8BF724\u5C0F\u65F6\u540E\u518D\u8BD5\uFF0C\u5EFA\u8BAE\u8C03\u7528\u524D\u4E0E\u7BA1\u7406\u5458\u6C9F\u901A\u786E\u8BA4"],[89507,"\u8BE5IP\u8C03\u7528\u6C42\u8BF7\u6C42\u5DF2\u88AB\u516C\u4F17\u53F7\u7BA1\u7406\u5458\u62D2\u7EDD\uFF0C\u8BF71\u5C0F\u65F6\u540E\u518D\u8BD5\uFF0C\u5EFA\u8BAE\u8C03\u7528\u524D\u4E0E\u7BA1\u7406\u5458\u6C9F\u901A\u786E\u8BA4"],[900100,"	POST \u6570\u636E\u53C2\u6570\u4E0D\u5408\u6CD5"],[900100,"	\u8FDC\u7AEF\u670D\u52A1\u4E0D\u53EF\u7528"],[900100,"	Ticket \u4E0D\u5408\u6CD5"],[900100,"	\u83B7\u53D6\u6447\u5468\u8FB9\u7528\u6237\u4FE1\u606F\u5931\u8D25"],[900100,"	\u83B7\u53D6\u5546\u6237\u4FE1\u606F\u5931\u8D25"],[900100,"	\u83B7\u53D6 OpenID \u5931\u8D25"],[900100,"	\u4E0A\u4F20\u6587\u4EF6\u7F3A\u5931"],[900100,"	\u4E0A\u4F20\u7D20\u6750\u7684\u6587\u4EF6\u7C7B\u578B\u4E0D\u5408\u6CD5"],[900100,"	\u4E0A\u4F20\u7D20\u6750\u7684\u6587\u4EF6\u5C3A\u5BF8\u4E0D\u5408\u6CD5"],[900101,"	\u4E0A\u4F20\u5931\u8D25"],[900102,"	\u8D26\u53F7\u4E0D\u5408\u6CD5"],[900102,"	\u5DF2\u6709\u8BBE\u5907\u6FC0\u6D3B\u7387\u4F4E\u4E8E 50% \uFF0C\u4E0D\u80FD\u65B0\u589E\u8BBE\u5907"],[900102,"	\u8BBE\u5907\u7533\u8BF7\u6570\u4E0D\u5408\u6CD5\uFF0C\u5FC5\u987B\u4E3A\u5927\u4E8E 0 \u7684\u6570\u5B57"],[900102,"	\u5DF2\u5B58\u5728\u5BA1\u6838\u4E2D\u7684\u8BBE\u5907 ID \u7533\u8BF7"],[900102,"	\u4E00\u6B21\u67E5\u8BE2\u8BBE\u5907 ID \u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7 50"],[900102,"	\u8BBE\u5907 ID \u4E0D\u5408\u6CD5"],[900102,"	\u9875\u9762 ID \u4E0D\u5408\u6CD5"],[900102,"	\u9875\u9762\u53C2\u6570\u4E0D\u5408\u6CD5"],[900102,"	\u4E00\u6B21\u5220\u9664\u9875\u9762 ID \u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7 10"],[900102,"	\u9875\u9762\u5DF2\u5E94\u7528\u5728\u8BBE\u5907\u4E2D\uFF0C\u8BF7\u5148\u89E3\u9664\u5E94\u7528\u5173\u7CFB\u518D\u5220\u9664"],[900103,"	\u4E00\u6B21\u67E5\u8BE2\u9875\u9762 ID \u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7 50"],[900103,"	\u65F6\u95F4\u533A\u95F4\u4E0D\u5408\u6CD5"],[900103,"	\u4FDD\u5B58\u8BBE\u5907\u4E0E\u9875\u9762\u7684\u7ED1\u5B9A\u5173\u7CFB\u53C2\u6570\u9519\u8BEF"],[900103,"	\u95E8\u5E97 ID \u4E0D\u5408\u6CD5"],[900103,"	\u8BBE\u5907\u5907\u6CE8\u4FE1\u606F\u8FC7\u957F"],[900103,"	\u8BBE\u5907\u7533\u8BF7\u53C2\u6570\u4E0D\u5408\u6CD5"],[900103,"	\u67E5\u8BE2\u8D77\u59CB\u503C begin \u4E0D\u5408\u6CD5"],[40114,"invalid index value"],[41039,"invalid content_source_url"],[45166,"invalid content"],[88e3,"without comment privilege"]])});function Qs(d){let t=/\b(?:\d{1,3}\.){3}\d{1,3}\b/g,e=/(?:::ffff:)?([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::(?:ffff:)?(?:\d{1,3}\.){3}\d{1,3}/g,n=d.match(t)||[],i=d.match(e)||[];return{ipv4:n,ipv6:i}}var $,Ke,Me,Tt=y(()=>{$=require("obsidian");ha();de();Ke=class{constructor(t){this.baseUrl="https://api.weixin.qq.com/cgi-bin";this.plugin=t}static getInstance(t){return Ke.instance||(Ke.instance=new Ke(t)),Ke.instance}static resetInstance(){Ke.instance=null}async requestToken(){let t="https://wewrite.3thinking.cn/mp_token",e=this.plugin.getSelectedMPAccount();if(e===void 0)return new $.Notice(u("wechat-api.select-an-wechat-mp-account-first")),null;let{appId:n,appSecret:i,doc_id:r}=e,a;r===void 0||!r?a={app_id:n,secret:i}:a={doc_id:r};try{let o=await(0,$.requestUrl)({method:"POST",url:t,headers:{"Content-Type":"application/json"},throw:!1,body:JSON.stringify(a)});if(o.status!==200)return new $.Notice(o.text,0),null;let{code:s,data:l}=o.json;if(s!==0){if(s==-2)return e.doc_id=void 0,this.plugin.saveSettings(),await this.requestToken();if(s==-10&&l.errcode===40164){let{ipv4:c}=Qs(l.errmsg);c[0]!==void 0&&c[0]&&new $.Notice(u("wechat-api.add-ip-address-ipv4-0-to-wechat-mp-ip-wh",[c[0]]))}return null}return l.last_token===void 0?(new $.Notice(u("wechat-api.failed-to-get-wechat-access-token"),0),null):(e.access_token=l.last_token,e.doc_id=l.doc_id,e.expires_in=l.expiretime,e.lastRefreshTime=new Date().getTime(),this.plugin.saveSettings(),l.last_token)}catch(o){return console.error("Get wechat access token error:",o),new $.Notice(u("wechat-api.failed-to-get-wechat-access-token"),0),null}}getHeaders(){return{"Accept-Encoding":"gzip, deflate, br","Accept-Language":"zh-CN,zh;q=0.9,en;q=0.8"}}async getAccessToken(t,e){let i={url:`${this.baseUrl}/token?grant_type=client_credential&appid=${t}&secret=${e}`,method:"GET",headers:this.getHeaders()},r=await(0,$.requestUrl)(i),{access_token:a,errcode:o,expires_in:s}=r.json;return a===void 0?(new $.Notice(ye(o),0),!1):{access_token:a,expires_in:s}}async getAccountBasicInfo(t){let e=t!=null?t:this.plugin.settings.selectedMPAccount;if(!e)return new $.Notice(u("wechat-api.select-an-wechat-mp-account-first")),null;let n=await this.plugin.refreshAccessToken(e);if(!n)return null;let i=`${this.baseUrl}/account/getaccountbasicinfo?access_token=${n}`,r=await(0,$.requestUrl)({method:"GET",url:i,throw:!1}),{errcode:a}=r.json;return a!==void 0&&a!==0?(new $.Notice(ye(a),0),null):r.json}async getBatchMaterial(t,e,n=0,i=10){let r=await this.plugin.refreshAccessToken(t);if(!r)return!1;let a="https://api.weixin.qq.com/cgi-bin/material/batchget_material?access_token="+r;return await(await(0,$.requestUrl)({method:"POST",url:a,throw:!1,body:JSON.stringify({type:e,offset:n,count:i})})).json}async sendArticleToDraftBox(t,e){let n=await this.plugin.refreshAccessToken(this.plugin.settings.selectedMPAccount);if(!n)return!1;let i="https://api.weixin.qq.com/cgi-bin/draft/add?access_token="+n,r={articles:[{title:t.title,content:e,digest:t.digest,thumb_media_id:t.thumb_media_id,...t.content_source_url&&{content_source_url:t.content_source_url},...t.need_open_comment!==void 0&&{need_open_comment:t.need_open_comment},...t.only_fans_can_comment!==void 0&&{only_fans_can_comment:t.only_fans_can_comment},...t.pic_crop_235_1&&{pic_crop_235_1:t.pic_crop_235_1},...t.pic_crop_1_1&&{pic_crop_1_1:t.pic_crop_1_1},...t.author&&{author:t.author}}]},a=await(0,$.requestUrl)({method:"POST",url:i,throw:!1,body:JSON.stringify(r)}),{errcode:o,media_id:s}=a.json;return o!==void 0&&o!==0?(new $.Notice(ye(o),0),!1):(new $.Notice(u("wechat-api.send-article-to-draft-box-successfully")),s)}async uploadXMaterial(t,e,n){if(n==="video"){if(t.size>1024*1024*10)return new $.Notice(u("wechat-api.video-size-exceeds-10m")),!1}else if(n==="voice"){if(t.size>1024*1024*2)return new $.Notice(u("wechat-api.voice-size-exceeds-2m")),!1}else if(t.size>1024*1024*10)return new $.Notice(u("wechat-api.image-size-exceeds-10m")),!1;let i=await this.plugin.refreshAccessToken(this.plugin.settings.selectedMPAccount);if(!i)return!1;let r=`https://api.weixin.qq.com/cgi-bin/media/uploadimg?access_token=${i}`;n===void 0&&t.size>=1024*1024&&(n="image"),n!==void 0&&(r=`https://api.weixin.qq.com/cgi-bin/material/add_material?access_token=${i}&type=${n}`);let a=16,o="one2mpBoundary"+Array(a+1).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,a),s=[],l=JSON.stringify({title:"title of video",content:"content of video"});s.push(`--${o}\r
Content-Disposition: form-data; name="media"; filename="${e}"\r
Content-Type: "application/octet-stream"\r
\r
`);let c=await(0,$.getBlobArrayBuffer)(t);s.push(c),s.push(`\r
`),n==="video"&&s.push(`--${o}\r
Content-Disposition: form-data; name="description"\r
Content-Type: application/json\r
\r
`+l+`\r
`),s.push(`--${o}--\r
`);let p=new TextEncoder,h=s.map(A=>typeof A=="string"?p.encode(A):A),g=await new Blob(h).arrayBuffer(),m={method:"POST",url:r,contentType:`multipart/form-data; boundary=${o}`,body:g},v=await(await(0,$.requestUrl)(m)).json;return(v.errcode===void 0||v.errcode==0)&&this.plugin.messageService.sendMessage(n+"-item-updated",v),{url:v.url||"",media_id:v.media_id||"",errcode:v.errcode||0,errmsg:v.errmsg||""}}async uploadMaterial(t,e,n){if(n==="video"){if(t.size>1024*1024*10)return new $.Notice(u("wechat-api.video-size-exceeds-10m")),!1}else if(n==="voice"){if(t.size>1024*1024*2)return new $.Notice(u("wechat-api.voice-size-exceeds-2m")),!1}else if(t.size>1024*1024*10)return new $.Notice(u("wechat-api.image-size-exceeds-10m")),!1;let i=await this.plugin.refreshAccessToken(this.plugin.settings.selectedMPAccount);if(!i)return!1;let r=`https://api.weixin.qq.com/cgi-bin/media/uploadimg?access_token=${i}`;n===void 0&&t.size>=1024*1024&&(n="image"),n!==void 0&&(r=`https://api.weixin.qq.com/cgi-bin/material/add_material?access_token=${i}&type=${n}`);let a={title:"title of video",introduction:"content of video"},o=await(0,$.getBlobArrayBuffer)(t),s=e,l="----WebKitFormBoundary"+Math.random().toString(36).substring(2),c=[];c.push(`--${l}\r
Content-Disposition: form-data; name="media"; filename="${s}"\r
Content-Type: application/octet-stream\r
\r
`),c.push(new Uint8Array(o)),c.push(`\r
`),n==="video"&&a&&c.push(`--${l}\r
Content-Disposition: form-data; name="description"\r
Content-Type: application/json\r
\r
`+JSON.stringify(a)+`\r
`),c.push(`--${l}--\r
`);let p=new TextEncoder,h=c.map(g=>typeof g=="string"?p.encode(g):g).reduce((g,m)=>{let f=new Uint8Array(g.length+m.length);return f.set(g),f.set(m,g.length),f},new Uint8Array(0));try{this.plugin.showSpinner(u("wechat-api.uploading-material-type",[n||"unknown"]));let g=await(0,$.requestUrl)({url:r,method:"POST",headers:{"Content-Type":`multipart/form-data; boundary=${l}`},body:h.buffer});this.plugin.hideSpinner();let m=await g.json;return m.errcode!==void 0&&m.errcode!==0?(console.error("\u4E0A\u4F20\u7D20\u6750\u5931\u8D25:",m),new $.Notice(ye(m.errcode)||m.errmsg||"\u4E0A\u4F20\u7D20\u6750\u5931\u8D25",0),null):(this.plugin.messageService.sendMessage(n+"-item-updated",m),{url:m.url||"",media_id:m.media_id||"",errcode:m.errcode||0,errmsg:m.errmsg||""})}catch(g){throw this.plugin.hideSpinner(),console.error("\u4E0A\u4F20\u7D20\u6750\u65F6\u51FA\u9519:",g),g}}async getMaterialList(t,e,n=0,i=20){let r=await this.plugin.refreshAccessToken(t);if(!r)return!1;let a=`${this.baseUrl}/material/batchget_material?access_token=${r}`,o={type:e,offset:n,count:i},s={url:a,method:"POST",headers:this.getHeaders(),body:JSON.stringify(o)};return(await(0,$.requestUrl)(s)).json}async getMaterialById(t,e){if(!t)return!1;e===void 0&&(e=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(e);if(!n)return!1;let i=`${this.baseUrl}/material/get_material?access_token=${n}`,r={media_id:t},a={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(r)};return(await(0,$.requestUrl)(a)).json}async getBatchDraftList(t,e=0,n=20){let i=await this.plugin.refreshAccessToken(t);if(!i)return!1;let r=`${this.baseUrl}/draft/batchget?access_token=${i}`,a={offset:e,count:n,no_content:!1},o={url:r,method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)};return(await(0,$.requestUrl)(o)).json}async getMaterialCounts(t){let e=await this.plugin.refreshAccessToken(t);if(!e)return!1;let i={url:`${this.baseUrl}/material/get_materialcount?access_token=${e}`,method:"GET",headers:this.getHeaders()},r=await(0,$.requestUrl)(i),{errcode:a}=r.json;return a!==void 0&&a!==0?(new $.Notice(ye(a),0),!1):r.json}async getDraftCount(t){let e=await this.plugin.refreshAccessToken(t);if(!e)return!1;let i={url:`${this.baseUrl}/draft/count?access_token=${e}`,method:"GET",headers:this.getHeaders()},r=await(0,$.requestUrl)(i),{errcode:a,total_count:o}=r.json;return a!==void 0&&a!==0?(new $.Notice(ye(a),0),!1):o}async getDraftById(t,e){let n=await this.plugin.refreshAccessToken(t);if(!n)return!1;let i=`${this.baseUrl}/draft/get?access_token=${n}`,r={media_id:e},a={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(r)},o=await(0,$.requestUrl)(a),{errcode:s,news_item:l}=o.json;return s!==void 0&&s!==0?(new $.Notice(ye(s),0),!1):l}async publishDraft(t,e=""){e||(e=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(e);if(!n)return!1;let i=`${this.baseUrl}/freepublish/submit?access_token=${n}`,r={media_id:t},a={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(r)},o=await(0,$.requestUrl)(a),{errcode:s,publish_id:l}=o.json;return s!==void 0&&s!==0?(new $.Notice(ye(s),0),!1):l}async deleteMedia(t,e=""){e||(e=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(e);if(!n)return!1;let i=`${this.baseUrl}/material/del_material?access_token=${n}`,r={media_id:t},a={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(r)},o=await(0,$.requestUrl)(a),{errcode:s}=o.json;return s!==void 0&&s!==0?(new $.Notice(ye(s),0),!1):!0}async deleteDraft(t,e=""){e||(e=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(e);if(!n)return!1;let i=`${this.baseUrl}/draft/delete?access_token=${n}`,r={media_id:t},a={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(r)},o=await(0,$.requestUrl)(a),{errcode:s}=o.json;return s!==void 0&&s!==0?(new $.Notice(ye(s),0),!1):!0}async massSendAll(t,e=""){e||(e=this.plugin.settings.selectedMPAccount);let n=await this.plugin.refreshAccessToken(e);if(!n)return!1;let i=`${this.baseUrl}/message/mass/sendall?access_token=${n}`,r={filter:{is_to_all:!0},mpnews:{media_id:t},msgtype:"mpnews"},a={url:i,method:"POST",headers:this.getHeaders(),body:JSON.stringify(r)},o=await(0,$.requestUrl)(a),{errcode:s}=o.json;return s!==void 0&&s!==0?(new $.Notice(ye(s),0),!1):!0}async senfForPreview(t,e="",n=""){n||(n=this.plugin.settings.selectedMPAccount),e||(e=this.plugin.settings.previewer_wxname);let i=await this.plugin.refreshAccessToken(n);if(!i)return!1;let r=`${this.baseUrl}/message/mass/preview?access_token=${i}`,a={towxname:e,mpnews:{media_id:t},msgtype:"mpnews"},o={url:r,method:"POST",headers:this.getHeaders(),body:JSON.stringify(a)},s=await(0,$.requestUrl)(o),{errcode:l}=s.json;return l!==void 0&&l!==0?(new $.Notice(ye(l),0),!1):!0}},Me=Ke;Me.instance=null});function Zn(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}function ba(d){Ye=d}function W(d,t=""){let e=typeof d=="string"?d:d.source,n={replace:(i,r)=>{let a=typeof r=="string"?r:r.source;return a=a.replace(ve.caret,"$1"),e=e.replace(i,a),n},getRegex:()=>new RegExp(e,t)};return n}function _e(d,t){if(t){if(ve.escapeTest.test(d))return d.replace(ve.escapeReplace,ga)}else if(ve.escapeTestNoEncode.test(d))return d.replace(ve.escapeReplaceNoEncode,ga);return d}function ma(d){try{d=encodeURI(d).replace(ve.percentDecode,"%")}catch(t){return null}return d}function fa(d,t){var r;let e=d.replace(ve.findPipe,(a,o,s)=>{let l=!1,c=o;for(;--c>=0&&s[c]==="\\";)l=!l;return l?"|":" |"}),n=e.split(ve.splitPipe),i=0;if(n[0].trim()||n.shift(),n.length>0&&!((r=n.at(-1))!=null&&r.trim())&&n.pop(),t)if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;i<n.length;i++)n[i]=n[i].trim().replace(ve.slashPipe,"|");return n}function Mt(d,t,e){let n=d.length;if(n===0)return"";let i=0;for(;i<n&&d.charAt(n-i-1)===t;)i++;return d.slice(0,n-i)}function Il(d,t){if(d.indexOf(t[1])===-1)return-1;let e=0;for(let n=0;n<d.length;n++)if(d[n]==="\\")n++;else if(d[n]===t[0])e++;else if(d[n]===t[1]&&(e--,e<0))return n;return-1}function va(d,t,e,n,i){let r=t.href,a=t.title||null,o=d[1].replace(i.other.outputLinkReplace,"$1");if(d[0].charAt(0)!=="!"){n.state.inLink=!0;let s={type:"link",raw:e,href:r,title:a,text:o,tokens:n.inlineTokens(o)};return n.state.inLink=!1,s}return{type:"image",raw:e,href:r,title:a,text:o}}function Dl(d,t,e){let n=d.match(e.other.indentCodeCompensation);if(n===null)return t;let i=n[1];return t.split(`
`).map(r=>{let a=r.match(e.other.beginningSpace);if(a===null)return r;let[o]=a;return o.length>=i.length?r.slice(i.length):r}).join(`
`)}function q(d,t){return Ze.parse(d,t)}var Ye,At,ve,el,tl,nl,$t,il,wa,xa,Yn,rl,Xn,al,ol,nn,Qn,sl,ya,ll,ei,ua,cl,dl,pl,hl,ka,ul,rn,ti,Sa,gl,Ca,ml,fl,vl,Pa,bl,wl,Ta,xl,yl,kl,Sl,Cl,Pl,Tl,tn,El,Ea,Ma,Ml,ni,Al,Jn,Ll,en,Et,$l,ga,gt,be,mt,Lt,we,Je,je,Ze,Hp,Np,zp,Bp,jp,Vp,Up,an=y(()=>{Ye=Zn();At={exec:()=>null};ve={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:d=>new RegExp(`^( {0,3}${d})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:d=>new RegExp(`^ {0,${Math.min(3,d-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:d=>new RegExp(`^ {0,${Math.min(3,d-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:d=>new RegExp(`^ {0,${Math.min(3,d-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:d=>new RegExp(`^ {0,${Math.min(3,d-1)}}#`),htmlBeginRegex:d=>new RegExp(`^ {0,${Math.min(3,d-1)}}<(?:[a-z].*>|!--)`,"i")},el=/^(?:[ \t]*(?:\n|$))+/,tl=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,nl=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,$t=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,il=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,wa=/(?:[*+-]|\d{1,9}[.)])/,xa=W(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,wa).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),Yn=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,rl=/^[^\n]+/,Xn=/(?!\s*\])(?:\\.|[^\[\]\\])+/,al=W(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Xn).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ol=W(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,wa).getRegex(),nn="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Qn=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,sl=W("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Qn).replace("tag",nn).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ya=W(Yn).replace("hr",$t).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",nn).getRegex(),ll=W(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",ya).getRegex(),ei={blockquote:ll,code:tl,def:al,fences:nl,heading:il,hr:$t,html:sl,lheading:xa,list:ol,newline:el,paragraph:ya,table:At,text:rl},ua=W("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",$t).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",nn).getRegex(),cl={...ei,table:ua,paragraph:W(Yn).replace("hr",$t).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",ua).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",nn).getRegex()},dl={...ei,html:W(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Qn).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:At,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:W(Yn).replace("hr",$t).replace("heading",` *#{1,6} *[^
]`).replace("lheading",xa).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},pl=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,hl=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,ka=/^( {2,}|\\)\n(?!\s*$)/,ul=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,rn=/[\p{P}\p{S}]/u,ti=/[\s\p{P}\p{S}]/u,Sa=/[^\s\p{P}\p{S}]/u,gl=W(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,ti).getRegex(),Ca=/(?!~)[\p{P}\p{S}]/u,ml=/(?!~)[\s\p{P}\p{S}]/u,fl=/(?:[^\s\p{P}\p{S}]|~)/u,vl=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,Pa=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,bl=W(Pa,"u").replace(/punct/g,rn).getRegex(),wl=W(Pa,"u").replace(/punct/g,Ca).getRegex(),Ta="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",xl=W(Ta,"gu").replace(/notPunctSpace/g,Sa).replace(/punctSpace/g,ti).replace(/punct/g,rn).getRegex(),yl=W(Ta,"gu").replace(/notPunctSpace/g,fl).replace(/punctSpace/g,ml).replace(/punct/g,Ca).getRegex(),kl=W("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Sa).replace(/punctSpace/g,ti).replace(/punct/g,rn).getRegex(),Sl=W(/\\(punct)/,"gu").replace(/punct/g,rn).getRegex(),Cl=W(/^<(scheme:[^\s<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Pl=W(Qn).replace("(?:-->|$)","-->").getRegex(),Tl=W("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Pl).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),tn=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,El=W(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",tn).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Ea=W(/^!?\[(label)\]\[(ref)\]/).replace("label",tn).replace("ref",Xn).getRegex(),Ma=W(/^!?\[(ref)\](?:\[\])?/).replace("ref",Xn).getRegex(),Ml=W("reflink|nolink(?!\\()","g").replace("reflink",Ea).replace("nolink",Ma).getRegex(),ni={_backpedal:At,anyPunctuation:Sl,autolink:Cl,blockSkip:vl,br:ka,code:hl,del:At,emStrongLDelim:bl,emStrongRDelimAst:xl,emStrongRDelimUnd:kl,escape:pl,link:El,nolink:Ma,punctuation:gl,reflink:Ea,reflinkSearch:Ml,tag:Tl,text:ul,url:At},Al={...ni,link:W(/^!?\[(label)\]\((.*?)\)/).replace("label",tn).getRegex(),reflink:W(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",tn).getRegex()},Jn={...ni,emStrongRDelimAst:yl,emStrongLDelim:wl,url:W(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Ll={...Jn,br:W(ka).replace("{2,}","*").getRegex(),text:W(Jn.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},en={normal:ei,gfm:cl,pedantic:dl},Et={normal:ni,gfm:Jn,breaks:Ll,pedantic:Al},$l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ga=d=>$l[d];gt=class{constructor(t){Z(this,"options");Z(this,"rules");Z(this,"lexer");this.options=t||Ye}space(t){let e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){let e=this.rules.block.code.exec(t);if(e){let n=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Mt(n,`
`)}}}fences(t){let e=this.rules.block.fences.exec(t);if(e){let n=e[0],i=Dl(n,e[3]||"",this.rules);return{type:"code",raw:n,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:i}}}heading(t){let e=this.rules.block.heading.exec(t);if(e){let n=e[2].trim();if(this.rules.other.endingHash.test(n)){let i=Mt(n,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(n=i.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(t){let e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:Mt(e[0],`
`)}}blockquote(t){let e=this.rules.block.blockquote.exec(t);if(e){let n=Mt(e[0],`
`).split(`
`),i="",r="",a=[];for(;n.length>0;){let o=!1,s=[],l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))s.push(n[l]),o=!0;else if(!o)s.push(n[l]);else break;n=n.slice(l);let c=s.join(`
`),p=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${c}`:c,r=r?`${r}
${p}`:p;let h=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(p,a,!0),this.lexer.state.top=h,n.length===0)break;let g=a.at(-1);if((g==null?void 0:g.type)==="code")break;if((g==null?void 0:g.type)==="blockquote"){let m=g,f=m.raw+`
`+n.join(`
`),v=this.blockquote(f);a[a.length-1]=v,i=i.substring(0,i.length-m.raw.length)+v.raw,r=r.substring(0,r.length-m.text.length)+v.text;break}else if((g==null?void 0:g.type)==="list"){let m=g,f=m.raw+`
`+n.join(`
`),v=this.list(f);a[a.length-1]=v,i=i.substring(0,i.length-g.raw.length)+v.raw,r=r.substring(0,r.length-m.raw.length)+v.raw,n=f.substring(a.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:a,text:r}}}list(t){let e=this.rules.block.list.exec(t);if(e){let n=e[1].trim(),i=n.length>1,r={type:"list",raw:"",ordered:i,start:i?+n.slice(0,-1):"",loose:!1,items:[]};n=i?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=i?n:"[*+-]");let a=this.rules.other.listItemRegex(n),o=!1;for(;t;){let l=!1,c="",p="";if(!(e=a.exec(t))||this.rules.block.hr.test(t))break;c=e[0],t=t.substring(c.length);let h=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,k=>" ".repeat(3*k.length)),g=t.split(`
`,1)[0],m=!h.trim(),f=0;if(this.options.pedantic?(f=2,p=h.trimStart()):m?f=e[1].length+1:(f=e[2].search(this.rules.other.nonSpaceChar),f=f>4?1:f,p=h.slice(f),f+=e[1].length),m&&this.rules.other.blankLine.test(g)&&(c+=g+`
`,t=t.substring(g.length+1),l=!0),!l){let k=this.rules.other.nextBulletRegex(f),C=this.rules.other.hrRegex(f),P=this.rules.other.fencesBeginRegex(f),K=this.rules.other.headingBeginRegex(f),le=this.rules.other.htmlBeginRegex(f);for(;t;){let U=t.split(`
`,1)[0],ne;if(g=U,this.options.pedantic?(g=g.replace(this.rules.other.listReplaceNesting,"  "),ne=g):ne=g.replace(this.rules.other.tabCharGlobal,"    "),P.test(g)||K.test(g)||le.test(g)||k.test(g)||C.test(g))break;if(ne.search(this.rules.other.nonSpaceChar)>=f||!g.trim())p+=`
`+ne.slice(f);else{if(m||h.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||P.test(h)||K.test(h)||C.test(h))break;p+=`
`+g}!m&&!g.trim()&&(m=!0),c+=U+`
`,t=t.substring(U.length+1),h=ne.slice(f)}}r.loose||(o?r.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(o=!0));let v=null,A;this.options.gfm&&(v=this.rules.other.listIsTask.exec(p),v&&(A=v[0]!=="[ ] ",p=p.replace(this.rules.other.listReplaceTask,""))),r.items.push({type:"list_item",raw:c,task:!!v,checked:A,loose:!1,text:p,tokens:[]}),r.raw+=c}let s=r.items.at(-1);if(s)s.raw=s.raw.trimEnd(),s.text=s.text.trimEnd();else return;r.raw=r.raw.trimEnd();for(let l=0;l<r.items.length;l++)if(this.lexer.state.top=!1,r.items[l].tokens=this.lexer.blockTokens(r.items[l].text,[]),!r.loose){let c=r.items[l].tokens.filter(h=>h.type==="space"),p=c.length>0&&c.some(h=>this.rules.other.anyLine.test(h.raw));r.loose=p}if(r.loose)for(let l=0;l<r.items.length;l++)r.items[l].loose=!0;return r}}html(t){let e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){let e=this.rules.block.def.exec(t);if(e){let n=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:n,raw:e[0],href:i,title:r}}}table(t){var o;let e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let n=fa(e[1]),i=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),r=(o=e[3])!=null&&o.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],a={type:"table",raw:e[0],header:[],align:[],rows:[]};if(n.length===i.length){for(let s of i)this.rules.other.tableAlignRight.test(s)?a.align.push("right"):this.rules.other.tableAlignCenter.test(s)?a.align.push("center"):this.rules.other.tableAlignLeft.test(s)?a.align.push("left"):a.align.push(null);for(let s=0;s<n.length;s++)a.header.push({text:n[s],tokens:this.lexer.inline(n[s]),header:!0,align:a.align[s]});for(let s of r)a.rows.push(fa(s,a.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:a.align[c]})));return a}}lheading(t){let e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){let e=this.rules.block.paragraph.exec(t);if(e){let n=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:n,tokens:this.lexer.inline(n)}}}text(t){let e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){let e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){let e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){let e=this.rules.inline.link.exec(t);if(e){let n=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let a=Mt(n.slice(0,-1),"\\");if((n.length-a.length)%2===0)return}else{let a=Il(e[2],"()");if(a>-1){let s=(e[0].indexOf("!")===0?5:4)+e[1].length+a;e[2]=e[2].substring(0,a),e[0]=e[0].substring(0,s).trim(),e[3]=""}}let i=e[2],r="";if(this.options.pedantic){let a=this.rules.other.pedanticHrefTitle.exec(i);a&&(i=a[1],r=a[3])}else r=e[3]?e[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?i=i.slice(1):i=i.slice(1,-1)),va(e,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){let i=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),r=e[i.toLowerCase()];if(!r){let a=n[0].charAt(0);return{type:"text",raw:a,text:a}}return va(n,r,n[0],this.lexer,this.rules)}}emStrong(t,e,n=""){let i=this.rules.inline.emStrongLDelim.exec(t);if(!i||i[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(i[1]||i[2]||"")||!n||this.rules.inline.punctuation.exec(n)){let a=[...i[0]].length-1,o,s,l=a,c=0,p=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(p.lastIndex=0,e=e.slice(-1*t.length+a);(i=p.exec(e))!=null;){if(o=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!o)continue;if(s=[...o].length,i[3]||i[4]){l+=s;continue}else if((i[5]||i[6])&&a%3&&!((a+s)%3)){c+=s;continue}if(l-=s,l>0)continue;s=Math.min(s,s+l+c);let h=[...i[0]][0].length,g=t.slice(0,a+i.index+h+s);if(Math.min(a,s)%2){let f=g.slice(1,-1);return{type:"em",raw:g,text:f,tokens:this.lexer.inlineTokens(f)}}let m=g.slice(2,-2);return{type:"strong",raw:g,text:m,tokens:this.lexer.inlineTokens(m)}}}}codespan(t){let e=this.rules.inline.code.exec(t);if(e){let n=e[2].replace(this.rules.other.newLineCharGlobal," "),i=this.rules.other.nonSpaceChar.test(n),r=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return i&&r&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:e[0],text:n}}}br(t){let e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){let e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t){let e=this.rules.inline.autolink.exec(t);if(e){let n,i;return e[2]==="@"?(n=e[1],i="mailto:"+n):(n=e[1],i=n),{type:"link",raw:e[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}url(t){var n,i;let e;if(e=this.rules.inline.url.exec(t)){let r,a;if(e[2]==="@")r=e[0],a="mailto:"+r;else{let o;do o=e[0],e[0]=(i=(n=this.rules.inline._backpedal.exec(e[0]))==null?void 0:n[0])!=null?i:"";while(o!==e[0]);r=e[0],e[1]==="www."?a="http://"+e[0]:a=e[0]}return{type:"link",raw:e[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(t){let e=this.rules.inline.text.exec(t);if(e){let n=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:n}}}},be=class{constructor(t){Z(this,"tokens");Z(this,"options");Z(this,"state");Z(this,"tokenizer");Z(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Ye,this.options.tokenizer=this.options.tokenizer||new gt,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let e={other:ve,block:en.normal,inline:Et.normal};this.options.pedantic?(e.block=en.pedantic,e.inline=Et.pedantic):this.options.gfm&&(e.block=en.gfm,this.options.breaks?e.inline=Et.breaks:e.inline=Et.gfm),this.tokenizer.rules=e}static get rules(){return{block:en,inline:Et}}static lex(t,e){return new be(e).lex(t)}static lexInline(t,e){return new be(e).inlineTokens(t)}lex(t){t=t.replace(ve.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){let n=this.inlineQueue[e];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,e=[],n=!1){var i,r,a;for(this.options.pedantic&&(t=t.replace(ve.tabCharGlobal,"    ").replace(ve.spaceLine,""));t;){let o;if((r=(i=this.options.extensions)==null?void 0:i.block)!=null&&r.some(l=>(o=l.call({lexer:this},t,e))?(t=t.substring(o.raw.length),e.push(o),!0):!1))continue;if(o=this.tokenizer.space(t)){t=t.substring(o.raw.length);let l=e.at(-1);o.raw.length===1&&l!==void 0?l.raw+=`
`:e.push(o);continue}if(o=this.tokenizer.code(t)){t=t.substring(o.raw.length);let l=e.at(-1);(l==null?void 0:l.type)==="paragraph"||(l==null?void 0:l.type)==="text"?(l.raw+=`
`+o.raw,l.text+=`
`+o.text,this.inlineQueue.at(-1).src=l.text):e.push(o);continue}if(o=this.tokenizer.fences(t)){t=t.substring(o.raw.length),e.push(o);continue}if(o=this.tokenizer.heading(t)){t=t.substring(o.raw.length),e.push(o);continue}if(o=this.tokenizer.hr(t)){t=t.substring(o.raw.length),e.push(o);continue}if(o=this.tokenizer.blockquote(t)){t=t.substring(o.raw.length),e.push(o);continue}if(o=this.tokenizer.list(t)){t=t.substring(o.raw.length),e.push(o);continue}if(o=this.tokenizer.html(t)){t=t.substring(o.raw.length),e.push(o);continue}if(o=this.tokenizer.def(t)){t=t.substring(o.raw.length);let l=e.at(-1);(l==null?void 0:l.type)==="paragraph"||(l==null?void 0:l.type)==="text"?(l.raw+=`
`+o.raw,l.text+=`
`+o.raw,this.inlineQueue.at(-1).src=l.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(t)){t=t.substring(o.raw.length),e.push(o);continue}if(o=this.tokenizer.lheading(t)){t=t.substring(o.raw.length),e.push(o);continue}let s=t;if((a=this.options.extensions)!=null&&a.startBlock){let l=1/0,c=t.slice(1),p;this.options.extensions.startBlock.forEach(h=>{p=h.call({lexer:this},c),typeof p=="number"&&p>=0&&(l=Math.min(l,p))}),l<1/0&&l>=0&&(s=t.substring(0,l+1))}if(this.state.top&&(o=this.tokenizer.paragraph(s))){let l=e.at(-1);n&&(l==null?void 0:l.type)==="paragraph"?(l.raw+=`
`+o.raw,l.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):e.push(o),n=s.length!==t.length,t=t.substring(o.raw.length);continue}if(o=this.tokenizer.text(t)){t=t.substring(o.raw.length);let l=e.at(-1);(l==null?void 0:l.type)==="text"?(l.raw+=`
`+o.raw,l.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):e.push(o);continue}if(t){let l="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(l);break}else throw new Error(l)}}return this.state.top=!0,e}inline(t,e=[]){return this.inlineQueue.push({src:t,tokens:e}),e}inlineTokens(t,e=[]){var o,s,l;let n=t,i=null;if(this.tokens.links){let c=Object.keys(this.tokens.links);if(c.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(n))!=null;)c.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.blockSkip.exec(n))!=null;)n=n.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(n))!=null;)n=n.slice(0,i.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let r=!1,a="";for(;t;){r||(a=""),r=!1;let c;if((s=(o=this.options.extensions)==null?void 0:o.inline)!=null&&s.some(h=>(c=h.call({lexer:this},t,e))?(t=t.substring(c.raw.length),e.push(c),!0):!1))continue;if(c=this.tokenizer.escape(t)){t=t.substring(c.raw.length),e.push(c);continue}if(c=this.tokenizer.tag(t)){t=t.substring(c.raw.length),e.push(c);continue}if(c=this.tokenizer.link(t)){t=t.substring(c.raw.length),e.push(c);continue}if(c=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(c.raw.length);let h=e.at(-1);c.type==="text"&&(h==null?void 0:h.type)==="text"?(h.raw+=c.raw,h.text+=c.text):e.push(c);continue}if(c=this.tokenizer.emStrong(t,n,a)){t=t.substring(c.raw.length),e.push(c);continue}if(c=this.tokenizer.codespan(t)){t=t.substring(c.raw.length),e.push(c);continue}if(c=this.tokenizer.br(t)){t=t.substring(c.raw.length),e.push(c);continue}if(c=this.tokenizer.del(t)){t=t.substring(c.raw.length),e.push(c);continue}if(c=this.tokenizer.autolink(t)){t=t.substring(c.raw.length),e.push(c);continue}if(!this.state.inLink&&(c=this.tokenizer.url(t))){t=t.substring(c.raw.length),e.push(c);continue}let p=t;if((l=this.options.extensions)!=null&&l.startInline){let h=1/0,g=t.slice(1),m;this.options.extensions.startInline.forEach(f=>{m=f.call({lexer:this},g),typeof m=="number"&&m>=0&&(h=Math.min(h,m))}),h<1/0&&h>=0&&(p=t.substring(0,h+1))}if(c=this.tokenizer.inlineText(p)){t=t.substring(c.raw.length),c.raw.slice(-1)!=="_"&&(a=c.raw.slice(-1)),r=!0;let h=e.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=c.raw,h.text+=c.text):e.push(c);continue}if(t){let h="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return e}},mt=class{constructor(t){Z(this,"options");Z(this,"parser");this.options=t||Ye}space(t){return""}code({text:t,lang:e,escaped:n}){var a;let i=(a=(e||"").match(ve.notSpaceStart))==null?void 0:a[0],r=t.replace(ve.endingNewline,"")+`
`;return i?'<pre><code class="language-'+_e(i)+'">'+(n?r:_e(r,!0))+`</code></pre>
`:"<pre><code>"+(n?r:_e(r,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){let e=t.ordered,n=t.start,i="";for(let o=0;o<t.items.length;o++){let s=t.items[o];i+=this.listitem(s)}let r=e?"ol":"ul",a=e&&n!==1?' start="'+n+'"':"";return"<"+r+a+`>
`+i+"</"+r+`>
`}listitem(t){var n;let e="";if(t.task){let i=this.checkbox({checked:!!t.checked});t.loose?((n=t.tokens[0])==null?void 0:n.type)==="paragraph"?(t.tokens[0].text=i+" "+t.tokens[0].text,t.tokens[0].tokens&&t.tokens[0].tokens.length>0&&t.tokens[0].tokens[0].type==="text"&&(t.tokens[0].tokens[0].text=i+" "+_e(t.tokens[0].tokens[0].text),t.tokens[0].tokens[0].escaped=!0)):t.tokens.unshift({type:"text",raw:i+" ",text:i+" ",escaped:!0}):e+=i+" "}return e+=this.parser.parse(t.tokens,!!t.loose),`<li>${e}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",n="";for(let r=0;r<t.header.length;r++)n+=this.tablecell(t.header[r]);e+=this.tablerow({text:n});let i="";for(let r=0;r<t.rows.length;r++){let a=t.rows[r];n="";for(let o=0;o<a.length;o++)n+=this.tablecell(a[o]);i+=this.tablerow({text:n})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+i+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){let e=this.parser.parseInline(t.tokens),n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${_e(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:n}){let i=this.parser.parseInline(n),r=ma(t);if(r===null)return i;t=r;let a='<a href="'+t+'"';return e&&(a+=' title="'+_e(e)+'"'),a+=">"+i+"</a>",a}image({href:t,title:e,text:n}){let i=ma(t);if(i===null)return _e(n);t=i;let r=`<img src="${t}" alt="${n}"`;return e&&(r+=` title="${_e(e)}"`),r+=">",r}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:_e(t.text)}},Lt=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}},we=class{constructor(t){Z(this,"options");Z(this,"renderer");Z(this,"textRenderer");this.options=t||Ye,this.options.renderer=this.options.renderer||new mt,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Lt}static parse(t,e){return new we(e).parse(t)}static parseInline(t,e){return new we(e).parseInline(t)}parse(t,e=!0){var i,r;let n="";for(let a=0;a<t.length;a++){let o=t[a];if((r=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&r[o.type]){let l=o,c=this.options.extensions.renderers[l.type].call({parser:this},l);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(l.type)){n+=c||"";continue}}let s=o;switch(s.type){case"space":{n+=this.renderer.space(s);continue}case"hr":{n+=this.renderer.hr(s);continue}case"heading":{n+=this.renderer.heading(s);continue}case"code":{n+=this.renderer.code(s);continue}case"table":{n+=this.renderer.table(s);continue}case"blockquote":{n+=this.renderer.blockquote(s);continue}case"list":{n+=this.renderer.list(s);continue}case"html":{n+=this.renderer.html(s);continue}case"paragraph":{n+=this.renderer.paragraph(s);continue}case"text":{let l=s,c=this.renderer.text(l);for(;a+1<t.length&&t[a+1].type==="text";)l=t[++a],c+=`
`+this.renderer.text(l);e?n+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c,escaped:!0}]}):n+=c;continue}default:{let l='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return n}parseInline(t,e=this.renderer){var i,r;let n="";for(let a=0;a<t.length;a++){let o=t[a];if((r=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&r[o.type]){let l=this.options.extensions.renderers[o.type].call({parser:this},o);if(l!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){n+=l||"";continue}}let s=o;switch(s.type){case"escape":{n+=e.text(s);break}case"html":{n+=e.html(s);break}case"link":{n+=e.link(s);break}case"image":{n+=e.image(s);break}case"strong":{n+=e.strong(s);break}case"em":{n+=e.em(s);break}case"codespan":{n+=e.codespan(s);break}case"br":{n+=e.br(s);break}case"del":{n+=e.del(s);break}case"text":{n+=e.text(s);break}default:{let l='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return n}},Je=class{constructor(t){Z(this,"options");Z(this,"block");this.options=t||Ye}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}provideLexer(){return this.block?be.lex:be.lexInline}provideParser(){return this.block?we.parse:we.parseInline}};Z(Je,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));je=class{constructor(...t){Z(this,"defaults",Zn());Z(this,"options",this.setOptions);Z(this,"parse",this.parseMarkdown(!0));Z(this,"parseInline",this.parseMarkdown(!1));Z(this,"Parser",we);Z(this,"Renderer",mt);Z(this,"TextRenderer",Lt);Z(this,"Lexer",be);Z(this,"Tokenizer",gt);Z(this,"Hooks",Je);this.use(...t)}walkTokens(t,e){var i,r;let n=[];for(let a of t)switch(n=n.concat(e.call(this,a)),a.type){case"table":{let o=a;for(let s of o.header)n=n.concat(this.walkTokens(s.tokens,e));for(let s of o.rows)for(let l of s)n=n.concat(this.walkTokens(l.tokens,e));break}case"list":{let o=a;n=n.concat(this.walkTokens(o.items,e));break}default:{let o=a;(r=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&r[o.type]?this.defaults.extensions.childTokens[o.type].forEach(s=>{let l=o[s].flat(1/0);n=n.concat(this.walkTokens(l,e))}):o.tokens&&(n=n.concat(this.walkTokens(o.tokens,e)))}}return n}use(...t){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(n=>{let i={...n};if(i.async=this.defaults.async||i.async||!1,n.extensions&&(n.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){let a=e.renderers[r.name];a?e.renderers[r.name]=function(...o){let s=r.renderer.apply(this,o);return s===!1&&(s=a.apply(this,o)),s}:e.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let a=e[r.level];a?a.unshift(r.tokenizer):e[r.level]=[r.tokenizer],r.start&&(r.level==="block"?e.startBlock?e.startBlock.push(r.start):e.startBlock=[r.start]:r.level==="inline"&&(e.startInline?e.startInline.push(r.start):e.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(e.childTokens[r.name]=r.childTokens)}),i.extensions=e),n.renderer){let r=this.defaults.renderer||new mt(this.defaults);for(let a in n.renderer){if(!(a in r))throw new Error(`renderer '${a}' does not exist`);if(["options","parser"].includes(a))continue;let o=a,s=n.renderer[o],l=r[o];r[o]=(...c)=>{let p=s.apply(r,c);return p===!1&&(p=l.apply(r,c)),p||""}}i.renderer=r}if(n.tokenizer){let r=this.defaults.tokenizer||new gt(this.defaults);for(let a in n.tokenizer){if(!(a in r))throw new Error(`tokenizer '${a}' does not exist`);if(["options","rules","lexer"].includes(a))continue;let o=a,s=n.tokenizer[o],l=r[o];r[o]=(...c)=>{let p=s.apply(r,c);return p===!1&&(p=l.apply(r,c)),p}}i.tokenizer=r}if(n.hooks){let r=this.defaults.hooks||new Je;for(let a in n.hooks){if(!(a in r))throw new Error(`hook '${a}' does not exist`);if(["options","block"].includes(a))continue;let o=a,s=n.hooks[o],l=r[o];Je.passThroughHooks.has(a)?r[o]=c=>{if(this.defaults.async)return Promise.resolve(s.call(r,c)).then(h=>l.call(r,h));let p=s.call(r,c);return l.call(r,p)}:r[o]=(...c)=>{let p=s.apply(r,c);return p===!1&&(p=l.apply(r,c)),p}}i.hooks=r}if(n.walkTokens){let r=this.defaults.walkTokens,a=n.walkTokens;i.walkTokens=function(o){let s=[];return s.push(a.call(this,o)),r&&(s=s.concat(r.call(this,o))),s}}this.defaults={...this.defaults,...i}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return be.lex(t,e!=null?e:this.defaults)}parser(t,e){return we.parse(t,e!=null?e:this.defaults)}parseMarkdown(t){return(n,i)=>{let r={...i},a={...this.defaults,...r},o=this.onError(!!a.silent,!!a.async);if(this.defaults.async===!0&&r.async===!1)return o(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n=="undefined"||n===null)return o(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return o(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));a.hooks&&(a.hooks.options=a,a.hooks.block=t);let s=a.hooks?a.hooks.provideLexer():t?be.lex:be.lexInline,l=a.hooks?a.hooks.provideParser():t?we.parse:we.parseInline;if(a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(n):n).then(c=>s(c,a)).then(c=>a.hooks?a.hooks.processAllTokens(c):c).then(c=>a.walkTokens?Promise.all(this.walkTokens(c,a.walkTokens)).then(()=>c):c).then(c=>l(c,a)).then(c=>a.hooks?a.hooks.postprocess(c):c).catch(o);try{a.hooks&&(n=a.hooks.preprocess(n));let c=s(n,a);a.hooks&&(c=a.hooks.processAllTokens(c)),a.walkTokens&&this.walkTokens(c,a.walkTokens);let p=l(c,a);return a.hooks&&(p=a.hooks.postprocess(p)),p}catch(c){return o(c)}}}onError(t,e){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,t){let i="<p>An error occurred:</p><pre>"+_e(n.message+"",!0)+"</pre>";return e?Promise.resolve(i):i}if(e)return Promise.reject(n);throw n}}},Ze=new je;q.options=q.setOptions=function(d){return Ze.setOptions(d),q.defaults=Ze.defaults,ba(q.defaults),q};q.getDefaults=Zn;q.defaults=Ye;q.use=function(...d){return Ze.use(...d),q.defaults=Ze.defaults,ba(q.defaults),q};q.walkTokens=function(d,t){return Ze.walkTokens(d,t)};q.parseInline=Ze.parseInline;q.Parser=we;q.parser=we.parse;q.Renderer=mt;q.TextRenderer=Lt;q.Lexer=be;q.lexer=be.lex;q.Tokenizer=gt;q.Hooks=Je;q.parse=q;Hp=q.options,Np=q.setOptions,zp=q.use,Bp=q.walkTokens,jp=q.parseInline,Vp=we.parse,Up=be.lex});var se,re,Rl,ft,ii,Xe,Aa,It=y(()=>{se={title:"\u6807\u9898",author:"\u4F5C\u8005",digest:"\u6458\u8981",sourceUrl:"\u539F\u6587\u94FE\u63A5",cover:"\u5C01\u9762\u56FE",openComment:"\u5F00\u542F\u8BC4\u8BBA",onlyFans:"\u4EC5\u7C89\u4E1D\u53EF\u8BC4\u8BBA",wechatArticleUrl:"\u516C\u4F17\u53F7\u94FE\u63A5"},re={title:[se.title,"title"],author:[se.author,"author"],digest:[se.digest,"digest","description","summary"],sourceUrl:[se.sourceUrl,"content_source_url","source_url"],cover:[se.cover,"cover","thumbnail","one2mp_cover"],openComment:[se.openComment,"need_open_comment","open_comment"],onlyFans:[se.onlyFans,"only_fans_can_comment"]},Rl=[se.wechatArticleUrl,"\u516C\u4F17\u53F7\u6587\u7AE0\u94FE\u63A5","wechat_url","wechat_article_url","mp_url","mp_article_url","mp_link"],ft=(d,t)=>{if(d)for(let e of t){let n=d[e];if(typeof n=="string"&&n.trim()!=="")return n.trim()}},ii=(d,t)=>{if(!d)return;let e=new Set(["1","true","yes","y","on","\u662F","\u5F00\u542F","\u5F00"]),n=new Set(["0","false","no","n","off","\u5426","\u5173\u95ED","\u5173"]);for(let i of t){let r=d[i];if(typeof r=="boolean")return r?1:0;if(typeof r=="number")return r>0?1:0;if(typeof r=="string"){let a=r.trim().toLowerCase();if(e.has(a))return 1;if(n.has(a))return 0}}},Xe=d=>{if(!d)return null;for(let t of re.cover){let e=d[t];if(typeof e=="string"&&e.trim()!=="")return e.trim()}return null},Aa=d=>ft(d,Rl)});var La=Ko((ri,ai)=>{(function(d){"use strict";let t=U(),e=ne(),n=Ve(),i=Ne(),r={copyDefaultStyles:!0,imagePlaceholder:void 0,cacheBust:!1,useCredentials:!1,httpTimeout:3e4,styleCaching:"strict",corsImg:void 0},a={toSvg:p,toPng:g,toJpeg:m,toBlob:f,toPixelData:h,toCanvas:v,impl:{fontFaces:n,images:i,util:t,inliner:e,urlCache:[],options:{}}};typeof ri=="object"&&typeof ai=="object"?ai.exports=a:d.domtoimage=a;let o=(typeof Node=="undefined"?void 0:Node.ELEMENT_NODE)||1,s=(d===void 0?void 0:d.getComputedStyle)||(typeof window=="undefined"?void 0:window.getComputedStyle)||globalThis.getComputedStyle,l=(d===void 0?void 0:d.atob)||(typeof window=="undefined"?void 0:window.atob)||globalThis.atob;function c(x){return x===""||x==="none"}function p(x,w){let E=a.impl.util.getWindow(x);w||(w={}),A(w);let F=[];return Promise.resolve(x).then(O).then(S=>P(S,w,null,E)).then(K).then(le).then(N).then(B).then(M).then(I);function O(S){if(S.nodeType===o)return S;let L=S,X=S.parentNode,D=document.createElement("span");return L.replaceWith(D),D.append(S),F.push({parent:X,child:L,wrapper:D}),D}function M(S){for(;F.length>0;){let L=F.pop();L.parent.replaceChild(L.child,L.wrapper)}return S}function I(S){return a.impl.urlCache=[],ze(),S}function N(S){if(w.bgcolor&&(S.style.backgroundColor=w.bgcolor),w.width&&(S.style.width=`${w.width}px`),w.height&&(S.style.height=`${w.height}px`),w.style)for(let X of Object.keys(w.style))S.style[X]=w.style[X];let L=null;return typeof w.onclone=="function"&&(L=w.onclone(S)),Promise.resolve(L).then(()=>S)}function B(S){let L=w.width||t.width(S),X=w.height||t.height(S);return Promise.resolve(S).then(D=>(D.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(D))).then(t.escapeXhtml).then(D=>{let oe=(t.isDimensionMissing(L)?' width="100%"':` width="${L}"`)+(t.isDimensionMissing(X)?' height="100%"':` height="${X}"`);return`<svg xmlns="http://www.w3.org/2000/svg"${(t.isDimensionMissing(L)?"":` width="${L}"`)+(t.isDimensionMissing(X)?"":` height="${X}"`)}><foreignObject${oe}>${D}</foreignObject></svg>`}).then(D=>`data:image/svg+xml;charset=utf-8,${D}`)}}function h(x,w){return k(x,w).then(E=>E.getContext("2d").getImageData(0,0,t.width(x),t.height(x)).data)}function g(x,w={}){return k(x,w).then(E=>E.toDataURL())}function m(x,w){return k(x,w).then(E=>E.toDataURL("image/jpeg",(w?w.quality:void 0)||1))}function f(x,w){return k(x,w).then(t.canvasToBlob)}function v(x,w){return k(x,w)}function A(x){x.copyDefaultStyles===void 0?a.impl.options.copyDefaultStyles=r.copyDefaultStyles:a.impl.options.copyDefaultStyles=x.copyDefaultStyles,x.imagePlaceholder===void 0?a.impl.options.imagePlaceholder=r.imagePlaceholder:a.impl.options.imagePlaceholder=x.imagePlaceholder,a.impl.options.cacheBust=x.cacheBust===void 0?r.cacheBust:x.cacheBust,a.impl.options.corsImg=x.corsImg===void 0?r.corsImg:x.corsImg,a.impl.options.useCredentials=x.useCredentials===void 0?r.useCredentials:x.useCredentials,a.impl.options.httpTimeout=x.httpTimeout===void 0?r.httpTimeout:x.httpTimeout,a.impl.options.styleCaching=x.styleCaching===void 0?r.styleCaching:x.styleCaching,a.impl.options.requestUrl=x.requestUrl,a.impl.options.type=x.type||"image/png",a.impl.options.quality=x.quality||1}function k(x,w){return w||(w={}),p(x,w).then(t.makeImage).then(F=>{let O=typeof w.scale=="number"?w.scale:1,M=E(x,O),I=M.getContext("2d");return I.msImageSmoothingEnabled=!1,I.imageSmoothingEnabled=!1,F&&(I.scale(O,O),I.drawImage(F,0,0)),M});function E(F,O){let M=w.width||t.width(F),I=w.height||t.height(F);t.isDimensionMissing(M)&&(M=t.isDimensionMissing(I)?300:I*2),t.isDimensionMissing(I)&&(I=M/2);let N=document.createElement("canvas");if(N.width=M*O,N.height=I*O,w.bgcolor){let B=N.getContext("2d");B.fillStyle=w.bgcolor,B.fillRect(0,0,N.width,N.height)}return N}}let C=null;function P(x,w,E,F){let O=w.filter;if(x===C||t.isHTMLScriptElement(x)||t.isHTMLStyleElement(x)||t.isHTMLLinkElement(x)||E!==null&&O&&!O(x))return Promise.resolve();return Promise.resolve(x).then(M).then(S=>N(S,I(x))).then(S=>B(S,x));function M(S){return t.isHTMLCanvasElement(S)?t.makeImage(S.toDataURL()):S.cloneNode(!1)}function I(S){return t.isElementHostForOpenShadowRoot(S)?S.shadowRoot:S}function N(S,L){let X=ie(L),D=Promise.resolve();if(X.length>0){let ee=s(oe(L));for(let he of t.asArray(X))D=D.then(()=>P(he,w,ee,F).then(te=>{te&&S.append(te)}))}return D.then(()=>S);function oe(ee){return t.isShadowRoot(ee)?ee.host:ee}function ie(ee){return t.isShadowSlotElement(ee)?ee.assignedNodes():ee.childNodes}}function B(S,L){if(!t.isElement(S)||t.isShadowSlotElement(L))return Promise.resolve(S);return Promise.resolve().then(X).then(D).then(oe).then(ie).then(()=>S);function X(){he(L,S);function ee(te,Q){Q.font=te.font,Q.fontFamily=te.fontFamily,Q.fontFeatureSettings=te.fontFeatureSettings,Q.fontKerning=te.fontKerning,Q.fontSize=te.fontSize,Q.fontStretch=te.fontStretch,Q.fontStyle=te.fontStyle,Q.fontVariant=te.fontVariant,Q.fontVariantCaps=te.fontVariantCaps,Q.fontVariantEastAsian=te.fontVariantEastAsian,Q.fontVariantLigatures=te.fontVariantLigatures,Q.fontVariantNumeric=te.fontVariantNumeric,Q.fontVariationSettings=te.fontVariationSettings,Q.fontWeight=te.fontWeight}function he(te,Q){let Ue=s(te);if(Ue.cssText)Q.style.cssText=Ue.cssText,ee(Ue,Q.style);else{if(In(w,te,Ue,E,Q),E===null){for(let nt of["inset-block","inset-block-start","inset-block-end"])Q.style.removeProperty(nt);for(let nt of["left","right","top","bottom"])Q.style.getPropertyValue(nt)&&Ie(Q.style,nt,"0px")}let Nt="-webkit-background-clip",bt=Ue.getPropertyValue(Nt);bt&&bt!=="border-box"&&Ie(Q.style,Nt,bt)}}}function D(){}function oe(){t.isHTMLTextAreaElement(L)&&(S.value=L.value,S.textContent=L.value),t.isHTMLInputElement(L)&&S.setAttribute("value",L.value)}function ie(){if(t.isSVGElement(S)&&(S.setAttribute("xmlns","http://www.w3.org/2000/svg"),t.isSVGRectElement(S)))for(let ee of["width","height"]){let he=S.getAttribute(ee);he&&(S.style[ee]=he)}}}}function K(x){return Promise.resolve(x)}function le(x){return i.inlineAll(x).then(()=>x)}function U(){let x=0;return{escape:Do,isDataUrl:te,canvasToBlob:Nt,resolveUrl:bt,getAndEncode:Io,uid:nt,delay:Ro,asArray:Fo,escapeXhtml:Oo,makeImage:$o,width:_o,height:Ho,getWindow:w,isElement:M,isElementHostForOpenShadowRoot:E,isShadowRoot:F,isInShadowRoot:O,isHTMLElement:N,isHTMLCanvasElement:I,isHTMLInputElement:S,isHTMLImageElement:B,isHTMLLinkElement:L,isHTMLScriptElement:X,isHTMLStyleElement:D,isHTMLTextAreaElement:oe,isShadowSlotElement:ie,isSVGElement:ee,isSVGRectElement:he,isDimensionMissing:Q};function w(b){let z=b?b.ownerDocument:void 0;return(z?z.defaultView:void 0)||d||window}function E(b){return M(b)&&b.shadowRoot!==null}function F(b){return b instanceof w(b).ShadowRoot}function O(b){return b!==null&&Object.hasOwn(b,"getRootNode")&&F(b.getRootNode())}function M(b){return b instanceof w(b).Element}function I(b){return b instanceof w(b).HTMLCanvasElement}function N(b){return b instanceof w(b).HTMLElement}function B(b){return b instanceof w(b).HTMLImageElement}function S(b){return b instanceof w(b).HTMLInputElement}function L(b){return b instanceof w(b).HTMLLinkElement}function X(b){return b instanceof w(b).HTMLScriptElement}function D(b){return b instanceof w(b).HTMLStyleElement}function oe(b){return b instanceof w(b).HTMLTextAreaElement}function ie(b){return O(b)&&b instanceof w(b).HTMLSlotElement}function ee(b){return b instanceof w(b).SVGElement}function he(b){return b instanceof w(b).SVGRectElement}function te(b){return b.search(/^(data:)/)!==-1}function Q(b){return isNaN(b)||b<=0}function Ue(b){return new Promise(z=>{let H=l(b.toDataURL().split(",")[1]),j=H.length,J=new Uint8Array(j);for(let Ce=0;Ce<j;Ce++)J[Ce]=H.charCodeAt(Ce);z(new Blob([J],{type:a.impl.options.type}))})}function Nt(b){return b.toBlob?new Promise(z=>{b.toBlob(z,a.impl.options.type,a.impl.options.quality)}):Ue(b)}function bt(b,z){let H=document.implementation.createHTMLDocument(),j=H.createElement("base");H.head.append(j);let J=H.createElement("a");return H.body.append(J),j.href=z,J.href=b,J.href}function nt(){return`u${b()}${x++}`;function b(){return`0000${Math.trunc(Math.random()*36**4).toString(36)}`.slice(-4)}}function $o(b){return b==="data:,"?Promise.resolve():new Promise((z,H)=>{let j=new Image;a.impl.options.useCredentials&&(j.crossOrigin="use-credentials"),j.addEventListener("load",()=>{window&&window.requestAnimationFrame?window.requestAnimationFrame(()=>{z(j)}):z(j)}),j.onerror=H,j.src=b})}function Io(b){let z=a.impl.urlCache.find(H=>H.url===b);return z||(z={url:b,promise:null},a.impl.urlCache.push(z)),z.promise===null&&(a.impl.options.cacheBust&&(b+=(/\?/.test(b)?"&":"?")+Date.now()),a.impl.options.requestUrl&&b.startsWith("http")&&!b.startsWith("http://localhost/")?z.promise=a.impl.options.requestUrl({url:b,method:"GET"}).then(H=>new Promise(j=>{let J=new FileReader;J.addEventListener("load",Ce=>{j(Ce.target.result)}),J.readAsDataURL(new Blob([H.arrayBuffer],{type:H.headers["content-type"]}))})).catch(H=>(console.error("cannot fetch resource: "+b+", error: "+H),"")):z.promise=new Promise(H=>{let j=a.impl.options.httpTimeout,J=new XMLHttpRequest;if(J.addEventListener("readystatechange",No),J.ontimeout=zo,J.responseType="blob",J.timeout=j,a.impl.options.useCredentials&&(J.withCredentials=!0),a.impl.options.corsImg&&b.indexOf("http")===0&&!b.includes(window.location.origin)){let xe=(a.impl.options.corsImg.method||"GET").toUpperCase()==="POST"?"POST":"GET";J.open(xe,(a.impl.options.corsImg.url||"").replace("#{cors}",b),!0);let Rn=!1,Fn=a.impl.options.corsImg.headers||{};for(let We of Object.keys(Fn))Fn[We].includes("application/json")&&(Rn=!0),J.setRequestHeader(We,Fn[We]);let rt=Bo(a.impl.options.corsImg.data||"");for(let We of Object.keys(rt))typeof rt[We]=="string"&&(rt[We]=rt[We].replace("#{cors}",b));J.send(Rn?JSON.stringify(rt):rt)}else J.open("GET",b,!0),J.send();let Ce;if(a.impl.options.imagePlaceholder){let xe=a.impl.options.imagePlaceholder.split(/,/);xe&&xe[1]&&(Ce=xe[1])}function No(){if(J.readyState!==4)return;if(J.status>=300){Ce?H(Ce):Dn(`cannot fetch resource: ${b}, status: ${J.status}`);return}let xe=new FileReader;xe.onloadend=function(){H(xe.result)},xe.readAsDataURL(J.response)}function zo(){Ce?H(Ce):Dn(`timeout of ${j}ms occured while fetching resource: ${b}`)}function Bo(xe){try{return JSON.parse(JSON.stringify(xe))}catch(Rn){Dn("corsImg.data is missing or invalid")}}function Dn(xe){console.error(xe),H("")}})),z.promise}function Do(b){return b.replaceAll(/([.*+?^${}()|[\]\/\\])/g,"\\$1")}function Ro(b){return function(z){return new Promise(H=>{setTimeout(()=>{H(z)},b)})}}function Fo(b){let z=[],H=b.length;for(let j=0;j<H;j++)z.push(b[j]);return z}function Oo(b){let z=b.replaceAll("%","%25").replaceAll("#","%23").replaceAll(`
`,"%0A"),H="";for(let j=0;j<z.length;j++){let J=z.charCodeAt(j);J<=31||J===127||(H+=z[j])}return H}function _o(b){let z=it(b,"width");if(!isNaN(z))return z;let H=it(b,"border-left-width"),j=it(b,"border-right-width");return b.scrollWidth+H+j}function Ho(b){let z=it(b,"height");if(!isNaN(z))return z;let H=it(b,"border-top-width"),j=it(b,"border-bottom-width");return b.scrollHeight+H+j}function it(b,z){if(b.nodeType===o){let H=s(b).getPropertyValue(z);if(H.slice(-2)==="px")return H=H.slice(0,-2),Number.parseFloat(H)}return Number.NaN}}function ne(){let x=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:O,shouldProcess:w,impl:{readUrls:E,inline:F}};function w(M){return M.search(x)!==-1}function E(M){let I=[],N;for(;(N=x.exec(M))!==null;)I.push(N[1]);return I.filter(B=>!t.isDataUrl(B))}function F(M,I,N,B){return Promise.resolve(I).then(L=>N?t.resolveUrl(L,N):L).then(B||t.getAndEncode).then(L=>M.replace(S(I),`$1${L}$3`));function S(L){return new RegExp(`(url\\(['"]?)(${t.escape(L)})(['"]?\\))`,"g")}}function O(M,I,N){if(B())return Promise.resolve(M);return Promise.resolve(M).then(E).then(S=>{let L=Promise.resolve(M);for(let X of S)L=L.then(D=>F(D,X,I,N));return L});function B(){return!w(M)}}}function Ve(){return{resolveAll:x,impl:{readAll:w}};function x(){return w().then(E=>Promise.all(E.map(F=>F.resolve()))).then(E=>E.join(`
`))}function w(){return Promise.resolve(t.asArray(document.styleSheets)).then(F).then(E).then(M=>M.map(O));function E(M){return M.filter(I=>I.type===CSSRule.FONT_FACE_RULE).filter(I=>e.shouldProcess(I.style.getPropertyValue("src")))}function F(M){let I=[];for(let N of M)if(Object.hasOwn(Object.getPrototypeOf(N),"cssRules"))try{t.asArray(N.cssRules||[]).forEach(I.push.bind(I))}catch(B){console.error(`domtoimage: Error while reading CSS rules from ${N.href}`,B.toString())}return I}function O(M){return{resolve:function(){let N=(M.parentStyleSheet||{}).href;return e.inlineAll(M.cssText,N)},src(){return M.style.getPropertyValue("src")}}}}}function Ne(){return{inlineAll:w,impl:{newImage:x}};function x(E){return{inline:F};function F(O){return t.isDataUrl(E.src)?Promise.resolve():Promise.resolve(E.src).then(O||t.getAndEncode).then(M=>new Promise(I=>{E.addEventListener("load",I),E.onerror=I,E.src=M}))}}function w(E){if(!t.isElement(E))return Promise.resolve(E);return F(E).then(()=>t.isHTMLImageElement(E)?x(E).inline():Promise.all(t.asArray(E.childNodes).map(O=>w(O))));function F(O){let I=["background","background-image"].map(N=>{let B=O.style.getPropertyValue(N),S=O.style.getPropertyPriority(N);return B?e.inlineAll(B).then(L=>{Ie(O.style,N,L,S)}):Promise.resolve()});return Promise.all(I).then(()=>O)}}}function Ie(x,w,E,F){let O=["background-clip"].includes(w),M=F?" !important":"";$n(x,w,E,M),O&&$n(x,`-webkit-${w}`,E,M)}function $n(x,w,E,F){if(!w)return;let O=x.cssText&&!x.cssText.trim().endsWith(";")?"; ":"";x.cssText+=`${O}${w}: ${E}${F};`}function In(x,w,E,F,O){let M=a.impl.options.copyDefaultStyles?Ht(x,w):{},I=O.style;for(let B of N(t.asArray(E))){let S=E.getPropertyValue(B),L=M[B],X=F?F.getPropertyValue(B):void 0;if(S!==L||F&&S!==X||/border/.test(B)){let D=E.getPropertyPriority(B);Ie(I,B,S,D)}}function N(B){for(let S of["counter-reset","counter-increment","counter-set"])B.indexOf(S)<0&&!c(E.getPropertyValue(S))&&B.push(S);return B}}let De=null,Re={},tt=new Set(["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","DETAILS","DIALOG","DD","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","LI","MAIN","NAV","OL","P","PRE","SECTION","SVG","TABLE","UL","math","svg","BODY","HEAD","HTML"]);function Ht(x,w){let E=N(w),F=B(E);if(Re[F])return Re[F];let O=me(),M=S(O.document,E),I=L(O,M);return X(M),Re[F]=I,I;function N(D){let oe=[];do{if(D.nodeType===o){let ie=D.tagName;if(oe.push(ie),tt.has(ie))break}D=D.parentNode}while(D);return oe}function B(D){return x.styleCaching==="relaxed"?D.filter((oe,ie,ee)=>ie===0||ie===ee.length-1).join(">"):D.join(">")}function S(D,oe){let ie=D.body;do{let ee=oe.pop(),he=D.createElement(ee);ie.append(he),ie=he}while(oe.length>0);return ie.textContent="\u200B",ie}function L(D,oe){let ie={},ee=D.getComputedStyle(oe);for(let he of t.asArray(ee))ie[he]=he==="width"||he==="height"?"auto":ee.getPropertyValue(he);return ie}function X(D){do{let oe=D.parentElement;oe!==null&&D.remove(),D=oe}while(D&&D.tagName!=="BODY")}}function me(){if(C)return C.contentWindow;let x=document.characterSet||"UTF-8",w=document.doctype,E=w?`<!DOCTYPE ${F(w.name)} ${F(w.publicId)} ${F(w.systemId)}`.trim()+">":"";return C=document.createElement("iframe"),C.id="domtoimage-sandbox-"+t.uid(),C.classList.add("one2mp-domtoimage-sandbox"),document.body.append(C),O(C,E,x,"domtoimage-sandbox");function F(M){return M?M.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;"):""}function O(M,I,N,B){let S=document.createElement("meta");S.setAttribute("charset",N);try{let L=document.implementation.createHTMLDocument(B);L.head.append(S);let X=new XMLSerializer,D=I+X.serializeToString(L.documentElement);return M.setAttribute("srcdoc",D),M.contentWindow}catch(L){}return M.contentDocument.head.append(S),M.contentDocument.title=B,M.contentWindow}}function ze(){C&&(C.remove(),C=null),De&&clearTimeout(De),De=setTimeout(()=>{De=null,Re={}},20*1e3)}})(ri)});var dn,$a,ae,Dt=y(()=>{dn=require("obsidian"),$a=Jo(La()),ae=class{constructor(t){this.app=t;this.rendering=!1;this.app=t}static getInstance(t){return ae.instance||(ae.instance=new ae(t)),ae.instance}async render(t,e,n){if(t===void 0||!t||!t.toLowerCase().endsWith(".md")||!e||!n)return;this.container=e,this.container.addClass("one2mp-markdown-render-container"),this.view=n,this.container.empty(),this.container.show(),this.rendering=!0,this.mdv&&this.mdv.unload(),this.previewEl=createDiv(),this.markdownBody=this.previewEl.createDiv(),this.mdv=new dn.MarkdownRenderChild(this.markdownBody),this.view.addChild(this.mdv),this.container.appendChild(this.previewEl);let i=await this.app.vault.adapter.read(t);await dn.MarkdownRenderer.render(this.app,i,this.markdownBody,t,this.mdv);try{let r=[];/^\s*>+\s*\[!/m.test(i)&&r.push(this.waitForSelector(this.previewEl,".callout",1e3)),/```\s*mermaid/i.test(i)&&r.push(this.waitForSelector(this.previewEl,".mermaid svg",5e3)),r.length&&await Promise.all(r)}catch(r){console.warn("\u90E8\u5206\u63D2\u4EF6\u6E32\u67D3\u8D85\u65F6\uFF08\u975E\u81F4\u547D\uFF09",r)}this.rendering=!1}queryElement(t,e){if(this.previewEl===void 0||!this.previewEl||this.rendering||this.previewEl===void 0||!this.previewEl)return null;let n=this.previewEl.querySelectorAll(e);return t<0||t>=n.length?null:n[t]}async domToImage(t,e={}){return await $a.default.toPng(t,e)}waitForSelector(t,e,n=1e3){return new Promise(i=>{if(t.querySelector(e))return i();let r=new MutationObserver(()=>{t.querySelector(e)&&(r.disconnect(),i())});r.observe(t,{childList:!0,subtree:!0}),setTimeout(()=>{r.disconnect(),i()},n)})}}});var oi,He,pn=y(()=>{oi=require("obsidian");Ee();He=class{constructor(t){this.app=t}parseObsidianUrl(t){let e=/obsidian:\/\/open\?vault=(.*?)&file=([^,]*),?(.*)$/,n=t.match(e);return n&&n[2]?decodeURIComponent(n[2]):null}getFileFromPath(t){let e=this.app.vault.getAbstractFileByPath(t);return e instanceof oi.TFile?e:null}getDisplayUrl(t){if(t)try{return this.app.vault.getResourcePath(t)}catch(e){console.error("Error reading file:",e)}return null}getInternalLinkDisplayUrl(t){let e=this.parseObsidianUrl(t);if(e){let n=this.getFileFromPath(e);if(n)return this.getDisplayUrl(n)}return null}}});var ue,Da,Ia,si,Fl,Ol,_l,Hl,Nl,zl,Ra,Fa=y(()=>{ue=require("obsidian");It();pn();Da=require("obsidian"),Ia=d=>d.replace(/[\\/:*?"<>|]/g,"-").trim()||"\u672A\u547D\u540D",si=async(d,t)=>{d.vault.getAbstractFileByPath(t)||await d.vault.createFolder(t)},Fl=(d,t)=>{let e=d.vault.adapter;if(!(e instanceof Da.FileSystemAdapter))return null;let n=e.getBasePath();if(!t.startsWith(n))return null;let i=t.slice(n.length);return(i.startsWith("/")||i.startsWith("\\"))&&(i=i.slice(1)),i.replace(/\\\\/g,"/")},Ol=(d,t)=>{var r,a;let e=(a=(r=d.metadataCache.getFileCache(t))==null?void 0:r.frontmatter)!=null?a:null,n=["\u5C0F\u7EA2\u4E66\u5C01\u9762\u56FE","\u5C0F\u7EA2\u4E66\u5C01\u9762","redbook_cover","xhs_cover"];for(let o of n){let s=e==null?void 0:e[o];if(typeof s=="string"&&s.trim())return s.trim()}let i=Xe(e);return i!=null?i:null},_l=(d,t)=>{if(!t||!t.trim())return null;let e=t.trim();if(e.startsWith("vault:")&&(e=e.slice(6)),e.startsWith("obsidian://")){let i=new He(d).parseObsidianUrl(e);i&&(e=i)}if(e.startsWith("file://")){let n=decodeURIComponent(e.replace("file://","")),i=Fl(d,n);i&&(e=i)}return e},Hl=(d,t,e)=>{if(ue.Platform.isMobile)return;let i=d.openWithDefaultApp;if(!i)return;let r=d.vault.adapter,a=r.getFullPath?r.getFullPath(t):t,o=l=>{try{i(l)}catch(c){console.debug("\u6253\u5F00\u6587\u4EF6\u5939\u5931\u8D25",c)}};if(o(a),o(`${a}/`),e){let l=r.getFullPath?r.getFullPath(e):e;o(l)}let s=typeof navigator!="undefined"?navigator.clipboard:void 0;s!=null&&s.writeText&&s.writeText(a)},Nl=(d,t)=>{var c,p,h,g,m,f,v,A;let e=d.vault,n=d.workspace.getActiveFile(),i=e.config,r=(c=i==null?void 0:i.attachmentFolderPath)!=null?c:"",a=t.trim();if(!a)return null;a=a.split("|")[0].split("?")[0].split("#")[0],(a.startsWith("/")||a.startsWith("\\"))&&(a=a.slice(1));let o=e.getAbstractFileByPath(a);if(o instanceof ue.TFile)return o;let s=d.metadataCache.getFirstLinkpathDest(a,(p=n==null?void 0:n.path)!=null?p:"");if(s instanceof ue.TFile)return s;if((h=n==null?void 0:n.parent)!=null&&h.path){let k=`${n.parent.path}/${a}`,C=e.getAbstractFileByPath(k);if(C instanceof ue.TFile)return C}let l=a.split("/").pop()||a;if(r){let k=[];if(r.startsWith("./")){let C=r.slice(2);k.push(`${(m=(g=n==null?void 0:n.parent)==null?void 0:g.path)!=null?m:""}/${C}/${l}`),k.push(`${(v=(f=n==null?void 0:n.parent)==null?void 0:f.path)!=null?v:""}/${C}/${a}`)}else k.push(`${r}/${l}`),k.push(`${r}/${a}`),(A=n==null?void 0:n.parent)!=null&&A.path&&(k.push(`${n.parent.path}/${r}/${l}`),k.push(`${n.parent.path}/${r}/${a}`));for(let C of k){let P=e.getAbstractFileByPath(C);if(P instanceof ue.TFile)return P}}return null},zl=()=>{let d=new Date,t=e=>String(e).padStart(2,"0");return`${d.getFullYear()}${t(d.getMonth()+1)}${t(d.getDate())}-${t(d.getHours())}${t(d.getMinutes())}${t(d.getSeconds())}`},Ra=async(d,t,e)=>{var v;let n=await d.vault.cachedRead(t),i=await e.parse(n),r=_l(d,Ol(d,t)),a=r?[r,...i.images.filter(A=>A!==r)]:i.images,o=((v=t.parent)==null?void 0:v.path)||"",s=o.includes("/")?o.split("/").slice(0,-1).join("/"):"",l=Ia(t.basename),c=(0,ue.normalizePath)(`${s}/\u5C0F\u7EA2\u4E66\u5BFC\u51FA/${l}-${zl()}`),p=(0,ue.normalizePath)(`${c}/\u56FE\u7247`);await si(d,(0,ue.normalizePath)(`${s}/\u5C0F\u7EA2\u4E66\u5BFC\u51FA`)),await si(d,c),await si(d,p);let h=(0,ue.normalizePath)(`${c}/\u6587\u6848.txt`);await d.vault.create(h,i.text);let g="",m=0;for(let A=0;A<a.length;A+=1){let k=a[A],C=A+1,P=Nl(d,k);if(!P){g+=`\u56FE${C}: \u672A\u627E\u5230\uFF08${k}\uFF09
`;continue}let K=P.extension||"png",le=`${String(C).padStart(2,"0")}-${Ia(P.basename)}.${K}`,U=(0,ue.normalizePath)(`${p}/${le}`),ne=await d.vault.readBinary(P);await d.vault.adapter.writeBinary(U,ne),g+=`\u56FE${C}: ${le}\uFF08\u539F\u59CB\uFF1A${k}\uFF09
`,m+=1}let f=(0,ue.normalizePath)(`${c}/\u4E0A\u4F20\u987A\u5E8F.txt`);return await d.vault.create(f,g.trim()+`
`),new ue.Notice(`\u5C0F\u7EA2\u4E66\u7D20\u6750\u5DF2\u5BFC\u51FA\uFF1A${c}\uFF08${m}/${a.length}\uFF09`),Hl(d,c,f),{folder:c,imageCount:a.length,successCount:m}}});var ke,Bl,jl,Vl,Ul,Wl,Oa,hn,_a=y(()=>{an();ke={heading:["\u2728","\u{1F539}","\u{1F538}"],listStyle:"\u25AB\uFE0F",orderedListStyle:["1\uFE0F\u20E3","2\uFE0F\u20E3","3\uFE0F\u20E3","4\uFE0F\u20E3","5\uFE0F\u20E3","6\uFE0F\u20E3","7\uFE0F\u20E3","8\uFE0F\u20E3","9\uFE0F\u20E3","\u{1F51F}"],taskListStyle:["\u{1F532}","\u2705"],hr:"---------------------"},Bl=d=>{if(!d.startsWith("---"))return d;let t=d.indexOf(`
---`,3);return t===-1?d:d.slice(t+4)},jl=d=>d.replace(/<[^>]*>/g,""),Vl=d=>d.replace(/!\[\[([^\]|#]+)(?:#[^\]|]+)?(?:\|[^\]]+)?\]\]/g,(t,e)=>{let n=String(e).trim();return n?`![](${n})`:""}),Ul=(d,t)=>{let e=/!\[\[[^\]]+\]\]|!\[[^\]]*\]\([^)]+\)/g;for(let n of d.matchAll(e)){let i=n[0]||"";if(i){if(i.startsWith("![[")){let a=i.slice(3,-2).split("|")[0].split("#")[0].trim();a&&t(a);continue}if(i.startsWith("![")){let r=i.replace(/^!\[[^\]]*\]\(/,"").replace(/\)$/,"");r=r.trim(),r.startsWith("<")&&r.endsWith(">")&&(r=r.slice(1,-1).trim());let a=r.indexOf(" ");a>0&&(r=r.slice(0,a).trim()),r&&t(r)}}}},Wl=d=>d.replace(/\n{3,}/g,`

`).trim(),Oa=d=>ke.orderedListStyle[d-1]||`${d}.`,hn=class{buildRenderer(t){let e=a=>{if(a==null)return"";if(typeof a=="string")return a;let o=a;return typeof o.text=="string"?o.text:typeof o.raw=="string"?o.raw:""},n=(a,o)=>{let s=a;return s&&typeof s.depth=="number"?s.depth:s&&typeof s.level=="number"?s.level:typeof o=="number"?o:1},i=(a,o,s=1)=>{let l="",c=s;for(let p of a){let h=p.trim();if(!h)continue;if(o){l+=`${Oa(c)} ${h}
`,c+=1;continue}let g=h.startsWith(ke.taskListStyle[0])||h.startsWith(ke.taskListStyle[1]);l+=g?`${h}
`:`${ke.listStyle} ${h}
`}return`
${l}
`};return{heading(a,o){let s=e(a),l=n(a,o);return`${ke.heading[l-1]||""} ${s}

`},paragraph(a){return`${e(a)}

`},strong(a){return e(a)},em(a){return e(a)},codespan(a){return e(a)},code(a,o){var p;let s=typeof a=="string"?a:(p=a==null?void 0:a.text)!=null?p:"",l=(a&&typeof a.lang=="string"?a.lang:o)||"";return`\u3010\u4EE3\u7801\u5757${l?`\uFF08${l}\uFF09`:""}\u3011
${s}

`},blockquote(a){return`${e(a).split(`
`).filter(l=>l.trim()).map(l=>`    ${l}`).join(`
`)}

`},hr(){return`
${ke.hr}
`},list(a,o){var c,p;if(typeof a=="string"){let h=a.split(`
`);return i(h,!!o,1)}let s=(p=(c=a==null?void 0:a.ordered)!=null?c:o)!=null?p:!1,l=typeof(a==null?void 0:a.start)=="number"?a.start:1;if(Array.isArray(a==null?void 0:a.items)){let h="",g=l;for(let m of a.items){let f=e(m);if(s){h+=`${Oa(g)} ${f}
`,g+=1;continue}if(m!=null&&m.task){let v=m.checked?ke.taskListStyle[1]:ke.taskListStyle[0];h+=`${v} ${f}
`;continue}h+=`${ke.listStyle} ${f}
`}return`
${h}
`}return""},listitem(a,o,s){var h,g,m;if(typeof a=="string")return o?`${s?ke.taskListStyle[1]:ke.taskListStyle[0]} ${a}`:a;let l=e(a);return((g=(h=a==null?void 0:a.task)!=null?h:o)!=null?g:!1)?`${((m=a==null?void 0:a.checked)!=null?m:s)?ke.taskListStyle[1]:ke.taskListStyle[0]} ${l}`:l},link(a,o,s){var p,h,g;if(typeof a=="string")return a;let l=(p=a==null?void 0:a.href)!=null?p:"",c=(g=(h=a==null?void 0:a.text)!=null?h:s)!=null?g:"";return l?`${c}\uFF08\u94FE\u63A5\uFF1A${l}\uFF09`:c},image(a){var l;let o=(l=a==null?void 0:a.href)!=null?l:typeof a=="string"?a:"";return`\u3010\u56FE${t(o||"")}\u3011`},br(){return`
`}}}async parse(t){let e=Bl(t),n=[],i=new Set,r=c=>{let p=(c||"").trim();return p?(i.has(p)||(i.add(p),n.push(p)),n.indexOf(p)+1):n.length+1};Ul(e,r);let a=Vl(e),o=new je;o.use({gfm:!0,breaks:!0}),o.use({renderer:this.buildRenderer(r)});let s=await o.parse(a);return{text:Wl(jl(String(s))),images:n}}}});function un(d,t){let e="";return d&&d.includes("/")&&(e=d.split("/")[1]||""),e||(e=t||"png"),`image-${new Date().getTime()}.${e}`}function ql(d){if(!d)return;let e=d.split("?")[0].split("#")[0].match(/\.([a-zA-Z0-9]+)$/);return e?e[1].toLowerCase():void 0}function gn(d,t){t.forEach(e=>{e.status==="rejected"&&console.error(`${d}\u4E0A\u4F20\u5931\u8D25:`,e.reason)})}function Gl(d){return new Promise((t,e)=>{let n=new Image;n.onload=()=>{let o=document.createElement("canvas"),s=window.devicePixelRatio||1;o.width=n.width*s,o.height=n.height*s;let l=o.getContext("2d");if(!l){e(new Error(u("render.faild-canvas-context")));return}l.drawImage(n,0,0),o.toBlob(c=>{c?t(c):e(new Error(u("render.failed-to-convert-canvas-to-blob")))},"image/png")},n.onerror=o=>{let s=o instanceof Error?o.message:typeof o=="string"?o:JSON.stringify(o);e(new Error(s))};let r=new TextEncoder().encode(d),a=String.fromCharCode.apply(null,r);n.src=`data:image/svg+xml;base64,${btoa(a)}`})}function li(d){let t=d.split(";base64,");console.debug("parts:",t);let e=t[0].split(":")[1];console.debug("contentType",e);let n=window.atob(t[1]);console.debug("raw:",n);let i=n.length,r=new Uint8Array(i);for(let a=0;a<i;++a)r[a]=n.charCodeAt(a);return console.debug("uInt8Array byteLength:",r.byteLength),new Blob([r],{type:e})}function Kl(d){let t=d.toDataURL("image/png");return li(t)}async function Ha(d,t){let e=[];d.querySelectorAll("svg").forEach(r=>{e.push(r)});let n=e.map(async r=>{let a=Pe(r);a.length<1e4||await Gl(a).then(async o=>{let s=await t.uploadMaterial(o,un(o.type,"png"));if(s&&s.url){let l=document.createElement("img");l.src=s.url,r.replaceWith(l)}else console.error("upload svg failed.")})}),i=await Promise.allSettled(n);gn("SVG",i)}async function Na(d,t){let e=[];d.querySelectorAll("canvas").forEach(r=>{e.push(r)});let n=e.map(async r=>{let a=Kl(r),o=await t.uploadMaterial(a,un(a.type,"png"));if(o&&o.url){let s=document.createElement("img");s.src=o.url,r.replaceWith(s)}else console.error("upload canvas failed.")}),i=await Promise.allSettled(n);gn("Canvas",i)}async function za(d,t,e){let n=[];d.querySelectorAll("img").forEach(a=>{n.push(a)});let i=n.map(async a=>{let o,s=ql(a.src);if(!a.src.includes("://mmbiz.qpic.cn/")){if(a.src.startsWith("data:image/"))o=li(a.src);else try{o=await Ct(a.src,e)}catch(l){console.error(`Error fetching image from ${a.src}:`,l);return}o!==void 0&&await t.uploadMaterial(o,un(o.type,s)).then(l=>{l&&l.url?a.src=l.url:console.error("upload image failed.")})}}),r=await Promise.allSettled(i);gn("\u56FE\u7247",r)}function Ba(d,t){var a;let e=d.classList.contains("one2mp")?d:(a=d.querySelector(".one2mp"))!=null?a:d,n=e.querySelector("p"),i=t||n&&window.getComputedStyle(n).color||window.getComputedStyle(e).color||"#333333",r=o=>{o.setCssProps({color:i,opacity:"1",filter:"none"})};d.querySelectorAll(".one2mp-callout .callout-text").forEach(r),d.querySelectorAll(".one2mp-callout .callout-content p, .one2mp-callout .callout-content li").forEach(r)}async function ja(d,t){let e=[];d.querySelectorAll("video").forEach(r=>{e.push(r)});let n=e.map(async r=>{let a;r.src.includes("://mmbiz.qpic.cn/")||(r.src.startsWith("data:image/")?a=li(r.src):a=await Ct(r.src),a!==void 0&&await t.uploadMaterial(a,un(a.type),"video").then(async o=>{if(o){let s=await t.getMaterialById(o.media_id);r.src=s.url}else console.error("upload video failed.")}))}),i=await Promise.allSettled(n);gn("\u89C6\u9891",i)}var Va=y(()=>{de();Pt();Ee()});var Ae,ci=y(()=>{Ae=class{constructor(){this.cardData=new Map}static getInstance(){return Ae.instance||(Ae.instance=new Ae),Ae.instance}setCardData(t,e){this.cardData.set(t,e)}cleanup(){this.cardData.clear()}restoreCard(t){for(let[e,n]of this.cardData.entries()){let r=`<section[^>]*\\sdata-id="${e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}"[^>]*>(.*?)<\\/section>`,a=new RegExp(r,"gs");if(!a.test(t)){console.warn("\u6CA1\u6709\u516C\u4F17\u53F7\u4FE1\u606F\uFF1A",e);continue}t=t.replace(a,n)}return t}}});var Y,Se=y(()=>{Y=class{constructor(t,e,n){this.plugin=t,this.previewRender=e,this.marked=n}prepare(){return Promise.resolve()}postprocess(t){return Promise.resolve(t)}beforePublish(){return Promise.resolve()}cleanup(){return Promise.resolve()}isPluginInstlled(t){let e=this.plugin.app.plugins.plugins;return Object.prototype.hasOwnProperty.call(e,t)}}});function Ga(d){if(!d)return"";let t=/\[!(.*?)\]/,e=d.match(t);return e?e[1].trim():""}function fi(d){return d?d.split(/\r?\n/).map(t=>t.replace(/^>\s?/,"")).join(`
`).trim():""}function ec(d,t){let e=d.charAt(0).toUpperCase()+d.slice(1).toLowerCase(),n=t.indexOf("]")+1;(t.indexOf("]-")>0||t.indexOf("]+")>0)&&(n=n+1);let i=t.indexOf(`
`);if(i===-1&&(i=t.length),n>=i)return e;let r=t.slice(n,i).trim();return r!==""&&(e=r),e}function tc(d){return d&&d.replace(/<p([^>]*)>([\s\S]*?)<\/p>/g,'<p$1><span class="callout-text">$2</span></p>')}var Jl,di,Zl,Yl,pi,hi,ui,gi,mi,Ua,Xl,Ql,Wa,qa,mn,Ka=y(()=>{Se();Jl='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-pencil"><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"></path><path d="m15 5 4 4"></path></svg>',di='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-clipboard-list"><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><path d="M12 11h4"></path><path d="M12 16h4"></path><path d="M8 11h.01"></path><path d="M8 16h.01"></path></svg>',Zl='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg>',Yl='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check-circle-2"><circle cx="12" cy="12" r="10"></circle><path d="m9 12 2 2 4-4"></path></svg>',pi='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-flame"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"></path></svg>',hi='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-check"><path d="M20 6 9 17l-5-5"></path></svg>',ui='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-help-circle"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><path d="M12 17h.01"></path></svg>',gi='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-alert-triangle"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path></svg>',mi='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>',Ua='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-zap"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>',Xl='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-bug"><path d="m8 2 1.88 1.88"></path><path d="M14.12 3.88 16 2"></path><path d="M9 7.13v-1a3.003 3.003 0 1 1 6 0v1"></path><path d="M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6"></path><path d="M12 20v-9"></path><path d="M6.53 9C4.6 8.8 3 7.1 3 5"></path><path d="M6 13H2"></path><path d="M3 21c0-2.1 1.7-3.9 3.8-4"></path><path d="M20.97 5c0 2.1-1.6 3.8-3.5 4"></path><path d="M22 13h-4"></path><path d="M17.2 17c2.1.1 3.8 1.9 3.8 4"></path></svg>',Ql='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>',Wa='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svg-icon lucide-quote"><path d="M3 21c3 0 7-1 7-8V5c0-1.25-.756-2.017-2-2H4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2 1 0 1 0 1 1v1c0 1-1 2-2 2s-1 .008-1 1.031V20c0 1 0 1 1 1z"></path><path d="M15 21c3 0 7-1 7-8V5c0-1.25-.757-2.017-2-2h-4c-1.25 0-2 .75-2 1.972V11c0 1.25.75 2 2 2h.75c0 2.25.25 4-2.75 4v3c0 1 0 1 1 1z"></path></svg>',qa=new Map(Object.entries({note:{icon:Jl},abstract:{icon:di},summary:{icon:di},tldr:{icon:di},info:{icon:Zl},todo:{icon:Yl},tip:{icon:pi},hint:{icon:pi},important:{icon:pi},success:{icon:hi},check:{icon:hi},done:{icon:hi},question:{icon:ui},help:{icon:ui},faq:{icon:ui},warning:{icon:gi},caution:{icon:gi},attention:{icon:gi},failure:{icon:mi},fail:{icon:mi},missing:{icon:mi},danger:{icon:Ua},error:{icon:Ua},bug:{icon:Xl},example:{icon:Ql},quote:{icon:Wa},cite:{icon:Wa}}));mn=class extends Y{prepare(){return this.marked||console.error("marked is not ready"),Promise.resolve()}async rendererBlockquote(t){let e=t.text||fi(t.raw||"");return`<blockquote dir="auto"><span class="icon-pin"></span><div class="blockquote-inner">${(await this.marked.parseInline(e)).replace(/\n/gm,"<br>").trim()}</div></blockquote>`}async rendererCallout(t){let e=t.text||fi(t.raw||""),n=Ga(e);if(!n)return this.rendererBlockquote(t);let i=n.toLowerCase(),r=ec(n,e),a=e.indexOf(`
`),o="";if(a>0){let c=e.slice(a+1).trim();c&&(o=await this.marked.parse(c)),!o&&c&&(o=(await this.marked.parseInline(c)).replace(/\n/gm,"<br>")),o=tc(o)}let s=qa.get(i)||qa.get("note"),l=s?s.icon:"";return`<section class="one2mp-callout" data-callout="${i}"><div class="callout-title"><div class="callout-icon">${l}</div><div class="callout-title-inner">${r}</div></div><div class="callout-content">${o}</div></section>`}markedExtension(){return{async:!0,walkTokens:async t=>{if(t.type!=="blockquote")return;let e=t,n=e.raw||"",i=fi(n);!e.text&&i&&(e.text=i),Ga(i||e.text)?t.html=await this.rendererCallout(e):t.html=await this.rendererBlockquote(e)},extensions:[{name:"blockquote",level:"block",renderer:t=>t.html}]}}}});var nc,fn,ic,Rt,rc,ac,Ja,Za,Ya=y(()=>{nc=d=>d&&d.replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"),fn=d=>d.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ic=d=>{let t=d.match(/```mpcard\s*([\s\S]*?)```/i);return t?t[1].trim():d.trim()},Rt=(d,t)=>{var i,r;let e=new RegExp(`\\b${t}=("([^"]*)"|'([^']*)')`,"i"),n=d.match(e);return n?nc(((r=(i=n[2])!=null?i:n[3])!=null?r:"").trim()):""},rc=d=>{let t=d.split(/\r?\n/).map(i=>i.trim()).filter(i=>i.length>0),e={},n=/^(\w+):\s*"?(.*?)"?$/;for(let i of t){let r=i.match(n);if(r){let a=r[1].trim().toLowerCase(),o=r[2].trim();e[a]=o}}return{id:e.id||"",headimg:e.headimg||e.avatar||"",nickname:e.nickname||e.name||"",signature:e.signature||e.desc||e.description||"",alias:e.alias||""}},ac=d=>{let t=ic(d);if(!t)return null;if(/<mp-common-profile/i.test(t)||/\bdata-id=/.test(t))return{id:Rt(t,"data-id"),headimg:Rt(t,"data-headimg"),nickname:Rt(t,"data-nickname"),signature:Rt(t,"data-signature"),alias:Rt(t,"data-alias"),rawHtml:t};let e=rc(t);return{id:e.id||"",headimg:e.headimg||"",nickname:e.nickname||"",signature:e.signature||"",alias:e.alias,rawHtml:""}},Ja=d=>{let t=ac(d);if(!t||!t.id||!t.rawHtml)return null;let e=t.rawHtml.trim();return/<mp-common-profile/i.test(e)?(/^\s*<section/i.test(e)||(e=`<section class="mp_profile_iframe_wrp" nodeleaf="">${e}</section>`),{info:t,html:e}):null},Za=d=>{let t=fn(d.headimg||""),e=fn(d.nickname||""),n=fn(d.signature||"");return`<section${d.id?` data-id="${fn(d.id)}"`:""} class="one2mp-mpcard-wrapper"><div class="one2mp-mpcard-content"><img class="one2mp-mpcard-headimg" width="54" height="54" src="${t}"></img><div class="one2mp-mpcard-info"><div class="one2mp-mpcard-nickname">${e}</div><div class="one2mp-mpcard-signature">${n}</div></div></div><div class="one2mp-mpcard-foot">\u516C\u4F17\u53F7</div></section>`}});var Xa,vn,Qa=y(()=>{de();Pt();Ee();Dt();Se();Xa=require("obsidian");ci();Ya();vn=class extends Y{constructor(){super(...arguments);this.mermaidIndex=0;this.admonitionIndex=0;this.chartsIndex=0}prepare(){return this.mermaidIndex=0,this.admonitionIndex=0,this.chartsIndex=0,Ae.getInstance().cleanup(),Promise.resolve()}static srcToBlob(e){let n=e.split(",")[1],i=atob(n),r=new Array(i.length);for(let o=0;o<i.length;o++)r[o]=i.charCodeAt(o);let a=new Uint8Array(r);return new Blob([a],{type:"image/png"})}getHighlightProfile(e){if(!e)return null;let n=e.toLowerCase(),i=new Set(["const","let","var","function","return","if","else","for","while","switch","case","break","continue","class","new","this","try","catch","finally","throw","import","export","from","extends","super","await","async","typeof","instanceof","in","of","interface","type","enum","public","private","protected","readonly","implements","constructor","static","get","set"]),r=new Set(["def","class","import","from","return","if","elif","else","for","while","try","except","finally","with","as","pass","break","continue","lambda","yield","True","False","None"]),a=new Set(["true","false","null"]),o=new Set(["if","then","fi","for","do","done","case","esac","function","in","while","until","return","export","local","readonly"]);return{js:{keywords:i,lineComment:"//",blockComment:{start:"/*",end:"*/"},allowBacktick:!0},javascript:{keywords:i,lineComment:"//",blockComment:{start:"/*",end:"*/"},allowBacktick:!0},ts:{keywords:i,lineComment:"//",blockComment:{start:"/*",end:"*/"},allowBacktick:!0},typescript:{keywords:i,lineComment:"//",blockComment:{start:"/*",end:"*/"},allowBacktick:!0},json:{keywords:a},py:{keywords:r,lineComment:"#"},python:{keywords:r,lineComment:"#"},sh:{keywords:o,lineComment:"#"},bash:{keywords:o,lineComment:"#"},shell:{keywords:o,lineComment:"#"},zsh:{keywords:o,lineComment:"#"}}[n]||null}escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}preserveSpaces(e){return e.replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/ /g,"&nbsp;")}isIdentifierStart(e){let n=e.charCodeAt(0);return n>=65&&n<=90||n>=97&&n<=122||e==="_"||e==="$"}isIdentifierPart(e){let n=e.charCodeAt(0);return n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||e==="_"||e==="$"}highlightLine(e,n,i){let r=[],a=0,o=(l,c)=>{c&&r.push({type:l,text:c})};for(;a<e.length;){let l=e[a];if(n.inBlockComment&&i.blockComment){let p=e.indexOf(i.blockComment.end,a);if(p>=0){o("comment",e.slice(a,p+i.blockComment.end.length)),a=p+i.blockComment.end.length,n.inBlockComment=!1;continue}o("comment",e.slice(a)),a=e.length;continue}if(n.inString){let p="";for(;a<e.length;){let h=e[a];if(p+=h,h==="\\"&&a+1<e.length){p+=e[a+1],a+=2;continue}if(a+=1,h===n.stringChar){n.inString=!1;break}}o("string",p);continue}if(i.lineComment&&e.startsWith(i.lineComment,a)){o("comment",e.slice(a));break}if(i.blockComment&&e.startsWith(i.blockComment.start,a)){n.inBlockComment=!0;continue}if(l==="'"||l==='"'||l==="`"&&i.allowBacktick){n.inString=!0,n.stringChar=l;continue}if(l===" "||l==="	"){let p=a;for(;a<e.length&&(e[a]===" "||e[a]==="	");)a+=1;o("plain",e.slice(p,a));continue}let c=l.charCodeAt(0);if(c>=48&&c<=57||l==="."&&a+1<e.length&&e[a+1]>="0"&&e[a+1]<="9"){let p=a;for(a+=1;a<e.length;){let h=e[a];if(h>="0"&&h<="9"||h==="."||h==="_"||h==="x"||h==="X"||h>="a"&&h<="f"||h>="A"&&h<="F"){a+=1;continue}break}o("number",e.slice(p,a));continue}if(this.isIdentifierStart(l)){let p=a;for(a+=1;a<e.length&&this.isIdentifierPart(e[a]);)a+=1;let h=e.slice(p,a);i.keywords.has(h)?o("keyword",h):o("plain",h);continue}o("plain",l),a+=1}return{html:r.map(l=>{let c=this.preserveSpaces(this.escapeHtml(l.text));return l.type==="plain"?c:`<span class="o2any-token-${l.type}">${c}</span>`}).join(""),state:n}}codeRenderer(e,n){var h;let i=(h=(n||"").match(/^\S*/))==null?void 0:h[0],r=e.replace(/\n$/,""),a=this.getHighlightProfile(i||""),o=r.split(/\r?\n/),s="",l={inBlockComment:!1,inString:!1,stringChar:""};for(let g of o){let m=g;if(a){let f=this.highlightLine(g,l,a);m=f.html,l.inBlockComment=f.state.inBlockComment,l.inString=f.state.inString,l.stringChar=f.state.stringChar}else m=this.preserveSpaces(this.escapeHtml(g));m.length===0&&(m="<br>"),s+="<code>"+m+"</code>"}let c='<section class="code-section code-snippet__fix">',p="";return i?p=c+`<pre style="max-width:1000% !important;" class="hljs o2any-codeblock language-${i}">${s}</pre></section>`:p=c+`<pre class="hljs o2any-codeblock">${s}</pre></section>`,p}static getMathType(e){if(!e)return null;let n=e.toLowerCase();return n=n.trim(),n==="am"||n==="asciimath"?"asciimath":n==="latex"||n==="tex"?"latex":null}renderAdmonition(e,n){let i=ae.getInstance(this.plugin.app).queryElement(this.admonitionIndex,".callout.admonition");if(!i)return u("render.admonition-failed");this.admonitionIndex++;let r=i.querySelector(".edit-block-button");r&&r.parentNode.removeChild(r);let a=i.querySelector(".callout-fold");if(a)try{a.parentNode.removeChild(a)}catch(o){console.error(o)}return Pe(i)}renderAdmonitionAsync(e,n){let r=ae.getInstance(this.plugin.app).queryElement(this.admonitionIndex,".callout.admonition");if(!r)return u("render.admonition-failed");this.admonitionIndex++;let a=r.querySelector(".edit-block-button");a&&a.parentNode.removeChild(a);let o=r.querySelector(".callout-fold");if(o)try{o.parentNode.removeChild(o)}catch(s){console.error(s)}return la(r)}async renderMermaidAsync(e){var c;e.html=u("render.mermaid-failed");let n=this.mermaidIndex;this.mermaidIndex++;let i=ae.getInstance(this.plugin.app),r=i.queryElement(n,".mermaid");if(!r)return;await i.waitForSelector(r,"svg",5e3);let a=r.querySelector("svg");if(!a)return;let o=r.closest(".one2mp-render-preview"),s=(c=o==null?void 0:o.classList.contains("one2mp-render-preview-visible"))!=null?c:!1,l=r.classList.contains("one2mp-mermaid-visible");try{o==null||o.classList.add("one2mp-render-preview-visible"),r.classList.add("one2mp-mermaid-visible");let{width:p,height:h}=this.getMermaidSize(a),g=await i.domToImage(a,{width:p,height:h});e.html=`<section id="one2mp-mermaid-${n}" class="mermaid"><img src="${g}" class="mermaid-image" style="width:${p}px;height:auto;"></section>`}catch(p){console.error(p)}finally{o&&!s&&o.classList.remove("one2mp-render-preview-visible"),l||r.classList.remove("one2mp-mermaid-visible")}}getMermaidSize(e){var a;let n=e.getBoundingClientRect(),i=Math.round(n.width),r=Math.round(n.height);if(!i||!r){let o=(a=e.viewBox)==null?void 0:a.baseVal;o&&o.width&&o.height&&(i=Math.round(o.width),r=Math.round(o.height))}if(!i||!r){let o=e.getAttribute("width"),s=e.getAttribute("height"),l=o?parseFloat(o):0,c=s?parseFloat(s):0;l&&(i=Math.round(l)),c&&(r=Math.round(c))}return i||(i=800),r||(r=400),{width:i,height:r}}renderCharts(e){if(!this.isPluginInstlled("obsidian-charts"))return console.debug("charts plugin not installed."),new Xa.Notice(u("rnder.charts-plugin-not-installed")),!1;let n=this.plugin.resourceManager.getMarkdownRenderedElement(this.chartsIndex,".block-language-chart");if(!n)return u("render.charts-failed");let i=`charts-img-${this.chartsIndex}`;this.chartsIndex++;let r=n.querySelector("canvas");if(r){let a="image/png",o=r.toDataURL(a);return`<section id="${i}" class="charts" >
			<img src="${o}" class="charts-image" />
			</section>`}return u("render.charts-failed")}renderWewriteProfile(e){let n=e.text.split(/\r?\n/).filter(o=>o.trim()!==""),i={},r=/^(\w+):\s*"?(.*?)"?$/;return n.forEach(o=>{let s=o.match(r);if(s){let l=s[1].trim().toLocaleLowerCase(),c=s[2].trim();i[l]=c}}),`<div class="one2mp-profile-card">
		<a class="one2mp-profile-card-link" href="${i.url}">
			<div class="card-main">
				<div class="avatar">
					<img src="${i.avatar}" alt="${i.nickname}" avatar class="one2mp-avatar-image" >
				</div>
			<div class="content">
				<div class="title">${i.nickname}</div>
				<div class="description">${i.description}</div>
				<div class="meta">${i.tips}</div>
			</div>
			<div class="arrow"><i class="weui-icon-arrow"></i></div>
			</div>
			<div class="card-footer">${i.footer}</div>
		</a>
  	</div>`}renderMpcard(e){let n=Ja(e.text);if(!n)return"<span>\u516C\u4F17\u53F7\u540D\u7247\u6570\u636E\u9519\u8BEF\uFF0C\u7F3A\u5C11id</span>";let{info:i,html:r}=n;return!i.headimg&&!i.nickname&&!i.signature?"<span>\u516C\u4F17\u53F7\u540D\u7247\u6570\u636E\u4E3A\u7A7A</span>":(Ae.getInstance().setCardData(i.id,r),Za({...i,nickname:i.nickname||u("render.mpcard-default-name"),signature:i.signature||u("render.mpcard-default-signature")}))}markedExtension(){return{extensions:[{name:"code",level:"block",renderer:e=>e.lang&&e.lang.trim().toLocaleLowerCase()=="mermaid"?e.html:e.lang&&e.lang.trim().toLocaleLowerCase()=="chart"?this.renderCharts(e):e.lang&&e.lang.trim().toLocaleLowerCase()=="one2mp-profile"?this.renderWewriteProfile(e):e.lang&&e.lang.trim().toLocaleLowerCase()=="mpcard"?this.renderMpcard(e):e.lang&&e.lang.trim().toLocaleLowerCase().startsWith("ad-")?e.html:this.codeRenderer(e.text,e.lang)}],async:!0,walkTokens:async e=>{if(e.lang&&e.lang.trim().toLocaleLowerCase()=="mermaid"&&await this.renderMermaidAsync(e),e.lang&&e.lang.trim().toLocaleLowerCase().startsWith("ad-")){let n=e.lang.trim().toLocaleLowerCase().replace("ad-","");n===""&&(n="note"),e.html=this.renderAdmonitionAsync(e,n)}}}}}});var bn,eo=y(()=>{Se();bn=class extends Y{constructor(){super(...arguments);this.mermaidIndex=0;this.admonitionIndex=0;this.chartsIndex=0}extractOne2MpCaptions(e){let n=/^wwcap:\s*(.*)$/gim,i=[],r;for(;(r=n.exec(e))!==null;)i.push(r[1].trim());return i}codespanRenderer(e){e=e.trim();let n=this.extractOne2MpCaptions(e);return n.length>0?`<div class="one2mp-image-caption">${n[0]}</div>`:`<span class="one2mp-codespan">${e}</span>`}markedExtension(){return{extensions:[{name:"codespan",level:"inline",renderer:e=>e.html}],walkTokens:e=>{e.type==="codespan"&&(e.html=this.codespanRenderer(e.text))}}}}});function to(d){let t=/^pdf#page=(\d+)(&rect=.*?)$/,e=d.lastIndexOf("|");e>0&&(d=d.substring(0,e));let n=d.lastIndexOf(".");if(n==-1)return"note";let i=d.substring(n+1);if(t.test(i))return"pdf-crop";if(d.startsWith("https://mmbiz.qpic.cn/")||d.startsWith("http://mmbiz.qpic.cn/"))return"image";switch(i.toLocaleLowerCase()){case"md":return"note";case"png":case"jpg":case"jpeg":case"gif":case"bmp":return"image";case"webp":return"webp";case"svg":return"svg";case"pdf":return"pdf";case"mp4":return"video";case"mp3":case"wma":case"wav":case"amr":return"voice";case"excalidraw":return"excalidraw";default:return"file"}}var no,oc,Ot,Ft,io=y(()=>{no=require("obsidian");Dt();Se();de();kt();Ee();oc=/^!\[\[(.*?)\]\]/;Ot=class extends Y{constructor(){super(...arguments);this.index=0;this.videoIndex=0;this.voiceIndex=0;this.pdfCropIndex=0;this.embedMarkdownIndex=0;this.excalidrawIndex=0;this.markdownEmbedIndex=0}generateId(){return this.index+=1,`fid-${this.index}`}prepare(){return this.videoIndex=0,this.voiceIndex=0,this.pdfCropIndex=0,this.index=0,this.embedMarkdownIndex=0,this.excalidrawIndex=0,this.markdownEmbedIndex=0,Promise.resolve()}searchFile(e){let n=this.resolvePath(e),i=this.plugin.app.vault,r=i.config.attachmentFolderPath||"",a=n,o=null;if(o=i.getFileByPath(n),o||(o=i.getFileByPath(e),o)||r!=""&&(a=r+"/"+e,o=i.getFileByPath(a),o||(a=r+"/"+n,o=i.getFileByPath(a),o)))return o;let s=i.getAllLoadedFiles();for(let l of s)if(l.path.includes(e))return l;return null}resolvePath(e){let n=this.getActiveFileDir();if(!e.includes("/"))return e;let i=n.split("/"),r=e.split("/");i.pop();for(let a of r)a!=="."&&(a===".."?i.pop():i.push(a));return i.join("/")}getActiveFileDir(){let e=this.plugin.app.workspace.getActiveFile();if(e==null)return"";let n=e.path.split("/");return n.pop(),n.length==0?"":n.join("/")}getImagePath(e){if(e.startsWith("http"))return e;let n=this.searchFile(e);return n==null?(console.error("File not found"+e),""):n instanceof no.TFile?this.plugin.app.vault.getResourcePath(n):""}isImage(e){return e=e.toLowerCase(),e.endsWith(".png")||e.endsWith(".jpg")||e.endsWith(".jpeg")||e.endsWith(".gif")||e.endsWith(".bmp")||e.endsWith(".webp")}parseImageLink(e){if(e.includes("|")){let n=e.split("|"),i=n[0];if(!this.isImage(i))return null;let r=null,a=null;if(n.length==2){let o=n[1].toLowerCase().split("x");r=parseInt(o[0]),o.length==2&&o[1]!=""&&(a=parseInt(o[1]))}return{path:i,width:r,height:a}}return{path:e,width:null,height:null}}getHeaderLevel(e){let n=e.trimStart().match(/^#{1,6}/);return n?n[0].length:0}async getFileContent(e,n,i){let r=await this.plugin.app.vault.adapter.read(e.path);if(n==null&&i==null)return r;let a="",o=r.split(`
`);if(n){let s=0,l=!1;for(let c of o){if(l){if(s==this.getHeaderLevel(c))break;a+=c+`
`;continue}if(!c.trim().startsWith("#"))continue;let p=c.trim().split(" ");p.length==2&&n.trim()==p[1].trim()&&this.getHeaderLevel(c)&&(a+=c+`
`,s=this.getHeaderLevel(c),l=!0)}}if(i)for(let s=0;s<o.length;s++){let l=o[s];if(l.indexOf(i)>=0){if(a=l.replace(i,""),a.trim()=="")for(let c=s-1;c>=0;c--){let p=o[c];if(p.trim()!=""){a=p;break}}break}}return a}parseFileLink(e){let i=e.split("|")[0].split("#"),r=i[0],a=null,o=null;return i.length==2&&(i[1].startsWith("^")?o=i[1]:a=i[1]),{path:r,head:a,block:o}}async renderFile(e){let{path:n,head:i,block:r}=this.parseFileLink(e),a=null;if(n===""?a=this.plugin.app.workspace.getActiveFile():(n.endsWith(".md")||(n=n+".md"),a=this.searchFile(n)),a==null){let c="File not found:"+n;console.error(c);return}let o=await this.getFileContent(a,i,r),{content:s}=Be(o);return await this.marked.parse(s)}parseLinkStyle(e){let n="",i='style="width:100%;height:100%"',r="left",a=["left","center","right"];if(e.includes("|")){let o=e.split("|");n=o[0];let s="";if(o.length==2?a.includes(o[1])?r=o[1]:s=o[1]:o.length==3&&(s=o[1],a.includes(o[1])?(s=o[2],r=o[1]):(s=o[1],r=o[2])),s!=""){let l=s.split("x");l.length==2?i=`style="width:${l[0]}px;height:${l[1]}px;"`:i=`style="width:${l[0]}px;"`}}else n=e;return{filename:n,style:i,postion:r}}parseSVGLink(e){let n="note-embed-svg-left",i=new Map([["left","note-embed-svg-left"],["center","note-embed-svg-center"],["right","note-embed-svg-right"]]),{filename:r,style:a,postion:o}=this.parseLinkStyle(e);return n=i.get(o)||n,{filename:r,style:a,classname:n}}async renderSVGFile(e,n){let i=this.searchFile(e);if(i==null){let a=u("render.file-not-found")+i;console.error(a),this.previewRender.updateElementByID(n,a);return}let r=await this.getFileContent(i,null,null);Ot.fileCache.set(e,r),this.previewRender.updateElementByID(n,r)}markedExtension(){return{extensions:[{name:"Embed",level:"inline",start:e=>e.indexOf("![["),tokenizer:e=>{let n=e.match(oc);return n==null?void 0:{type:"Embed",raw:n[0],href:n[1],text:n[1]}},renderer:e=>{let n=to(e.href);if(console.debug("render embed type:",e,n),n=="image"||n=="webp"){let i=this.parseImageLink(e.href);if(i){let r=this.getImagePath(i.path),a=i.width?`width="${i.width}"`:"",o=i.height?`height="${i.height}"`:"";return`<img src="${r}" alt="${e.text}" ${a} ${o} />`}}else if(n=="svg"){let i=this.parseSVGLink(e.href),r=this.generateId(),a=u("render.rendering");return Ot.fileCache.has(i.filename)?a=Ot.fileCache.get(i.filename)||u("render.render-failed"):this.renderSVGFile(i.filename,r),`<span class="${i.classname}"><span class="note-embed-svg" id="${r}" ${i.style}>${a}</span></span>`}else{if(n=="excalidraw")return e.html;if(n=="pdf-crop")return this.renderPdfCrop(e.href);if(n=="note")return e.html;if(n=="video")return this.renderVideo(e.href);if(n=="voice")return this.renderVoice(e.href)}}}],async:!0,walkTokens:async e=>{if(e.type!=="Embed")return;let n=to(e.href);n==="excalidraw"?await this.renderExcalidrawAsync(e):n==="note"&&await this.renderMarkdownEmbedAsync(e)}}}async renderExcalidrawAsync(e){if(!this.isPluginInstlled("obsidian-excalidraw-plugin"))return!1;e.html=u("render.excalidraw-failed");let n=this.excalidrawIndex;this.excalidrawIndex++;let i=ae.getInstance(this.plugin.app),r=i.queryElement(n,"div.excalidraw-svg");if(!r){console.error("renderExcalidrawAsync error:","root is null");return}r.removeAttribute("style");try{let a=r.querySelector("img");a&&(a.setAttr("width","100%"),a.setAttr("height","100%"),a.setAttr("style","width:100%;height:100%"));let o=await i.domToImage(r);e.html=`<section class="excalidraw" ><img src="${o}" class="exclaidraw-image" ></section>`}catch(a){console.error("renderExcalidrawAsync error:",a)}}async renderMarkdownEmbedAsync(e){let n=e.href,i=await this.renderFile(n);e.html=`<div class="markdown-embed inline-embed is-loaded">${i}</div>`}renderPdfCrop(e){if(!this.isPluginInstlled("pdf-plus"))return!1;let n=ae.getInstance(this.plugin.app).queryElement(this.pdfCropIndex,".pdf-cropped-embed");return n?(this.pdfCropIndex++,`<section class="pdf-crop">${Pe(n)}</section>`):u("render.pdf-crop-failed")}renderVideo(e){let n=ae.getInstance(this.plugin.app).queryElement(this.videoIndex,"video");return n?(this.videoIndex++,`<section class="video">${Pe(n)}</section>`):"render video failed"}renderVoice(e){let n=ae.getInstance(this.plugin.app).queryElement(this.voiceIndex,"audio");return n?(this.voiceIndex++,`<section class="audio">${Pe(n)}</section>`):"render voice failed"}},Ft=Ot;Ft.fileCache=new Map});var ro,wn,ao=y(()=>{Se();ro=require("obsidian");Ee();wn=class extends Y{postprocess(t){let e=(0,ro.sanitizeHTMLToDom)(t),n=createEl("div");n.appendChild(e);let i=n.querySelectorAll("h1, h2, h3, h4, h5, h6");for(let r of i){let a=r.textContent;r.empty(),r.createSpan({text:" ",cls:"one2mp-heading-prefix"}),r.createSpan({cls:"one2mp-heading-outbox"}).createSpan({text:a||"",cls:"one2mp-heading-leaf"}),r.createSpan({cls:"one2mp-heading-tail"})}return Promise.resolve(Te(n))}markedExtension(){return{extensions:[]}}}});function lc(){let d=globalThis.MathJax;return d!=null?d:null}function vi(d){return d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function cc(d){var e;let t=d.tagName.toLowerCase()=="svg"?d:d.querySelector("svg");return t?sc.serializeToString(t):vi((e=d.textContent)!=null?e:"")}function oo(d,t=!1){let e=lc();if(!(e!=null&&e.tex2svg))return vi(d);try{let n=e.tex2svg(d,{display:t});return cc(n)}catch(n){return console.warn("MathJax \u6E32\u67D3\u5931\u8D25",n),vi(d)}}var sc,so=y(()=>{sc=new XMLSerializer});var lo,dc,xn,co=y(()=>{so();Se();lo=/^(\${1,2})(?!\$)((?:\\.|[^\\\n])*?(?:\\.|[^\\\n$]))\1/,dc=/^(\${1,2})\n((?:\\[^]|[^\\])+?)\n\1(?:\n|$)/,xn=class extends Y{renderer(t,e,n=""){n===""&&(n="InlineMath");let i=oo(t.text,!e);return e?`<span  class="inline-math">${i}</span>`:`<section  class="block-math">${i}</section>`}markedExtension(){return{extensions:[this.inlineMath(),this.blockMath()]}}inlineMath(){return{name:"InlineMath",level:"inline",start(t){let e,n=t;for(;n;){if(e=n.indexOf("$"),e===-1)return;if(n.substring(e).match(lo))return e;n=n.substring(e+1).replace(/^\$+/,"")}},tokenizer(t){let e=t.match(lo);if(e)return{type:"InlineMath",raw:e[0],text:e[2].trim(),displayMode:e[1].length===2}},renderer:t=>this.renderer(t,!0)}}blockMath(){return{name:"BlockMath",level:"block",tokenizer(t){let e=t.match(dc);if(e)return{type:"BlockMath",raw:e[0],text:e[2].trim(),displayMode:e[1].length===2}},renderer:t=>this.renderer(t,!1)}}}});var pc,hc,yn,po=y(()=>{Dt();Se();Ee();pc=/`(ris|fas):([a-z0-9-]+)`/i,hc=/^`(ris|fas):([a-z0-9-]+)`/i,yn=class extends Y{constructor(){super(...arguments);this.remixIndex=0}prepare(){return this.remixIndex=0,Promise.resolve()}render(){let e=ae.getInstance(this.plugin.app).queryElement(this.remixIndex,".obsidian-icon.react-icon");return e?(this.remixIndex++,Pe(e)):"<span>remix icon not found </span>"}markedExtension(){return{extensions:[{name:"remixIcon",level:"inline",start:e=>{let n=e.match(pc);if(n)return n.index},tokenizer:e=>{let n=e.match(hc);if(n)return{type:"remixIcon",raw:n[0],text:n[0].trim(),lang:n[1]}},renderer:()=>this.render()}]}}}});var kn,ho=y(()=>{Se();kn=class extends Y{markedExtension(){return{extensions:[{name:"table",level:"block",renderer:t=>{let e=(r,a)=>{var c;let o=r.align,s=o?` style="text-align:${o};"`:"",l=(c=r.tokens)!=null&&c.length?this.marked.Parser.parseInline(r.tokens):r.text;return`<${a}${s}>${l}</${a}>`},n=t.header.map(r=>e(r,"th")),i=t.rows.map(r=>`<tr>${r.map(o=>e(o,"td")).join("")}</tr>`);return`<section class="table-container"><table><thead><tr>${n.join("")}</tr></thead><tbody>${i.join("")}</tbody></table></section>`}}]}}}});var Sn,uo=y(()=>{Se();Sn=class extends Y{markedExtension(){return{extensions:[{name:"footnote",level:"block",start:t=>{var e;return(e=t.match(/\[\^(\w+)\]:/))==null?void 0:e.index},tokenizer:t=>{let n=/^\[\^(\w+)\]:\s*(.*)/.exec(t);if(n)return{type:"footnote",raw:n[0],id:n[1],text:n[2],tokens:[]}},renderer:t=>{if(t.type==="footnote")return`<div id="footnote-${t.id}" class="footnote"><span class="footnote-id">\u3010${t.id}\u3011 </span>${t.text}</div>`}},{name:"footnoteMark",level:"inline",start:t=>{var e;return(e=t.match(/\[\^(\w+)\]/))==null?void 0:e.index},tokenizer:t=>{let n=/^\[\^(\w+)\]/.exec(t);if(n)return{type:"footnoteMark",raw:n[0],id:n[1],tokens:[]}},renderer:t=>{if(t.type==="footnoteMark")return`<a>${t.text}<sup>\u3010${t.id}\u3011</sup></a>`}}]}}}});var Cn,go=y(()=>{Se();Cn=class extends Y{constructor(){super(...arguments);this.allLinks=[]}prepare(){return this.allLinks=[],Promise.resolve()}postprocess(e){var a,o;if(!this.allLinks.length)return Promise.resolve(e);let n=[],i=new Map;for(let s of this.allLinks){let l=i.get(s.href);if(!l){let g={href:s.href,text:s.text};i.set(s.href,g),n.push(g);continue}let c=((a=l.text)==null?void 0:a.trim())||"",p=((o=s.text)==null?void 0:o.trim())||"";p&&p!==s.href&&(c===s.href||p.length>c.length)&&(l.text=p)}let r=n.map(s=>{var p;let l=(p=s.text)==null?void 0:p.trim();return`<li>${l&&l!==s.href?l:"\u5916\u94FE"}\uFF1A<a data-linktype="2" data-link="${s.href}" href="${s.href}">${s.href}</a>&nbsp;\u21A9</li>`});return Promise.resolve(`${e}<section class="foot-links"><hr class="foot-links-separator"><ol>${r.join("")}</ol></section>`)}markedExtension(){return{extensions:[{name:"link",level:"inline",renderer:e=>{let n=i=>i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;");if(e.href.startsWith("http")){let i=(e.text||"").trim(),r=n(e.href);return!i||i===e.href?`<strong>(${r})</strong>`:`${n(i)}<strong>(${r})</strong>`}else return`<a href="${e.href}">${e.text}</a>`}}]}}}});function uc(d){return/^h[1-6]$/i.test(d.tagName)}function mo(d){return uc(d)?parseInt(d.tagName.charAt(1),10):null}function gc(d,t){let e=mo(t),n=mo(d);return n===null?!0:e===null||e>n}var fo,Pn,vo=y(()=>{fo=require("obsidian");Ee();Se();Pn=class extends Y{processHeading(t,e){var a;let n=["h1","h2","h3","h4","h5","h6"],i=e.trim().toLowerCase();if(!n.includes(i))return t;let r=t.querySelectorAll(e.trim());for(let o=0;o<r.length;o++){let s=r[o];if(s){let l=createEl("details");l.createEl("summary",{text:(a=s.textContent)!=null?a:""});let c=s.nextSibling;for(;c&&gc(s,c);){let p=c.nextSibling;l.appendChild(c),c=p}s.replaceWith(l)}}return t}postprocess(t){let e=this.previewRender.articleProperties.get("folded-headings");if(e===void 0||!e)return Promise.resolve(t);let n=(0,fo.sanitizeHTMLToDom)(t),i=createEl("div");i.appendChild(n);let r=e.split(",");for(let a of r)this.processHeading(i,a);return Promise.resolve(Te(i))}markedExtension(){return{extensions:[]}}}});var _t,Tn,bo=y(()=>{_t=require("obsidian");Ee();Se();Tn=class extends Y{isImageFile(t){if(!(t instanceof _t.TFile))return!1;let e=t.extension.toLowerCase();return["png","jpg","jpeg","gif","bmp","webp","svg"].includes(e)}findImageFile(t){var g,m,f,v,A;let e=this.plugin.app.vault,n=this.plugin.app.workspace.getActiveFile(),i=(m=(g=n==null?void 0:n.parent)==null?void 0:g.path)!=null?m:"",r="app://obsidian.md/",a=t.trim();if(a.startsWith(r)&&(a=decodeURIComponent(a.slice(r.length))),a=a.split("|")[0].split("?")[0].split("#")[0],!a)return null;let o=this.plugin.app.metadataCache.getFirstLinkpathDest(a,(f=n==null?void 0:n.path)!=null?f:"");if(this.isImageFile(o))return o;if(a.includes("/")){let k=a.split("/").pop()||a;if(o=this.plugin.app.metadataCache.getFirstLinkpathDest(k,(v=n==null?void 0:n.path)!=null?v:""),this.isImageFile(o))return o}let s=e.config,l=(A=s==null?void 0:s.attachmentFolderPath)!=null?A:"",c=a.split("/").pop()||a,p=[];if(!l||l===".")i?(p.push(`${i}/${a}`),p.push(`${i}/${c}`)):p.push(a,c);else if(l.startsWith("./")){let k=l.slice(2),C=i?`${i}/${k}`:k;p.push(`${C}/${a}`),p.push(`${C}/${c}`)}else p.push(`${l}/${a}`),p.push(`${l}/${c}`);for(let k of p)if(o=e.getAbstractFileByPath(k),this.isImageFile(o))return o;let h=e.getAllLoadedFiles();for(let k of h)if(k instanceof _t.TFile&&k.basename===c&&this.isImageFile(k))return k;return null}resolveImageSrc(t){let e=t.trim();if(!e||/^(https?:|data:)/i.test(e))return e;let n=this.findImageFile(e);return n?this.plugin.app.vault.getResourcePath(n):t}processImage(t){var n,i,r;let e=t.querySelectorAll("img");for(let a=0;a<e.length;a++){let o=e[a],s=(n=o.getAttribute("class"))==null?void 0:n.split(" ");if(s!=null&&s.includes("one2mp-avatar-image"))continue;let l=o.getAttribute("src");l&&o.setAttribute("src",this.resolveImageSrc(l));let p=((i=o.getAttribute("title"))==null?void 0:i.trim())||"",h=createEl("figure",{cls:"image-with-caption"});if((r=o.parentNode)==null||r.insertBefore(h,o),h.appendChild(o),p){let g=h.createEl("div",{cls:"image-caption-row"});g.createEl("div",{cls:"triangle"}),g.createEl("figcaption",{cls:"image-caption",text:p})}}return t}postprocess(t){let e=(0,_t.sanitizeHTMLToDom)(t),n=createEl("div");return n.appendChild(e),this.processImage(n),Promise.resolve(Te(n))}markedExtension(){return{renderer:{image:t=>{let e=this.resolveImageSrc(t.href||""),n=t.text?`alt="${t.text}"`:'alt=""',i=t.title?` title="${t.title}"`:"";return`<img src="${e}" ${n}${i} />`}},extensions:[]}}}});var En,mc,wo,xo=y(()=>{En={header:{start:["%%hh%%","%%hh%"],end:["%%/hh%%","%%/hh%"]},footer:{start:["%%tt%%","%%tt%"],end:["%%/tt%%","%%/tt%"]}},mc=d=>d.trim().toLowerCase(),wo=d=>d&&d.split(/\r?\n/).filter(n=>{let i=mc(n);return![...En.header.start,...En.header.end,...En.footer.start,...En.footer.end].includes(i)}).join(`
`)});var ko={};at(ko,{WechatRender:()=>et});var yo,fc,vc,Qe,et,bi=y(()=>{an();yo=require("obsidian");Ee();Tt();Ka();Qa();eo();io();ao();co();po();ho();uo();go();vo();bo();It();xo();kt();fc={gfm:!0,breaks:!0},vc=d=>{let t=d.split(/\r?\n/),e=r=>/^[\t ]*([-*_])\1\1+[\t ]*$/.test(r),n=r=>{let a=r.trim();return a?/^!\[\[.+\]\]$/.test(a)?!0:/^!\[[^\]]*]\([^)]+\)$/.test(a):!1},i=[];for(let r=0;r<t.length;r+=1){let a=t[r];e(a)&&r>0&&n(t[r-1])&&i.length&&i[i.length-1].trim()!==""&&i.push(""),i.push(a)}return i.join(`
`)},Qe=class{constructor(t,e){this.extensions=[];this.delayParse=t=>new Promise((e,n)=>{setTimeout(()=>{this.plugin.app.vault.adapter.read(t).then(i=>this.parse(i)).then(i=>this.postprocess(i)).then(e).catch(i=>{let r=i instanceof Error?i:new Error(String(i));n(r)})},100)});this.plugin=t,this.previewRender=e,this.client=Me.getInstance(t),this.marked=new je,this.marked.use(fc),this.marked.use({renderer:{list(n){let i="";if(n.items)for(let o of n.items)i+=this.listitem(o);let r=n.ordered?"ol":"ul",a=n.ordered&&n.start!==1?' start="'+n.start+'"':"";return"<"+r+a+' class="list-paddingleft-1">'+i+"</"+r+">"},listitem(n){return`<li><section>${n.tokens?this.parser.parse(n.tokens):n.text||""}</section></li>`}}}),this.useExtensions()}static getInstance(t,e){return Qe.instance||(Qe.instance=new Qe(t,e)),Qe.instance}static resetInstance(){Qe.instance=null}addExtension(t){this.extensions.push(t),this.marked.use(t.markedExtension())}useExtensions(){this.addExtension(new Sn(this.plugin,this.previewRender,this.marked)),this.addExtension(new wn(this.plugin,this.previewRender,this.marked)),this.addExtension(new Ft(this.plugin,this.previewRender,this.marked)),this.addExtension(new vn(this.plugin,this.previewRender,this.marked)),this.addExtension(new bn(this.plugin,this.previewRender,this.marked)),this.addExtension(new xn(this.plugin,this.previewRender,this.marked)),this.addExtension(new yn(this.plugin,this.previewRender,this.marked)),this.addExtension(new mn(this.plugin,this.previewRender,this.marked)),this.addExtension(new kn(this.plugin,this.previewRender,this.marked)),this.addExtension(new Cn(this.plugin,this.previewRender,this.marked)),this.addExtension(new Pn(this.plugin,this.previewRender,this.marked)),this.addExtension(new Tn(this.plugin,this.previewRender,this.marked))}async replaceInternalLinks(t,e){let n=new Map,i=c=>c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),r=async c=>{var p;if(n.has(c))return(p=n.get(c))!=null?p:null;try{let h=await this.plugin.app.vault.adapter.read(c),{data:g}=Be(h);return n.set(c,g!=null?g:null),g!=null?g:null}catch(h){return n.set(c,null),null}},a=async c=>{var U,ne;let p=c.slice(2,-2),[h,g]=p.split("|",2),m=(h!=null?h:"").trim(),f=(g!=null?g:m).trim(),v=m.split("#")[0].trim();if(!v)return f||c;let A=this.plugin.app.metadataCache.getFirstLinkpathDest(v,e);if(!A)return f||v;let k=(ne=(U=this.plugin.app.metadataCache.getFileCache(A))==null?void 0:U.frontmatter)!=null?ne:null;k||(k=await r(A.path));let C=Aa(k),P=f||A.basename||v;if(!C)return P;let K=i(C),le=i(P);return`<a data-linktype="2" data-link="${K}" href="${K}">${le}</a>`},o=t.split(/\r?\n/),s=!1,l=[];for(let c of o){if(/^\s*```/.test(c)){s=!s,l.push(c);continue}if(s){l.push(c);continue}let p=/!\[\[[^\]]+\]\]|\[\[[^\]]+\]\]/g,h=0,g="",m;for(;(m=p.exec(c))!==null;){let f=m[0];g+=c.slice(h,m.index),f.startsWith("![[")?g+=f:g+=await a(f),h=m.index+f.length}g+=c.slice(h),l.push(g)}return l.join(`
`)}async parse(t,e){let{content:n}=Be(t),i=wo(n),r=vc(i),a=e?await this.replaceInternalLinks(r,e):r;for(let o of this.extensions)await o.prepare();return await this.marked.parse(a)}async postprocess(t){let e=t;for(let n of this.extensions)e=await n.postprocess(e);return e=this.removeEmptyListItems(e),e}removeEmptyListItems(t){let e=document.createElement("div");return e.appendChild((0,yo.sanitizeHTMLToDom)(t)),e.querySelectorAll("ol li, ul li").forEach(n=>{let i=n.querySelector("img, video, figure"),r=Te(n).replace(/<br\s*\/?>/gi,"").replace(/&nbsp;/gi,"").replace(/\u00A0/g,"").replace(/<span[^>]*>\s*<\/span>/gi,"").replace(/<section[^>]*>\s*<\/section>/gi,"").replace(/<div[^>]*>\s*<\/div>/gi,"").replace(/[\s\u200B-\u200D]+/g,"").trim();!i&&r===""&&n.remove()}),Te(e)}async parseNote(t){let e=await this.plugin.app.vault.adapter.read(t),n=await this.parse(e,t);return n=await this.postprocess(n),n}},et=Qe;et.instance=null});var G,Mn,wi,So=y(()=>{G=require("obsidian");ut();pn();Pt();Tt();de();Wn();It();kt();Mn=class{constructor(t,e){this.coverImageRef=null;this.coverImageWrap=null;this.coverImageEl=null;this.coverNaturalWidth=0;this.coverNaturalHeight=0;this.coverTransform={scale:1,offsetX:0,offsetY:0};this.coverResizeObserver=null;this.coverFrontmatterKey=se.cover;this.coverVaultPrefix="vault:";this.coverImageExtensions=["png","jpg","jpeg","gif","webp","bmp","svg","tiff"];this.plugin=t,this.localDraftmanager=$e.getInstance(t),this.BuildUI(e),this.coverResizeDebounced=(0,G.debounce)(()=>this.handleCoverFrameResize(),80),typeof ResizeObserver!="undefined"&&(this.coverResizeObserver=new ResizeObserver(()=>{this.coverResizeDebounced()}),this.coverResizeObserver.observe(this.coverFrame)),this.plugin.messageService.registerListener("wechat-account-changed",()=>{this.updateLocalDraft()}),this.plugin.messageService.registerListener("active-file-changed",()=>{this.updateLocalDraft()}),this.plugin.messageService.registerListener("set-draft-cover-image",n=>{this.coverImageRef=n,this.cover_image=this.resolveCoverUrl(n),this.resetCoverCropState(this.coverImageRef),this.setCoverImage(this.cover_image),this.saveCoverToFrontmatter(this.coverImageRef),this.activeLocalDraft&&(this.activeLocalDraft.thumb_media_id=void 0,this.localDraftmanager.setDraft(this.activeLocalDraft))}),this.plugin.messageService.registerListener("set-image-as-cover",n=>{this.coverImageRef=n.url,this.cover_image=this.resolveCoverUrl(n.url),this.resetCoverCropState(this.coverImageRef),this.setCoverImage(this.cover_image),this.saveCoverToFrontmatter(this.coverImageRef),this.activeLocalDraft&&(this.activeLocalDraft.thumb_media_id=n.media_id,this.localDraftmanager.setDraft(this.activeLocalDraft))}),this.updateLocalDraft()}updateDraftDraftId(t){this.activeLocalDraft!==void 0&&(this.activeLocalDraft.last_draft_id=t)}resetCoverTransform(){this.coverTransform={scale:1,offsetX:0,offsetY:0}}async resetCoverCropState(t){this.activeLocalDraft&&(delete this.activeLocalDraft.cover_crop_scale,delete this.activeLocalDraft.cover_crop_offset_x,delete this.activeLocalDraft.cover_crop_offset_y,delete this.activeLocalDraft.pic_crop_235_1,delete this.activeLocalDraft.pic_crop_1_1,t!==void 0?this.activeLocalDraft.cover_crop_ref=t||void 0:delete this.activeLocalDraft.cover_crop_ref,await this.localDraftmanager.setDraft(this.activeLocalDraft))}restoreCoverTransform(){this.resetCoverTransform()}applyCoverTransform(t=!1){!this.coverImageEl||!this.coverImageWrap||(this.coverImageWrap.setCssProps({left:"0",top:"0",width:"100%",height:"100%",transform:"none"}),this.coverImageEl.setCssProps({width:"100%",height:"100%","object-fit":"cover"}))}handleCoverFrameResize(){this.coverImageEl&&this.applyCoverTransform(!1)}onNoteRename(t){let e=this.plugin.app.workspace.getActiveFile();e===void 0||t!==e||this.activeLocalDraft!==void 0&&(this.activeLocalDraft.notePath=t.path,$e.getInstance(this.plugin).setDraft(this.activeLocalDraft))}getActiveLocalDraft(){return this.activeLocalDraft}getRootEl(){return this.rootEl}BuildUI(t){this.rootEl=t.createDiv({cls:"one2mp-meta-card"});let e=this.rootEl.createDiv({cls:"one2mp-cover-container"});e.createDiv({cls:"one2mp-cover-hint",text:u("views.article-header.cover-image-description")}),this.coverFrame=this.createCoverFrame(e),G.Platform.isMobile&&e.createDiv({cls:"one2mp-cover-mobile-action"}).createEl("button",{cls:"one2mp-cover-mobile-button",text:u("views.article-header.cover-image-mobile-button")}).addEventListener("click",()=>{this.openMobileCoverModal()});let n=this.rootEl.createDiv({cls:"one2mp-digest-container"});this.digestInput=new G.TextAreaComponent(n),this.digestInput.setPlaceholder(u("views.article-header.digest-text")),this.digestInput.inputEl.rows=4,this.digestInput.inputEl.addClass("one2mp-digest-input"),this.digestInput.onChange(i=>{let r=this.activeLocalDraft;r&&(r.digest=i,(async()=>(await this.localDraftmanager.setDraft(r),await this.saveDigestToFrontmatter(i)))())})}async saveDigestToFrontmatter(t){let e=this.getActiveMarkdownFile();e&&await this.plugin.app.fileManager.processFrontMatter(e,n=>{n[se.digest]=t,n[re.digest[0]]&&re.digest[0]!==se.digest&&delete n[re.digest[0]]})}getActiveMarkdownFile(){let t=this.plugin.app.workspace.getActiveFile();return!t||t.extension!=="md"&&t.extension!=="markdown"?null:t}getCoverFromFrontmatter(){var n,i;let t=this.getActiveMarkdownFile();if(!t)return null;let e=(i=(n=this.plugin.app.metadataCache.getFileCache(t))==null?void 0:n.frontmatter)!=null?i:null;return Xe(e)}getVaultRelativePathFromAbsolute(t){let e=this.plugin.app.vault.adapter;if(!(e instanceof G.FileSystemAdapter))return null;let n=e.getBasePath();if(!t.startsWith(n))return null;let i=t.slice(n.length);return(i.startsWith("/")||i.startsWith("\\"))&&(i=i.slice(1)),i.replace(/\\/g,"/")}getActiveRootFolder(){let t=this.getActiveMarkdownFile();if(!t)return null;let e=t.path.split("/");return e.length<=1?null:e[0]||null}getVaultPathCandidates(t){let e=t.replace(/^\/+/,""),n=[e],i=this.getActiveRootFolder();return i&&!e.startsWith(`${i}/`)&&n.push(`${i}/${e}`),n}resolveCoverUrl(t){if(!t||!t.trim())return null;let e=t.trim();if(e.startsWith(this.coverVaultPrefix)){let i=e.slice(this.coverVaultPrefix.length);for(let r of this.getVaultPathCandidates(i)){let a=this.plugin.app.vault.getAbstractFileByPath(r);if(a instanceof G.TFile)return this.plugin.app.vault.getResourcePath(a)}return null}if(e.startsWith("obsidian://")){let r=new He(this.plugin.app).parseObsidianUrl(e);if(r){let a=this.plugin.app.vault.getAbstractFileByPath(r);if(a instanceof G.TFile)return this.plugin.app.vault.getResourcePath(a)}}let n=this.plugin.app.vault.getAbstractFileByPath(e);return n instanceof G.TFile?this.plugin.app.vault.getResourcePath(n):e}getCoverFileFromRef(t){if(!t||!t.trim())return null;let e=t.trim();if(e.startsWith(this.coverVaultPrefix)){let i=e.slice(this.coverVaultPrefix.length);for(let r of this.getVaultPathCandidates(i)){let a=this.plugin.app.vault.getAbstractFileByPath(r);if(a instanceof G.TFile)return a}return null}if(e.startsWith("obsidian://")){let r=new He(this.plugin.app).parseObsidianUrl(e);if(r){let a=this.plugin.app.vault.getAbstractFileByPath(r);return a instanceof G.TFile?a:null}}let n=this.plugin.app.vault.getAbstractFileByPath(e);return n instanceof G.TFile?n:null}async saveCoverToFrontmatter(t){let e=this.getActiveMarkdownFile();e&&await this.plugin.app.fileManager.processFrontMatter(e,n=>{if(t&&t.trim()!==""){n[this.coverFrontmatterKey]=t;for(let i of re.cover)i!==this.coverFrontmatterKey&&delete n[i]}else for(let i of re.cover)delete n[i]})}createCoverFrame(t){let e=t.createDiv({cls:"cover-frame",attr:{droppable:!0}});return e.ondragenter=n=>{n.preventDefault(),e.addClass("image-on-dragover")},e.ondragleave=n=>{n.preventDefault(),e.removeClass("image-on-dragover")},e.ondragover=n=>{n.preventDefault()},e.addEventListener("drop",n=>{this.handleCoverDrop(n,e)}),e}async handleCoverDrop(t,e){var r,a,o,s,l;t.preventDefault();let n=t.dataTransfer,i=(a=(r=n==null?void 0:n.getData("text/uri-list"))==null?void 0:r.trim())!=null?a:"";if(i||(i=(s=(o=n==null?void 0:n.getData("text/plain"))==null?void 0:o.trim())!=null?s:""),i.includes(`
`)&&(i=(l=i.split(/\r?\n/).map(p=>p.trim()).filter(p=>p&&!p.startsWith("#"))[0])!=null?l:""),this.activeLocalDraft||await this.updateLocalDraft(),i){let c=null,p=null;if(i.startsWith("obsidian://")){let g=new He(this.plugin.app).parseObsidianUrl(i);g&&(c=`${this.coverVaultPrefix}${g}`,p=this.resolveCoverUrl(c))}else if(i.startsWith("http")||i.startsWith("https")){if(c=i,p=i,this.activeLocalDraft){let h=await this.getCoverImageMediaId(i);h?(e.setAttr("data-media_id",h),this.activeLocalDraft.thumb_media_id=h):(e.removeAttribute("data-media_id"),this.activeLocalDraft.thumb_media_id=void 0)}}else if(i.startsWith("file://")){let h=decodeURIComponent(i.replace("file://","")),g=this.getVaultRelativePathFromAbsolute(h);g?(c=`${this.coverVaultPrefix}${g}`,p=this.resolveCoverUrl(c)):G.Platform.isMobile?(new G.Notice(u("views.article-header.cover-file-not-supported")),c=null,p=""):(c=i,p=i)}else this.plugin.app.vault.getAbstractFileByPath(i)instanceof G.TFile?(c=`${this.coverVaultPrefix}${i}`,p=this.resolveCoverUrl(c)):(c=null,p="",this.setCoverImageXY());this.activeLocalDraft!==void 0&&(this.activeLocalDraft.cover_image_url=c||"",await this.localDraftmanager.setDraft(this.activeLocalDraft)),this.coverImageRef=c,this.cover_image=p,await this.resetCoverCropState(c),await this.saveCoverToFrontmatter(this.coverImageRef),this.setCoverImage(this.cover_image||"")}e.removeClass("image-on-dragover")}openMobileCoverModal(){new wi(this.plugin,this.coverImageExtensions,async t=>{let{filePath:e,url:n}=t,i=null;e?i=`${this.coverVaultPrefix}${e}`:n&&(i=n),await this.applyCoverRef(i)}).open()}async applyCoverRef(t){let e=t?this.resolveCoverUrl(t):"";this.activeLocalDraft&&(this.activeLocalDraft.cover_image_url=t||"",this.activeLocalDraft.thumb_media_id=void 0,await this.localDraftmanager.setDraft(this.activeLocalDraft)),this.coverImageRef=t,this.cover_image=e,await this.resetCoverCropState(t),await this.saveCoverToFrontmatter(this.coverImageRef),this.setCoverImage(this.cover_image||"")}setCoverImage(t){var a,o;for(;this.coverFrame.firstChild;)this.coverFrame.firstChild.remove();if(this.coverImageEl=null,this.coverImageWrap=null,this.coverNaturalWidth=0,this.coverNaturalHeight=0,!t){(a=this.coverFrame.parentElement)==null||a.removeClass("has-image");return}(o=this.coverFrame.parentElement)==null||o.addClass("has-image");let e=new Image;e.decoding="async",e.loading="lazy";let n=document.createElement("div");n.className="one2mp-cover-image-wrap",e.className="one2mp-cover-image",n.appendChild(e),this.coverFrame.appendChild(n),this.coverImageWrap=n,this.coverImageEl=e;let i=!1,r=()=>{i||(i=!0,this.coverNaturalWidth=e.naturalWidth||e.width,this.coverNaturalHeight=e.naturalHeight||e.height,this.resetCoverTransform(),this.restoreCoverTransform(),this.applyCoverTransform(!1))};e.onload=r,e.src=t,e.complete&&e.naturalWidth&&r()}resetImage(){this.setCoverImageXY(0,0)}async checkCoverImage(){if(await this.syncDraftFromFrontmatter(),this.activeLocalDraft!==void 0)if(this.activeLocalDraft.thumb_media_id===void 0||!this.activeLocalDraft.thumb_media_id){let t=this.coverImageRef||this.cover_image;if(t){let e=await this.getCoverImageMediaId(t,!0);return this.activeLocalDraft.thumb_media_id=e,!0}}else return!0;return!1}async getCoverImageMediaId(t,e=!1){let n;if(e){let i,r=this.getCoverFileFromRef(t);if(r){let o=await this.plugin.app.vault.readBinary(r);i=new Blob([o])}else{let o=this.resolveCoverUrl(t);i=await Ct(o||t,this.plugin.app)}if(i===void 0||!i)return;let a=await Me.getInstance(this.plugin).uploadMaterial(i,"banner-cover.png","image");if(a){let{errcode:o,media_id:s}=a;if(o!==0){new G.Notice(u("views.article-header.upload-cover-image-error"));return}else n=s}}return n}setCoverImageXY(t=0,e=0){if(!this.coverImageEl){this.setCoverImage(this.cover_image);return}this.applyCoverTransform(!1)}getFrontmatter(){var e,n;let t=this.getActiveMarkdownFile();return t&&(n=(e=this.plugin.app.metadataCache.getFileCache(t))==null?void 0:e.frontmatter)!=null?n:null}async migrateFrontmatterKeys(){let t=this.getActiveMarkdownFile();if(!t)return;let e=this.getFrontmatter();if(!e)return;let n=[{canonical:se.title,aliases:re.title},{canonical:se.author,aliases:re.author},{canonical:se.digest,aliases:re.digest},{canonical:se.sourceUrl,aliases:re.sourceUrl},{canonical:se.cover,aliases:re.cover},{canonical:se.openComment,aliases:re.openComment},{canonical:se.onlyFans,aliases:re.onlyFans}];n.some(r=>r.aliases.some(a=>a!==r.canonical&&e[a]!==void 0))&&await this.plugin.app.fileManager.processFrontMatter(t,r=>{for(let a of n)if(r[a.canonical]===void 0){for(let o of a.aliases)if(o!==a.canonical&&r[o]!==void 0){r[a.canonical]=r[o],delete r[o];break}}else for(let o of a.aliases)o!==a.canonical&&r[o]!==void 0&&delete r[o]})}async syncDraftFromFrontmatter(){if(!this.activeLocalDraft)return;let t=this.getFrontmatter(),e=this.getActiveMarkdownFile(),n=ft(t,re.title)||(e==null?void 0:e.basename)||this.activeLocalDraft.title||"",i=ft(t,re.author),r=ft(t,re.digest),a=ft(t,re.sourceUrl),o=ii(t,re.openComment),s=ii(t,re.onlyFans);this.activeLocalDraft.title=n,this.activeLocalDraft.author=i,this.activeLocalDraft.digest=r,this.digestInput&&this.digestInput.setValue(r||""),this.activeLocalDraft.content_source_url=a,o!==void 0?this.activeLocalDraft.need_open_comment=o:this.activeLocalDraft.need_open_comment===void 0&&(this.activeLocalDraft.need_open_comment=1),s!==void 0?this.activeLocalDraft.only_fans_can_comment=s:this.activeLocalDraft.only_fans_can_comment===void 0&&(this.activeLocalDraft.only_fans_can_comment=0),await this.localDraftmanager.setDraft(this.activeLocalDraft),this.plugin.messageService.sendMessage("draft-title-updated",n)}async updateLocalDraft(){return this.activeLocalDraft=await this.localDraftmanager.getDrafOfActiveNote(),await this.updateHeaderProporties(),!0}async updateHeaderProporties(){await this.migrateFrontmatterKeys();let e=this.getCoverFromFrontmatter();if(!e){let a=this.getActiveMarkdownFile();if(a){let o=await this.plugin.app.vault.read(a),s=Be(o),l=Xe(s.data);l&&(e=l)}}this.activeLocalDraft!==void 0&&(await this.syncDraftFromFrontmatter(),!e&&this.activeLocalDraft.cover_image_url&&(e=this.activeLocalDraft.cover_image_url),this.activeLocalDraft.cover_image_url=e||"",this.activeLocalDraft.cover_crop_ref!==(e||"")&&await this.resetCoverCropState(e||void 0),await this.localDraftmanager.setDraft(this.activeLocalDraft));let n=e||"",i=this.coverImageRef||"",r=n!==i;this.coverImageRef=n,this.cover_image=this.resolveCoverUrl(this.coverImageRef),r||!this.coverImageEl?this.setCoverImage(this.cover_image):this.setCoverImageXY()}},wi=class extends G.Modal{constructor(e,n,i){super(e.app);this.plugin=e;this.imageExtensions=n;this.onSubmit=i}onOpen(){let{contentEl:e}=this;e.empty(),e.createEl("h3",{text:u("views.article-header.cover-image-mobile-title")}),new G.Setting(e).setName(u("views.article-header.cover-image-mobile-vault")).setDesc(u("views.article-header.cover-image-mobile-vault-desc")).addText(a=>{this.fileInput=a,this.fileInput.setPlaceholder(u("views.article-header.cover-image-mobile-vault-placeholder")),new pt(this.plugin.app,this.fileInput.inputEl,this.imageExtensions)}),new G.Setting(e).setName(u("views.article-header.cover-image-mobile-url")).setDesc(u("views.article-header.cover-image-mobile-url-desc")).addText(a=>{this.urlInput=a,this.urlInput.setPlaceholder("https://")});let r=e.createDiv("modal-button-container");r.createEl("button",{text:u("modals.confirm")}).addEventListener("click",()=>{var l,c;let a=(l=this.fileInput)==null?void 0:l.getValue().trim(),o=(c=this.urlInput)==null?void 0:c.getValue().trim();if(!a&&!o){new G.Notice(u("views.article-header.cover-image-mobile-required"));return}let s=null;if(a){let p=this.plugin.app.vault.getAbstractFileByPath(a);if(!(p instanceof G.TFile)){new G.Notice(u("views.article-header.cover-image-mobile-invalid"));return}s=p.path}this.onSubmit({filePath:s,url:o||null}),this.close()}),r.createEl("button",{text:u("modals.cancel")}).addEventListener("click",()=>{this.close()})}onClose(){this.contentEl.empty()}}});var pe,An,Co=y(()=>{pe=require("obsidian");de();ut();An=class extends pe.Modal{constructor(e,n){super(e);this.plugin=n,this.updateCurrentAccount()}updateCurrentAccount(){let e=this.plugin.settings.selectedMPAccount;e&&(this.account=this.plugin.getMPAccountByName(e))}onOpen(){let{contentEl:e}=this;if(e.empty(),e.addClass("one2mp-publish-modal"),e.createEl("h2",{text:u("publish-config.title")}),!this.account){new pe.Notice(u("wechat-api.select-an-wechat-mp-account-first")),this.close();return}this.renderMPCardSection(e),this.renderOtherSettings(e)}renderMPCardSection(e){let n=e.createEl("details",{cls:"one2mp-config-section"});n.open=!0,n.createEl("summary",{text:u("publish-config.mp-card-settings")});let i=n.createDiv({cls:"one2mp-config-content"}),r=i.createDiv({cls:"one2mp-card-preview"});this.renderCardPreview(r);let a=i.createDiv({cls:"one2mp-card-parser"});a.createEl("p",{text:u("publish-config.paste-html-guide"),cls:"setting-item-description"});let o=new pe.TextAreaComponent(a);o.setPlaceholder("<mp-common-profile ... >"),o.inputEl.rows=3,o.inputEl.setCssProps({width:"100%"});let l=a.createDiv({cls:"one2mp-parser-actions"}).createEl("button",{text:u("publish-config.parse-and-save")});l.onclick=()=>{let h=o.getValue();this.parseAndSaveCard(h)?(o.setValue(""),this.renderCardPreview(r),new pe.Notice(u("publish-config.card-updated"))):new pe.Notice(u("publish-config.parse-failed"))};let c=i.createEl("details",{cls:"one2mp-manual-edit"});c.createEl("summary",{text:u("publish-config.manual-edit")});let p=c.createDiv();this.renderManualFields(p,r)}renderCardPreview(e){e.empty();let n=this.plugin.settings.defaultMpcard;if(n&&n.includes("```mpcard")){let i=n.replace(/```mpcard|```/g,"").trim().split(`
`),r={};i.forEach(l=>{let[c,...p]=l.split(":");c&&p&&(r[c.trim()]=p.join(":").trim())});let a=e.createDiv({cls:"one2mp-mpcard-wrapper"});a.setCssProps({"max-width":"100%"});let o=a.createDiv({cls:"one2mp-mpcard-content"});if(r.headimg){let l=o.createEl("img",{cls:"one2mp-mpcard-headimg"});l.src=r.headimg}let s=o.createDiv({cls:"one2mp-mpcard-info"});s.createDiv({cls:"one2mp-mpcard-nickname",text:r.nickname||"No Nickname"}),s.createDiv({cls:"one2mp-mpcard-signature",text:r.signature||"No Signature"})}else e.createDiv({text:u("publish-config.mpcard-empty"),cls:"setting-item-description"})}parseAndSaveCard(e){let n=e.match(/data-nickname="([^"]*)"/),i=e.match(/data-headimg="([^"]*)"/),r=e.match(/data-signature="([^"]*)"/),a=e.match(/data-id="([^"]*)"/);return!n&&!i?!1:(n&&(this.plugin.settings.defaultMpcardNickname=n[1]),i&&(this.plugin.settings.defaultMpcardHeadimg=i[1]),r&&(this.plugin.settings.defaultMpcardSignature=r[1]),a&&(this.plugin.settings.defaultMpcardId=a[1]),this.saveSettings(),!0)}saveSettings(){var o,s,l,c;let e=[],n=(o=this.plugin.settings.defaultMpcardId)==null?void 0:o.trim(),i=(s=this.plugin.settings.defaultMpcardHeadimg)==null?void 0:s.trim(),r=(l=this.plugin.settings.defaultMpcardNickname)==null?void 0:l.trim(),a=(c=this.plugin.settings.defaultMpcardSignature)==null?void 0:c.trim();n&&e.push(`id: ${n}`),i&&e.push(`headimg: ${i}`),r&&e.push(`nickname: ${r}`),a&&e.push(`signature: ${a}`),e.length>0?this.plugin.settings.defaultMpcard=["```mpcard",...e,"```"].join(`
`):this.plugin.settings.defaultMpcard="",this.plugin.saveSettings()}renderManualFields(e,n){new pe.Setting(e).setName(u("settings.default-mpcard-nickname")).setClass("one2mp-setting-wide").addText(i=>i.setValue(this.plugin.settings.defaultMpcardNickname||"").onChange(r=>{this.plugin.settings.defaultMpcardNickname=r,this.saveSettings(),this.renderCardPreview(n)})),new pe.Setting(e).setName(u("settings.default-mpcard-headimg")).setClass("one2mp-setting-wide").addText(i=>i.setValue(this.plugin.settings.defaultMpcardHeadimg||"").onChange(r=>{this.plugin.settings.defaultMpcardHeadimg=r,this.saveSettings(),this.renderCardPreview(n)})),new pe.Setting(e).setName(u("settings.default-mpcard-signature")).setClass("one2mp-setting-wide").addTextArea(i=>i.setValue(this.plugin.settings.defaultMpcardSignature||"").setPlaceholder("...").onChange(r=>{this.plugin.settings.defaultMpcardSignature=r,this.saveSettings(),this.renderCardPreview(n)})),e.findAll("textarea").forEach(i=>i.rows=4),new pe.Setting(e).setName(u("settings.default-mpcard-biz-id")).setDesc(u("settings.default-mpcard-biz-id-desc")).setClass("one2mp-setting-wide").addText(i=>i.setValue(this.plugin.settings.defaultMpcardId||"").onChange(r=>{this.plugin.settings.defaultMpcardId=r,this.saveSettings()}))}renderOtherSettings(e){let n=e.createEl("details",{cls:"one2mp-config-section"});n.createEl("summary",{text:u("publish-config.other-settings")});let i=n.createDiv({cls:"one2mp-config-content"});new pe.Setting(i).setName(u("settings.draft-previewer-wechat-id")).setDesc(u("settings.draft-only-visible-for-the-wechat-user-o")).addText(a=>a.setValue(this.plugin.settings.previewer_wxname||"").onChange(o=>{this.plugin.settings.previewer_wxname=o,this.plugin.saveSettings()})).addButton(a=>{a.setButtonText(u("views.preview-draft")).setIcon("eye").setTooltip(u("settings.preview-draft-tooltip")).onClick(()=>{(async()=>{var c;if(!((c=this.plugin.settings.previewer_wxname)!=null&&c.trim())){new pe.Notice(u("views.previewer.preview-draft-missing-wxid"));return}let o=await $e.getInstance(this.plugin).getDrafOfActiveNote(),s=o==null?void 0:o.last_draft_id;if(!s){new pe.Notice(u("views.previewer.preview-draft-missing-id"));return}await this.plugin.wechatClient.senfForPreview(s)&&new pe.Notice(u("views.previewer.preview-draft-sent"))})()})})}onClose(){let{contentEl:e}=this;e.empty()}}});var To={};at(To,{ThemeSelector:()=>xi});var Po,xi,Eo=y(()=>{Po=require("obsidian");St();de();xi=class{constructor(t){this.plugin=t,this._themeManager=ht.getInstance(t),this.plugin.messageService.registerListener("custom-theme-folder-changed",()=>{this.updateThemeOptions()})}async dropdown(t){this._themeDropdown=t,await this.updateThemeOptions(),t.onChange(e=>{this.plugin.settings.custom_theme=e,this.plugin.saveSettings(),this.plugin.messageService.sendMessage("custom-theme-changed",e)})}async updateThemeOptions(){let t=await this._themeManager.loadThemes();this._themeDropdown.selectEl.length=0,this._themeDropdown.addOption("--default--",u("views.theme-manager.default-theme")),t.forEach(e=>{this._themeDropdown.addOption(e.path,e.name)}),this.plugin.settings.custom_theme===void 0||!this.plugin.settings.custom_theme?this._themeDropdown.setValue("--default--"):this._themeDropdown.setValue(this.plugin.settings.custom_theme)}onThemeChange(t){t instanceof Po.TFile&&t.extension==="md"&&t.path.startsWith(this.plugin.settings.css_styles_folder)&&this.updateThemeOptions()}startWatchThemes(){this.plugin.registerEvent(this.plugin.app.vault.on("rename",t=>{this.onThemeChange(t)})),this.plugin.registerEvent(this.plugin.app.vault.on("modify",t=>{this.onThemeChange(t)})),this.plugin.registerEvent(this.plugin.app.vault.on("create",t=>{this.onThemeChange(t)})),this.plugin.registerEvent(this.plugin.app.vault.on("delete",t=>{this.onThemeChange(t)}))}}});var Mo={};at(Mo,{PreviewPanel:()=>ki,VIEW_TYPE_ONE2MP_PREVIEW:()=>yi});var _,yi,ki,Ao=y(()=>{_=require("obsidian");de();Ee();Dt();Fa();_a();Va();ci();bi();_n();Tt();So();Co();pn();yi="one2mp-article-preview",ki=class extends _.ItemView{constructor(e,n){super(e);this.markdownView=null;this.listeners=[];this.messageUnsubscribes=[];this.themeSelector=null;this.themeManagerModule=null;this.allowRender=!1;this.initialRenderScheduled=!1;this.currentPlatform="wechat";this.platformTabs=new Map;this.platformPanels=new Map;this.redbookParser=new hn;this.redbookPreviewEl=null;this.redbookContent="";this.redbookCoverFrame=null;this.redbookCoverImageEl=null;this.redbookCoverRef=null;this.redbookCoverFrontmatterKey="\u5C0F\u7EA2\u4E66\u5C01\u9762\u56FE";this.haloPreviewEl=null;this.haloSiteTextEl=null;this.debouncedRender=(0,_.debounce)(async()=>{this.plugin.settings.realTimeRender&&await this.renderDraft()},1e3);this.debouncedUpdate=(0,_.debounce)(async()=>{this.plugin.settings.realTimeRender&&await this.renderDraft()},1e3);this.debouncedCustomThemeChange=(0,_.debounce)(e=>{this.renderDraft(!0)},2e3);this.articleProperties=new Map;this.editorView=null;this.isActive=!1;this.plugin=n,this.wechatClient=Me.getInstance(this.plugin)}getViewType(){return yi}getDisplayText(){return u("views.previewer.one2mp-previewer")}getIcon(){return"one2mp-logo"}async onOpen(){var e,n;await this.ensureThemeSelector(),this.buildUI(),this.startListen(),this.isActive=!0,this.markdownView=(e=Fe.getInstance(this.plugin).getCurrentMarkdownView())!=null?e:null,this.scheduleInitialRender(),this.messageUnsubscribes.push(this.plugin.messageService.registerListener("draft-title-updated",i=>{this.setPreviewTitle(i)})),(n=this.themeSelector)==null||n.startWatchThemes(),this.messageUnsubscribes.push(this.plugin.messageService.registerListener("custom-theme-changed",i=>{this.debouncedCustomThemeChange(i)})),this.plugin.messageService.sendMessage("active-file-changed",null),await this.loadComponents()}scheduleInitialRender(){if(this.initialRenderScheduled)return;this.initialRenderScheduled=!0;let e=()=>{this.renderDraft(!0)};this.plugin.app.workspace.onLayoutReady(()=>{let n=window.requestIdleCallback;typeof n=="function"?n(e,{timeout:2e3}):setTimeout(e,300)})}async ensureThemeSelector(){if(this.themeSelector)return;let{ThemeSelector:e}=await Promise.resolve().then(()=>(Eo(),To));this.themeSelector=new e(this.plugin)}async getThemeManager(){return this.themeManagerModule||(this.themeManagerModule=await Promise.resolve().then(()=>(St(),Zt))),this.themeManagerModule.ThemeManager}getArticleProperties(){let e=this.plugin.app.workspace.getActiveFile();if((e==null?void 0:e.extension)==="md"||(e==null?void 0:e.extension)==="markdown"){let n=this.app.metadataCache.getCache(e.path),i=n==null?void 0:n.frontmatter;this.articleProperties.clear(),i!=null&&Object.keys(i).forEach(r=>{this.articleProperties.set(r,i[r])})}return this.articleProperties}async setArticleProperties(){let e=this.getCurrentMarkdownFile();if(e&&this.articleProperties.size>0){let n=this.app.vault.getAbstractFileByPath(e);if(!(n instanceof _.TFile))throw new Error(u("views.previewer.file-not-found-path",[e]));await this.app.fileManager.processFrontMatter(n,i=>{this.articleProperties.forEach((r,a)=>{i[a]=r})})}}getCurrentMarkdownFile(){var i,r;let e=this.plugin.app.workspace.getActiveFile(),n=this.plugin.app.workspace.getLeavesOfType("markdown");for(let a of n){let o=a.view;if(((i=o.file)==null?void 0:i.path)===(e==null?void 0:e.path))return(r=o.file)==null?void 0:r.path}return null}buildUI(){let e=this.containerEl.children[1];e.empty(),e.addClass("one2mp-preview-container"),this.buildToolbar(e);let n=e.createDiv({cls:"one2mp-main-scroll-area"}),i=n.createDiv({cls:"one2mp-platform-tabs"});this.buildPlatformTabs(i);let r=n.createDiv({cls:"one2mp-platform-panels"}),a=r.createDiv({cls:"one2mp-platform-panel one2mp-platform-panel-active"});this.platformPanels.set("wechat",a),this.draftHeader=new Mn(this.plugin,a),this.previewTitleEl=a.createDiv({cls:"one2mp-preview-title"}),this.setPreviewTitle(),this.renderDiv=a.createDiv({cls:"render-container"}),this.renderDiv.id="render-div",this.renderPreviewer=a.createDiv({cls:"one2mp-render-preview"}),this.containerDiv=this.renderDiv.createDiv({cls:"one2mp-article"}),this.articleDiv=this.containerDiv.createDiv({cls:"article-div"});let o=r.createDiv({cls:"one2mp-platform-panel"});this.platformPanels.set("redbook",o),this.buildRedbookPanel(o);let s=r.createDiv({cls:"one2mp-platform-panel"});this.platformPanels.set("halo",s),this.buildHaloPanel(s),this.setActivePlatform("wechat")}buildToolbar(e){let n=e.createDiv({cls:"one2mp-preview-toolbar"}),i=n.createDiv({cls:"toolbar-group-left"});this.accountDropdown=new _.DropdownComponent(i),this.updateAccountOptions(),this.accountDropdown.onChange(h=>{this.plugin.settings.selectedMPAccount=h,this.plugin.saveSettings(),this.plugin.messageService.sendMessage("wechat-account-changed",h),new _.Notice(`Switched to: ${h}`)}),n.createDiv({cls:"toolbar-group-center"});let r=n.createDiv({cls:"toolbar-group-right"}),a=r.createDiv({cls:"one2mp-toolbar-actions-group"}),o=new _.DropdownComponent(a);this.themeSelector?this.themeSelector.dropdown(o):(o.addOption("--default--",u("views.theme-manager.default-theme")),o.setDisabled(!0));let s=(h,g,m)=>{let f=a.createEl("button",{cls:"clickable-icon one2mp-toolbar-btn"});return(0,_.setIcon)(f,h),f.setAttribute("aria-label",g),f.onclick=m,f};s("settings",u("views.previewer.publish-config"),()=>{new An(this.app,this.plugin).open()}),s("refresh-cw",u("views.previewer.render-article"),()=>{this.renderDraft(!0)}),s("clipboard-copy",u("views.previewer.copy-article-to-clipboard"),()=>{var g,m;let h=this.getArticleContent();if((g=navigator.clipboard)!=null&&g.write&&window.ClipboardItem){navigator.clipboard.write([new ClipboardItem({"text/html":new Blob([h],{type:"text/html"})})]).then(()=>{new _.Notice(u("views.previewer.article-copied-to-clipboard"))}).catch(f=>{console.warn("\u590D\u5236\u5230\u526A\u8D34\u677F\u5931\u8D25",f)});return}if((m=navigator.clipboard)!=null&&m.writeText){navigator.clipboard.writeText(h).then(()=>{new _.Notice(u("views.previewer.article-copied-to-clipboard"))}).catch(f=>{console.warn("\u590D\u5236\u5230\u526A\u8D34\u677F\u5931\u8D25",f)});return}new _.Notice(u("settings.clipboard-not-supported"))}),s("send-horizontal",u("views.previewer.send-article-to-draft-box"),()=>{(async()=>await this.checkCoverImage()?this.sendArticleToDraftBox():new _.Notice(u("views.previewer.please-set-cover-image")))()});let l=r.createDiv({cls:"one2mp-toolbar-ip"}),c=h=>{if(l.empty(),!h.direct&&!h.proxy){l.setText("IP: ...");return}let g=(m,f)=>{let v=l.createDiv({cls:"one2mp-ip-subrow"});v.createSpan({text:m+": ",cls:"label"});let A=f==="single"?h.direct||h.proxy:f==="direct"?h.direct:h.proxy;v.createSpan({text:A,cls:"value"}),v.title=`\u70B9\u51FB\u5237\u65B0\u5E76\u590D\u5236 ${m} IP`,v.onclick=k=>{k.stopPropagation(),(async()=>{var C;new _.Notice("\u6B63\u5728\u5237\u65B0 IP...");try{let P=await this.plugin.updateIpAddress();c(P);let K=f==="single"?P.direct||P.proxy:f==="direct"?P.direct:P.proxy;K?(C=navigator.clipboard)!=null&&C.writeText?(await navigator.clipboard.writeText(K),new _.Notice(`${m} IP \u5DF2\u5237\u65B0\u5E76\u590D\u5236`)):new _.Notice(u("settings.clipboard-not-supported")):new _.Notice("\u65E0\u6CD5\u83B7\u53D6 IP")}catch(P){new _.Notice("\u5237\u65B0 IP \u5931\u8D25"),console.error(P)}})()}};h.direct===h.proxy||!h.proxy||!h.direct?g("IP","single"):(h.direct&&g("\u76F4\u8FDE","direct"),h.proxy&&g("\u4EE3\u7406","proxy"))},p={};try{p=JSON.parse(this.plugin.settings.ipAddress||"{}")}catch(h){console.debug("Failed to parse cached IP address:",h)}c(p),this.plugin.updateIpAddress().then(h=>{c(h)}).catch(h=>{console.debug("Failed to refresh IP address:",h)})}buildPlatformTabs(e){[{key:"wechat",label:u("views.platform.wechat")},{key:"redbook",label:u("views.platform.redbook")},{key:"halo",label:u("views.platform.halo")}].forEach(i=>{let r=e.createEl("button",{cls:"one2mp-platform-tab"});r.setText(i.label),r.onclick=()=>{this.setActivePlatform(i.key)},this.platformTabs.set(i.key,r)})}setActivePlatform(e){if(this.currentPlatform=e,this.platformTabs.forEach((n,i)=>{n.classList.toggle("one2mp-platform-tab-active",i===e)}),this.platformPanels.forEach((n,i)=>{n.classList.toggle("one2mp-platform-panel-active",i===e)}),e==="wechat"){this.renderDraft(!0);return}if(e==="redbook"){this.renderRedbookPreview();return}e==="halo"&&this.renderHaloPreview()}buildRedbookPanel(e){let n=e.createDiv({cls:"one2mp-redbook-cover"});n.createDiv({cls:"one2mp-redbook-cover-title",text:u("views.redbook.cover-title")}),n.createDiv({cls:"one2mp-redbook-cover-hint",text:u("views.redbook.cover-hint")}),this.redbookCoverFrame=n.createDiv({cls:"one2mp-redbook-cover-frame",attr:{droppable:!0}}),this.redbookCoverFrame.ondragenter=a=>{var o;a.preventDefault(),(o=this.redbookCoverFrame)==null||o.addClass("image-on-dragover")},this.redbookCoverFrame.ondragleave=a=>{var o;a.preventDefault(),(o=this.redbookCoverFrame)==null||o.removeClass("image-on-dragover")},this.redbookCoverFrame.ondragover=a=>{a.preventDefault()},this.redbookCoverFrame.addEventListener("drop",a=>{this.handleRedbookCoverDrop(a)}),this.refreshRedbookCover();let i=e.createDiv({cls:"one2mp-platform-actions"}),r=(a,o)=>{let s=i.createEl("button");return s.setText(a),s.onclick=o,s};r(u("views.redbook.refresh"),()=>{this.renderRedbookPreview()}),r(u("views.redbook.copy"),()=>{this.copyRedbookText()}),r(u("views.redbook.export"),()=>{this.exportRedbookPackage()}),r(u("views.redbook.open"),()=>{this.openUrl("https://creator.xiaohongshu.com/")}),this.redbookPreviewEl=e.createDiv({cls:"one2mp-platform-preview"})}buildHaloPanel(e){let n=e.createDiv({cls:"one2mp-halo-info"});this.haloSiteTextEl=n.createDiv({cls:"one2mp-halo-site"}),this.updateHaloSiteText(),n.createDiv({cls:"one2mp-halo-hint",text:u("views.halo.hint")});let i=e.createDiv({cls:"one2mp-platform-actions"}),r=(a,o)=>{let s=i.createEl("button");return s.setText(a),s.onclick=o,s};r(u("views.halo.publish"),()=>{this.plugin.haloClient.publishActiveNote()}),r(u("views.halo.open-site"),()=>{let a=this.getSelectedHaloSite();if(!a){new _.Notice(u("views.halo.missing-site"));return}this.openUrl(a.url)}),this.haloPreviewEl=e.createDiv({cls:"one2mp-platform-preview one2mp-halo-preview"}),this.renderHaloPreview()}async renderHaloPreview(){if(!this.haloPreviewEl)return;this.haloPreviewEl.empty(),this.updateHaloSiteText();let e=this.getSelectedHaloSite();if(!e){this.haloPreviewEl.createDiv({text:u("views.halo.missing-site")});return}this.haloPreviewEl.createDiv({text:u("views.halo.ready",[e.name||e.url])})}updateHaloSiteText(){if(!this.haloSiteTextEl)return;let e=this.getSelectedHaloSite();if(!e){this.haloSiteTextEl.setText(u("views.halo.missing-site"));return}this.haloSiteTextEl.setText(u("views.halo.current-site",[e.name||e.url]))}getSelectedHaloSite(){var i;let e=this.plugin.settings.haloSites;if(!e||e.length===0)return null;let n=this.plugin.settings.selectedHaloSite;if(n){let r=e.find(a=>a.name===n);if(r)return r}return(i=e[0])!=null?i:null}getActiveMarkdownFile(){let e=this.app.workspace.getActiveFile();return!e||e.extension!=="md"?null:e}async renderRedbookPreview(){if(!this.redbookPreviewEl)return;let e=this.getActiveMarkdownFile();if(this.redbookPreviewEl.empty(),!e){this.redbookContent="",this.redbookPreviewEl.createDiv({text:u("views.redbook.no-active-file")});return}let n=await this.app.vault.cachedRead(e),i=await this.redbookParser.parse(n);this.redbookContent=i.text,this.refreshRedbookCover(),this.redbookPreviewEl.createEl("pre",{cls:"one2mp-redbook-pre"}).setText(i.text||u("views.redbook.empty"))}async copyRedbookText(){var e;if(!this.redbookContent.trim()){new _.Notice(u("views.redbook.empty"));return}if(!((e=navigator.clipboard)!=null&&e.writeText)){new _.Notice(u("settings.clipboard-not-supported"));return}try{await navigator.clipboard.writeText(this.redbookContent),new _.Notice(u("views.redbook.copied"))}catch(n){console.warn("\u590D\u5236\u5C0F\u7EA2\u4E66\u6587\u6848\u5931\u8D25",n)}}async exportRedbookPackage(){let e=this.getActiveMarkdownFile();if(!e){new _.Notice(u("views.redbook.no-active-file"));return}try{await Ra(this.app,e,this.redbookParser)}catch(n){console.error("\u5C0F\u7EA2\u4E66\u7D20\u6750\u5BFC\u51FA\u5931\u8D25",n)}}refreshRedbookCover(){let e=this.getRedbookCoverFromFrontmatter();this.redbookCoverRef=e;let n=this.resolveRedbookCoverUrl(e);this.updateRedbookCoverView(n)}updateRedbookCoverView(e){if(this.redbookCoverFrame){if(this.redbookCoverFrame.empty(),this.redbookCoverImageEl=null,!e){this.redbookCoverFrame.createDiv({cls:"one2mp-redbook-cover-placeholder",text:u("views.redbook.cover-empty")});return}this.redbookCoverImageEl=this.redbookCoverFrame.createEl("img",{cls:"one2mp-redbook-cover-image",attr:{src:e}})}}getRedbookCoverFromFrontmatter(){var r,a;let e=this.getActiveMarkdownFile();if(!e)return null;let n=(a=(r=this.app.metadataCache.getFileCache(e))==null?void 0:r.frontmatter)!=null?a:null;if(!n)return null;let i=[this.redbookCoverFrontmatterKey,"\u5C0F\u7EA2\u4E66\u5C01\u9762","redbook_cover","xhs_cover"];for(let o of i){let s=n[o];if(typeof s=="string"&&s.trim()!=="")return s.trim()}return null}resolveRedbookCoverUrl(e){if(!e||!e.trim())return null;let n=e.trim();if(n.startsWith("http"))return n;let i=n;i.startsWith("vault:")&&(i=i.slice(6));let r=this.app.vault.getAbstractFileByPath(i);return r instanceof _.TFile?this.app.vault.getResourcePath(r):null}async saveRedbookCoverToFrontmatter(e){let n=this.getActiveMarkdownFile();n&&await this.app.fileManager.processFrontMatter(n,i=>{e&&e.trim()?i[this.redbookCoverFrontmatterKey]=e.trim():delete i[this.redbookCoverFrontmatterKey]})}getVaultRelativePathFromAbsolute(e){let n=this.app.vault.adapter;if(!(n instanceof _.FileSystemAdapter))return null;let i=n.getBasePath();if(!e.startsWith(i))return null;let r=e.slice(i.length);return(r.startsWith("/")||r.startsWith("\\"))&&(r=r.slice(1)),r.replace(/\\/g,"/")}async handleRedbookCoverDrop(e){var a,o,s,l,c;if(!this.redbookCoverFrame)return;e.preventDefault(),this.redbookCoverFrame.removeClass("image-on-dragover");let n=e.dataTransfer,i=(o=(a=n==null?void 0:n.getData("text/uri-list"))==null?void 0:a.trim())!=null?o:"";if(i||(i=(l=(s=n==null?void 0:n.getData("text/plain"))==null?void 0:s.trim())!=null?l:""),i.includes(`
`)&&(i=(c=i.split(/\r?\n/).map(h=>h.trim()).filter(h=>h&&!h.startsWith("#"))[0])!=null?c:""),!i)return;let r=null;if(i.startsWith("obsidian://")){let h=new He(this.app).parseObsidianUrl(i);h&&(r=h)}else if(i.startsWith("http"))r=i;else if(i.startsWith("file://")){let p=decodeURIComponent(i.replace("file://",""));r=this.getVaultRelativePathFromAbsolute(p)||i}else this.app.vault.getAbstractFileByPath(i)instanceof _.TFile&&(r=i);await this.saveRedbookCoverToFrontmatter(r),this.redbookCoverRef=r,this.updateRedbookCoverView(this.resolveRedbookCoverUrl(r))}updateAccountOptions(){let e=this.accountDropdown;e.selectEl.empty(),this.plugin.settings.mpAccounts.length===0?e.addOption("",u("modals.publish-config.no-account")):(this.plugin.settings.mpAccounts.forEach(n=>{e.addOption(n.accountName,n.accountName)}),this.plugin.settings.selectedMPAccount&&e.setValue(this.plugin.settings.selectedMPAccount))}setPreviewTitle(e){var r,a;if(!this.previewTitleEl)return;let n=(a=(r=this.app.workspace.getActiveFile())==null?void 0:r.basename)!=null?a:u("views.previewer.article-title"),i=e&&e.trim()?e.trim():n;this.previewTitleEl.setText(i),this.previewTitleEl.setAttr("title",i)}async checkCoverImage(){return this.draftHeader.checkCoverImage()}async sendArticleToDraftBox(){let e=this.articleDiv.firstElementChild;if(e){let i=await this.getThemeManager();i&&await i.getInstance(this.plugin).applyTheme(e)}await Ha(this.articleDiv,this.plugin.wechatClient),await Na(this.articleDiv,this.plugin.wechatClient),await za(this.articleDiv,this.plugin.wechatClient,this.app),await ja(this.articleDiv,this.plugin.wechatClient);let n=await this.wechatClient.sendArticleToDraftBox(this.draftHeader.getActiveLocalDraft(),this.getArticleContent());if(n){this.draftHeader.updateDraftDraftId(n);let i=await this.wechatClient.getDraftById(this.plugin.settings.selectedMPAccount,n);if(i){this.openUrl(i[0].url);let r={media_id:n,content:{news_item:i},update_time:Date.now()};this.plugin.messageService.sendMessage("draft-item-updated",r)}}}getArticleContent(){let e=this.articleDiv.firstElementChild,n=e==null?void 0:e.querySelector("p"),i=n&&window.getComputedStyle(n).color||e&&window.getComputedStyle(e).color||void 0,r=this.articleDiv.cloneNode(!0);return Ba(r,i),Ae.getInstance().restoreCard(Te(r))}onClose(){return this.stopListen(),this.messageUnsubscribes.forEach(e=>e()),this.messageUnsubscribes=[],Promise.resolve()}async parseActiveMarkdown(){var o;this.getArticleProperties();let e=Fe.getInstance(this.plugin).getCurrentMarkdownView()||this.markdownView;if(!e)return u("views.previewer.not-a-markdown-view");this.articleDiv.empty(),this.elementMap=new Map;let n=(o=e.file)!=null?o:this.app.workspace.getActiveFile();if(!n)return"<h1>No active file</h1>";if(n.extension!=="md")return"<h1>Not a markdown file</h1>";await ae.getInstance(this.plugin.app).render(n.path,this.renderPreviewer,this);let i=await et.getInstance(this.plugin,this).parseNote(n.path),r=createEl("section",{cls:"one2mp-article-content one2mp"}),a=(0,_.sanitizeHTMLToDom)(i);r.appendChild(a),this.articleDiv.empty(),this.articleDiv.appendChild(r);for(let[s,l]of this.elementMap.entries()){let c=this.articleDiv.querySelector("#"+s);if(c)if(typeof l=="string"){let p=Fe.getInstance(this.plugin).getFileOfLink(l);if(p){let h=this.plugin.app.vault.getFileByPath(p.path);if(h){let g=await et.getInstance(this.plugin,this).parseNote(h.path);c.empty(),c.appendChild((0,_.sanitizeHTMLToDom)(g))}}}else c.appendChild(l)}}async renderDraft(e=!1){if(e&&(this.allowRender=!0),!this.allowRender||!this.isViewActive())return;if(this.currentPlatform==="redbook"){await this.renderRedbookPreview();return}if(this.currentPlatform==="halo"){await this.renderHaloPreview();return}if(await this.parseActiveMarkdown(),this.articleDiv===null||this.articleDiv.firstChild===null)return;let n=this.articleDiv.firstChild,i=()=>{n.isConnected&&(async()=>{let a=await this.getThemeManager();a&&await a.getInstance(this.plugin).applyTheme(n)})()},r=window.requestIdleCallback;typeof r=="function"?r(i):setTimeout(i,0)}isViewActive(){return this.isActive&&!this.app.workspace.rightSplit.collapsed}startListen(){this.registerEvent(this.plugin.app.vault.on("rename",i=>{this.draftHeader.onNoteRename(i)})),this.registerEvent(this.app.workspace.on("layout-change",()=>{let i=this.app.workspace.getLeavesOfType(yi).length>0;this.isActive=i}));let e=this.app.workspace.on("editor-change",()=>{this.onEditorChange()});this.listeners.push(e);let n=this.app.workspace.on("active-leaf-change",i=>{i&&(i.view.getViewType()==="markdown"?(this.markdownView=i.view,this.lastLeaf=i,this.plugin.messageService.sendMessage("active-file-changed",null),this.debouncedUpdate()):this.isActive=i.view===this)});this.listeners.push(n)}stopListen(){this.listeners.forEach(e=>this.app.workspace.offref(e))}onEditorChange(){this.debouncedRender()}updateElementByID(e,n){let i=this.articleDiv.querySelector("#"+e);if(!i)return;let r=(0,_.sanitizeHTMLToDom)(n);i.empty(),i.appendChild(r)}addElementByID(e,n){typeof n=="string"?this.elementMap.set(e,n):this.elementMap.set(e,n.cloneNode(!0))}async loadComponents(){let e=this,n=async(i,r=new Set)=>{var o,s;if(r.has(i))return;r.add(i);let a=i;if((o=a._children)!=null&&o.length)for(let l of a._children)await n(l,r);try{if(((s=i==null?void 0:i.constructor)==null?void 0:s.name)==="SheetElement"){let c=i.onload();c&&typeof c.then=="function"&&await c}}catch(l){console.error("Error calling onload()",l)}};await n(e)}openUrl(e){if(!e)return;if(typeof window!="undefined"&&typeof window.open=="function"){window.open(e);return}let n=this.app;if(n.openWithDefaultApp){n.openWithDefaultApp(e);return}new _.Notice(u("views.previewer.open-url-not-supported"))}}});var xc={};at(xc,{default:()=>Ln});module.exports=Zo(xc);var ge=require("obsidian");var On=require("obsidian");async function Ci(){let d=async()=>{try{return(await(0,On.requestUrl)("https://api.ipify.org?format=json")).json.ip}catch(i){console.warn("Failed to fetch proxy IP",i);return}},t=async()=>{try{return(await(0,On.requestUrl)("https://myip.ipip.net/json")).json.data.ip}catch(i){console.warn("Failed to fetch direct IP",i);return}},[e,n]=await Promise.all([d(),t()]);return{proxy:e,direct:n}}_n();de();var Ui=require("obsidian");de();var Wt=class extends Ui.Modal{constructor(e,n,i){super(e);this.message=n;this.resolve=i}onOpen(){let{contentEl:e}=this;e.createEl("p",{text:this.message});let n=e.createDiv("modal-button-container");n.createEl("button",{text:u("modals.confirm")}).addEventListener("click",()=>{this.resolve(!0),this.close()}),n.createEl("button",{text:u("modals.cancel")}).addEventListener("click",()=>{this.resolve(!1),this.close()})}onClose(){let{contentEl:e}=this;e.empty()}};var T=require("obsidian");de();var Gt=require("obsidian"),qt=class extends Gt.AbstractInputSuggest{constructor(e,n){super(e,n);this.inputEl=n}getSuggestions(e){return this.app.vault.getAllLoadedFiles().filter(i=>i instanceof Gt.TFolder).filter(i=>i.path.toLowerCase().includes(e.toLowerCase()))}renderSuggestion(e,n){n.setText(e.path)}selectSuggestion(e){this.inputEl.value=e.path,this.inputEl.trigger("input"),this.close()}};Wn();var Yt=class extends T.PluginSettingTab{constructor(e,n){super(e,n);this.plugin=n}display(){let{containerEl:e}=this;e.empty(),e.addClass("one2mp-settings");let n=this.createSettingsSection(e,u("settings.section-wechat"),{open:!0,addTooltip:u("settings.create-new-account"),onAdd:()=>{this.createNewAccount()}});this.createAccountManagement(n);let i=this.createSettingsSection(e,u("settings.section-halo"),{open:!0,addTooltip:u("settings.halo-add-site"),onAdd:()=>{this.createNewHaloSite()}});this.createHaloSettings(i),this.createGeneralSettings(e),this.creatCSSStyleSetting(e),this.createBackupRestore(e)}createSettingsSection(e,n,i){let r=e.createEl("details",{cls:"one2mp-settings-section"});i!=null&&i.open&&(r.open=!0);let a=r.createEl("summary");if(a.createSpan({text:n}),a.addEventListener("click",o=>{o.target.closest("button")||(o.preventDefault(),r.open=!r.open)}),i!=null&&i.onAdd){let o=a.createEl("button",{cls:"clickable-icon one2mp-section-add"});o.setAttr("aria-label",i.addTooltip||""),o.setAttr("title",i.addTooltip||""),o.onclick=s=>{var l;s.preventDefault(),s.stopPropagation(),(l=i.onAdd)==null||l.call(i)},(0,T.setIcon)(o,"plus")}return r.createDiv({cls:"one2mp-settings-section-body"})}createAccountManagement(e){let n=e.createDiv({cls:"one2mp-appid-guide"});n.createEl("span",{text:u("settings.appid-secret-guide")+" ",cls:"setting-item-description"}),n.createEl("a",{href:"https://developers.weixin.qq.com/console/",text:u("settings.appid-secret-guide-link")}).setAttr("target","_blank"),this.plugin.settings.mpAccounts.length===0?e.createDiv({cls:"one2mp-no-account"}).createEl("p",{text:u("settings.select-account")}):this.plugin.settings.mpAccounts.forEach((i,r)=>{this.renderAccountItem(e,i,r)})}renderAccountItem(e,n,i){let a=e.createDiv({cls:"one2mp-account-item"}).createEl("details");i===0&&(a.open=!0);let o=a.createEl("summary");o.setText(n.accountName||u("settings.new-account"));let s=a.createDiv({cls:"one2mp-account-details"});new T.Setting(s).setName(u("settings.account-name")).setDesc(u("settings.account-name-for-your-wechat-official")).setClass("one2mp-setting-wide").addText(c=>c.setValue(n.accountName).onChange(p=>{n.accountName=p,o.setText(p),this.plugin.settings.selectedMPAccount===this.plugin.settings.mpAccounts[i].accountName&&(this.plugin.settings.selectedMPAccount=p),this.plugin.saveSettings()})),new T.Setting(s).setName(u("settings.appid")).setDesc(u("settings.appid-for-your-wechat-official-account")).setClass("one2mp-setting-wide").addText(c=>c.setValue(n.appId).setPlaceholder("wx...").onChange(p=>{n.appId=p.trim(),this.plugin.saveSettings()})),new T.Setting(s).setName(u("settings.app-secret")).setDesc(u("settings.app-secret-for-your-wechat-official")).setClass("one2mp-setting-wide").addText(c=>c.setValue(n.appSecret).setPlaceholder("...").onChange(p=>{let h=p.replace(/\s+/g,"");h!==p&&c.setValue(h),n.appSecret=h,this.plugin.saveSettings()}));let l=new T.Setting(s).setName("");l.addButton(c=>{c.setTooltip(u("settings.click-to-connect-wechat-server")).setIcon("plug-zap").setButtonText(u("settings.test-connection")).onClick(()=>{(async()=>await this.plugin.TestAccessToken(n.accountName)?new T.Notice(u("settings.successfully-connected-to-wechat-server")):new T.Notice(u("settings.failed-to-connect-to-wechat-server")))()})}),l.addButton(c=>{c.setTooltip(u("settings.delete-account")).setIcon("trash-2").setButtonText(u("settings.delete-account")).setClass("mod-warning").onClick(()=>{var p;this.plugin.settings.mpAccounts.splice(i,1),this.plugin.settings.selectedMPAccount===n.accountName&&(this.plugin.settings.selectedMPAccount=(p=this.plugin.settings.mpAccounts[0])==null?void 0:p.accountName),this.plugin.saveSettings(),this.display()})})}createNewAccount(){let e=1,n=u("settings.new-account");for(;this.plugin.settings.mpAccounts.some(r=>r.accountName===n);)e++,n=`${u("settings.new-account")} ${e}`;let i={accountName:n,appId:"",appSecret:""};this.plugin.settings.mpAccounts.push(i),this.plugin.settings.selectedMPAccount||(this.plugin.settings.selectedMPAccount=n),this.plugin.saveSettings(),this.display()}createHaloSettings(e){e.createDiv({cls:"setting-item-description"}).setText(u("settings.halo-settings-desc")),this.plugin.settings.haloSites.length==0?e.createDiv({cls:"one2mp-no-account"}).createEl("p",{text:u("settings.halo-no-site")}):this.plugin.settings.haloSites.forEach((r,a)=>{this.renderHaloSiteItem(e,r,a)}),new T.Setting(e).setName(u("settings.halo-default-site")).setDesc(u("settings.halo-default-site-desc")).setClass("one2mp-setting-wide").addDropdown(r=>{var o;if(this.plugin.settings.haloSites.length==0){r.addOption("",u("settings.halo-no-site")),r.setDisabled(!0);return}this.plugin.settings.haloSites.forEach(s=>{r.addOption(s.name,s.name)});let a=this.plugin.settings.selectedHaloSite||((o=this.plugin.settings.haloSites[0])==null?void 0:o.name)||"";r.setValue(a),r.onChange(s=>{this.plugin.settings.selectedHaloSite=s,this.plugin.saveSettings()})}),new T.Setting(e).setName(u("settings.halo-publish-default")).setDesc(u("settings.halo-publish-default-desc")).addToggle(r=>{r.setValue(this.plugin.settings.haloPublishByDefault).onChange(a=>{this.plugin.settings.haloPublishByDefault=a,this.plugin.saveSettings()})})}renderHaloSiteItem(e,n,i){let r=e.createDiv({cls:"one2mp-halo-site-item"}),a=r.createDiv({cls:"one2mp-halo-site-title"});a.setText(n.name||u("settings.halo-new-site")),a.setAttr("role","button"),a.setAttr("tabindex","0");let o=r.createDiv({cls:"one2mp-halo-site-details"}),s=()=>{let c=!r.classList.contains("is-collapsed");r.toggleClass("is-collapsed",c),a.setAttr("aria-expanded",c?"false":"true")};a.addEventListener("click",()=>{s()}),a.addEventListener("keydown",c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),s())}),new T.Setting(o).setName(u("settings.halo-site-name")).setDesc(u("settings.halo-site-name-desc")).setClass("one2mp-setting-wide").addText(c=>c.setValue(n.name).onChange(p=>{n.name=p,a.setText(p||u("settings.halo-new-site")),this.plugin.settings.selectedHaloSite==this.plugin.settings.haloSites[i].name&&(this.plugin.settings.selectedHaloSite=p),this.plugin.saveSettings()})),new T.Setting(o).setName(u("settings.halo-site-url")).setDesc(u("settings.halo-site-url-desc")).setClass("one2mp-setting-wide").addText(c=>c.setValue(n.url).setPlaceholder(u("settings.halo-site-url-placeholder")).onChange(p=>{n.url=p.trim(),this.plugin.saveSettings()})),new T.Setting(o).setName(u("settings.halo-site-token")).setDesc(u("settings.halo-site-token-desc")).setClass("one2mp-setting-wide").addText(c=>c.setValue(n.token).setPlaceholder(u("settings.halo-site-token-placeholder")).onChange(p=>{n.token=p.trim(),this.plugin.saveSettings()}));let l=new T.Setting(o).setName("");l.addButton(c=>{c.setIcon("plug-zap").setTooltip(u("settings.halo-test")).setButtonText(u("settings.halo-test")).onClick(()=>{this.testHaloConnection(n)})}),l.addButton(c=>{c.setIcon("trash-2").setTooltip(u("settings.halo-delete-site")).setButtonText(u("settings.halo-delete-site")).setClass("mod-warning").onClick(()=>{var p;this.plugin.settings.haloSites.splice(i,1),this.plugin.settings.selectedHaloSite==n.name&&(this.plugin.settings.selectedHaloSite=((p=this.plugin.settings.haloSites[0])==null?void 0:p.name)||""),this.plugin.saveSettings(),this.display()})})}getSelectedHaloSiteFromSettings(){var i;let e=this.plugin.settings.haloSites;if(!e||e.length===0)return null;let n=this.plugin.settings.selectedHaloSite;if(n){let r=e.find(a=>a.name===n);if(r)return r}return(i=e[0])!=null?i:null}async testHaloConnection(e){let n=e||this.getSelectedHaloSiteFromSettings();if(!n||!n.url.trim()||!n.token.trim()){new T.Notice(u("settings.halo-test-missing"));return}try{let i=await this.plugin.haloClient.testConnection(n);if(i.ok){new T.Notice(u("settings.halo-test-success"));return}switch(i.code){case"auth":new T.Notice(u("settings.halo-test-auth"));break;case"not-found":new T.Notice(u("settings.halo-test-not-found"));break;default:new T.Notice(u("settings.halo-test-failed"))}}catch(i){console.warn("Halo \u6D4B\u8BD5\u8FDE\u63A5\u5931\u8D25",i),new T.Notice(u("settings.halo-test-failed"))}}createNewHaloSite(){let e=1,n=u("settings.halo-new-site");for(;this.plugin.settings.haloSites.some(r=>r.name==n);)e+=1,n=`${u("settings.halo-new-site")} ${e}`;let i={name:n,url:"",token:""};this.plugin.settings.haloSites.push(i),this.plugin.settings.selectedHaloSite||(this.plugin.settings.selectedHaloSite=n),this.plugin.saveSettings(),this.display()}createGeneralSettings(e){new T.Setting(e).setName(u("settings.general-settings")).setHeading();let n=new T.Setting(e).setName(u("settings.public-ip-address")).setDesc(u("settings.you-should-add-this-ip-to-ip-whitelist-o")),i=a=>{n.controlEl.empty(),n.controlEl.addClass("one2mp-ip-container");let o=(s,l)=>{if(!l)return;let c=n.controlEl.createDiv({cls:"one2mp-ip-row"});c.createSpan({cls:"one2mp-ip-label",text:s}),c.createSpan({cls:"one2mp-ip-value",text:l}),c.title=u("settings.copy-ip-to-clipboard"),c.onclick=()=>{var p;if(!((p=navigator.clipboard)!=null&&p.writeText)){new T.Notice(u("settings.clipboard-not-supported"));return}navigator.clipboard.writeText(l).then(()=>{new T.Notice(u("settings.ip-copied-to-clipboard"))}).catch(h=>{console.warn("\u590D\u5236 IP \u5931\u8D25",h)})}};if(!a.direct&&!a.proxy){n.controlEl.createSpan({text:u("settings.no-ip-address"),cls:"text-muted"});return}a.direct===a.proxy||!a.proxy||!a.direct?o("\u516C\u7F51 IP",a.direct||a.proxy):(o("\u76F4\u8FDE",a.direct),o("\u4EE3\u7406",a.proxy))};(()=>{let a={};try{a=JSON.parse(this.plugin.settings.ipAddress||"{}")}catch(o){a={direct:this.plugin.settings.ipAddress}}i(a)})(),this.plugin.updateIpAddress().then(a=>{i(a)}).catch(()=>{}),new T.Setting(e).setName(u("settings.real-time-render")).setDesc(u("settings.enable-real-time-rendering")).addToggle(a=>{a.setValue(this.plugin.settings.realTimeRender).onChange(o=>{this.plugin.settings.realTimeRender=o,this.plugin.saveSettings()})})}creatCSSStyleSetting(e){new T.Setting(e).setName(u("settings.custom-themes")).setHeading(),new T.Setting(e).setName(u("settings.custom-themes-folder")).setDesc(u("settings.the-folder-where-your-custom-themes")).addSearch(n=>{new qt(this.app,n.inputEl),n.setPlaceholder(u("settings.themes-folder-path")).setValue(this.plugin.settings.css_styles_folder).onChange(i=>{this.plugin.settings.css_styles_folder=i,this.plugin.saveThemeFolderDebounce()})}).addExtraButton(n=>{n.setIcon("download").setTooltip(u("views.theme-manager.download-predefined-custom-themes")).onClick(()=>{(async()=>{let{ThemeManager:i}=await Promise.resolve().then(()=>(St(),Zt));new T.Notice(u("views.theme-manager.download-started")),i.getInstance(this.plugin).downloadThemes()})()})}),new T.Setting(e).setName(u("settings.theme-download-overwrite")).setDesc(u("settings.theme-download-overwrite-desc")).addToggle(n=>{n.setValue(this.plugin.settings.themeDownloadOverwrite).onChange(i=>{this.plugin.settings.themeDownloadOverwrite=i,this.plugin.saveSettings()})})}createBackupRestore(e){new T.Setting(e).setName(u("settings.import-export-one2mp-account")).setHeading().setDesc(u("settings.import-or-export-your-account-info-for-b")).addExtraButton(n=>{n.setIcon("upload").setTooltip(u("settings.import-account-info")).onClick(()=>{this.importSettings()})}).addExtraButton(n=>{n.setIcon("download").setTooltip(u("settings.export-account-info")).onClick(()=>{this.exportSettings()})})}async exportSettings(){try{let e=JSON.stringify(this.plugin.settings,null,2);if(!window.showSaveFilePicker||T.Platform.isMobile){let a=new Date().toISOString().slice(0,10),o="one2mp-settings",s=`one2mp-settings-${a}.json`,l=`${o}/${s}`;return this.app.vault.getAbstractFileByPath(o)||await this.app.vault.createFolder(o),await this.app.vault.adapter.write(l,e),new T.Notice(u("settings.settings-exported-to-vault",[l])),!0}let n=new Blob([e],{type:"application/json"}),r=await(await window.showSaveFilePicker({suggestedName:`one2mp-settings-${new Date().toISOString().slice(0,10)}.json`,types:[{description:"JSON Files",accept:{"application/json":[".json"]}}]})).createWritable();return await r.write(n),await r.close(),new T.Notice(u("settings.settings-exported")),!0}catch(e){if(e instanceof Error&&e.name==="AbortError")return!1;let n=e instanceof Error?e.message:String(e);return new T.Notice(`${u("settings.settings-exporting-failed")}${n}`),console.error(e),!1}}async importSettingsFromVault(){let e=new T.Modal(this.app);e.contentEl.createEl("h3",{text:u("settings.import-settings-title")}),e.contentEl.createEl("p",{text:u("settings.import-settings-hint")});let n=new T.TextComponent(e.contentEl);n.setPlaceholder(u("settings.import-settings-placeholder")),new pt(this.app,n.inputEl,["json"]);let i=e.contentEl.createDiv({cls:"modal-button-container"}),r=new T.ButtonComponent(i);r.setButtonText(u("settings.cancel")),r.onClick(()=>e.close());let a=new T.ButtonComponent(i);a.setButtonText(u("settings.import-settings-confirm")),a.setCta(),a.onClick(async()=>{let o=n.getValue().trim();if(!o){new T.Notice(u("settings.import-settings-empty-path"));return}let s=this.app.vault.getAbstractFileByPath(o);if(!(s instanceof T.TFile)){new T.Notice(u("settings.import-settings-file-not-found"));return}try{let l=await this.app.vault.read(s);await this.applyImportedSettings(l),e.close()}catch(l){let c=l instanceof Error?l.message:String(l);new T.Notice(`${u("settings.settings-imported-failed")}${c}`),console.error(l)}}),e.open()}async applyImportedSettings(e){let n;try{n=JSON.parse(e)}catch(a){new T.Notice(u("settings.invalid-json-file"));return}let{mpAccounts:i,css_styles_folder:r}=n;if(i===void 0||r===void 0){new T.Notice(u("settings.invalid-wewerite-settings-file"));return}this.plugin.settings=n,this.plugin.saveSettings(),this.display(),new T.Notice(u("settings.settings-imported-successfully"))}importSettings(){try{if(T.Platform.isMobile){this.importSettingsFromVault();return}let e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=n=>{(()=>{var o;let r=(o=n.target.files)==null?void 0:o[0];if(!r)return;let a=new FileReader;a.onload=s=>{(async()=>{var l;try{let c=(l=s.target)==null?void 0:l.result;await this.applyImportedSettings(c)}catch(c){let p=c instanceof Error?c.message:String(c);new T.Notice(`${u("settings.settings-imported-failed")}${p}`),console.error(c)}})()},a.readAsText(r)})()},e.click()}catch(e){let n=e instanceof Error?e.message:String(e);new T.Notice(`${u("settings.settings-imported-error")}${n}`),console.error(e)}}};var Js=1,ra=async()=>{},aa=async d=>{try{let t=await d.loadData();return t!=null&&t.settings?(t.custom_theme_folder&&!t.settings.css_styles_folder&&(t.settings.css_styles_folder=t.custom_theme_folder),t.settings):void 0}catch(t){console.error("Error loading One2MpSetting:",t);return}},oa=async(d,t)=>{var e;try{let n=await d.loadData(),i=n==null?void 0:n.settings;if(i&&JSON.stringify(t)==JSON.stringify(i))return;let r={...n,settings:t,custom_theme_folder:(e=t.css_styles_folder)!=null?e:n==null?void 0:n.custom_theme_folder,settings_version:Js};await d.saveData(r)}catch(n){console.error("Error setting One2MpSetting:",n)}};ut();var Qt=class{constructor(){this.listeners=new Map}registerListener(t,e){let n=this.listeners.get(t);return n==null||n===null?this.listeners.set(t,[e]):n.push(e),()=>this.unregisterListener(t,e)}unregisterListener(t,e){let n=this.listeners.get(t);if(!n)return;let i=n.filter(r=>r!==e);if(i.length===0){this.listeners.delete(t);return}this.listeners.set(t,i)}sendMessage(t,e){let n=this.listeners.get(t);n==null||n===null||n.forEach(i=>i(e))}};Tt();var V=require("obsidian");ut();an();It();de();var on=class{constructor(t){this.linkCache=new Map;this.imageCache=new Map;this.uploadPermissionNotified=!1;this.uploadConfigNotified=!1;this.plugin=t}async publishActiveNote(){let t=this.getSelectedSite();if(!t){new V.Notice(u("views.halo.missing-site"));return}if(!t.url.trim()||!t.token.trim()){new V.Notice(u("views.halo.missing-site"));return}let e=this.getActiveMarkdownFile();if(!e){new V.Notice(u("views.halo.no-active-file"));return}this.linkCache.clear(),this.imageCache.clear(),new V.Notice(u("views.halo.publishing"));try{await this.publishFile(e,t),new V.Notice(u("views.halo.publish-success"))}catch(n){console.error("Halo \u53D1\u5E03\u5931\u8D25",n),new V.Notice(u("views.halo.publish-failed"))}}getActiveMarkdownFile(){let t=this.plugin.app.workspace.getActiveFile();return!t||t.extension!=="md"?null:t}getSelectedSite(){var n;let{haloSites:t,selectedHaloSite:e}=this.plugin.settings;if(!t||t.length===0)return null;if(e){let i=t.find(r=>r.name===e);if(i)return i}return(n=t[0])!=null?n:null}async testConnection(t){let e=`${t.url.replace(/\/+$/,"")}/apis/uc.api.content.halo.run/v1alpha1/posts?page=0&size=1`;try{let n=await(0,V.requestUrl)({url:e,method:"GET",headers:this.buildHeaders(t),throw:!1});return n.status>=200&&n.status<300?{ok:!0}:n.status===401||n.status===403?{ok:!1,code:"auth",status:n.status}:n.status===404?{ok:!1,code:"not-found",status:n.status}:{ok:!1,code:"unknown",status:n.status}}catch(n){return console.warn("Halo \u8FDE\u63A5\u6D4B\u8BD5\u5931\u8D25",n),{ok:!1,code:"network"}}}async publishFile(t,e){var A,k;let n=await this.plugin.app.vault.read(t),i=this.plugin.app.metadataCache.getFileCache(t),r=(A=i==null?void 0:i.frontmatter)!=null?A:void 0,a=i==null?void 0:i.frontmatterPosition,o=a?n.slice(a.end.offset):n,s=o,l=null;try{s=await this.processMarkdown(o,t,e);let C=Xe(r!=null?r:null);if(!C){let P=await $e.getInstance(this.plugin).getDrafOfActiveNote();P!=null&&P.cover_image_url&&(C=P.cover_image_url)}C&&(l=await this.resolveCoverUrl(C,t,e))}catch(C){throw C instanceof Error&&(C.message==="HALO_ATTACHMENT_PERMISSION"||C.message==="HALO_ATTACHMENT_NOT_CONFIGURED")||new V.Notice(u("views.halo.attachment-failed")),C}let c=this.getFrontmatterHalo(r);if(c!=null&&c.site&&c.site!==e.url){new V.Notice(u("views.halo.site-mismatch"));return}let p=this.buildDefaultPost(),h=this.buildContent(s);if(c!=null&&c.name){let C=await this.getPost(e,c.name);C&&(p=C.post,h=C.content,p.spec.deleted&&(p.spec.deleted=!1))}h.raw=s,h.content=this.renderHtml(s);let g=this.getFrontmatterString(r,"title")||t.basename;p.spec.title=g,p.spec.slug=this.getFrontmatterString(r,"slug")||this.buildSlug(g),p.spec.excerpt=this.buildExcerpt(r),l&&(p.spec.cover=l),Array.isArray(r==null?void 0:r.categories)&&(p.spec.categories=await this.getCategoryNames(e,r.categories)),Array.isArray(r==null?void 0:r.tags)&&(p.spec.tags=await this.getTagNames(e,r.tags)),p.metadata.name?await this.updatePost(e,p,h):(p.metadata.name=this.buildPostName(),p.metadata.annotations={...p.metadata.annotations||{},"content.halo.run/content-json":JSON.stringify(h)},p=await this.createPost(e,p));let m=this.getPublishFlag(r);m!==void 0&&await this.changePublish(e,p.metadata.name,m);let f=await this.getPost(e,p.metadata.name),v=this.normalizePermalink(e,((k=f==null?void 0:f.post.status)==null?void 0:k.permalink)||null);await this.plugin.app.fileManager.processFrontMatter(t,C=>{C.halo={site:e.url,name:p.metadata.name,publish:m!=null?m:p.spec.publish,...v?{permalink:v}:{}}})}buildDefaultPost(){return{apiVersion:"content.halo.run/v1alpha1",kind:"Post",metadata:{name:"",annotations:{}},spec:{allowComment:!0,baseSnapshot:"",categories:[],cover:"",deleted:!1,excerpt:{autoGenerate:!0,raw:""},headSnapshot:"",htmlMetas:[],owner:"",pinned:!1,priority:0,publish:!1,publishTime:"",releaseSnapshot:"",slug:"",tags:[],template:"",title:"",visible:"PUBLIC"}}}buildContent(t){return{rawType:"markdown",raw:t,content:""}}renderHtml(t){let e=new je;return e.use({gfm:!0,breaks:!0}),e.parse(t)}buildSlug(t){return t.trim().toLowerCase().replace(/[^\w-]+/g,"-").replace(/^-+|-+$/g,"")||`post-${Date.now()}`}buildPostName(){let t=globalThis.crypto;return t!=null&&t.randomUUID?t.randomUUID():`o2any-${Date.now()}-${Math.random().toString(16).slice(2)}`}buildExcerpt(t){let e=this.getFrontmatterString(t,"excerpt")||this.getFrontmatterString(t,"\u6458\u8981");return e?{autoGenerate:!1,raw:e}:{autoGenerate:!0,raw:""}}getPublishFlag(t){let e=this.getFrontmatterHalo(t);return typeof(e==null?void 0:e.publish)=="boolean"?e.publish:this.plugin.settings.haloPublishByDefault}getFrontmatterHalo(t){let e=t==null?void 0:t.halo;return!e||typeof e!="object"?null:e}getFrontmatterString(t,e){let n=t==null?void 0:t[e];if(typeof n=="string"&&n.trim())return n.trim()}buildHeaders(t){return{"Content-Type":"application/json",Authorization:`Bearer ${t.token}`}}async getPost(t,e){var n;try{let i=this.buildHeaders(t),r=await(0,V.requestUrl)({url:`${t.url.replace(/\/+$/,"")}/apis/uc.api.content.halo.run/v1alpha1/posts/${e}`,headers:i}).json,a=await(0,V.requestUrl)({url:`${t.url.replace(/\/+$/,"")}/apis/uc.api.content.halo.run/v1alpha1/posts/${e}/draft?patched=true`,headers:i}).json,s=(a.metadata.annotations||{})["content.halo.run/content-json"],l={rawType:((n=a.spec)==null?void 0:n.rawType)||"markdown",raw:"",content:""};if(s&&typeof s=="string")try{l=JSON.parse(s)}catch(c){console.warn("\u89E3\u6790 Halo content-json \u5931\u8D25",c)}return{post:r,content:l}}catch(i){return null}}async createPost(t,e){let n=this.buildHeaders(t);return(await(0,V.requestUrl)({url:`${t.url.replace(/\/+$/,"")}/apis/uc.api.content.halo.run/v1alpha1/posts`,method:"POST",contentType:"application/json",headers:n,body:JSON.stringify(e)})).json}async updatePost(t,e,n){let i=this.buildHeaders(t),r=e.metadata.name;await(0,V.requestUrl)({url:`${t.url.replace(/\/+$/,"")}/apis/uc.api.content.halo.run/v1alpha1/posts/${r}`,method:"PUT",contentType:"application/json",headers:i,body:JSON.stringify(e)});let a=await(0,V.requestUrl)({url:`${t.url.replace(/\/+$/,"")}/apis/uc.api.content.halo.run/v1alpha1/posts/${r}/draft?patched=true`,headers:i}).json;a.metadata.annotations={...a.metadata.annotations||{},"content.halo.run/content-json":JSON.stringify(n)},await(0,V.requestUrl)({url:`${t.url.replace(/\/+$/,"")}/apis/uc.api.content.halo.run/v1alpha1/posts/${r}/draft`,method:"PUT",contentType:"application/json",headers:i,body:JSON.stringify(a)})}async changePublish(t,e,n){let i=this.buildHeaders(t);await(0,V.requestUrl)({url:`${t.url.replace(/\/+$/,"")}/apis/uc.api.content.halo.run/v1alpha1/posts/${e}/${n?"publish":"unpublish"}`,method:"PUT",contentType:"application/json",headers:i})}normalizePermalink(t,e){return e?/^https?:\/\//i.test(e)?e:`${t.url.replace(/\/+$/,"")}${e.startsWith("/")?"":"/"}${e}`:null}async processMarkdown(t,e,n){let i=t;return i=await this.replaceImages(i,e,n),i=await this.replaceWikiLinks(i,e,n),i}async replaceImages(t,e,n){return this.replaceOutsideCodeBlocks(t,async i=>{let r=i,a=/!\[\[([^\]]+)\]\]/g,o=Array.from(i.matchAll(a));for(let c of o){let p=c[0],g=c[1].split("|")[0].trim();if(!g)continue;let m=this.normalizeRemoteImage(g);if(m){r=r.replace(p,`![](${m})`);continue}let f=await this.uploadLocalImage(g,e,n);if(f){let v=this.extractImageAlt(g);r=r.replace(p,`![${v}](${f})`)}}let s=/!\[([^\]]*)\]\(([^)]+)\)/g,l=Array.from(r.matchAll(s));for(let c of l){let p=c[0],h=c[1],m=c[2].trim().split(/\s+/)[0].replace(/^<|>$/g,"");if(this.normalizeRemoteImage(m))continue;let v=await this.uploadLocalImage(m,e,n);v&&(r=r.replace(p,`![${h}](${v})`))}return r})}async replaceWikiLinks(t,e,n){return this.replaceOutsideCodeBlocks(t,async i=>{let r=/\[\[([^\]]+)\]\]/g,a=Array.from(i.matchAll(r)),o=i;for(let s of a){let l=s[0],c=s[1];if(!c)continue;let[p,h]=c.split("|"),g=p.trim(),m=(h||p).trim(),f=await this.resolvePermalinkForNote(g,e,n);f?o=o.replace(l,`[${m}](${f})`):o=o.replace(l,m)}return o})}async replaceOutsideCodeBlocks(t,e){var a;let n=/```[\s\S]*?```/g,i="",r=0;for(let o of t.matchAll(n)){let s=(a=o.index)!=null?a:0,l=t.slice(r,s);i+=await e(l),i+=o[0],r=s+o[0].length}return i+=await e(t.slice(r)),i}normalizeRemoteImage(t){return/^(https?:|data:)/i.test(t)?t:null}extractImageAlt(t){return(t.split("/").pop()||t).replace(/\.[a-zA-Z0-9]+$/,"")}resolveLocalImageFile(t,e){var o,s,l;let n=t.split("|")[0].split("?")[0].split("#")[0].trim();if(!n)return null;let i=this.plugin.app.vault.getAbstractFileByPath(n);if(i instanceof V.TFile)return i;let r=this.plugin.app.metadataCache.getFirstLinkpathDest(n,e.path);if(r instanceof V.TFile)return r;let a=((o=this.plugin.app.vault.config)==null?void 0:o.attachmentFolderPath)||"";if(a){let c=(l=(s=e.parent)==null?void 0:s.path)!=null?l:"",p=n.split("/").pop()||n,h=a.startsWith("./")?[`${c}/${a.slice(2)}/${p}`,`${c}/${a.slice(2)}/${n}`]:[`${a}/${p}`,`${a}/${n}`,`${c}/${a}/${p}`,`${c}/${a}/${n}`];for(let g of h){let m=this.plugin.app.vault.getAbstractFileByPath(g);if(m instanceof V.TFile)return m}}return null}async uploadLocalImage(t,e,n){let i=this.resolveLocalImageFile(t,e);if(!i)return null;if(this.imageCache.has(i.path))return this.imageCache.get(i.path)||null;let r=await this.plugin.app.vault.readBinary(i),a=await this.uploadAttachment(n,r,i.name);return a&&this.imageCache.set(i.path,a),a}async uploadAttachment(t,e,n){var g,m;let i=n.replace(/[\r\n"]/g,"_");if(i.length>180){let f=i.lastIndexOf("."),v=f>-1?i.slice(f):"";i=i.slice(0,180-v.length)+v}let r=`----O2AnyHaloBoundary${Date.now()}`,a=new TextEncoder,o=`--${r}\r
Content-Disposition: form-data; name="file"; filename="${i}"\r
Content-Type: application/octet-stream\r
\r
`,s=`\r
--${r}\r
Content-Disposition: form-data; name="filename"\r
\r
${i}\r
--${r}--\r
`,l=this.concatBuffers([a.encode(o),new Uint8Array(e),a.encode(s)]),c=[`${t.url.replace(/\/+$/,"")}/apis/console.api.storage.halo.run/v1alpha1/attachments/-/upload`,`${t.url.replace(/\/+$/,"")}/apis/uc.api.storage.halo.run/v1alpha1/attachments/-/upload`],p=!1,h=!1;for(let f of c){let v=await(0,V.requestUrl)({url:f,method:"POST",headers:{Authorization:`Bearer ${t.token}`,"Content-Type":`multipart/form-data; boundary=${r}`},body:l.buffer,throw:!1});if(v.status==404)continue;if(v.status==401||v.status==403){p=!0;continue}let A=v.json&&typeof v.json.detail=="string"&&(g=v.json.detail)!=null?g:"";if(v.status==400&&A.includes("Attachment system setting is not configured")){h=!0;continue}if(v.status>=400)throw new Error(`Upload failed: ${v.status} ${v.text}`);let k=v.json,C=(m=k==null?void 0:k.status)==null?void 0:m.permalink;if(C)return this.normalizePermalink(t,C)}throw p?(this.uploadPermissionNotified||(new V.Notice(u("views.halo.attachment-permission")),this.uploadPermissionNotified=!0),new Error("HALO_ATTACHMENT_PERMISSION")):h?(this.uploadConfigNotified||(new V.Notice(u("views.halo.attachment-not-configured")),this.uploadConfigNotified=!0),new Error("HALO_ATTACHMENT_NOT_CONFIGURED")):new Error("HALO_ATTACHMENT_UPLOAD_FAILED")}concatBuffers(t){let e=t.reduce((r,a)=>r+a.length,0),n=new Uint8Array(e),i=0;for(let r of t)n.set(r,i),i+=r.length;return n}async resolvePermalinkForNote(t,e,n){var o,s,l,c,p;let i=t.split("#")[0].trim();if(!i)return null;if(this.linkCache.has(i))return this.linkCache.get(i)||null;let r=this.plugin.app.metadataCache.getFirstLinkpathDest(i,e.path);if(!(r instanceof V.TFile))return null;let a=(o=this.plugin.app.metadataCache.getFileCache(r))==null?void 0:o.frontmatter;if((s=a==null?void 0:a.halo)!=null&&s.site&&a.halo.site!==n.url)return null;if((l=a==null?void 0:a.halo)!=null&&l.permalink){let h=this.normalizePermalink(n,a.halo.permalink);return h&&this.linkCache.set(i,h),h}if((c=a==null?void 0:a.halo)!=null&&c.name){let h=await this.getPost(n,a.halo.name),g=this.normalizePermalink(n,((p=h==null?void 0:h.post.status)==null?void 0:p.permalink)||null);return g&&this.linkCache.set(i,g),g}return null}async resolveCoverUrl(t,e,n){let i=t.trim(),r=this.normalizeRemoteImage(i);if(r)return r;let a=i;a.startsWith("vault:")&&(a=a.slice(6));let o=await this.uploadLocalImage(a,e,n);return o!=null?o:null}async getCategories(t){let e=this.buildHeaders(t);return(await(0,V.requestUrl)({url:`${t.url.replace(/\/+$/,"")}/apis/content.halo.run/v1alpha1/categories`,headers:e})).json.items}async getTags(t){let e=this.buildHeaders(t);return(await(0,V.requestUrl)({url:`${t.url.replace(/\/+$/,"")}/apis/content.halo.run/v1alpha1/tags`,headers:e})).json.items}async getCategoryNames(t,e){let n=await this.getCategories(t),i=e.filter(l=>!n.find(c=>c.spec.displayName===l)),r=this.buildHeaders(t),a=i.map((l,c)=>(0,V.requestUrl)({url:`${t.url.replace(/\/+$/,"")}/apis/content.halo.run/v1alpha1/categories`,method:"POST",contentType:"application/json",headers:r,body:JSON.stringify({spec:{displayName:l,slug:this.buildSlug(l),description:"",cover:"",template:"",priority:n.length+c,children:[]},apiVersion:"content.halo.run/v1alpha1",kind:"Category",metadata:{name:"",generateName:"category-"}})})),o=await Promise.all(a);return[...e.map(l=>{var c;return(c=n.find(p=>p.spec.displayName===l))==null?void 0:c.metadata.name}).filter(Boolean),...o.map(l=>l.json.metadata.name)]}async getTagNames(t,e){let n=await this.getTags(t),i=e.filter(l=>!n.find(c=>c.spec.displayName===l)),r=this.buildHeaders(t),a=i.map(l=>(0,V.requestUrl)({url:`${t.url.replace(/\/+$/,"")}/apis/content.halo.run/v1alpha1/tags`,method:"POST",contentType:"application/json",headers:r,body:JSON.stringify({spec:{displayName:l,slug:this.buildSlug(l),color:"#ffffff",cover:""},apiVersion:"content.halo.run/v1alpha1",kind:"Tag",metadata:{name:"",generateName:"tag-"}})})),o=await Promise.all(a);return[...e.map(l=>{var c;return(c=n.find(p=>p.spec.displayName===l))==null?void 0:c.metadata.name}).filter(Boolean),...o.map(l=>l.json.metadata.name)]}};var sn=class{constructor(t){this.spinnerEl=t,this.spinnerEl.addClass("spinner-container");let e=this.spinnerEl.createDiv({cls:"spinner-dots"});for(let n=0;n<6;n++)e.createDiv({cls:`spinner-dot spinner-dot${n+1}`}).setCssProps({"animation-delay":`${n*.3}s`});this.spinnerText=this.spinnerEl.createDiv({cls:"spinner-text"})}showSpinner(t=""){this.spinnerEl.setCssProps({display:"flex"}),this.spinnerText.setText(t)}isSpinning(){return getComputedStyle(this.spinnerEl).display!=="none"}hideSpinner(){this.spinnerEl.setCssProps({display:"none"})}unload(){this.spinnerEl.remove()}};var cn=require("obsidian");de();var ln=class extends cn.Modal{constructor(e,n,i=""){super(e);this.initialContent=i;this.inputEl=null;this.onSubmit=n}onOpen(){let{contentEl:e}=this;e.empty(),e.createEl("h3",{text:u("modals.mpcard.title")}),e.createEl("p",{text:u("modals.mpcard.hint")}),this.inputEl=e.createEl("textarea",{cls:"one2mp-mpcard-input"}),this.inputEl.placeholder=u("modals.mpcard.placeholder"),this.initialContent&&(this.inputEl.value=this.initialContent),this.inputEl.focus();let n=e.createDiv("modal-button-container");n.createEl("button",{text:u("modals.mpcard.insert")}).addEventListener("click",()=>{var a,o;let i=(o=(a=this.inputEl)==null?void 0:a.value)!=null?o:"",r=this.normalizeMpcard(i);if(!r){new cn.Notice(u("modals.mpcard.empty"));return}this.onSubmit(r),this.close()}),n.createEl("button",{text:u("modals.cancel")}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:e}=this;e.empty(),this.inputEl=null}normalizeMpcard(e){let n=e.trim();if(!n)return"";if(n.startsWith("```")){let i=n.split(/\r?\n/);return/```\\s*mpcard/i.test(i[0])||(i[0]="```mpcard"),i.slice(1).some(a=>a.trim()==="```")||i.push("```"),`
${i.join(`
`)}
`}return`
\`\`\`mpcard
${n}
\`\`\`
`}};var vt="one2mp-article-preview",bc={mpAccounts:[],ipAddress:"",css_styles_folder:"one2mp-css-styles",codeLineNumber:!0,accountDataPath:"one2mp-accounts",useCenterToken:!1,realTimeRender:!0,defaultMpcard:"",defaultMpcardId:"",defaultMpcardHeadimg:"",defaultMpcardNickname:"",defaultMpcardSignature:"",themeDownloadOverwrite:!1,haloSites:[],selectedHaloSite:"",haloPublishByDefault:!0},Lo="one2mp-logo",wc=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="100" height="100">
	<path d="M 15.560304092607304 33.94050605385342C 29.693661897802365 -1.1141138324752404 70.30633810219763 -1.1141138324752404 84.43969590739269 33.940506053853426C 51.84603073656342 45.353262378865885 48.15396926343658 45.353262378865885 15.560304092607304 33.94050605385342Z" fill="#84D473" />
	<path d="M 81.12777768298169 28.204095418660252C 104.41929012195195 57.97125226189857 84.1129520197543 93.14286157057666 46.688081775588984 87.85539852748633C 53.1011774563413 53.92207832459788 54.947208192904725 50.72465929653623 81.12777768298169 28.204095418660252Z" fill="#3AB54A" />
	<path d="M 53.31191822441101 87.85539852748633C 15.887047980245676 93.14286157057666 -4.419290121951946 57.971252261898584 18.872222317018313 28.204095418660245Q 45.052791807095275 50.72465929653624 28.163984663890915 52.681125554913244L 38.40889008453118 53.10582854123025L 29.748893224046313 58.59608482676403Q 46.898822543658696 53.92207832459788 53.31191822441101 87.85539852748633Z" fill="#27753D" />
</svg>`,Ln=class extends ge.Plugin{constructor(){super(...arguments);this.editorChangeListener=null;this.resourceManager=Fe.getInstance(this);this.active=!1;this.previewPanelCtor=null;this.notePathKey="\u7B14\u8BB0\u8DEF\u5F84";this.updateNotePathDebounced=null;this.saveSettings=(0,ge.debounce)(async()=>{delete this.settings._id,delete this.settings._rev,this.trimSettings(),await oa(this,this.settings),await this.saveThemeFolder()},3e3);this.saveThemeFolderDebounce=(0,ge.debounce)(async()=>{await this.saveThemeFolder()},3e3)}async updateNotePathFrontmatter(e){if(!e||e.extension!=="md")return;let n=e.path;try{await this.app.fileManager.processFrontMatter(e,i=>{i[this.notePathKey]!==n&&(i[this.notePathKey]=n)})}catch(i){console.warn("\u66F4\u65B0\u7B14\u8BB0\u8DEF\u5F84\u5931\u8D25",i)}}async saveThemeFolder(){this.trimSettings();let e={...this.settings};delete e._id,delete e._rev;let n={custom_theme_folder:this.settings.css_styles_folder},i=await this.loadData();await this.saveData({...i!=null?i:{},...n,settings:e}),this.messageService.sendMessage("custom-theme-folder-changed",null)}async loadThemeFolder(){let e=await this.loadData();e&&e.custom_theme_folder&&(this.settings.css_styles_folder=e.custom_theme_folder)}trimSettings(){var e,n,i,r,a;this.settings.mpAccounts.forEach(o=>{o.accountName=o.accountName.trim(),o.appId=o.appId.trim(),o.appSecret=o.appSecret.trim()}),this.settings.haloSites.forEach(o=>{o.name=o.name.trim(),o.url=o.url.trim(),o.token=o.token.trim()}),this.settings.selectedHaloSite=(e=this.settings.selectedHaloSite)==null?void 0:e.trim(),this.settings.ipAddress=(n=this.settings.ipAddress)==null?void 0:n.trim(),this.settings.selectedMPAccount=(i=this.settings.selectedMPAccount)==null?void 0:i.trim(),this.settings.accountDataPath=(r=this.settings.accountDataPath)==null?void 0:r.trim(),this.settings.css_styles_folder=(a=this.settings.css_styles_folder)==null?void 0:a.trim()}async writeStartupLog(e,n){let i="o2any-startup.log",r=new Date().toISOString(),a=n?` ${this.formatStartupError(n)}`:"",o=`[${r}] ${e}${a}
`;try{let s=this.app.vault.adapter;await s.exists(i)?await s.append(i,o):await s.write(i,o)}catch(s){console.error("O2Any \u542F\u52A8\u65E5\u5FD7\u5199\u5165\u5931\u8D25",s)}}formatStartupError(e){return e instanceof Error?`${e.name}: ${e.message}${e.stack?`
${e.stack}`:""}`:String(e)}createSpinner(){this.spinner=new sn(this.addStatusBarItem())}showSpinner(e=""){this.spinner.showSpinner(e)}isSpinning(){return this.spinner.isSpinning()}hideSpinner(){this.spinner.hideSpinner()}async loadSettings(){this.settings=Object.assign({},bc,await aa(this)),await this.loadThemeFolder()}async updateIpAddress(){try{let e=await Ci();return this.settings.ipAddress=JSON.stringify(e),this.saveSettings(),e}catch(e){return console.error("Error fetching public IP address:",e),{}}}async activateView(){let{workspace:e}=this.app,n=e.getLeavesOfType(vt).find(i=>i.view.getViewType()===vt);n==null&&(n=e.getRightLeaf(!1),await(n==null?void 0:n.setViewState({type:vt,active:!0}))),n&&e.revealLeaf(n)}getAccessToken(e){let n=this.getMPAccountByName(e);return n===void 0?(new ge.Notice(u("main.no-wechat-mp-account-selected")),!1):n.access_token}async TestAccessToken(e){if(this.settings.useCenterToken)return this.wechatClient.requestToken();{let n=this.getMPAccountByName(e);if(n===void 0)return new ge.Notice(u("main.no-wechat-mp-account-selected")),!1;let i=await this.wechatClient.getAccessToken(n.appId,n.appSecret);if(i)return this.setAccessToken(e,i.access_token,i.expires_in),i.access_token}return!1}async refreshAccessToken(e){if(this.settings.useCenterToken)return this.wechatClient.requestToken();if(e===void 0)return!1;let n=this.getMPAccountByName(e);if(n===void 0)return new ge.Notice(u("main.no-wechat-mp-account-selected")),!1;let{appId:i,appSecret:r}=n;if(i===void 0||r===void 0||!i||!r)return new ge.Notice(u("main.please-check-you-appid-and-appsecret")),!1;let{access_token:a,expires_in:o,lastRefreshTime:s}=n;if(a===void 0||a===""){let l=await this.wechatClient.getAccessToken(i,r);if(l)return this.setAccessToken(e,l.access_token,l.expires_in),l.access_token}else if(s+o*1e3<new Date().getTime()){let l=await this.wechatClient.getAccessToken(i,r);if(l)return this.setAccessToken(e,l.access_token,l.expires_in),l.access_token}else return a;return!1}getMPAccountByName(e){return this.settings.mpAccounts.find(n=>n.accountName===e)}getSelectedMPAccount(){return this.getMPAccountByName(this.settings.selectedMPAccount)}setAccessToken(e,n,i){let r=this.getMPAccountByName(e);r!==void 0&&(r.access_token=n,r.lastRefreshTime=new Date().getTime(),r.expires_in=i,this.saveSettings())}confirm(e){return new Promise(n=>{new Wt(this.app,e,n).open()})}initDB(){ra(),Kn()}async onload(){await this.writeStartupLog("onload:start");try{this.initDB(),this.messageService=new Qt,await this.loadSettings(),this.wechatClient=Me.getInstance(this),this.haloClient=new on(this),(0,ge.addIcon)(Lo,wc);let e=await Promise.resolve().then(()=>(Ao(),Mo));this.previewPanelCtor=e.PreviewPanel,this.registerViews(),this.addCommand({id:"open-previewer",name:u("main.open-previewer"),callback:()=>{this.activateView()}}),this.addRibbonIcon(Lo,u("main.open-previewer"),()=>{this.activateView()}),this.addSettingTab(new Yt(this.app,this)),this.updateNotePathDebounced=(0,ge.debounce)(n=>{this.updateNotePathFrontmatter(n)},200),this.registerEvent(this.app.workspace.on("file-open",n=>{this.updateNotePathDebounced&&this.updateNotePathDebounced(n)})),this.registerEvent(this.app.vault.on("rename",n=>{n instanceof ge.TFile&&this.updateNotePathDebounced&&this.updateNotePathDebounced(n)})),this.createSpinner(),this.messageService.registerListener("show-spinner",n=>{this.showSpinner(n)}),this.messageService.registerListener("hide-spinner",()=>{this.hideSpinner()}),this.registerEvent(this.app.workspace.on("editor-menu",(n,i)=>{n.addItem(r=>{r.setTitle(u("main.insert-mpcard")),r.onClick(()=>{let a=this.settings.defaultMpcard||this.buildDefaultMpcard();new ln(this.app,s=>{i.replaceSelection(s)},a).open()})})}))}catch(e){throw await this.writeStartupLog("onload:error",e),e}await this.writeStartupLog("onload:ready")}buildDefaultMpcard(){var o,s,l,c;let e=[],n=(o=this.settings.defaultMpcardId)==null?void 0:o.trim(),i=(s=this.settings.defaultMpcardHeadimg)==null?void 0:s.trim(),r=(l=this.settings.defaultMpcardNickname)==null?void 0:l.trim(),a=(c=this.settings.defaultMpcardSignature)==null?void 0:c.trim();return n&&e.push(`id: ${n}`),i&&e.push(`headimg: ${i}`),r&&e.push(`nickname: ${r}`),a&&e.push(`signature: ${a}`),e.length===0?"":["```mpcard",...e,"```"].join(`
`)}registerViewOnce(e){if(this.app.workspace.getLeavesOfType(e).length===0&&e===vt){if(!this.previewPanelCtor){new ge.Notice("\u9884\u89C8\u5668\u672A\u52A0\u8F7D\uFF0C\u65E0\u6CD5\u6CE8\u518C\u89C6\u56FE");return}this.registerView(e,n=>new this.previewPanelCtor(n,this))}}registerViews(){this.registerViewOnce(vt)}onunload(){this.editorChangeListener&&this.app.workspace.offref(this.editorChangeListener),this.spinner.unload(),this.app.workspace.getLeavesOfType(vt).forEach(e=>e.detach()),Me.resetInstance(),(async()=>{let{ThemeManager:e}=await Promise.resolve().then(()=>(St(),Zt));e.resetInstance()})(),(async()=>{let{LocalDraftManager:e}=await Promise.resolve().then(()=>(ut(),pa));e.resetInstance();let{WechatRender:n}=await Promise.resolve().then(()=>(bi(),ko));n.resetInstance()})()}};
//![[]]
